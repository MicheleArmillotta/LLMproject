[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "644-807",
    "snippet": "int\nmain(int argc, char **argv)\n{\n\tint debug_flag = 0, log_level = SYSLOG_LEVEL_INFO;\n\tint opt, fopt_count = 0, j;\n\tchar *tname, *cp, *line = NULL;\n\tsize_t linesize = 0;\n\tFILE *fp;\n\n\textern int optind;\n\textern char *optarg;\n\n\tssh_malloc_init();\t/* must be called before any mallocs */\n\t__progname = ssh_get_progname(argv[0]);\n\tseed_rng();\n\tTAILQ_INIT(&tq);\n\n\t/* Ensure that fds 0, 1 and 2 are open or directed to /dev/null */\n\tsanitise_stdfd();\n\n\tif (argc <= 1)\n\t\tusage();\n\n\twhile ((opt = getopt(argc, argv, \"cDHv46p:T:t:f:\")) != -1) {\n\t\tswitch (opt) {\n\t\tcase 'H':\n\t\t\thash_hosts = 1;\n\t\t\tbreak;\n\t\tcase 'c':\n\t\t\tget_cert = 1;\n\t\t\tbreak;\n\t\tcase 'D':\n\t\t\tprint_sshfp = 1;\n\t\t\tbreak;\n\t\tcase 'p':\n\t\t\tssh_port = a2port(optarg);\n\t\t\tif (ssh_port <= 0) {\n\t\t\t\tfprintf(stderr, \"Bad port '%s'\\n\", optarg);\n\t\t\t\texit(1);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'T':\n\t\t\ttimeout = convtime(optarg);\n\t\t\tif (timeout == -1 || timeout == 0) {\n\t\t\t\tfprintf(stderr, \"Bad timeout '%s'\\n\", optarg);\n\t\t\t\tusage();\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'v':\n\t\t\tif (!debug_flag) {\n\t\t\t\tdebug_flag = 1;\n\t\t\t\tlog_level = SYSLOG_LEVEL_DEBUG1;\n\t\t\t}\n\t\t\telse if (log_level < SYSLOG_LEVEL_DEBUG3)\n\t\t\t\tlog_level++;\n\t\t\telse\n\t\t\t\tfatal(\"Too high debugging level.\");\n\t\t\tbreak;\n\t\tcase 'f':\n\t\t\tif (strcmp(optarg, \"-\") == 0)\n\t\t\t\toptarg = NULL;\n\t\t\targv[fopt_count++] = optarg;\n\t\t\tbreak;\n\t\tcase 't':\n\t\t\tget_keytypes = 0;\n\t\t\ttname = strtok(optarg, \",\");\n\t\t\twhile (tname) {\n\t\t\t\tint type = sshkey_type_from_name(tname);\n\n\t\t\t\tswitch (type) {\n\t\t\t\tcase KEY_DSA:\n\t\t\t\t\tget_keytypes |= KT_DSA;\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_ECDSA:\n\t\t\t\t\tget_keytypes |= KT_ECDSA;\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_RSA:\n\t\t\t\t\tget_keytypes |= KT_RSA;\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_ED25519:\n\t\t\t\t\tget_keytypes |= KT_ED25519;\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_XMSS:\n\t\t\t\t\tget_keytypes |= KT_XMSS;\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_UNSPEC:\n\t\t\t\tdefault:\n\t\t\t\t\tfatal(\"Unknown key type \\\"%s\\\"\", tname);\n\t\t\t\t}\n\t\t\t\ttname = strtok(NULL, \",\");\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '4':\n\t\t\tIPv4or6 = AF_INET;\n\t\t\tbreak;\n\t\tcase '6':\n\t\t\tIPv4or6 = AF_INET6;\n\t\t\tbreak;\n\t\tcase '?':\n\t\tdefault:\n\t\t\tusage();\n\t\t}\n\t}\n\tif (optind == argc && !fopt_count)\n\t\tusage();\n\n\tlog_init(\"ssh-keyscan\", log_level, SYSLOG_FACILITY_USER, 1);\n\n\tmaxfd = fdlim_get(1);\n\tif (maxfd < 0)\n\t\tfatal(\"%s: fdlim_get: bad value\", __progname);\n\tif (maxfd > MAXMAXFD)\n\t\tmaxfd = MAXMAXFD;\n\tif (MAXCON <= 0)\n\t\tfatal(\"%s: not enough file descriptors\", __progname);\n\tif (maxfd > fdlim_get(0))\n\t\tfdlim_set(maxfd);\n\tfdcon = xcalloc(maxfd, sizeof(con));\n\n\tread_wait_nfdset = howmany(maxfd, NFDBITS);\n\tread_wait = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\n\tfor (j = 0; j < fopt_count; j++) {\n\t\tif (argv[j] == NULL)\n\t\t\tfp = stdin;\n\t\telse if ((fp = fopen(argv[j], \"r\")) == NULL)\n\t\t\tfatal(\"%s: %s: %s\", __progname, argv[j],\n\t\t\t    strerror(errno));\n\n\t\twhile (getline(&line, &linesize, fp) != -1) {\n\t\t\t/* Chomp off trailing whitespace and comments */\n\t\t\tif ((cp = strchr(line, '#')) == NULL)\n\t\t\t\tcp = line + strlen(line) - 1;\n\t\t\twhile (cp >= line) {\n\t\t\t\tif (*cp == ' ' || *cp == '\\t' ||\n\t\t\t\t    *cp == '\\n' || *cp == '#')\n\t\t\t\t\t*cp-- = '\\0';\n\t\t\t\telse\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Skip empty lines */\n\t\t\tif (*line == '\\0')\n\t\t\t\tcontinue;\n\n\t\t\tdo_host(line);\n\t\t}\n\n\t\tif (ferror(fp))\n\t\t\tfatal(\"%s: %s: %s\", __progname, argv[j],\n\t\t\t    strerror(errno));\n\n\t\tfclose(fp);\n\t}\n\tfree(line);\n\n\twhile (optind < argc)\n\t\tdo_host(argv[optind++]);\n\n\twhile (ncon > 0)\n\t\tconloop();\n\n\treturn (0);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define MAXCON (maxfd - 10)",
      "#define MAXMAXFD 256",
      "#define KT_XMSS\t\t(1<<4)",
      "#define KT_ED25519\t(1<<3)",
      "#define KT_ECDSA\t(1<<2)",
      "#define KT_RSA\t\t(1<<1)",
      "#define KT_DSA\t\t(1)"
    ],
    "globals_used": [
      "int IPv4or6 = AF_UNSPEC;",
      "int ssh_port = SSH_DEFAULT_PORT;",
      "int get_cert = 0;",
      "int get_keytypes = KT_RSA|KT_ECDSA|KT_ED25519;",
      "int hash_hosts = 0;",
      "int print_sshfp = 0;",
      "int timeout = 5;",
      "int maxfd;",
      "extern char *__progname;",
      "fd_set *read_wait;",
      "size_t read_wait_nfdset;",
      "int ncon;",
      "con *fdcon;",
      "static void keyprint(con *c, struct sshkey *key);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "conloop",
          "args": [],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "conloop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "554-604",
          "snippet": "static void\nconloop(void)\n{\n\tstruct timeval seltime, now;\n\tfd_set *r, *e;\n\tcon *c;\n\tint i;\n\n\tmonotime_tv(&now);\n\tc = TAILQ_FIRST(&tq);\n\n\tif (c && (c->c_tv.tv_sec > now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec > now.tv_usec))) {\n\t\tseltime = c->c_tv;\n\t\tseltime.tv_sec -= now.tv_sec;\n\t\tseltime.tv_usec -= now.tv_usec;\n\t\tif (seltime.tv_usec < 0) {\n\t\t\tseltime.tv_usec += 1000000;\n\t\t\tseltime.tv_sec--;\n\t\t}\n\t} else\n\t\ttimerclear(&seltime);\n\n\tr = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\te = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\tmemcpy(r, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\tmemcpy(e, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\n\twhile (select(maxfd, r, NULL, e, &seltime) == -1 &&\n\t    (errno == EAGAIN || errno == EINTR || errno == EWOULDBLOCK))\n\t\t;\n\n\tfor (i = 0; i < maxfd; i++) {\n\t\tif (FD_ISSET(i, e)) {\n\t\t\terror(\"%s: exception!\", fdcon[i].c_name);\n\t\t\tconfree(i);\n\t\t} else if (FD_ISSET(i, r))\n\t\t\tconread(i);\n\t}\n\tfree(r);\n\tfree(e);\n\n\tc = TAILQ_FIRST(&tq);\n\twhile (c && (c->c_tv.tv_sec < now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec < now.tv_usec))) {\n\t\tint s = c->c_fd;\n\n\t\tc = TAILQ_NEXT(c, c_link);\n\t\tconrecycle(s);\n\t}\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "size_t read_wait_nfdset;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint maxfd;\nfd_set *read_wait;\nsize_t read_wait_nfdset;\ncon *fdcon;\n\nstatic void\nconloop(void)\n{\n\tstruct timeval seltime, now;\n\tfd_set *r, *e;\n\tcon *c;\n\tint i;\n\n\tmonotime_tv(&now);\n\tc = TAILQ_FIRST(&tq);\n\n\tif (c && (c->c_tv.tv_sec > now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec > now.tv_usec))) {\n\t\tseltime = c->c_tv;\n\t\tseltime.tv_sec -= now.tv_sec;\n\t\tseltime.tv_usec -= now.tv_usec;\n\t\tif (seltime.tv_usec < 0) {\n\t\t\tseltime.tv_usec += 1000000;\n\t\t\tseltime.tv_sec--;\n\t\t}\n\t} else\n\t\ttimerclear(&seltime);\n\n\tr = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\te = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\tmemcpy(r, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\tmemcpy(e, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\n\twhile (select(maxfd, r, NULL, e, &seltime) == -1 &&\n\t    (errno == EAGAIN || errno == EINTR || errno == EWOULDBLOCK))\n\t\t;\n\n\tfor (i = 0; i < maxfd; i++) {\n\t\tif (FD_ISSET(i, e)) {\n\t\t\terror(\"%s: exception!\", fdcon[i].c_name);\n\t\t\tconfree(i);\n\t\t} else if (FD_ISSET(i, r))\n\t\t\tconread(i);\n\t}\n\tfree(r);\n\tfree(e);\n\n\tc = TAILQ_FIRST(&tq);\n\twhile (c && (c->c_tv.tv_sec < now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec < now.tv_usec))) {\n\t\tint s = c->c_fd;\n\n\t\tc = TAILQ_NEXT(c, c_link);\n\t\tconrecycle(s);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_host",
          "args": [
            "argv[optind++]"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "do_host",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "606-621",
          "snippet": "static void\ndo_host(char *host)\n{\n\tchar *name = strnnsep(&host, \" \\t\\n\");\n\tint j;\n\n\tif (name == NULL)\n\t\treturn;\n\tfor (j = KT_MIN; j <= KT_MAX; j *= 2) {\n\t\tif (get_keytypes & j) {\n\t\t\twhile (ncon >= MAXCON)\n\t\t\t\tconloop();\n\t\t\tconalloc(name, *host ? host : name, j);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define MAXCON (maxfd - 10)",
            "#define KT_MAX\t\tKT_XMSS",
            "#define KT_MIN\t\tKT_DSA"
          ],
          "globals_used": [
            "int get_keytypes = KT_RSA|KT_ECDSA|KT_ED25519;",
            "int ncon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define MAXCON (maxfd - 10)\n#define KT_MAX\t\tKT_XMSS\n#define KT_MIN\t\tKT_DSA\n\nint get_keytypes = KT_RSA|KT_ECDSA|KT_ED25519;\nint ncon;\n\nstatic void\ndo_host(char *host)\n{\n\tchar *name = strnnsep(&host, \" \\t\\n\");\n\tint j;\n\n\tif (name == NULL)\n\t\treturn;\n\tfor (j = KT_MIN; j <= KT_MAX; j *= 2) {\n\t\tif (get_keytypes & j) {\n\t\t\twhile (ncon >= MAXCON)\n\t\t\t\tconloop();\n\t\t\tconalloc(name, *host ? host : name, j);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "line"
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "confree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "401-421",
          "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
            "#define CS_UNUSED 0\t\t/* File descriptor unused */"
          ],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_UNUSED 0\t\t/* File descriptor unused */\n\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: %s: %s\"",
            "__progname",
            "argv[j]",
            "strerror(errno)"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "623-632",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "140-146",
          "snippet": "const char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ferror",
          "args": [
            "fp"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "line"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "line",
            "'#'"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "g_strchr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/glob.c",
          "lines": "1025-1033",
          "snippet": "static Char *\ng_strchr(const Char *str, int ch)\n{\n\tdo {\n\t\tif (*str == ch)\n\t\t\treturn ((Char *)str);\n\t} while (*str++);\n\treturn (NULL);\n}",
          "includes": [
            "#include \"charclass.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"glob.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"charclass.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include <ctype.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"glob.h\"\n#include \"includes.h\"\n\nstatic Char *\ng_strchr(const Char *str, int ch)\n{\n\tdo {\n\t\tif (*str == ch)\n\t\t\treturn ((Char *)str);\n\t} while (*str++);\n\treturn (NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getline",
          "args": [
            "&line",
            "&linesize",
            "fp"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "getline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-getline.c",
          "lines": "92-96",
          "snippet": "ssize_t\ngetline(char **buf, size_t *bufsiz, FILE *fp)\n{\n\treturn getdelim(buf, bufsiz, '\\n', fp);\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include \"file.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include \"file.h\"\n#include \"includes.h\"\n\nssize_t\ngetline(char **buf, size_t *bufsiz, FILE *fp)\n{\n\treturn getdelim(buf, bufsiz, '\\n', fp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "argv[j]",
            "\"r\""
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcalloc",
          "args": [
            "read_wait_nfdset",
            "sizeof(fd_mask)"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "xcalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "52-66",
          "snippet": "void *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "howmany",
          "args": [
            "maxfd",
            "NFDBITS"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fdlim_set",
          "args": [
            "maxfd"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "fdlim_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "136-155",
          "snippet": "static int\nfdlim_set(int lim)\n{\n#if defined(HAVE_SETRLIMIT) && defined(RLIMIT_NOFILE)\n\tstruct rlimit rlfd;\n#endif\n\n\tif (lim <= 0)\n\t\treturn (-1);\n#if defined(HAVE_SETRLIMIT) && defined(RLIMIT_NOFILE)\n\tif (getrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n\trlfd.rlim_cur = lim;\n\tif (setrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n#elif defined (HAVE_SETDTABLESIZE)\n\tsetdtablesize(lim);\n#endif\n\treturn (0);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nfdlim_set(int lim)\n{\n#if defined(HAVE_SETRLIMIT) && defined(RLIMIT_NOFILE)\n\tstruct rlimit rlfd;\n#endif\n\n\tif (lim <= 0)\n\t\treturn (-1);\n#if defined(HAVE_SETRLIMIT) && defined(RLIMIT_NOFILE)\n\tif (getrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n\trlfd.rlim_cur = lim;\n\tif (setrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n#elif defined (HAVE_SETDTABLESIZE)\n\tsetdtablesize(lim);\n#endif\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdlim_get",
          "args": [
            "0"
          ],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "fdlim_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "119-134",
          "snippet": "static int\nfdlim_get(int hard)\n{\n#if defined(HAVE_GETRLIMIT) && defined(RLIMIT_NOFILE)\n\tstruct rlimit rlfd;\n\n\tif (getrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n\tif ((hard ? rlfd.rlim_max : rlfd.rlim_cur) == RLIM_INFINITY)\n\t\treturn SSH_SYSFDMAX;\n\telse\n\t\treturn hard ? rlfd.rlim_max : rlfd.rlim_cur;\n#else\n\treturn SSH_SYSFDMAX;\n#endif\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nfdlim_get(int hard)\n{\n#if defined(HAVE_GETRLIMIT) && defined(RLIMIT_NOFILE)\n\tstruct rlimit rlfd;\n\n\tif (getrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n\tif ((hard ? rlfd.rlim_max : rlfd.rlim_cur) == RLIM_INFINITY)\n\t\treturn SSH_SYSFDMAX;\n\telse\n\t\treturn hard ? rlfd.rlim_max : rlfd.rlim_cur;\n#else\n\treturn SSH_SYSFDMAX;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_init",
          "args": [
            "\"ssh-keyscan\"",
            "log_level",
            "SYSLOG_FACILITY_USER",
            "1"
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "log_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "256-336",
          "snippet": "void\nlog_init(char *av0, LogLevel level, SyslogFacility facility, int on_stderr)\n{\n#if defined(HAVE_OPENLOG_R) && defined(SYSLOG_DATA_INIT)\n\tstruct syslog_data sdata = SYSLOG_DATA_INIT;\n#endif\n\n\targv0 = av0;\n\n\tif (log_change_level(level) != 0) {\n\t\tfprintf(stderr, \"Unrecognized internal syslog level code %d\\n\",\n\t\t    (int) level);\n\t\texit(1);\n\t}\n\n\tlog_handler = NULL;\n\tlog_handler_ctx = NULL;\n\n\tlog_on_stderr = on_stderr;\n\tif (on_stderr)\n\t\treturn;\n\n\tswitch (facility) {\n\tcase SYSLOG_FACILITY_DAEMON:\n\t\tlog_facility = LOG_DAEMON;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_USER:\n\t\tlog_facility = LOG_USER;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_AUTH:\n\t\tlog_facility = LOG_AUTH;\n\t\tbreak;\n#ifdef LOG_AUTHPRIV\n\tcase SYSLOG_FACILITY_AUTHPRIV:\n\t\tlog_facility = LOG_AUTHPRIV;\n\t\tbreak;\n#endif\n\tcase SYSLOG_FACILITY_LOCAL0:\n\t\tlog_facility = LOG_LOCAL0;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL1:\n\t\tlog_facility = LOG_LOCAL1;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL2:\n\t\tlog_facility = LOG_LOCAL2;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL3:\n\t\tlog_facility = LOG_LOCAL3;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL4:\n\t\tlog_facility = LOG_LOCAL4;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL5:\n\t\tlog_facility = LOG_LOCAL5;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL6:\n\t\tlog_facility = LOG_LOCAL6;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL7:\n\t\tlog_facility = LOG_LOCAL7;\n\t\tbreak;\n\tdefault:\n\t\tfprintf(stderr,\n\t\t    \"Unrecognized internal syslog facility code %d\\n\",\n\t\t    (int) facility);\n\t\texit(1);\n\t}\n\n\t/*\n\t * If an external library (eg libwrap) attempts to use syslog\n\t * immediately after reexec, syslog may be pointing to the wrong\n\t * facility, so we force an open/close of syslog here.\n\t */\n#if defined(HAVE_OPENLOG_R) && defined(SYSLOG_DATA_INIT)\n\topenlog_r(argv0 ? argv0 : __progname, LOG_PID, log_facility, &sdata);\n\tcloselog_r(&sdata);\n#else\n\topenlog(argv0 ? argv0 : __progname, LOG_PID, log_facility);\n\tcloselog();\n#endif\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int log_on_stderr = 1;",
            "static int log_facility = LOG_AUTH;",
            "static char *argv0;",
            "static log_handler_fn *log_handler;",
            "static void *log_handler_ctx;",
            "extern char *__progname;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int log_on_stderr = 1;\nstatic int log_facility = LOG_AUTH;\nstatic char *argv0;\nstatic log_handler_fn *log_handler;\nstatic void *log_handler_ctx;\nextern char *__progname;\n\nvoid\nlog_init(char *av0, LogLevel level, SyslogFacility facility, int on_stderr)\n{\n#if defined(HAVE_OPENLOG_R) && defined(SYSLOG_DATA_INIT)\n\tstruct syslog_data sdata = SYSLOG_DATA_INIT;\n#endif\n\n\targv0 = av0;\n\n\tif (log_change_level(level) != 0) {\n\t\tfprintf(stderr, \"Unrecognized internal syslog level code %d\\n\",\n\t\t    (int) level);\n\t\texit(1);\n\t}\n\n\tlog_handler = NULL;\n\tlog_handler_ctx = NULL;\n\n\tlog_on_stderr = on_stderr;\n\tif (on_stderr)\n\t\treturn;\n\n\tswitch (facility) {\n\tcase SYSLOG_FACILITY_DAEMON:\n\t\tlog_facility = LOG_DAEMON;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_USER:\n\t\tlog_facility = LOG_USER;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_AUTH:\n\t\tlog_facility = LOG_AUTH;\n\t\tbreak;\n#ifdef LOG_AUTHPRIV\n\tcase SYSLOG_FACILITY_AUTHPRIV:\n\t\tlog_facility = LOG_AUTHPRIV;\n\t\tbreak;\n#endif\n\tcase SYSLOG_FACILITY_LOCAL0:\n\t\tlog_facility = LOG_LOCAL0;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL1:\n\t\tlog_facility = LOG_LOCAL1;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL2:\n\t\tlog_facility = LOG_LOCAL2;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL3:\n\t\tlog_facility = LOG_LOCAL3;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL4:\n\t\tlog_facility = LOG_LOCAL4;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL5:\n\t\tlog_facility = LOG_LOCAL5;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL6:\n\t\tlog_facility = LOG_LOCAL6;\n\t\tbreak;\n\tcase SYSLOG_FACILITY_LOCAL7:\n\t\tlog_facility = LOG_LOCAL7;\n\t\tbreak;\n\tdefault:\n\t\tfprintf(stderr,\n\t\t    \"Unrecognized internal syslog facility code %d\\n\",\n\t\t    (int) facility);\n\t\texit(1);\n\t}\n\n\t/*\n\t * If an external library (eg libwrap) attempts to use syslog\n\t * immediately after reexec, syslog may be pointing to the wrong\n\t * facility, so we force an open/close of syslog here.\n\t */\n#if defined(HAVE_OPENLOG_R) && defined(SYSLOG_DATA_INIT)\n\topenlog_r(argv0 ? argv0 : __progname, LOG_PID, log_facility, &sdata);\n\tcloselog_r(&sdata);\n#else\n\topenlog(argv0 ? argv0 : __progname, LOG_PID, log_facility);\n\tcloselog();\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "usage",
          "args": [],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "usage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "634-642",
          "snippet": "static void\nusage(void)\n{\n\tfprintf(stderr,\n\t    \"usage: %s [-46cDHv] [-f file] [-p port] [-T timeout] [-t type]\\n\"\n\t    \"\\t\\t   [host | addrlist namelist]\\n\",\n\t    __progname);\n\texit(1);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int timeout = 5;",
            "extern char *__progname;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint timeout = 5;\nextern char *__progname;\n\nstatic void\nusage(void)\n{\n\tfprintf(stderr,\n\t    \"usage: %s [-46cDHv] [-f file] [-p port] [-T timeout] [-t type]\\n\"\n\t    \"\\t\\t   [host | addrlist namelist]\\n\",\n\t    __progname);\n\texit(1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtok",
          "args": [
            "NULL",
            "\",\""
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshkey_type_from_name",
          "args": [
            "tname"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "sshkey_type_from_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshkey.c",
          "lines": "190-202",
          "snippet": "int\nsshkey_type_from_name(const char *name)\n{\n\tconst struct keytype *kt;\n\n\tfor (kt = keytypes; kt->type != -1; kt++) {\n\t\t/* Only allow shortname matches for plain key types */\n\t\tif ((kt->name != NULL && strcmp(name, kt->name) == 0) ||\n\t\t    (!kt->cert && strcasecmp(kt->shortname, name) == 0))\n\t\t\treturn kt->type;\n\t}\n\treturn KEY_UNSPEC;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"xmss_fast.h\"",
            "#include \"match.h\"",
            "#include \"sshkey-xmss.h\"",
            "#include \"sshkey.h\"",
            "#include \"digest.h\"",
            "#include \"cipher.h\"",
            "#include \"sshbuf.h\"",
            "#include \"misc.h\"",
            "#include \"ssherr.h\"",
            "#include \"ssh2.h\"",
            "#include <util.h>",
            "#include <resolv.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"crypto_api.h\"",
            "#include <openssl/pem.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <netinet/in.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct keytype keytypes[] = {\n\t{ \"ssh-ed25519\", \"ED25519\", NULL, KEY_ED25519, 0, 0, 0 },\n\t{ \"ssh-ed25519-cert-v01@openssh.com\", \"ED25519-CERT\", NULL,\n\t    KEY_ED25519_CERT, 0, 1, 0 },\n#ifdef WITH_XMSS\n\t{ \"ssh-xmss@openssh.com\", \"XMSS\", NULL, KEY_XMSS, 0, 0, 0 },\n\t{ \"ssh-xmss-cert-v01@openssh.com\", \"XMSS-CERT\", NULL,\n\t    KEY_XMSS_CERT, 0, 1, 0 },\n#endif /* WITH_XMSS */\n#ifdef WITH_OPENSSL\n\t{ \"ssh-rsa\", \"RSA\", NULL, KEY_RSA, 0, 0, 0 },\n\t{ \"rsa-sha2-256\", \"RSA\", NULL, KEY_RSA, 0, 0, 1 },\n\t{ \"rsa-sha2-512\", \"RSA\", NULL, KEY_RSA, 0, 0, 1 },\n\t{ \"ssh-dss\", \"DSA\", NULL, KEY_DSA, 0, 0, 0 },\n# ifdef OPENSSL_HAS_ECC\n\t{ \"ecdsa-sha2-nistp256\", \"ECDSA\", NULL,\n\t    KEY_ECDSA, NID_X9_62_prime256v1, 0, 0 },\n\t{ \"ecdsa-sha2-nistp384\", \"ECDSA\", NULL,\n\t    KEY_ECDSA, NID_secp384r1, 0, 0 },\n#  ifdef OPENSSL_HAS_NISTP521\n\t{ \"ecdsa-sha2-nistp521\", \"ECDSA\", NULL,\n\t    KEY_ECDSA, NID_secp521r1, 0, 0 },\n#  endif /* OPENSSL_HAS_NISTP521 */\n# endif /* OPENSSL_HAS_ECC */\n\t{ \"ssh-rsa-cert-v01@openssh.com\", \"RSA-CERT\", NULL,\n\t    KEY_RSA_CERT, 0, 1, 0 },\n\t{ \"rsa-sha2-256-cert-v01@openssh.com\", \"RSA-CERT\",\n\t    \"rsa-sha2-256\", KEY_RSA_CERT, 0, 1, 1 },\n\t{ \"rsa-sha2-512-cert-v01@openssh.com\", \"RSA-CERT\",\n\t    \"rsa-sha2-512\", KEY_RSA_CERT, 0, 1, 1 },\n\t{ \"ssh-dss-cert-v01@openssh.com\", \"DSA-CERT\", NULL,\n\t    KEY_DSA_CERT, 0, 1, 0 },\n# ifdef OPENSSL_HAS_ECC\n\t{ \"ecdsa-sha2-nistp256-cert-v01@openssh.com\", \"ECDSA-CERT\", NULL,\n\t    KEY_ECDSA_CERT, NID_X9_62_prime256v1, 1, 0 },\n\t{ \"ecdsa-sha2-nistp384-cert-v01@openssh.com\", \"ECDSA-CERT\", NULL,\n\t    KEY_ECDSA_CERT, NID_secp384r1, 1, 0 },\n#  ifdef OPENSSL_HAS_NISTP521\n\t{ \"ecdsa-sha2-nistp521-cert-v01@openssh.com\", \"ECDSA-CERT\", NULL,\n\t   KEY_ECDSA_CERT, NID_secp521r1, 1, 0 },\n#  endif /* OPENSSL_HAS_NISTP521 */\n# endif /* OPENSSL_HAS_ECC */\n#endif /* WITH_OPENSSL */\n\t{ NULL, NULL, NULL, -1, -1, 0, 0 }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"xmss_fast.h\"\n#include \"match.h\"\n#include \"sshkey-xmss.h\"\n#include \"sshkey.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"sshbuf.h\"\n#include \"misc.h\"\n#include \"ssherr.h\"\n#include \"ssh2.h\"\n#include <util.h>\n#include <resolv.h>\n#include <string.h>\n#include <stdio.h>\n#include <limits.h>\n#include <errno.h>\n#include \"crypto_api.h\"\n#include <openssl/pem.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <netinet/in.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const struct keytype keytypes[] = {\n\t{ \"ssh-ed25519\", \"ED25519\", NULL, KEY_ED25519, 0, 0, 0 },\n\t{ \"ssh-ed25519-cert-v01@openssh.com\", \"ED25519-CERT\", NULL,\n\t    KEY_ED25519_CERT, 0, 1, 0 },\n#ifdef WITH_XMSS\n\t{ \"ssh-xmss@openssh.com\", \"XMSS\", NULL, KEY_XMSS, 0, 0, 0 },\n\t{ \"ssh-xmss-cert-v01@openssh.com\", \"XMSS-CERT\", NULL,\n\t    KEY_XMSS_CERT, 0, 1, 0 },\n#endif /* WITH_XMSS */\n#ifdef WITH_OPENSSL\n\t{ \"ssh-rsa\", \"RSA\", NULL, KEY_RSA, 0, 0, 0 },\n\t{ \"rsa-sha2-256\", \"RSA\", NULL, KEY_RSA, 0, 0, 1 },\n\t{ \"rsa-sha2-512\", \"RSA\", NULL, KEY_RSA, 0, 0, 1 },\n\t{ \"ssh-dss\", \"DSA\", NULL, KEY_DSA, 0, 0, 0 },\n# ifdef OPENSSL_HAS_ECC\n\t{ \"ecdsa-sha2-nistp256\", \"ECDSA\", NULL,\n\t    KEY_ECDSA, NID_X9_62_prime256v1, 0, 0 },\n\t{ \"ecdsa-sha2-nistp384\", \"ECDSA\", NULL,\n\t    KEY_ECDSA, NID_secp384r1, 0, 0 },\n#  ifdef OPENSSL_HAS_NISTP521\n\t{ \"ecdsa-sha2-nistp521\", \"ECDSA\", NULL,\n\t    KEY_ECDSA, NID_secp521r1, 0, 0 },\n#  endif /* OPENSSL_HAS_NISTP521 */\n# endif /* OPENSSL_HAS_ECC */\n\t{ \"ssh-rsa-cert-v01@openssh.com\", \"RSA-CERT\", NULL,\n\t    KEY_RSA_CERT, 0, 1, 0 },\n\t{ \"rsa-sha2-256-cert-v01@openssh.com\", \"RSA-CERT\",\n\t    \"rsa-sha2-256\", KEY_RSA_CERT, 0, 1, 1 },\n\t{ \"rsa-sha2-512-cert-v01@openssh.com\", \"RSA-CERT\",\n\t    \"rsa-sha2-512\", KEY_RSA_CERT, 0, 1, 1 },\n\t{ \"ssh-dss-cert-v01@openssh.com\", \"DSA-CERT\", NULL,\n\t    KEY_DSA_CERT, 0, 1, 0 },\n# ifdef OPENSSL_HAS_ECC\n\t{ \"ecdsa-sha2-nistp256-cert-v01@openssh.com\", \"ECDSA-CERT\", NULL,\n\t    KEY_ECDSA_CERT, NID_X9_62_prime256v1, 1, 0 },\n\t{ \"ecdsa-sha2-nistp384-cert-v01@openssh.com\", \"ECDSA-CERT\", NULL,\n\t    KEY_ECDSA_CERT, NID_secp384r1, 1, 0 },\n#  ifdef OPENSSL_HAS_NISTP521\n\t{ \"ecdsa-sha2-nistp521-cert-v01@openssh.com\", \"ECDSA-CERT\", NULL,\n\t   KEY_ECDSA_CERT, NID_secp521r1, 1, 0 },\n#  endif /* OPENSSL_HAS_NISTP521 */\n# endif /* OPENSSL_HAS_ECC */\n#endif /* WITH_OPENSSL */\n\t{ NULL, NULL, NULL, -1, -1, 0, 0 }\n};\n\nint\nsshkey_type_from_name(const char *name)\n{\n\tconst struct keytype *kt;\n\n\tfor (kt = keytypes; kt->type != -1; kt++) {\n\t\t/* Only allow shortname matches for plain key types */\n\t\tif ((kt->name != NULL && strcmp(name, kt->name) == 0) ||\n\t\t    (!kt->cert && strcasecmp(kt->shortname, name) == 0))\n\t\t\treturn kt->type;\n\t}\n\treturn KEY_UNSPEC;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtok",
          "args": [
            "optarg",
            "\",\""
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "optarg",
            "\"-\""
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_maybe_null",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1550-1558",
          "snippet": "static int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Bad timeout '%s'\\n\"",
            "optarg"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convtime",
          "args": [
            "optarg"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "convtime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "406-465",
          "snippet": "long\nconvtime(const char *s)\n{\n\tlong total, secs, multiplier = 1;\n\tconst char *p;\n\tchar *endp;\n\n\terrno = 0;\n\ttotal = 0;\n\tp = s;\n\n\tif (p == NULL || *p == '\\0')\n\t\treturn -1;\n\n\twhile (*p) {\n\t\tsecs = strtol(p, &endp, 10);\n\t\tif (p == endp ||\n\t\t    (errno == ERANGE && (secs == LONG_MIN || secs == LONG_MAX)) ||\n\t\t    secs < 0)\n\t\t\treturn -1;\n\n\t\tswitch (*endp++) {\n\t\tcase '\\0':\n\t\t\tendp--;\n\t\t\tbreak;\n\t\tcase 's':\n\t\tcase 'S':\n\t\t\tbreak;\n\t\tcase 'm':\n\t\tcase 'M':\n\t\t\tmultiplier = MINUTES;\n\t\t\tbreak;\n\t\tcase 'h':\n\t\tcase 'H':\n\t\t\tmultiplier = HOURS;\n\t\t\tbreak;\n\t\tcase 'd':\n\t\tcase 'D':\n\t\t\tmultiplier = DAYS;\n\t\t\tbreak;\n\t\tcase 'w':\n\t\tcase 'W':\n\t\t\tmultiplier = WEEKS;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn -1;\n\t\t}\n\t\tif (secs >= LONG_MAX / multiplier)\n\t\t\treturn -1;\n\t\tsecs *= multiplier;\n\t\tif  (total >= LONG_MAX - secs)\n\t\t\treturn -1;\n\t\ttotal += secs;\n\t\tif (total < 0)\n\t\t\treturn -1;\n\t\tp = endp;\n\t}\n\n\treturn total;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define WEEKS\t\t(DAYS * 7)",
            "#define DAYS\t\t(HOURS * 24)",
            "#define HOURS\t\t(MINUTES * 60)",
            "#define MINUTES\t\t(SECONDS * 60)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define WEEKS\t\t(DAYS * 7)\n#define DAYS\t\t(HOURS * 24)\n#define HOURS\t\t(MINUTES * 60)\n#define MINUTES\t\t(SECONDS * 60)\n\nlong\nconvtime(const char *s)\n{\n\tlong total, secs, multiplier = 1;\n\tconst char *p;\n\tchar *endp;\n\n\terrno = 0;\n\ttotal = 0;\n\tp = s;\n\n\tif (p == NULL || *p == '\\0')\n\t\treturn -1;\n\n\twhile (*p) {\n\t\tsecs = strtol(p, &endp, 10);\n\t\tif (p == endp ||\n\t\t    (errno == ERANGE && (secs == LONG_MIN || secs == LONG_MAX)) ||\n\t\t    secs < 0)\n\t\t\treturn -1;\n\n\t\tswitch (*endp++) {\n\t\tcase '\\0':\n\t\t\tendp--;\n\t\t\tbreak;\n\t\tcase 's':\n\t\tcase 'S':\n\t\t\tbreak;\n\t\tcase 'm':\n\t\tcase 'M':\n\t\t\tmultiplier = MINUTES;\n\t\t\tbreak;\n\t\tcase 'h':\n\t\tcase 'H':\n\t\t\tmultiplier = HOURS;\n\t\t\tbreak;\n\t\tcase 'd':\n\t\tcase 'D':\n\t\t\tmultiplier = DAYS;\n\t\t\tbreak;\n\t\tcase 'w':\n\t\tcase 'W':\n\t\t\tmultiplier = WEEKS;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn -1;\n\t\t}\n\t\tif (secs >= LONG_MAX / multiplier)\n\t\t\treturn -1;\n\t\tsecs *= multiplier;\n\t\tif  (total >= LONG_MAX - secs)\n\t\t\treturn -1;\n\t\ttotal += secs;\n\t\tif (total < 0)\n\t\t\treturn -1;\n\t\tp = endp;\n\t}\n\n\treturn total;\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "sftp_server_cleanup_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-server.c",
          "lines": "1474-1483",
          "snippet": "void\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"uidswap.h\"",
            "#include \"match.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/statvfs.h>",
            "#include <sys/mount.h>",
            "# include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct passwd *pw = NULL;",
            "static char *client_addr = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"uidswap.h\"\n#include \"match.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"xmalloc.h\"\n#include <stdarg.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/statvfs.h>\n#include <sys/mount.h>\n# include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct passwd *pw = NULL;\nstatic char *client_addr = NULL;\n\nvoid\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Bad port '%s'\\n\"",
            "optarg"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a2port",
          "args": [
            "optarg"
          ],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "a2port",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "333-346",
          "snippet": "int\na2port(const char *s)\n{\n\tstruct servent *se;\n\tlong long port;\n\tconst char *errstr;\n\n\tport = strtonum(s, 0, 65535, &errstr);\n\tif (errstr == NULL)\n\t\treturn (int)port;\n\tif ((se = getservbyname(s, \"tcp\")) != NULL)\n\t\treturn ntohs(se->s_port);\n\treturn -1;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\na2port(const char *s)\n{\n\tstruct servent *se;\n\tlong long port;\n\tconst char *errstr;\n\n\tport = strtonum(s, 0, 65535, &errstr);\n\tif (errstr == NULL)\n\t\treturn (int)port;\n\tif ((se = getservbyname(s, \"tcp\")) != NULL)\n\t\treturn ntohs(se->s_port);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getopt",
          "args": [
            "argc",
            "argv",
            "\"cDHv46p:T:t:f:\""
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "getopt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/getopt_long.c",
          "lines": "489-502",
          "snippet": "int\ngetopt(int nargc, char * const *nargv, const char *options)\n{\n\n\t/*\n\t * We don't pass FLAG_PERMUTE to getopt_internal() since\n\t * the BSD getopt(3) (unlike GNU) has never done this.\n\t *\n\t * Furthermore, since many privileged programs call getopt()\n\t * before dropping privileges it makes sense to keep things\n\t * as simple (and bug-free) as possible.\n\t */\n\treturn (getopt_internal(nargc, nargv, options, NULL, NULL, 0));\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <stdarg.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <getopt.h>",
            "#include <err.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define FLAG_PERMUTE\t0x01\t/* permute non-options to the end of argv */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <stdarg.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <getopt.h>\n#include <err.h>\n#include \"includes.h\"\n\n#define FLAG_PERMUTE\t0x01\t/* permute non-options to the end of argv */\n\nint\ngetopt(int nargc, char * const *nargv, const char *options)\n{\n\n\t/*\n\t * We don't pass FLAG_PERMUTE to getopt_internal() since\n\t * the BSD getopt(3) (unlike GNU) has never done this.\n\t *\n\t * Furthermore, since many privileged programs call getopt()\n\t * before dropping privileges it makes sense to keep things\n\t * as simple (and bug-free) as possible.\n\t */\n\treturn (getopt_internal(nargc, nargv, options, NULL, NULL, 0));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sanitise_stdfd",
          "args": [],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "sanitise_stdfd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1109-1130",
          "snippet": "void\nsanitise_stdfd(void)\n{\n\tint nullfd, dupfd;\n\n\tif ((nullfd = dupfd = open(_PATH_DEVNULL, O_RDWR)) == -1) {\n\t\tfprintf(stderr, \"Couldn't open /dev/null: %s\\n\",\n\t\t    strerror(errno));\n\t\texit(1);\n\t}\n\twhile (++dupfd <= STDERR_FILENO) {\n\t\t/* Only populate closed fds. */\n\t\tif (fcntl(dupfd, F_GETFL) == -1 && errno == EBADF) {\n\t\t\tif (dup2(nullfd, dupfd) == -1) {\n\t\t\t\tfprintf(stderr, \"dup2: %s\\n\", strerror(errno));\n\t\t\t\texit(1);\n\t\t\t}\n\t\t}\n\t}\n\tif (nullfd > STDERR_FILENO)\n\t\tclose(nullfd);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsanitise_stdfd(void)\n{\n\tint nullfd, dupfd;\n\n\tif ((nullfd = dupfd = open(_PATH_DEVNULL, O_RDWR)) == -1) {\n\t\tfprintf(stderr, \"Couldn't open /dev/null: %s\\n\",\n\t\t    strerror(errno));\n\t\texit(1);\n\t}\n\twhile (++dupfd <= STDERR_FILENO) {\n\t\t/* Only populate closed fds. */\n\t\tif (fcntl(dupfd, F_GETFL) == -1 && errno == EBADF) {\n\t\t\tif (dup2(nullfd, dupfd) == -1) {\n\t\t\t\tfprintf(stderr, \"dup2: %s\\n\", strerror(errno));\n\t\t\t\texit(1);\n\t\t\t}\n\t\t}\n\t}\n\tif (nullfd > STDERR_FILENO)\n\t\tclose(nullfd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TAILQ_INIT",
          "args": [
            "&tq"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seed_rng",
          "args": [],
          "line": 658
        },
        "resolved": true,
        "details": {
          "function_name": "seed_rng",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/entropy.c",
          "lines": "247-250",
          "snippet": "void\nseed_rng(void)\n{\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"atomicio.h\"",
            "#include \"xmalloc.h\"",
            "#include \"misc.h\"",
            "#include \"ssh.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/err.h>",
            "#include <openssl/crypto.h>",
            "#include <openssl/rand.h>",
            "#include <stddef.h> /* for offsetof */",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"atomicio.h\"\n#include \"xmalloc.h\"\n#include \"misc.h\"\n#include \"ssh.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/err.h>\n#include <openssl/crypto.h>\n#include <openssl/rand.h>\n#include <stddef.h> /* for offsetof */\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nseed_rng(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_get_progname",
          "args": [
            "argv[0]"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_get_progname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "43-64",
          "snippet": "char *ssh_get_progname(char *argv0)\n{\n\tchar *p, *q;\n#ifdef HAVE___PROGNAME\n\textern char *__progname;\n\n\tp = __progname;\n#else\n\tif (argv0 == NULL)\n\t\treturn (\"unknown\");\t/* XXX */\n\tp = strrchr(argv0, '/');\n\tif (p == NULL)\n\t\tp = argv0;\n\telse\n\t\tp++;\n#endif\n\tif ((q = strdup(p)) == NULL) {\n\t\tperror(\"strdup\");\n\t\texit(1);\n\t}\n\treturn q;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *ssh_get_progname(char *argv0)\n{\n\tchar *p, *q;\n#ifdef HAVE___PROGNAME\n\textern char *__progname;\n\n\tp = __progname;\n#else\n\tif (argv0 == NULL)\n\t\treturn (\"unknown\");\t/* XXX */\n\tp = strrchr(argv0, '/');\n\tif (p == NULL)\n\t\tp = argv0;\n\telse\n\t\tp++;\n#endif\n\tif ((q = strdup(p)) == NULL) {\n\t\tperror(\"strdup\");\n\t\texit(1);\n\t}\n\treturn q;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_malloc_init",
          "args": [],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_malloc_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "29-37",
          "snippet": "void\nssh_malloc_init(void)\n{\n#if defined(__OpenBSD__)\n\textern char *malloc_options;\n\n\tmalloc_options = \"S\";\n#endif /* __OpenBSD__ */\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid\nssh_malloc_init(void)\n{\n#if defined(__OpenBSD__)\n\textern char *malloc_options;\n\n\tmalloc_options = \"S\";\n#endif /* __OpenBSD__ */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define MAXCON (maxfd - 10)\n#define MAXMAXFD 256\n#define KT_XMSS\t\t(1<<4)\n#define KT_ED25519\t(1<<3)\n#define KT_ECDSA\t(1<<2)\n#define KT_RSA\t\t(1<<1)\n#define KT_DSA\t\t(1)\n\nint IPv4or6 = AF_UNSPEC;\nint ssh_port = SSH_DEFAULT_PORT;\nint get_cert = 0;\nint get_keytypes = KT_RSA|KT_ECDSA|KT_ED25519;\nint hash_hosts = 0;\nint print_sshfp = 0;\nint timeout = 5;\nint maxfd;\nextern char *__progname;\nfd_set *read_wait;\nsize_t read_wait_nfdset;\nint ncon;\ncon *fdcon;\nstatic void keyprint(con *c, struct sshkey *key);\n\nint\nmain(int argc, char **argv)\n{\n\tint debug_flag = 0, log_level = SYSLOG_LEVEL_INFO;\n\tint opt, fopt_count = 0, j;\n\tchar *tname, *cp, *line = NULL;\n\tsize_t linesize = 0;\n\tFILE *fp;\n\n\textern int optind;\n\textern char *optarg;\n\n\tssh_malloc_init();\t/* must be called before any mallocs */\n\t__progname = ssh_get_progname(argv[0]);\n\tseed_rng();\n\tTAILQ_INIT(&tq);\n\n\t/* Ensure that fds 0, 1 and 2 are open or directed to /dev/null */\n\tsanitise_stdfd();\n\n\tif (argc <= 1)\n\t\tusage();\n\n\twhile ((opt = getopt(argc, argv, \"cDHv46p:T:t:f:\")) != -1) {\n\t\tswitch (opt) {\n\t\tcase 'H':\n\t\t\thash_hosts = 1;\n\t\t\tbreak;\n\t\tcase 'c':\n\t\t\tget_cert = 1;\n\t\t\tbreak;\n\t\tcase 'D':\n\t\t\tprint_sshfp = 1;\n\t\t\tbreak;\n\t\tcase 'p':\n\t\t\tssh_port = a2port(optarg);\n\t\t\tif (ssh_port <= 0) {\n\t\t\t\tfprintf(stderr, \"Bad port '%s'\\n\", optarg);\n\t\t\t\texit(1);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'T':\n\t\t\ttimeout = convtime(optarg);\n\t\t\tif (timeout == -1 || timeout == 0) {\n\t\t\t\tfprintf(stderr, \"Bad timeout '%s'\\n\", optarg);\n\t\t\t\tusage();\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'v':\n\t\t\tif (!debug_flag) {\n\t\t\t\tdebug_flag = 1;\n\t\t\t\tlog_level = SYSLOG_LEVEL_DEBUG1;\n\t\t\t}\n\t\t\telse if (log_level < SYSLOG_LEVEL_DEBUG3)\n\t\t\t\tlog_level++;\n\t\t\telse\n\t\t\t\tfatal(\"Too high debugging level.\");\n\t\t\tbreak;\n\t\tcase 'f':\n\t\t\tif (strcmp(optarg, \"-\") == 0)\n\t\t\t\toptarg = NULL;\n\t\t\targv[fopt_count++] = optarg;\n\t\t\tbreak;\n\t\tcase 't':\n\t\t\tget_keytypes = 0;\n\t\t\ttname = strtok(optarg, \",\");\n\t\t\twhile (tname) {\n\t\t\t\tint type = sshkey_type_from_name(tname);\n\n\t\t\t\tswitch (type) {\n\t\t\t\tcase KEY_DSA:\n\t\t\t\t\tget_keytypes |= KT_DSA;\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_ECDSA:\n\t\t\t\t\tget_keytypes |= KT_ECDSA;\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_RSA:\n\t\t\t\t\tget_keytypes |= KT_RSA;\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_ED25519:\n\t\t\t\t\tget_keytypes |= KT_ED25519;\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_XMSS:\n\t\t\t\t\tget_keytypes |= KT_XMSS;\n\t\t\t\t\tbreak;\n\t\t\t\tcase KEY_UNSPEC:\n\t\t\t\tdefault:\n\t\t\t\t\tfatal(\"Unknown key type \\\"%s\\\"\", tname);\n\t\t\t\t}\n\t\t\t\ttname = strtok(NULL, \",\");\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '4':\n\t\t\tIPv4or6 = AF_INET;\n\t\t\tbreak;\n\t\tcase '6':\n\t\t\tIPv4or6 = AF_INET6;\n\t\t\tbreak;\n\t\tcase '?':\n\t\tdefault:\n\t\t\tusage();\n\t\t}\n\t}\n\tif (optind == argc && !fopt_count)\n\t\tusage();\n\n\tlog_init(\"ssh-keyscan\", log_level, SYSLOG_FACILITY_USER, 1);\n\n\tmaxfd = fdlim_get(1);\n\tif (maxfd < 0)\n\t\tfatal(\"%s: fdlim_get: bad value\", __progname);\n\tif (maxfd > MAXMAXFD)\n\t\tmaxfd = MAXMAXFD;\n\tif (MAXCON <= 0)\n\t\tfatal(\"%s: not enough file descriptors\", __progname);\n\tif (maxfd > fdlim_get(0))\n\t\tfdlim_set(maxfd);\n\tfdcon = xcalloc(maxfd, sizeof(con));\n\n\tread_wait_nfdset = howmany(maxfd, NFDBITS);\n\tread_wait = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\n\tfor (j = 0; j < fopt_count; j++) {\n\t\tif (argv[j] == NULL)\n\t\t\tfp = stdin;\n\t\telse if ((fp = fopen(argv[j], \"r\")) == NULL)\n\t\t\tfatal(\"%s: %s: %s\", __progname, argv[j],\n\t\t\t    strerror(errno));\n\n\t\twhile (getline(&line, &linesize, fp) != -1) {\n\t\t\t/* Chomp off trailing whitespace and comments */\n\t\t\tif ((cp = strchr(line, '#')) == NULL)\n\t\t\t\tcp = line + strlen(line) - 1;\n\t\t\twhile (cp >= line) {\n\t\t\t\tif (*cp == ' ' || *cp == '\\t' ||\n\t\t\t\t    *cp == '\\n' || *cp == '#')\n\t\t\t\t\t*cp-- = '\\0';\n\t\t\t\telse\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Skip empty lines */\n\t\t\tif (*line == '\\0')\n\t\t\t\tcontinue;\n\n\t\t\tdo_host(line);\n\t\t}\n\n\t\tif (ferror(fp))\n\t\t\tfatal(\"%s: %s: %s\", __progname, argv[j],\n\t\t\t    strerror(errno));\n\n\t\tfclose(fp);\n\t}\n\tfree(line);\n\n\twhile (optind < argc)\n\t\tdo_host(argv[optind++]);\n\n\twhile (ncon > 0)\n\t\tconloop();\n\n\treturn (0);\n}"
  },
  {
    "function_name": "usage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "634-642",
    "snippet": "static void\nusage(void)\n{\n\tfprintf(stderr,\n\t    \"usage: %s [-46cDHv] [-f file] [-p port] [-T timeout] [-t type]\\n\"\n\t    \"\\t\\t   [host | addrlist namelist]\\n\",\n\t    __progname);\n\texit(1);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int timeout = 5;",
      "extern char *__progname;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "sftp_server_cleanup_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-server.c",
          "lines": "1474-1483",
          "snippet": "void\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"uidswap.h\"",
            "#include \"match.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/statvfs.h>",
            "#include <sys/mount.h>",
            "# include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct passwd *pw = NULL;",
            "static char *client_addr = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"uidswap.h\"\n#include \"match.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"xmalloc.h\"\n#include <stdarg.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/statvfs.h>\n#include <sys/mount.h>\n# include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct passwd *pw = NULL;\nstatic char *client_addr = NULL;\n\nvoid\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"usage: %s [-46cDHv] [-f file] [-p port] [-T timeout] [-t type]\\n\"\n\t    \"\\t\\t   [host | addrlist namelist]\\n\"",
            "__progname"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint timeout = 5;\nextern char *__progname;\n\nstatic void\nusage(void)\n{\n\tfprintf(stderr,\n\t    \"usage: %s [-46cDHv] [-f file] [-p port] [-T timeout] [-t type]\\n\"\n\t    \"\\t\\t   [host | addrlist namelist]\\n\",\n\t    __progname);\n\texit(1);\n}"
  },
  {
    "function_name": "fatal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "623-632",
    "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "255"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "sftp_server_cleanup_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-server.c",
          "lines": "1474-1483",
          "snippet": "void\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"uidswap.h\"",
            "#include \"match.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/statvfs.h>",
            "#include <sys/mount.h>",
            "# include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct passwd *pw = NULL;",
            "static char *client_addr = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"uidswap.h\"\n#include \"match.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"xmalloc.h\"\n#include <stdarg.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/statvfs.h>\n#include <sys/mount.h>\n# include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct passwd *pw = NULL;\nstatic char *client_addr = NULL;\n\nvoid\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_log",
          "args": [
            "SYSLOG_LEVEL_FATAL",
            "fmt",
            "args"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "do_log2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "390-398",
          "snippet": "void\ndo_log2(LogLevel level, const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(level, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndo_log2(LogLevel level, const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(level, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}"
  },
  {
    "function_name": "do_host",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "606-621",
    "snippet": "static void\ndo_host(char *host)\n{\n\tchar *name = strnnsep(&host, \" \\t\\n\");\n\tint j;\n\n\tif (name == NULL)\n\t\treturn;\n\tfor (j = KT_MIN; j <= KT_MAX; j *= 2) {\n\t\tif (get_keytypes & j) {\n\t\t\twhile (ncon >= MAXCON)\n\t\t\t\tconloop();\n\t\t\tconalloc(name, *host ? host : name, j);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define MAXCON (maxfd - 10)",
      "#define KT_MAX\t\tKT_XMSS",
      "#define KT_MIN\t\tKT_DSA"
    ],
    "globals_used": [
      "int get_keytypes = KT_RSA|KT_ECDSA|KT_ED25519;",
      "int ncon;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "conalloc",
          "args": [
            "name",
            "*host ? host : name",
            "j"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "conalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "361-399",
          "snippet": "static int\nconalloc(char *iname, char *oname, int keytype)\n{\n\tchar *namebase, *name, *namelist;\n\tint s;\n\n\tnamebase = namelist = xstrdup(iname);\n\n\tdo {\n\t\tname = xstrsep(&namelist, \",\");\n\t\tif (!name) {\n\t\t\tfree(namebase);\n\t\t\treturn (-1);\n\t\t}\n\t} while ((s = tcpconnect(name)) < 0);\n\n\tif (s >= maxfd)\n\t\tfatal(\"conalloc: fdno %d too high\", s);\n\tif (fdcon[s].c_status)\n\t\tfatal(\"conalloc: attempt to reuse fdno %d\", s);\n\n\tdebug3(\"%s: oname %s kt %d\", __func__, oname, keytype);\n\tfdcon[s].c_fd = s;\n\tfdcon[s].c_status = CS_CON;\n\tfdcon[s].c_namebase = namebase;\n\tfdcon[s].c_name = name;\n\tfdcon[s].c_namelist = namelist;\n\tfdcon[s].c_output_name = xstrdup(oname);\n\tfdcon[s].c_data = (char *) &fdcon[s].c_plen;\n\tfdcon[s].c_len = 4;\n\tfdcon[s].c_off = 0;\n\tfdcon[s].c_keytype = keytype;\n\tmonotime_tv(&fdcon[s].c_tv);\n\tfdcon[s].c_tv.tv_sec += timeout;\n\tTAILQ_INSERT_TAIL(&tq, &fdcon[s], c_link);\n\tFD_SET(s, read_wait);\n\tncon++;\n\treturn (s);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_CON 1\t\t/* Waiting to connect/read greeting */"
          ],
          "globals_used": [
            "int timeout = 5;",
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_CON 1\t\t/* Waiting to connect/read greeting */\n\nint timeout = 5;\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic int\nconalloc(char *iname, char *oname, int keytype)\n{\n\tchar *namebase, *name, *namelist;\n\tint s;\n\n\tnamebase = namelist = xstrdup(iname);\n\n\tdo {\n\t\tname = xstrsep(&namelist, \",\");\n\t\tif (!name) {\n\t\t\tfree(namebase);\n\t\t\treturn (-1);\n\t\t}\n\t} while ((s = tcpconnect(name)) < 0);\n\n\tif (s >= maxfd)\n\t\tfatal(\"conalloc: fdno %d too high\", s);\n\tif (fdcon[s].c_status)\n\t\tfatal(\"conalloc: attempt to reuse fdno %d\", s);\n\n\tdebug3(\"%s: oname %s kt %d\", __func__, oname, keytype);\n\tfdcon[s].c_fd = s;\n\tfdcon[s].c_status = CS_CON;\n\tfdcon[s].c_namebase = namebase;\n\tfdcon[s].c_name = name;\n\tfdcon[s].c_namelist = namelist;\n\tfdcon[s].c_output_name = xstrdup(oname);\n\tfdcon[s].c_data = (char *) &fdcon[s].c_plen;\n\tfdcon[s].c_len = 4;\n\tfdcon[s].c_off = 0;\n\tfdcon[s].c_keytype = keytype;\n\tmonotime_tv(&fdcon[s].c_tv);\n\tfdcon[s].c_tv.tv_sec += timeout;\n\tTAILQ_INSERT_TAIL(&tq, &fdcon[s], c_link);\n\tFD_SET(s, read_wait);\n\tncon++;\n\treturn (s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "conloop",
          "args": [],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "conloop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "554-604",
          "snippet": "static void\nconloop(void)\n{\n\tstruct timeval seltime, now;\n\tfd_set *r, *e;\n\tcon *c;\n\tint i;\n\n\tmonotime_tv(&now);\n\tc = TAILQ_FIRST(&tq);\n\n\tif (c && (c->c_tv.tv_sec > now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec > now.tv_usec))) {\n\t\tseltime = c->c_tv;\n\t\tseltime.tv_sec -= now.tv_sec;\n\t\tseltime.tv_usec -= now.tv_usec;\n\t\tif (seltime.tv_usec < 0) {\n\t\t\tseltime.tv_usec += 1000000;\n\t\t\tseltime.tv_sec--;\n\t\t}\n\t} else\n\t\ttimerclear(&seltime);\n\n\tr = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\te = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\tmemcpy(r, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\tmemcpy(e, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\n\twhile (select(maxfd, r, NULL, e, &seltime) == -1 &&\n\t    (errno == EAGAIN || errno == EINTR || errno == EWOULDBLOCK))\n\t\t;\n\n\tfor (i = 0; i < maxfd; i++) {\n\t\tif (FD_ISSET(i, e)) {\n\t\t\terror(\"%s: exception!\", fdcon[i].c_name);\n\t\t\tconfree(i);\n\t\t} else if (FD_ISSET(i, r))\n\t\t\tconread(i);\n\t}\n\tfree(r);\n\tfree(e);\n\n\tc = TAILQ_FIRST(&tq);\n\twhile (c && (c->c_tv.tv_sec < now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec < now.tv_usec))) {\n\t\tint s = c->c_fd;\n\n\t\tc = TAILQ_NEXT(c, c_link);\n\t\tconrecycle(s);\n\t}\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "size_t read_wait_nfdset;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint maxfd;\nfd_set *read_wait;\nsize_t read_wait_nfdset;\ncon *fdcon;\n\nstatic void\nconloop(void)\n{\n\tstruct timeval seltime, now;\n\tfd_set *r, *e;\n\tcon *c;\n\tint i;\n\n\tmonotime_tv(&now);\n\tc = TAILQ_FIRST(&tq);\n\n\tif (c && (c->c_tv.tv_sec > now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec > now.tv_usec))) {\n\t\tseltime = c->c_tv;\n\t\tseltime.tv_sec -= now.tv_sec;\n\t\tseltime.tv_usec -= now.tv_usec;\n\t\tif (seltime.tv_usec < 0) {\n\t\t\tseltime.tv_usec += 1000000;\n\t\t\tseltime.tv_sec--;\n\t\t}\n\t} else\n\t\ttimerclear(&seltime);\n\n\tr = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\te = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\tmemcpy(r, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\tmemcpy(e, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\n\twhile (select(maxfd, r, NULL, e, &seltime) == -1 &&\n\t    (errno == EAGAIN || errno == EINTR || errno == EWOULDBLOCK))\n\t\t;\n\n\tfor (i = 0; i < maxfd; i++) {\n\t\tif (FD_ISSET(i, e)) {\n\t\t\terror(\"%s: exception!\", fdcon[i].c_name);\n\t\t\tconfree(i);\n\t\t} else if (FD_ISSET(i, r))\n\t\t\tconread(i);\n\t}\n\tfree(r);\n\tfree(e);\n\n\tc = TAILQ_FIRST(&tq);\n\twhile (c && (c->c_tv.tv_sec < now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec < now.tv_usec))) {\n\t\tint s = c->c_fd;\n\n\t\tc = TAILQ_NEXT(c, c_link);\n\t\tconrecycle(s);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strnnsep",
          "args": [
            "&host",
            "\" \\t\\n\""
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "strnnsep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "184-193",
          "snippet": "static char *\nstrnnsep(char **stringp, char *delim)\n{\n\tchar *tok;\n\n\tdo {\n\t\ttok = xstrsep(stringp, delim);\n\t} while (tok && *tok == '\\0');\n\treturn (tok);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\nstrnnsep(char **stringp, char *delim)\n{\n\tchar *tok;\n\n\tdo {\n\t\ttok = xstrsep(stringp, delim);\n\t} while (tok && *tok == '\\0');\n\treturn (tok);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define MAXCON (maxfd - 10)\n#define KT_MAX\t\tKT_XMSS\n#define KT_MIN\t\tKT_DSA\n\nint get_keytypes = KT_RSA|KT_ECDSA|KT_ED25519;\nint ncon;\n\nstatic void\ndo_host(char *host)\n{\n\tchar *name = strnnsep(&host, \" \\t\\n\");\n\tint j;\n\n\tif (name == NULL)\n\t\treturn;\n\tfor (j = KT_MIN; j <= KT_MAX; j *= 2) {\n\t\tif (get_keytypes & j) {\n\t\t\twhile (ncon >= MAXCON)\n\t\t\t\tconloop();\n\t\t\tconalloc(name, *host ? host : name, j);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "conloop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "554-604",
    "snippet": "static void\nconloop(void)\n{\n\tstruct timeval seltime, now;\n\tfd_set *r, *e;\n\tcon *c;\n\tint i;\n\n\tmonotime_tv(&now);\n\tc = TAILQ_FIRST(&tq);\n\n\tif (c && (c->c_tv.tv_sec > now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec > now.tv_usec))) {\n\t\tseltime = c->c_tv;\n\t\tseltime.tv_sec -= now.tv_sec;\n\t\tseltime.tv_usec -= now.tv_usec;\n\t\tif (seltime.tv_usec < 0) {\n\t\t\tseltime.tv_usec += 1000000;\n\t\t\tseltime.tv_sec--;\n\t\t}\n\t} else\n\t\ttimerclear(&seltime);\n\n\tr = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\te = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\tmemcpy(r, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\tmemcpy(e, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\n\twhile (select(maxfd, r, NULL, e, &seltime) == -1 &&\n\t    (errno == EAGAIN || errno == EINTR || errno == EWOULDBLOCK))\n\t\t;\n\n\tfor (i = 0; i < maxfd; i++) {\n\t\tif (FD_ISSET(i, e)) {\n\t\t\terror(\"%s: exception!\", fdcon[i].c_name);\n\t\t\tconfree(i);\n\t\t} else if (FD_ISSET(i, r))\n\t\t\tconread(i);\n\t}\n\tfree(r);\n\tfree(e);\n\n\tc = TAILQ_FIRST(&tq);\n\twhile (c && (c->c_tv.tv_sec < now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec < now.tv_usec))) {\n\t\tint s = c->c_fd;\n\n\t\tc = TAILQ_NEXT(c, c_link);\n\t\tconrecycle(s);\n\t}\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int maxfd;",
      "fd_set *read_wait;",
      "size_t read_wait_nfdset;",
      "con *fdcon;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "conrecycle",
          "args": [
            "s"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "conrecycle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "432-441",
          "snippet": "static int\nconrecycle(int s)\n{\n\tcon *c = &fdcon[s];\n\tint ret;\n\n\tret = conalloc(c->c_namelist, c->c_output_name, c->c_keytype);\n\tconfree(s);\n\treturn (ret);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\ncon *fdcon;\n\nstatic int\nconrecycle(int s)\n{\n\tcon *c = &fdcon[s];\n\tint ret;\n\n\tret = conalloc(c->c_namelist, c->c_output_name, c->c_keytype);\n\tconfree(s);\n\treturn (ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TAILQ_NEXT",
          "args": [
            "c",
            "c_link"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TAILQ_FIRST",
          "args": [
            "&tq"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "e"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "confree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "401-421",
          "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
            "#define CS_UNUSED 0\t\t/* File descriptor unused */"
          ],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_UNUSED 0\t\t/* File descriptor unused */\n\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "conread",
          "args": [
            "i"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "conread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "519-552",
          "snippet": "static void\nconread(int s)\n{\n\tcon *c = &fdcon[s];\n\tsize_t n;\n\n\tif (c->c_status == CS_CON) {\n\t\tcongreet(s);\n\t\treturn;\n\t}\n\tn = atomicio(read, s, c->c_data + c->c_off, c->c_len - c->c_off);\n\tif (n == 0) {\n\t\terror(\"read (%s): %s\", c->c_name, strerror(errno));\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tc->c_off += n;\n\n\tif (c->c_off == c->c_len)\n\t\tswitch (c->c_status) {\n\t\tcase CS_SIZE:\n\t\t\tc->c_plen = htonl(c->c_plen);\n\t\t\tc->c_len = c->c_plen + 8 - (c->c_plen & 7);\n\t\t\tc->c_off = 0;\n\t\t\tc->c_data = xmalloc(c->c_len);\n\t\t\tc->c_status = CS_KEYS;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"conread: invalid status %d\", c->c_status);\n\t\t\tbreak;\n\t\t}\n\n\tcontouch(s);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
            "#define CS_SIZE 2\t\t/* Waiting to read initial packet size */",
            "#define CS_CON 1\t\t/* Waiting to connect/read greeting */"
          ],
          "globals_used": [
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_SIZE 2\t\t/* Waiting to read initial packet size */\n#define CS_CON 1\t\t/* Waiting to connect/read greeting */\n\ncon *fdcon;\n\nstatic void\nconread(int s)\n{\n\tcon *c = &fdcon[s];\n\tsize_t n;\n\n\tif (c->c_status == CS_CON) {\n\t\tcongreet(s);\n\t\treturn;\n\t}\n\tn = atomicio(read, s, c->c_data + c->c_off, c->c_len - c->c_off);\n\tif (n == 0) {\n\t\terror(\"read (%s): %s\", c->c_name, strerror(errno));\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tc->c_off += n;\n\n\tif (c->c_off == c->c_len)\n\t\tswitch (c->c_status) {\n\t\tcase CS_SIZE:\n\t\t\tc->c_plen = htonl(c->c_plen);\n\t\t\tc->c_len = c->c_plen + 8 - (c->c_plen & 7);\n\t\t\tc->c_off = 0;\n\t\t\tc->c_data = xmalloc(c->c_len);\n\t\t\tc->c_status = CS_KEYS;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"conread: invalid status %d\", c->c_status);\n\t\t\tbreak;\n\t\t}\n\n\tcontouch(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "FD_ISSET",
          "args": [
            "i",
            "r"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "kludge_FD_ISSET",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/kludge-fd_set.c",
          "lines": "22-24",
          "snippet": "int kludge_FD_ISSET(int n, fd_set *set) {\n\treturn FD_ISSET(n, set);\n}",
          "includes": [
            "#   include <sys/socket.h>",
            "# include <features.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/socket.h>\n# include <features.h>\n#include \"config.h\"\n\nint kludge_FD_ISSET(int n, fd_set *set) {\n\treturn FD_ISSET(n, set);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"%s: exception!\"",
            "fdcon[i].c_name"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "select",
          "args": [
            "maxfd",
            "r",
            "NULL",
            "e",
            "&seltime"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "select",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "110-122",
          "snippet": "static void select(unsigned int p[64],unsigned int q[64],const unsigned int r[64],const unsigned int s[64],unsigned int b)\n{\n  unsigned int j;\n  unsigned int t;\n  unsigned int bminus1;\n\n  bminus1 = b - 1;\n  for (j = 0;j < 64;++j) {\n    t = bminus1 & (r[j] ^ s[j]);\n    p[j] = s[j] ^ t;\n    q[j] = r[j] ^ t;\n  }\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static void select(unsigned int p[64],unsigned int q[64],const unsigned int r[64],const unsigned int s[64],unsigned int b)\n{\n  unsigned int j;\n  unsigned int t;\n  unsigned int bminus1;\n\n  bminus1 = b - 1;\n  for (j = 0;j < 64;++j) {\n    t = bminus1 & (r[j] ^ s[j]);\n    p[j] = s[j] ^ t;\n    q[j] = r[j] ^ t;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "e",
            "read_wait",
            "read_wait_nfdset * sizeof(fd_mask)"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "r",
            "read_wait",
            "read_wait_nfdset * sizeof(fd_mask)"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xcalloc",
          "args": [
            "read_wait_nfdset",
            "sizeof(fd_mask)"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "xcalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "52-66",
          "snippet": "void *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "timerclear",
          "args": [
            "&seltime"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TAILQ_FIRST",
          "args": [
            "&tq"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "monotime_tv",
          "args": [
            "&now"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "monotime_tv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1305-1313",
          "snippet": "void\nmonotime_tv(struct timeval *tv)\n{\n\tstruct timespec ts;\n\n\tmonotime_ts(&ts);\n\ttv->tv_sec = ts.tv_sec;\n\ttv->tv_usec = ts.tv_nsec / 1000;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nmonotime_tv(struct timeval *tv)\n{\n\tstruct timespec ts;\n\n\tmonotime_ts(&ts);\n\ttv->tv_sec = ts.tv_sec;\n\ttv->tv_usec = ts.tv_nsec / 1000;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint maxfd;\nfd_set *read_wait;\nsize_t read_wait_nfdset;\ncon *fdcon;\n\nstatic void\nconloop(void)\n{\n\tstruct timeval seltime, now;\n\tfd_set *r, *e;\n\tcon *c;\n\tint i;\n\n\tmonotime_tv(&now);\n\tc = TAILQ_FIRST(&tq);\n\n\tif (c && (c->c_tv.tv_sec > now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec > now.tv_usec))) {\n\t\tseltime = c->c_tv;\n\t\tseltime.tv_sec -= now.tv_sec;\n\t\tseltime.tv_usec -= now.tv_usec;\n\t\tif (seltime.tv_usec < 0) {\n\t\t\tseltime.tv_usec += 1000000;\n\t\t\tseltime.tv_sec--;\n\t\t}\n\t} else\n\t\ttimerclear(&seltime);\n\n\tr = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\te = xcalloc(read_wait_nfdset, sizeof(fd_mask));\n\tmemcpy(r, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\tmemcpy(e, read_wait, read_wait_nfdset * sizeof(fd_mask));\n\n\twhile (select(maxfd, r, NULL, e, &seltime) == -1 &&\n\t    (errno == EAGAIN || errno == EINTR || errno == EWOULDBLOCK))\n\t\t;\n\n\tfor (i = 0; i < maxfd; i++) {\n\t\tif (FD_ISSET(i, e)) {\n\t\t\terror(\"%s: exception!\", fdcon[i].c_name);\n\t\t\tconfree(i);\n\t\t} else if (FD_ISSET(i, r))\n\t\t\tconread(i);\n\t}\n\tfree(r);\n\tfree(e);\n\n\tc = TAILQ_FIRST(&tq);\n\twhile (c && (c->c_tv.tv_sec < now.tv_sec ||\n\t    (c->c_tv.tv_sec == now.tv_sec && c->c_tv.tv_usec < now.tv_usec))) {\n\t\tint s = c->c_fd;\n\n\t\tc = TAILQ_NEXT(c, c_link);\n\t\tconrecycle(s);\n\t}\n}"
  },
  {
    "function_name": "conread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "519-552",
    "snippet": "static void\nconread(int s)\n{\n\tcon *c = &fdcon[s];\n\tsize_t n;\n\n\tif (c->c_status == CS_CON) {\n\t\tcongreet(s);\n\t\treturn;\n\t}\n\tn = atomicio(read, s, c->c_data + c->c_off, c->c_len - c->c_off);\n\tif (n == 0) {\n\t\terror(\"read (%s): %s\", c->c_name, strerror(errno));\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tc->c_off += n;\n\n\tif (c->c_off == c->c_len)\n\t\tswitch (c->c_status) {\n\t\tcase CS_SIZE:\n\t\t\tc->c_plen = htonl(c->c_plen);\n\t\t\tc->c_len = c->c_plen + 8 - (c->c_plen & 7);\n\t\t\tc->c_off = 0;\n\t\t\tc->c_data = xmalloc(c->c_len);\n\t\t\tc->c_status = CS_KEYS;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"conread: invalid status %d\", c->c_status);\n\t\t\tbreak;\n\t\t}\n\n\tcontouch(s);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
      "#define CS_SIZE 2\t\t/* Waiting to read initial packet size */",
      "#define CS_CON 1\t\t/* Waiting to connect/read greeting */"
    ],
    "globals_used": [
      "con *fdcon;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "contouch",
          "args": [
            "s"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "contouch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "423-430",
          "snippet": "static void\ncontouch(int s)\n{\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tmonotime_tv(&fdcon[s].c_tv);\n\tfdcon[s].c_tv.tv_sec += timeout;\n\tTAILQ_INSERT_TAIL(&tq, &fdcon[s], c_link);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int timeout = 5;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint timeout = 5;\ncon *fdcon;\n\nstatic void\ncontouch(int s)\n{\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tmonotime_tv(&fdcon[s].c_tv);\n\tfdcon[s].c_tv.tv_sec += timeout;\n\tTAILQ_INSERT_TAIL(&tq, &fdcon[s], c_link);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"conread: invalid status %d\"",
            "c->c_status"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "623-632",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "c->c_len"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "xmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "39-50",
          "snippet": "void *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "c->c_plen"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "confree",
          "args": [
            "s"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "confree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "401-421",
          "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
            "#define CS_UNUSED 0\t\t/* File descriptor unused */"
          ],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_UNUSED 0\t\t/* File descriptor unused */\n\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"read (%s): %s\"",
            "c->c_name",
            "strerror(errno)"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "140-146",
          "snippet": "const char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomicio",
          "args": [
            "read",
            "s",
            "c->c_data + c->c_off",
            "c->c_len - c->c_off"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "atomiciov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/atomicio.c",
          "lines": "165-170",
          "snippet": "size_t\natomiciov(ssize_t (*f) (int, const struct iovec *, int), int fd,\n    const struct iovec *_iov, int iovcnt)\n{\n\treturn atomiciov6(f, fd, _iov, iovcnt, NULL, NULL);\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#  include <sys/poll.h>",
            "#include <poll.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#  include <sys/poll.h>\n#include <poll.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include \"includes.h\"\n\nsize_t\natomiciov(ssize_t (*f) (int, const struct iovec *, int), int fd,\n    const struct iovec *_iov, int iovcnt)\n{\n\treturn atomiciov6(f, fd, _iov, iovcnt, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "congreet",
          "args": [
            "s"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "congreet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "443-517",
          "snippet": "static void\ncongreet(int s)\n{\n\tint n = 0, remote_major = 0, remote_minor = 0;\n\tchar buf[256], *cp;\n\tchar remote_version[sizeof buf];\n\tsize_t bufsiz;\n\tcon *c = &fdcon[s];\n\n\t/* send client banner */\n\tn = snprintf(buf, sizeof buf, \"SSH-%d.%d-OpenSSH-keyscan\\r\\n\",\n\t    PROTOCOL_MAJOR_2, PROTOCOL_MINOR_2);\n\tif (n < 0 || (size_t)n >= sizeof(buf)) {\n\t\terror(\"snprintf: buffer too small\");\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tif (atomicio(vwrite, s, buf, n) != (size_t)n) {\n\t\terror(\"write (%s): %s\", c->c_name, strerror(errno));\n\t\tconfree(s);\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tmemset(buf, '\\0', sizeof(buf));\n\t\tbufsiz = sizeof(buf);\n\t\tcp = buf;\n\t\twhile (bufsiz-- &&\n\t\t    (n = atomicio(read, s, cp, 1)) == 1 && *cp != '\\n') {\n\t\t\tif (*cp == '\\r')\n\t\t\t\t*cp = '\\n';\n\t\t\tcp++;\n\t\t}\n\t\tif (n != 1 || strncmp(buf, \"SSH-\", 4) == 0)\n\t\t\tbreak;\n\t}\n\tif (n == 0) {\n\t\tswitch (errno) {\n\t\tcase EPIPE:\n\t\t\terror(\"%s: Connection closed by remote host\", c->c_name);\n\t\t\tbreak;\n\t\tcase ECONNREFUSED:\n\t\t\tbreak;\n\t\tdefault:\n\t\t\terror(\"read (%s): %s\", c->c_name, strerror(errno));\n\t\t\tbreak;\n\t\t}\n\t\tconrecycle(s);\n\t\treturn;\n\t}\n\tif (*cp != '\\n' && *cp != '\\r') {\n\t\terror(\"%s: bad greeting\", c->c_name);\n\t\tconfree(s);\n\t\treturn;\n\t}\n\t*cp = '\\0';\n\tif ((c->c_ssh = ssh_packet_set_connection(NULL, s, s)) == NULL)\n\t\tfatal(\"ssh_packet_set_connection failed\");\n\tssh_packet_set_timeout(c->c_ssh, timeout, 1);\n\tssh_set_app_data(c->c_ssh, c);\t/* back link */\n\tif (sscanf(buf, \"SSH-%d.%d-%[^\\n]\\n\",\n\t    &remote_major, &remote_minor, remote_version) == 3)\n\t\tc->c_ssh->compat = compat_datafellows(remote_version);\n\telse\n\t\tc->c_ssh->compat = 0;\n\tif (!ssh2_capable(remote_major, remote_minor)) {\n\t\tdebug(\"%s doesn't support ssh2\", c->c_name);\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tfprintf(stderr, \"%c %s:%d %s\\n\", print_sshfp ? ';' : '#',\n\t    c->c_name, ssh_port, chop(buf));\n\tkeygrab_ssh2(c);\n\tconfree(s);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int ssh_port = SSH_DEFAULT_PORT;",
            "int print_sshfp = 0;",
            "int timeout = 5;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint ssh_port = SSH_DEFAULT_PORT;\nint print_sshfp = 0;\nint timeout = 5;\ncon *fdcon;\n\nstatic void\ncongreet(int s)\n{\n\tint n = 0, remote_major = 0, remote_minor = 0;\n\tchar buf[256], *cp;\n\tchar remote_version[sizeof buf];\n\tsize_t bufsiz;\n\tcon *c = &fdcon[s];\n\n\t/* send client banner */\n\tn = snprintf(buf, sizeof buf, \"SSH-%d.%d-OpenSSH-keyscan\\r\\n\",\n\t    PROTOCOL_MAJOR_2, PROTOCOL_MINOR_2);\n\tif (n < 0 || (size_t)n >= sizeof(buf)) {\n\t\terror(\"snprintf: buffer too small\");\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tif (atomicio(vwrite, s, buf, n) != (size_t)n) {\n\t\terror(\"write (%s): %s\", c->c_name, strerror(errno));\n\t\tconfree(s);\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tmemset(buf, '\\0', sizeof(buf));\n\t\tbufsiz = sizeof(buf);\n\t\tcp = buf;\n\t\twhile (bufsiz-- &&\n\t\t    (n = atomicio(read, s, cp, 1)) == 1 && *cp != '\\n') {\n\t\t\tif (*cp == '\\r')\n\t\t\t\t*cp = '\\n';\n\t\t\tcp++;\n\t\t}\n\t\tif (n != 1 || strncmp(buf, \"SSH-\", 4) == 0)\n\t\t\tbreak;\n\t}\n\tif (n == 0) {\n\t\tswitch (errno) {\n\t\tcase EPIPE:\n\t\t\terror(\"%s: Connection closed by remote host\", c->c_name);\n\t\t\tbreak;\n\t\tcase ECONNREFUSED:\n\t\t\tbreak;\n\t\tdefault:\n\t\t\terror(\"read (%s): %s\", c->c_name, strerror(errno));\n\t\t\tbreak;\n\t\t}\n\t\tconrecycle(s);\n\t\treturn;\n\t}\n\tif (*cp != '\\n' && *cp != '\\r') {\n\t\terror(\"%s: bad greeting\", c->c_name);\n\t\tconfree(s);\n\t\treturn;\n\t}\n\t*cp = '\\0';\n\tif ((c->c_ssh = ssh_packet_set_connection(NULL, s, s)) == NULL)\n\t\tfatal(\"ssh_packet_set_connection failed\");\n\tssh_packet_set_timeout(c->c_ssh, timeout, 1);\n\tssh_set_app_data(c->c_ssh, c);\t/* back link */\n\tif (sscanf(buf, \"SSH-%d.%d-%[^\\n]\\n\",\n\t    &remote_major, &remote_minor, remote_version) == 3)\n\t\tc->c_ssh->compat = compat_datafellows(remote_version);\n\telse\n\t\tc->c_ssh->compat = 0;\n\tif (!ssh2_capable(remote_major, remote_minor)) {\n\t\tdebug(\"%s doesn't support ssh2\", c->c_name);\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tfprintf(stderr, \"%c %s:%d %s\\n\", print_sshfp ? ';' : '#',\n\t    c->c_name, ssh_port, chop(buf));\n\tkeygrab_ssh2(c);\n\tconfree(s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_SIZE 2\t\t/* Waiting to read initial packet size */\n#define CS_CON 1\t\t/* Waiting to connect/read greeting */\n\ncon *fdcon;\n\nstatic void\nconread(int s)\n{\n\tcon *c = &fdcon[s];\n\tsize_t n;\n\n\tif (c->c_status == CS_CON) {\n\t\tcongreet(s);\n\t\treturn;\n\t}\n\tn = atomicio(read, s, c->c_data + c->c_off, c->c_len - c->c_off);\n\tif (n == 0) {\n\t\terror(\"read (%s): %s\", c->c_name, strerror(errno));\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tc->c_off += n;\n\n\tif (c->c_off == c->c_len)\n\t\tswitch (c->c_status) {\n\t\tcase CS_SIZE:\n\t\t\tc->c_plen = htonl(c->c_plen);\n\t\t\tc->c_len = c->c_plen + 8 - (c->c_plen & 7);\n\t\t\tc->c_off = 0;\n\t\t\tc->c_data = xmalloc(c->c_len);\n\t\t\tc->c_status = CS_KEYS;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"conread: invalid status %d\", c->c_status);\n\t\t\tbreak;\n\t\t}\n\n\tcontouch(s);\n}"
  },
  {
    "function_name": "congreet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "443-517",
    "snippet": "static void\ncongreet(int s)\n{\n\tint n = 0, remote_major = 0, remote_minor = 0;\n\tchar buf[256], *cp;\n\tchar remote_version[sizeof buf];\n\tsize_t bufsiz;\n\tcon *c = &fdcon[s];\n\n\t/* send client banner */\n\tn = snprintf(buf, sizeof buf, \"SSH-%d.%d-OpenSSH-keyscan\\r\\n\",\n\t    PROTOCOL_MAJOR_2, PROTOCOL_MINOR_2);\n\tif (n < 0 || (size_t)n >= sizeof(buf)) {\n\t\terror(\"snprintf: buffer too small\");\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tif (atomicio(vwrite, s, buf, n) != (size_t)n) {\n\t\terror(\"write (%s): %s\", c->c_name, strerror(errno));\n\t\tconfree(s);\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tmemset(buf, '\\0', sizeof(buf));\n\t\tbufsiz = sizeof(buf);\n\t\tcp = buf;\n\t\twhile (bufsiz-- &&\n\t\t    (n = atomicio(read, s, cp, 1)) == 1 && *cp != '\\n') {\n\t\t\tif (*cp == '\\r')\n\t\t\t\t*cp = '\\n';\n\t\t\tcp++;\n\t\t}\n\t\tif (n != 1 || strncmp(buf, \"SSH-\", 4) == 0)\n\t\t\tbreak;\n\t}\n\tif (n == 0) {\n\t\tswitch (errno) {\n\t\tcase EPIPE:\n\t\t\terror(\"%s: Connection closed by remote host\", c->c_name);\n\t\t\tbreak;\n\t\tcase ECONNREFUSED:\n\t\t\tbreak;\n\t\tdefault:\n\t\t\terror(\"read (%s): %s\", c->c_name, strerror(errno));\n\t\t\tbreak;\n\t\t}\n\t\tconrecycle(s);\n\t\treturn;\n\t}\n\tif (*cp != '\\n' && *cp != '\\r') {\n\t\terror(\"%s: bad greeting\", c->c_name);\n\t\tconfree(s);\n\t\treturn;\n\t}\n\t*cp = '\\0';\n\tif ((c->c_ssh = ssh_packet_set_connection(NULL, s, s)) == NULL)\n\t\tfatal(\"ssh_packet_set_connection failed\");\n\tssh_packet_set_timeout(c->c_ssh, timeout, 1);\n\tssh_set_app_data(c->c_ssh, c);\t/* back link */\n\tif (sscanf(buf, \"SSH-%d.%d-%[^\\n]\\n\",\n\t    &remote_major, &remote_minor, remote_version) == 3)\n\t\tc->c_ssh->compat = compat_datafellows(remote_version);\n\telse\n\t\tc->c_ssh->compat = 0;\n\tif (!ssh2_capable(remote_major, remote_minor)) {\n\t\tdebug(\"%s doesn't support ssh2\", c->c_name);\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tfprintf(stderr, \"%c %s:%d %s\\n\", print_sshfp ? ';' : '#',\n\t    c->c_name, ssh_port, chop(buf));\n\tkeygrab_ssh2(c);\n\tconfree(s);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int ssh_port = SSH_DEFAULT_PORT;",
      "int print_sshfp = 0;",
      "int timeout = 5;",
      "con *fdcon;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "confree",
          "args": [
            "s"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "confree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "401-421",
          "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
            "#define CS_UNUSED 0\t\t/* File descriptor unused */"
          ],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_UNUSED 0\t\t/* File descriptor unused */\n\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "keygrab_ssh2",
          "args": [
            "c"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "keygrab_ssh2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "223-283",
          "snippet": "static void\nkeygrab_ssh2(con *c)\n{\n\tchar *myproposal[PROPOSAL_MAX] = { KEX_CLIENT };\n\tint r;\n\n\tswitch (c->c_keytype) {\n\tcase KT_DSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-dss-cert-v01@openssh.com\" : \"ssh-dss\";\n\t\tbreak;\n\tcase KT_RSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-rsa-cert-v01@openssh.com\" : \"ssh-rsa\";\n\t\tbreak;\n\tcase KT_ED25519:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-ed25519-cert-v01@openssh.com\" : \"ssh-ed25519\";\n\t\tbreak;\n\tcase KT_XMSS:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-xmss-cert-v01@openssh.com\" : \"ssh-xmss@openssh.com\";\n\t\tbreak;\n\tcase KT_ECDSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ecdsa-sha2-nistp256-cert-v01@openssh.com,\"\n\t\t    \"ecdsa-sha2-nistp384-cert-v01@openssh.com,\"\n\t\t    \"ecdsa-sha2-nistp521-cert-v01@openssh.com\" :\n\t\t    \"ecdsa-sha2-nistp256,\"\n\t\t    \"ecdsa-sha2-nistp384,\"\n\t\t    \"ecdsa-sha2-nistp521\";\n\t\tbreak;\n\tdefault:\n\t\tfatal(\"unknown key type %d\", c->c_keytype);\n\t\tbreak;\n\t}\n\tif ((r = kex_setup(c->c_ssh, myproposal)) != 0) {\n\t\tfree(c->c_ssh);\n\t\tfprintf(stderr, \"kex_setup: %s\\n\", ssh_err(r));\n\t\texit(1);\n\t}\n#ifdef WITH_OPENSSL\n\tc->c_ssh->kex->kex[KEX_DH_GRP1_SHA1] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP14_SHA1] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP14_SHA256] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP16_SHA512] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP18_SHA512] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GEX_SHA1] = kexgex_client;\n\tc->c_ssh->kex->kex[KEX_DH_GEX_SHA256] = kexgex_client;\n# ifdef OPENSSL_HAS_ECC\n\tc->c_ssh->kex->kex[KEX_ECDH_SHA2] = kexecdh_client;\n# endif\n#endif\n\tc->c_ssh->kex->kex[KEX_C25519_SHA256] = kexc25519_client;\n\tssh_set_verify_host_key_callback(c->c_ssh, key_print_wrapper);\n\t/*\n\t * do the key-exchange until an error occurs or until\n\t * the key_print_wrapper() callback sets c_done.\n\t */\n\tssh_dispatch_run(c->c_ssh, DISPATCH_BLOCK, &c->c_done);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define KT_XMSS\t\t(1<<4)",
            "#define KT_ED25519\t(1<<3)",
            "#define KT_ECDSA\t(1<<2)",
            "#define KT_RSA\t\t(1<<1)",
            "#define KT_DSA\t\t(1)"
          ],
          "globals_used": [
            "int get_cert = 0;",
            "static void keyprint(con *c, struct sshkey *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define KT_XMSS\t\t(1<<4)\n#define KT_ED25519\t(1<<3)\n#define KT_ECDSA\t(1<<2)\n#define KT_RSA\t\t(1<<1)\n#define KT_DSA\t\t(1)\n\nint get_cert = 0;\nstatic void keyprint(con *c, struct sshkey *key);\n\nstatic void\nkeygrab_ssh2(con *c)\n{\n\tchar *myproposal[PROPOSAL_MAX] = { KEX_CLIENT };\n\tint r;\n\n\tswitch (c->c_keytype) {\n\tcase KT_DSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-dss-cert-v01@openssh.com\" : \"ssh-dss\";\n\t\tbreak;\n\tcase KT_RSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-rsa-cert-v01@openssh.com\" : \"ssh-rsa\";\n\t\tbreak;\n\tcase KT_ED25519:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-ed25519-cert-v01@openssh.com\" : \"ssh-ed25519\";\n\t\tbreak;\n\tcase KT_XMSS:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-xmss-cert-v01@openssh.com\" : \"ssh-xmss@openssh.com\";\n\t\tbreak;\n\tcase KT_ECDSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ecdsa-sha2-nistp256-cert-v01@openssh.com,\"\n\t\t    \"ecdsa-sha2-nistp384-cert-v01@openssh.com,\"\n\t\t    \"ecdsa-sha2-nistp521-cert-v01@openssh.com\" :\n\t\t    \"ecdsa-sha2-nistp256,\"\n\t\t    \"ecdsa-sha2-nistp384,\"\n\t\t    \"ecdsa-sha2-nistp521\";\n\t\tbreak;\n\tdefault:\n\t\tfatal(\"unknown key type %d\", c->c_keytype);\n\t\tbreak;\n\t}\n\tif ((r = kex_setup(c->c_ssh, myproposal)) != 0) {\n\t\tfree(c->c_ssh);\n\t\tfprintf(stderr, \"kex_setup: %s\\n\", ssh_err(r));\n\t\texit(1);\n\t}\n#ifdef WITH_OPENSSL\n\tc->c_ssh->kex->kex[KEX_DH_GRP1_SHA1] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP14_SHA1] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP14_SHA256] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP16_SHA512] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP18_SHA512] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GEX_SHA1] = kexgex_client;\n\tc->c_ssh->kex->kex[KEX_DH_GEX_SHA256] = kexgex_client;\n# ifdef OPENSSL_HAS_ECC\n\tc->c_ssh->kex->kex[KEX_ECDH_SHA2] = kexecdh_client;\n# endif\n#endif\n\tc->c_ssh->kex->kex[KEX_C25519_SHA256] = kexc25519_client;\n\tssh_set_verify_host_key_callback(c->c_ssh, key_print_wrapper);\n\t/*\n\t * do the key-exchange until an error occurs or until\n\t * the key_print_wrapper() callback sets c_done.\n\t */\n\tssh_dispatch_run(c->c_ssh, DISPATCH_BLOCK, &c->c_done);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%c %s:%d %s\\n\"",
            "print_sshfp ? ';' : '#'",
            "c->c_name",
            "ssh_port",
            "chop(buf)"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chop",
          "args": [
            "buf"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "chop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "76-89",
          "snippet": "char *\nchop(char *s)\n{\n\tchar *t = s;\n\twhile (*t) {\n\t\tif (*t == '\\n' || *t == '\\r') {\n\t\t\t*t = '\\0';\n\t\t\treturn s;\n\t\t}\n\t\tt++;\n\t}\n\treturn s;\n\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nchop(char *s)\n{\n\tchar *t = s;\n\twhile (*t) {\n\t\tif (*t == '\\n' || *t == '\\r') {\n\t\t\t*t = '\\0';\n\t\t\treturn s;\n\t\t}\n\t\tt++;\n\t}\n\treturn s;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"%s doesn't support ssh2\"",
            "c->c_name"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh2_capable",
          "args": [
            "remote_major",
            "remote_minor"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "ssh2_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "207-221",
          "snippet": "static int\nssh2_capable(int remote_major, int remote_minor)\n{\n\tswitch (remote_major) {\n\tcase 1:\n\t\tif (remote_minor == 99)\n\t\t\treturn 1;\n\t\tbreak;\n\tcase 2:\n\t\treturn 1;\n\tdefault:\n\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nssh2_capable(int remote_major, int remote_minor)\n{\n\tswitch (remote_major) {\n\tcase 1:\n\t\tif (remote_minor == 99)\n\t\t\treturn 1;\n\t\tbreak;\n\tcase 2:\n\t\treturn 1;\n\tdefault:\n\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_datafellows",
          "args": [
            "remote_version"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "compat_datafellows",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/compat.c",
          "lines": "44-158",
          "snippet": "u_int\ncompat_datafellows(const char *version)\n{\n\tint i;\n\tstatic struct {\n\t\tchar\t*pat;\n\t\tint\tbugs;\n\t} check[] = {\n\t\t{ \"OpenSSH_2.*,\"\n\t\t  \"OpenSSH_3.0*,\"\n\t\t  \"OpenSSH_3.1*\",\tSSH_BUG_EXTEOF|SSH_OLD_FORWARD_ADDR|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_3.*\",\tSSH_OLD_FORWARD_ADDR|SSH_BUG_SIGTYPE },\n\t\t{ \"Sun_SSH_1.0*\",\tSSH_BUG_NOREKEY|SSH_BUG_EXTEOF|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_2*,\"\n\t\t  \"OpenSSH_3*,\"\n\t\t  \"OpenSSH_4*\",\t\tSSH_BUG_SIGTYPE },\n\t\t{ \"OpenSSH_5*\",\t\tSSH_NEW_OPENSSH|SSH_BUG_DYNAMIC_RPORT|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_6.6.1*\",\tSSH_NEW_OPENSSH|SSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_6.5*,\"\n\t\t  \"OpenSSH_6.6*\",\tSSH_NEW_OPENSSH|SSH_BUG_CURVE25519PAD|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_7.0*,\"\n\t\t  \"OpenSSH_7.1*,\"\n\t\t  \"OpenSSH_7.2*,\"\n\t\t  \"OpenSSH_7.3*,\"\n\t\t  \"OpenSSH_7.4*,\"\n\t\t  \"OpenSSH_7.5*,\"\n\t\t  \"OpenSSH_7.6*,\"\n\t\t  \"OpenSSH_7.7*\",\tSSH_NEW_OPENSSH|SSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH*\",\t\tSSH_NEW_OPENSSH },\n\t\t{ \"*MindTerm*\",\t\t0 },\n\t\t{ \"3.0.*\",\t\tSSH_BUG_DEBUG },\n\t\t{ \"3.0 SecureCRT*\",\tSSH_OLD_SESSIONID },\n\t\t{ \"1.7 SecureFX*\",\tSSH_OLD_SESSIONID },\n\t\t{ \"1.2.18*,\"\n\t\t  \"1.2.19*,\"\n\t\t  \"1.2.20*,\"\n\t\t  \"1.2.21*,\"\n\t\t  \"1.2.22*\",\t\tSSH_BUG_IGNOREMSG },\n\t\t{ \"1.3.2*\",\t\t/* F-Secure */\n\t\t\t\t\tSSH_BUG_IGNOREMSG },\n\t\t{ \"Cisco-1.*\",\t\tSSH_BUG_DHGEX_LARGE|\n\t\t\t\t\tSSH_BUG_HOSTKEYS },\n\t\t{ \"*SSH Compatible Server*\",\t\t\t/* Netscreen */\n\t\t\t\t\tSSH_BUG_PASSWORDPAD },\n\t\t{ \"*OSU_0*,\"\n\t\t  \"OSU_1.0*,\"\n\t\t  \"OSU_1.1*,\"\n\t\t  \"OSU_1.2*,\"\n\t\t  \"OSU_1.3*,\"\n\t\t  \"OSU_1.4*,\"\n\t\t  \"OSU_1.5alpha1*,\"\n\t\t  \"OSU_1.5alpha2*,\"\n\t\t  \"OSU_1.5alpha3*\",\tSSH_BUG_PASSWORDPAD },\n\t\t{ \"*SSH_Version_Mapper*\",\n\t\t\t\t\tSSH_BUG_SCANNER },\n\t\t{ \"PuTTY_Local:*,\"\t/* dev versions < Sep 2014 */\n\t\t  \"PuTTY-Release-0.5*,\" /* 0.50-0.57, DH-GEX in >=0.52 */\n\t\t  \"PuTTY_Release_0.5*,\"\t/* 0.58-0.59 */\n\t\t  \"PuTTY_Release_0.60*,\"\n\t\t  \"PuTTY_Release_0.61*,\"\n\t\t  \"PuTTY_Release_0.62*,\"\n\t\t  \"PuTTY_Release_0.63*,\"\n\t\t  \"PuTTY_Release_0.64*\",\n\t\t\t\t\tSSH_OLD_DHGEX },\n\t\t{ \"FuTTY*\",\t\tSSH_OLD_DHGEX }, /* Putty Fork */\n\t\t{ \"Probe-*\",\n\t\t\t\t\tSSH_BUG_PROBE },\n\t\t{ \"TeraTerm SSH*,\"\n\t\t  \"TTSSH/1.5.*,\"\n\t\t  \"TTSSH/2.1*,\"\n\t\t  \"TTSSH/2.2*,\"\n\t\t  \"TTSSH/2.3*,\"\n\t\t  \"TTSSH/2.4*,\"\n\t\t  \"TTSSH/2.5*,\"\n\t\t  \"TTSSH/2.6*,\"\n\t\t  \"TTSSH/2.70*,\"\n\t\t  \"TTSSH/2.71*,\"\n\t\t  \"TTSSH/2.72*\",\tSSH_BUG_HOSTKEYS },\n\t\t{ \"WinSCP_release_4*,\"\n\t\t  \"WinSCP_release_5.0*,\"\n\t\t  \"WinSCP_release_5.1,\"\n\t\t  \"WinSCP_release_5.1.*,\"\n\t\t  \"WinSCP_release_5.5,\"\n\t\t  \"WinSCP_release_5.5.*,\"\n\t\t  \"WinSCP_release_5.6,\"\n\t\t  \"WinSCP_release_5.6.*,\"\n\t\t  \"WinSCP_release_5.7,\"\n\t\t  \"WinSCP_release_5.7.1,\"\n\t\t  \"WinSCP_release_5.7.2,\"\n\t\t  \"WinSCP_release_5.7.3,\"\n\t\t  \"WinSCP_release_5.7.4\",\n\t\t\t\t\tSSH_OLD_DHGEX },\n\t\t{ \"ConfD-*\",\n\t\t\t\t\tSSH_BUG_UTF8TTYMODE },\n\t\t{ \"Twisted_*\",\t\t0 },\n\t\t{ \"Twisted*\",\t\tSSH_BUG_DEBUG },\n\t\t{ NULL,\t\t\t0 }\n\t};\n\n\t/* process table, return first match */\n\tfor (i = 0; check[i].pat; i++) {\n\t\tif (match_pattern_list(version, check[i].pat, 0) == 1) {\n\t\t\tdebug(\"match: %s pat %s compat 0x%08x\",\n\t\t\t    version, check[i].pat, check[i].bugs);\n\t\t\tdatafellows = check[i].bugs;\t/* XXX for now */\n\t\t\treturn check[i].bugs;\n\t\t}\n\t}\n\tdebug(\"no match: %s\", version);\n\treturn 0;\n}",
          "includes": [
            "#include \"kex.h\"",
            "#include \"match.h\"",
            "#include \"log.h\"",
            "#include \"compat.h\"",
            "#include \"packet.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdarg.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int datafellows = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kex.h\"\n#include \"match.h\"\n#include \"log.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"xmalloc.h\"\n#include <stdarg.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint datafellows = 0;\n\nu_int\ncompat_datafellows(const char *version)\n{\n\tint i;\n\tstatic struct {\n\t\tchar\t*pat;\n\t\tint\tbugs;\n\t} check[] = {\n\t\t{ \"OpenSSH_2.*,\"\n\t\t  \"OpenSSH_3.0*,\"\n\t\t  \"OpenSSH_3.1*\",\tSSH_BUG_EXTEOF|SSH_OLD_FORWARD_ADDR|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_3.*\",\tSSH_OLD_FORWARD_ADDR|SSH_BUG_SIGTYPE },\n\t\t{ \"Sun_SSH_1.0*\",\tSSH_BUG_NOREKEY|SSH_BUG_EXTEOF|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_2*,\"\n\t\t  \"OpenSSH_3*,\"\n\t\t  \"OpenSSH_4*\",\t\tSSH_BUG_SIGTYPE },\n\t\t{ \"OpenSSH_5*\",\t\tSSH_NEW_OPENSSH|SSH_BUG_DYNAMIC_RPORT|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_6.6.1*\",\tSSH_NEW_OPENSSH|SSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_6.5*,\"\n\t\t  \"OpenSSH_6.6*\",\tSSH_NEW_OPENSSH|SSH_BUG_CURVE25519PAD|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_7.0*,\"\n\t\t  \"OpenSSH_7.1*,\"\n\t\t  \"OpenSSH_7.2*,\"\n\t\t  \"OpenSSH_7.3*,\"\n\t\t  \"OpenSSH_7.4*,\"\n\t\t  \"OpenSSH_7.5*,\"\n\t\t  \"OpenSSH_7.6*,\"\n\t\t  \"OpenSSH_7.7*\",\tSSH_NEW_OPENSSH|SSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH*\",\t\tSSH_NEW_OPENSSH },\n\t\t{ \"*MindTerm*\",\t\t0 },\n\t\t{ \"3.0.*\",\t\tSSH_BUG_DEBUG },\n\t\t{ \"3.0 SecureCRT*\",\tSSH_OLD_SESSIONID },\n\t\t{ \"1.7 SecureFX*\",\tSSH_OLD_SESSIONID },\n\t\t{ \"1.2.18*,\"\n\t\t  \"1.2.19*,\"\n\t\t  \"1.2.20*,\"\n\t\t  \"1.2.21*,\"\n\t\t  \"1.2.22*\",\t\tSSH_BUG_IGNOREMSG },\n\t\t{ \"1.3.2*\",\t\t/* F-Secure */\n\t\t\t\t\tSSH_BUG_IGNOREMSG },\n\t\t{ \"Cisco-1.*\",\t\tSSH_BUG_DHGEX_LARGE|\n\t\t\t\t\tSSH_BUG_HOSTKEYS },\n\t\t{ \"*SSH Compatible Server*\",\t\t\t/* Netscreen */\n\t\t\t\t\tSSH_BUG_PASSWORDPAD },\n\t\t{ \"*OSU_0*,\"\n\t\t  \"OSU_1.0*,\"\n\t\t  \"OSU_1.1*,\"\n\t\t  \"OSU_1.2*,\"\n\t\t  \"OSU_1.3*,\"\n\t\t  \"OSU_1.4*,\"\n\t\t  \"OSU_1.5alpha1*,\"\n\t\t  \"OSU_1.5alpha2*,\"\n\t\t  \"OSU_1.5alpha3*\",\tSSH_BUG_PASSWORDPAD },\n\t\t{ \"*SSH_Version_Mapper*\",\n\t\t\t\t\tSSH_BUG_SCANNER },\n\t\t{ \"PuTTY_Local:*,\"\t/* dev versions < Sep 2014 */\n\t\t  \"PuTTY-Release-0.5*,\" /* 0.50-0.57, DH-GEX in >=0.52 */\n\t\t  \"PuTTY_Release_0.5*,\"\t/* 0.58-0.59 */\n\t\t  \"PuTTY_Release_0.60*,\"\n\t\t  \"PuTTY_Release_0.61*,\"\n\t\t  \"PuTTY_Release_0.62*,\"\n\t\t  \"PuTTY_Release_0.63*,\"\n\t\t  \"PuTTY_Release_0.64*\",\n\t\t\t\t\tSSH_OLD_DHGEX },\n\t\t{ \"FuTTY*\",\t\tSSH_OLD_DHGEX }, /* Putty Fork */\n\t\t{ \"Probe-*\",\n\t\t\t\t\tSSH_BUG_PROBE },\n\t\t{ \"TeraTerm SSH*,\"\n\t\t  \"TTSSH/1.5.*,\"\n\t\t  \"TTSSH/2.1*,\"\n\t\t  \"TTSSH/2.2*,\"\n\t\t  \"TTSSH/2.3*,\"\n\t\t  \"TTSSH/2.4*,\"\n\t\t  \"TTSSH/2.5*,\"\n\t\t  \"TTSSH/2.6*,\"\n\t\t  \"TTSSH/2.70*,\"\n\t\t  \"TTSSH/2.71*,\"\n\t\t  \"TTSSH/2.72*\",\tSSH_BUG_HOSTKEYS },\n\t\t{ \"WinSCP_release_4*,\"\n\t\t  \"WinSCP_release_5.0*,\"\n\t\t  \"WinSCP_release_5.1,\"\n\t\t  \"WinSCP_release_5.1.*,\"\n\t\t  \"WinSCP_release_5.5,\"\n\t\t  \"WinSCP_release_5.5.*,\"\n\t\t  \"WinSCP_release_5.6,\"\n\t\t  \"WinSCP_release_5.6.*,\"\n\t\t  \"WinSCP_release_5.7,\"\n\t\t  \"WinSCP_release_5.7.1,\"\n\t\t  \"WinSCP_release_5.7.2,\"\n\t\t  \"WinSCP_release_5.7.3,\"\n\t\t  \"WinSCP_release_5.7.4\",\n\t\t\t\t\tSSH_OLD_DHGEX },\n\t\t{ \"ConfD-*\",\n\t\t\t\t\tSSH_BUG_UTF8TTYMODE },\n\t\t{ \"Twisted_*\",\t\t0 },\n\t\t{ \"Twisted*\",\t\tSSH_BUG_DEBUG },\n\t\t{ NULL,\t\t\t0 }\n\t};\n\n\t/* process table, return first match */\n\tfor (i = 0; check[i].pat; i++) {\n\t\tif (match_pattern_list(version, check[i].pat, 0) == 1) {\n\t\t\tdebug(\"match: %s pat %s compat 0x%08x\",\n\t\t\t    version, check[i].pat, check[i].bugs);\n\t\t\tdatafellows = check[i].bugs;\t/* XXX for now */\n\t\t\treturn check[i].bugs;\n\t\t}\n\t}\n\tdebug(\"no match: %s\", version);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "buf",
            "\"SSH-%d.%d-%[^\\n]\\n\"",
            "&remote_major",
            "&remote_minor",
            "remote_version"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_set_app_data",
          "args": [
            "c->c_ssh",
            "c"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_set_app_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh_api.c",
          "lines": "164-168",
          "snippet": "void\nssh_set_app_data(struct ssh *ssh, void *app_data)\n{\n\tssh->app_data = app_data;\n}",
          "includes": [
            "#include <string.h>",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"myproposal.h\"",
            "#include \"version.h\"",
            "#include \"ssh2.h\"",
            "#include \"misc.h\"",
            "#include \"sshkey.h\"",
            "#include \"authfile.h\"",
            "#include \"log.h\"",
            "#include \"compat.h\"",
            "#include \"ssh_api.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int\t_ssh_exchange_banner(struct ssh *);",
            "int\t_ssh_send_banner(struct ssh *, char **);",
            "int\t_ssh_read_banner(struct ssh *, char **);",
            "int\t_ssh_order_hostkeyalgs(struct ssh *);",
            "int\t_ssh_verify_host_key(struct sshkey *, struct ssh *);",
            "struct sshkey *_ssh_host_public_key(int, int, struct ssh *);",
            "struct sshkey *_ssh_host_private_key(int, int, struct ssh *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"openbsd-compat/openssl-compat.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"myproposal.h\"\n#include \"version.h\"\n#include \"ssh2.h\"\n#include \"misc.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"log.h\"\n#include \"compat.h\"\n#include \"ssh_api.h\"\n#include \"includes.h\"\n\nint\t_ssh_exchange_banner(struct ssh *);\nint\t_ssh_send_banner(struct ssh *, char **);\nint\t_ssh_read_banner(struct ssh *, char **);\nint\t_ssh_order_hostkeyalgs(struct ssh *);\nint\t_ssh_verify_host_key(struct sshkey *, struct ssh *);\nstruct sshkey *_ssh_host_public_key(int, int, struct ssh *);\nstruct sshkey *_ssh_host_private_key(int, int, struct ssh *);\n\nvoid\nssh_set_app_data(struct ssh *ssh, void *app_data)\n{\n\tssh->app_data = app_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_packet_set_timeout",
          "args": [
            "c->c_ssh",
            "timeout",
            "1"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_packet_set_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "319-332",
          "snippet": "void\nssh_packet_set_timeout(struct ssh *ssh, int timeout, int count)\n{\n\tstruct session_state *state = ssh->state;\n\n\tif (timeout <= 0 || count <= 0) {\n\t\tstate->packet_timeout_ms = -1;\n\t\treturn;\n\t}\n\tif ((INT_MAX / 1000) / count < timeout)\n\t\tstate->packet_timeout_ms = INT_MAX;\n\telse\n\t\tstate->packet_timeout_ms = timeout * count * 1000;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_packet_set_timeout(struct ssh *ssh, int timeout, int count)\n{\n\tstruct session_state *state = ssh->state;\n\n\tif (timeout <= 0 || count <= 0) {\n\t\tstate->packet_timeout_ms = -1;\n\t\treturn;\n\t}\n\tif ((INT_MAX / 1000) / count < timeout)\n\t\tstate->packet_timeout_ms = INT_MAX;\n\telse\n\t\tstate->packet_timeout_ms = timeout * count * 1000;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"ssh_packet_set_connection failed\""
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "623-632",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_packet_set_connection",
          "args": [
            "NULL",
            "s",
            "s"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_packet_set_connection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "282-317",
          "snippet": "struct ssh *\nssh_packet_set_connection(struct ssh *ssh, int fd_in, int fd_out)\n{\n\tstruct session_state *state;\n\tconst struct sshcipher *none = cipher_by_name(\"none\");\n\tint r;\n\n\tif (none == NULL) {\n\t\terror(\"%s: cannot load cipher 'none'\", __func__);\n\t\treturn NULL;\n\t}\n\tif (ssh == NULL)\n\t\tssh = ssh_alloc_session_state();\n\tif (ssh == NULL) {\n\t\terror(\"%s: cound not allocate state\", __func__);\n\t\treturn NULL;\n\t}\n\tstate = ssh->state;\n\tstate->connection_in = fd_in;\n\tstate->connection_out = fd_out;\n\tif ((r = cipher_init(&state->send_context, none,\n\t    (const u_char *)\"\", 0, NULL, 0, CIPHER_ENCRYPT)) != 0 ||\n\t    (r = cipher_init(&state->receive_context, none,\n\t    (const u_char *)\"\", 0, NULL, 0, CIPHER_DECRYPT)) != 0) {\n\t\terror(\"%s: cipher_init failed: %s\", __func__, ssh_err(r));\n\t\tfree(ssh); /* XXX need ssh_free_session_state? */\n\t\treturn NULL;\n\t}\n\tstate->newkeys[MODE_IN] = state->newkeys[MODE_OUT] = NULL;\n\t/*\n\t * Cache the IP address of the remote connection for use in error\n\t * messages that might be generated after the connection has closed.\n\t */\n\t(void)ssh_remote_ipaddr(ssh);\n\treturn ssh;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct ssh *\nssh_packet_set_connection(struct ssh *ssh, int fd_in, int fd_out)\n{\n\tstruct session_state *state;\n\tconst struct sshcipher *none = cipher_by_name(\"none\");\n\tint r;\n\n\tif (none == NULL) {\n\t\terror(\"%s: cannot load cipher 'none'\", __func__);\n\t\treturn NULL;\n\t}\n\tif (ssh == NULL)\n\t\tssh = ssh_alloc_session_state();\n\tif (ssh == NULL) {\n\t\terror(\"%s: cound not allocate state\", __func__);\n\t\treturn NULL;\n\t}\n\tstate = ssh->state;\n\tstate->connection_in = fd_in;\n\tstate->connection_out = fd_out;\n\tif ((r = cipher_init(&state->send_context, none,\n\t    (const u_char *)\"\", 0, NULL, 0, CIPHER_ENCRYPT)) != 0 ||\n\t    (r = cipher_init(&state->receive_context, none,\n\t    (const u_char *)\"\", 0, NULL, 0, CIPHER_DECRYPT)) != 0) {\n\t\terror(\"%s: cipher_init failed: %s\", __func__, ssh_err(r));\n\t\tfree(ssh); /* XXX need ssh_free_session_state? */\n\t\treturn NULL;\n\t}\n\tstate->newkeys[MODE_IN] = state->newkeys[MODE_OUT] = NULL;\n\t/*\n\t * Cache the IP address of the remote connection for use in error\n\t * messages that might be generated after the connection has closed.\n\t */\n\t(void)ssh_remote_ipaddr(ssh);\n\treturn ssh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"%s: bad greeting\"",
            "c->c_name"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "conrecycle",
          "args": [
            "s"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "conrecycle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "432-441",
          "snippet": "static int\nconrecycle(int s)\n{\n\tcon *c = &fdcon[s];\n\tint ret;\n\n\tret = conalloc(c->c_namelist, c->c_output_name, c->c_keytype);\n\tconfree(s);\n\treturn (ret);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\ncon *fdcon;\n\nstatic int\nconrecycle(int s)\n{\n\tcon *c = &fdcon[s];\n\tint ret;\n\n\tret = conalloc(c->c_namelist, c->c_output_name, c->c_keytype);\n\tconfree(s);\n\treturn (ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "140-146",
          "snippet": "const char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "buf",
            "\"SSH-\"",
            "4"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "g_strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/glob.c",
          "lines": "422-435",
          "snippet": "static int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}",
          "includes": [
            "#include \"charclass.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"glob.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"charclass.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include <ctype.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"glob.h\"\n#include \"includes.h\"\n\nstatic int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomicio",
          "args": [
            "read",
            "s",
            "cp",
            "1"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "atomiciov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/atomicio.c",
          "lines": "165-170",
          "snippet": "size_t\natomiciov(ssize_t (*f) (int, const struct iovec *, int), int fd,\n    const struct iovec *_iov, int iovcnt)\n{\n\treturn atomiciov6(f, fd, _iov, iovcnt, NULL, NULL);\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#  include <sys/poll.h>",
            "#include <poll.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#  include <sys/poll.h>\n#include <poll.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include \"includes.h\"\n\nsize_t\natomiciov(ssize_t (*f) (int, const struct iovec *, int), int fd,\n    const struct iovec *_iov, int iovcnt)\n{\n\treturn atomiciov6(f, fd, _iov, iovcnt, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf",
            "'\\0'",
            "sizeof(buf)"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof buf",
            "\"SSH-%d.%d-OpenSSH-keyscan\\r\\n\"",
            "PROTOCOL_MAJOR_2",
            "PROTOCOL_MINOR_2"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-snprintf.c",
          "lines": "869-879",
          "snippet": "int\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nint\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint ssh_port = SSH_DEFAULT_PORT;\nint print_sshfp = 0;\nint timeout = 5;\ncon *fdcon;\n\nstatic void\ncongreet(int s)\n{\n\tint n = 0, remote_major = 0, remote_minor = 0;\n\tchar buf[256], *cp;\n\tchar remote_version[sizeof buf];\n\tsize_t bufsiz;\n\tcon *c = &fdcon[s];\n\n\t/* send client banner */\n\tn = snprintf(buf, sizeof buf, \"SSH-%d.%d-OpenSSH-keyscan\\r\\n\",\n\t    PROTOCOL_MAJOR_2, PROTOCOL_MINOR_2);\n\tif (n < 0 || (size_t)n >= sizeof(buf)) {\n\t\terror(\"snprintf: buffer too small\");\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tif (atomicio(vwrite, s, buf, n) != (size_t)n) {\n\t\terror(\"write (%s): %s\", c->c_name, strerror(errno));\n\t\tconfree(s);\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tmemset(buf, '\\0', sizeof(buf));\n\t\tbufsiz = sizeof(buf);\n\t\tcp = buf;\n\t\twhile (bufsiz-- &&\n\t\t    (n = atomicio(read, s, cp, 1)) == 1 && *cp != '\\n') {\n\t\t\tif (*cp == '\\r')\n\t\t\t\t*cp = '\\n';\n\t\t\tcp++;\n\t\t}\n\t\tif (n != 1 || strncmp(buf, \"SSH-\", 4) == 0)\n\t\t\tbreak;\n\t}\n\tif (n == 0) {\n\t\tswitch (errno) {\n\t\tcase EPIPE:\n\t\t\terror(\"%s: Connection closed by remote host\", c->c_name);\n\t\t\tbreak;\n\t\tcase ECONNREFUSED:\n\t\t\tbreak;\n\t\tdefault:\n\t\t\terror(\"read (%s): %s\", c->c_name, strerror(errno));\n\t\t\tbreak;\n\t\t}\n\t\tconrecycle(s);\n\t\treturn;\n\t}\n\tif (*cp != '\\n' && *cp != '\\r') {\n\t\terror(\"%s: bad greeting\", c->c_name);\n\t\tconfree(s);\n\t\treturn;\n\t}\n\t*cp = '\\0';\n\tif ((c->c_ssh = ssh_packet_set_connection(NULL, s, s)) == NULL)\n\t\tfatal(\"ssh_packet_set_connection failed\");\n\tssh_packet_set_timeout(c->c_ssh, timeout, 1);\n\tssh_set_app_data(c->c_ssh, c);\t/* back link */\n\tif (sscanf(buf, \"SSH-%d.%d-%[^\\n]\\n\",\n\t    &remote_major, &remote_minor, remote_version) == 3)\n\t\tc->c_ssh->compat = compat_datafellows(remote_version);\n\telse\n\t\tc->c_ssh->compat = 0;\n\tif (!ssh2_capable(remote_major, remote_minor)) {\n\t\tdebug(\"%s doesn't support ssh2\", c->c_name);\n\t\tconfree(s);\n\t\treturn;\n\t}\n\tfprintf(stderr, \"%c %s:%d %s\\n\", print_sshfp ? ';' : '#',\n\t    c->c_name, ssh_port, chop(buf));\n\tkeygrab_ssh2(c);\n\tconfree(s);\n}"
  },
  {
    "function_name": "conrecycle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "432-441",
    "snippet": "static int\nconrecycle(int s)\n{\n\tcon *c = &fdcon[s];\n\tint ret;\n\n\tret = conalloc(c->c_namelist, c->c_output_name, c->c_keytype);\n\tconfree(s);\n\treturn (ret);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "con *fdcon;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "confree",
          "args": [
            "s"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "confree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "401-421",
          "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
            "#define CS_UNUSED 0\t\t/* File descriptor unused */"
          ],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_UNUSED 0\t\t/* File descriptor unused */\n\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "conalloc",
          "args": [
            "c->c_namelist",
            "c->c_output_name",
            "c->c_keytype"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "conalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "361-399",
          "snippet": "static int\nconalloc(char *iname, char *oname, int keytype)\n{\n\tchar *namebase, *name, *namelist;\n\tint s;\n\n\tnamebase = namelist = xstrdup(iname);\n\n\tdo {\n\t\tname = xstrsep(&namelist, \",\");\n\t\tif (!name) {\n\t\t\tfree(namebase);\n\t\t\treturn (-1);\n\t\t}\n\t} while ((s = tcpconnect(name)) < 0);\n\n\tif (s >= maxfd)\n\t\tfatal(\"conalloc: fdno %d too high\", s);\n\tif (fdcon[s].c_status)\n\t\tfatal(\"conalloc: attempt to reuse fdno %d\", s);\n\n\tdebug3(\"%s: oname %s kt %d\", __func__, oname, keytype);\n\tfdcon[s].c_fd = s;\n\tfdcon[s].c_status = CS_CON;\n\tfdcon[s].c_namebase = namebase;\n\tfdcon[s].c_name = name;\n\tfdcon[s].c_namelist = namelist;\n\tfdcon[s].c_output_name = xstrdup(oname);\n\tfdcon[s].c_data = (char *) &fdcon[s].c_plen;\n\tfdcon[s].c_len = 4;\n\tfdcon[s].c_off = 0;\n\tfdcon[s].c_keytype = keytype;\n\tmonotime_tv(&fdcon[s].c_tv);\n\tfdcon[s].c_tv.tv_sec += timeout;\n\tTAILQ_INSERT_TAIL(&tq, &fdcon[s], c_link);\n\tFD_SET(s, read_wait);\n\tncon++;\n\treturn (s);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_CON 1\t\t/* Waiting to connect/read greeting */"
          ],
          "globals_used": [
            "int timeout = 5;",
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_CON 1\t\t/* Waiting to connect/read greeting */\n\nint timeout = 5;\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic int\nconalloc(char *iname, char *oname, int keytype)\n{\n\tchar *namebase, *name, *namelist;\n\tint s;\n\n\tnamebase = namelist = xstrdup(iname);\n\n\tdo {\n\t\tname = xstrsep(&namelist, \",\");\n\t\tif (!name) {\n\t\t\tfree(namebase);\n\t\t\treturn (-1);\n\t\t}\n\t} while ((s = tcpconnect(name)) < 0);\n\n\tif (s >= maxfd)\n\t\tfatal(\"conalloc: fdno %d too high\", s);\n\tif (fdcon[s].c_status)\n\t\tfatal(\"conalloc: attempt to reuse fdno %d\", s);\n\n\tdebug3(\"%s: oname %s kt %d\", __func__, oname, keytype);\n\tfdcon[s].c_fd = s;\n\tfdcon[s].c_status = CS_CON;\n\tfdcon[s].c_namebase = namebase;\n\tfdcon[s].c_name = name;\n\tfdcon[s].c_namelist = namelist;\n\tfdcon[s].c_output_name = xstrdup(oname);\n\tfdcon[s].c_data = (char *) &fdcon[s].c_plen;\n\tfdcon[s].c_len = 4;\n\tfdcon[s].c_off = 0;\n\tfdcon[s].c_keytype = keytype;\n\tmonotime_tv(&fdcon[s].c_tv);\n\tfdcon[s].c_tv.tv_sec += timeout;\n\tTAILQ_INSERT_TAIL(&tq, &fdcon[s], c_link);\n\tFD_SET(s, read_wait);\n\tncon++;\n\treturn (s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\ncon *fdcon;\n\nstatic int\nconrecycle(int s)\n{\n\tcon *c = &fdcon[s];\n\tint ret;\n\n\tret = conalloc(c->c_namelist, c->c_output_name, c->c_keytype);\n\tconfree(s);\n\treturn (ret);\n}"
  },
  {
    "function_name": "contouch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "423-430",
    "snippet": "static void\ncontouch(int s)\n{\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tmonotime_tv(&fdcon[s].c_tv);\n\tfdcon[s].c_tv.tv_sec += timeout;\n\tTAILQ_INSERT_TAIL(&tq, &fdcon[s], c_link);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int timeout = 5;",
      "con *fdcon;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "TAILQ_INSERT_TAIL",
          "args": [
            "&tq",
            "&fdcon[s]",
            "c_link"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "monotime_tv",
          "args": [
            "&fdcon[s].c_tv"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "monotime_tv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1305-1313",
          "snippet": "void\nmonotime_tv(struct timeval *tv)\n{\n\tstruct timespec ts;\n\n\tmonotime_ts(&ts);\n\ttv->tv_sec = ts.tv_sec;\n\ttv->tv_usec = ts.tv_nsec / 1000;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nmonotime_tv(struct timeval *tv)\n{\n\tstruct timespec ts;\n\n\tmonotime_ts(&ts);\n\ttv->tv_sec = ts.tv_sec;\n\ttv->tv_usec = ts.tv_nsec / 1000;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TAILQ_REMOVE",
          "args": [
            "&tq",
            "&fdcon[s]",
            "c_link"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint timeout = 5;\ncon *fdcon;\n\nstatic void\ncontouch(int s)\n{\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tmonotime_tv(&fdcon[s].c_tv);\n\tfdcon[s].c_tv.tv_sec += timeout;\n\tTAILQ_INSERT_TAIL(&tq, &fdcon[s], c_link);\n}"
  },
  {
    "function_name": "confree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "401-421",
    "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
      "#define CS_UNUSED 0\t\t/* File descriptor unused */"
    ],
    "globals_used": [
      "int maxfd;",
      "fd_set *read_wait;",
      "int ncon;",
      "con *fdcon;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "FD_CLR",
          "args": [
            "s",
            "read_wait"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TAILQ_REMOVE",
          "args": [
            "&tq",
            "&fdcon[s]",
            "c_link"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "s"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_close_authentication_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/authfd.c",
          "lines": "171-176",
          "snippet": "void\nssh_close_authentication_socket(int sock)\n{\n\tif (getenv(SSH_AUTHSOCKET_ENV_NAME))\n\t\tclose(sock);\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"compat.h\"",
            "#include \"cipher.h\"",
            "#include \"authfd.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <sys/socket.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"compat.h\"\n#include \"cipher.h\"\n#include \"authfd.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/socket.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_close_authentication_socket(int sock)\n{\n\tif (getenv(SSH_AUTHSOCKET_ENV_NAME))\n\t\tclose(sock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "fdcon[s].c_ssh"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "confree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "401-421",
          "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ssh_packet_close",
          "args": [
            "fdcon[s].c_ssh"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_packet_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "646-650",
          "snippet": "void\nssh_packet_close(struct ssh *ssh)\n{\n\tssh_packet_close_internal(ssh, 1);\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_packet_close(struct ssh *ssh)\n{\n\tssh_packet_close_internal(ssh, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"confree: attempt to free bad fdno %d\"",
            "s"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "623-632",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_UNUSED 0\t\t/* File descriptor unused */\n\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}"
  },
  {
    "function_name": "conalloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "361-399",
    "snippet": "static int\nconalloc(char *iname, char *oname, int keytype)\n{\n\tchar *namebase, *name, *namelist;\n\tint s;\n\n\tnamebase = namelist = xstrdup(iname);\n\n\tdo {\n\t\tname = xstrsep(&namelist, \",\");\n\t\tif (!name) {\n\t\t\tfree(namebase);\n\t\t\treturn (-1);\n\t\t}\n\t} while ((s = tcpconnect(name)) < 0);\n\n\tif (s >= maxfd)\n\t\tfatal(\"conalloc: fdno %d too high\", s);\n\tif (fdcon[s].c_status)\n\t\tfatal(\"conalloc: attempt to reuse fdno %d\", s);\n\n\tdebug3(\"%s: oname %s kt %d\", __func__, oname, keytype);\n\tfdcon[s].c_fd = s;\n\tfdcon[s].c_status = CS_CON;\n\tfdcon[s].c_namebase = namebase;\n\tfdcon[s].c_name = name;\n\tfdcon[s].c_namelist = namelist;\n\tfdcon[s].c_output_name = xstrdup(oname);\n\tfdcon[s].c_data = (char *) &fdcon[s].c_plen;\n\tfdcon[s].c_len = 4;\n\tfdcon[s].c_off = 0;\n\tfdcon[s].c_keytype = keytype;\n\tmonotime_tv(&fdcon[s].c_tv);\n\tfdcon[s].c_tv.tv_sec += timeout;\n\tTAILQ_INSERT_TAIL(&tq, &fdcon[s], c_link);\n\tFD_SET(s, read_wait);\n\tncon++;\n\treturn (s);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define CS_CON 1\t\t/* Waiting to connect/read greeting */"
    ],
    "globals_used": [
      "int timeout = 5;",
      "int maxfd;",
      "fd_set *read_wait;",
      "int ncon;",
      "con *fdcon;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "FD_SET",
          "args": [
            "s",
            "read_wait"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "kludge_FD_SET",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/kludge-fd_set.c",
          "lines": "19-21",
          "snippet": "void kludge_FD_SET(int n, fd_set *set) {\n\tFD_SET(n, set);\n}",
          "includes": [
            "#   include <sys/socket.h>",
            "# include <features.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/socket.h>\n# include <features.h>\n#include \"config.h\"\n\nvoid kludge_FD_SET(int n, fd_set *set) {\n\tFD_SET(n, set);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TAILQ_INSERT_TAIL",
          "args": [
            "&tq",
            "&fdcon[s]",
            "c_link"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "monotime_tv",
          "args": [
            "&fdcon[s].c_tv"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "monotime_tv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1305-1313",
          "snippet": "void\nmonotime_tv(struct timeval *tv)\n{\n\tstruct timespec ts;\n\n\tmonotime_ts(&ts);\n\ttv->tv_sec = ts.tv_sec;\n\ttv->tv_usec = ts.tv_nsec / 1000;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nmonotime_tv(struct timeval *tv)\n{\n\tstruct timespec ts;\n\n\tmonotime_ts(&ts);\n\ttv->tv_sec = ts.tv_sec;\n\ttv->tv_usec = ts.tv_nsec / 1000;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "oname"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "xstrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "92-102",
          "snippet": "char *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nchar *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"%s: oname %s kt %d\"",
            "__func__",
            "oname",
            "keytype"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"conalloc: attempt to reuse fdno %d\"",
            "s"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "623-632",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tcpconnect",
          "args": [
            "name"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "tcpconnect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "326-359",
          "snippet": "static int\ntcpconnect(char *host)\n{\n\tstruct addrinfo hints, *ai, *aitop;\n\tchar strport[NI_MAXSERV];\n\tint gaierr, s = -1;\n\n\tsnprintf(strport, sizeof strport, \"%d\", ssh_port);\n\tmemset(&hints, 0, sizeof(hints));\n\thints.ai_family = IPv4or6;\n\thints.ai_socktype = SOCK_STREAM;\n\tif ((gaierr = getaddrinfo(host, strport, &hints, &aitop)) != 0) {\n\t\terror(\"getaddrinfo %s: %s\", host, ssh_gai_strerror(gaierr));\n\t\treturn -1;\n\t}\n\tfor (ai = aitop; ai; ai = ai->ai_next) {\n\t\ts = socket(ai->ai_family, ai->ai_socktype, ai->ai_protocol);\n\t\tif (s < 0) {\n\t\t\terror(\"socket: %s\", strerror(errno));\n\t\t\tcontinue;\n\t\t}\n\t\tif (set_nonblock(s) == -1)\n\t\t\tfatal(\"%s: set_nonblock(%d)\", __func__, s);\n\t\tif (connect(s, ai->ai_addr, ai->ai_addrlen) < 0 &&\n\t\t    errno != EINPROGRESS)\n\t\t\terror(\"connect (`%s'): %s\", host, strerror(errno));\n\t\telse\n\t\t\tbreak;\n\t\tclose(s);\n\t\ts = -1;\n\t}\n\tfreeaddrinfo(aitop);\n\treturn s;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int IPv4or6 = AF_UNSPEC;",
            "int ssh_port = SSH_DEFAULT_PORT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint IPv4or6 = AF_UNSPEC;\nint ssh_port = SSH_DEFAULT_PORT;\n\nstatic int\ntcpconnect(char *host)\n{\n\tstruct addrinfo hints, *ai, *aitop;\n\tchar strport[NI_MAXSERV];\n\tint gaierr, s = -1;\n\n\tsnprintf(strport, sizeof strport, \"%d\", ssh_port);\n\tmemset(&hints, 0, sizeof(hints));\n\thints.ai_family = IPv4or6;\n\thints.ai_socktype = SOCK_STREAM;\n\tif ((gaierr = getaddrinfo(host, strport, &hints, &aitop)) != 0) {\n\t\terror(\"getaddrinfo %s: %s\", host, ssh_gai_strerror(gaierr));\n\t\treturn -1;\n\t}\n\tfor (ai = aitop; ai; ai = ai->ai_next) {\n\t\ts = socket(ai->ai_family, ai->ai_socktype, ai->ai_protocol);\n\t\tif (s < 0) {\n\t\t\terror(\"socket: %s\", strerror(errno));\n\t\t\tcontinue;\n\t\t}\n\t\tif (set_nonblock(s) == -1)\n\t\t\tfatal(\"%s: set_nonblock(%d)\", __func__, s);\n\t\tif (connect(s, ai->ai_addr, ai->ai_addrlen) < 0 &&\n\t\t    errno != EINPROGRESS)\n\t\t\terror(\"connect (`%s'): %s\", host, strerror(errno));\n\t\telse\n\t\t\tbreak;\n\t\tclose(s);\n\t\ts = -1;\n\t}\n\tfreeaddrinfo(aitop);\n\treturn s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "namebase"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "confree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "401-421",
          "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
            "#define CS_UNUSED 0\t\t/* File descriptor unused */"
          ],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_UNUSED 0\t\t/* File descriptor unused */\n\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrsep",
          "args": [
            "&namelist",
            "\",\""
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "xstrsep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "162-178",
          "snippet": "static char *\nxstrsep(char **str, const char *delim)\n{\n\tchar *s, *e;\n\n\tif (!**str)\n\t\treturn (NULL);\n\n\ts = *str;\n\te = s + strcspn(s, delim);\n\n\tif (*e != '\\0')\n\t\t*e++ = '\\0';\n\t*str = e;\n\n\treturn (s);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\nxstrsep(char **str, const char *delim)\n{\n\tchar *s, *e;\n\n\tif (!**str)\n\t\treturn (NULL);\n\n\ts = *str;\n\te = s + strcspn(s, delim);\n\n\tif (*e != '\\0')\n\t\t*e++ = '\\0';\n\t*str = e;\n\n\treturn (s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_CON 1\t\t/* Waiting to connect/read greeting */\n\nint timeout = 5;\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic int\nconalloc(char *iname, char *oname, int keytype)\n{\n\tchar *namebase, *name, *namelist;\n\tint s;\n\n\tnamebase = namelist = xstrdup(iname);\n\n\tdo {\n\t\tname = xstrsep(&namelist, \",\");\n\t\tif (!name) {\n\t\t\tfree(namebase);\n\t\t\treturn (-1);\n\t\t}\n\t} while ((s = tcpconnect(name)) < 0);\n\n\tif (s >= maxfd)\n\t\tfatal(\"conalloc: fdno %d too high\", s);\n\tif (fdcon[s].c_status)\n\t\tfatal(\"conalloc: attempt to reuse fdno %d\", s);\n\n\tdebug3(\"%s: oname %s kt %d\", __func__, oname, keytype);\n\tfdcon[s].c_fd = s;\n\tfdcon[s].c_status = CS_CON;\n\tfdcon[s].c_namebase = namebase;\n\tfdcon[s].c_name = name;\n\tfdcon[s].c_namelist = namelist;\n\tfdcon[s].c_output_name = xstrdup(oname);\n\tfdcon[s].c_data = (char *) &fdcon[s].c_plen;\n\tfdcon[s].c_len = 4;\n\tfdcon[s].c_off = 0;\n\tfdcon[s].c_keytype = keytype;\n\tmonotime_tv(&fdcon[s].c_tv);\n\tfdcon[s].c_tv.tv_sec += timeout;\n\tTAILQ_INSERT_TAIL(&tq, &fdcon[s], c_link);\n\tFD_SET(s, read_wait);\n\tncon++;\n\treturn (s);\n}"
  },
  {
    "function_name": "tcpconnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "326-359",
    "snippet": "static int\ntcpconnect(char *host)\n{\n\tstruct addrinfo hints, *ai, *aitop;\n\tchar strport[NI_MAXSERV];\n\tint gaierr, s = -1;\n\n\tsnprintf(strport, sizeof strport, \"%d\", ssh_port);\n\tmemset(&hints, 0, sizeof(hints));\n\thints.ai_family = IPv4or6;\n\thints.ai_socktype = SOCK_STREAM;\n\tif ((gaierr = getaddrinfo(host, strport, &hints, &aitop)) != 0) {\n\t\terror(\"getaddrinfo %s: %s\", host, ssh_gai_strerror(gaierr));\n\t\treturn -1;\n\t}\n\tfor (ai = aitop; ai; ai = ai->ai_next) {\n\t\ts = socket(ai->ai_family, ai->ai_socktype, ai->ai_protocol);\n\t\tif (s < 0) {\n\t\t\terror(\"socket: %s\", strerror(errno));\n\t\t\tcontinue;\n\t\t}\n\t\tif (set_nonblock(s) == -1)\n\t\t\tfatal(\"%s: set_nonblock(%d)\", __func__, s);\n\t\tif (connect(s, ai->ai_addr, ai->ai_addrlen) < 0 &&\n\t\t    errno != EINPROGRESS)\n\t\t\terror(\"connect (`%s'): %s\", host, strerror(errno));\n\t\telse\n\t\t\tbreak;\n\t\tclose(s);\n\t\ts = -1;\n\t}\n\tfreeaddrinfo(aitop);\n\treturn s;\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int IPv4or6 = AF_UNSPEC;",
      "int ssh_port = SSH_DEFAULT_PORT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "freeaddrinfo",
          "args": [
            "aitop"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "freeaddrinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fake-rfc2553.c",
          "lines": "109-119",
          "snippet": "void\nfreeaddrinfo(struct addrinfo *ai)\n{\n\tstruct addrinfo *next;\n\n\tfor(; ai != NULL;) {\n\t\tnext = ai->ai_next;\n\t\tfree(ai);\n\t\tai = next;\n\t}\n}",
          "includes": [
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nvoid\nfreeaddrinfo(struct addrinfo *ai)\n{\n\tstruct addrinfo *next;\n\n\tfor(; ai != NULL;) {\n\t\tnext = ai->ai_next;\n\t\tfree(ai);\n\t\tai = next;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "s"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_close_authentication_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/authfd.c",
          "lines": "171-176",
          "snippet": "void\nssh_close_authentication_socket(int sock)\n{\n\tif (getenv(SSH_AUTHSOCKET_ENV_NAME))\n\t\tclose(sock);\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"compat.h\"",
            "#include \"cipher.h\"",
            "#include \"authfd.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <sys/socket.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"compat.h\"\n#include \"cipher.h\"\n#include \"authfd.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/socket.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_close_authentication_socket(int sock)\n{\n\tif (getenv(SSH_AUTHSOCKET_ENV_NAME))\n\t\tclose(sock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"connect (`%s'): %s\"",
            "host",
            "strerror(errno)"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "140-146",
          "snippet": "const char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "s",
            "ai->ai_addr",
            "ai->ai_addrlen"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "packet_disconnect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/opacket.c",
          "lines": "298-308",
          "snippet": "void\npacket_disconnect(const char *fmt, ...)\n{\n\tchar buf[1024];\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvsnprintf(buf, sizeof(buf), fmt, args);\n\tva_end(args);\n\tssh_packet_disconnect(active_state, \"%s\", buf);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"packet.h\"",
            "#include \"ssherr.h\"",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"packet.h\"\n#include \"ssherr.h\"\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid\npacket_disconnect(const char *fmt, ...)\n{\n\tchar buf[1024];\n\tva_list args;\n\n\tva_start(args, fmt);\n\tvsnprintf(buf, sizeof(buf), fmt, args);\n\tva_end(args);\n\tssh_packet_disconnect(active_state, \"%s\", buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: set_nonblock(%d)\"",
            "__func__",
            "s"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "623-632",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_nonblock",
          "args": [
            "s"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "unset_nonblock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "116-138",
          "snippet": "int\nunset_nonblock(int fd)\n{\n\tint val;\n\n\tval = fcntl(fd, F_GETFL);\n\tif (val < 0) {\n\t\terror(\"fcntl(%d, F_GETFL): %s\", fd, strerror(errno));\n\t\treturn (-1);\n\t}\n\tif (!(val & O_NONBLOCK)) {\n\t\tdebug3(\"fd %d is not O_NONBLOCK\", fd);\n\t\treturn (0);\n\t}\n\tdebug(\"fd %d clearing O_NONBLOCK\", fd);\n\tval &= ~O_NONBLOCK;\n\tif (fcntl(fd, F_SETFL, val) == -1) {\n\t\tdebug(\"fcntl(%d, F_SETFL, ~O_NONBLOCK): %s\",\n\t\t    fd, strerror(errno));\n\t\treturn (-1);\n\t}\n\treturn (0);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nunset_nonblock(int fd)\n{\n\tint val;\n\n\tval = fcntl(fd, F_GETFL);\n\tif (val < 0) {\n\t\terror(\"fcntl(%d, F_GETFL): %s\", fd, strerror(errno));\n\t\treturn (-1);\n\t}\n\tif (!(val & O_NONBLOCK)) {\n\t\tdebug3(\"fd %d is not O_NONBLOCK\", fd);\n\t\treturn (0);\n\t}\n\tdebug(\"fd %d clearing O_NONBLOCK\", fd);\n\tval &= ~O_NONBLOCK;\n\tif (fcntl(fd, F_SETFL, val) == -1) {\n\t\tdebug(\"fcntl(%d, F_SETFL, ~O_NONBLOCK): %s\",\n\t\t    fd, strerror(errno));\n\t\treturn (-1);\n\t}\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "socket",
          "args": [
            "ai->ai_family",
            "ai->ai_socktype",
            "ai->ai_protocol"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "get_socket_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/canohost.c",
          "lines": "67-111",
          "snippet": "static char *\nget_socket_address(int sock, int remote, int flags)\n{\n\tstruct sockaddr_storage addr;\n\tsocklen_t addrlen;\n\tchar ntop[NI_MAXHOST];\n\tint r;\n\n\t/* Get IP address of client. */\n\taddrlen = sizeof(addr);\n\tmemset(&addr, 0, sizeof(addr));\n\n\tif (remote) {\n\t\tif (getpeername(sock, (struct sockaddr *)&addr, &addrlen) != 0)\n\t\t\treturn NULL;\n\t} else {\n\t\tif (getsockname(sock, (struct sockaddr *)&addr, &addrlen) != 0)\n\t\t\treturn NULL;\n\t}\n\n\t/* Work around Linux IPv6 weirdness */\n\tif (addr.ss_family == AF_INET6) {\n\t\taddrlen = sizeof(struct sockaddr_in6);\n\t\tipv64_normalise_mapped(&addr, &addrlen);\n\t}\n\n\tswitch (addr.ss_family) {\n\tcase AF_INET:\n\tcase AF_INET6:\n\t\t/* Get the address in ascii. */\n\t\tif ((r = getnameinfo((struct sockaddr *)&addr, addrlen, ntop,\n\t\t    sizeof(ntop), NULL, 0, flags)) != 0) {\n\t\t\terror(\"%s: getnameinfo %d failed: %s\", __func__,\n\t\t\t    flags, ssh_gai_strerror(r));\n\t\t\treturn NULL;\n\t\t}\n\t\treturn xstrdup(ntop);\n\tcase AF_UNIX:\n\t\t/* Get the Unix domain socket path. */\n\t\treturn xstrdup(((struct sockaddr_un *)&addr)->sun_path);\n\tdefault:\n\t\t/* We can't look up remote Unix domain sockets. */\n\t\treturn NULL;\n\t}\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"packet.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"packet.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <stdarg.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\nget_socket_address(int sock, int remote, int flags)\n{\n\tstruct sockaddr_storage addr;\n\tsocklen_t addrlen;\n\tchar ntop[NI_MAXHOST];\n\tint r;\n\n\t/* Get IP address of client. */\n\taddrlen = sizeof(addr);\n\tmemset(&addr, 0, sizeof(addr));\n\n\tif (remote) {\n\t\tif (getpeername(sock, (struct sockaddr *)&addr, &addrlen) != 0)\n\t\t\treturn NULL;\n\t} else {\n\t\tif (getsockname(sock, (struct sockaddr *)&addr, &addrlen) != 0)\n\t\t\treturn NULL;\n\t}\n\n\t/* Work around Linux IPv6 weirdness */\n\tif (addr.ss_family == AF_INET6) {\n\t\taddrlen = sizeof(struct sockaddr_in6);\n\t\tipv64_normalise_mapped(&addr, &addrlen);\n\t}\n\n\tswitch (addr.ss_family) {\n\tcase AF_INET:\n\tcase AF_INET6:\n\t\t/* Get the address in ascii. */\n\t\tif ((r = getnameinfo((struct sockaddr *)&addr, addrlen, ntop,\n\t\t    sizeof(ntop), NULL, 0, flags)) != 0) {\n\t\t\terror(\"%s: getnameinfo %d failed: %s\", __func__,\n\t\t\t    flags, ssh_gai_strerror(r));\n\t\t\treturn NULL;\n\t\t}\n\t\treturn xstrdup(ntop);\n\tcase AF_UNIX:\n\t\t/* Get the Unix domain socket path. */\n\t\treturn xstrdup(((struct sockaddr_un *)&addr)->sun_path);\n\tdefault:\n\t\t/* We can't look up remote Unix domain sockets. */\n\t\treturn NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "getaddrinfo",
          "args": [
            "host",
            "strport",
            "&hints",
            "&aitop"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "getaddrinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fake-rfc2553.c",
          "lines": "154-234",
          "snippet": "int\ngetaddrinfo(const char *hostname, const char *servname,\n    const struct addrinfo *hints, struct addrinfo **res)\n{\n\tstruct hostent *hp;\n\tstruct servent *sp;\n\tstruct in_addr in;\n\tint i;\n\tlong int port;\n\tu_long addr;\n\n\tport = 0;\n\tif (hints && hints->ai_family != AF_UNSPEC &&\n\t    hints->ai_family != AF_INET)\n\t\treturn (EAI_FAMILY);\n\tif (servname != NULL) {\n\t\tchar *cp;\n\n\t\tport = strtol(servname, &cp, 10);\n\t\tif (port > 0 && port <= 65535 && *cp == '\\0')\n\t\t\tport = htons(port);\n\t\telse if ((sp = getservbyname(servname, NULL)) != NULL)\n\t\t\tport = sp->s_port;\n\t\telse\n\t\t\tport = 0;\n\t}\n\n\tif (hints && hints->ai_flags & AI_PASSIVE) {\n\t\taddr = htonl(0x00000000);\n\t\tif (hostname && inet_aton(hostname, &in) != 0)\n\t\t\taddr = in.s_addr;\n\t\t*res = malloc_ai(port, addr, hints);\n\t\tif (*res == NULL)\n\t\t\treturn (EAI_MEMORY);\n\t\treturn (0);\n\t}\n\n\tif (!hostname) {\n\t\t*res = malloc_ai(port, htonl(0x7f000001), hints);\n\t\tif (*res == NULL)\n\t\t\treturn (EAI_MEMORY);\n\t\treturn (0);\n\t}\n\n\tif (inet_aton(hostname, &in)) {\n\t\t*res = malloc_ai(port, in.s_addr, hints);\n\t\tif (*res == NULL)\n\t\t\treturn (EAI_MEMORY);\n\t\treturn (0);\n\t}\n\n\t/* Don't try DNS if AI_NUMERICHOST is set */\n\tif (hints && hints->ai_flags & AI_NUMERICHOST)\n\t\treturn (EAI_NONAME);\n\n\thp = gethostbyname(hostname);\n\tif (hp && hp->h_name && hp->h_name[0] && hp->h_addr_list[0]) {\n\t\tstruct addrinfo *cur, *prev;\n\n\t\tcur = prev = *res = NULL;\n\t\tfor (i = 0; hp->h_addr_list[i]; i++) {\n\t\t\tstruct in_addr *in = (struct in_addr *)hp->h_addr_list[i];\n\n\t\t\tcur = malloc_ai(port, in->s_addr, hints);\n\t\t\tif (cur == NULL) {\n\t\t\t\tif (*res != NULL)\n\t\t\t\t\tfreeaddrinfo(*res);\n\t\t\t\treturn (EAI_MEMORY);\n\t\t\t}\n\t\t\tif (prev)\n\t\t\t\tprev->ai_next = cur;\n\t\t\telse\n\t\t\t\t*res = cur;\n\n\t\t\tprev = cur;\n\t\t}\n\t\treturn (0);\n\t}\n\n\treturn (EAI_NODATA);\n}",
          "includes": [
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nint\ngetaddrinfo(const char *hostname, const char *servname,\n    const struct addrinfo *hints, struct addrinfo **res)\n{\n\tstruct hostent *hp;\n\tstruct servent *sp;\n\tstruct in_addr in;\n\tint i;\n\tlong int port;\n\tu_long addr;\n\n\tport = 0;\n\tif (hints && hints->ai_family != AF_UNSPEC &&\n\t    hints->ai_family != AF_INET)\n\t\treturn (EAI_FAMILY);\n\tif (servname != NULL) {\n\t\tchar *cp;\n\n\t\tport = strtol(servname, &cp, 10);\n\t\tif (port > 0 && port <= 65535 && *cp == '\\0')\n\t\t\tport = htons(port);\n\t\telse if ((sp = getservbyname(servname, NULL)) != NULL)\n\t\t\tport = sp->s_port;\n\t\telse\n\t\t\tport = 0;\n\t}\n\n\tif (hints && hints->ai_flags & AI_PASSIVE) {\n\t\taddr = htonl(0x00000000);\n\t\tif (hostname && inet_aton(hostname, &in) != 0)\n\t\t\taddr = in.s_addr;\n\t\t*res = malloc_ai(port, addr, hints);\n\t\tif (*res == NULL)\n\t\t\treturn (EAI_MEMORY);\n\t\treturn (0);\n\t}\n\n\tif (!hostname) {\n\t\t*res = malloc_ai(port, htonl(0x7f000001), hints);\n\t\tif (*res == NULL)\n\t\t\treturn (EAI_MEMORY);\n\t\treturn (0);\n\t}\n\n\tif (inet_aton(hostname, &in)) {\n\t\t*res = malloc_ai(port, in.s_addr, hints);\n\t\tif (*res == NULL)\n\t\t\treturn (EAI_MEMORY);\n\t\treturn (0);\n\t}\n\n\t/* Don't try DNS if AI_NUMERICHOST is set */\n\tif (hints && hints->ai_flags & AI_NUMERICHOST)\n\t\treturn (EAI_NONAME);\n\n\thp = gethostbyname(hostname);\n\tif (hp && hp->h_name && hp->h_name[0] && hp->h_addr_list[0]) {\n\t\tstruct addrinfo *cur, *prev;\n\n\t\tcur = prev = *res = NULL;\n\t\tfor (i = 0; hp->h_addr_list[i]; i++) {\n\t\t\tstruct in_addr *in = (struct in_addr *)hp->h_addr_list[i];\n\n\t\t\tcur = malloc_ai(port, in->s_addr, hints);\n\t\t\tif (cur == NULL) {\n\t\t\t\tif (*res != NULL)\n\t\t\t\t\tfreeaddrinfo(*res);\n\t\t\t\treturn (EAI_MEMORY);\n\t\t\t}\n\t\t\tif (prev)\n\t\t\t\tprev->ai_next = cur;\n\t\t\telse\n\t\t\t\t*res = cur;\n\n\t\t\tprev = cur;\n\t\t}\n\t\treturn (0);\n\t}\n\n\treturn (EAI_NODATA);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&hints",
            "0",
            "sizeof(hints)"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "strport",
            "sizeof strport",
            "\"%d\"",
            "ssh_port"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-snprintf.c",
          "lines": "869-879",
          "snippet": "int\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nint\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint IPv4or6 = AF_UNSPEC;\nint ssh_port = SSH_DEFAULT_PORT;\n\nstatic int\ntcpconnect(char *host)\n{\n\tstruct addrinfo hints, *ai, *aitop;\n\tchar strport[NI_MAXSERV];\n\tint gaierr, s = -1;\n\n\tsnprintf(strport, sizeof strport, \"%d\", ssh_port);\n\tmemset(&hints, 0, sizeof(hints));\n\thints.ai_family = IPv4or6;\n\thints.ai_socktype = SOCK_STREAM;\n\tif ((gaierr = getaddrinfo(host, strport, &hints, &aitop)) != 0) {\n\t\terror(\"getaddrinfo %s: %s\", host, ssh_gai_strerror(gaierr));\n\t\treturn -1;\n\t}\n\tfor (ai = aitop; ai; ai = ai->ai_next) {\n\t\ts = socket(ai->ai_family, ai->ai_socktype, ai->ai_protocol);\n\t\tif (s < 0) {\n\t\t\terror(\"socket: %s\", strerror(errno));\n\t\t\tcontinue;\n\t\t}\n\t\tif (set_nonblock(s) == -1)\n\t\t\tfatal(\"%s: set_nonblock(%d)\", __func__, s);\n\t\tif (connect(s, ai->ai_addr, ai->ai_addrlen) < 0 &&\n\t\t    errno != EINPROGRESS)\n\t\t\terror(\"connect (`%s'): %s\", host, strerror(errno));\n\t\telse\n\t\t\tbreak;\n\t\tclose(s);\n\t\ts = -1;\n\t}\n\tfreeaddrinfo(aitop);\n\treturn s;\n}"
  },
  {
    "function_name": "keyprint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "308-324",
    "snippet": "static void\nkeyprint(con *c, struct sshkey *key)\n{\n\tchar *hosts = c->c_output_name ? c->c_output_name : c->c_name;\n\tchar *host, *ohosts;\n\n\tif (key == NULL)\n\t\treturn;\n\tif (get_cert || (!hash_hosts && ssh_port == SSH_DEFAULT_PORT)) {\n\t\tkeyprint_one(hosts, key);\n\t\treturn;\n\t}\n\tohosts = hosts = xstrdup(hosts);\n\twhile ((host = strsep(&hosts, \",\")) != NULL)\n\t\tkeyprint_one(host, key);\n\tfree(ohosts);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int ssh_port = SSH_DEFAULT_PORT;",
      "int get_cert = 0;",
      "int hash_hosts = 0;",
      "static void keyprint(con *c, struct sshkey *key);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ohosts"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "confree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "401-421",
          "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
            "#define CS_UNUSED 0\t\t/* File descriptor unused */"
          ],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_UNUSED 0\t\t/* File descriptor unused */\n\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "keyprint_one",
          "args": [
            "host",
            "key"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "keyprint_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "285-306",
          "snippet": "static void\nkeyprint_one(const char *host, struct sshkey *key)\n{\n\tchar *hostport;\n\tconst char *known_host, *hashed;\n\n\tif (print_sshfp) {\n\t\texport_dns_rr(host, key, stdout, 0);\n\t\treturn;\n\t}\n\n\thostport = put_host_port(host, ssh_port);\n\tlowercase(hostport);\n\tif (hash_hosts && (hashed = host_hash(host, NULL, 0)) == NULL)\n\t\tfatal(\"host_hash failed\");\n\tknown_host = hash_hosts ? hashed : hostport;\n\tif (!get_cert)\n\t\tfprintf(stdout, \"%s \", known_host);\n\tsshkey_write(key, stdout);\n\tfputs(\"\\n\", stdout);\n\tfree(hostport);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int ssh_port = SSH_DEFAULT_PORT;",
            "int get_cert = 0;",
            "int hash_hosts = 0;",
            "int print_sshfp = 0;",
            "static void keyprint(con *c, struct sshkey *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint ssh_port = SSH_DEFAULT_PORT;\nint get_cert = 0;\nint hash_hosts = 0;\nint print_sshfp = 0;\nstatic void keyprint(con *c, struct sshkey *key);\n\nstatic void\nkeyprint_one(const char *host, struct sshkey *key)\n{\n\tchar *hostport;\n\tconst char *known_host, *hashed;\n\n\tif (print_sshfp) {\n\t\texport_dns_rr(host, key, stdout, 0);\n\t\treturn;\n\t}\n\n\thostport = put_host_port(host, ssh_port);\n\tlowercase(hostport);\n\tif (hash_hosts && (hashed = host_hash(host, NULL, 0)) == NULL)\n\t\tfatal(\"host_hash failed\");\n\tknown_host = hash_hosts ? hashed : hostport;\n\tif (!get_cert)\n\t\tfprintf(stdout, \"%s \", known_host);\n\tsshkey_write(key, stdout);\n\tfputs(\"\\n\", stdout);\n\tfree(hostport);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strsep",
          "args": [
            "&hosts",
            "\",\""
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "xstrsep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "162-178",
          "snippet": "static char *\nxstrsep(char **str, const char *delim)\n{\n\tchar *s, *e;\n\n\tif (!**str)\n\t\treturn (NULL);\n\n\ts = *str;\n\te = s + strcspn(s, delim);\n\n\tif (*e != '\\0')\n\t\t*e++ = '\\0';\n\t*str = e;\n\n\treturn (s);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\nxstrsep(char **str, const char *delim)\n{\n\tchar *s, *e;\n\n\tif (!**str)\n\t\treturn (NULL);\n\n\ts = *str;\n\te = s + strcspn(s, delim);\n\n\tif (*e != '\\0')\n\t\t*e++ = '\\0';\n\t*str = e;\n\n\treturn (s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "hosts"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "xstrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "92-102",
          "snippet": "char *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nchar *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint ssh_port = SSH_DEFAULT_PORT;\nint get_cert = 0;\nint hash_hosts = 0;\nstatic void keyprint(con *c, struct sshkey *key);\n\nstatic void\nkeyprint(con *c, struct sshkey *key)\n{\n\tchar *hosts = c->c_output_name ? c->c_output_name : c->c_name;\n\tchar *host, *ohosts;\n\n\tif (key == NULL)\n\t\treturn;\n\tif (get_cert || (!hash_hosts && ssh_port == SSH_DEFAULT_PORT)) {\n\t\tkeyprint_one(hosts, key);\n\t\treturn;\n\t}\n\tohosts = hosts = xstrdup(hosts);\n\twhile ((host = strsep(&hosts, \",\")) != NULL)\n\t\tkeyprint_one(host, key);\n\tfree(ohosts);\n}"
  },
  {
    "function_name": "keyprint_one",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "285-306",
    "snippet": "static void\nkeyprint_one(const char *host, struct sshkey *key)\n{\n\tchar *hostport;\n\tconst char *known_host, *hashed;\n\n\tif (print_sshfp) {\n\t\texport_dns_rr(host, key, stdout, 0);\n\t\treturn;\n\t}\n\n\thostport = put_host_port(host, ssh_port);\n\tlowercase(hostport);\n\tif (hash_hosts && (hashed = host_hash(host, NULL, 0)) == NULL)\n\t\tfatal(\"host_hash failed\");\n\tknown_host = hash_hosts ? hashed : hostport;\n\tif (!get_cert)\n\t\tfprintf(stdout, \"%s \", known_host);\n\tsshkey_write(key, stdout);\n\tfputs(\"\\n\", stdout);\n\tfree(hostport);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int ssh_port = SSH_DEFAULT_PORT;",
      "int get_cert = 0;",
      "int hash_hosts = 0;",
      "int print_sshfp = 0;",
      "static void keyprint(con *c, struct sshkey *key);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "hostport"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "confree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "401-421",
          "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
            "#define CS_UNUSED 0\t\t/* File descriptor unused */"
          ],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_UNUSED 0\t\t/* File descriptor unused */\n\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fputs",
          "args": [
            "\"\\n\"",
            "stdout"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshkey_write",
          "args": [
            "key",
            "stdout"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "sshkey_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshkey.c",
          "lines": "1428-1449",
          "snippet": "int\nsshkey_write(const struct sshkey *key, FILE *f)\n{\n\tstruct sshbuf *b = NULL;\n\tint r = SSH_ERR_INTERNAL_ERROR;\n\n\tif ((b = sshbuf_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = sshkey_format_text(key, b)) != 0)\n\t\tgoto out;\n\tif (fwrite(sshbuf_ptr(b), sshbuf_len(b), 1, f) != 1) {\n\t\tif (feof(f))\n\t\t\terrno = EPIPE;\n\t\tr = SSH_ERR_SYSTEM_ERROR;\n\t\tgoto out;\n\t}\n\t/* Success */\n\tr = 0;\n out:\n\tsshbuf_free(b);\n\treturn r;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"xmss_fast.h\"",
            "#include \"match.h\"",
            "#include \"sshkey-xmss.h\"",
            "#include \"sshkey.h\"",
            "#include \"digest.h\"",
            "#include \"cipher.h\"",
            "#include \"sshbuf.h\"",
            "#include \"misc.h\"",
            "#include \"ssherr.h\"",
            "#include \"ssh2.h\"",
            "#include <util.h>",
            "#include <resolv.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"crypto_api.h\"",
            "#include <openssl/pem.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <netinet/in.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"xmss_fast.h\"\n#include \"match.h\"\n#include \"sshkey-xmss.h\"\n#include \"sshkey.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"sshbuf.h\"\n#include \"misc.h\"\n#include \"ssherr.h\"\n#include \"ssh2.h\"\n#include <util.h>\n#include <resolv.h>\n#include <string.h>\n#include <stdio.h>\n#include <limits.h>\n#include <errno.h>\n#include \"crypto_api.h\"\n#include <openssl/pem.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <netinet/in.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshkey_write(const struct sshkey *key, FILE *f)\n{\n\tstruct sshbuf *b = NULL;\n\tint r = SSH_ERR_INTERNAL_ERROR;\n\n\tif ((b = sshbuf_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = sshkey_format_text(key, b)) != 0)\n\t\tgoto out;\n\tif (fwrite(sshbuf_ptr(b), sshbuf_len(b), 1, f) != 1) {\n\t\tif (feof(f))\n\t\t\terrno = EPIPE;\n\t\tr = SSH_ERR_SYSTEM_ERROR;\n\t\tgoto out;\n\t}\n\t/* Success */\n\tr = 0;\n out:\n\tsshbuf_free(b);\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stdout",
            "\"%s \"",
            "known_host"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"host_hash failed\""
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "623-632",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "host_hash",
          "args": [
            "host",
            "NULL",
            "0"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "host_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hostfile.c",
          "lines": "119-155",
          "snippet": "char *\nhost_hash(const char *host, const char *name_from_hostfile, u_int src_len)\n{\n\tstruct ssh_hmac_ctx *ctx;\n\tu_char salt[256], result[256];\n\tchar uu_salt[512], uu_result[512];\n\tstatic char encoded[1024];\n\tu_int len;\n\n\tlen = ssh_digest_bytes(SSH_DIGEST_SHA1);\n\n\tif (name_from_hostfile == NULL) {\n\t\t/* Create new salt */\n\t\tarc4random_buf(salt, len);\n\t} else {\n\t\t/* Extract salt from known host entry */\n\t\tif (extract_salt(name_from_hostfile, src_len, salt,\n\t\t    sizeof(salt)) == -1)\n\t\t\treturn (NULL);\n\t}\n\n\tif ((ctx = ssh_hmac_start(SSH_DIGEST_SHA1)) == NULL ||\n\t    ssh_hmac_init(ctx, salt, len) < 0 ||\n\t    ssh_hmac_update(ctx, host, strlen(host)) < 0 ||\n\t    ssh_hmac_final(ctx, result, sizeof(result)))\n\t\tfatal(\"%s: ssh_hmac failed\", __func__);\n\tssh_hmac_free(ctx);\n\n\tif (__b64_ntop(salt, len, uu_salt, sizeof(uu_salt)) == -1 ||\n\t    __b64_ntop(result, len, uu_result, sizeof(uu_result)) == -1)\n\t\tfatal(\"%s: __b64_ntop failed\", __func__);\n\n\tsnprintf(encoded, sizeof(encoded), \"%s%s%c%s\", HASH_MAGIC, uu_salt,\n\t    HASH_DELIM, uu_result);\n\n\treturn (encoded);\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"digest.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"match.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <resolv.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"match.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <stdarg.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <resolv.h>\n#include <errno.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nhost_hash(const char *host, const char *name_from_hostfile, u_int src_len)\n{\n\tstruct ssh_hmac_ctx *ctx;\n\tu_char salt[256], result[256];\n\tchar uu_salt[512], uu_result[512];\n\tstatic char encoded[1024];\n\tu_int len;\n\n\tlen = ssh_digest_bytes(SSH_DIGEST_SHA1);\n\n\tif (name_from_hostfile == NULL) {\n\t\t/* Create new salt */\n\t\tarc4random_buf(salt, len);\n\t} else {\n\t\t/* Extract salt from known host entry */\n\t\tif (extract_salt(name_from_hostfile, src_len, salt,\n\t\t    sizeof(salt)) == -1)\n\t\t\treturn (NULL);\n\t}\n\n\tif ((ctx = ssh_hmac_start(SSH_DIGEST_SHA1)) == NULL ||\n\t    ssh_hmac_init(ctx, salt, len) < 0 ||\n\t    ssh_hmac_update(ctx, host, strlen(host)) < 0 ||\n\t    ssh_hmac_final(ctx, result, sizeof(result)))\n\t\tfatal(\"%s: ssh_hmac failed\", __func__);\n\tssh_hmac_free(ctx);\n\n\tif (__b64_ntop(salt, len, uu_salt, sizeof(uu_salt)) == -1 ||\n\t    __b64_ntop(result, len, uu_result, sizeof(uu_result)) == -1)\n\t\tfatal(\"%s: __b64_ntop failed\", __func__);\n\n\tsnprintf(encoded, sizeof(encoded), \"%s%s%c%s\", HASH_MAGIC, uu_salt,\n\t    HASH_DELIM, uu_result);\n\n\treturn (encoded);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lowercase",
          "args": [
            "hostport"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "lowercase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1480-1485",
          "snippet": "void\nlowercase(char *s)\n{\n\tfor (; *s; s++)\n\t\t*s = tolower((u_char)*s);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nlowercase(char *s)\n{\n\tfor (; *s; s++)\n\t\t*s = tolower((u_char)*s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_host_port",
          "args": [
            "host",
            "ssh_port"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "put_host_port",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "471-482",
          "snippet": "char *\nput_host_port(const char *host, u_short port)\n{\n\tchar *hoststr;\n\n\tif (port == 0 || port == SSH_DEFAULT_PORT)\n\t\treturn(xstrdup(host));\n\tif (asprintf(&hoststr, \"[%s]:%d\", host, (int)port) < 0)\n\t\tfatal(\"put_host_port: asprintf: %s\", strerror(errno));\n\tdebug3(\"put_host_port: %s\", hoststr);\n\treturn hoststr;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nput_host_port(const char *host, u_short port)\n{\n\tchar *hoststr;\n\n\tif (port == 0 || port == SSH_DEFAULT_PORT)\n\t\treturn(xstrdup(host));\n\tif (asprintf(&hoststr, \"[%s]:%d\", host, (int)port) < 0)\n\t\tfatal(\"put_host_port: asprintf: %s\", strerror(errno));\n\tdebug3(\"put_host_port: %s\", hoststr);\n\treturn hoststr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "export_dns_rr",
          "args": [
            "host",
            "key",
            "stdout",
            "0"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "export_dns_rr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dns.c",
          "lines": "319-356",
          "snippet": "int\nexport_dns_rr(const char *hostname, struct sshkey *key, FILE *f, int generic)\n{\n\tu_int8_t rdata_pubkey_algorithm = 0;\n\tu_int8_t rdata_digest_type = SSHFP_HASH_RESERVED;\n\tu_int8_t dtype;\n\tu_char *rdata_digest;\n\tsize_t i, rdata_digest_len;\n\tint success = 0;\n\n\tfor (dtype = SSHFP_HASH_SHA1; dtype < SSHFP_HASH_MAX; dtype++) {\n\t\trdata_digest_type = dtype;\n\t\tif (dns_read_key(&rdata_pubkey_algorithm, &rdata_digest_type,\n\t\t    &rdata_digest, &rdata_digest_len, key)) {\n\t\t\tif (generic) {\n\t\t\t\tfprintf(f, \"%s IN TYPE%d \\\\# %zu %02x %02x \",\n\t\t\t\t    hostname, DNS_RDATATYPE_SSHFP,\n\t\t\t\t    2 + rdata_digest_len,\n\t\t\t\t    rdata_pubkey_algorithm, rdata_digest_type);\n\t\t\t} else {\n\t\t\t\tfprintf(f, \"%s IN SSHFP %d %d \", hostname,\n\t\t\t\t    rdata_pubkey_algorithm, rdata_digest_type);\n\t\t\t}\n\t\t\tfor (i = 0; i < rdata_digest_len; i++)\n\t\t\t\tfprintf(f, \"%02x\", rdata_digest[i]);\n\t\t\tfprintf(f, \"\\n\");\n\t\t\tfree(rdata_digest); /* from sshkey_fingerprint_raw() */\n\t\t\tsuccess = 1;\n\t\t}\n\t}\n\n\t/* No SSHFP record was generated at all */\n\tif (success == 0) {\n\t\terror(\"%s: unsupported algorithm and/or digest_type\", __func__);\n\t}\n\n\treturn success;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"log.h\"",
            "#include \"dns.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"log.h\"\n#include \"dns.h\"\n#include \"ssherr.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <stdlib.h>\n#include <stdarg.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nexport_dns_rr(const char *hostname, struct sshkey *key, FILE *f, int generic)\n{\n\tu_int8_t rdata_pubkey_algorithm = 0;\n\tu_int8_t rdata_digest_type = SSHFP_HASH_RESERVED;\n\tu_int8_t dtype;\n\tu_char *rdata_digest;\n\tsize_t i, rdata_digest_len;\n\tint success = 0;\n\n\tfor (dtype = SSHFP_HASH_SHA1; dtype < SSHFP_HASH_MAX; dtype++) {\n\t\trdata_digest_type = dtype;\n\t\tif (dns_read_key(&rdata_pubkey_algorithm, &rdata_digest_type,\n\t\t    &rdata_digest, &rdata_digest_len, key)) {\n\t\t\tif (generic) {\n\t\t\t\tfprintf(f, \"%s IN TYPE%d \\\\# %zu %02x %02x \",\n\t\t\t\t    hostname, DNS_RDATATYPE_SSHFP,\n\t\t\t\t    2 + rdata_digest_len,\n\t\t\t\t    rdata_pubkey_algorithm, rdata_digest_type);\n\t\t\t} else {\n\t\t\t\tfprintf(f, \"%s IN SSHFP %d %d \", hostname,\n\t\t\t\t    rdata_pubkey_algorithm, rdata_digest_type);\n\t\t\t}\n\t\t\tfor (i = 0; i < rdata_digest_len; i++)\n\t\t\t\tfprintf(f, \"%02x\", rdata_digest[i]);\n\t\t\tfprintf(f, \"\\n\");\n\t\t\tfree(rdata_digest); /* from sshkey_fingerprint_raw() */\n\t\t\tsuccess = 1;\n\t\t}\n\t}\n\n\t/* No SSHFP record was generated at all */\n\tif (success == 0) {\n\t\terror(\"%s: unsupported algorithm and/or digest_type\", __func__);\n\t}\n\n\treturn success;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint ssh_port = SSH_DEFAULT_PORT;\nint get_cert = 0;\nint hash_hosts = 0;\nint print_sshfp = 0;\nstatic void keyprint(con *c, struct sshkey *key);\n\nstatic void\nkeyprint_one(const char *host, struct sshkey *key)\n{\n\tchar *hostport;\n\tconst char *known_host, *hashed;\n\n\tif (print_sshfp) {\n\t\texport_dns_rr(host, key, stdout, 0);\n\t\treturn;\n\t}\n\n\thostport = put_host_port(host, ssh_port);\n\tlowercase(hostport);\n\tif (hash_hosts && (hashed = host_hash(host, NULL, 0)) == NULL)\n\t\tfatal(\"host_hash failed\");\n\tknown_host = hash_hosts ? hashed : hostport;\n\tif (!get_cert)\n\t\tfprintf(stdout, \"%s \", known_host);\n\tsshkey_write(key, stdout);\n\tfputs(\"\\n\", stdout);\n\tfree(hostport);\n}"
  },
  {
    "function_name": "keygrab_ssh2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "223-283",
    "snippet": "static void\nkeygrab_ssh2(con *c)\n{\n\tchar *myproposal[PROPOSAL_MAX] = { KEX_CLIENT };\n\tint r;\n\n\tswitch (c->c_keytype) {\n\tcase KT_DSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-dss-cert-v01@openssh.com\" : \"ssh-dss\";\n\t\tbreak;\n\tcase KT_RSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-rsa-cert-v01@openssh.com\" : \"ssh-rsa\";\n\t\tbreak;\n\tcase KT_ED25519:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-ed25519-cert-v01@openssh.com\" : \"ssh-ed25519\";\n\t\tbreak;\n\tcase KT_XMSS:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-xmss-cert-v01@openssh.com\" : \"ssh-xmss@openssh.com\";\n\t\tbreak;\n\tcase KT_ECDSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ecdsa-sha2-nistp256-cert-v01@openssh.com,\"\n\t\t    \"ecdsa-sha2-nistp384-cert-v01@openssh.com,\"\n\t\t    \"ecdsa-sha2-nistp521-cert-v01@openssh.com\" :\n\t\t    \"ecdsa-sha2-nistp256,\"\n\t\t    \"ecdsa-sha2-nistp384,\"\n\t\t    \"ecdsa-sha2-nistp521\";\n\t\tbreak;\n\tdefault:\n\t\tfatal(\"unknown key type %d\", c->c_keytype);\n\t\tbreak;\n\t}\n\tif ((r = kex_setup(c->c_ssh, myproposal)) != 0) {\n\t\tfree(c->c_ssh);\n\t\tfprintf(stderr, \"kex_setup: %s\\n\", ssh_err(r));\n\t\texit(1);\n\t}\n#ifdef WITH_OPENSSL\n\tc->c_ssh->kex->kex[KEX_DH_GRP1_SHA1] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP14_SHA1] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP14_SHA256] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP16_SHA512] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP18_SHA512] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GEX_SHA1] = kexgex_client;\n\tc->c_ssh->kex->kex[KEX_DH_GEX_SHA256] = kexgex_client;\n# ifdef OPENSSL_HAS_ECC\n\tc->c_ssh->kex->kex[KEX_ECDH_SHA2] = kexecdh_client;\n# endif\n#endif\n\tc->c_ssh->kex->kex[KEX_C25519_SHA256] = kexc25519_client;\n\tssh_set_verify_host_key_callback(c->c_ssh, key_print_wrapper);\n\t/*\n\t * do the key-exchange until an error occurs or until\n\t * the key_print_wrapper() callback sets c_done.\n\t */\n\tssh_dispatch_run(c->c_ssh, DISPATCH_BLOCK, &c->c_done);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define KT_XMSS\t\t(1<<4)",
      "#define KT_ED25519\t(1<<3)",
      "#define KT_ECDSA\t(1<<2)",
      "#define KT_RSA\t\t(1<<1)",
      "#define KT_DSA\t\t(1)"
    ],
    "globals_used": [
      "int get_cert = 0;",
      "static void keyprint(con *c, struct sshkey *key);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_dispatch_run",
          "args": [
            "c->c_ssh",
            "DISPATCH_BLOCK",
            "&c->c_done"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_dispatch_run_fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dispatch.c",
          "lines": "128-135",
          "snippet": "void\nssh_dispatch_run_fatal(struct ssh *ssh, int mode, volatile sig_atomic_t *done)\n{\n\tint r;\n\n\tif ((r = ssh_dispatch_run(ssh, mode, done)) != 0)\n\t\tsshpkt_fatal(ssh, __func__, r);\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"compat.h\"",
            "#include \"packet.h\"",
            "#include \"dispatch.h\"",
            "#include \"log.h\"",
            "#include \"ssh2.h\"",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"dispatch.h\"\n#include \"log.h\"\n#include \"ssh2.h\"\n#include <stdarg.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_dispatch_run_fatal(struct ssh *ssh, int mode, volatile sig_atomic_t *done)\n{\n\tint r;\n\n\tif ((r = ssh_dispatch_run(ssh, mode, done)) != 0)\n\t\tsshpkt_fatal(ssh, __func__, r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_set_verify_host_key_callback",
          "args": [
            "c->c_ssh",
            "key_print_wrapper"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_set_verify_host_key_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh_api.c",
          "lines": "211-221",
          "snippet": "int\nssh_set_verify_host_key_callback(struct ssh *ssh,\n    int (*cb)(struct sshkey *, struct ssh *))\n{\n\tif (cb == NULL || ssh->kex == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\n\tssh->kex->verify_host_key = cb;\n\n\treturn 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"myproposal.h\"",
            "#include \"version.h\"",
            "#include \"ssh2.h\"",
            "#include \"misc.h\"",
            "#include \"sshkey.h\"",
            "#include \"authfile.h\"",
            "#include \"log.h\"",
            "#include \"compat.h\"",
            "#include \"ssh_api.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int\t_ssh_exchange_banner(struct ssh *);",
            "int\t_ssh_send_banner(struct ssh *, char **);",
            "int\t_ssh_read_banner(struct ssh *, char **);",
            "int\t_ssh_order_hostkeyalgs(struct ssh *);",
            "int\t_ssh_verify_host_key(struct sshkey *, struct ssh *);",
            "struct sshkey *_ssh_host_public_key(int, int, struct ssh *);",
            "struct sshkey *_ssh_host_private_key(int, int, struct ssh *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"openbsd-compat/openssl-compat.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"myproposal.h\"\n#include \"version.h\"\n#include \"ssh2.h\"\n#include \"misc.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"log.h\"\n#include \"compat.h\"\n#include \"ssh_api.h\"\n#include \"includes.h\"\n\nint\t_ssh_exchange_banner(struct ssh *);\nint\t_ssh_send_banner(struct ssh *, char **);\nint\t_ssh_read_banner(struct ssh *, char **);\nint\t_ssh_order_hostkeyalgs(struct ssh *);\nint\t_ssh_verify_host_key(struct sshkey *, struct ssh *);\nstruct sshkey *_ssh_host_public_key(int, int, struct ssh *);\nstruct sshkey *_ssh_host_private_key(int, int, struct ssh *);\n\nint\nssh_set_verify_host_key_callback(struct ssh *ssh,\n    int (*cb)(struct sshkey *, struct ssh *))\n{\n\tif (cb == NULL || ssh->kex == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\n\tssh->kex->verify_host_key = cb;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "sftp_server_cleanup_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-server.c",
          "lines": "1474-1483",
          "snippet": "void\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"uidswap.h\"",
            "#include \"match.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/statvfs.h>",
            "#include <sys/mount.h>",
            "# include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct passwd *pw = NULL;",
            "static char *client_addr = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"uidswap.h\"\n#include \"match.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"xmalloc.h\"\n#include <stdarg.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/statvfs.h>\n#include <sys/mount.h>\n# include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct passwd *pw = NULL;\nstatic char *client_addr = NULL;\n\nvoid\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"kex_setup: %s\\n\"",
            "ssh_err(r)"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_err",
          "args": [
            "r"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssherr.c",
          "lines": "22-147",
          "snippet": "const char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include <string.h>\n#include <errno.h>\n\nconst char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "c->c_ssh"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "confree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "401-421",
          "snippet": "static void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define CS_KEYS 3\t\t/* Waiting to read public key packet */",
            "#define CS_UNUSED 0\t\t/* File descriptor unused */"
          ],
          "globals_used": [
            "int maxfd;",
            "fd_set *read_wait;",
            "int ncon;",
            "con *fdcon;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define CS_KEYS 3\t\t/* Waiting to read public key packet */\n#define CS_UNUSED 0\t\t/* File descriptor unused */\n\nint maxfd;\nfd_set *read_wait;\nint ncon;\ncon *fdcon;\n\nstatic void\nconfree(int s)\n{\n\tif (s >= maxfd || fdcon[s].c_status == CS_UNUSED)\n\t\tfatal(\"confree: attempt to free bad fdno %d\", s);\n\tfree(fdcon[s].c_namebase);\n\tfree(fdcon[s].c_output_name);\n\tif (fdcon[s].c_status == CS_KEYS)\n\t\tfree(fdcon[s].c_data);\n\tfdcon[s].c_status = CS_UNUSED;\n\tfdcon[s].c_keytype = 0;\n\tif (fdcon[s].c_ssh) {\n\t\tssh_packet_close(fdcon[s].c_ssh);\n\t\tfree(fdcon[s].c_ssh);\n\t\tfdcon[s].c_ssh = NULL;\n\t} else\n\t\tclose(s);\n\tTAILQ_REMOVE(&tq, &fdcon[s], c_link);\n\tFD_CLR(s, read_wait);\n\tncon--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kex_setup",
          "args": [
            "c->c_ssh",
            "myproposal"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "kex_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kex.c",
          "lines": "664-677",
          "snippet": "int\nkex_setup(struct ssh *ssh, char *proposal[PROPOSAL_MAX])\n{\n\tint r;\n\n\tif ((r = kex_new(ssh, proposal, &ssh->kex)) != 0)\n\t\treturn r;\n\tif ((r = kex_send_kexinit(ssh)) != 0) {\t\t/* we start */\n\t\tkex_free(ssh->kex);\n\t\tssh->kex = NULL;\n\t\treturn r;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"monitor.h\"",
            "#include \"dispatch.h\"",
            "#include \"misc.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"log.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"compat.h\"",
            "#include \"packet.h\"",
            "#include \"ssh2.h\"",
            "#include <openssl/dh.h>",
            "#include <openssl/crypto.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int kex_choose_conf(struct ssh *);",
            "static int kex_input_newkeys(int, u_int32_t, struct ssh *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"monitor.h\"\n#include \"dispatch.h\"\n#include \"misc.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"ssh2.h\"\n#include <openssl/dh.h>\n#include <openssl/crypto.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include \"includes.h\"\n\nstatic int kex_choose_conf(struct ssh *);\nstatic int kex_input_newkeys(int, u_int32_t, struct ssh *);\n\nint\nkex_setup(struct ssh *ssh, char *proposal[PROPOSAL_MAX])\n{\n\tint r;\n\n\tif ((r = kex_new(ssh, proposal, &ssh->kex)) != 0)\n\t\treturn r;\n\tif ((r = kex_send_kexinit(ssh)) != 0) {\t\t/* we start */\n\t\tkex_free(ssh->kex);\n\t\tssh->kex = NULL;\n\t\treturn r;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"unknown key type %d\"",
            "c->c_keytype"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "623-632",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\texit(255);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define KT_XMSS\t\t(1<<4)\n#define KT_ED25519\t(1<<3)\n#define KT_ECDSA\t(1<<2)\n#define KT_RSA\t\t(1<<1)\n#define KT_DSA\t\t(1)\n\nint get_cert = 0;\nstatic void keyprint(con *c, struct sshkey *key);\n\nstatic void\nkeygrab_ssh2(con *c)\n{\n\tchar *myproposal[PROPOSAL_MAX] = { KEX_CLIENT };\n\tint r;\n\n\tswitch (c->c_keytype) {\n\tcase KT_DSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-dss-cert-v01@openssh.com\" : \"ssh-dss\";\n\t\tbreak;\n\tcase KT_RSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-rsa-cert-v01@openssh.com\" : \"ssh-rsa\";\n\t\tbreak;\n\tcase KT_ED25519:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-ed25519-cert-v01@openssh.com\" : \"ssh-ed25519\";\n\t\tbreak;\n\tcase KT_XMSS:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ssh-xmss-cert-v01@openssh.com\" : \"ssh-xmss@openssh.com\";\n\t\tbreak;\n\tcase KT_ECDSA:\n\t\tmyproposal[PROPOSAL_SERVER_HOST_KEY_ALGS] = get_cert ?\n\t\t    \"ecdsa-sha2-nistp256-cert-v01@openssh.com,\"\n\t\t    \"ecdsa-sha2-nistp384-cert-v01@openssh.com,\"\n\t\t    \"ecdsa-sha2-nistp521-cert-v01@openssh.com\" :\n\t\t    \"ecdsa-sha2-nistp256,\"\n\t\t    \"ecdsa-sha2-nistp384,\"\n\t\t    \"ecdsa-sha2-nistp521\";\n\t\tbreak;\n\tdefault:\n\t\tfatal(\"unknown key type %d\", c->c_keytype);\n\t\tbreak;\n\t}\n\tif ((r = kex_setup(c->c_ssh, myproposal)) != 0) {\n\t\tfree(c->c_ssh);\n\t\tfprintf(stderr, \"kex_setup: %s\\n\", ssh_err(r));\n\t\texit(1);\n\t}\n#ifdef WITH_OPENSSL\n\tc->c_ssh->kex->kex[KEX_DH_GRP1_SHA1] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP14_SHA1] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP14_SHA256] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP16_SHA512] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GRP18_SHA512] = kexdh_client;\n\tc->c_ssh->kex->kex[KEX_DH_GEX_SHA1] = kexgex_client;\n\tc->c_ssh->kex->kex[KEX_DH_GEX_SHA256] = kexgex_client;\n# ifdef OPENSSL_HAS_ECC\n\tc->c_ssh->kex->kex[KEX_ECDH_SHA2] = kexecdh_client;\n# endif\n#endif\n\tc->c_ssh->kex->kex[KEX_C25519_SHA256] = kexc25519_client;\n\tssh_set_verify_host_key_callback(c->c_ssh, key_print_wrapper);\n\t/*\n\t * do the key-exchange until an error occurs or until\n\t * the key_print_wrapper() callback sets c_done.\n\t */\n\tssh_dispatch_run(c->c_ssh, DISPATCH_BLOCK, &c->c_done);\n}"
  },
  {
    "function_name": "ssh2_capable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "207-221",
    "snippet": "static int\nssh2_capable(int remote_major, int remote_minor)\n{\n\tswitch (remote_major) {\n\tcase 1:\n\t\tif (remote_minor == 99)\n\t\t\treturn 1;\n\t\tbreak;\n\tcase 2:\n\t\treturn 1;\n\tdefault:\n\t\tbreak;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nssh2_capable(int remote_major, int remote_minor)\n{\n\tswitch (remote_major) {\n\tcase 1:\n\t\tif (remote_minor == 99)\n\t\t\treturn 1;\n\t\tbreak;\n\tcase 2:\n\t\treturn 1;\n\tdefault:\n\t\tbreak;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "key_print_wrapper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "196-205",
    "snippet": "static int\nkey_print_wrapper(struct sshkey *hostkey, struct ssh *ssh)\n{\n\tcon *c;\n\n\tif ((c = ssh_get_app_data(ssh)) != NULL)\n\t\tkeyprint(c, hostkey);\n\t/* always abort key exchange */\n\treturn -1;\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void keyprint(con *c, struct sshkey *key);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "keyprint",
          "args": [
            "c",
            "hostkey"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "keyprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "308-324",
          "snippet": "static void\nkeyprint(con *c, struct sshkey *key)\n{\n\tchar *hosts = c->c_output_name ? c->c_output_name : c->c_name;\n\tchar *host, *ohosts;\n\n\tif (key == NULL)\n\t\treturn;\n\tif (get_cert || (!hash_hosts && ssh_port == SSH_DEFAULT_PORT)) {\n\t\tkeyprint_one(hosts, key);\n\t\treturn;\n\t}\n\tohosts = hosts = xstrdup(hosts);\n\twhile ((host = strsep(&hosts, \",\")) != NULL)\n\t\tkeyprint_one(host, key);\n\tfree(ohosts);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int ssh_port = SSH_DEFAULT_PORT;",
            "int get_cert = 0;",
            "int hash_hosts = 0;",
            "static void keyprint(con *c, struct sshkey *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint ssh_port = SSH_DEFAULT_PORT;\nint get_cert = 0;\nint hash_hosts = 0;\nstatic void keyprint(con *c, struct sshkey *key);\n\nstatic void\nkeyprint(con *c, struct sshkey *key)\n{\n\tchar *hosts = c->c_output_name ? c->c_output_name : c->c_name;\n\tchar *host, *ohosts;\n\n\tif (key == NULL)\n\t\treturn;\n\tif (get_cert || (!hash_hosts && ssh_port == SSH_DEFAULT_PORT)) {\n\t\tkeyprint_one(hosts, key);\n\t\treturn;\n\t}\n\tohosts = hosts = xstrdup(hosts);\n\twhile ((host = strsep(&hosts, \",\")) != NULL)\n\t\tkeyprint_one(host, key);\n\tfree(ohosts);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_get_app_data",
          "args": [
            "ssh"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_get_app_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh_api.c",
          "lines": "170-174",
          "snippet": "void *\nssh_get_app_data(struct ssh *ssh)\n{\n\treturn ssh->app_data;\n}",
          "includes": [
            "#include <string.h>",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"myproposal.h\"",
            "#include \"version.h\"",
            "#include \"ssh2.h\"",
            "#include \"misc.h\"",
            "#include \"sshkey.h\"",
            "#include \"authfile.h\"",
            "#include \"log.h\"",
            "#include \"compat.h\"",
            "#include \"ssh_api.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int\t_ssh_exchange_banner(struct ssh *);",
            "int\t_ssh_send_banner(struct ssh *, char **);",
            "int\t_ssh_read_banner(struct ssh *, char **);",
            "int\t_ssh_order_hostkeyalgs(struct ssh *);",
            "int\t_ssh_verify_host_key(struct sshkey *, struct ssh *);",
            "struct sshkey *_ssh_host_public_key(int, int, struct ssh *);",
            "struct sshkey *_ssh_host_private_key(int, int, struct ssh *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"openbsd-compat/openssl-compat.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"myproposal.h\"\n#include \"version.h\"\n#include \"ssh2.h\"\n#include \"misc.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"log.h\"\n#include \"compat.h\"\n#include \"ssh_api.h\"\n#include \"includes.h\"\n\nint\t_ssh_exchange_banner(struct ssh *);\nint\t_ssh_send_banner(struct ssh *, char **);\nint\t_ssh_read_banner(struct ssh *, char **);\nint\t_ssh_order_hostkeyalgs(struct ssh *);\nint\t_ssh_verify_host_key(struct sshkey *, struct ssh *);\nstruct sshkey *_ssh_host_public_key(int, int, struct ssh *);\nstruct sshkey *_ssh_host_private_key(int, int, struct ssh *);\n\nvoid *\nssh_get_app_data(struct ssh *ssh)\n{\n\treturn ssh->app_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void keyprint(con *c, struct sshkey *key);\n\nstatic int\nkey_print_wrapper(struct sshkey *hostkey, struct ssh *ssh)\n{\n\tcon *c;\n\n\tif ((c = ssh_get_app_data(ssh)) != NULL)\n\t\tkeyprint(c, hostkey);\n\t/* always abort key exchange */\n\treturn -1;\n}"
  },
  {
    "function_name": "strnnsep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "184-193",
    "snippet": "static char *\nstrnnsep(char **stringp, char *delim)\n{\n\tchar *tok;\n\n\tdo {\n\t\ttok = xstrsep(stringp, delim);\n\t} while (tok && *tok == '\\0');\n\treturn (tok);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xstrsep",
          "args": [
            "stringp",
            "delim"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "xstrsep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "162-178",
          "snippet": "static char *\nxstrsep(char **str, const char *delim)\n{\n\tchar *s, *e;\n\n\tif (!**str)\n\t\treturn (NULL);\n\n\ts = *str;\n\te = s + strcspn(s, delim);\n\n\tif (*e != '\\0')\n\t\t*e++ = '\\0';\n\t*str = e;\n\n\treturn (s);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\nxstrsep(char **str, const char *delim)\n{\n\tchar *s, *e;\n\n\tif (!**str)\n\t\treturn (NULL);\n\n\ts = *str;\n\te = s + strcspn(s, delim);\n\n\tif (*e != '\\0')\n\t\t*e++ = '\\0';\n\t*str = e;\n\n\treturn (s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\nstrnnsep(char **stringp, char *delim)\n{\n\tchar *tok;\n\n\tdo {\n\t\ttok = xstrsep(stringp, delim);\n\t} while (tok && *tok == '\\0');\n\treturn (tok);\n}"
  },
  {
    "function_name": "xstrsep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "162-178",
    "snippet": "static char *\nxstrsep(char **str, const char *delim)\n{\n\tchar *s, *e;\n\n\tif (!**str)\n\t\treturn (NULL);\n\n\ts = *str;\n\te = s + strcspn(s, delim);\n\n\tif (*e != '\\0')\n\t\t*e++ = '\\0';\n\t*str = e;\n\n\treturn (s);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcspn",
          "args": [
            "s",
            "delim"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\nxstrsep(char **str, const char *delim)\n{\n\tchar *s, *e;\n\n\tif (!**str)\n\t\treturn (NULL);\n\n\ts = *str;\n\te = s + strcspn(s, delim);\n\n\tif (*e != '\\0')\n\t\t*e++ = '\\0';\n\t*str = e;\n\n\treturn (s);\n}"
  },
  {
    "function_name": "fdlim_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "136-155",
    "snippet": "static int\nfdlim_set(int lim)\n{\n#if defined(HAVE_SETRLIMIT) && defined(RLIMIT_NOFILE)\n\tstruct rlimit rlfd;\n#endif\n\n\tif (lim <= 0)\n\t\treturn (-1);\n#if defined(HAVE_SETRLIMIT) && defined(RLIMIT_NOFILE)\n\tif (getrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n\trlfd.rlim_cur = lim;\n\tif (setrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n#elif defined (HAVE_SETDTABLESIZE)\n\tsetdtablesize(lim);\n#endif\n\treturn (0);\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setdtablesize",
          "args": [
            "lim"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setrlimit",
          "args": [
            "RLIMIT_NOFILE",
            "&rlfd"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getrlimit",
          "args": [
            "RLIMIT_NOFILE",
            "&rlfd"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nfdlim_set(int lim)\n{\n#if defined(HAVE_SETRLIMIT) && defined(RLIMIT_NOFILE)\n\tstruct rlimit rlfd;\n#endif\n\n\tif (lim <= 0)\n\t\treturn (-1);\n#if defined(HAVE_SETRLIMIT) && defined(RLIMIT_NOFILE)\n\tif (getrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n\trlfd.rlim_cur = lim;\n\tif (setrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n#elif defined (HAVE_SETDTABLESIZE)\n\tsetdtablesize(lim);\n#endif\n\treturn (0);\n}"
  },
  {
    "function_name": "fdlim_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
    "lines": "119-134",
    "snippet": "static int\nfdlim_get(int hard)\n{\n#if defined(HAVE_GETRLIMIT) && defined(RLIMIT_NOFILE)\n\tstruct rlimit rlfd;\n\n\tif (getrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n\tif ((hard ? rlfd.rlim_max : rlfd.rlim_cur) == RLIM_INFINITY)\n\t\treturn SSH_SYSFDMAX;\n\telse\n\t\treturn hard ? rlfd.rlim_max : rlfd.rlim_cur;\n#else\n\treturn SSH_SYSFDMAX;\n#endif\n}",
    "includes": [
      "#include \"dns.h\"",
      "#include \"ssh_api.h\"",
      "#include \"ssherr.h\"",
      "#include \"hostfile.h\"",
      "#include \"misc.h\"",
      "#include \"atomicio.h\"",
      "#include \"log.h\"",
      "#include \"dispatch.h\"",
      "#include \"packet.h\"",
      "#include \"myproposal.h\"",
      "#include \"compat.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssh.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <netdb.h>",
      "#include <openssl/bn.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "# include <sys/time.h>",
      "#include <sys/resource.h>",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getrlimit",
          "args": [
            "RLIMIT_NOFILE",
            "&rlfd"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nfdlim_get(int hard)\n{\n#if defined(HAVE_GETRLIMIT) && defined(RLIMIT_NOFILE)\n\tstruct rlimit rlfd;\n\n\tif (getrlimit(RLIMIT_NOFILE, &rlfd) < 0)\n\t\treturn (-1);\n\tif ((hard ? rlfd.rlim_max : rlfd.rlim_cur) == RLIM_INFINITY)\n\t\treturn SSH_SYSFDMAX;\n\telse\n\t\treturn hard ? rlfd.rlim_max : rlfd.rlim_cur;\n#else\n\treturn SSH_SYSFDMAX;\n#endif\n}"
  }
]