[
  {
    "function_name": "ge25519_scalarmult_base",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "306-321",
    "snippet": "void ge25519_scalarmult_base(ge25519_p3 *r, const sc25519 *s)\n{\n  signed char b[85];\n  int i;\n  ge25519_aff t;\n  sc25519_window3(b,s);\n\n  choose_t((ge25519_aff *)r, 0, b[0]);\n  fe25519_setone(&r->z);\n  fe25519_mul(&r->t, &r->x, &r->y);\n  for(i=1;i<85;i++)\n  {\n    choose_t(&t, (unsigned long long) i, b[i]);\n    ge25519_mixadd2(r, &t);\n  }\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define ge25519_p3 ge25519"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ge25519_mixadd2",
          "args": [
            "r",
            "&t"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "ge25519_mixadd2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "83-104",
          "snippet": "static void ge25519_mixadd2(ge25519_p3 *r, const ge25519_aff *q)\n{\n  fe25519 a,b,t1,t2,c,d,e,f,g,h,qt;\n  fe25519_mul(&qt, &q->x, &q->y);\n  fe25519_sub(&a, &r->y, &r->x); /* A = (Y1-X1)*(Y2-X2) */\n  fe25519_add(&b, &r->y, &r->x); /* B = (Y1+X1)*(Y2+X2) */\n  fe25519_sub(&t1, &q->y, &q->x);\n  fe25519_add(&t2, &q->y, &q->x);\n  fe25519_mul(&a, &a, &t1);\n  fe25519_mul(&b, &b, &t2);\n  fe25519_sub(&e, &b, &a); /* E = B-A */\n  fe25519_add(&h, &b, &a); /* H = B+A */\n  fe25519_mul(&c, &r->t, &qt); /* C = T1*k*T2 */\n  fe25519_mul(&c, &c, &ge25519_ec2d);\n  fe25519_add(&d, &r->z, &r->z); /* D = Z1*2 */\n  fe25519_sub(&f, &d, &c); /* F = D-C */\n  fe25519_add(&g, &d, &c); /* G = D+C */\n  fe25519_mul(&r->x, &e, &f);\n  fe25519_mul(&r->y, &h, &g);\n  fe25519_mul(&r->z, &g, &f);\n  fe25519_mul(&r->t, &e, &h);\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define ge25519_p3 ge25519"
          ],
          "globals_used": [
            "static const fe25519 ge25519_ec2d = {{0x59, 0xF1, 0xB2, 0x26, 0x94, 0x9B, 0xD6, 0xEB, 0x56, 0xB1, 0x83, 0x82, 0x9A, 0x14, 0xE0, 0x00, \n                       0x30, 0xD1, 0xF3, 0xEE, 0xF2, 0x80, 0x8E, 0x19, 0xE7, 0xFC, 0xDF, 0x56, 0xDC, 0xD9, 0x06, 0x24}};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nstatic const fe25519 ge25519_ec2d = {{0x59, 0xF1, 0xB2, 0x26, 0x94, 0x9B, 0xD6, 0xEB, 0x56, 0xB1, 0x83, 0x82, 0x9A, 0x14, 0xE0, 0x00, \n                       0x30, 0xD1, 0xF3, 0xEE, 0xF2, 0x80, 0x8E, 0x19, 0xE7, 0xFC, 0xDF, 0x56, 0xDC, 0xD9, 0x06, 0x24}};\n\nstatic void ge25519_mixadd2(ge25519_p3 *r, const ge25519_aff *q)\n{\n  fe25519 a,b,t1,t2,c,d,e,f,g,h,qt;\n  fe25519_mul(&qt, &q->x, &q->y);\n  fe25519_sub(&a, &r->y, &r->x); /* A = (Y1-X1)*(Y2-X2) */\n  fe25519_add(&b, &r->y, &r->x); /* B = (Y1+X1)*(Y2+X2) */\n  fe25519_sub(&t1, &q->y, &q->x);\n  fe25519_add(&t2, &q->y, &q->x);\n  fe25519_mul(&a, &a, &t1);\n  fe25519_mul(&b, &b, &t2);\n  fe25519_sub(&e, &b, &a); /* E = B-A */\n  fe25519_add(&h, &b, &a); /* H = B+A */\n  fe25519_mul(&c, &r->t, &qt); /* C = T1*k*T2 */\n  fe25519_mul(&c, &c, &ge25519_ec2d);\n  fe25519_add(&d, &r->z, &r->z); /* D = Z1*2 */\n  fe25519_sub(&f, &d, &c); /* F = D-C */\n  fe25519_add(&g, &d, &c); /* G = D+C */\n  fe25519_mul(&r->x, &e, &f);\n  fe25519_mul(&r->y, &h, &g);\n  fe25519_mul(&r->z, &g, &f);\n  fe25519_mul(&r->t, &e, &h);\n}"
        }
      },
      {
        "call_info": {
          "callee": "choose_t",
          "args": [
            "&t",
            "(unsigned long long) i",
            "b[i]"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "choose_t",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "170-181",
          "snippet": "static void choose_t(ge25519_aff *t, unsigned long long pos, signed char b)\n{\n  /* constant time */\n  fe25519 v;\n  *t = ge25519_base_multiples_affine[5*pos+0];\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+1],equal(b,1) | equal(b,-1));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+2],equal(b,2) | equal(b,-2));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+3],equal(b,3) | equal(b,-3));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+4],equal(b,-4));\n  fe25519_neg(&v, &t->x);\n  fe25519_cmov(&t->x, &v, negative(b));\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const ge25519_aff ge25519_base_multiples_affine[425] = {\n#include \"ge25519_base.data\"\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic const ge25519_aff ge25519_base_multiples_affine[425] = {\n#include \"ge25519_base.data\"\n};\n\nstatic void choose_t(ge25519_aff *t, unsigned long long pos, signed char b)\n{\n  /* constant time */\n  fe25519 v;\n  *t = ge25519_base_multiples_affine[5*pos+0];\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+1],equal(b,1) | equal(b,-1));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+2],equal(b,2) | equal(b,-2));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+3],equal(b,3) | equal(b,-3));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+4],equal(b,-4));\n  fe25519_neg(&v, &t->x);\n  fe25519_cmov(&t->x, &v, negative(b));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_mul",
          "args": [
            "&r->t",
            "&r->x",
            "&r->y"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_mul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "196-211",
          "snippet": "void fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_setone",
          "args": [
            "&r->z"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_setone",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "156-161",
          "snippet": "void fe25519_setone(fe25519 *r)\n{\n  int i;\n  r->v[0] = 1;\n  for(i=1;i<32;i++) r->v[i]=0;\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_setone(fe25519 *r)\n{\n  int i;\n  r->v[0] = 1;\n  for(i=1;i<32;i++) r->v[i]=0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc25519_window3",
          "args": [
            "b",
            "s"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "sc25519_window3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sc25519.c",
          "lines": "221-256",
          "snippet": "void sc25519_window3(signed char r[85], const sc25519 *s)\n{\n  char carry;\n  int i;\n  for(i=0;i<10;i++)\n  {\n    r[8*i+0]  =  s->v[3*i+0]       & 7;\n    r[8*i+1]  = (s->v[3*i+0] >> 3) & 7;\n    r[8*i+2]  = (s->v[3*i+0] >> 6) & 7;\n    r[8*i+2] ^= (s->v[3*i+1] << 2) & 7;\n    r[8*i+3]  = (s->v[3*i+1] >> 1) & 7;\n    r[8*i+4]  = (s->v[3*i+1] >> 4) & 7;\n    r[8*i+5]  = (s->v[3*i+1] >> 7) & 7;\n    r[8*i+5] ^= (s->v[3*i+2] << 1) & 7;\n    r[8*i+6]  = (s->v[3*i+2] >> 2) & 7;\n    r[8*i+7]  = (s->v[3*i+2] >> 5) & 7;\n  }\n  r[8*i+0]  =  s->v[3*i+0]       & 7;\n  r[8*i+1]  = (s->v[3*i+0] >> 3) & 7;\n  r[8*i+2]  = (s->v[3*i+0] >> 6) & 7;\n  r[8*i+2] ^= (s->v[3*i+1] << 2) & 7;\n  r[8*i+3]  = (s->v[3*i+1] >> 1) & 7;\n  r[8*i+4]  = (s->v[3*i+1] >> 4) & 7;\n\n  /* Making it signed */\n  carry = 0;\n  for(i=0;i<84;i++)\n  {\n    r[i] += carry;\n    r[i+1] += r[i] >> 3;\n    r[i] &= 7;\n    carry = r[i] >> 2;\n    r[i] -= carry<<3;\n  }\n  r[84] += carry;\n}",
          "includes": [
            "#include \"sc25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sc25519.h\"\n#include \"includes.h\"\n\nvoid sc25519_window3(signed char r[85], const sc25519 *s)\n{\n  char carry;\n  int i;\n  for(i=0;i<10;i++)\n  {\n    r[8*i+0]  =  s->v[3*i+0]       & 7;\n    r[8*i+1]  = (s->v[3*i+0] >> 3) & 7;\n    r[8*i+2]  = (s->v[3*i+0] >> 6) & 7;\n    r[8*i+2] ^= (s->v[3*i+1] << 2) & 7;\n    r[8*i+3]  = (s->v[3*i+1] >> 1) & 7;\n    r[8*i+4]  = (s->v[3*i+1] >> 4) & 7;\n    r[8*i+5]  = (s->v[3*i+1] >> 7) & 7;\n    r[8*i+5] ^= (s->v[3*i+2] << 1) & 7;\n    r[8*i+6]  = (s->v[3*i+2] >> 2) & 7;\n    r[8*i+7]  = (s->v[3*i+2] >> 5) & 7;\n  }\n  r[8*i+0]  =  s->v[3*i+0]       & 7;\n  r[8*i+1]  = (s->v[3*i+0] >> 3) & 7;\n  r[8*i+2]  = (s->v[3*i+0] >> 6) & 7;\n  r[8*i+2] ^= (s->v[3*i+1] << 2) & 7;\n  r[8*i+3]  = (s->v[3*i+1] >> 1) & 7;\n  r[8*i+4]  = (s->v[3*i+1] >> 4) & 7;\n\n  /* Making it signed */\n  carry = 0;\n  for(i=0;i<84;i++)\n  {\n    r[i] += carry;\n    r[i+1] += r[i] >> 3;\n    r[i] &= 7;\n    carry = r[i] >> 2;\n    r[i] -= carry<<3;\n  }\n  r[84] += carry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nvoid ge25519_scalarmult_base(ge25519_p3 *r, const sc25519 *s)\n{\n  signed char b[85];\n  int i;\n  ge25519_aff t;\n  sc25519_window3(b,s);\n\n  choose_t((ge25519_aff *)r, 0, b[0]);\n  fe25519_setone(&r->z);\n  fe25519_mul(&r->t, &r->x, &r->y);\n  for(i=1;i<85;i++)\n  {\n    choose_t(&t, (unsigned long long) i, b[i]);\n    ge25519_mixadd2(r, &t);\n  }\n}"
  },
  {
    "function_name": "ge25519_double_scalarmult_vartime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "262-304",
    "snippet": "void ge25519_double_scalarmult_vartime(ge25519_p3 *r, const ge25519_p3 *p1, const sc25519 *s1, const ge25519_p3 *p2, const sc25519 *s2)\n{\n  ge25519_p1p1 tp1p1;\n  ge25519_p3 pre[16];\n  unsigned char b[127];\n  int i;\n\n  /* precomputation                                                        s2 s1 */\n  setneutral(pre);                                                      /* 00 00 */\n  pre[1] = *p1;                                                         /* 00 01 */\n  dbl_p1p1(&tp1p1,(ge25519_p2 *)p1);      p1p1_to_p3( &pre[2], &tp1p1); /* 00 10 */\n  add_p1p1(&tp1p1,&pre[1], &pre[2]);      p1p1_to_p3( &pre[3], &tp1p1); /* 00 11 */\n  pre[4] = *p2;                                                         /* 01 00 */\n  add_p1p1(&tp1p1,&pre[1], &pre[4]);      p1p1_to_p3( &pre[5], &tp1p1); /* 01 01 */\n  add_p1p1(&tp1p1,&pre[2], &pre[4]);      p1p1_to_p3( &pre[6], &tp1p1); /* 01 10 */\n  add_p1p1(&tp1p1,&pre[3], &pre[4]);      p1p1_to_p3( &pre[7], &tp1p1); /* 01 11 */\n  dbl_p1p1(&tp1p1,(ge25519_p2 *)p2);      p1p1_to_p3( &pre[8], &tp1p1); /* 10 00 */\n  add_p1p1(&tp1p1,&pre[1], &pre[8]);      p1p1_to_p3( &pre[9], &tp1p1); /* 10 01 */\n  dbl_p1p1(&tp1p1,(ge25519_p2 *)&pre[5]); p1p1_to_p3(&pre[10], &tp1p1); /* 10 10 */\n  add_p1p1(&tp1p1,&pre[3], &pre[8]);      p1p1_to_p3(&pre[11], &tp1p1); /* 10 11 */\n  add_p1p1(&tp1p1,&pre[4], &pre[8]);      p1p1_to_p3(&pre[12], &tp1p1); /* 11 00 */\n  add_p1p1(&tp1p1,&pre[1],&pre[12]);      p1p1_to_p3(&pre[13], &tp1p1); /* 11 01 */\n  add_p1p1(&tp1p1,&pre[2],&pre[12]);      p1p1_to_p3(&pre[14], &tp1p1); /* 11 10 */\n  add_p1p1(&tp1p1,&pre[3],&pre[12]);      p1p1_to_p3(&pre[15], &tp1p1); /* 11 11 */\n\n  sc25519_2interleave2(b,s1,s2);\n\n  /* scalar multiplication */\n  *r = pre[b[126]];\n  for(i=125;i>=0;i--)\n  {\n    dbl_p1p1(&tp1p1, (ge25519_p2 *)r);\n    p1p1_to_p2((ge25519_p2 *) r, &tp1p1);\n    dbl_p1p1(&tp1p1, (ge25519_p2 *)r);\n    if(b[i]!=0)\n    {\n      p1p1_to_p3(r, &tp1p1);\n      add_p1p1(&tp1p1, r, &pre[b[i]]);\n    }\n    if(i != 0) p1p1_to_p2((ge25519_p2 *)r, &tp1p1);\n    else p1p1_to_p3(r, &tp1p1);\n  }\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define ge25519_p3 ge25519"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p1p1_to_p3",
          "args": [
            "r",
            "&tp1p1"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "p1p1_to_p3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "77-81",
          "snippet": "static void p1p1_to_p3(ge25519_p3 *r, const ge25519_p1p1 *p)\n{\n  p1p1_to_p2((ge25519_p2 *)r, p);\n  fe25519_mul(&r->t, &p->x, &p->y);\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define ge25519_p3 ge25519"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nstatic void p1p1_to_p3(ge25519_p3 *r, const ge25519_p1p1 *p)\n{\n  p1p1_to_p2((ge25519_p2 *)r, p);\n  fe25519_mul(&r->t, &p->x, &p->y);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p1p1_to_p2",
          "args": [
            "(ge25519_p2 *)r",
            "&tp1p1"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "p1p1_to_p2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "70-75",
          "snippet": "static void p1p1_to_p2(ge25519_p2 *r, const ge25519_p1p1 *p)\n{\n  fe25519_mul(&r->x, &p->x, &p->t);\n  fe25519_mul(&r->y, &p->y, &p->z);\n  fe25519_mul(&r->z, &p->z, &p->t);\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic void p1p1_to_p2(ge25519_p2 *r, const ge25519_p1p1 *p)\n{\n  fe25519_mul(&r->x, &p->x, &p->t);\n  fe25519_mul(&r->y, &p->y, &p->z);\n  fe25519_mul(&r->z, &p->z, &p->t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_p1p1",
          "args": [
            "&tp1p1",
            "r",
            "&pre[b[i]]"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "add_p1p1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "106-124",
          "snippet": "static void add_p1p1(ge25519_p1p1 *r, const ge25519_p3 *p, const ge25519_p3 *q)\n{\n  fe25519 a, b, c, d, t;\n  \n  fe25519_sub(&a, &p->y, &p->x); /* A = (Y1-X1)*(Y2-X2) */\n  fe25519_sub(&t, &q->y, &q->x);\n  fe25519_mul(&a, &a, &t);\n  fe25519_add(&b, &p->x, &p->y); /* B = (Y1+X1)*(Y2+X2) */\n  fe25519_add(&t, &q->x, &q->y);\n  fe25519_mul(&b, &b, &t);\n  fe25519_mul(&c, &p->t, &q->t); /* C = T1*k*T2 */\n  fe25519_mul(&c, &c, &ge25519_ec2d);\n  fe25519_mul(&d, &p->z, &q->z); /* D = Z1*2*Z2 */\n  fe25519_add(&d, &d, &d);\n  fe25519_sub(&r->x, &b, &a); /* E = B-A */\n  fe25519_sub(&r->t, &d, &c); /* F = D-C */\n  fe25519_add(&r->z, &d, &c); /* G = D+C */\n  fe25519_add(&r->y, &b, &a); /* H = B+A */\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define ge25519_p3 ge25519"
          ],
          "globals_used": [
            "static const fe25519 ge25519_ec2d = {{0x59, 0xF1, 0xB2, 0x26, 0x94, 0x9B, 0xD6, 0xEB, 0x56, 0xB1, 0x83, 0x82, 0x9A, 0x14, 0xE0, 0x00, \n                       0x30, 0xD1, 0xF3, 0xEE, 0xF2, 0x80, 0x8E, 0x19, 0xE7, 0xFC, 0xDF, 0x56, 0xDC, 0xD9, 0x06, 0x24}};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nstatic const fe25519 ge25519_ec2d = {{0x59, 0xF1, 0xB2, 0x26, 0x94, 0x9B, 0xD6, 0xEB, 0x56, 0xB1, 0x83, 0x82, 0x9A, 0x14, 0xE0, 0x00, \n                       0x30, 0xD1, 0xF3, 0xEE, 0xF2, 0x80, 0x8E, 0x19, 0xE7, 0xFC, 0xDF, 0x56, 0xDC, 0xD9, 0x06, 0x24}};\n\nstatic void add_p1p1(ge25519_p1p1 *r, const ge25519_p3 *p, const ge25519_p3 *q)\n{\n  fe25519 a, b, c, d, t;\n  \n  fe25519_sub(&a, &p->y, &p->x); /* A = (Y1-X1)*(Y2-X2) */\n  fe25519_sub(&t, &q->y, &q->x);\n  fe25519_mul(&a, &a, &t);\n  fe25519_add(&b, &p->x, &p->y); /* B = (Y1+X1)*(Y2+X2) */\n  fe25519_add(&t, &q->x, &q->y);\n  fe25519_mul(&b, &b, &t);\n  fe25519_mul(&c, &p->t, &q->t); /* C = T1*k*T2 */\n  fe25519_mul(&c, &c, &ge25519_ec2d);\n  fe25519_mul(&d, &p->z, &q->z); /* D = Z1*2*Z2 */\n  fe25519_add(&d, &d, &d);\n  fe25519_sub(&r->x, &b, &a); /* E = B-A */\n  fe25519_sub(&r->t, &d, &c); /* F = D-C */\n  fe25519_add(&r->z, &d, &c); /* G = D+C */\n  fe25519_add(&r->y, &b, &a); /* H = B+A */\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbl_p1p1",
          "args": [
            "&tp1p1",
            "(ge25519_p2 *)r"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "dbl_p1p1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "127-143",
          "snippet": "static void dbl_p1p1(ge25519_p1p1 *r, const ge25519_p2 *p)\n{\n  fe25519 a,b,c,d;\n  fe25519_square(&a, &p->x);\n  fe25519_square(&b, &p->y);\n  fe25519_square(&c, &p->z);\n  fe25519_add(&c, &c, &c);\n  fe25519_neg(&d, &a);\n\n  fe25519_add(&r->x, &p->x, &p->y);\n  fe25519_square(&r->x, &r->x);\n  fe25519_sub(&r->x, &r->x, &a);\n  fe25519_sub(&r->x, &r->x, &b);\n  fe25519_add(&r->z, &d, &b);\n  fe25519_sub(&r->t, &r->z, &c);\n  fe25519_sub(&r->y, &d, &b);\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic void dbl_p1p1(ge25519_p1p1 *r, const ge25519_p2 *p)\n{\n  fe25519 a,b,c,d;\n  fe25519_square(&a, &p->x);\n  fe25519_square(&b, &p->y);\n  fe25519_square(&c, &p->z);\n  fe25519_add(&c, &c, &c);\n  fe25519_neg(&d, &a);\n\n  fe25519_add(&r->x, &p->x, &p->y);\n  fe25519_square(&r->x, &r->x);\n  fe25519_sub(&r->x, &r->x, &a);\n  fe25519_sub(&r->x, &r->x, &b);\n  fe25519_add(&r->z, &d, &b);\n  fe25519_sub(&r->t, &r->z, &c);\n  fe25519_sub(&r->y, &d, &b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc25519_2interleave2",
          "args": [
            "b",
            "s1",
            "s2"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "sc25519_2interleave2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sc25519.c",
          "lines": "295-308",
          "snippet": "void sc25519_2interleave2(unsigned char r[127], const sc25519 *s1, const sc25519 *s2)\n{\n  int i;\n  for(i=0;i<31;i++)\n  {\n    r[4*i]   = ( s1->v[i]       & 3) ^ (( s2->v[i]       & 3) << 2);\n    r[4*i+1] = ((s1->v[i] >> 2) & 3) ^ (((s2->v[i] >> 2) & 3) << 2);\n    r[4*i+2] = ((s1->v[i] >> 4) & 3) ^ (((s2->v[i] >> 4) & 3) << 2);\n    r[4*i+3] = ((s1->v[i] >> 6) & 3) ^ (((s2->v[i] >> 6) & 3) << 2);\n  }\n  r[124] = ( s1->v[31]       & 3) ^ (( s2->v[31]       & 3) << 2);\n  r[125] = ((s1->v[31] >> 2) & 3) ^ (((s2->v[31] >> 2) & 3) << 2);\n  r[126] = ((s1->v[31] >> 4) & 3) ^ (((s2->v[31] >> 4) & 3) << 2);\n}",
          "includes": [
            "#include \"sc25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sc25519.h\"\n#include \"includes.h\"\n\nvoid sc25519_2interleave2(unsigned char r[127], const sc25519 *s1, const sc25519 *s2)\n{\n  int i;\n  for(i=0;i<31;i++)\n  {\n    r[4*i]   = ( s1->v[i]       & 3) ^ (( s2->v[i]       & 3) << 2);\n    r[4*i+1] = ((s1->v[i] >> 2) & 3) ^ (((s2->v[i] >> 2) & 3) << 2);\n    r[4*i+2] = ((s1->v[i] >> 4) & 3) ^ (((s2->v[i] >> 4) & 3) << 2);\n    r[4*i+3] = ((s1->v[i] >> 6) & 3) ^ (((s2->v[i] >> 6) & 3) << 2);\n  }\n  r[124] = ( s1->v[31]       & 3) ^ (( s2->v[31]       & 3) << 2);\n  r[125] = ((s1->v[31] >> 2) & 3) ^ (((s2->v[31] >> 2) & 3) << 2);\n  r[126] = ((s1->v[31] >> 4) & 3) ^ (((s2->v[31] >> 4) & 3) << 2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setneutral",
          "args": [
            "pre"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "setneutral",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "183-189",
          "snippet": "static void setneutral(ge25519 *r)\n{\n  fe25519_setzero(&r->x);\n  fe25519_setone(&r->y);\n  fe25519_setone(&r->z);\n  fe25519_setzero(&r->t);\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic void setneutral(ge25519 *r)\n{\n  fe25519_setzero(&r->x);\n  fe25519_setone(&r->y);\n  fe25519_setone(&r->z);\n  fe25519_setzero(&r->t);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nvoid ge25519_double_scalarmult_vartime(ge25519_p3 *r, const ge25519_p3 *p1, const sc25519 *s1, const ge25519_p3 *p2, const sc25519 *s2)\n{\n  ge25519_p1p1 tp1p1;\n  ge25519_p3 pre[16];\n  unsigned char b[127];\n  int i;\n\n  /* precomputation                                                        s2 s1 */\n  setneutral(pre);                                                      /* 00 00 */\n  pre[1] = *p1;                                                         /* 00 01 */\n  dbl_p1p1(&tp1p1,(ge25519_p2 *)p1);      p1p1_to_p3( &pre[2], &tp1p1); /* 00 10 */\n  add_p1p1(&tp1p1,&pre[1], &pre[2]);      p1p1_to_p3( &pre[3], &tp1p1); /* 00 11 */\n  pre[4] = *p2;                                                         /* 01 00 */\n  add_p1p1(&tp1p1,&pre[1], &pre[4]);      p1p1_to_p3( &pre[5], &tp1p1); /* 01 01 */\n  add_p1p1(&tp1p1,&pre[2], &pre[4]);      p1p1_to_p3( &pre[6], &tp1p1); /* 01 10 */\n  add_p1p1(&tp1p1,&pre[3], &pre[4]);      p1p1_to_p3( &pre[7], &tp1p1); /* 01 11 */\n  dbl_p1p1(&tp1p1,(ge25519_p2 *)p2);      p1p1_to_p3( &pre[8], &tp1p1); /* 10 00 */\n  add_p1p1(&tp1p1,&pre[1], &pre[8]);      p1p1_to_p3( &pre[9], &tp1p1); /* 10 01 */\n  dbl_p1p1(&tp1p1,(ge25519_p2 *)&pre[5]); p1p1_to_p3(&pre[10], &tp1p1); /* 10 10 */\n  add_p1p1(&tp1p1,&pre[3], &pre[8]);      p1p1_to_p3(&pre[11], &tp1p1); /* 10 11 */\n  add_p1p1(&tp1p1,&pre[4], &pre[8]);      p1p1_to_p3(&pre[12], &tp1p1); /* 11 00 */\n  add_p1p1(&tp1p1,&pre[1],&pre[12]);      p1p1_to_p3(&pre[13], &tp1p1); /* 11 01 */\n  add_p1p1(&tp1p1,&pre[2],&pre[12]);      p1p1_to_p3(&pre[14], &tp1p1); /* 11 10 */\n  add_p1p1(&tp1p1,&pre[3],&pre[12]);      p1p1_to_p3(&pre[15], &tp1p1); /* 11 11 */\n\n  sc25519_2interleave2(b,s1,s2);\n\n  /* scalar multiplication */\n  *r = pre[b[126]];\n  for(i=125;i>=0;i--)\n  {\n    dbl_p1p1(&tp1p1, (ge25519_p2 *)r);\n    p1p1_to_p2((ge25519_p2 *) r, &tp1p1);\n    dbl_p1p1(&tp1p1, (ge25519_p2 *)r);\n    if(b[i]!=0)\n    {\n      p1p1_to_p3(r, &tp1p1);\n      add_p1p1(&tp1p1, r, &pre[b[i]]);\n    }\n    if(i != 0) p1p1_to_p2((ge25519_p2 *)r, &tp1p1);\n    else p1p1_to_p3(r, &tp1p1);\n  }\n}"
  },
  {
    "function_name": "ge25519_isneutral_vartime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "253-259",
    "snippet": "int ge25519_isneutral_vartime(const ge25519_p3 *p)\n{\n  int ret = 1;\n  if(!fe25519_iszero(&p->x)) ret = 0;\n  if(!fe25519_iseq_vartime(&p->y, &p->z)) ret = 0;\n  return ret;\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define ge25519_p3 ge25519"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_iseq_vartime",
          "args": [
            "&p->y",
            "&p->z"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_iseq_vartime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "129-139",
          "snippet": "int fe25519_iseq_vartime(const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  fe25519 t1 = *x;\n  fe25519 t2 = *y;\n  fe25519_freeze(&t1);\n  fe25519_freeze(&t2);\n  for(i=0;i<32;i++)\n    if(t1.v[i] != t2.v[i]) return 0;\n  return 1;\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nint fe25519_iseq_vartime(const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  fe25519 t1 = *x;\n  fe25519 t2 = *y;\n  fe25519_freeze(&t1);\n  fe25519_freeze(&t2);\n  for(i=0;i<32;i++)\n    if(t1.v[i] != t2.v[i]) return 0;\n  return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_iszero",
          "args": [
            "&p->x"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_iszero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "117-127",
          "snippet": "int fe25519_iszero(const fe25519 *x)\n{\n  int i;\n  int r;\n  fe25519 t = *x;\n  fe25519_freeze(&t);\n  r = equal(t.v[0],0);\n  for(i=1;i<32;i++) \n    r &= equal(t.v[i],0);\n  return r;\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nint fe25519_iszero(const fe25519 *x)\n{\n  int i;\n  int r;\n  fe25519 t = *x;\n  fe25519_freeze(&t);\n  r = equal(t.v[0],0);\n  for(i=1;i<32;i++) \n    r &= equal(t.v[i],0);\n  return r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nint ge25519_isneutral_vartime(const ge25519_p3 *p)\n{\n  int ret = 1;\n  if(!fe25519_iszero(&p->x)) ret = 0;\n  if(!fe25519_iseq_vartime(&p->y, &p->z)) ret = 0;\n  return ret;\n}"
  },
  {
    "function_name": "ge25519_pack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "243-251",
    "snippet": "void ge25519_pack(unsigned char r[32], const ge25519_p3 *p)\n{\n  fe25519 tx, ty, zi;\n  fe25519_invert(&zi, &p->z); \n  fe25519_mul(&tx, &p->x, &zi);\n  fe25519_mul(&ty, &p->y, &zi);\n  fe25519_pack(r, &ty);\n  r[31] ^= fe25519_getparity(&tx) << 7;\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define ge25519_p3 ge25519"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_getparity",
          "args": [
            "&tx"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_getparity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "149-154",
          "snippet": "unsigned char fe25519_getparity(const fe25519 *x)\n{\n  fe25519 t = *x;\n  fe25519_freeze(&t);\n  return t.v[0] & 1;\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nunsigned char fe25519_getparity(const fe25519 *x)\n{\n  fe25519 t = *x;\n  fe25519_freeze(&t);\n  return t.v[0] & 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_pack",
          "args": [
            "r",
            "&ty"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_pack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "108-115",
          "snippet": "void fe25519_pack(unsigned char r[32], const fe25519 *x)\n{\n  int i;\n  fe25519 y = *x;\n  fe25519_freeze(&y);\n  for(i=0;i<32;i++) \n    r[i] = y.v[i];\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_pack(unsigned char r[32], const fe25519 *x)\n{\n  int i;\n  fe25519 y = *x;\n  fe25519_freeze(&y);\n  for(i=0;i<32;i++) \n    r[i] = y.v[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_mul",
          "args": [
            "&ty",
            "&p->y",
            "&zi"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_mul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "196-211",
          "snippet": "void fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_invert",
          "args": [
            "&zi",
            "&p->z"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_invert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "218-283",
          "snippet": "void fe25519_invert(fe25519 *r, const fe25519 *x)\n{\n\tfe25519 z2;\n\tfe25519 z9;\n\tfe25519 z11;\n\tfe25519 z2_5_0;\n\tfe25519 z2_10_0;\n\tfe25519 z2_20_0;\n\tfe25519 z2_50_0;\n\tfe25519 z2_100_0;\n\tfe25519 t0;\n\tfe25519 t1;\n\tint i;\n\t\n\t/* 2 */ fe25519_square(&z2,x);\n\t/* 4 */ fe25519_square(&t1,&z2);\n\t/* 8 */ fe25519_square(&t0,&t1);\n\t/* 9 */ fe25519_mul(&z9,&t0,x);\n\t/* 11 */ fe25519_mul(&z11,&z9,&z2);\n\t/* 22 */ fe25519_square(&t0,&z11);\n\t/* 2^5 - 2^0 = 31 */ fe25519_mul(&z2_5_0,&t0,&z9);\n\n\t/* 2^6 - 2^1 */ fe25519_square(&t0,&z2_5_0);\n\t/* 2^7 - 2^2 */ fe25519_square(&t1,&t0);\n\t/* 2^8 - 2^3 */ fe25519_square(&t0,&t1);\n\t/* 2^9 - 2^4 */ fe25519_square(&t1,&t0);\n\t/* 2^10 - 2^5 */ fe25519_square(&t0,&t1);\n\t/* 2^10 - 2^0 */ fe25519_mul(&z2_10_0,&t0,&z2_5_0);\n\n\t/* 2^11 - 2^1 */ fe25519_square(&t0,&z2_10_0);\n\t/* 2^12 - 2^2 */ fe25519_square(&t1,&t0);\n\t/* 2^20 - 2^10 */ for (i = 2;i < 10;i += 2) { fe25519_square(&t0,&t1); fe25519_square(&t1,&t0); }\n\t/* 2^20 - 2^0 */ fe25519_mul(&z2_20_0,&t1,&z2_10_0);\n\n\t/* 2^21 - 2^1 */ fe25519_square(&t0,&z2_20_0);\n\t/* 2^22 - 2^2 */ fe25519_square(&t1,&t0);\n\t/* 2^40 - 2^20 */ for (i = 2;i < 20;i += 2) { fe25519_square(&t0,&t1); fe25519_square(&t1,&t0); }\n\t/* 2^40 - 2^0 */ fe25519_mul(&t0,&t1,&z2_20_0);\n\n\t/* 2^41 - 2^1 */ fe25519_square(&t1,&t0);\n\t/* 2^42 - 2^2 */ fe25519_square(&t0,&t1);\n\t/* 2^50 - 2^10 */ for (i = 2;i < 10;i += 2) { fe25519_square(&t1,&t0); fe25519_square(&t0,&t1); }\n\t/* 2^50 - 2^0 */ fe25519_mul(&z2_50_0,&t0,&z2_10_0);\n\n\t/* 2^51 - 2^1 */ fe25519_square(&t0,&z2_50_0);\n\t/* 2^52 - 2^2 */ fe25519_square(&t1,&t0);\n\t/* 2^100 - 2^50 */ for (i = 2;i < 50;i += 2) { fe25519_square(&t0,&t1); fe25519_square(&t1,&t0); }\n\t/* 2^100 - 2^0 */ fe25519_mul(&z2_100_0,&t1,&z2_50_0);\n\n\t/* 2^101 - 2^1 */ fe25519_square(&t1,&z2_100_0);\n\t/* 2^102 - 2^2 */ fe25519_square(&t0,&t1);\n\t/* 2^200 - 2^100 */ for (i = 2;i < 100;i += 2) { fe25519_square(&t1,&t0); fe25519_square(&t0,&t1); }\n\t/* 2^200 - 2^0 */ fe25519_mul(&t1,&t0,&z2_100_0);\n\n\t/* 2^201 - 2^1 */ fe25519_square(&t0,&t1);\n\t/* 2^202 - 2^2 */ fe25519_square(&t1,&t0);\n\t/* 2^250 - 2^50 */ for (i = 2;i < 50;i += 2) { fe25519_square(&t0,&t1); fe25519_square(&t1,&t0); }\n\t/* 2^250 - 2^0 */ fe25519_mul(&t0,&t1,&z2_50_0);\n\n\t/* 2^251 - 2^1 */ fe25519_square(&t1,&t0);\n\t/* 2^252 - 2^2 */ fe25519_square(&t0,&t1);\n\t/* 2^253 - 2^3 */ fe25519_square(&t1,&t0);\n\t/* 2^254 - 2^4 */ fe25519_square(&t0,&t1);\n\t/* 2^255 - 2^5 */ fe25519_square(&t1,&t0);\n\t/* 2^255 - 21 */ fe25519_mul(r,&t1,&z11);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_invert(fe25519 *r, const fe25519 *x)\n{\n\tfe25519 z2;\n\tfe25519 z9;\n\tfe25519 z11;\n\tfe25519 z2_5_0;\n\tfe25519 z2_10_0;\n\tfe25519 z2_20_0;\n\tfe25519 z2_50_0;\n\tfe25519 z2_100_0;\n\tfe25519 t0;\n\tfe25519 t1;\n\tint i;\n\t\n\t/* 2 */ fe25519_square(&z2,x);\n\t/* 4 */ fe25519_square(&t1,&z2);\n\t/* 8 */ fe25519_square(&t0,&t1);\n\t/* 9 */ fe25519_mul(&z9,&t0,x);\n\t/* 11 */ fe25519_mul(&z11,&z9,&z2);\n\t/* 22 */ fe25519_square(&t0,&z11);\n\t/* 2^5 - 2^0 = 31 */ fe25519_mul(&z2_5_0,&t0,&z9);\n\n\t/* 2^6 - 2^1 */ fe25519_square(&t0,&z2_5_0);\n\t/* 2^7 - 2^2 */ fe25519_square(&t1,&t0);\n\t/* 2^8 - 2^3 */ fe25519_square(&t0,&t1);\n\t/* 2^9 - 2^4 */ fe25519_square(&t1,&t0);\n\t/* 2^10 - 2^5 */ fe25519_square(&t0,&t1);\n\t/* 2^10 - 2^0 */ fe25519_mul(&z2_10_0,&t0,&z2_5_0);\n\n\t/* 2^11 - 2^1 */ fe25519_square(&t0,&z2_10_0);\n\t/* 2^12 - 2^2 */ fe25519_square(&t1,&t0);\n\t/* 2^20 - 2^10 */ for (i = 2;i < 10;i += 2) { fe25519_square(&t0,&t1); fe25519_square(&t1,&t0); }\n\t/* 2^20 - 2^0 */ fe25519_mul(&z2_20_0,&t1,&z2_10_0);\n\n\t/* 2^21 - 2^1 */ fe25519_square(&t0,&z2_20_0);\n\t/* 2^22 - 2^2 */ fe25519_square(&t1,&t0);\n\t/* 2^40 - 2^20 */ for (i = 2;i < 20;i += 2) { fe25519_square(&t0,&t1); fe25519_square(&t1,&t0); }\n\t/* 2^40 - 2^0 */ fe25519_mul(&t0,&t1,&z2_20_0);\n\n\t/* 2^41 - 2^1 */ fe25519_square(&t1,&t0);\n\t/* 2^42 - 2^2 */ fe25519_square(&t0,&t1);\n\t/* 2^50 - 2^10 */ for (i = 2;i < 10;i += 2) { fe25519_square(&t1,&t0); fe25519_square(&t0,&t1); }\n\t/* 2^50 - 2^0 */ fe25519_mul(&z2_50_0,&t0,&z2_10_0);\n\n\t/* 2^51 - 2^1 */ fe25519_square(&t0,&z2_50_0);\n\t/* 2^52 - 2^2 */ fe25519_square(&t1,&t0);\n\t/* 2^100 - 2^50 */ for (i = 2;i < 50;i += 2) { fe25519_square(&t0,&t1); fe25519_square(&t1,&t0); }\n\t/* 2^100 - 2^0 */ fe25519_mul(&z2_100_0,&t1,&z2_50_0);\n\n\t/* 2^101 - 2^1 */ fe25519_square(&t1,&z2_100_0);\n\t/* 2^102 - 2^2 */ fe25519_square(&t0,&t1);\n\t/* 2^200 - 2^100 */ for (i = 2;i < 100;i += 2) { fe25519_square(&t1,&t0); fe25519_square(&t0,&t1); }\n\t/* 2^200 - 2^0 */ fe25519_mul(&t1,&t0,&z2_100_0);\n\n\t/* 2^201 - 2^1 */ fe25519_square(&t0,&t1);\n\t/* 2^202 - 2^2 */ fe25519_square(&t1,&t0);\n\t/* 2^250 - 2^50 */ for (i = 2;i < 50;i += 2) { fe25519_square(&t0,&t1); fe25519_square(&t1,&t0); }\n\t/* 2^250 - 2^0 */ fe25519_mul(&t0,&t1,&z2_50_0);\n\n\t/* 2^251 - 2^1 */ fe25519_square(&t1,&t0);\n\t/* 2^252 - 2^2 */ fe25519_square(&t0,&t1);\n\t/* 2^253 - 2^3 */ fe25519_square(&t1,&t0);\n\t/* 2^254 - 2^4 */ fe25519_square(&t0,&t1);\n\t/* 2^255 - 2^5 */ fe25519_square(&t1,&t0);\n\t/* 2^255 - 21 */ fe25519_mul(r,&t1,&z11);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nvoid ge25519_pack(unsigned char r[32], const ge25519_p3 *p)\n{\n  fe25519 tx, ty, zi;\n  fe25519_invert(&zi, &p->z); \n  fe25519_mul(&tx, &p->x, &zi);\n  fe25519_mul(&ty, &p->y, &zi);\n  fe25519_pack(r, &ty);\n  r[31] ^= fe25519_getparity(&tx) << 7;\n}"
  },
  {
    "function_name": "ge25519_unpackneg_vartime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "196-241",
    "snippet": "int ge25519_unpackneg_vartime(ge25519_p3 *r, const unsigned char p[32])\n{\n  unsigned char par;\n  fe25519 t, chk, num, den, den2, den4, den6;\n  fe25519_setone(&r->z);\n  par = p[31] >> 7;\n  fe25519_unpack(&r->y, p); \n  fe25519_square(&num, &r->y); /* x = y^2 */\n  fe25519_mul(&den, &num, &ge25519_ecd); /* den = dy^2 */\n  fe25519_sub(&num, &num, &r->z); /* x = y^2-1 */\n  fe25519_add(&den, &r->z, &den); /* den = dy^2+1 */\n\n  /* Computation of sqrt(num/den) */\n  /* 1.: computation of num^((p-5)/8)*den^((7p-35)/8) = (num*den^7)^((p-5)/8) */\n  fe25519_square(&den2, &den);\n  fe25519_square(&den4, &den2);\n  fe25519_mul(&den6, &den4, &den2);\n  fe25519_mul(&t, &den6, &num);\n  fe25519_mul(&t, &t, &den);\n\n  fe25519_pow2523(&t, &t);\n  /* 2. computation of r->x = t * num * den^3 */\n  fe25519_mul(&t, &t, &num);\n  fe25519_mul(&t, &t, &den);\n  fe25519_mul(&t, &t, &den);\n  fe25519_mul(&r->x, &t, &den);\n\n  /* 3. Check whether sqrt computation gave correct result, multiply by sqrt(-1) if not: */\n  fe25519_square(&chk, &r->x);\n  fe25519_mul(&chk, &chk, &den);\n  if (!fe25519_iseq_vartime(&chk, &num))\n    fe25519_mul(&r->x, &r->x, &ge25519_sqrtm1);\n\n  /* 4. Now we have one of the two square roots, except if input was not a square */\n  fe25519_square(&chk, &r->x);\n  fe25519_mul(&chk, &chk, &den);\n  if (!fe25519_iseq_vartime(&chk, &num))\n    return -1;\n\n  /* 5. Choose the desired square root according to parity: */\n  if(fe25519_getparity(&r->x) != (1-par))\n    fe25519_neg(&r->x, &r->x);\n\n  fe25519_mul(&r->t, &r->x, &r->y);\n  return 0;\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define ge25519_p3 ge25519"
    ],
    "globals_used": [
      "static const fe25519 ge25519_ecd = {{0xA3, 0x78, 0x59, 0x13, 0xCA, 0x4D, 0xEB, 0x75, 0xAB, 0xD8, 0x41, 0x41, 0x4D, 0x0A, 0x70, 0x00, \n                      0x98, 0xE8, 0x79, 0x77, 0x79, 0x40, 0xC7, 0x8C, 0x73, 0xFE, 0x6F, 0x2B, 0xEE, 0x6C, 0x03, 0x52}};",
      "static const fe25519 ge25519_sqrtm1 = {{0xB0, 0xA0, 0x0E, 0x4A, 0x27, 0x1B, 0xEE, 0xC4, 0x78, 0xE4, 0x2F, 0xAD, 0x06, 0x18, 0x43, 0x2F, \n                         0xA7, 0xD7, 0xFB, 0x3D, 0x99, 0x00, 0x4D, 0x2B, 0x0B, 0xDF, 0xC1, 0x4F, 0x80, 0x24, 0x83, 0x2B}};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_mul",
          "args": [
            "&r->t",
            "&r->x",
            "&r->y"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_mul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "196-211",
          "snippet": "void fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_neg",
          "args": [
            "&r->x",
            "&r->x"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_neg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "169-176",
          "snippet": "void fe25519_neg(fe25519 *r, const fe25519 *x)\n{\n  fe25519 t;\n  int i;\n  for(i=0;i<32;i++) t.v[i]=x->v[i];\n  fe25519_setzero(r);\n  fe25519_sub(r, r, &t);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_neg(fe25519 *r, const fe25519 *x)\n{\n  fe25519 t;\n  int i;\n  for(i=0;i<32;i++) t.v[i]=x->v[i];\n  fe25519_setzero(r);\n  fe25519_sub(r, r, &t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_getparity",
          "args": [
            "&r->x"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_getparity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "149-154",
          "snippet": "unsigned char fe25519_getparity(const fe25519 *x)\n{\n  fe25519 t = *x;\n  fe25519_freeze(&t);\n  return t.v[0] & 1;\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nunsigned char fe25519_getparity(const fe25519 *x)\n{\n  fe25519 t = *x;\n  fe25519_freeze(&t);\n  return t.v[0] & 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_iseq_vartime",
          "args": [
            "&chk",
            "&num"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_iseq_vartime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "129-139",
          "snippet": "int fe25519_iseq_vartime(const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  fe25519 t1 = *x;\n  fe25519 t2 = *y;\n  fe25519_freeze(&t1);\n  fe25519_freeze(&t2);\n  for(i=0;i<32;i++)\n    if(t1.v[i] != t2.v[i]) return 0;\n  return 1;\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nint fe25519_iseq_vartime(const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  fe25519 t1 = *x;\n  fe25519 t2 = *y;\n  fe25519_freeze(&t1);\n  fe25519_freeze(&t2);\n  for(i=0;i<32;i++)\n    if(t1.v[i] != t2.v[i]) return 0;\n  return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_square",
          "args": [
            "&chk",
            "&r->x"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_square",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "213-216",
          "snippet": "void fe25519_square(fe25519 *r, const fe25519 *x)\n{\n  fe25519_mul(r, x, x);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_square(fe25519 *r, const fe25519 *x)\n{\n  fe25519_mul(r, x, x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_pow2523",
          "args": [
            "&t",
            "&t"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_pow2523",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "285-337",
          "snippet": "void fe25519_pow2523(fe25519 *r, const fe25519 *x)\n{\n\tfe25519 z2;\n\tfe25519 z9;\n\tfe25519 z11;\n\tfe25519 z2_5_0;\n\tfe25519 z2_10_0;\n\tfe25519 z2_20_0;\n\tfe25519 z2_50_0;\n\tfe25519 z2_100_0;\n\tfe25519 t;\n\tint i;\n\t\t\n\t/* 2 */ fe25519_square(&z2,x);\n\t/* 4 */ fe25519_square(&t,&z2);\n\t/* 8 */ fe25519_square(&t,&t);\n\t/* 9 */ fe25519_mul(&z9,&t,x);\n\t/* 11 */ fe25519_mul(&z11,&z9,&z2);\n\t/* 22 */ fe25519_square(&t,&z11);\n\t/* 2^5 - 2^0 = 31 */ fe25519_mul(&z2_5_0,&t,&z9);\n\n\t/* 2^6 - 2^1 */ fe25519_square(&t,&z2_5_0);\n\t/* 2^10 - 2^5 */ for (i = 1;i < 5;i++) { fe25519_square(&t,&t); }\n\t/* 2^10 - 2^0 */ fe25519_mul(&z2_10_0,&t,&z2_5_0);\n\n\t/* 2^11 - 2^1 */ fe25519_square(&t,&z2_10_0);\n\t/* 2^20 - 2^10 */ for (i = 1;i < 10;i++) { fe25519_square(&t,&t); }\n\t/* 2^20 - 2^0 */ fe25519_mul(&z2_20_0,&t,&z2_10_0);\n\n\t/* 2^21 - 2^1 */ fe25519_square(&t,&z2_20_0);\n\t/* 2^40 - 2^20 */ for (i = 1;i < 20;i++) { fe25519_square(&t,&t); }\n\t/* 2^40 - 2^0 */ fe25519_mul(&t,&t,&z2_20_0);\n\n\t/* 2^41 - 2^1 */ fe25519_square(&t,&t);\n\t/* 2^50 - 2^10 */ for (i = 1;i < 10;i++) { fe25519_square(&t,&t); }\n\t/* 2^50 - 2^0 */ fe25519_mul(&z2_50_0,&t,&z2_10_0);\n\n\t/* 2^51 - 2^1 */ fe25519_square(&t,&z2_50_0);\n\t/* 2^100 - 2^50 */ for (i = 1;i < 50;i++) { fe25519_square(&t,&t); }\n\t/* 2^100 - 2^0 */ fe25519_mul(&z2_100_0,&t,&z2_50_0);\n\n\t/* 2^101 - 2^1 */ fe25519_square(&t,&z2_100_0);\n\t/* 2^200 - 2^100 */ for (i = 1;i < 100;i++) { fe25519_square(&t,&t); }\n\t/* 2^200 - 2^0 */ fe25519_mul(&t,&t,&z2_100_0);\n\n\t/* 2^201 - 2^1 */ fe25519_square(&t,&t);\n\t/* 2^250 - 2^50 */ for (i = 1;i < 50;i++) { fe25519_square(&t,&t); }\n\t/* 2^250 - 2^0 */ fe25519_mul(&t,&t,&z2_50_0);\n\n\t/* 2^251 - 2^1 */ fe25519_square(&t,&t);\n\t/* 2^252 - 2^2 */ fe25519_square(&t,&t);\n\t/* 2^252 - 3 */ fe25519_mul(r,&t,x);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_pow2523(fe25519 *r, const fe25519 *x)\n{\n\tfe25519 z2;\n\tfe25519 z9;\n\tfe25519 z11;\n\tfe25519 z2_5_0;\n\tfe25519 z2_10_0;\n\tfe25519 z2_20_0;\n\tfe25519 z2_50_0;\n\tfe25519 z2_100_0;\n\tfe25519 t;\n\tint i;\n\t\t\n\t/* 2 */ fe25519_square(&z2,x);\n\t/* 4 */ fe25519_square(&t,&z2);\n\t/* 8 */ fe25519_square(&t,&t);\n\t/* 9 */ fe25519_mul(&z9,&t,x);\n\t/* 11 */ fe25519_mul(&z11,&z9,&z2);\n\t/* 22 */ fe25519_square(&t,&z11);\n\t/* 2^5 - 2^0 = 31 */ fe25519_mul(&z2_5_0,&t,&z9);\n\n\t/* 2^6 - 2^1 */ fe25519_square(&t,&z2_5_0);\n\t/* 2^10 - 2^5 */ for (i = 1;i < 5;i++) { fe25519_square(&t,&t); }\n\t/* 2^10 - 2^0 */ fe25519_mul(&z2_10_0,&t,&z2_5_0);\n\n\t/* 2^11 - 2^1 */ fe25519_square(&t,&z2_10_0);\n\t/* 2^20 - 2^10 */ for (i = 1;i < 10;i++) { fe25519_square(&t,&t); }\n\t/* 2^20 - 2^0 */ fe25519_mul(&z2_20_0,&t,&z2_10_0);\n\n\t/* 2^21 - 2^1 */ fe25519_square(&t,&z2_20_0);\n\t/* 2^40 - 2^20 */ for (i = 1;i < 20;i++) { fe25519_square(&t,&t); }\n\t/* 2^40 - 2^0 */ fe25519_mul(&t,&t,&z2_20_0);\n\n\t/* 2^41 - 2^1 */ fe25519_square(&t,&t);\n\t/* 2^50 - 2^10 */ for (i = 1;i < 10;i++) { fe25519_square(&t,&t); }\n\t/* 2^50 - 2^0 */ fe25519_mul(&z2_50_0,&t,&z2_10_0);\n\n\t/* 2^51 - 2^1 */ fe25519_square(&t,&z2_50_0);\n\t/* 2^100 - 2^50 */ for (i = 1;i < 50;i++) { fe25519_square(&t,&t); }\n\t/* 2^100 - 2^0 */ fe25519_mul(&z2_100_0,&t,&z2_50_0);\n\n\t/* 2^101 - 2^1 */ fe25519_square(&t,&z2_100_0);\n\t/* 2^200 - 2^100 */ for (i = 1;i < 100;i++) { fe25519_square(&t,&t); }\n\t/* 2^200 - 2^0 */ fe25519_mul(&t,&t,&z2_100_0);\n\n\t/* 2^201 - 2^1 */ fe25519_square(&t,&t);\n\t/* 2^250 - 2^50 */ for (i = 1;i < 50;i++) { fe25519_square(&t,&t); }\n\t/* 2^250 - 2^0 */ fe25519_mul(&t,&t,&z2_50_0);\n\n\t/* 2^251 - 2^1 */ fe25519_square(&t,&t);\n\t/* 2^252 - 2^2 */ fe25519_square(&t,&t);\n\t/* 2^252 - 3 */ fe25519_mul(r,&t,x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_add",
          "args": [
            "&den",
            "&r->z",
            "&den"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "178-183",
          "snippet": "void fe25519_add(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i] = x->v[i] + y->v[i];\n  reduce_add_sub(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_add(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i] = x->v[i] + y->v[i];\n  reduce_add_sub(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_sub",
          "args": [
            "&num",
            "&num",
            "&r->z"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "185-194",
          "snippet": "void fe25519_sub(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  crypto_uint32 t[32];\n  t[0] = x->v[0] + 0x1da;\n  t[31] = x->v[31] + 0xfe;\n  for(i=1;i<31;i++) t[i] = x->v[i] + 0x1fe;\n  for(i=0;i<32;i++) r->v[i] = t[i] - y->v[i];\n  reduce_add_sub(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_sub(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  crypto_uint32 t[32];\n  t[0] = x->v[0] + 0x1da;\n  t[31] = x->v[31] + 0xfe;\n  for(i=1;i<31;i++) t[i] = x->v[i] + 0x1fe;\n  for(i=0;i<32;i++) r->v[i] = t[i] - y->v[i];\n  reduce_add_sub(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_unpack",
          "args": [
            "&r->y",
            "p"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_unpack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "100-105",
          "snippet": "void fe25519_unpack(fe25519 *r, const unsigned char x[32])\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i] = x[i];\n  r->v[31] &= 127;\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_unpack(fe25519 *r, const unsigned char x[32])\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i] = x[i];\n  r->v[31] &= 127;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_setone",
          "args": [
            "&r->z"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_setone",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "156-161",
          "snippet": "void fe25519_setone(fe25519 *r)\n{\n  int i;\n  r->v[0] = 1;\n  for(i=1;i<32;i++) r->v[i]=0;\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_setone(fe25519 *r)\n{\n  int i;\n  r->v[0] = 1;\n  for(i=1;i<32;i++) r->v[i]=0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nstatic const fe25519 ge25519_ecd = {{0xA3, 0x78, 0x59, 0x13, 0xCA, 0x4D, 0xEB, 0x75, 0xAB, 0xD8, 0x41, 0x41, 0x4D, 0x0A, 0x70, 0x00, \n                      0x98, 0xE8, 0x79, 0x77, 0x79, 0x40, 0xC7, 0x8C, 0x73, 0xFE, 0x6F, 0x2B, 0xEE, 0x6C, 0x03, 0x52}};\nstatic const fe25519 ge25519_sqrtm1 = {{0xB0, 0xA0, 0x0E, 0x4A, 0x27, 0x1B, 0xEE, 0xC4, 0x78, 0xE4, 0x2F, 0xAD, 0x06, 0x18, 0x43, 0x2F, \n                         0xA7, 0xD7, 0xFB, 0x3D, 0x99, 0x00, 0x4D, 0x2B, 0x0B, 0xDF, 0xC1, 0x4F, 0x80, 0x24, 0x83, 0x2B}};\n\nint ge25519_unpackneg_vartime(ge25519_p3 *r, const unsigned char p[32])\n{\n  unsigned char par;\n  fe25519 t, chk, num, den, den2, den4, den6;\n  fe25519_setone(&r->z);\n  par = p[31] >> 7;\n  fe25519_unpack(&r->y, p); \n  fe25519_square(&num, &r->y); /* x = y^2 */\n  fe25519_mul(&den, &num, &ge25519_ecd); /* den = dy^2 */\n  fe25519_sub(&num, &num, &r->z); /* x = y^2-1 */\n  fe25519_add(&den, &r->z, &den); /* den = dy^2+1 */\n\n  /* Computation of sqrt(num/den) */\n  /* 1.: computation of num^((p-5)/8)*den^((7p-35)/8) = (num*den^7)^((p-5)/8) */\n  fe25519_square(&den2, &den);\n  fe25519_square(&den4, &den2);\n  fe25519_mul(&den6, &den4, &den2);\n  fe25519_mul(&t, &den6, &num);\n  fe25519_mul(&t, &t, &den);\n\n  fe25519_pow2523(&t, &t);\n  /* 2. computation of r->x = t * num * den^3 */\n  fe25519_mul(&t, &t, &num);\n  fe25519_mul(&t, &t, &den);\n  fe25519_mul(&t, &t, &den);\n  fe25519_mul(&r->x, &t, &den);\n\n  /* 3. Check whether sqrt computation gave correct result, multiply by sqrt(-1) if not: */\n  fe25519_square(&chk, &r->x);\n  fe25519_mul(&chk, &chk, &den);\n  if (!fe25519_iseq_vartime(&chk, &num))\n    fe25519_mul(&r->x, &r->x, &ge25519_sqrtm1);\n\n  /* 4. Now we have one of the two square roots, except if input was not a square */\n  fe25519_square(&chk, &r->x);\n  fe25519_mul(&chk, &chk, &den);\n  if (!fe25519_iseq_vartime(&chk, &num))\n    return -1;\n\n  /* 5. Choose the desired square root according to parity: */\n  if(fe25519_getparity(&r->x) != (1-par))\n    fe25519_neg(&r->x, &r->x);\n\n  fe25519_mul(&r->t, &r->x, &r->y);\n  return 0;\n}"
  },
  {
    "function_name": "setneutral",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "183-189",
    "snippet": "static void setneutral(ge25519 *r)\n{\n  fe25519_setzero(&r->x);\n  fe25519_setone(&r->y);\n  fe25519_setone(&r->z);\n  fe25519_setzero(&r->t);\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_setzero",
          "args": [
            "&r->t"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_setzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "163-167",
          "snippet": "void fe25519_setzero(fe25519 *r)\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i]=0;\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_setzero(fe25519 *r)\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i]=0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_setone",
          "args": [
            "&r->z"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_setone",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "156-161",
          "snippet": "void fe25519_setone(fe25519 *r)\n{\n  int i;\n  r->v[0] = 1;\n  for(i=1;i<32;i++) r->v[i]=0;\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_setone(fe25519 *r)\n{\n  int i;\n  r->v[0] = 1;\n  for(i=1;i<32;i++) r->v[i]=0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic void setneutral(ge25519 *r)\n{\n  fe25519_setzero(&r->x);\n  fe25519_setone(&r->y);\n  fe25519_setone(&r->z);\n  fe25519_setzero(&r->t);\n}"
  },
  {
    "function_name": "choose_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "170-181",
    "snippet": "static void choose_t(ge25519_aff *t, unsigned long long pos, signed char b)\n{\n  /* constant time */\n  fe25519 v;\n  *t = ge25519_base_multiples_affine[5*pos+0];\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+1],equal(b,1) | equal(b,-1));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+2],equal(b,2) | equal(b,-2));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+3],equal(b,3) | equal(b,-3));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+4],equal(b,-4));\n  fe25519_neg(&v, &t->x);\n  fe25519_cmov(&t->x, &v, negative(b));\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const ge25519_aff ge25519_base_multiples_affine[425] = {\n#include \"ge25519_base.data\"\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_cmov",
          "args": [
            "&t->x",
            "&v",
            "negative(b)"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_cmov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "141-147",
          "snippet": "void fe25519_cmov(fe25519 *r, const fe25519 *x, unsigned char b)\n{\n  int i;\n  crypto_uint32 mask = b;\n  mask = -mask;\n  for(i=0;i<32;i++) r->v[i] ^= mask & (x->v[i] ^ r->v[i]);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_cmov(fe25519 *r, const fe25519 *x, unsigned char b)\n{\n  int i;\n  crypto_uint32 mask = b;\n  mask = -mask;\n  for(i=0;i<32;i++) r->v[i] ^= mask & (x->v[i] ^ r->v[i]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "negative",
          "args": [
            "b"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "negative",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "163-168",
          "snippet": "static unsigned char negative(signed char b)\n{\n  unsigned long long x = b; /* 18446744073709551361..18446744073709551615: yes; 0..255: no */\n  x >>= 63; /* 1: yes; 0: no */\n  return x;\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic unsigned char negative(signed char b)\n{\n  unsigned long long x = b; /* 18446744073709551361..18446744073709551615: yes; 0..255: no */\n  x >>= 63; /* 1: yes; 0: no */\n  return x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_neg",
          "args": [
            "&v",
            "&t->x"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_neg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "169-176",
          "snippet": "void fe25519_neg(fe25519 *r, const fe25519 *x)\n{\n  fe25519 t;\n  int i;\n  for(i=0;i<32;i++) t.v[i]=x->v[i];\n  fe25519_setzero(r);\n  fe25519_sub(r, r, &t);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_neg(fe25519 *r, const fe25519 *x)\n{\n  fe25519 t;\n  int i;\n  for(i=0;i<32;i++) t.v[i]=x->v[i];\n  fe25519_setzero(r);\n  fe25519_sub(r, r, &t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmov_aff",
          "args": [
            "t",
            "&ge25519_base_multiples_affine[5*pos+4]",
            "equal(b,-4)"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "cmov_aff",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "146-150",
          "snippet": "static void cmov_aff(ge25519_aff *r, const ge25519_aff *p, unsigned char b)\n{\n  fe25519_cmov(&r->x, &p->x, b);\n  fe25519_cmov(&r->y, &p->y, b);\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic void cmov_aff(ge25519_aff *r, const ge25519_aff *p, unsigned char b)\n{\n  fe25519_cmov(&r->x, &p->x, b);\n  fe25519_cmov(&r->y, &p->y, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "equal",
          "args": [
            "b",
            "-4"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "152-161",
          "snippet": "static unsigned char equal(signed char b,signed char c)\n{\n  unsigned char ub = b;\n  unsigned char uc = c;\n  unsigned char x = ub ^ uc; /* 0: yes; 1..255: no */\n  crypto_uint32 y = x; /* 0: yes; 1..255: no */\n  y -= 1; /* 4294967295: yes; 0..254: no */\n  y >>= 31; /* 1: yes; 0: no */\n  return y;\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic unsigned char equal(signed char b,signed char c)\n{\n  unsigned char ub = b;\n  unsigned char uc = c;\n  unsigned char x = ub ^ uc; /* 0: yes; 1..255: no */\n  crypto_uint32 y = x; /* 0: yes; 1..255: no */\n  y -= 1; /* 4294967295: yes; 0..254: no */\n  y >>= 31; /* 1: yes; 0: no */\n  return y;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic const ge25519_aff ge25519_base_multiples_affine[425] = {\n#include \"ge25519_base.data\"\n};\n\nstatic void choose_t(ge25519_aff *t, unsigned long long pos, signed char b)\n{\n  /* constant time */\n  fe25519 v;\n  *t = ge25519_base_multiples_affine[5*pos+0];\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+1],equal(b,1) | equal(b,-1));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+2],equal(b,2) | equal(b,-2));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+3],equal(b,3) | equal(b,-3));\n  cmov_aff(t, &ge25519_base_multiples_affine[5*pos+4],equal(b,-4));\n  fe25519_neg(&v, &t->x);\n  fe25519_cmov(&t->x, &v, negative(b));\n}"
  },
  {
    "function_name": "negative",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "163-168",
    "snippet": "static unsigned char negative(signed char b)\n{\n  unsigned long long x = b; /* 18446744073709551361..18446744073709551615: yes; 0..255: no */\n  x >>= 63; /* 1: yes; 0: no */\n  return x;\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic unsigned char negative(signed char b)\n{\n  unsigned long long x = b; /* 18446744073709551361..18446744073709551615: yes; 0..255: no */\n  x >>= 63; /* 1: yes; 0: no */\n  return x;\n}"
  },
  {
    "function_name": "equal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "152-161",
    "snippet": "static unsigned char equal(signed char b,signed char c)\n{\n  unsigned char ub = b;\n  unsigned char uc = c;\n  unsigned char x = ub ^ uc; /* 0: yes; 1..255: no */\n  crypto_uint32 y = x; /* 0: yes; 1..255: no */\n  y -= 1; /* 4294967295: yes; 0..254: no */\n  y >>= 31; /* 1: yes; 0: no */\n  return y;\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic unsigned char equal(signed char b,signed char c)\n{\n  unsigned char ub = b;\n  unsigned char uc = c;\n  unsigned char x = ub ^ uc; /* 0: yes; 1..255: no */\n  crypto_uint32 y = x; /* 0: yes; 1..255: no */\n  y -= 1; /* 4294967295: yes; 0..254: no */\n  y >>= 31; /* 1: yes; 0: no */\n  return y;\n}"
  },
  {
    "function_name": "cmov_aff",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "146-150",
    "snippet": "static void cmov_aff(ge25519_aff *r, const ge25519_aff *p, unsigned char b)\n{\n  fe25519_cmov(&r->x, &p->x, b);\n  fe25519_cmov(&r->y, &p->y, b);\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_cmov",
          "args": [
            "&r->y",
            "&p->y",
            "b"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_cmov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "141-147",
          "snippet": "void fe25519_cmov(fe25519 *r, const fe25519 *x, unsigned char b)\n{\n  int i;\n  crypto_uint32 mask = b;\n  mask = -mask;\n  for(i=0;i<32;i++) r->v[i] ^= mask & (x->v[i] ^ r->v[i]);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_cmov(fe25519 *r, const fe25519 *x, unsigned char b)\n{\n  int i;\n  crypto_uint32 mask = b;\n  mask = -mask;\n  for(i=0;i<32;i++) r->v[i] ^= mask & (x->v[i] ^ r->v[i]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic void cmov_aff(ge25519_aff *r, const ge25519_aff *p, unsigned char b)\n{\n  fe25519_cmov(&r->x, &p->x, b);\n  fe25519_cmov(&r->y, &p->y, b);\n}"
  },
  {
    "function_name": "dbl_p1p1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "127-143",
    "snippet": "static void dbl_p1p1(ge25519_p1p1 *r, const ge25519_p2 *p)\n{\n  fe25519 a,b,c,d;\n  fe25519_square(&a, &p->x);\n  fe25519_square(&b, &p->y);\n  fe25519_square(&c, &p->z);\n  fe25519_add(&c, &c, &c);\n  fe25519_neg(&d, &a);\n\n  fe25519_add(&r->x, &p->x, &p->y);\n  fe25519_square(&r->x, &r->x);\n  fe25519_sub(&r->x, &r->x, &a);\n  fe25519_sub(&r->x, &r->x, &b);\n  fe25519_add(&r->z, &d, &b);\n  fe25519_sub(&r->t, &r->z, &c);\n  fe25519_sub(&r->y, &d, &b);\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_sub",
          "args": [
            "&r->y",
            "&d",
            "&b"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "185-194",
          "snippet": "void fe25519_sub(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  crypto_uint32 t[32];\n  t[0] = x->v[0] + 0x1da;\n  t[31] = x->v[31] + 0xfe;\n  for(i=1;i<31;i++) t[i] = x->v[i] + 0x1fe;\n  for(i=0;i<32;i++) r->v[i] = t[i] - y->v[i];\n  reduce_add_sub(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_sub(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  crypto_uint32 t[32];\n  t[0] = x->v[0] + 0x1da;\n  t[31] = x->v[31] + 0xfe;\n  for(i=1;i<31;i++) t[i] = x->v[i] + 0x1fe;\n  for(i=0;i<32;i++) r->v[i] = t[i] - y->v[i];\n  reduce_add_sub(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_add",
          "args": [
            "&r->z",
            "&d",
            "&b"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "178-183",
          "snippet": "void fe25519_add(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i] = x->v[i] + y->v[i];\n  reduce_add_sub(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_add(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i] = x->v[i] + y->v[i];\n  reduce_add_sub(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_square",
          "args": [
            "&r->x",
            "&r->x"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_square",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "213-216",
          "snippet": "void fe25519_square(fe25519 *r, const fe25519 *x)\n{\n  fe25519_mul(r, x, x);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_square(fe25519 *r, const fe25519 *x)\n{\n  fe25519_mul(r, x, x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_neg",
          "args": [
            "&d",
            "&a"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_neg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "169-176",
          "snippet": "void fe25519_neg(fe25519 *r, const fe25519 *x)\n{\n  fe25519 t;\n  int i;\n  for(i=0;i<32;i++) t.v[i]=x->v[i];\n  fe25519_setzero(r);\n  fe25519_sub(r, r, &t);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_neg(fe25519 *r, const fe25519 *x)\n{\n  fe25519 t;\n  int i;\n  for(i=0;i<32;i++) t.v[i]=x->v[i];\n  fe25519_setzero(r);\n  fe25519_sub(r, r, &t);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic void dbl_p1p1(ge25519_p1p1 *r, const ge25519_p2 *p)\n{\n  fe25519 a,b,c,d;\n  fe25519_square(&a, &p->x);\n  fe25519_square(&b, &p->y);\n  fe25519_square(&c, &p->z);\n  fe25519_add(&c, &c, &c);\n  fe25519_neg(&d, &a);\n\n  fe25519_add(&r->x, &p->x, &p->y);\n  fe25519_square(&r->x, &r->x);\n  fe25519_sub(&r->x, &r->x, &a);\n  fe25519_sub(&r->x, &r->x, &b);\n  fe25519_add(&r->z, &d, &b);\n  fe25519_sub(&r->t, &r->z, &c);\n  fe25519_sub(&r->y, &d, &b);\n}"
  },
  {
    "function_name": "add_p1p1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "106-124",
    "snippet": "static void add_p1p1(ge25519_p1p1 *r, const ge25519_p3 *p, const ge25519_p3 *q)\n{\n  fe25519 a, b, c, d, t;\n  \n  fe25519_sub(&a, &p->y, &p->x); /* A = (Y1-X1)*(Y2-X2) */\n  fe25519_sub(&t, &q->y, &q->x);\n  fe25519_mul(&a, &a, &t);\n  fe25519_add(&b, &p->x, &p->y); /* B = (Y1+X1)*(Y2+X2) */\n  fe25519_add(&t, &q->x, &q->y);\n  fe25519_mul(&b, &b, &t);\n  fe25519_mul(&c, &p->t, &q->t); /* C = T1*k*T2 */\n  fe25519_mul(&c, &c, &ge25519_ec2d);\n  fe25519_mul(&d, &p->z, &q->z); /* D = Z1*2*Z2 */\n  fe25519_add(&d, &d, &d);\n  fe25519_sub(&r->x, &b, &a); /* E = B-A */\n  fe25519_sub(&r->t, &d, &c); /* F = D-C */\n  fe25519_add(&r->z, &d, &c); /* G = D+C */\n  fe25519_add(&r->y, &b, &a); /* H = B+A */\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define ge25519_p3 ge25519"
    ],
    "globals_used": [
      "static const fe25519 ge25519_ec2d = {{0x59, 0xF1, 0xB2, 0x26, 0x94, 0x9B, 0xD6, 0xEB, 0x56, 0xB1, 0x83, 0x82, 0x9A, 0x14, 0xE0, 0x00, \n                       0x30, 0xD1, 0xF3, 0xEE, 0xF2, 0x80, 0x8E, 0x19, 0xE7, 0xFC, 0xDF, 0x56, 0xDC, 0xD9, 0x06, 0x24}};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_add",
          "args": [
            "&r->y",
            "&b",
            "&a"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "178-183",
          "snippet": "void fe25519_add(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i] = x->v[i] + y->v[i];\n  reduce_add_sub(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_add(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i] = x->v[i] + y->v[i];\n  reduce_add_sub(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_sub",
          "args": [
            "&r->t",
            "&d",
            "&c"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "185-194",
          "snippet": "void fe25519_sub(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  crypto_uint32 t[32];\n  t[0] = x->v[0] + 0x1da;\n  t[31] = x->v[31] + 0xfe;\n  for(i=1;i<31;i++) t[i] = x->v[i] + 0x1fe;\n  for(i=0;i<32;i++) r->v[i] = t[i] - y->v[i];\n  reduce_add_sub(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_sub(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  crypto_uint32 t[32];\n  t[0] = x->v[0] + 0x1da;\n  t[31] = x->v[31] + 0xfe;\n  for(i=1;i<31;i++) t[i] = x->v[i] + 0x1fe;\n  for(i=0;i<32;i++) r->v[i] = t[i] - y->v[i];\n  reduce_add_sub(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_mul",
          "args": [
            "&d",
            "&p->z",
            "&q->z"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_mul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "196-211",
          "snippet": "void fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nstatic const fe25519 ge25519_ec2d = {{0x59, 0xF1, 0xB2, 0x26, 0x94, 0x9B, 0xD6, 0xEB, 0x56, 0xB1, 0x83, 0x82, 0x9A, 0x14, 0xE0, 0x00, \n                       0x30, 0xD1, 0xF3, 0xEE, 0xF2, 0x80, 0x8E, 0x19, 0xE7, 0xFC, 0xDF, 0x56, 0xDC, 0xD9, 0x06, 0x24}};\n\nstatic void add_p1p1(ge25519_p1p1 *r, const ge25519_p3 *p, const ge25519_p3 *q)\n{\n  fe25519 a, b, c, d, t;\n  \n  fe25519_sub(&a, &p->y, &p->x); /* A = (Y1-X1)*(Y2-X2) */\n  fe25519_sub(&t, &q->y, &q->x);\n  fe25519_mul(&a, &a, &t);\n  fe25519_add(&b, &p->x, &p->y); /* B = (Y1+X1)*(Y2+X2) */\n  fe25519_add(&t, &q->x, &q->y);\n  fe25519_mul(&b, &b, &t);\n  fe25519_mul(&c, &p->t, &q->t); /* C = T1*k*T2 */\n  fe25519_mul(&c, &c, &ge25519_ec2d);\n  fe25519_mul(&d, &p->z, &q->z); /* D = Z1*2*Z2 */\n  fe25519_add(&d, &d, &d);\n  fe25519_sub(&r->x, &b, &a); /* E = B-A */\n  fe25519_sub(&r->t, &d, &c); /* F = D-C */\n  fe25519_add(&r->z, &d, &c); /* G = D+C */\n  fe25519_add(&r->y, &b, &a); /* H = B+A */\n}"
  },
  {
    "function_name": "ge25519_mixadd2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "83-104",
    "snippet": "static void ge25519_mixadd2(ge25519_p3 *r, const ge25519_aff *q)\n{\n  fe25519 a,b,t1,t2,c,d,e,f,g,h,qt;\n  fe25519_mul(&qt, &q->x, &q->y);\n  fe25519_sub(&a, &r->y, &r->x); /* A = (Y1-X1)*(Y2-X2) */\n  fe25519_add(&b, &r->y, &r->x); /* B = (Y1+X1)*(Y2+X2) */\n  fe25519_sub(&t1, &q->y, &q->x);\n  fe25519_add(&t2, &q->y, &q->x);\n  fe25519_mul(&a, &a, &t1);\n  fe25519_mul(&b, &b, &t2);\n  fe25519_sub(&e, &b, &a); /* E = B-A */\n  fe25519_add(&h, &b, &a); /* H = B+A */\n  fe25519_mul(&c, &r->t, &qt); /* C = T1*k*T2 */\n  fe25519_mul(&c, &c, &ge25519_ec2d);\n  fe25519_add(&d, &r->z, &r->z); /* D = Z1*2 */\n  fe25519_sub(&f, &d, &c); /* F = D-C */\n  fe25519_add(&g, &d, &c); /* G = D+C */\n  fe25519_mul(&r->x, &e, &f);\n  fe25519_mul(&r->y, &h, &g);\n  fe25519_mul(&r->z, &g, &f);\n  fe25519_mul(&r->t, &e, &h);\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define ge25519_p3 ge25519"
    ],
    "globals_used": [
      "static const fe25519 ge25519_ec2d = {{0x59, 0xF1, 0xB2, 0x26, 0x94, 0x9B, 0xD6, 0xEB, 0x56, 0xB1, 0x83, 0x82, 0x9A, 0x14, 0xE0, 0x00, \n                       0x30, 0xD1, 0xF3, 0xEE, 0xF2, 0x80, 0x8E, 0x19, 0xE7, 0xFC, 0xDF, 0x56, 0xDC, 0xD9, 0x06, 0x24}};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_mul",
          "args": [
            "&r->t",
            "&e",
            "&h"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_mul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "196-211",
          "snippet": "void fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_add",
          "args": [
            "&g",
            "&d",
            "&c"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "178-183",
          "snippet": "void fe25519_add(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i] = x->v[i] + y->v[i];\n  reduce_add_sub(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_add(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  for(i=0;i<32;i++) r->v[i] = x->v[i] + y->v[i];\n  reduce_add_sub(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fe25519_sub",
          "args": [
            "&f",
            "&d",
            "&c"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "185-194",
          "snippet": "void fe25519_sub(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  crypto_uint32 t[32];\n  t[0] = x->v[0] + 0x1da;\n  t[31] = x->v[31] + 0xfe;\n  for(i=1;i<31;i++) t[i] = x->v[i] + 0x1fe;\n  for(i=0;i<32;i++) r->v[i] = t[i] - y->v[i];\n  reduce_add_sub(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_sub(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i;\n  crypto_uint32 t[32];\n  t[0] = x->v[0] + 0x1da;\n  t[31] = x->v[31] + 0xfe;\n  for(i=1;i<31;i++) t[i] = x->v[i] + 0x1fe;\n  for(i=0;i<32;i++) r->v[i] = t[i] - y->v[i];\n  reduce_add_sub(r);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nstatic const fe25519 ge25519_ec2d = {{0x59, 0xF1, 0xB2, 0x26, 0x94, 0x9B, 0xD6, 0xEB, 0x56, 0xB1, 0x83, 0x82, 0x9A, 0x14, 0xE0, 0x00, \n                       0x30, 0xD1, 0xF3, 0xEE, 0xF2, 0x80, 0x8E, 0x19, 0xE7, 0xFC, 0xDF, 0x56, 0xDC, 0xD9, 0x06, 0x24}};\n\nstatic void ge25519_mixadd2(ge25519_p3 *r, const ge25519_aff *q)\n{\n  fe25519 a,b,t1,t2,c,d,e,f,g,h,qt;\n  fe25519_mul(&qt, &q->x, &q->y);\n  fe25519_sub(&a, &r->y, &r->x); /* A = (Y1-X1)*(Y2-X2) */\n  fe25519_add(&b, &r->y, &r->x); /* B = (Y1+X1)*(Y2+X2) */\n  fe25519_sub(&t1, &q->y, &q->x);\n  fe25519_add(&t2, &q->y, &q->x);\n  fe25519_mul(&a, &a, &t1);\n  fe25519_mul(&b, &b, &t2);\n  fe25519_sub(&e, &b, &a); /* E = B-A */\n  fe25519_add(&h, &b, &a); /* H = B+A */\n  fe25519_mul(&c, &r->t, &qt); /* C = T1*k*T2 */\n  fe25519_mul(&c, &c, &ge25519_ec2d);\n  fe25519_add(&d, &r->z, &r->z); /* D = Z1*2 */\n  fe25519_sub(&f, &d, &c); /* F = D-C */\n  fe25519_add(&g, &d, &c); /* G = D+C */\n  fe25519_mul(&r->x, &e, &f);\n  fe25519_mul(&r->y, &h, &g);\n  fe25519_mul(&r->z, &g, &f);\n  fe25519_mul(&r->t, &e, &h);\n}"
  },
  {
    "function_name": "p1p1_to_p3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "77-81",
    "snippet": "static void p1p1_to_p3(ge25519_p3 *r, const ge25519_p1p1 *p)\n{\n  p1p1_to_p2((ge25519_p2 *)r, p);\n  fe25519_mul(&r->t, &p->x, &p->y);\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define ge25519_p3 ge25519"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_mul",
          "args": [
            "&r->t",
            "&p->x",
            "&p->y"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_mul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "196-211",
          "snippet": "void fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p1p1_to_p2",
          "args": [
            "(ge25519_p2 *)r",
            "p"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "p1p1_to_p2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
          "lines": "70-75",
          "snippet": "static void p1p1_to_p2(ge25519_p2 *r, const ge25519_p1p1 *p)\n{\n  fe25519_mul(&r->x, &p->x, &p->t);\n  fe25519_mul(&r->y, &p->y, &p->z);\n  fe25519_mul(&r->z, &p->z, &p->t);\n}",
          "includes": [
            "#include \"ge25519.h\"",
            "#include \"sc25519.h\"",
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic void p1p1_to_p2(ge25519_p2 *r, const ge25519_p1p1 *p)\n{\n  fe25519_mul(&r->x, &p->x, &p->t);\n  fe25519_mul(&r->y, &p->y, &p->z);\n  fe25519_mul(&r->z, &p->z, &p->t);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\n#define ge25519_p3 ge25519\n\nstatic void p1p1_to_p3(ge25519_p3 *r, const ge25519_p1p1 *p)\n{\n  p1p1_to_p2((ge25519_p2 *)r, p);\n  fe25519_mul(&r->t, &p->x, &p->y);\n}"
  },
  {
    "function_name": "p1p1_to_p2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ge25519.c",
    "lines": "70-75",
    "snippet": "static void p1p1_to_p2(ge25519_p2 *r, const ge25519_p1p1 *p)\n{\n  fe25519_mul(&r->x, &p->x, &p->t);\n  fe25519_mul(&r->y, &p->y, &p->z);\n  fe25519_mul(&r->z, &p->z, &p->t);\n}",
    "includes": [
      "#include \"ge25519.h\"",
      "#include \"sc25519.h\"",
      "#include \"fe25519.h\"",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fe25519_mul",
          "args": [
            "&r->z",
            "&p->z",
            "&p->t"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "fe25519_mul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fe25519.c",
          "lines": "196-211",
          "snippet": "void fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}",
          "includes": [
            "#include \"fe25519.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fe25519.h\"\n#include \"includes.h\"\n\nvoid fe25519_mul(fe25519 *r, const fe25519 *x, const fe25519 *y)\n{\n  int i,j;\n  crypto_uint32 t[63];\n  for(i=0;i<63;i++)t[i] = 0;\n\n  for(i=0;i<32;i++)\n    for(j=0;j<32;j++)\n      t[i+j] += x->v[i] * y->v[j];\n\n  for(i=32;i<63;i++)\n    r->v[i-32] = t[i-32] + times38(t[i]); \n  r->v[31] = t[31]; /* result now in r[0]...r[31] */\n\n  reduce_mul(r);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ge25519.h\"\n#include \"sc25519.h\"\n#include \"fe25519.h\"\n#include \"includes.h\"\n\nstatic void p1p1_to_p2(ge25519_p2 *r, const ge25519_p1p1 *p)\n{\n  fe25519_mul(&r->x, &p->x, &p->t);\n  fe25519_mul(&r->y, &p->y, &p->z);\n  fe25519_mul(&r->z, &p->z, &p->t);\n}"
  }
]