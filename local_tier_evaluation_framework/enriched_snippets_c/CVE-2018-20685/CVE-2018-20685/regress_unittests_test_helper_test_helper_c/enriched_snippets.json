[
  {
    "function_name": "assert_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "538-547",
    "snippet": "void\nassert_ptr(const char *file, int line, const char *a1, const char *a2,\n    const void *aa1, const void *aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"PTR\", pred);\n\tfprintf(stderr, \"%12s = %p\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %p\\n\", a2, aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %p\\n\"",
            "a2",
            "aa2"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %p\\n\"",
            "a1",
            "aa1"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"PTR\"",
            "pred"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_ptr(const char *file, int line, const char *a1, const char *a2,\n    const void *aa1, const void *aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"PTR\", pred);\n\tfprintf(stderr, \"%12s = %p\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %p\\n\", a2, aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_u64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "525-536",
    "snippet": "void\nassert_u64(const char *file, int line, const char *a1, const char *a2,\n    u_int64_t aa1, u_int64_t aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"U64\", pred);\n\tfprintf(stderr, \"%12s = 0x%016llx %llu\\n\", a1,\n\t    (unsigned long long)aa1, (unsigned long long)aa1);\n\tfprintf(stderr, \"%12s = 0x%016llx %llu\\n\", a2,\n\t    (unsigned long long)aa2, (unsigned long long)aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = 0x%016llx %llu\\n\"",
            "a2",
            "(unsigned long long)aa2",
            "(unsigned long long)aa2"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = 0x%016llx %llu\\n\"",
            "a1",
            "(unsigned long long)aa1",
            "(unsigned long long)aa1"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"U64\"",
            "pred"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_u64(const char *file, int line, const char *a1, const char *a2,\n    u_int64_t aa1, u_int64_t aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"U64\", pred);\n\tfprintf(stderr, \"%12s = 0x%016llx %llu\\n\", a1,\n\t    (unsigned long long)aa1, (unsigned long long)aa1);\n\tfprintf(stderr, \"%12s = 0x%016llx %llu\\n\", a2,\n\t    (unsigned long long)aa2, (unsigned long long)aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_u32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "514-523",
    "snippet": "void\nassert_u32(const char *file, int line, const char *a1, const char *a2,\n    u_int32_t aa1, u_int32_t aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"U32\", pred);\n\tfprintf(stderr, \"%12s = 0x%08x %u\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = 0x%08x %u\\n\", a2, aa2, aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = 0x%08x %u\\n\"",
            "a2",
            "aa2",
            "aa2"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = 0x%08x %u\\n\"",
            "a1",
            "aa1",
            "aa1"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"U32\"",
            "pred"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_u32(const char *file, int line, const char *a1, const char *a2,\n    u_int32_t aa1, u_int32_t aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"U32\", pred);\n\tfprintf(stderr, \"%12s = 0x%08x %u\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = 0x%08x %u\\n\", a2, aa2, aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_u16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "503-512",
    "snippet": "void\nassert_u16(const char *file, int line, const char *a1, const char *a2,\n    u_int16_t aa1, u_int16_t aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"U16\", pred);\n\tfprintf(stderr, \"%12s = 0x%04x %u\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = 0x%04x %u\\n\", a2, aa2, aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = 0x%04x %u\\n\"",
            "a2",
            "aa2",
            "aa2"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = 0x%04x %u\\n\"",
            "a1",
            "aa1",
            "aa1"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"U16\"",
            "pred"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_u16(const char *file, int line, const char *a1, const char *a2,\n    u_int16_t aa1, u_int16_t aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"U16\", pred);\n\tfprintf(stderr, \"%12s = 0x%04x %u\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = 0x%04x %u\\n\", a2, aa2, aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_u8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "492-501",
    "snippet": "void\nassert_u8(const char *file, int line, const char *a1, const char *a2,\n    u_int8_t aa1, u_int8_t aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"U8\", pred);\n\tfprintf(stderr, \"%12s = 0x%02x %u\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = 0x%02x %u\\n\", a2, aa2, aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = 0x%02x %u\\n\"",
            "a2",
            "aa2",
            "aa2"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = 0x%02x %u\\n\"",
            "a1",
            "aa1",
            "aa1"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"U8\"",
            "pred"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_u8(const char *file, int line, const char *a1, const char *a2,\n    u_int8_t aa1, u_int8_t aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"U8\", pred);\n\tfprintf(stderr, \"%12s = 0x%02x %u\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = 0x%02x %u\\n\", a2, aa2, aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_char",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "477-490",
    "snippet": "void\nassert_char(const char *file, int line, const char *a1, const char *a2,\n    char aa1, char aa2, enum test_predicate pred)\n{\n\tchar buf[8];\n\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"CHAR\", pred);\n\tfprintf(stderr, \"%12s = '%s' / 0x02%x\\n\", a1,\n\t    vis(buf, aa1, VIS_SAFE|VIS_NL|VIS_TAB|VIS_OCTAL, 0), aa1);\n\tfprintf(stderr, \"%12s = '%s' / 0x02%x\\n\", a1,\n\t    vis(buf, aa2, VIS_SAFE|VIS_NL|VIS_TAB|VIS_OCTAL, 0), aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = '%s' / 0x02%x\\n\"",
            "a1",
            "vis(buf, aa2, VIS_SAFE|VIS_NL|VIS_TAB|VIS_OCTAL, 0)",
            "aa2"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vis",
          "args": [
            "buf",
            "aa2",
            "VIS_SAFE|VIS_NL|VIS_TAB|VIS_OCTAL",
            "0"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "strvisx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/vis.c",
          "lines": "235-249",
          "snippet": "int\nstrvisx(char *dst, const char *src, size_t len, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; len > 1; len--) {\n\t\tc = *src;\n\t\tdst = vis(dst, c, flag, *++src);\n\t}\n\tif (len)\n\t\tdst = vis(dst, *src, flag, '\\0');\n\t*dst = '\\0';\n\treturn (dst - start);\n}",
          "includes": [
            "#include \"vis.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vis.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <ctype.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nstrvisx(char *dst, const char *src, size_t len, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; len > 1; len--) {\n\t\tc = *src;\n\t\tdst = vis(dst, c, flag, *++src);\n\t}\n\tif (len)\n\t\tdst = vis(dst, *src, flag, '\\0');\n\t*dst = '\\0';\n\treturn (dst - start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = '%s' / 0x02%x\\n\"",
            "a1",
            "vis(buf, aa1, VIS_SAFE|VIS_NL|VIS_TAB|VIS_OCTAL, 0)",
            "aa1"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"CHAR\"",
            "pred"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_char(const char *file, int line, const char *a1, const char *a2,\n    char aa1, char aa2, enum test_predicate pred)\n{\n\tchar buf[8];\n\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"CHAR\", pred);\n\tfprintf(stderr, \"%12s = '%s' / 0x02%x\\n\", a1,\n\t    vis(buf, aa1, VIS_SAFE|VIS_NL|VIS_TAB|VIS_OCTAL, 0), aa1);\n\tfprintf(stderr, \"%12s = '%s' / 0x02%x\\n\", a1,\n\t    vis(buf, aa2, VIS_SAFE|VIS_NL|VIS_TAB|VIS_OCTAL, 0), aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_long_long",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "466-475",
    "snippet": "void\nassert_long_long(const char *file, int line, const char *a1, const char *a2,\n    long long aa1, long long aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"LONG LONG\", pred);\n\tfprintf(stderr, \"%12s = %lld / 0x%llx\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = %lld / 0x%llx\\n\", a2, aa2, aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %lld / 0x%llx\\n\"",
            "a2",
            "aa2",
            "aa2"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %lld / 0x%llx\\n\"",
            "a1",
            "aa1",
            "aa1"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"LONG LONG\"",
            "pred"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_long_long(const char *file, int line, const char *a1, const char *a2,\n    long long aa1, long long aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"LONG LONG\", pred);\n\tfprintf(stderr, \"%12s = %lld / 0x%llx\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = %lld / 0x%llx\\n\", a2, aa2, aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_long",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "455-464",
    "snippet": "void\nassert_long(const char *file, int line, const char *a1, const char *a2,\n    long aa1, long aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"LONG\", pred);\n\tfprintf(stderr, \"%12s = %ld / 0x%lx\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = %ld / 0x%lx\\n\", a2, aa2, aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %ld / 0x%lx\\n\"",
            "a2",
            "aa2",
            "aa2"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %ld / 0x%lx\\n\"",
            "a1",
            "aa1",
            "aa1"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"LONG\"",
            "pred"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_long(const char *file, int line, const char *a1, const char *a2,\n    long aa1, long aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"LONG\", pred);\n\tfprintf(stderr, \"%12s = %ld / 0x%lx\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = %ld / 0x%lx\\n\", a2, aa2, aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_u_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "444-453",
    "snippet": "void\nassert_u_int(const char *file, int line, const char *a1, const char *a2,\n    u_int aa1, u_int aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"U_INT\", pred);\n\tfprintf(stderr, \"%12s = %u / 0x%x\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = %u / 0x%x\\n\", a2, aa2, aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %u / 0x%x\\n\"",
            "a2",
            "aa2",
            "aa2"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %u / 0x%x\\n\"",
            "a1",
            "aa1",
            "aa1"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"U_INT\"",
            "pred"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_u_int(const char *file, int line, const char *a1, const char *a2,\n    u_int aa1, u_int aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"U_INT\", pred);\n\tfprintf(stderr, \"%12s = %u / 0x%x\\n\", a1, aa1, aa1);\n\tfprintf(stderr, \"%12s = %u / 0x%x\\n\", a2, aa2, aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_size_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "433-442",
    "snippet": "void\nassert_size_t(const char *file, int line, const char *a1, const char *a2,\n    size_t aa1, size_t aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"SIZE_T\", pred);\n\tfprintf(stderr, \"%12s = %zu\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %zu\\n\", a2, aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %zu\\n\"",
            "a2",
            "aa2"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %zu\\n\"",
            "a1",
            "aa1"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"SIZE_T\"",
            "pred"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_size_t(const char *file, int line, const char *a1, const char *a2,\n    size_t aa1, size_t aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"SIZE_T\", pred);\n\tfprintf(stderr, \"%12s = %zu\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %zu\\n\", a2, aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "422-431",
    "snippet": "void\nassert_int(const char *file, int line, const char *a1, const char *a2,\n    int aa1, int aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"INT\", pred);\n\tfprintf(stderr, \"%12s = %d\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %d\\n\", a2, aa2);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %d\\n\"",
            "a2",
            "aa2"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %d\\n\"",
            "a1",
            "aa1"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"INT\"",
            "pred"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK",
          "args": [
            "aa1",
            "aa2",
            "pred"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_int(const char *file, int line, const char *a1, const char *a2,\n    int aa1, int aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"INT\", pred);\n\tfprintf(stderr, \"%12s = %d\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %d\\n\", a2, aa2);\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_mem_filled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "398-420",
    "snippet": "void\nassert_mem_filled(const char *file, int line, const char *a1,\n    const void *aa1, u_char v, size_t l, enum test_predicate pred)\n{\n\tsize_t where = -1;\n\tint r;\n\tchar tmp[64];\n\n\tif (l == 0)\n\t\treturn;\n\t/* If length is >0, then verify the pointer is not NULL */\n\tassert_ptr(file, line, a1, \"NULL\", aa1, NULL, TEST_NE);\n\n\tr = memvalcmp(aa1, v, l, &where);\n\tTEST_CHECK_INT(r, pred);\n\ttest_header(file, line, a1, NULL, \"MEM_ZERO\", pred);\n\tfprintf(stderr, \"%20s = %s%s (len %zu)\\n\", a1,\n\t    tohex(aa1, MIN(l, 20)), l > 20 ? \"...\" : \"\", l);\n\tsnprintf(tmp, sizeof(tmp), \"(%s)[%zu]\", a1, where);\n\tfprintf(stderr, \"%20s = 0x%02x (expected 0x%02x)\\n\", tmp,\n\t    ((u_char *)aa1)[where], v);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%20s = 0x%02x (expected 0x%02x)\\n\"",
            "tmp",
            "((u_char *)aa1)[where]",
            "v"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "tmp",
            "sizeof(tmp)",
            "\"(%s)[%zu]\"",
            "a1",
            "where"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-snprintf.c",
          "lines": "869-879",
          "snippet": "int\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nint\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%20s = %s%s (len %zu)\\n\"",
            "a1",
            "tohex(aa1, MIN(l, 20))",
            "l > 20 ? \"...\" : \"\"",
            "l"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tohex",
          "args": [
            "aa1",
            "MIN(l, 20)"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "tohex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "347-362",
          "snippet": "static char *\ntohex(const void *_s, size_t l)\n{\n\tu_int8_t *s = (u_int8_t *)_s;\n\tsize_t i, j;\n\tconst char *hex = \"0123456789abcdef\";\n\tchar *r = malloc((l * 2) + 1);\n\n\tassert(r != NULL);\n\tfor (i = j = 0; i < l; i++) {\n\t\tr[j++] = hex[(s[i] >> 4) & 0xf];\n\t\tr[j++] = hex[s[i] & 0xf];\n\t}\n\tr[j] = '\\0';\n\treturn r;\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\ntohex(const void *_s, size_t l)\n{\n\tu_int8_t *s = (u_int8_t *)_s;\n\tsize_t i, j;\n\tconst char *hex = \"0123456789abcdef\";\n\tchar *r = malloc((l * 2) + 1);\n\n\tassert(r != NULL);\n\tfor (i = j = 0; i < l; i++) {\n\t\tr[j++] = hex[(s[i] >> 4) & 0xf];\n\t\tr[j++] = hex[s[i] & 0xf];\n\t}\n\tr[j] = '\\0';\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MIN",
          "args": [
            "l",
            "20"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "_SPLAY_MINMAX",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sys-tree.h",
          "lines": "247-278",
          "snippet": "void name##_SPLAY_MINMAX(struct name *head, int __comp) \\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct type __node, *__left, *__right, *__tmp;\t\t\t\\\n\\\n\tSPLAY_LEFT(&__node, field) = SPLAY_RIGHT(&__node, field) = NULL;\\\n\t__left = __right = &__node;\t\t\t\t\t\\\n\\\n\twhile (1) {\t\t\t\t\t\t\t\\\n\t\tif (__comp < 0) {\t\t\t\t\t\\\n\t\t\t__tmp = SPLAY_LEFT((head)->sph_root, field);\t\\\n\t\t\tif (__tmp == NULL)\t\t\t\t\\\n\t\t\t\tbreak;\t\t\t\t\t\\\n\t\t\tif (__comp < 0){\t\t\t\t\\\n\t\t\t\tSPLAY_ROTATE_RIGHT(head, __tmp, field);\t\\\n\t\t\t\tif (SPLAY_LEFT((head)->sph_root, field) == NULL)\\\n\t\t\t\t\tbreak;\t\t\t\t\\\n\t\t\t}\t\t\t\t\t\t\\\n\t\t\tSPLAY_LINKLEFT(head, __right, field);\t\t\\\n\t\t} else if (__comp > 0) {\t\t\t\t\\\n\t\t\t__tmp = SPLAY_RIGHT((head)->sph_root, field);\t\\\n\t\t\tif (__tmp == NULL)\t\t\t\t\\\n\t\t\t\tbreak;\t\t\t\t\t\\\n\t\t\tif (__comp > 0) {\t\t\t\t\\\n\t\t\t\tSPLAY_ROTATE_LEFT(head, __tmp, field);\t\\\n\t\t\t\tif (SPLAY_RIGHT((head)->sph_root, field) == NULL)\\\n\t\t\t\t\tbreak;\t\t\t\t\\\n\t\t\t}\t\t\t\t\t\t\\\n\t\t\tSPLAY_LINKRIGHT(head, __left, field);\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\tSPLAY_ASSEMBLE(head, &__node, __left, __right, field);\t\t\\\n}",
          "includes": [
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n\nvoid name##_SPLAY_MINMAX(struct name *head, int __comp) \\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct type __node, *__left, *__right, *__tmp;\t\t\t\\\n\\\n\tSPLAY_LEFT(&__node, field) = SPLAY_RIGHT(&__node, field) = NULL;\\\n\t__left = __right = &__node;\t\t\t\t\t\\\n\\\n\twhile (1) {\t\t\t\t\t\t\t\\\n\t\tif (__comp < 0) {\t\t\t\t\t\\\n\t\t\t__tmp = SPLAY_LEFT((head)->sph_root, field);\t\\\n\t\t\tif (__tmp == NULL)\t\t\t\t\\\n\t\t\t\tbreak;\t\t\t\t\t\\\n\t\t\tif (__comp < 0){\t\t\t\t\\\n\t\t\t\tSPLAY_ROTATE_RIGHT(head, __tmp, field);\t\\\n\t\t\t\tif (SPLAY_LEFT((head)->sph_root, field) == NULL)\\\n\t\t\t\t\tbreak;\t\t\t\t\\\n\t\t\t}\t\t\t\t\t\t\\\n\t\t\tSPLAY_LINKLEFT(head, __right, field);\t\t\\\n\t\t} else if (__comp > 0) {\t\t\t\t\\\n\t\t\t__tmp = SPLAY_RIGHT((head)->sph_root, field);\t\\\n\t\t\tif (__tmp == NULL)\t\t\t\t\\\n\t\t\t\tbreak;\t\t\t\t\t\\\n\t\t\tif (__comp > 0) {\t\t\t\t\\\n\t\t\t\tSPLAY_ROTATE_LEFT(head, __tmp, field);\t\\\n\t\t\t\tif (SPLAY_RIGHT((head)->sph_root, field) == NULL)\\\n\t\t\t\t\tbreak;\t\t\t\t\\\n\t\t\t}\t\t\t\t\t\t\\\n\t\t\tSPLAY_LINKRIGHT(head, __left, field);\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\tSPLAY_ASSEMBLE(head, &__node, __left, __right, field);\t\t\\\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "NULL",
            "\"MEM_ZERO\"",
            "pred"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK_INT",
          "args": [
            "r",
            "pred"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memvalcmp",
          "args": [
            "aa1",
            "v",
            "l",
            "&where"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "memvalcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "384-396",
          "snippet": "static int\nmemvalcmp(const u_int8_t *s, u_char v, size_t l, size_t *where)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < l; i++) {\n\t\tif (s[i] != v) {\n\t\t\t*where = i;\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nmemvalcmp(const u_int8_t *s, u_char v, size_t l, size_t *where)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < l; i++) {\n\t\tif (s[i] != v) {\n\t\t\t*where = i;\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_ptr",
          "args": [
            "file",
            "line",
            "a1",
            "\"NULL\"",
            "aa1",
            "NULL",
            "TEST_NE"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "assert_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "538-547",
          "snippet": "void\nassert_ptr(const char *file, int line, const char *a1, const char *a2,\n    const void *aa1, const void *aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"PTR\", pred);\n\tfprintf(stderr, \"%12s = %p\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %p\\n\", a2, aa2);\n\ttest_die();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_ptr(const char *file, int line, const char *a1, const char *a2,\n    const void *aa1, const void *aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"PTR\", pred);\n\tfprintf(stderr, \"%12s = %p\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %p\\n\", a2, aa2);\n\ttest_die();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_mem_filled(const char *file, int line, const char *a1,\n    const void *aa1, u_char v, size_t l, enum test_predicate pred)\n{\n\tsize_t where = -1;\n\tint r;\n\tchar tmp[64];\n\n\tif (l == 0)\n\t\treturn;\n\t/* If length is >0, then verify the pointer is not NULL */\n\tassert_ptr(file, line, a1, \"NULL\", aa1, NULL, TEST_NE);\n\n\tr = memvalcmp(aa1, v, l, &where);\n\tTEST_CHECK_INT(r, pred);\n\ttest_header(file, line, a1, NULL, \"MEM_ZERO\", pred);\n\tfprintf(stderr, \"%20s = %s%s (len %zu)\\n\", a1,\n\t    tohex(aa1, MIN(l, 20)), l > 20 ? \"...\" : \"\", l);\n\tsnprintf(tmp, sizeof(tmp), \"(%s)[%zu]\", a1, where);\n\tfprintf(stderr, \"%20s = 0x%02x (expected 0x%02x)\\n\", tmp,\n\t    ((u_char *)aa1)[where], v);\n\ttest_die();\n}"
  },
  {
    "function_name": "memvalcmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "384-396",
    "snippet": "static int\nmemvalcmp(const u_int8_t *s, u_char v, size_t l, size_t *where)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < l; i++) {\n\t\tif (s[i] != v) {\n\t\t\t*where = i;\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nmemvalcmp(const u_int8_t *s, u_char v, size_t l, size_t *where)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < l; i++) {\n\t\tif (s[i] != v) {\n\t\t\t*where = i;\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "assert_mem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "364-382",
    "snippet": "void\nassert_mem(const char *file, int line, const char *a1, const char *a2,\n    const void *aa1, const void *aa2, size_t l, enum test_predicate pred)\n{\n\tint r;\n\n\tif (l == 0)\n\t\treturn;\n\t/* If length is >0, then verify pointers are not NULL */\n\tassert_ptr(file, line, a1, \"NULL\", aa1, NULL, TEST_NE);\n\tassert_ptr(file, line, a2, \"NULL\", aa2, NULL, TEST_NE);\n\n\tr = memcmp(aa1, aa2, l);\n\tTEST_CHECK_INT(r, pred);\n\ttest_header(file, line, a1, a2, \"STRING\", pred);\n\tfprintf(stderr, \"%12s = %s (len %zu)\\n\", a1, tohex(aa1, MIN(l, 256)), l);\n\tfprintf(stderr, \"%12s = %s (len %zu)\\n\", a2, tohex(aa2, MIN(l, 256)), l);\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %s (len %zu)\\n\"",
            "a2",
            "tohex(aa2, MIN(l, 256))",
            "l"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tohex",
          "args": [
            "aa2",
            "MIN(l, 256)"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "tohex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "347-362",
          "snippet": "static char *\ntohex(const void *_s, size_t l)\n{\n\tu_int8_t *s = (u_int8_t *)_s;\n\tsize_t i, j;\n\tconst char *hex = \"0123456789abcdef\";\n\tchar *r = malloc((l * 2) + 1);\n\n\tassert(r != NULL);\n\tfor (i = j = 0; i < l; i++) {\n\t\tr[j++] = hex[(s[i] >> 4) & 0xf];\n\t\tr[j++] = hex[s[i] & 0xf];\n\t}\n\tr[j] = '\\0';\n\treturn r;\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\ntohex(const void *_s, size_t l)\n{\n\tu_int8_t *s = (u_int8_t *)_s;\n\tsize_t i, j;\n\tconst char *hex = \"0123456789abcdef\";\n\tchar *r = malloc((l * 2) + 1);\n\n\tassert(r != NULL);\n\tfor (i = j = 0; i < l; i++) {\n\t\tr[j++] = hex[(s[i] >> 4) & 0xf];\n\t\tr[j++] = hex[s[i] & 0xf];\n\t}\n\tr[j] = '\\0';\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MIN",
          "args": [
            "l",
            "256"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "_SPLAY_MINMAX",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sys-tree.h",
          "lines": "247-278",
          "snippet": "void name##_SPLAY_MINMAX(struct name *head, int __comp) \\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct type __node, *__left, *__right, *__tmp;\t\t\t\\\n\\\n\tSPLAY_LEFT(&__node, field) = SPLAY_RIGHT(&__node, field) = NULL;\\\n\t__left = __right = &__node;\t\t\t\t\t\\\n\\\n\twhile (1) {\t\t\t\t\t\t\t\\\n\t\tif (__comp < 0) {\t\t\t\t\t\\\n\t\t\t__tmp = SPLAY_LEFT((head)->sph_root, field);\t\\\n\t\t\tif (__tmp == NULL)\t\t\t\t\\\n\t\t\t\tbreak;\t\t\t\t\t\\\n\t\t\tif (__comp < 0){\t\t\t\t\\\n\t\t\t\tSPLAY_ROTATE_RIGHT(head, __tmp, field);\t\\\n\t\t\t\tif (SPLAY_LEFT((head)->sph_root, field) == NULL)\\\n\t\t\t\t\tbreak;\t\t\t\t\\\n\t\t\t}\t\t\t\t\t\t\\\n\t\t\tSPLAY_LINKLEFT(head, __right, field);\t\t\\\n\t\t} else if (__comp > 0) {\t\t\t\t\\\n\t\t\t__tmp = SPLAY_RIGHT((head)->sph_root, field);\t\\\n\t\t\tif (__tmp == NULL)\t\t\t\t\\\n\t\t\t\tbreak;\t\t\t\t\t\\\n\t\t\tif (__comp > 0) {\t\t\t\t\\\n\t\t\t\tSPLAY_ROTATE_LEFT(head, __tmp, field);\t\\\n\t\t\t\tif (SPLAY_RIGHT((head)->sph_root, field) == NULL)\\\n\t\t\t\t\tbreak;\t\t\t\t\\\n\t\t\t}\t\t\t\t\t\t\\\n\t\t\tSPLAY_LINKRIGHT(head, __left, field);\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\tSPLAY_ASSEMBLE(head, &__node, __left, __right, field);\t\t\\\n}",
          "includes": [
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n\nvoid name##_SPLAY_MINMAX(struct name *head, int __comp) \\\n{\t\t\t\t\t\t\t\t\t\\\n\tstruct type __node, *__left, *__right, *__tmp;\t\t\t\\\n\\\n\tSPLAY_LEFT(&__node, field) = SPLAY_RIGHT(&__node, field) = NULL;\\\n\t__left = __right = &__node;\t\t\t\t\t\\\n\\\n\twhile (1) {\t\t\t\t\t\t\t\\\n\t\tif (__comp < 0) {\t\t\t\t\t\\\n\t\t\t__tmp = SPLAY_LEFT((head)->sph_root, field);\t\\\n\t\t\tif (__tmp == NULL)\t\t\t\t\\\n\t\t\t\tbreak;\t\t\t\t\t\\\n\t\t\tif (__comp < 0){\t\t\t\t\\\n\t\t\t\tSPLAY_ROTATE_RIGHT(head, __tmp, field);\t\\\n\t\t\t\tif (SPLAY_LEFT((head)->sph_root, field) == NULL)\\\n\t\t\t\t\tbreak;\t\t\t\t\\\n\t\t\t}\t\t\t\t\t\t\\\n\t\t\tSPLAY_LINKLEFT(head, __right, field);\t\t\\\n\t\t} else if (__comp > 0) {\t\t\t\t\\\n\t\t\t__tmp = SPLAY_RIGHT((head)->sph_root, field);\t\\\n\t\t\tif (__tmp == NULL)\t\t\t\t\\\n\t\t\t\tbreak;\t\t\t\t\t\\\n\t\t\tif (__comp > 0) {\t\t\t\t\\\n\t\t\t\tSPLAY_ROTATE_LEFT(head, __tmp, field);\t\\\n\t\t\t\tif (SPLAY_RIGHT((head)->sph_root, field) == NULL)\\\n\t\t\t\t\tbreak;\t\t\t\t\\\n\t\t\t}\t\t\t\t\t\t\\\n\t\t\tSPLAY_LINKRIGHT(head, __left, field);\t\t\\\n\t\t}\t\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\\\n\tSPLAY_ASSEMBLE(head, &__node, __left, __right, field);\t\t\\\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %s (len %zu)\\n\"",
            "a1",
            "tohex(aa1, MIN(l, 256))",
            "l"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"STRING\"",
            "pred"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK_INT",
          "args": [
            "r",
            "pred"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "aa1",
            "aa2",
            "l"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_ptr",
          "args": [
            "file",
            "line",
            "a2",
            "\"NULL\"",
            "aa2",
            "NULL",
            "TEST_NE"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "assert_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "538-547",
          "snippet": "void\nassert_ptr(const char *file, int line, const char *a1, const char *a2,\n    const void *aa1, const void *aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"PTR\", pred);\n\tfprintf(stderr, \"%12s = %p\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %p\\n\", a2, aa2);\n\ttest_die();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_ptr(const char *file, int line, const char *a1, const char *a2,\n    const void *aa1, const void *aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"PTR\", pred);\n\tfprintf(stderr, \"%12s = %p\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %p\\n\", a2, aa2);\n\ttest_die();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_mem(const char *file, int line, const char *a1, const char *a2,\n    const void *aa1, const void *aa2, size_t l, enum test_predicate pred)\n{\n\tint r;\n\n\tif (l == 0)\n\t\treturn;\n\t/* If length is >0, then verify pointers are not NULL */\n\tassert_ptr(file, line, a1, \"NULL\", aa1, NULL, TEST_NE);\n\tassert_ptr(file, line, a2, \"NULL\", aa2, NULL, TEST_NE);\n\n\tr = memcmp(aa1, aa2, l);\n\tTEST_CHECK_INT(r, pred);\n\ttest_header(file, line, a1, a2, \"STRING\", pred);\n\tfprintf(stderr, \"%12s = %s (len %zu)\\n\", a1, tohex(aa1, MIN(l, 256)), l);\n\tfprintf(stderr, \"%12s = %s (len %zu)\\n\", a2, tohex(aa2, MIN(l, 256)), l);\n\ttest_die();\n}"
  },
  {
    "function_name": "tohex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "347-362",
    "snippet": "static char *\ntohex(const void *_s, size_t l)\n{\n\tu_int8_t *s = (u_int8_t *)_s;\n\tsize_t i, j;\n\tconst char *hex = \"0123456789abcdef\";\n\tchar *r = malloc((l * 2) + 1);\n\n\tassert(r != NULL);\n\tfor (i = j = 0; i < l; i++) {\n\t\tr[j++] = hex[(s[i] >> 4) & 0xf];\n\t\tr[j++] = hex[s[i] & 0xf];\n\t}\n\tr[j] = '\\0';\n\treturn r;\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "r != NULL"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "(l * 2) + 1"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "xmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "39-50",
          "snippet": "void *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\ntohex(const void *_s, size_t l)\n{\n\tu_int8_t *s = (u_int8_t *)_s;\n\tsize_t i, j;\n\tconst char *hex = \"0123456789abcdef\";\n\tchar *r = malloc((l * 2) + 1);\n\n\tassert(r != NULL);\n\tfor (i = j = 0; i < l; i++) {\n\t\tr[j++] = hex[(s[i] >> 4) & 0xf];\n\t\tr[j++] = hex[s[i] & 0xf];\n\t}\n\tr[j] = '\\0';\n\treturn r;\n}"
  },
  {
    "function_name": "assert_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "329-345",
    "snippet": "void\nassert_string(const char *file, int line, const char *a1, const char *a2,\n    const char *aa1, const char *aa2, enum test_predicate pred)\n{\n\tint r;\n\n\t/* Verify pointers are not NULL */\n\tassert_ptr(file, line, a1, \"NULL\", aa1, NULL, TEST_NE);\n\tassert_ptr(file, line, a2, \"NULL\", aa2, NULL, TEST_NE);\n\n\tr = strcmp(aa1, aa2);\n\tTEST_CHECK_INT(r, pred);\n\ttest_header(file, line, a1, a2, \"STRING\", pred);\n\tfprintf(stderr, \"%12s = %s (len %zu)\\n\", a1, aa1, strlen(aa1));\n\tfprintf(stderr, \"%12s = %s (len %zu)\\n\", a2, aa2, strlen(aa2));\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %s (len %zu)\\n\"",
            "a2",
            "aa2",
            "strlen(aa2)"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "aa2"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = %s (len %zu)\\n\"",
            "a1",
            "aa1",
            "strlen(aa1)"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "aa1"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"STRING\"",
            "pred"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK_INT",
          "args": [
            "r",
            "pred"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "aa1",
            "aa2"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_maybe_null",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1550-1558",
          "snippet": "static int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_ptr",
          "args": [
            "file",
            "line",
            "a2",
            "\"NULL\"",
            "aa2",
            "NULL",
            "TEST_NE"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "assert_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "538-547",
          "snippet": "void\nassert_ptr(const char *file, int line, const char *a1, const char *a2,\n    const void *aa1, const void *aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"PTR\", pred);\n\tfprintf(stderr, \"%12s = %p\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %p\\n\", a2, aa2);\n\ttest_die();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_ptr(const char *file, int line, const char *a1, const char *a2,\n    const void *aa1, const void *aa2, enum test_predicate pred)\n{\n\tTEST_CHECK(aa1, aa2, pred);\n\ttest_header(file, line, a1, a2, \"PTR\", pred);\n\tfprintf(stderr, \"%12s = %p\\n\", a1, aa1);\n\tfprintf(stderr, \"%12s = %p\\n\", a2, aa2);\n\ttest_die();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_string(const char *file, int line, const char *a1, const char *a2,\n    const char *aa1, const char *aa2, enum test_predicate pred)\n{\n\tint r;\n\n\t/* Verify pointers are not NULL */\n\tassert_ptr(file, line, a1, \"NULL\", aa1, NULL, TEST_NE);\n\tassert_ptr(file, line, a2, \"NULL\", aa2, NULL, TEST_NE);\n\n\tr = strcmp(aa1, aa2);\n\tTEST_CHECK_INT(r, pred);\n\ttest_header(file, line, a1, a2, \"STRING\", pred);\n\tfprintf(stderr, \"%12s = %s (len %zu)\\n\", a1, aa1, strlen(aa1));\n\tfprintf(stderr, \"%12s = %s (len %zu)\\n\", a2, aa2, strlen(aa2));\n\ttest_die();\n}"
  },
  {
    "function_name": "assert_bignum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "316-327",
    "snippet": "void\nassert_bignum(const char *file, int line, const char *a1, const char *a2,\n    const BIGNUM *aa1, const BIGNUM *aa2, enum test_predicate pred)\n{\n\tint r = BN_cmp(aa1, aa2);\n\n\tTEST_CHECK_INT(r, pred);\n\ttest_header(file, line, a1, a2, \"BIGNUM\", pred);\n\tfprintf(stderr, \"%12s = 0x%s\\n\", a1, BN_bn2hex(aa1));\n\tfprintf(stderr, \"%12s = 0x%s\\n\", a2, BN_bn2hex(aa2));\n\ttest_die();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_die",
          "args": [],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "test_die",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "296-302",
          "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static test_onerror_func_t *test_onerror = NULL;",
            "static void *onerror_ctx = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = 0x%s\\n\"",
            "a2",
            "BN_bn2hex(aa2)"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_bn2hex",
          "args": [
            "aa2"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%12s = 0x%s\\n\"",
            "a1",
            "BN_bn2hex(aa1)"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_bn2hex",
          "args": [
            "aa1"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_header",
          "args": [
            "file",
            "line",
            "a1",
            "a2",
            "\"BIGNUM\"",
            "pred"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "test_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "304-314",
          "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *active_test_name = NULL;",
            "static u_int test_number = 0;",
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_CHECK_INT",
          "args": [
            "r",
            "pred"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_cmp",
          "args": [
            "aa1",
            "aa2"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nassert_bignum(const char *file, int line, const char *a1, const char *a2,\n    const BIGNUM *aa1, const BIGNUM *aa2, enum test_predicate pred)\n{\n\tint r = BN_cmp(aa1, aa2);\n\n\tTEST_CHECK_INT(r, pred);\n\ttest_header(file, line, a1, a2, \"BIGNUM\", pred);\n\tfprintf(stderr, \"%12s = 0x%s\\n\", a1, BN_bn2hex(aa1));\n\tfprintf(stderr, \"%12s = 0x%s\\n\", a2, BN_bn2hex(aa2));\n\ttest_die();\n}"
  },
  {
    "function_name": "test_header",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "304-314",
    "snippet": "static void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static char *active_test_name = NULL;",
      "static u_int test_number = 0;",
      "static char subtest_info[512];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"ASSERT_%s_%s(%s%s%s) failed:\\n\"",
            "name",
            "pred_name(pred)",
            "a1",
            "a2 != NULL ? \", \" : \"\"",
            "a2 != NULL ? a2 : \"\""
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pred_name",
          "args": [
            "pred"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "pred_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "275-294",
          "snippet": "static const char *\npred_name(enum test_predicate p)\n{\n\tswitch (p) {\n\tcase TEST_EQ:\n\t\treturn \"EQ\";\n\tcase TEST_NE:\n\t\treturn \"NE\";\n\tcase TEST_LT:\n\t\treturn \"LT\";\n\tcase TEST_LE:\n\t\treturn \"LE\";\n\tcase TEST_GT:\n\t\treturn \"GT\";\n\tcase TEST_GE:\n\t\treturn \"GE\";\n\tdefault:\n\t\treturn \"UNKNOWN\";\n\t}\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const char *\npred_name(enum test_predicate p)\n{\n\tswitch (p) {\n\tcase TEST_EQ:\n\t\treturn \"EQ\";\n\tcase TEST_NE:\n\t\treturn \"NE\";\n\tcase TEST_LT:\n\t\treturn \"LT\";\n\tcase TEST_LE:\n\t\treturn \"LE\";\n\tcase TEST_GT:\n\t\treturn \"GT\";\n\tcase TEST_GE:\n\t\treturn \"GE\";\n\tdefault:\n\t\treturn \"UNKNOWN\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\"",
            "file",
            "line",
            "test_number",
            "active_test_name",
            "*subtest_info != '\\0' ? \" - \" : \"\"",
            "subtest_info"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nstatic void\ntest_header(const char *file, int line, const char *a1, const char *a2,\n    const char *name, enum test_predicate pred)\n{\n\tfprintf(stderr, \"\\n%s:%d test #%u \\\"%s\\\"%s%s\\n\", \n\t    file, line, test_number, active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n\tfprintf(stderr, \"ASSERT_%s_%s(%s%s%s) failed:\\n\",\n\t    name, pred_name(pred), a1,\n\t    a2 != NULL ? \", \" : \"\", a2 != NULL ? a2 : \"\");\n}"
  },
  {
    "function_name": "test_die",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "296-302",
    "snippet": "static void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static test_onerror_func_t *test_onerror = NULL;",
      "static void *onerror_ctx = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_onerror",
          "args": [
            "onerror_ctx"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nstatic void\ntest_die(void)\n{\n\tif (test_onerror != NULL)\n\t\ttest_onerror(onerror_ctx);\n\tabort();\n}"
  },
  {
    "function_name": "pred_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "275-294",
    "snippet": "static const char *\npred_name(enum test_predicate p)\n{\n\tswitch (p) {\n\tcase TEST_EQ:\n\t\treturn \"EQ\";\n\tcase TEST_NE:\n\t\treturn \"NE\";\n\tcase TEST_LT:\n\t\treturn \"LT\";\n\tcase TEST_LE:\n\t\treturn \"LE\";\n\tcase TEST_GT:\n\t\treturn \"GT\";\n\tcase TEST_GE:\n\t\treturn \"GE\";\n\tdefault:\n\t\treturn \"UNKNOWN\";\n\t}\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const char *\npred_name(enum test_predicate p)\n{\n\tswitch (p) {\n\tcase TEST_EQ:\n\t\treturn \"EQ\";\n\tcase TEST_NE:\n\t\treturn \"NE\";\n\tcase TEST_LT:\n\t\treturn \"LT\";\n\tcase TEST_LE:\n\t\treturn \"LE\";\n\tcase TEST_GT:\n\t\treturn \"GT\";\n\tcase TEST_GE:\n\t\treturn \"GE\";\n\tdefault:\n\t\treturn \"UNKNOWN\";\n\t}\n}"
  },
  {
    "function_name": "ssl_err_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "262-273",
    "snippet": "void\nssl_err_check(const char *file, int line)\n{\n\tlong openssl_error = ERR_get_error();\n\n\tif (openssl_error == 0)\n\t\treturn;\n\n\tfprintf(stderr, \"\\n%s:%d: uncaught OpenSSL error: %s\",\n\t    file, line, ERR_error_string(openssl_error, NULL));\n\tabort();\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"\\n%s:%d: uncaught OpenSSL error: %s\"",
            "file",
            "line",
            "ERR_error_string(openssl_error, NULL)"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_error_string",
          "args": [
            "openssl_error",
            "NULL"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_get_error",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssl_err_check(const char *file, int line)\n{\n\tlong openssl_error = ERR_get_error();\n\n\tif (openssl_error == 0)\n\t\treturn;\n\n\tfprintf(stderr, \"\\n%s:%d: uncaught OpenSSL error: %s\",\n\t    file, line, ERR_error_string(openssl_error, NULL));\n\tabort();\n}"
  },
  {
    "function_name": "test_subtest_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "252-260",
    "snippet": "void\ntest_subtest_info(const char *fmt, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tvsnprintf(subtest_info, sizeof(subtest_info), fmt, ap);\n\tva_end(ap);\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static char subtest_info[512];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "subtest_info",
            "sizeof(subtest_info)",
            "fmt",
            "ap"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "vsnprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-snprintf.c",
          "lines": "861-865",
          "snippet": "int\nvsnprintf (char *str, size_t count, const char *fmt, va_list args)\n{\n\treturn dopr(str, count, fmt, args);\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nint\nvsnprintf (char *str, size_t count, const char *fmt, va_list args)\n{\n\treturn dopr(str, count, fmt, args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "fmt"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char subtest_info[512];\n\nvoid\ntest_subtest_info(const char *fmt, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tvsnprintf(subtest_info, sizeof(subtest_info), fmt, ap);\n\tva_end(ap);\n}"
  },
  {
    "function_name": "test_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "237-250",
    "snippet": "void\ntest_done(void)\n{\n\t*subtest_info = '\\0';\n\tassert(active_test_name != NULL);\n\tfree(active_test_name);\n\tactive_test_name = NULL;\n\tif (verbose_mode)\n\t\tprintf(\"OK\\n\");\n\telse if (!quiet_mode) {\n\t\tprintf(\".\");\n\t\tfflush(stdout);\n\t}\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int verbose_mode = 0;",
      "static int quiet_mode = 0;",
      "static char *active_test_name = NULL;",
      "static char subtest_info[512];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "stdout"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "_ssh_compat_fflush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "314-326",
          "snippet": "int _ssh_compat_fflush(FILE *f)\n{\n\tint r1, r2;\n\n\tif (f == NULL) {\n\t\tr1 = fflush(stdout);\n\t\tr2 = fflush(stderr);\n\t\tif (r1 == -1 || r2 == -1)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\treturn fflush(f);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint _ssh_compat_fflush(FILE *f)\n{\n\tint r1, r2;\n\n\tif (f == NULL) {\n\t\tr1 = fflush(stdout);\n\t\tr2 = fflush(stderr);\n\t\tif (r1 == -1 || r2 == -1)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\treturn fflush(f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\".\""
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "mprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/utf8.c",
          "lines": "289-299",
          "snippet": "int\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"utf8.h\"",
            "# include <wchar.h>",
            "# include <vis.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "# include <langinfo.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t vasnmprintf(char **, size_t, int *, const char *, va_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n# include <wchar.h>\n# include <vis.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <locale.h>\n#include <limits.h>\n# include <langinfo.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\t vasnmprintf(char **, size_t, int *, const char *, va_list);\n\nint\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "active_test_name"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "active_test_name != NULL"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int verbose_mode = 0;\nstatic int quiet_mode = 0;\nstatic char *active_test_name = NULL;\nstatic char subtest_info[512];\n\nvoid\ntest_done(void)\n{\n\t*subtest_info = '\\0';\n\tassert(active_test_name != NULL);\n\tfree(active_test_name);\n\tactive_test_name = NULL;\n\tif (verbose_mode)\n\t\tprintf(\"OK\\n\");\n\telse if (!quiet_mode) {\n\t\tprintf(\".\");\n\t\tfflush(stdout);\n\t}\n}"
  },
  {
    "function_name": "set_onerror_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "230-235",
    "snippet": "void\nset_onerror_func(test_onerror_func_t *f, void *ctx)\n{\n\ttest_onerror = f;\n\tonerror_ctx = ctx;\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static test_onerror_func_t *test_onerror = NULL;",
      "static void *onerror_ctx = NULL;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic test_onerror_func_t *test_onerror = NULL;\nstatic void *onerror_ctx = NULL;\n\nvoid\nset_onerror_func(test_onerror_func_t *f, void *ctx)\n{\n\ttest_onerror = f;\n\tonerror_ctx = ctx;\n}"
  },
  {
    "function_name": "test_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "215-228",
    "snippet": "void\ntest_start(const char *n)\n{\n\tassert(active_test_name == NULL);\n\tassert((active_test_name = strdup(n)) != NULL);\n\t*subtest_info = '\\0';\n\tif (verbose_mode)\n\t\tprintf(\"test %u - \\\"%s\\\": \", test_number, active_test_name);\n\ttest_number++;\n#ifdef SIGINFO\n\tsignal(SIGINFO, siginfo);\n#endif\n\tsignal(SIGUSR1, siginfo);\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int verbose_mode = 0;",
      "static char *active_test_name = NULL;",
      "static u_int test_number = 0;",
      "static char subtest_info[512];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "signal",
          "args": [
            "SIGUSR1",
            "siginfo"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "session_signal_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/session.c",
          "lines": "2130-2176",
          "snippet": "static int\nsession_signal_req(struct ssh *ssh, Session *s)\n{\n\tchar *signame = NULL;\n\tint r, sig, success = 0;\n\n\tif ((r = sshpkt_get_cstring(ssh, &signame, NULL)) != 0 ||\n\t    (r = sshpkt_get_end(ssh)) != 0) {\n\t\terror(\"%s: parse packet: %s\", __func__, ssh_err(r));\n\t\tgoto out;\n\t}\n\tif ((sig = name2sig(signame)) == -1) {\n\t\terror(\"%s: unsupported signal \\\"%s\\\"\", __func__, signame);\n\t\tgoto out;\n\t}\n\tif (s->pid <= 0) {\n\t\terror(\"%s: no pid for session %d\", __func__, s->self);\n\t\tgoto out;\n\t}\n\tif (s->forced || s->is_subsystem) {\n\t\terror(\"%s: refusing to send signal %s to %s session\", __func__,\n\t\t    signame, s->forced ? \"forced-command\" : \"subsystem\");\n\t\tgoto out;\n\t}\n\tif (!use_privsep || mm_is_monitor()) {\n\t\terror(\"%s: session signalling requires privilege separation\",\n\t\t    __func__);\n\t\tgoto out;\n\t}\n\n\tdebug(\"%s: signal %s, killpg(%ld, %d)\", __func__, signame,\n\t    (long)s->pid, sig);\n\ttemporarily_use_uid(s->pw);\n\tr = killpg(s->pid, sig);\n\trestore_uid();\n\tif (r != 0) {\n\t\terror(\"%s: killpg(%ld, %d): %s\", __func__, (long)s->pid,\n\t\t    sig, strerror(errno));\n\t\tgoto out;\n\t}\n\n\t/* success */\n\tsuccess = 1;\n out:\n\tfree(signame);\n\treturn success;\n}",
          "includes": [
            "#include <selinux/selinux.h>",
            "#include <kafs.h>",
            "#include \"atomicio.h\"",
            "#include \"sftp.h\"",
            "#include \"monitor_wrap.h\"",
            "#include \"kex.h\"",
            "#include \"session.h\"",
            "#include \"canohost.h\"",
            "#include \"serverloop.h\"",
            "#include \"sshlogin.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"authfd.h\"",
            "#include \"auth-options.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"ssh-gss.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"channels.h\"",
            "#include \"compat.h\"",
            "#include \"uidswap.h\"",
            "#include \"match.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"packet.h\"",
            "#include \"sshpty.h\"",
            "#include \"ssh2.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <pwd.h>",
            "#include <paths.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <sys/wait.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "# include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void\tsession_set_fds(struct ssh *, Session *, int, int, int, int, int);",
            "void\tsession_pty_cleanup(Session *);",
            "void\tsession_proctitle(Session *);",
            "int\tsession_setup_x11fwd(struct ssh *, Session *);",
            "int\tdo_exec_pty(struct ssh *, Session *, const char *);",
            "int\tdo_exec_no_pty(struct ssh *, Session *, const char *);",
            "int\tdo_exec(struct ssh *, Session *, const char *);",
            "void\tdo_login(struct ssh *, Session *, const char *);",
            "void\tdo_child(struct ssh *, Session *, const char *);",
            "int\tcheck_quietlogin(Session *, const char *);",
            "static int session_pty_req(struct ssh *, Session *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <selinux/selinux.h>\n#include <kafs.h>\n#include \"atomicio.h\"\n#include \"sftp.h\"\n#include \"monitor_wrap.h\"\n#include \"kex.h\"\n#include \"session.h\"\n#include \"canohost.h\"\n#include \"serverloop.h\"\n#include \"sshlogin.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"authfd.h\"\n#include \"auth-options.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"ssh-gss.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"channels.h\"\n#include \"compat.h\"\n#include \"uidswap.h\"\n#include \"match.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"packet.h\"\n#include \"sshpty.h\"\n#include \"ssh2.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <pwd.h>\n#include <paths.h>\n#include <netdb.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <sys/wait.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n# include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\tsession_set_fds(struct ssh *, Session *, int, int, int, int, int);\nvoid\tsession_pty_cleanup(Session *);\nvoid\tsession_proctitle(Session *);\nint\tsession_setup_x11fwd(struct ssh *, Session *);\nint\tdo_exec_pty(struct ssh *, Session *, const char *);\nint\tdo_exec_no_pty(struct ssh *, Session *, const char *);\nint\tdo_exec(struct ssh *, Session *, const char *);\nvoid\tdo_login(struct ssh *, Session *, const char *);\nvoid\tdo_child(struct ssh *, Session *, const char *);\nint\tcheck_quietlogin(Session *, const char *);\nstatic int session_pty_req(struct ssh *, Session *);\n\nstatic int\nsession_signal_req(struct ssh *ssh, Session *s)\n{\n\tchar *signame = NULL;\n\tint r, sig, success = 0;\n\n\tif ((r = sshpkt_get_cstring(ssh, &signame, NULL)) != 0 ||\n\t    (r = sshpkt_get_end(ssh)) != 0) {\n\t\terror(\"%s: parse packet: %s\", __func__, ssh_err(r));\n\t\tgoto out;\n\t}\n\tif ((sig = name2sig(signame)) == -1) {\n\t\terror(\"%s: unsupported signal \\\"%s\\\"\", __func__, signame);\n\t\tgoto out;\n\t}\n\tif (s->pid <= 0) {\n\t\terror(\"%s: no pid for session %d\", __func__, s->self);\n\t\tgoto out;\n\t}\n\tif (s->forced || s->is_subsystem) {\n\t\terror(\"%s: refusing to send signal %s to %s session\", __func__,\n\t\t    signame, s->forced ? \"forced-command\" : \"subsystem\");\n\t\tgoto out;\n\t}\n\tif (!use_privsep || mm_is_monitor()) {\n\t\terror(\"%s: session signalling requires privilege separation\",\n\t\t    __func__);\n\t\tgoto out;\n\t}\n\n\tdebug(\"%s: signal %s, killpg(%ld, %d)\", __func__, signame,\n\t    (long)s->pid, sig);\n\ttemporarily_use_uid(s->pw);\n\tr = killpg(s->pid, sig);\n\trestore_uid();\n\tif (r != 0) {\n\t\terror(\"%s: killpg(%ld, %d): %s\", __func__, (long)s->pid,\n\t\t    sig, strerror(errno));\n\t\tgoto out;\n\t}\n\n\t/* success */\n\tsuccess = 1;\n out:\n\tfree(signame);\n\treturn success;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"test %u - \\\"%s\\\": \"",
            "test_number",
            "active_test_name"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "xasprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "104-118",
          "snippet": "int\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nint\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "(active_test_name = strdup(n)) != NULL"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "n"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "xstrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "92-102",
          "snippet": "char *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nchar *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "active_test_name == NULL"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int verbose_mode = 0;\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nvoid\ntest_start(const char *n)\n{\n\tassert(active_test_name == NULL);\n\tassert((active_test_name = strdup(n)) != NULL);\n\t*subtest_info = '\\0';\n\tif (verbose_mode)\n\t\tprintf(\"test %u - \\\"%s\\\": \", test_number, active_test_name);\n\ttest_number++;\n#ifdef SIGINFO\n\tsignal(SIGINFO, siginfo);\n#endif\n\tsignal(SIGUSR1, siginfo);\n}"
  },
  {
    "function_name": "siginfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "206-213",
    "snippet": "static void\nsiginfo(int unused __attribute__((__unused__)))\n{\n\tchar buf[256];\n\n\ttest_info(buf, sizeof(buf));\n\tatomicio(vwrite, STDERR_FILENO, buf, strlen(buf));\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomicio",
          "args": [
            "vwrite",
            "STDERR_FILENO",
            "buf",
            "strlen(buf)"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "atomiciov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/atomicio.c",
          "lines": "165-170",
          "snippet": "size_t\natomiciov(ssize_t (*f) (int, const struct iovec *, int), int fd,\n    const struct iovec *_iov, int iovcnt)\n{\n\treturn atomiciov6(f, fd, _iov, iovcnt, NULL, NULL);\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#  include <sys/poll.h>",
            "#include <poll.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#  include <sys/poll.h>\n#include <poll.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include \"includes.h\"\n\nsize_t\natomiciov(ssize_t (*f) (int, const struct iovec *, int), int fd,\n    const struct iovec *_iov, int iovcnt)\n{\n\treturn atomiciov6(f, fd, _iov, iovcnt, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "buf"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_info",
          "args": [
            "buf",
            "sizeof(buf)"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "test_subtest_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "252-260",
          "snippet": "void\ntest_subtest_info(const char *fmt, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tvsnprintf(subtest_info, sizeof(subtest_info), fmt, ap);\n\tva_end(ap);\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char subtest_info[512];\n\nvoid\ntest_subtest_info(const char *fmt, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tvsnprintf(subtest_info, sizeof(subtest_info), fmt, ap);\n\tva_end(ap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nsiginfo(int unused __attribute__((__unused__)))\n{\n\tchar buf[256];\n\n\ttest_info(buf, sizeof(buf));\n\tatomicio(vwrite, STDERR_FILENO, buf, strlen(buf));\n}"
  },
  {
    "function_name": "test_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "198-204",
    "snippet": "void\ntest_info(char *s, size_t len)\n{\n\tsnprintf(s, len, \"In test %u: \\\"%s\\\"%s%s\\n\", test_number,\n\t    active_test_name == NULL ? \"<none>\" : active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static char *active_test_name = NULL;",
      "static u_int test_number = 0;",
      "static char subtest_info[512];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "s",
            "len",
            "\"In test %u: \\\"%s\\\"%s%s\\n\"",
            "test_number",
            "active_test_name == NULL ? \"<none>\" : active_test_name",
            "*subtest_info != '\\0' ? \" - \" : \"\"",
            "subtest_info"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-snprintf.c",
          "lines": "869-879",
          "snippet": "int\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nint\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *active_test_name = NULL;\nstatic u_int test_number = 0;\nstatic char subtest_info[512];\n\nvoid\ntest_info(char *s, size_t len)\n{\n\tsnprintf(s, len, \"In test %u: \\\"%s\\\"%s%s\\n\", test_number,\n\t    active_test_name == NULL ? \"<none>\" : active_test_name,\n\t    *subtest_info != '\\0' ? \" - \" : \"\", subtest_info);\n}"
  },
  {
    "function_name": "test_data_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "181-196",
    "snippet": "const char *\ntest_data_file(const char *name)\n{\n\tstatic char ret[PATH_MAX];\n\n\tif (data_dir != NULL)\n\t\tsnprintf(ret, sizeof(ret), \"%s/%s\", data_dir, name);\n\telse\n\t\tstrlcpy(ret, name, sizeof(ret));\n\tif (access(ret, F_OK) != 0) {\n\t\tfprintf(stderr, \"Cannot access data file %s: %s\\n\",\n\t\t    ret, strerror(errno));\n\t\texit(1);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *data_dir = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "sftp_server_cleanup_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-server.c",
          "lines": "1474-1483",
          "snippet": "void\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"uidswap.h\"",
            "#include \"match.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/statvfs.h>",
            "#include <sys/mount.h>",
            "# include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct passwd *pw = NULL;",
            "static char *client_addr = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"uidswap.h\"\n#include \"match.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"xmalloc.h\"\n#include <stdarg.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/statvfs.h>\n#include <sys/mount.h>\n# include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct passwd *pw = NULL;\nstatic char *client_addr = NULL;\n\nvoid\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Cannot access data file %s: %s\\n\"",
            "ret",
            "strerror(errno)"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "140-146",
          "snippet": "const char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "ret",
            "F_OK"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "ret",
            "name",
            "sizeof(ret)"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "strlcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strlcpy.c",
          "lines": "32-56",
          "snippet": "size_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}",
          "includes": [
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "ret",
            "sizeof(ret)",
            "\"%s/%s\"",
            "data_dir",
            "name"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-snprintf.c",
          "lines": "869-879",
          "snippet": "int\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nint\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const char *data_dir = NULL;\n\nconst char *\ntest_data_file(const char *name)\n{\n\tstatic char ret[PATH_MAX];\n\n\tif (data_dir != NULL)\n\t\tsnprintf(ret, sizeof(ret), \"%s/%s\", data_dir, name);\n\telse\n\t\tstrlcpy(ret, name, sizeof(ret));\n\tif (access(ret, F_OK) != 0) {\n\t\tfprintf(stderr, \"Cannot access data file %s: %s\\n\",\n\t\t    ret, strerror(errno));\n\t\texit(1);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "test_is_quiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "175-179",
    "snippet": "int\ntest_is_quiet()\n{\n\treturn quiet_mode;\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int quiet_mode = 0;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int quiet_mode = 0;\n\nint\ntest_is_quiet()\n{\n\treturn quiet_mode;\n}"
  },
  {
    "function_name": "test_is_verbose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "169-173",
    "snippet": "int\ntest_is_verbose()\n{\n\treturn verbose_mode;\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int verbose_mode = 0;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int verbose_mode = 0;\n\nint\ntest_is_verbose()\n{\n\treturn verbose_mode;\n}"
  },
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
    "lines": "119-167",
    "snippet": "int\nmain(int argc, char **argv)\n{\n\tint ch;\n\n\t/* Handle systems without __progname */\n\tif (__progname == NULL) {\n\t\t__progname = strrchr(argv[0], '/');\n\t\tif (__progname == NULL || __progname[1] == '\\0')\n\t\t\t__progname = argv[0];\t\n\t\telse\n\t\t\t__progname++;\n\t\tif ((__progname = strdup(__progname)) == NULL) {\n\t\t\tfprintf(stderr, \"strdup failed\\n\");\n\t\t\texit(1);\n\t\t}\n\t}\n\n\twhile ((ch = getopt(argc, argv, \"vqd:\")) != -1) {\n\t\tswitch (ch) {\n\t\tcase 'd':\n\t\t\tdata_dir = optarg;\n\t\t\tbreak;\n\t\tcase 'q':\n\t\t\tverbose_mode = 0;\n\t\t\tquiet_mode = 1;\n\t\t\tbreak;\n\t\tcase 'v':\n\t\t\tverbose_mode = 1;\n\t\t\tquiet_mode = 0;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfprintf(stderr, \"Unrecognised command line option\\n\");\n\t\t\tfprintf(stderr, \"Usage: %s [-v]\\n\", __progname);\n\t\t\texit(1);\n\t\t}\n\t}\n\tsetvbuf(stdout, NULL, _IONBF, 0);\n\tif (!quiet_mode)\n\t\tprintf(\"%s: \", __progname);\n\tif (verbose_mode)\n\t\tprintf(\"\\n\");\n\n\ttests();\n\n\tif (!quiet_mode)\n\t\tprintf(\" %u tests ok\\n\", test_number);\n\treturn 0;\n}",
    "includes": [
      "#include \"atomicio.h\"",
      "#include \"test_helper.h\"",
      "# include <vis.h>",
      "#include <openssl/bn.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/uio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "extern char *__progname;",
      "static int verbose_mode = 0;",
      "static int quiet_mode = 0;",
      "static u_int test_number = 0;",
      "static const char *data_dir = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\" %u tests ok\\n\"",
            "test_number"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "xasprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "104-118",
          "snippet": "int\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nint\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tests",
          "args": [],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "tests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/authopt/tests.c",
          "lines": "560-573",
          "snippet": "void\ntests(void)\n{\n\textern char *__progname;\n\tLogLevel ll = test_is_verbose() ?\n\t    SYSLOG_LEVEL_DEBUG3 : SYSLOG_LEVEL_QUIET;\n\n\t/* test_cert_parse() are a bit spammy to error() by default... */\n\tlog_init(__progname, ll, SYSLOG_FACILITY_USER, 1);\n\n\ttest_authkeys_parse();\n\ttest_cert_parse();\n\ttest_merge();\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"auth-options.h\"",
            "#include \"authfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"test_helper.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"misc.h\"\n#include \"auth-options.h\"\n#include \"authfile.h\"\n#include \"sshkey.h\"\n#include \"test_helper.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nvoid\ntests(void)\n{\n\textern char *__progname;\n\tLogLevel ll = test_is_verbose() ?\n\t    SYSLOG_LEVEL_DEBUG3 : SYSLOG_LEVEL_QUIET;\n\n\t/* test_cert_parse() are a bit spammy to error() by default... */\n\tlog_init(__progname, ll, SYSLOG_FACILITY_USER, 1);\n\n\ttest_authkeys_parse();\n\ttest_cert_parse();\n\ttest_merge();\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "mprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/utf8.c",
          "lines": "289-299",
          "snippet": "int\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"utf8.h\"",
            "# include <wchar.h>",
            "# include <vis.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "# include <langinfo.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t vasnmprintf(char **, size_t, int *, const char *, va_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n# include <wchar.h>\n# include <vis.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <locale.h>\n#include <limits.h>\n# include <langinfo.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\t vasnmprintf(char **, size_t, int *, const char *, va_list);\n\nint\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setvbuf",
          "args": [
            "stdout",
            "NULL",
            "_IONBF",
            "0"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "sftp_server_cleanup_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-server.c",
          "lines": "1474-1483",
          "snippet": "void\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"uidswap.h\"",
            "#include \"match.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/statvfs.h>",
            "#include <sys/mount.h>",
            "# include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct passwd *pw = NULL;",
            "static char *client_addr = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"uidswap.h\"\n#include \"match.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"xmalloc.h\"\n#include <stdarg.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/statvfs.h>\n#include <sys/mount.h>\n# include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct passwd *pw = NULL;\nstatic char *client_addr = NULL;\n\nvoid\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Usage: %s [-v]\\n\"",
            "__progname"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Unrecognised command line option\\n\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getopt",
          "args": [
            "argc",
            "argv",
            "\"vqd:\""
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "getopt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/getopt_long.c",
          "lines": "489-502",
          "snippet": "int\ngetopt(int nargc, char * const *nargv, const char *options)\n{\n\n\t/*\n\t * We don't pass FLAG_PERMUTE to getopt_internal() since\n\t * the BSD getopt(3) (unlike GNU) has never done this.\n\t *\n\t * Furthermore, since many privileged programs call getopt()\n\t * before dropping privileges it makes sense to keep things\n\t * as simple (and bug-free) as possible.\n\t */\n\treturn (getopt_internal(nargc, nargv, options, NULL, NULL, 0));\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <stdarg.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <getopt.h>",
            "#include <err.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define FLAG_PERMUTE\t0x01\t/* permute non-options to the end of argv */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <stdarg.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <getopt.h>\n#include <err.h>\n#include \"includes.h\"\n\n#define FLAG_PERMUTE\t0x01\t/* permute non-options to the end of argv */\n\nint\ngetopt(int nargc, char * const *nargv, const char *options)\n{\n\n\t/*\n\t * We don't pass FLAG_PERMUTE to getopt_internal() since\n\t * the BSD getopt(3) (unlike GNU) has never done this.\n\t *\n\t * Furthermore, since many privileged programs call getopt()\n\t * before dropping privileges it makes sense to keep things\n\t * as simple (and bug-free) as possible.\n\t */\n\treturn (getopt_internal(nargc, nargv, options, NULL, NULL, 0));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"strdup failed\\n\""
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "__progname"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "xstrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "92-102",
          "snippet": "char *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nchar *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "argv[0]",
            "'/'"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nextern char *__progname;\nstatic int verbose_mode = 0;\nstatic int quiet_mode = 0;\nstatic u_int test_number = 0;\nstatic const char *data_dir = NULL;\n\nint\nmain(int argc, char **argv)\n{\n\tint ch;\n\n\t/* Handle systems without __progname */\n\tif (__progname == NULL) {\n\t\t__progname = strrchr(argv[0], '/');\n\t\tif (__progname == NULL || __progname[1] == '\\0')\n\t\t\t__progname = argv[0];\t\n\t\telse\n\t\t\t__progname++;\n\t\tif ((__progname = strdup(__progname)) == NULL) {\n\t\t\tfprintf(stderr, \"strdup failed\\n\");\n\t\t\texit(1);\n\t\t}\n\t}\n\n\twhile ((ch = getopt(argc, argv, \"vqd:\")) != -1) {\n\t\tswitch (ch) {\n\t\tcase 'd':\n\t\t\tdata_dir = optarg;\n\t\t\tbreak;\n\t\tcase 'q':\n\t\t\tverbose_mode = 0;\n\t\t\tquiet_mode = 1;\n\t\t\tbreak;\n\t\tcase 'v':\n\t\t\tverbose_mode = 1;\n\t\t\tquiet_mode = 0;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfprintf(stderr, \"Unrecognised command line option\\n\");\n\t\t\tfprintf(stderr, \"Usage: %s [-v]\\n\", __progname);\n\t\t\texit(1);\n\t\t}\n\t}\n\tsetvbuf(stdout, NULL, _IONBF, 0);\n\tif (!quiet_mode)\n\t\tprintf(\"%s: \", __progname);\n\tif (verbose_mode)\n\t\tprintf(\"\\n\");\n\n\ttests();\n\n\tif (!quiet_mode)\n\t\tprintf(\" %u tests ok\\n\", test_number);\n\treturn 0;\n}"
  }
]