[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass1.c",
    "lines": "154-171",
    "snippet": "int\nmain(int argc, char **argv)\n{\n\tchar *message;\n\tint result;\n\n\tgnome_init(\"GNOME ssh-askpass\", \"0.1\", argc, argv);\n\n\tif (argc == 2)\n\t\tmessage = argv[1];\n\telse\n\t\tmessage = \"Enter your OpenSSH passphrase:\";\n\n\tsetvbuf(stdout, 0, _IONBF, 0);\n\tresult = passphrase_dialog(message);\n\n\treturn (result);\n}",
    "includes": [
      "#include <gdk/gdkx.h>",
      "#include <X11/Xlib.h>",
      "#include <gnome.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "passphrase_dialog",
          "args": [
            "message"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "passphrase_dialog",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass1.c",
          "lines": "67-152",
          "snippet": "int\npassphrase_dialog(char *message)\n{\n\tchar *passphrase;\n\tchar **messages;\n\tint result, i, grab_server, grab_pointer;\n\tGtkWidget *dialog, *entry, *label;\n\n\tgrab_server = (getenv(\"GNOME_SSH_ASKPASS_GRAB_SERVER\") != NULL);\n\tgrab_pointer = (getenv(\"GNOME_SSH_ASKPASS_GRAB_POINTER\") != NULL);\n\n\tdialog = gnome_dialog_new(\"OpenSSH\", GNOME_STOCK_BUTTON_OK,\n\t    GNOME_STOCK_BUTTON_CANCEL, NULL);\n\n\tmessages = g_strsplit(message, \"\\\\n\", 0);\n\tif (messages)\n\t\tfor(i = 0; messages[i]; i++) {\n\t\t\tlabel = gtk_label_new(messages[i]);\n\t\t\tgtk_box_pack_start(GTK_BOX(GNOME_DIALOG(dialog)->vbox),\n\t\t\t    label, FALSE, FALSE, 0);\n\t\t}\n\n\tentry = gtk_entry_new();\n\tgtk_box_pack_start(GTK_BOX(GNOME_DIALOG(dialog)->vbox), entry, FALSE,\n\t    FALSE, 0);\n\tgtk_entry_set_visibility(GTK_ENTRY(entry), FALSE);\n\tgtk_widget_grab_focus(entry);\n\n\t/* Center window and prepare for grab */\n\tgtk_object_set(GTK_OBJECT(dialog), \"type\", GTK_WINDOW_POPUP, NULL);\n\tgnome_dialog_set_default(GNOME_DIALOG(dialog), 0);\n\tgtk_window_set_position (GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);\n\tgtk_window_set_policy(GTK_WINDOW(dialog), FALSE, FALSE, TRUE);\n\tgnome_dialog_close_hides(GNOME_DIALOG(dialog), TRUE);\n\tgtk_container_set_border_width(GTK_CONTAINER(GNOME_DIALOG(dialog)->vbox),\n\t    GNOME_PAD);\n\tgtk_widget_show_all(dialog);\n\n\t/* Grab focus */\n\tif (grab_server)\n\t\tXGrabServer(GDK_DISPLAY());\n\tif (grab_pointer && gdk_pointer_grab(dialog->window, TRUE, 0,\n\t    NULL, NULL, GDK_CURRENT_TIME))\n\t\tgoto nograb;\n\tif (gdk_keyboard_grab(dialog->window, FALSE, GDK_CURRENT_TIME))\n\t\tgoto nograbkb;\n\n\t/* Make <enter> close dialog */\n\tgnome_dialog_editable_enters(GNOME_DIALOG(dialog), GTK_EDITABLE(entry));\n\n\t/* Run dialog */\n\tresult = gnome_dialog_run(GNOME_DIALOG(dialog));\n\n\t/* Ungrab */\n\tif (grab_server)\n\t\tXUngrabServer(GDK_DISPLAY());\n\tif (grab_pointer)\n\t\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n\tgdk_keyboard_ungrab(GDK_CURRENT_TIME);\n\tgdk_flush();\n\n\t/* Report passphrase if user selected OK */\n\tpassphrase = gtk_entry_get_text(GTK_ENTRY(entry));\n\tif (result == 0)\n\t\tputs(passphrase);\n\t\t\n\t/* Zero passphrase in memory */\n\tmemset(passphrase, '\\0', strlen(passphrase));\n\tgtk_entry_set_text(GTK_ENTRY(entry), passphrase);\n\t\t\t\n\tgnome_dialog_close(GNOME_DIALOG(dialog));\n\treturn (result == 0 ? 0 : -1);\n\n\t/* At least one grab failed - ungrab what we got, and report\n\t   the failure to the user.  Note that XGrabServer() cannot\n\t   fail.  */\n nograbkb:\n\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n nograb:\n\tif (grab_server)\n\t\tXUngrabServer(GDK_DISPLAY());\n\tgnome_dialog_close(GNOME_DIALOG(dialog));\n\t\n\treport_failed_grab();\n\treturn (-1);\n}",
          "includes": [
            "#include <gdk/gdkx.h>",
            "#include <X11/Xlib.h>",
            "#include <gnome.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gdk/gdkx.h>\n#include <X11/Xlib.h>\n#include <gnome.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nint\npassphrase_dialog(char *message)\n{\n\tchar *passphrase;\n\tchar **messages;\n\tint result, i, grab_server, grab_pointer;\n\tGtkWidget *dialog, *entry, *label;\n\n\tgrab_server = (getenv(\"GNOME_SSH_ASKPASS_GRAB_SERVER\") != NULL);\n\tgrab_pointer = (getenv(\"GNOME_SSH_ASKPASS_GRAB_POINTER\") != NULL);\n\n\tdialog = gnome_dialog_new(\"OpenSSH\", GNOME_STOCK_BUTTON_OK,\n\t    GNOME_STOCK_BUTTON_CANCEL, NULL);\n\n\tmessages = g_strsplit(message, \"\\\\n\", 0);\n\tif (messages)\n\t\tfor(i = 0; messages[i]; i++) {\n\t\t\tlabel = gtk_label_new(messages[i]);\n\t\t\tgtk_box_pack_start(GTK_BOX(GNOME_DIALOG(dialog)->vbox),\n\t\t\t    label, FALSE, FALSE, 0);\n\t\t}\n\n\tentry = gtk_entry_new();\n\tgtk_box_pack_start(GTK_BOX(GNOME_DIALOG(dialog)->vbox), entry, FALSE,\n\t    FALSE, 0);\n\tgtk_entry_set_visibility(GTK_ENTRY(entry), FALSE);\n\tgtk_widget_grab_focus(entry);\n\n\t/* Center window and prepare for grab */\n\tgtk_object_set(GTK_OBJECT(dialog), \"type\", GTK_WINDOW_POPUP, NULL);\n\tgnome_dialog_set_default(GNOME_DIALOG(dialog), 0);\n\tgtk_window_set_position (GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);\n\tgtk_window_set_policy(GTK_WINDOW(dialog), FALSE, FALSE, TRUE);\n\tgnome_dialog_close_hides(GNOME_DIALOG(dialog), TRUE);\n\tgtk_container_set_border_width(GTK_CONTAINER(GNOME_DIALOG(dialog)->vbox),\n\t    GNOME_PAD);\n\tgtk_widget_show_all(dialog);\n\n\t/* Grab focus */\n\tif (grab_server)\n\t\tXGrabServer(GDK_DISPLAY());\n\tif (grab_pointer && gdk_pointer_grab(dialog->window, TRUE, 0,\n\t    NULL, NULL, GDK_CURRENT_TIME))\n\t\tgoto nograb;\n\tif (gdk_keyboard_grab(dialog->window, FALSE, GDK_CURRENT_TIME))\n\t\tgoto nograbkb;\n\n\t/* Make <enter> close dialog */\n\tgnome_dialog_editable_enters(GNOME_DIALOG(dialog), GTK_EDITABLE(entry));\n\n\t/* Run dialog */\n\tresult = gnome_dialog_run(GNOME_DIALOG(dialog));\n\n\t/* Ungrab */\n\tif (grab_server)\n\t\tXUngrabServer(GDK_DISPLAY());\n\tif (grab_pointer)\n\t\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n\tgdk_keyboard_ungrab(GDK_CURRENT_TIME);\n\tgdk_flush();\n\n\t/* Report passphrase if user selected OK */\n\tpassphrase = gtk_entry_get_text(GTK_ENTRY(entry));\n\tif (result == 0)\n\t\tputs(passphrase);\n\t\t\n\t/* Zero passphrase in memory */\n\tmemset(passphrase, '\\0', strlen(passphrase));\n\tgtk_entry_set_text(GTK_ENTRY(entry), passphrase);\n\t\t\t\n\tgnome_dialog_close(GNOME_DIALOG(dialog));\n\treturn (result == 0 ? 0 : -1);\n\n\t/* At least one grab failed - ungrab what we got, and report\n\t   the failure to the user.  Note that XGrabServer() cannot\n\t   fail.  */\n nograbkb:\n\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n nograb:\n\tif (grab_server)\n\t\tXUngrabServer(GDK_DISPLAY());\n\tgnome_dialog_close(GNOME_DIALOG(dialog));\n\t\n\treport_failed_grab();\n\treturn (-1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setvbuf",
          "args": [
            "stdout",
            "0",
            "_IONBF",
            "0"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnome_init",
          "args": [
            "\"GNOME ssh-askpass\"",
            "\"0.1\"",
            "argc",
            "argv"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <gdk/gdkx.h>\n#include <X11/Xlib.h>\n#include <gnome.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nint\nmain(int argc, char **argv)\n{\n\tchar *message;\n\tint result;\n\n\tgnome_init(\"GNOME ssh-askpass\", \"0.1\", argc, argv);\n\n\tif (argc == 2)\n\t\tmessage = argv[1];\n\telse\n\t\tmessage = \"Enter your OpenSSH passphrase:\";\n\n\tsetvbuf(stdout, 0, _IONBF, 0);\n\tresult = passphrase_dialog(message);\n\n\treturn (result);\n}"
  },
  {
    "function_name": "passphrase_dialog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass1.c",
    "lines": "67-152",
    "snippet": "int\npassphrase_dialog(char *message)\n{\n\tchar *passphrase;\n\tchar **messages;\n\tint result, i, grab_server, grab_pointer;\n\tGtkWidget *dialog, *entry, *label;\n\n\tgrab_server = (getenv(\"GNOME_SSH_ASKPASS_GRAB_SERVER\") != NULL);\n\tgrab_pointer = (getenv(\"GNOME_SSH_ASKPASS_GRAB_POINTER\") != NULL);\n\n\tdialog = gnome_dialog_new(\"OpenSSH\", GNOME_STOCK_BUTTON_OK,\n\t    GNOME_STOCK_BUTTON_CANCEL, NULL);\n\n\tmessages = g_strsplit(message, \"\\\\n\", 0);\n\tif (messages)\n\t\tfor(i = 0; messages[i]; i++) {\n\t\t\tlabel = gtk_label_new(messages[i]);\n\t\t\tgtk_box_pack_start(GTK_BOX(GNOME_DIALOG(dialog)->vbox),\n\t\t\t    label, FALSE, FALSE, 0);\n\t\t}\n\n\tentry = gtk_entry_new();\n\tgtk_box_pack_start(GTK_BOX(GNOME_DIALOG(dialog)->vbox), entry, FALSE,\n\t    FALSE, 0);\n\tgtk_entry_set_visibility(GTK_ENTRY(entry), FALSE);\n\tgtk_widget_grab_focus(entry);\n\n\t/* Center window and prepare for grab */\n\tgtk_object_set(GTK_OBJECT(dialog), \"type\", GTK_WINDOW_POPUP, NULL);\n\tgnome_dialog_set_default(GNOME_DIALOG(dialog), 0);\n\tgtk_window_set_position (GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);\n\tgtk_window_set_policy(GTK_WINDOW(dialog), FALSE, FALSE, TRUE);\n\tgnome_dialog_close_hides(GNOME_DIALOG(dialog), TRUE);\n\tgtk_container_set_border_width(GTK_CONTAINER(GNOME_DIALOG(dialog)->vbox),\n\t    GNOME_PAD);\n\tgtk_widget_show_all(dialog);\n\n\t/* Grab focus */\n\tif (grab_server)\n\t\tXGrabServer(GDK_DISPLAY());\n\tif (grab_pointer && gdk_pointer_grab(dialog->window, TRUE, 0,\n\t    NULL, NULL, GDK_CURRENT_TIME))\n\t\tgoto nograb;\n\tif (gdk_keyboard_grab(dialog->window, FALSE, GDK_CURRENT_TIME))\n\t\tgoto nograbkb;\n\n\t/* Make <enter> close dialog */\n\tgnome_dialog_editable_enters(GNOME_DIALOG(dialog), GTK_EDITABLE(entry));\n\n\t/* Run dialog */\n\tresult = gnome_dialog_run(GNOME_DIALOG(dialog));\n\n\t/* Ungrab */\n\tif (grab_server)\n\t\tXUngrabServer(GDK_DISPLAY());\n\tif (grab_pointer)\n\t\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n\tgdk_keyboard_ungrab(GDK_CURRENT_TIME);\n\tgdk_flush();\n\n\t/* Report passphrase if user selected OK */\n\tpassphrase = gtk_entry_get_text(GTK_ENTRY(entry));\n\tif (result == 0)\n\t\tputs(passphrase);\n\t\t\n\t/* Zero passphrase in memory */\n\tmemset(passphrase, '\\0', strlen(passphrase));\n\tgtk_entry_set_text(GTK_ENTRY(entry), passphrase);\n\t\t\t\n\tgnome_dialog_close(GNOME_DIALOG(dialog));\n\treturn (result == 0 ? 0 : -1);\n\n\t/* At least one grab failed - ungrab what we got, and report\n\t   the failure to the user.  Note that XGrabServer() cannot\n\t   fail.  */\n nograbkb:\n\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n nograb:\n\tif (grab_server)\n\t\tXUngrabServer(GDK_DISPLAY());\n\tgnome_dialog_close(GNOME_DIALOG(dialog));\n\t\n\treport_failed_grab();\n\treturn (-1);\n}",
    "includes": [
      "#include <gdk/gdkx.h>",
      "#include <X11/Xlib.h>",
      "#include <gnome.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "report_failed_grab",
          "args": [],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "report_failed_grab",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass1.c",
          "lines": "53-65",
          "snippet": "void\nreport_failed_grab (void)\n{\n\tGtkWidget *err;\n\n\terr = gnome_message_box_new(\"Could not grab keyboard or mouse.\\n\"\n\t\t\"A malicious client may be eavesdropping on your session.\",\n\t\t\t\t    GNOME_MESSAGE_BOX_ERROR, \"EXIT\", NULL);\n\tgtk_window_set_position(GTK_WINDOW(err), GTK_WIN_POS_CENTER);\n\tgtk_object_set(GTK_OBJECT(err), \"type\", GTK_WINDOW_POPUP, NULL);\n\n\tgnome_dialog_run_and_close(GNOME_DIALOG(err));\n}",
          "includes": [
            "#include <gdk/gdkx.h>",
            "#include <X11/Xlib.h>",
            "#include <gnome.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gdk/gdkx.h>\n#include <X11/Xlib.h>\n#include <gnome.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nvoid\nreport_failed_grab (void)\n{\n\tGtkWidget *err;\n\n\terr = gnome_message_box_new(\"Could not grab keyboard or mouse.\\n\"\n\t\t\"A malicious client may be eavesdropping on your session.\",\n\t\t\t\t    GNOME_MESSAGE_BOX_ERROR, \"EXIT\", NULL);\n\tgtk_window_set_position(GTK_WINDOW(err), GTK_WIN_POS_CENTER);\n\tgtk_object_set(GTK_OBJECT(err), \"type\", GTK_WINDOW_POPUP, NULL);\n\n\tgnome_dialog_run_and_close(GNOME_DIALOG(err));\n}"
        }
      },
      {
        "call_info": {
          "callee": "gnome_dialog_close",
          "args": [
            "GNOME_DIALOG(dialog)"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNOME_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XUngrabServer",
          "args": [
            "GDK_DISPLAY()"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GDK_DISPLAY",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_pointer_ungrab",
          "args": [
            "GDK_CURRENT_TIME"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnome_dialog_close",
          "args": [
            "GNOME_DIALOG(dialog)"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNOME_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_entry_set_text",
          "args": [
            "GTK_ENTRY(entry)",
            "passphrase"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_ENTRY",
          "args": [
            "entry"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "passphrase",
            "'\\0'",
            "strlen(passphrase)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "passphrase"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "puts",
          "args": [
            "passphrase"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_entry_get_text",
          "args": [
            "GTK_ENTRY(entry)"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_ENTRY",
          "args": [
            "entry"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_flush",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_keyboard_ungrab",
          "args": [
            "GDK_CURRENT_TIME"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_pointer_ungrab",
          "args": [
            "GDK_CURRENT_TIME"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XUngrabServer",
          "args": [
            "GDK_DISPLAY()"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GDK_DISPLAY",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnome_dialog_run",
          "args": [
            "GNOME_DIALOG(dialog)"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNOME_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnome_dialog_editable_enters",
          "args": [
            "GNOME_DIALOG(dialog)",
            "GTK_EDITABLE(entry)"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_EDITABLE",
          "args": [
            "entry"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNOME_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_keyboard_grab",
          "args": [
            "dialog->window",
            "FALSE",
            "GDK_CURRENT_TIME"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_pointer_grab",
          "args": [
            "dialog->window",
            "TRUE",
            "0",
            "NULL",
            "NULL",
            "GDK_CURRENT_TIME"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XGrabServer",
          "args": [
            "GDK_DISPLAY()"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GDK_DISPLAY",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_widget_show_all",
          "args": [
            "dialog"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_container_set_border_width",
          "args": [
            "GTK_CONTAINER(GNOME_DIALOG(dialog)->vbox)",
            "GNOME_PAD"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_CONTAINER",
          "args": [
            "GNOME_DIALOG(dialog)->vbox"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNOME_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnome_dialog_close_hides",
          "args": [
            "GNOME_DIALOG(dialog)",
            "TRUE"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNOME_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_window_set_policy",
          "args": [
            "GTK_WINDOW(dialog)",
            "FALSE",
            "FALSE",
            "TRUE"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WINDOW",
          "args": [
            "dialog"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_window_set_position",
          "args": [
            "GTK_WINDOW(dialog)",
            "GTK_WIN_POS_CENTER"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WINDOW",
          "args": [
            "dialog"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnome_dialog_set_default",
          "args": [
            "GNOME_DIALOG(dialog)",
            "0"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNOME_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_object_set",
          "args": [
            "GTK_OBJECT(dialog)",
            "\"type\"",
            "GTK_WINDOW_POPUP",
            "NULL"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_OBJECT",
          "args": [
            "dialog"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_widget_grab_focus",
          "args": [
            "entry"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_entry_set_visibility",
          "args": [
            "GTK_ENTRY(entry)",
            "FALSE"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_ENTRY",
          "args": [
            "entry"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_box_pack_start",
          "args": [
            "GTK_BOX(GNOME_DIALOG(dialog)->vbox)",
            "entry",
            "FALSE",
            "FALSE",
            "0"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_BOX",
          "args": [
            "GNOME_DIALOG(dialog)->vbox"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNOME_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_entry_new",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_box_pack_start",
          "args": [
            "GTK_BOX(GNOME_DIALOG(dialog)->vbox)",
            "label",
            "FALSE",
            "FALSE",
            "0"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_BOX",
          "args": [
            "GNOME_DIALOG(dialog)->vbox"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNOME_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_label_new",
          "args": [
            "messages[i]"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strsplit",
          "args": [
            "message",
            "\"\\\\n\"",
            "0"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnome_dialog_new",
          "args": [
            "\"OpenSSH\"",
            "GNOME_STOCK_BUTTON_OK",
            "GNOME_STOCK_BUTTON_CANCEL",
            "NULL"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"GNOME_SSH_ASKPASS_GRAB_POINTER\""
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "pam_getenvlist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/auth-pam.c",
          "lines": "254-263",
          "snippet": "static char **\npam_getenvlist(pam_handle_t *pamh)\n{\n\t/*\n\t * XXX - If necessary, we can still support envrionment passing\n\t * for platforms without pam_getenvlist by searching for known\n\t * env vars (e.g. KRB5CCNAME) from the PAM environment.\n\t */\n\t return NULL;\n}",
          "includes": [
            "#include <pthread.h>",
            "#include \"monitor_wrap.h\"",
            "#include \"ssh-gss.h\"",
            "#include \"auth-options.h\"",
            "#include \"ssh2.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"packet.h\"",
            "#include \"msg.h\"",
            "#include \"log.h\"",
            "#include \"canohost.h\"",
            "#include \"auth-pam.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"xmalloc.h\"",
            "#include <pam/pam_appl.h>",
            "#include <security/pam_appl.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <pthread.h>\n#include \"monitor_wrap.h\"\n#include \"ssh-gss.h\"\n#include \"auth-options.h\"\n#include \"ssh2.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"packet.h\"\n#include \"msg.h\"\n#include \"log.h\"\n#include \"canohost.h\"\n#include \"auth-pam.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"xmalloc.h\"\n#include <pam/pam_appl.h>\n#include <security/pam_appl.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <errno.h>\n#include <sys/wait.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char **\npam_getenvlist(pam_handle_t *pamh)\n{\n\t/*\n\t * XXX - If necessary, we can still support envrionment passing\n\t * for platforms without pam_getenvlist by searching for known\n\t * env vars (e.g. KRB5CCNAME) from the PAM environment.\n\t */\n\t return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <gdk/gdkx.h>\n#include <X11/Xlib.h>\n#include <gnome.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nint\npassphrase_dialog(char *message)\n{\n\tchar *passphrase;\n\tchar **messages;\n\tint result, i, grab_server, grab_pointer;\n\tGtkWidget *dialog, *entry, *label;\n\n\tgrab_server = (getenv(\"GNOME_SSH_ASKPASS_GRAB_SERVER\") != NULL);\n\tgrab_pointer = (getenv(\"GNOME_SSH_ASKPASS_GRAB_POINTER\") != NULL);\n\n\tdialog = gnome_dialog_new(\"OpenSSH\", GNOME_STOCK_BUTTON_OK,\n\t    GNOME_STOCK_BUTTON_CANCEL, NULL);\n\n\tmessages = g_strsplit(message, \"\\\\n\", 0);\n\tif (messages)\n\t\tfor(i = 0; messages[i]; i++) {\n\t\t\tlabel = gtk_label_new(messages[i]);\n\t\t\tgtk_box_pack_start(GTK_BOX(GNOME_DIALOG(dialog)->vbox),\n\t\t\t    label, FALSE, FALSE, 0);\n\t\t}\n\n\tentry = gtk_entry_new();\n\tgtk_box_pack_start(GTK_BOX(GNOME_DIALOG(dialog)->vbox), entry, FALSE,\n\t    FALSE, 0);\n\tgtk_entry_set_visibility(GTK_ENTRY(entry), FALSE);\n\tgtk_widget_grab_focus(entry);\n\n\t/* Center window and prepare for grab */\n\tgtk_object_set(GTK_OBJECT(dialog), \"type\", GTK_WINDOW_POPUP, NULL);\n\tgnome_dialog_set_default(GNOME_DIALOG(dialog), 0);\n\tgtk_window_set_position (GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);\n\tgtk_window_set_policy(GTK_WINDOW(dialog), FALSE, FALSE, TRUE);\n\tgnome_dialog_close_hides(GNOME_DIALOG(dialog), TRUE);\n\tgtk_container_set_border_width(GTK_CONTAINER(GNOME_DIALOG(dialog)->vbox),\n\t    GNOME_PAD);\n\tgtk_widget_show_all(dialog);\n\n\t/* Grab focus */\n\tif (grab_server)\n\t\tXGrabServer(GDK_DISPLAY());\n\tif (grab_pointer && gdk_pointer_grab(dialog->window, TRUE, 0,\n\t    NULL, NULL, GDK_CURRENT_TIME))\n\t\tgoto nograb;\n\tif (gdk_keyboard_grab(dialog->window, FALSE, GDK_CURRENT_TIME))\n\t\tgoto nograbkb;\n\n\t/* Make <enter> close dialog */\n\tgnome_dialog_editable_enters(GNOME_DIALOG(dialog), GTK_EDITABLE(entry));\n\n\t/* Run dialog */\n\tresult = gnome_dialog_run(GNOME_DIALOG(dialog));\n\n\t/* Ungrab */\n\tif (grab_server)\n\t\tXUngrabServer(GDK_DISPLAY());\n\tif (grab_pointer)\n\t\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n\tgdk_keyboard_ungrab(GDK_CURRENT_TIME);\n\tgdk_flush();\n\n\t/* Report passphrase if user selected OK */\n\tpassphrase = gtk_entry_get_text(GTK_ENTRY(entry));\n\tif (result == 0)\n\t\tputs(passphrase);\n\t\t\n\t/* Zero passphrase in memory */\n\tmemset(passphrase, '\\0', strlen(passphrase));\n\tgtk_entry_set_text(GTK_ENTRY(entry), passphrase);\n\t\t\t\n\tgnome_dialog_close(GNOME_DIALOG(dialog));\n\treturn (result == 0 ? 0 : -1);\n\n\t/* At least one grab failed - ungrab what we got, and report\n\t   the failure to the user.  Note that XGrabServer() cannot\n\t   fail.  */\n nograbkb:\n\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n nograb:\n\tif (grab_server)\n\t\tXUngrabServer(GDK_DISPLAY());\n\tgnome_dialog_close(GNOME_DIALOG(dialog));\n\t\n\treport_failed_grab();\n\treturn (-1);\n}"
  },
  {
    "function_name": "report_failed_grab",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass1.c",
    "lines": "53-65",
    "snippet": "void\nreport_failed_grab (void)\n{\n\tGtkWidget *err;\n\n\terr = gnome_message_box_new(\"Could not grab keyboard or mouse.\\n\"\n\t\t\"A malicious client may be eavesdropping on your session.\",\n\t\t\t\t    GNOME_MESSAGE_BOX_ERROR, \"EXIT\", NULL);\n\tgtk_window_set_position(GTK_WINDOW(err), GTK_WIN_POS_CENTER);\n\tgtk_object_set(GTK_OBJECT(err), \"type\", GTK_WINDOW_POPUP, NULL);\n\n\tgnome_dialog_run_and_close(GNOME_DIALOG(err));\n}",
    "includes": [
      "#include <gdk/gdkx.h>",
      "#include <X11/Xlib.h>",
      "#include <gnome.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gnome_dialog_run_and_close",
          "args": [
            "GNOME_DIALOG(err)"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNOME_DIALOG",
          "args": [
            "err"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_object_set",
          "args": [
            "GTK_OBJECT(err)",
            "\"type\"",
            "GTK_WINDOW_POPUP",
            "NULL"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_OBJECT",
          "args": [
            "err"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_window_set_position",
          "args": [
            "GTK_WINDOW(err)",
            "GTK_WIN_POS_CENTER"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WINDOW",
          "args": [
            "err"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnome_message_box_new",
          "args": [
            "\"Could not grab keyboard or mouse.\\n\"\n\t\t\"A malicious client may be eavesdropping on your session.\"",
            "GNOME_MESSAGE_BOX_ERROR",
            "\"EXIT\"",
            "NULL"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <gdk/gdkx.h>\n#include <X11/Xlib.h>\n#include <gnome.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nvoid\nreport_failed_grab (void)\n{\n\tGtkWidget *err;\n\n\terr = gnome_message_box_new(\"Could not grab keyboard or mouse.\\n\"\n\t\t\"A malicious client may be eavesdropping on your session.\",\n\t\t\t\t    GNOME_MESSAGE_BOX_ERROR, \"EXIT\", NULL);\n\tgtk_window_set_position(GTK_WINDOW(err), GTK_WIN_POS_CENTER);\n\tgtk_object_set(GTK_OBJECT(err), \"type\", GTK_WINDOW_POPUP, NULL);\n\n\tgnome_dialog_run_and_close(GNOME_DIALOG(err));\n}"
  }
]