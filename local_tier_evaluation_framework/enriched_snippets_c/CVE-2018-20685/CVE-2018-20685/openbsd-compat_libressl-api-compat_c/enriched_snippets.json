[
  {
    "function_name": "EVP_MD_CTX_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "628-637",
    "snippet": "void\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ctx"
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "EVP_MD_CTX_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "628-637",
          "snippet": "void\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "EVP_MD_CTX_cleanup",
          "args": [
            "ctx"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}"
  },
  {
    "function_name": "EVP_MD_CTX_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "620-624",
    "snippet": "EVP_MD_CTX *\nEVP_MD_CTX_new(void)\n{\n\treturn calloc(1, sizeof(EVP_MD_CTX));\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "1",
            "sizeof(EVP_MD_CTX)"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "rpl_calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-malloc.c",
          "lines": "36-44",
          "snippet": "void *\nrpl_calloc(size_t nmemb, size_t size)\n{\n\tif (nmemb == 0)\n\t\tnmemb = 1;\n\tif (size == 0)\n\t\tsize = 1;\n\treturn calloc(nmemb, size);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nvoid *\nrpl_calloc(size_t nmemb, size_t size)\n{\n\tif (nmemb == 0)\n\t\tnmemb = 1;\n\tif (size == 0)\n\t\tsize = 1;\n\treturn calloc(nmemb, size);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nEVP_MD_CTX *\nEVP_MD_CTX_new(void)\n{\n\treturn calloc(1, sizeof(EVP_MD_CTX));\n}"
  },
  {
    "function_name": "EVP_PKEY_get0_RSA",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "608-616",
    "snippet": "RSA *\nEVP_PKEY_get0_RSA(EVP_PKEY *pkey)\n{\n\tif (pkey->type != EVP_PKEY_RSA) {\n\t\t/* EVPerror(EVP_R_EXPECTING_AN_RSA_KEY); */\n\t\treturn NULL;\n\t}\n\treturn pkey->pkey.rsa;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nRSA *\nEVP_PKEY_get0_RSA(EVP_PKEY *pkey)\n{\n\tif (pkey->type != EVP_PKEY_RSA) {\n\t\t/* EVPerror(EVP_R_EXPECTING_AN_RSA_KEY); */\n\t\treturn NULL;\n\t}\n\treturn pkey->pkey.rsa;\n}"
  },
  {
    "function_name": "RSA_meth_set_finish",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "599-604",
    "snippet": "int\nRSA_meth_set_finish(RSA_METHOD *meth, int (*finish)(RSA *rsa))\n{\n\tmeth->finish = finish;\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nRSA_meth_set_finish(RSA_METHOD *meth, int (*finish)(RSA *rsa))\n{\n\tmeth->finish = finish;\n\treturn 1;\n}"
  },
  {
    "function_name": "RSA_meth_set_priv_dec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "589-595",
    "snippet": "int\nRSA_meth_set_priv_dec(RSA_METHOD *meth, int (*priv_dec)(int flen,\n    const unsigned char *from, unsigned char *to, RSA *rsa, int padding))\n{\n\tmeth->rsa_priv_dec = priv_dec;\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nRSA_meth_set_priv_dec(RSA_METHOD *meth, int (*priv_dec)(int flen,\n    const unsigned char *from, unsigned char *to, RSA *rsa, int padding))\n{\n\tmeth->rsa_priv_dec = priv_dec;\n\treturn 1;\n}"
  },
  {
    "function_name": "RSA_meth_set_priv_enc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "579-585",
    "snippet": "int\nRSA_meth_set_priv_enc(RSA_METHOD *meth, int (*priv_enc)(int flen,\n    const unsigned char *from, unsigned char *to, RSA *rsa, int padding))\n{\n\tmeth->rsa_priv_enc = priv_enc;\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nRSA_meth_set_priv_enc(RSA_METHOD *meth, int (*priv_enc)(int flen,\n    const unsigned char *from, unsigned char *to, RSA *rsa, int padding))\n{\n\tmeth->rsa_priv_enc = priv_enc;\n\treturn 1;\n}"
  },
  {
    "function_name": "RSA_meth_get_finish",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "571-575",
    "snippet": "int\n(*RSA_meth_get_finish(const RSA_METHOD *meth))(RSA *rsa)\n{\n\treturn meth->finish;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\n(*RSA_meth_get_finish(const RSA_METHOD *meth))(RSA *rsa)\n{\n\treturn meth->finish;\n}"
  },
  {
    "function_name": "RSA_meth_set1_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "557-567",
    "snippet": "int\nRSA_meth_set1_name(RSA_METHOD *meth, const char *name)\n{\n\tchar *copy;\n\n\tif ((copy = strdup(name)) == NULL)\n\t\treturn 0;\n\tfree((char *)meth->name);\n\tmeth->name = copy;\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "(char *)meth->name"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "EVP_MD_CTX_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "628-637",
          "snippet": "void\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "name"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "216-227",
          "snippet": "char *\nstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = malloc(len);\n\tif (cp != NULL)\n\t\treturn(memcpy(cp, str, len));\n\treturn NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = malloc(len);\n\tif (cp != NULL)\n\t\treturn(memcpy(cp, str, len));\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nRSA_meth_set1_name(RSA_METHOD *meth, const char *name)\n{\n\tchar *copy;\n\n\tif ((copy = strdup(name)) == NULL)\n\t\treturn 0;\n\tfree((char *)meth->name);\n\tmeth->name = copy;\n\treturn 1;\n}"
  },
  {
    "function_name": "RSA_meth_dup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "539-553",
    "snippet": "RSA_METHOD *\nRSA_meth_dup(const RSA_METHOD *meth)\n{\n\tRSA_METHOD *copy;\n\n\tif ((copy = calloc(1, sizeof(*copy))) == NULL)\n\t\treturn NULL;\n\tmemcpy(copy, meth, sizeof(*copy));\n\tif ((copy->name = strdup(meth->name)) == NULL) {\n\t\tfree(copy);\n\t\treturn NULL;\n\t}\n\n\treturn copy;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "copy"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "EVP_MD_CTX_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "628-637",
          "snippet": "void\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "meth->name"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "216-227",
          "snippet": "char *\nstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = malloc(len);\n\tif (cp != NULL)\n\t\treturn(memcpy(cp, str, len));\n\treturn NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = malloc(len);\n\tif (cp != NULL)\n\t\treturn(memcpy(cp, str, len));\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "copy",
            "meth",
            "sizeof(*copy)"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "1",
            "sizeof(*copy)"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "rpl_calloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-malloc.c",
          "lines": "36-44",
          "snippet": "void *\nrpl_calloc(size_t nmemb, size_t size)\n{\n\tif (nmemb == 0)\n\t\tnmemb = 1;\n\tif (size == 0)\n\t\tsize = 1;\n\treturn calloc(nmemb, size);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nvoid *\nrpl_calloc(size_t nmemb, size_t size)\n{\n\tif (nmemb == 0)\n\t\tnmemb = 1;\n\tif (size == 0)\n\t\tsize = 1;\n\treturn calloc(nmemb, size);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nRSA_METHOD *\nRSA_meth_dup(const RSA_METHOD *meth)\n{\n\tRSA_METHOD *copy;\n\n\tif ((copy = calloc(1, sizeof(*copy))) == NULL)\n\t\treturn NULL;\n\tmemcpy(copy, meth, sizeof(*copy));\n\tif ((copy->name = strdup(meth->name)) == NULL) {\n\t\tfree(copy);\n\t\treturn NULL;\n\t}\n\n\treturn copy;\n}"
  },
  {
    "function_name": "RSA_meth_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "528-535",
    "snippet": "void\nRSA_meth_free(RSA_METHOD *meth)\n{\n\tif (meth != NULL) {\n\t\tfree((char *)meth->name);\n\t\tfree(meth);\n\t}\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "meth"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "EVP_MD_CTX_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "628-637",
          "snippet": "void\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_meth_free(RSA_METHOD *meth)\n{\n\tif (meth != NULL) {\n\t\tfree((char *)meth->name);\n\t\tfree(meth);\n\t}\n}"
  },
  {
    "function_name": "DH_set_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "516-524",
    "snippet": "int\nDH_set_length(DH *dh, long length)\n{\n\tif (length < 0 || length > INT_MAX)\n\t\treturn 0;\n\n\tdh->length = length;\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nDH_set_length(DH *dh, long length)\n{\n\tif (length < 0 || length > INT_MAX)\n\t\treturn 0;\n\n\tdh->length = length;\n\treturn 1;\n}"
  },
  {
    "function_name": "DH_set0_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "499-512",
    "snippet": "int\nDH_set0_key(DH *dh, BIGNUM *pub_key, BIGNUM *priv_key)\n{\n\tif (pub_key != NULL) {\n\t\tBN_free(dh->pub_key);\n\t\tdh->pub_key = pub_key;\n\t}\n\tif (priv_key != NULL) {\n\t\tBN_free(dh->priv_key);\n\t\tdh->priv_key = priv_key;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "dh->priv_key"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "dh->pub_key"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nDH_set0_key(DH *dh, BIGNUM *pub_key, BIGNUM *priv_key)\n{\n\tif (pub_key != NULL) {\n\t\tBN_free(dh->pub_key);\n\t\tdh->pub_key = pub_key;\n\t}\n\tif (priv_key != NULL) {\n\t\tBN_free(dh->priv_key);\n\t\tdh->priv_key = priv_key;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "DH_get0_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "488-495",
    "snippet": "void\nDH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = dh->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = dh->priv_key;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = dh->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = dh->priv_key;\n}"
  },
  {
    "function_name": "DH_set0_pqg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "464-484",
    "snippet": "int\nDH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g)\n{\n\tif ((dh->p == NULL && p == NULL) || (dh->g == NULL && g == NULL))\n\t\treturn 0;\n\n\tif (p != NULL) {\n\t\tBN_free(dh->p);\n\t\tdh->p = p;\n\t}\n\tif (q != NULL) {\n\t\tBN_free(dh->q);\n\t\tdh->q = q;\n\t}\n\tif (g != NULL) {\n\t\tBN_free(dh->g);\n\t\tdh->g = g;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "dh->g"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "dh->q"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "dh->p"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nDH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g)\n{\n\tif ((dh->p == NULL && p == NULL) || (dh->g == NULL && g == NULL))\n\t\treturn 0;\n\n\tif (p != NULL) {\n\t\tBN_free(dh->p);\n\t\tdh->p = p;\n\t}\n\tif (q != NULL) {\n\t\tBN_free(dh->q);\n\t\tdh->q = q;\n\t}\n\tif (g != NULL) {\n\t\tBN_free(dh->g);\n\t\tdh->g = g;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "DH_get0_pqg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "451-460",
    "snippet": "void\nDH_get0_pqg(const DH *dh, const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)\n{\n\tif (p != NULL)\n\t\t*p = dh->p;\n\tif (q != NULL)\n\t\t*q = dh->q;\n\tif (g != NULL)\n\t\t*g = dh->g;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDH_get0_pqg(const DH *dh, const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)\n{\n\tif (p != NULL)\n\t\t*p = dh->p;\n\tif (q != NULL)\n\t\t*q = dh->q;\n\tif (g != NULL)\n\t\t*g = dh->g;\n}"
  },
  {
    "function_name": "ECDSA_SIG_set0",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "435-446",
    "snippet": "int\nECDSA_SIG_set0(ECDSA_SIG *sig, BIGNUM *r, BIGNUM *s)\n{\n\tif (r == NULL || s == NULL)\n\t\treturn 0;\n\n\tBN_clear_free(sig->r);\n\tBN_clear_free(sig->s);\n\tsig->r = r;\n\tsig->s = s;\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "sig->s"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "sig->r"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nECDSA_SIG_set0(ECDSA_SIG *sig, BIGNUM *r, BIGNUM *s)\n{\n\tif (r == NULL || s == NULL)\n\t\treturn 0;\n\n\tBN_clear_free(sig->r);\n\tBN_clear_free(sig->s);\n\tsig->r = r;\n\tsig->s = s;\n\treturn 1;\n}"
  },
  {
    "function_name": "ECDSA_SIG_get0",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "424-431",
    "snippet": "void\nECDSA_SIG_get0(const ECDSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps)\n{\n\tif (pr != NULL)\n\t\t*pr = sig->r;\n\tif (ps != NULL)\n\t\t*ps = sig->s;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nECDSA_SIG_get0(const ECDSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps)\n{\n\tif (pr != NULL)\n\t\t*pr = sig->r;\n\tif (ps != NULL)\n\t\t*ps = sig->s;\n}"
  },
  {
    "function_name": "DSA_SIG_set0",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "407-419",
    "snippet": "int\nDSA_SIG_set0(DSA_SIG *sig, BIGNUM *r, BIGNUM *s)\n{\n\tif (r == NULL || s == NULL)\n\t\treturn 0;\n\n\tBN_clear_free(sig->r);\n\tsig->r = r;\n\tBN_clear_free(sig->s);\n\tsig->s = s;\n\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "sig->s"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "sig->r"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nDSA_SIG_set0(DSA_SIG *sig, BIGNUM *r, BIGNUM *s)\n{\n\tif (r == NULL || s == NULL)\n\t\treturn 0;\n\n\tBN_clear_free(sig->r);\n\tsig->r = r;\n\tBN_clear_free(sig->s);\n\tsig->s = s;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "DSA_SIG_get0",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "396-403",
    "snippet": "void\nDSA_SIG_get0(const DSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps)\n{\n\tif (pr != NULL)\n\t\t*pr = sig->r;\n\tif (ps != NULL)\n\t\t*ps = sig->s;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDSA_SIG_get0(const DSA_SIG *sig, const BIGNUM **pr, const BIGNUM **ps)\n{\n\tif (pr != NULL)\n\t\t*pr = sig->r;\n\tif (ps != NULL)\n\t\t*ps = sig->s;\n}"
  },
  {
    "function_name": "EVP_CIPHER_CTX_set_iv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "367-392",
    "snippet": "int\nEVP_CIPHER_CTX_set_iv(EVP_CIPHER_CTX *ctx, const unsigned char *iv, size_t len)\n{\n\tif (ctx == NULL)\n\t\treturn 0;\n\tif (EVP_CIPHER_CTX_iv_length(ctx) < 0)\n\t\treturn 0;\n\tif (len != (size_t)EVP_CIPHER_CTX_iv_length(ctx))\n\t\treturn 0;\n\tif (len > EVP_MAX_IV_LENGTH)\n\t\treturn 0; /* sanity check; shouldn't happen */\n\t/*\n\t * Skip the memcpy entirely when the requested IV length is zero,\n\t * since the iv pointer may be NULL or invalid.\n\t */\n\tif (len != 0) {\n\t\tif (iv == NULL)\n\t\t\treturn 0;\n# ifdef HAVE_EVP_CIPHER_CTX_IV_NOCONST\n\t\tmemcpy(EVP_CIPHER_CTX_iv_noconst(ctx), iv, len);\n# else\n\t\tmemcpy(ctx->iv, iv, len);\n# endif /* HAVE_EVP_CIPHER_CTX_IV_NOCONST */\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ctx->iv",
            "iv",
            "len"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "EVP_CIPHER_CTX_iv_noconst(ctx)",
            "iv",
            "len"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVP_CIPHER_CTX_iv_noconst",
          "args": [
            "ctx"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVP_CIPHER_CTX_iv_length",
          "args": [
            "ctx"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVP_CIPHER_CTX_iv_length",
          "args": [
            "ctx"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nEVP_CIPHER_CTX_set_iv(EVP_CIPHER_CTX *ctx, const unsigned char *iv, size_t len)\n{\n\tif (ctx == NULL)\n\t\treturn 0;\n\tif (EVP_CIPHER_CTX_iv_length(ctx) < 0)\n\t\treturn 0;\n\tif (len != (size_t)EVP_CIPHER_CTX_iv_length(ctx))\n\t\treturn 0;\n\tif (len > EVP_MAX_IV_LENGTH)\n\t\treturn 0; /* sanity check; shouldn't happen */\n\t/*\n\t * Skip the memcpy entirely when the requested IV length is zero,\n\t * since the iv pointer may be NULL or invalid.\n\t */\n\tif (len != 0) {\n\t\tif (iv == NULL)\n\t\t\treturn 0;\n# ifdef HAVE_EVP_CIPHER_CTX_IV_NOCONST\n\t\tmemcpy(EVP_CIPHER_CTX_iv_noconst(ctx), iv, len);\n# else\n\t\tmemcpy(ctx->iv, iv, len);\n# endif /* HAVE_EVP_CIPHER_CTX_IV_NOCONST */\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "EVP_CIPHER_CTX_get_iv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "338-363",
    "snippet": "int\nEVP_CIPHER_CTX_get_iv(const EVP_CIPHER_CTX *ctx, unsigned char *iv, size_t len)\n{\n\tif (ctx == NULL)\n\t\treturn 0;\n\tif (EVP_CIPHER_CTX_iv_length(ctx) < 0)\n\t\treturn 0;\n\tif (len != (size_t)EVP_CIPHER_CTX_iv_length(ctx))\n\t\treturn 0;\n\tif (len > EVP_MAX_IV_LENGTH)\n\t\treturn 0; /* sanity check; shouldn't happen */\n\t/*\n\t * Skip the memcpy entirely when the requested IV length is zero,\n\t * since the iv pointer may be NULL or invalid.\n\t */\n\tif (len != 0) {\n\t\tif (iv == NULL)\n\t\t\treturn 0;\n# ifdef HAVE_EVP_CIPHER_CTX_IV\n\t\tmemcpy(iv, EVP_CIPHER_CTX_iv(ctx), len);\n# else\n\t\tmemcpy(iv, ctx->iv, len);\n# endif /* HAVE_EVP_CIPHER_CTX_IV */\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "iv",
            "ctx->iv",
            "len"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "iv",
            "EVP_CIPHER_CTX_iv(ctx)",
            "len"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVP_CIPHER_CTX_iv",
          "args": [
            "ctx"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVP_CIPHER_CTX_iv_length",
          "args": [
            "ctx"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVP_CIPHER_CTX_iv_length",
          "args": [
            "ctx"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nEVP_CIPHER_CTX_get_iv(const EVP_CIPHER_CTX *ctx, unsigned char *iv, size_t len)\n{\n\tif (ctx == NULL)\n\t\treturn 0;\n\tif (EVP_CIPHER_CTX_iv_length(ctx) < 0)\n\t\treturn 0;\n\tif (len != (size_t)EVP_CIPHER_CTX_iv_length(ctx))\n\t\treturn 0;\n\tif (len > EVP_MAX_IV_LENGTH)\n\t\treturn 0; /* sanity check; shouldn't happen */\n\t/*\n\t * Skip the memcpy entirely when the requested IV length is zero,\n\t * since the iv pointer may be NULL or invalid.\n\t */\n\tif (len != 0) {\n\t\tif (iv == NULL)\n\t\t\treturn 0;\n# ifdef HAVE_EVP_CIPHER_CTX_IV\n\t\tmemcpy(iv, EVP_CIPHER_CTX_iv(ctx), len);\n# else\n\t\tmemcpy(iv, ctx->iv, len);\n# endif /* HAVE_EVP_CIPHER_CTX_IV */\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "RSA_set0_factors",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "318-334",
    "snippet": "int\nRSA_set0_factors(RSA *r, BIGNUM *p, BIGNUM *q)\n{\n\tif ((r->p == NULL && p == NULL) || (r->q == NULL && q == NULL))\n\t\treturn 0;\n\n\tif (p != NULL) {\n\t\tBN_free(r->p);\n\t\tr->p = p;\n\t}\n\tif (q != NULL) {\n\t\tBN_free(r->q);\n\t\tr->q = q;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "r->q"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "r->p"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nRSA_set0_factors(RSA *r, BIGNUM *p, BIGNUM *q)\n{\n\tif ((r->p == NULL && p == NULL) || (r->q == NULL && q == NULL))\n\t\treturn 0;\n\n\tif (p != NULL) {\n\t\tBN_free(r->p);\n\t\tr->p = p;\n\t}\n\tif (q != NULL) {\n\t\tBN_free(r->q);\n\t\tr->q = q;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "RSA_get0_factors",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "307-314",
    "snippet": "void\nRSA_get0_factors(const RSA *r, const BIGNUM **p, const BIGNUM **q)\n{\n\tif (p != NULL)\n\t\t*p = r->p;\n\tif (q != NULL)\n\t\t*q = r->q;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_factors(const RSA *r, const BIGNUM **p, const BIGNUM **q)\n{\n\tif (p != NULL)\n\t\t*p = r->p;\n\tif (q != NULL)\n\t\t*q = r->q;\n}"
  },
  {
    "function_name": "RSA_set0_crt_params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "281-303",
    "snippet": "int\nRSA_set0_crt_params(RSA *r, BIGNUM *dmp1, BIGNUM *dmq1, BIGNUM *iqmp)\n{\n\tif ((r->dmp1 == NULL && dmp1 == NULL) ||\n\t    (r->dmq1 == NULL && dmq1 == NULL) ||\n\t    (r->iqmp == NULL && iqmp == NULL))\n\t       \treturn 0;\n\n\tif (dmp1 != NULL) {\n\t\tBN_free(r->dmp1);\n\t\tr->dmp1 = dmp1;\n\t}\n\tif (dmq1 != NULL) {\n\t\tBN_free(r->dmq1);\n\t\tr->dmq1 = dmq1;\n\t}\n\tif (iqmp != NULL) {\n\t\tBN_free(r->iqmp);\n\t\tr->iqmp = iqmp;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "r->iqmp"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "r->dmq1"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "r->dmp1"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nRSA_set0_crt_params(RSA *r, BIGNUM *dmp1, BIGNUM *dmq1, BIGNUM *iqmp)\n{\n\tif ((r->dmp1 == NULL && dmp1 == NULL) ||\n\t    (r->dmq1 == NULL && dmq1 == NULL) ||\n\t    (r->iqmp == NULL && iqmp == NULL))\n\t       \treturn 0;\n\n\tif (dmp1 != NULL) {\n\t\tBN_free(r->dmp1);\n\t\tr->dmp1 = dmp1;\n\t}\n\tif (dmq1 != NULL) {\n\t\tBN_free(r->dmq1);\n\t\tr->dmq1 = dmq1;\n\t}\n\tif (iqmp != NULL) {\n\t\tBN_free(r->iqmp);\n\t\tr->iqmp = iqmp;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "RSA_get0_crt_params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "267-277",
    "snippet": "void\nRSA_get0_crt_params(const RSA *r, const BIGNUM **dmp1, const BIGNUM **dmq1,\n    const BIGNUM **iqmp)\n{\n\tif (dmp1 != NULL)\n\t\t*dmp1 = r->dmp1;\n\tif (dmq1 != NULL)\n\t\t*dmq1 = r->dmq1;\n\tif (iqmp != NULL)\n\t\t*iqmp = r->iqmp;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_crt_params(const RSA *r, const BIGNUM **dmp1, const BIGNUM **dmq1,\n    const BIGNUM **iqmp)\n{\n\tif (dmp1 != NULL)\n\t\t*dmp1 = r->dmp1;\n\tif (dmq1 != NULL)\n\t\t*dmq1 = r->dmq1;\n\tif (iqmp != NULL)\n\t\t*iqmp = r->iqmp;\n}"
  },
  {
    "function_name": "RSA_set0_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "243-263",
    "snippet": "int\nRSA_set0_key(RSA *r, BIGNUM *n, BIGNUM *e, BIGNUM *d)\n{\n\tif ((r->n == NULL && n == NULL) || (r->e == NULL && e == NULL))\n\t\treturn 0;\n\n\tif (n != NULL) {\n\t\tBN_free(r->n);\n\t\tr->n = n;\n\t}\n\tif (e != NULL) {\n\t\tBN_free(r->e);\n\t\tr->e = e;\n\t}\n\tif (d != NULL) {\n\t\tBN_free(r->d);\n\t\tr->d = d;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "r->d"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "r->e"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "r->n"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nRSA_set0_key(RSA *r, BIGNUM *n, BIGNUM *e, BIGNUM *d)\n{\n\tif ((r->n == NULL && n == NULL) || (r->e == NULL && e == NULL))\n\t\treturn 0;\n\n\tif (n != NULL) {\n\t\tBN_free(r->n);\n\t\tr->n = n;\n\t}\n\tif (e != NULL) {\n\t\tBN_free(r->e);\n\t\tr->e = e;\n\t}\n\tif (d != NULL) {\n\t\tBN_free(r->d);\n\t\tr->d = d;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "RSA_get0_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "230-239",
    "snippet": "void\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}"
  },
  {
    "function_name": "DSA_set0_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "210-226",
    "snippet": "int\nDSA_set0_key(DSA *d, BIGNUM *pub_key, BIGNUM *priv_key)\n{\n\tif (d->pub_key == NULL && pub_key == NULL)\n\t\treturn 0;\n\n\tif (pub_key != NULL) {\n\t\tBN_free(d->pub_key);\n\t\td->pub_key = pub_key;\n\t}\n\tif (priv_key != NULL) {\n\t\tBN_free(d->priv_key);\n\t\td->priv_key = priv_key;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "d->priv_key"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "d->pub_key"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nDSA_set0_key(DSA *d, BIGNUM *pub_key, BIGNUM *priv_key)\n{\n\tif (d->pub_key == NULL && pub_key == NULL)\n\t\treturn 0;\n\n\tif (pub_key != NULL) {\n\t\tBN_free(d->pub_key);\n\t\td->pub_key = pub_key;\n\t}\n\tif (priv_key != NULL) {\n\t\tBN_free(d->priv_key);\n\t\td->priv_key = priv_key;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "DSA_get0_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "199-206",
    "snippet": "void\nDSA_get0_key(const DSA *d, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = d->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = d->priv_key;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDSA_get0_key(const DSA *d, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = d->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = d->priv_key;\n}"
  },
  {
    "function_name": "DSA_set0_pqg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "174-195",
    "snippet": "int\nDSA_set0_pqg(DSA *d, BIGNUM *p, BIGNUM *q, BIGNUM *g)\n{\n\tif ((d->p == NULL && p == NULL) || (d->q == NULL && q == NULL) ||\n\t    (d->g == NULL && g == NULL))\n\t\treturn 0;\n\n\tif (p != NULL) {\n\t\tBN_free(d->p);\n\t\td->p = p;\n\t}\n\tif (q != NULL) {\n\t\tBN_free(d->q);\n\t\td->q = q;\n\t}\n\tif (g != NULL) {\n\t\tBN_free(d->g);\n\t\td->g = g;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "d->g"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "d->q"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "d->p"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nDSA_set0_pqg(DSA *d, BIGNUM *p, BIGNUM *q, BIGNUM *g)\n{\n\tif ((d->p == NULL && p == NULL) || (d->q == NULL && q == NULL) ||\n\t    (d->g == NULL && g == NULL))\n\t\treturn 0;\n\n\tif (p != NULL) {\n\t\tBN_free(d->p);\n\t\td->p = p;\n\t}\n\tif (q != NULL) {\n\t\tBN_free(d->q);\n\t\td->q = q;\n\t}\n\tif (g != NULL) {\n\t\tBN_free(d->g);\n\t\td->g = g;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "DSA_get0_pqg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
    "lines": "161-170",
    "snippet": "void\nDSA_get0_pqg(const DSA *d, const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)\n{\n\tif (p != NULL)\n\t\t*p = d->p;\n\tif (q != NULL)\n\t\t*q = d->q;\n\tif (g != NULL)\n\t\t*g = d->g;\n}",
    "includes": [
      "#include <openssl/dh.h>",
      "#include <openssl/ecdsa.h>",
      "#include <openssl/evp.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/bn.h>",
      "#include <openssl/err.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDSA_get0_pqg(const DSA *d, const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)\n{\n\tif (p != NULL)\n\t\t*p = d->p;\n\tif (q != NULL)\n\t\t*q = d->q;\n\tif (g != NULL)\n\t\t*g = d->g;\n}"
  }
]