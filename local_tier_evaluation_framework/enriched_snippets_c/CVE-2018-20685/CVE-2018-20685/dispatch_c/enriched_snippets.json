[
  {
    "function_name": "ssh_dispatch_run_fatal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dispatch.c",
    "lines": "128-135",
    "snippet": "void\nssh_dispatch_run_fatal(struct ssh *ssh, int mode, volatile sig_atomic_t *done)\n{\n\tint r;\n\n\tif ((r = ssh_dispatch_run(ssh, mode, done)) != 0)\n\t\tsshpkt_fatal(ssh, __func__, r);\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"packet.h\"",
      "#include \"dispatch.h\"",
      "#include \"log.h\"",
      "#include \"ssh2.h\"",
      "#include <stdarg.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sshpkt_fatal",
          "args": [
            "ssh",
            "__func__",
            "r"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "1808-1851",
          "snippet": "void\nsshpkt_fatal(struct ssh *ssh, const char *tag, int r)\n{\n\tchar remote_id[512];\n\n\tsshpkt_fmt_connection_id(ssh, remote_id, sizeof(remote_id));\n\n\tswitch (r) {\n\tcase SSH_ERR_CONN_CLOSED:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Connection closed by %s\", remote_id);\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Connection %s %s timed out\",\n\t\t    ssh->state->server_side ? \"from\" : \"to\", remote_id);\n\tcase SSH_ERR_DISCONNECTED:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Disconnected from %s\", remote_id);\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\tif (errno == ECONNRESET) {\n\t\t\tssh_packet_clear_keys(ssh);\n\t\t\tlogdie(\"Connection reset by %s\", remote_id);\n\t\t}\n\t\t/* FALLTHROUGH */\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\tif (ssh && ssh->kex && ssh->kex->failed_choice) {\n\t\t\tssh_packet_clear_keys(ssh);\n\t\t\tlogdie(\"Unable to negotiate with %s: %s. \"\n\t\t\t    \"Their offer: %s\", remote_id, ssh_err(r),\n\t\t\t    ssh->kex->failed_choice);\n\t\t}\n\t\t/* FALLTHROUGH */\n\tdefault:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"%s%sConnection %s %s: %s\",\n\t\t    tag != NULL ? tag : \"\", tag != NULL ? \": \" : \"\",\n\t\t    ssh->state->server_side ? \"from\" : \"to\",\n\t\t    remote_id, ssh_err(r));\n\t}\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshpkt_fatal(struct ssh *ssh, const char *tag, int r)\n{\n\tchar remote_id[512];\n\n\tsshpkt_fmt_connection_id(ssh, remote_id, sizeof(remote_id));\n\n\tswitch (r) {\n\tcase SSH_ERR_CONN_CLOSED:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Connection closed by %s\", remote_id);\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Connection %s %s timed out\",\n\t\t    ssh->state->server_side ? \"from\" : \"to\", remote_id);\n\tcase SSH_ERR_DISCONNECTED:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Disconnected from %s\", remote_id);\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\tif (errno == ECONNRESET) {\n\t\t\tssh_packet_clear_keys(ssh);\n\t\t\tlogdie(\"Connection reset by %s\", remote_id);\n\t\t}\n\t\t/* FALLTHROUGH */\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\tif (ssh && ssh->kex && ssh->kex->failed_choice) {\n\t\t\tssh_packet_clear_keys(ssh);\n\t\t\tlogdie(\"Unable to negotiate with %s: %s. \"\n\t\t\t    \"Their offer: %s\", remote_id, ssh_err(r),\n\t\t\t    ssh->kex->failed_choice);\n\t\t}\n\t\t/* FALLTHROUGH */\n\tdefault:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"%s%sConnection %s %s: %s\",\n\t\t    tag != NULL ? tag : \"\", tag != NULL ? \": \" : \"\",\n\t\t    ssh->state->server_side ? \"from\" : \"to\",\n\t\t    remote_id, ssh_err(r));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_dispatch_run",
          "args": [
            "ssh",
            "mode",
            "done"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_dispatch_run_fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dispatch.c",
          "lines": "128-135",
          "snippet": "void\nssh_dispatch_run_fatal(struct ssh *ssh, int mode, volatile sig_atomic_t *done)\n{\n\tint r;\n\n\tif ((r = ssh_dispatch_run(ssh, mode, done)) != 0)\n\t\tsshpkt_fatal(ssh, __func__, r);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"dispatch.h\"\n#include \"log.h\"\n#include \"ssh2.h\"\n#include <stdarg.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_dispatch_run_fatal(struct ssh *ssh, int mode, volatile sig_atomic_t *done)\n{\n\tint r;\n\n\tif ((r = ssh_dispatch_run(ssh, mode, done)) != 0)\n\t\tsshpkt_fatal(ssh, __func__, r);\n}"
  },
  {
    "function_name": "ssh_dispatch_run",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dispatch.c",
    "lines": "87-126",
    "snippet": "int\nssh_dispatch_run(struct ssh *ssh, int mode, volatile sig_atomic_t *done)\n{\n\tint r;\n\tu_char type;\n\tu_int32_t seqnr;\n\n\tfor (;;) {\n\t\tif (mode == DISPATCH_BLOCK) {\n\t\t\tr = ssh_packet_read_seqnr(ssh, &type, &seqnr);\n\t\t\tif (r != 0)\n\t\t\t\treturn r;\n\t\t} else {\n\t\t\tr = ssh_packet_read_poll_seqnr(ssh, &type, &seqnr);\n\t\t\tif (r != 0)\n\t\t\t\treturn r;\n\t\t\tif (type == SSH_MSG_NONE)\n\t\t\t\treturn 0;\n\t\t}\n\t\tif (type > 0 && type < DISPATCH_MAX &&\n\t\t    ssh->dispatch[type] != NULL) {\n\t\t\tif (ssh->dispatch_skip_packets) {\n\t\t\t\tdebug2(\"skipped packet (type %u)\", type);\n\t\t\t\tssh->dispatch_skip_packets--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tr = (*ssh->dispatch[type])(type, seqnr, ssh);\n\t\t\tif (r != 0)\n\t\t\t\treturn r;\n\t\t} else {\n\t\t\tr = sshpkt_disconnect(ssh,\n\t\t\t    \"protocol error: rcvd type %d\", type);\n\t\t\tif (r != 0)\n\t\t\t\treturn r;\n\t\t\treturn SSH_ERR_DISCONNECTED;\n\t\t}\n\t\tif (done != NULL && *done)\n\t\t\treturn 0;\n\t}\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"packet.h\"",
      "#include \"dispatch.h\"",
      "#include \"log.h\"",
      "#include \"ssh2.h\"",
      "#include <stdarg.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sshpkt_disconnect",
          "args": [
            "ssh",
            "\"protocol error: rcvd type %d\"",
            "type"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_disconnect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2656-2674",
          "snippet": "int\nsshpkt_disconnect(struct ssh *ssh, const char *fmt,...)\n{\n\tchar buf[1024];\n\tva_list args;\n\tint r;\n\n\tva_start(args, fmt);\n\tvsnprintf(buf, sizeof(buf), fmt, args);\n\tva_end(args);\n\n\tif ((r = sshpkt_start(ssh, SSH2_MSG_DISCONNECT)) != 0 ||\n\t    (r = sshpkt_put_u32(ssh, SSH2_DISCONNECT_PROTOCOL_ERROR)) != 0 ||\n\t    (r = sshpkt_put_cstring(ssh, buf)) != 0 ||\n\t    (r = sshpkt_put_cstring(ssh, \"\")) != 0 ||\n\t    (r = sshpkt_send(ssh)) != 0)\n\t\treturn r;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_disconnect(struct ssh *ssh, const char *fmt,...)\n{\n\tchar buf[1024];\n\tva_list args;\n\tint r;\n\n\tva_start(args, fmt);\n\tvsnprintf(buf, sizeof(buf), fmt, args);\n\tva_end(args);\n\n\tif ((r = sshpkt_start(ssh, SSH2_MSG_DISCONNECT)) != 0 ||\n\t    (r = sshpkt_put_u32(ssh, SSH2_DISCONNECT_PROTOCOL_ERROR)) != 0 ||\n\t    (r = sshpkt_put_cstring(ssh, buf)) != 0 ||\n\t    (r = sshpkt_put_cstring(ssh, \"\")) != 0 ||\n\t    (r = sshpkt_send(ssh)) != 0)\n\t\treturn r;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "type",
            "seqnr",
            "ssh"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"skipped packet (type %u)\"",
            "type"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "debug2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "232-240",
          "snippet": "void\ndebug2(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG2, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug2(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG2, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_packet_read_poll_seqnr",
          "args": [
            "ssh",
            "&type",
            "&seqnr"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_packet_read_poll_seqnr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "1675-1729",
          "snippet": "int\nssh_packet_read_poll_seqnr(struct ssh *ssh, u_char *typep, u_int32_t *seqnr_p)\n{\n\tstruct session_state *state = ssh->state;\n\tu_int reason, seqnr;\n\tint r;\n\tu_char *msg;\n\n\tfor (;;) {\n\t\tmsg = NULL;\n\t\tr = ssh_packet_read_poll2(ssh, typep, seqnr_p);\n\t\tif (r != 0)\n\t\t\treturn r;\n\t\tif (*typep) {\n\t\t\tstate->keep_alive_timeouts = 0;\n\t\t\tDBG(debug(\"received packet type %d\", *typep));\n\t\t}\n\t\tswitch (*typep) {\n\t\tcase SSH2_MSG_IGNORE:\n\t\t\tdebug3(\"Received SSH2_MSG_IGNORE\");\n\t\t\tbreak;\n\t\tcase SSH2_MSG_DEBUG:\n\t\t\tif ((r = sshpkt_get_u8(ssh, NULL)) != 0 ||\n\t\t\t    (r = sshpkt_get_string(ssh, &msg, NULL)) != 0 ||\n\t\t\t    (r = sshpkt_get_string(ssh, NULL, NULL)) != 0) {\n\t\t\t\tfree(msg);\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tdebug(\"Remote: %.900s\", msg);\n\t\t\tfree(msg);\n\t\t\tbreak;\n\t\tcase SSH2_MSG_DISCONNECT:\n\t\t\tif ((r = sshpkt_get_u32(ssh, &reason)) != 0 ||\n\t\t\t    (r = sshpkt_get_string(ssh, &msg, NULL)) != 0)\n\t\t\t\treturn r;\n\t\t\t/* Ignore normal client exit notifications */\n\t\t\tdo_log2(ssh->state->server_side &&\n\t\t\t    reason == SSH2_DISCONNECT_BY_APPLICATION ?\n\t\t\t    SYSLOG_LEVEL_INFO : SYSLOG_LEVEL_ERROR,\n\t\t\t    \"Received disconnect from %s port %d:\"\n\t\t\t    \"%u: %.400s\", ssh_remote_ipaddr(ssh),\n\t\t\t    ssh_remote_port(ssh), reason, msg);\n\t\t\tfree(msg);\n\t\t\treturn SSH_ERR_DISCONNECTED;\n\t\tcase SSH2_MSG_UNIMPLEMENTED:\n\t\t\tif ((r = sshpkt_get_u32(ssh, &seqnr)) != 0)\n\t\t\t\treturn r;\n\t\t\tdebug(\"Received SSH2_MSG_UNIMPLEMENTED for %u\",\n\t\t\t    seqnr);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn 0;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_packet_read_poll_seqnr(struct ssh *ssh, u_char *typep, u_int32_t *seqnr_p)\n{\n\tstruct session_state *state = ssh->state;\n\tu_int reason, seqnr;\n\tint r;\n\tu_char *msg;\n\n\tfor (;;) {\n\t\tmsg = NULL;\n\t\tr = ssh_packet_read_poll2(ssh, typep, seqnr_p);\n\t\tif (r != 0)\n\t\t\treturn r;\n\t\tif (*typep) {\n\t\t\tstate->keep_alive_timeouts = 0;\n\t\t\tDBG(debug(\"received packet type %d\", *typep));\n\t\t}\n\t\tswitch (*typep) {\n\t\tcase SSH2_MSG_IGNORE:\n\t\t\tdebug3(\"Received SSH2_MSG_IGNORE\");\n\t\t\tbreak;\n\t\tcase SSH2_MSG_DEBUG:\n\t\t\tif ((r = sshpkt_get_u8(ssh, NULL)) != 0 ||\n\t\t\t    (r = sshpkt_get_string(ssh, &msg, NULL)) != 0 ||\n\t\t\t    (r = sshpkt_get_string(ssh, NULL, NULL)) != 0) {\n\t\t\t\tfree(msg);\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tdebug(\"Remote: %.900s\", msg);\n\t\t\tfree(msg);\n\t\t\tbreak;\n\t\tcase SSH2_MSG_DISCONNECT:\n\t\t\tif ((r = sshpkt_get_u32(ssh, &reason)) != 0 ||\n\t\t\t    (r = sshpkt_get_string(ssh, &msg, NULL)) != 0)\n\t\t\t\treturn r;\n\t\t\t/* Ignore normal client exit notifications */\n\t\t\tdo_log2(ssh->state->server_side &&\n\t\t\t    reason == SSH2_DISCONNECT_BY_APPLICATION ?\n\t\t\t    SYSLOG_LEVEL_INFO : SYSLOG_LEVEL_ERROR,\n\t\t\t    \"Received disconnect from %s port %d:\"\n\t\t\t    \"%u: %.400s\", ssh_remote_ipaddr(ssh),\n\t\t\t    ssh_remote_port(ssh), reason, msg);\n\t\t\tfree(msg);\n\t\t\treturn SSH_ERR_DISCONNECTED;\n\t\tcase SSH2_MSG_UNIMPLEMENTED:\n\t\t\tif ((r = sshpkt_get_u32(ssh, &seqnr)) != 0)\n\t\t\t\treturn r;\n\t\t\tdebug(\"Received SSH2_MSG_UNIMPLEMENTED for %u\",\n\t\t\t    seqnr);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn 0;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_packet_read_seqnr",
          "args": [
            "ssh",
            "&type",
            "&seqnr"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_packet_read_seqnr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "1281-1369",
          "snippet": "int\nssh_packet_read_seqnr(struct ssh *ssh, u_char *typep, u_int32_t *seqnr_p)\n{\n\tstruct session_state *state = ssh->state;\n\tint len, r, ms_remain;\n\tfd_set *setp;\n\tchar buf[8192];\n\tstruct timeval timeout, start, *timeoutp = NULL;\n\n\tDBG(debug(\"packet_read()\"));\n\n\tsetp = calloc(howmany(state->connection_in + 1,\n\t    NFDBITS), sizeof(fd_mask));\n\tif (setp == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\n\t/*\n\t * Since we are blocking, ensure that all written packets have\n\t * been sent.\n\t */\n\tif ((r = ssh_packet_write_wait(ssh)) != 0)\n\t\tgoto out;\n\n\t/* Stay in the loop until we have received a complete packet. */\n\tfor (;;) {\n\t\t/* Try to read a packet from the buffer. */\n\t\tr = ssh_packet_read_poll_seqnr(ssh, typep, seqnr_p);\n\t\tif (r != 0)\n\t\t\tbreak;\n\t\t/* If we got a packet, return it. */\n\t\tif (*typep != SSH_MSG_NONE)\n\t\t\tbreak;\n\t\t/*\n\t\t * Otherwise, wait for some data to arrive, add it to the\n\t\t * buffer, and try again.\n\t\t */\n\t\tmemset(setp, 0, howmany(state->connection_in + 1,\n\t\t    NFDBITS) * sizeof(fd_mask));\n\t\tFD_SET(state->connection_in, setp);\n\n\t\tif (state->packet_timeout_ms > 0) {\n\t\t\tms_remain = state->packet_timeout_ms;\n\t\t\ttimeoutp = &timeout;\n\t\t}\n\t\t/* Wait for some data to arrive. */\n\t\tfor (;;) {\n\t\t\tif (state->packet_timeout_ms != -1) {\n\t\t\t\tms_to_timeval(&timeout, ms_remain);\n\t\t\t\tmonotime_tv(&start);\n\t\t\t}\n\t\t\tif ((r = select(state->connection_in + 1, setp,\n\t\t\t    NULL, NULL, timeoutp)) >= 0)\n\t\t\t\tbreak;\n\t\t\tif (errno != EAGAIN && errno != EINTR &&\n\t\t\t    errno != EWOULDBLOCK) {\n\t\t\t\tr = SSH_ERR_SYSTEM_ERROR;\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t\tif (state->packet_timeout_ms == -1)\n\t\t\t\tcontinue;\n\t\t\tms_subtract_diff(&start, &ms_remain);\n\t\t\tif (ms_remain <= 0) {\n\t\t\t\tr = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (r == 0) {\n\t\t\tr = SSH_ERR_CONN_TIMEOUT;\n\t\t\tgoto out;\n\t\t}\n\t\t/* Read data from the socket. */\n\t\tlen = read(state->connection_in, buf, sizeof(buf));\n\t\tif (len == 0) {\n\t\t\tr = SSH_ERR_CONN_CLOSED;\n\t\t\tgoto out;\n\t\t}\n\t\tif (len < 0) {\n\t\t\tr = SSH_ERR_SYSTEM_ERROR;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* Append it to the buffer. */\n\t\tif ((r = ssh_packet_process_incoming(ssh, buf, len)) != 0)\n\t\t\tgoto out;\n\t}\n out:\n\tfree(setp);\n\treturn r;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_packet_read_seqnr(struct ssh *ssh, u_char *typep, u_int32_t *seqnr_p)\n{\n\tstruct session_state *state = ssh->state;\n\tint len, r, ms_remain;\n\tfd_set *setp;\n\tchar buf[8192];\n\tstruct timeval timeout, start, *timeoutp = NULL;\n\n\tDBG(debug(\"packet_read()\"));\n\n\tsetp = calloc(howmany(state->connection_in + 1,\n\t    NFDBITS), sizeof(fd_mask));\n\tif (setp == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\n\t/*\n\t * Since we are blocking, ensure that all written packets have\n\t * been sent.\n\t */\n\tif ((r = ssh_packet_write_wait(ssh)) != 0)\n\t\tgoto out;\n\n\t/* Stay in the loop until we have received a complete packet. */\n\tfor (;;) {\n\t\t/* Try to read a packet from the buffer. */\n\t\tr = ssh_packet_read_poll_seqnr(ssh, typep, seqnr_p);\n\t\tif (r != 0)\n\t\t\tbreak;\n\t\t/* If we got a packet, return it. */\n\t\tif (*typep != SSH_MSG_NONE)\n\t\t\tbreak;\n\t\t/*\n\t\t * Otherwise, wait for some data to arrive, add it to the\n\t\t * buffer, and try again.\n\t\t */\n\t\tmemset(setp, 0, howmany(state->connection_in + 1,\n\t\t    NFDBITS) * sizeof(fd_mask));\n\t\tFD_SET(state->connection_in, setp);\n\n\t\tif (state->packet_timeout_ms > 0) {\n\t\t\tms_remain = state->packet_timeout_ms;\n\t\t\ttimeoutp = &timeout;\n\t\t}\n\t\t/* Wait for some data to arrive. */\n\t\tfor (;;) {\n\t\t\tif (state->packet_timeout_ms != -1) {\n\t\t\t\tms_to_timeval(&timeout, ms_remain);\n\t\t\t\tmonotime_tv(&start);\n\t\t\t}\n\t\t\tif ((r = select(state->connection_in + 1, setp,\n\t\t\t    NULL, NULL, timeoutp)) >= 0)\n\t\t\t\tbreak;\n\t\t\tif (errno != EAGAIN && errno != EINTR &&\n\t\t\t    errno != EWOULDBLOCK) {\n\t\t\t\tr = SSH_ERR_SYSTEM_ERROR;\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t\tif (state->packet_timeout_ms == -1)\n\t\t\t\tcontinue;\n\t\t\tms_subtract_diff(&start, &ms_remain);\n\t\t\tif (ms_remain <= 0) {\n\t\t\t\tr = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (r == 0) {\n\t\t\tr = SSH_ERR_CONN_TIMEOUT;\n\t\t\tgoto out;\n\t\t}\n\t\t/* Read data from the socket. */\n\t\tlen = read(state->connection_in, buf, sizeof(buf));\n\t\tif (len == 0) {\n\t\t\tr = SSH_ERR_CONN_CLOSED;\n\t\t\tgoto out;\n\t\t}\n\t\tif (len < 0) {\n\t\t\tr = SSH_ERR_SYSTEM_ERROR;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* Append it to the buffer. */\n\t\tif ((r = ssh_packet_process_incoming(ssh, buf, len)) != 0)\n\t\t\tgoto out;\n\t}\n out:\n\tfree(setp);\n\treturn r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"dispatch.h\"\n#include \"log.h\"\n#include \"ssh2.h\"\n#include <stdarg.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_dispatch_run(struct ssh *ssh, int mode, volatile sig_atomic_t *done)\n{\n\tint r;\n\tu_char type;\n\tu_int32_t seqnr;\n\n\tfor (;;) {\n\t\tif (mode == DISPATCH_BLOCK) {\n\t\t\tr = ssh_packet_read_seqnr(ssh, &type, &seqnr);\n\t\t\tif (r != 0)\n\t\t\t\treturn r;\n\t\t} else {\n\t\t\tr = ssh_packet_read_poll_seqnr(ssh, &type, &seqnr);\n\t\t\tif (r != 0)\n\t\t\t\treturn r;\n\t\t\tif (type == SSH_MSG_NONE)\n\t\t\t\treturn 0;\n\t\t}\n\t\tif (type > 0 && type < DISPATCH_MAX &&\n\t\t    ssh->dispatch[type] != NULL) {\n\t\t\tif (ssh->dispatch_skip_packets) {\n\t\t\t\tdebug2(\"skipped packet (type %u)\", type);\n\t\t\t\tssh->dispatch_skip_packets--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tr = (*ssh->dispatch[type])(type, seqnr, ssh);\n\t\t\tif (r != 0)\n\t\t\t\treturn r;\n\t\t} else {\n\t\t\tr = sshpkt_disconnect(ssh,\n\t\t\t    \"protocol error: rcvd type %d\", type);\n\t\t\tif (r != 0)\n\t\t\t\treturn r;\n\t\t\treturn SSH_ERR_DISCONNECTED;\n\t\t}\n\t\tif (done != NULL && *done)\n\t\t\treturn 0;\n\t}\n}"
  },
  {
    "function_name": "ssh_dispatch_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dispatch.c",
    "lines": "81-85",
    "snippet": "void\nssh_dispatch_set(struct ssh *ssh, int type, dispatch_fn *fn)\n{\n\tssh->dispatch[type] = fn;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"packet.h\"",
      "#include \"dispatch.h\"",
      "#include \"log.h\"",
      "#include \"ssh2.h\"",
      "#include <stdarg.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"dispatch.h\"\n#include \"log.h\"\n#include \"ssh2.h\"\n#include <stdarg.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_dispatch_set(struct ssh *ssh, int type, dispatch_fn *fn)\n{\n\tssh->dispatch[type] = fn;\n}"
  },
  {
    "function_name": "ssh_dispatch_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dispatch.c",
    "lines": "69-79",
    "snippet": "void\nssh_dispatch_range(struct ssh *ssh, u_int from, u_int to, dispatch_fn *fn)\n{\n\tu_int i;\n\n\tfor (i = from; i <= to; i++) {\n\t\tif (i >= DISPATCH_MAX)\n\t\t\tbreak;\n\t\tssh->dispatch[i] = fn;\n\t}\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"packet.h\"",
      "#include \"dispatch.h\"",
      "#include \"log.h\"",
      "#include \"ssh2.h\"",
      "#include <stdarg.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"dispatch.h\"\n#include \"log.h\"\n#include \"ssh2.h\"\n#include <stdarg.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_dispatch_range(struct ssh *ssh, u_int from, u_int to, dispatch_fn *fn)\n{\n\tu_int i;\n\n\tfor (i = from; i <= to; i++) {\n\t\tif (i >= DISPATCH_MAX)\n\t\t\tbreak;\n\t\tssh->dispatch[i] = fn;\n\t}\n}"
  },
  {
    "function_name": "ssh_dispatch_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dispatch.c",
    "lines": "61-67",
    "snippet": "void\nssh_dispatch_init(struct ssh *ssh, dispatch_fn *dflt)\n{\n\tu_int i;\n\tfor (i = 0; i < DISPATCH_MAX; i++)\n\t\tssh->dispatch[i] = dflt;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"packet.h\"",
      "#include \"dispatch.h\"",
      "#include \"log.h\"",
      "#include \"ssh2.h\"",
      "#include <stdarg.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"dispatch.h\"\n#include \"log.h\"\n#include \"ssh2.h\"\n#include <stdarg.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_dispatch_init(struct ssh *ssh, dispatch_fn *dflt)\n{\n\tu_int i;\n\tfor (i = 0; i < DISPATCH_MAX; i++)\n\t\tssh->dispatch[i] = dflt;\n}"
  },
  {
    "function_name": "dispatch_protocol_ignore",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dispatch.c",
    "lines": "54-59",
    "snippet": "int\ndispatch_protocol_ignore(int type, u_int32_t seq, struct ssh *ssh)\n{\n\tlogit(\"dispatch_protocol_ignore: type %d seq %u\", type, seq);\n\treturn 0;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"packet.h\"",
      "#include \"dispatch.h\"",
      "#include \"log.h\"",
      "#include \"ssh2.h\"",
      "#include <stdarg.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logit",
          "args": [
            "\"dispatch_protocol_ignore: type %d seq %u\"",
            "type",
            "seq"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "logit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "198-206",
          "snippet": "void\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"dispatch.h\"\n#include \"log.h\"\n#include \"ssh2.h\"\n#include <stdarg.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\ndispatch_protocol_ignore(int type, u_int32_t seq, struct ssh *ssh)\n{\n\tlogit(\"dispatch_protocol_ignore: type %d seq %u\", type, seq);\n\treturn 0;\n}"
  },
  {
    "function_name": "dispatch_protocol_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dispatch.c",
    "lines": "40-52",
    "snippet": "int\ndispatch_protocol_error(int type, u_int32_t seq, struct ssh *ssh)\n{\n\tint r;\n\n\tlogit(\"dispatch_protocol_error: type %d seq %u\", type, seq);\n\tif ((r = sshpkt_start(ssh, SSH2_MSG_UNIMPLEMENTED)) != 0 ||\n\t    (r = sshpkt_put_u32(ssh, seq)) != 0 ||\n\t    (r = sshpkt_send(ssh)) != 0 ||\n\t    (r = ssh_packet_write_wait(ssh)) != 0)\n\t\tsshpkt_fatal(ssh, __func__, r);\n\treturn 0;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"packet.h\"",
      "#include \"dispatch.h\"",
      "#include \"log.h\"",
      "#include \"ssh2.h\"",
      "#include <stdarg.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sshpkt_fatal",
          "args": [
            "ssh",
            "__func__",
            "r"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "1808-1851",
          "snippet": "void\nsshpkt_fatal(struct ssh *ssh, const char *tag, int r)\n{\n\tchar remote_id[512];\n\n\tsshpkt_fmt_connection_id(ssh, remote_id, sizeof(remote_id));\n\n\tswitch (r) {\n\tcase SSH_ERR_CONN_CLOSED:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Connection closed by %s\", remote_id);\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Connection %s %s timed out\",\n\t\t    ssh->state->server_side ? \"from\" : \"to\", remote_id);\n\tcase SSH_ERR_DISCONNECTED:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Disconnected from %s\", remote_id);\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\tif (errno == ECONNRESET) {\n\t\t\tssh_packet_clear_keys(ssh);\n\t\t\tlogdie(\"Connection reset by %s\", remote_id);\n\t\t}\n\t\t/* FALLTHROUGH */\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\tif (ssh && ssh->kex && ssh->kex->failed_choice) {\n\t\t\tssh_packet_clear_keys(ssh);\n\t\t\tlogdie(\"Unable to negotiate with %s: %s. \"\n\t\t\t    \"Their offer: %s\", remote_id, ssh_err(r),\n\t\t\t    ssh->kex->failed_choice);\n\t\t}\n\t\t/* FALLTHROUGH */\n\tdefault:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"%s%sConnection %s %s: %s\",\n\t\t    tag != NULL ? tag : \"\", tag != NULL ? \": \" : \"\",\n\t\t    ssh->state->server_side ? \"from\" : \"to\",\n\t\t    remote_id, ssh_err(r));\n\t}\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshpkt_fatal(struct ssh *ssh, const char *tag, int r)\n{\n\tchar remote_id[512];\n\n\tsshpkt_fmt_connection_id(ssh, remote_id, sizeof(remote_id));\n\n\tswitch (r) {\n\tcase SSH_ERR_CONN_CLOSED:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Connection closed by %s\", remote_id);\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Connection %s %s timed out\",\n\t\t    ssh->state->server_side ? \"from\" : \"to\", remote_id);\n\tcase SSH_ERR_DISCONNECTED:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"Disconnected from %s\", remote_id);\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\tif (errno == ECONNRESET) {\n\t\t\tssh_packet_clear_keys(ssh);\n\t\t\tlogdie(\"Connection reset by %s\", remote_id);\n\t\t}\n\t\t/* FALLTHROUGH */\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\tif (ssh && ssh->kex && ssh->kex->failed_choice) {\n\t\t\tssh_packet_clear_keys(ssh);\n\t\t\tlogdie(\"Unable to negotiate with %s: %s. \"\n\t\t\t    \"Their offer: %s\", remote_id, ssh_err(r),\n\t\t\t    ssh->kex->failed_choice);\n\t\t}\n\t\t/* FALLTHROUGH */\n\tdefault:\n\t\tssh_packet_clear_keys(ssh);\n\t\tlogdie(\"%s%sConnection %s %s: %s\",\n\t\t    tag != NULL ? tag : \"\", tag != NULL ? \": \" : \"\",\n\t\t    ssh->state->server_side ? \"from\" : \"to\",\n\t\t    remote_id, ssh_err(r));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_packet_write_wait",
          "args": [
            "ssh"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_packet_write_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "1930-1985",
          "snippet": "int\nssh_packet_write_wait(struct ssh *ssh)\n{\n\tfd_set *setp;\n\tint ret, r, ms_remain = 0;\n\tstruct timeval start, timeout, *timeoutp = NULL;\n\tstruct session_state *state = ssh->state;\n\n\tsetp = calloc(howmany(state->connection_out + 1,\n\t    NFDBITS), sizeof(fd_mask));\n\tif (setp == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = ssh_packet_write_poll(ssh)) != 0) {\n\t\tfree(setp);\n\t\treturn r;\n\t}\n\twhile (ssh_packet_have_data_to_write(ssh)) {\n\t\tmemset(setp, 0, howmany(state->connection_out + 1,\n\t\t    NFDBITS) * sizeof(fd_mask));\n\t\tFD_SET(state->connection_out, setp);\n\n\t\tif (state->packet_timeout_ms > 0) {\n\t\t\tms_remain = state->packet_timeout_ms;\n\t\t\ttimeoutp = &timeout;\n\t\t}\n\t\tfor (;;) {\n\t\t\tif (state->packet_timeout_ms != -1) {\n\t\t\t\tms_to_timeval(&timeout, ms_remain);\n\t\t\t\tmonotime_tv(&start);\n\t\t\t}\n\t\t\tif ((ret = select(state->connection_out + 1,\n\t\t\t    NULL, setp, NULL, timeoutp)) >= 0)\n\t\t\t\tbreak;\n\t\t\tif (errno != EAGAIN && errno != EINTR &&\n\t\t\t    errno != EWOULDBLOCK)\n\t\t\t\tbreak;\n\t\t\tif (state->packet_timeout_ms == -1)\n\t\t\t\tcontinue;\n\t\t\tms_subtract_diff(&start, &ms_remain);\n\t\t\tif (ms_remain <= 0) {\n\t\t\t\tret = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (ret == 0) {\n\t\t\tfree(setp);\n\t\t\treturn SSH_ERR_CONN_TIMEOUT;\n\t\t}\n\t\tif ((r = ssh_packet_write_poll(ssh)) != 0) {\n\t\t\tfree(setp);\n\t\t\treturn r;\n\t\t}\n\t}\n\tfree(setp);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_packet_write_wait(struct ssh *ssh)\n{\n\tfd_set *setp;\n\tint ret, r, ms_remain = 0;\n\tstruct timeval start, timeout, *timeoutp = NULL;\n\tstruct session_state *state = ssh->state;\n\n\tsetp = calloc(howmany(state->connection_out + 1,\n\t    NFDBITS), sizeof(fd_mask));\n\tif (setp == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = ssh_packet_write_poll(ssh)) != 0) {\n\t\tfree(setp);\n\t\treturn r;\n\t}\n\twhile (ssh_packet_have_data_to_write(ssh)) {\n\t\tmemset(setp, 0, howmany(state->connection_out + 1,\n\t\t    NFDBITS) * sizeof(fd_mask));\n\t\tFD_SET(state->connection_out, setp);\n\n\t\tif (state->packet_timeout_ms > 0) {\n\t\t\tms_remain = state->packet_timeout_ms;\n\t\t\ttimeoutp = &timeout;\n\t\t}\n\t\tfor (;;) {\n\t\t\tif (state->packet_timeout_ms != -1) {\n\t\t\t\tms_to_timeval(&timeout, ms_remain);\n\t\t\t\tmonotime_tv(&start);\n\t\t\t}\n\t\t\tif ((ret = select(state->connection_out + 1,\n\t\t\t    NULL, setp, NULL, timeoutp)) >= 0)\n\t\t\t\tbreak;\n\t\t\tif (errno != EAGAIN && errno != EINTR &&\n\t\t\t    errno != EWOULDBLOCK)\n\t\t\t\tbreak;\n\t\t\tif (state->packet_timeout_ms == -1)\n\t\t\t\tcontinue;\n\t\t\tms_subtract_diff(&start, &ms_remain);\n\t\t\tif (ms_remain <= 0) {\n\t\t\t\tret = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (ret == 0) {\n\t\t\tfree(setp);\n\t\t\treturn SSH_ERR_CONN_TIMEOUT;\n\t\t}\n\t\tif ((r = ssh_packet_write_poll(ssh)) != 0) {\n\t\t\tfree(setp);\n\t\t\treturn r;\n\t\t}\n\t}\n\tfree(setp);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshpkt_send",
          "args": [
            "ssh"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2648-2654",
          "snippet": "int\nsshpkt_send(struct ssh *ssh)\n{\n\tif (ssh->state && ssh->state->mux)\n\t\treturn ssh_packet_send_mux(ssh);\n\treturn ssh_packet_send2(ssh);\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_send(struct ssh *ssh)\n{\n\tif (ssh->state && ssh->state->mux)\n\t\treturn ssh_packet_send_mux(ssh);\n\treturn ssh_packet_send2(ssh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshpkt_put_u32",
          "args": [
            "ssh",
            "seq"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_put_u32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2441-2445",
          "snippet": "int\nsshpkt_put_u32(struct ssh *ssh, u_int32_t val)\n{\n\treturn sshbuf_put_u32(ssh->state->outgoing_packet, val);\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_put_u32(struct ssh *ssh, u_int32_t val)\n{\n\treturn sshbuf_put_u32(ssh->state->outgoing_packet, val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshpkt_start",
          "args": [
            "ssh",
            "SSH2_MSG_UNIMPLEMENTED"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2573-2583",
          "snippet": "int\nsshpkt_start(struct ssh *ssh, u_char type)\n{\n\tu_char buf[6]; /* u32 packet length, u8 pad len, u8 type */\n\n\tDBG(debug(\"packet_start[%d]\", type));\n\tmemset(buf, 0, sizeof(buf));\n\tbuf[sizeof(buf) - 1] = type;\n\tsshbuf_reset(ssh->state->outgoing_packet);\n\treturn sshbuf_put(ssh->state->outgoing_packet, buf, sizeof(buf));\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_start(struct ssh *ssh, u_char type)\n{\n\tu_char buf[6]; /* u32 packet length, u8 pad len, u8 type */\n\n\tDBG(debug(\"packet_start[%d]\", type));\n\tmemset(buf, 0, sizeof(buf));\n\tbuf[sizeof(buf) - 1] = type;\n\tsshbuf_reset(ssh->state->outgoing_packet);\n\treturn sshbuf_put(ssh->state->outgoing_packet, buf, sizeof(buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "logit",
          "args": [
            "\"dispatch_protocol_error: type %d seq %u\"",
            "type",
            "seq"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "logit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "198-206",
          "snippet": "void\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"dispatch.h\"\n#include \"log.h\"\n#include \"ssh2.h\"\n#include <stdarg.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\ndispatch_protocol_error(int type, u_int32_t seq, struct ssh *ssh)\n{\n\tint r;\n\n\tlogit(\"dispatch_protocol_error: type %d seq %u\", type, seq);\n\tif ((r = sshpkt_start(ssh, SSH2_MSG_UNIMPLEMENTED)) != 0 ||\n\t    (r = sshpkt_put_u32(ssh, seq)) != 0 ||\n\t    (r = sshpkt_send(ssh)) != 0 ||\n\t    (r = ssh_packet_write_wait(ssh)) != 0)\n\t\tsshpkt_fatal(ssh, __func__, r);\n\treturn 0;\n}"
  }
]