[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
    "lines": "163-195",
    "snippet": "int\nmain(int argc, char **argv)\n{\n\t/* try test vectors from RFC 2104 */\n\n\tu_char key1[16] = {\n\t    0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb,\n\t    0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb };\n\tu_char *data1 = \"Hi There\";\n\tu_char dig1[16] = {\n\t    0x92, 0x94, 0x72, 0x7a, 0x36, 0x38, 0xbb, 0x1c,\n\t    0x13, 0xf4, 0x8e, 0xf8, 0x15, 0x8b, 0xfc, 0x9d };\n\n\tu_char *key2 = \"Jefe\";\n\tu_char *data2 = \"what do ya want for nothing?\";\n\tu_char dig2[16] = {\n\t    0x75, 0x0c, 0x78, 0x3e, 0x6a, 0xb0, 0xb5, 0x03,\n\t    0xea, 0xa8, 0x6e, 0x31, 0x0a, 0x5d, 0xb7, 0x38 };\n\n\tu_char key3[16];\n\tu_char data3[50];\n\tu_char dig3[16] = {\n\t    0x56, 0xbe, 0x34, 0x52, 0x1d, 0x14, 0x4c, 0x88,\n\t    0xdb, 0xb8, 0xc7, 0x33, 0xf0, 0xe8, 0xb3, 0xf6 };\n\tmemset(key3, 0xaa, sizeof(key3));\n\tmemset(data3, 0xdd, sizeof(data3));\n\n\thmac_test(key1, sizeof(key1), data1, strlen(data1), dig1, sizeof(dig1));\n\thmac_test(key2, strlen(key2), data2, strlen(data2), dig2, sizeof(dig2));\n\thmac_test(key3, sizeof(key3), data3, sizeof(data3), dig3, sizeof(dig3));\n\n\treturn 0;\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hmac_test",
          "args": [
            "key3",
            "sizeof(key3)",
            "data3",
            "sizeof(data3)",
            "dig3",
            "sizeof(dig3)"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "hmac_test",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
          "lines": "140-161",
          "snippet": "static void\nhmac_test(void *key, size_t klen, void *m, size_t mlen, u_char *e, size_t elen)\n{\n\tstruct ssh_hmac_ctx\t*ctx;\n\tsize_t\t\t\t i;\n\tu_char\t\t\t digest[16];\n\n\tif ((ctx = ssh_hmac_start(SSH_DIGEST_MD5)) == NULL)\n\t\tprintf(\"ssh_hmac_start failed\");\n\tif (ssh_hmac_init(ctx, key, klen) < 0 ||\n\t    ssh_hmac_update(ctx, m, mlen) < 0 ||\n\t    ssh_hmac_final(ctx, digest, sizeof(digest)) < 0)\n\t\tprintf(\"ssh_hmac_xxx failed\");\n\tssh_hmac_free(ctx);\n\n\tif (memcmp(e, digest, elen)) {\n\t\tfor (i = 0; i < elen; i++)\n\t\t\tprintf(\"[%zu] %2.2x %2.2x\\n\", i, e[i], digest[i]);\n\t\tprintf(\"mismatch\\n\");\n\t} else\n\t\tprintf(\"ok\\n\");\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nhmac_test(void *key, size_t klen, void *m, size_t mlen, u_char *e, size_t elen)\n{\n\tstruct ssh_hmac_ctx\t*ctx;\n\tsize_t\t\t\t i;\n\tu_char\t\t\t digest[16];\n\n\tif ((ctx = ssh_hmac_start(SSH_DIGEST_MD5)) == NULL)\n\t\tprintf(\"ssh_hmac_start failed\");\n\tif (ssh_hmac_init(ctx, key, klen) < 0 ||\n\t    ssh_hmac_update(ctx, m, mlen) < 0 ||\n\t    ssh_hmac_final(ctx, digest, sizeof(digest)) < 0)\n\t\tprintf(\"ssh_hmac_xxx failed\");\n\tssh_hmac_free(ctx);\n\n\tif (memcmp(e, digest, elen)) {\n\t\tfor (i = 0; i < elen; i++)\n\t\t\tprintf(\"[%zu] %2.2x %2.2x\\n\", i, e[i], digest[i]);\n\t\tprintf(\"mismatch\\n\");\n\t} else\n\t\tprintf(\"ok\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "data2"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key2"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "data1"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "data3",
            "0xdd",
            "sizeof(data3)"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "key3",
            "0xaa",
            "sizeof(key3)"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nmain(int argc, char **argv)\n{\n\t/* try test vectors from RFC 2104 */\n\n\tu_char key1[16] = {\n\t    0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb,\n\t    0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb };\n\tu_char *data1 = \"Hi There\";\n\tu_char dig1[16] = {\n\t    0x92, 0x94, 0x72, 0x7a, 0x36, 0x38, 0xbb, 0x1c,\n\t    0x13, 0xf4, 0x8e, 0xf8, 0x15, 0x8b, 0xfc, 0x9d };\n\n\tu_char *key2 = \"Jefe\";\n\tu_char *data2 = \"what do ya want for nothing?\";\n\tu_char dig2[16] = {\n\t    0x75, 0x0c, 0x78, 0x3e, 0x6a, 0xb0, 0xb5, 0x03,\n\t    0xea, 0xa8, 0x6e, 0x31, 0x0a, 0x5d, 0xb7, 0x38 };\n\n\tu_char key3[16];\n\tu_char data3[50];\n\tu_char dig3[16] = {\n\t    0x56, 0xbe, 0x34, 0x52, 0x1d, 0x14, 0x4c, 0x88,\n\t    0xdb, 0xb8, 0xc7, 0x33, 0xf0, 0xe8, 0xb3, 0xf6 };\n\tmemset(key3, 0xaa, sizeof(key3));\n\tmemset(data3, 0xdd, sizeof(data3));\n\n\thmac_test(key1, sizeof(key1), data1, strlen(data1), dig1, sizeof(dig1));\n\thmac_test(key2, strlen(key2), data2, strlen(data2), dig2, sizeof(dig2));\n\thmac_test(key3, sizeof(key3), data3, sizeof(data3), dig3, sizeof(dig3));\n\n\treturn 0;\n}"
  },
  {
    "function_name": "hmac_test",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
    "lines": "140-161",
    "snippet": "static void\nhmac_test(void *key, size_t klen, void *m, size_t mlen, u_char *e, size_t elen)\n{\n\tstruct ssh_hmac_ctx\t*ctx;\n\tsize_t\t\t\t i;\n\tu_char\t\t\t digest[16];\n\n\tif ((ctx = ssh_hmac_start(SSH_DIGEST_MD5)) == NULL)\n\t\tprintf(\"ssh_hmac_start failed\");\n\tif (ssh_hmac_init(ctx, key, klen) < 0 ||\n\t    ssh_hmac_update(ctx, m, mlen) < 0 ||\n\t    ssh_hmac_final(ctx, digest, sizeof(digest)) < 0)\n\t\tprintf(\"ssh_hmac_xxx failed\");\n\tssh_hmac_free(ctx);\n\n\tif (memcmp(e, digest, elen)) {\n\t\tfor (i = 0; i < elen; i++)\n\t\t\tprintf(\"[%zu] %2.2x %2.2x\\n\", i, e[i], digest[i]);\n\t\tprintf(\"mismatch\\n\");\n\t} else\n\t\tprintf(\"ok\\n\");\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"ok\\n\""
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "mprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/utf8.c",
          "lines": "289-299",
          "snippet": "int\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"utf8.h\"",
            "# include <wchar.h>",
            "# include <vis.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "# include <langinfo.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t vasnmprintf(char **, size_t, int *, const char *, va_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n# include <wchar.h>\n# include <vis.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <locale.h>\n#include <limits.h>\n# include <langinfo.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\t vasnmprintf(char **, size_t, int *, const char *, va_list);\n\nint\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"[%zu] %2.2x %2.2x\\n\"",
            "i",
            "e[i]",
            "digest[i]"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "xasprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "104-118",
          "snippet": "int\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nint\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "e",
            "digest",
            "elen"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_hmac_free",
          "args": [
            "ctx"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_hmac_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
          "lines": "121-135",
          "snippet": "void\nssh_hmac_free(struct ssh_hmac_ctx *ctx)\n{\n\tif (ctx != NULL) {\n\t\tssh_digest_free(ctx->ictx);\n\t\tssh_digest_free(ctx->octx);\n\t\tssh_digest_free(ctx->digest);\n\t\tif (ctx->buf) {\n\t\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t\t\tfree(ctx->buf);\n\t\t}\n\t\texplicit_bzero(ctx, sizeof(*ctx));\n\t\tfree(ctx);\n\t}\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_hmac_free(struct ssh_hmac_ctx *ctx)\n{\n\tif (ctx != NULL) {\n\t\tssh_digest_free(ctx->ictx);\n\t\tssh_digest_free(ctx->octx);\n\t\tssh_digest_free(ctx->digest);\n\t\tif (ctx->buf) {\n\t\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t\t\tfree(ctx->buf);\n\t\t}\n\t\texplicit_bzero(ctx, sizeof(*ctx));\n\t\tfree(ctx);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_hmac_final",
          "args": [
            "ctx",
            "digest",
            "sizeof(digest)"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_hmac_final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
          "lines": "104-119",
          "snippet": "int\nssh_hmac_final(struct ssh_hmac_ctx *ctx, u_char *d, size_t dlen)\n{\n\tsize_t len;\n\n\tlen = ssh_digest_bytes(ctx->alg);\n\tif (dlen < len ||\n\t    ssh_digest_final(ctx->digest, ctx->buf, len))\n\t\treturn -1;\n\t/* switch to octx */\n\tif (ssh_digest_copy_state(ctx->octx, ctx->digest) < 0 ||\n\t    ssh_digest_update(ctx->digest, ctx->buf, len) < 0 ||\n\t    ssh_digest_final(ctx->digest, d, dlen) < 0)\n\t\treturn -1;\n\treturn 0;\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_hmac_final(struct ssh_hmac_ctx *ctx, u_char *d, size_t dlen)\n{\n\tsize_t len;\n\n\tlen = ssh_digest_bytes(ctx->alg);\n\tif (dlen < len ||\n\t    ssh_digest_final(ctx->digest, ctx->buf, len))\n\t\treturn -1;\n\t/* switch to octx */\n\tif (ssh_digest_copy_state(ctx->octx, ctx->digest) < 0 ||\n\t    ssh_digest_update(ctx->digest, ctx->buf, len) < 0 ||\n\t    ssh_digest_final(ctx->digest, d, dlen) < 0)\n\t\treturn -1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_hmac_update",
          "args": [
            "ctx",
            "m",
            "mlen"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_hmac_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
          "lines": "92-96",
          "snippet": "int\nssh_hmac_update(struct ssh_hmac_ctx *ctx, const void *m, size_t mlen)\n{\n\treturn ssh_digest_update(ctx->digest, m, mlen);\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_hmac_update(struct ssh_hmac_ctx *ctx, const void *m, size_t mlen)\n{\n\treturn ssh_digest_update(ctx->digest, m, mlen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_hmac_init",
          "args": [
            "ctx",
            "key",
            "klen"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_hmac_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
          "lines": "63-90",
          "snippet": "int\nssh_hmac_init(struct ssh_hmac_ctx *ctx, const void *key, size_t klen)\n{\n\tsize_t i;\n\n\t/* reset ictx and octx if no is key given */\n\tif (key != NULL) {\n\t\t/* truncate long keys */\n\t\tif (klen <= ctx->buf_len)\n\t\t\tmemcpy(ctx->buf, key, klen);\n\t\telse if (ssh_digest_memory(ctx->alg, key, klen, ctx->buf,\n\t\t    ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\tfor (i = 0; i < ctx->buf_len; i++)\n\t\t\tctx->buf[i] ^= 0x36;\n\t\tif (ssh_digest_update(ctx->ictx, ctx->buf, ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\tfor (i = 0; i < ctx->buf_len; i++)\n\t\t\tctx->buf[i] ^= 0x36 ^ 0x5c;\n\t\tif (ssh_digest_update(ctx->octx, ctx->buf, ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t}\n\t/* start with ictx */\n\tif (ssh_digest_copy_state(ctx->ictx, ctx->digest) < 0)\n\t\treturn -1;\n\treturn 0;\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_hmac_init(struct ssh_hmac_ctx *ctx, const void *key, size_t klen)\n{\n\tsize_t i;\n\n\t/* reset ictx and octx if no is key given */\n\tif (key != NULL) {\n\t\t/* truncate long keys */\n\t\tif (klen <= ctx->buf_len)\n\t\t\tmemcpy(ctx->buf, key, klen);\n\t\telse if (ssh_digest_memory(ctx->alg, key, klen, ctx->buf,\n\t\t    ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\tfor (i = 0; i < ctx->buf_len; i++)\n\t\t\tctx->buf[i] ^= 0x36;\n\t\tif (ssh_digest_update(ctx->ictx, ctx->buf, ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\tfor (i = 0; i < ctx->buf_len; i++)\n\t\t\tctx->buf[i] ^= 0x36 ^ 0x5c;\n\t\tif (ssh_digest_update(ctx->octx, ctx->buf, ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t}\n\t/* start with ictx */\n\tif (ssh_digest_copy_state(ctx->ictx, ctx->digest) < 0)\n\t\treturn -1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_hmac_start",
          "args": [
            "SSH_DIGEST_MD5"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_hmac_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
          "lines": "42-61",
          "snippet": "struct ssh_hmac_ctx *\nssh_hmac_start(int alg)\n{\n\tstruct ssh_hmac_ctx\t*ret;\n\n\tif ((ret = calloc(1, sizeof(*ret))) == NULL)\n\t\treturn NULL;\n\tret->alg = alg;\n\tif ((ret->ictx = ssh_digest_start(alg)) == NULL ||\n\t    (ret->octx = ssh_digest_start(alg)) == NULL ||\n\t    (ret->digest = ssh_digest_start(alg)) == NULL)\n\t\tgoto fail;\n\tret->buf_len = ssh_digest_blocksize(ret->ictx);\n\tif ((ret->buf = calloc(1, ret->buf_len)) == NULL)\n\t\tgoto fail;\n\treturn ret;\nfail:\n\tssh_hmac_free(ret);\n\treturn NULL;\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct ssh_hmac_ctx *\nssh_hmac_start(int alg)\n{\n\tstruct ssh_hmac_ctx\t*ret;\n\n\tif ((ret = calloc(1, sizeof(*ret))) == NULL)\n\t\treturn NULL;\n\tret->alg = alg;\n\tif ((ret->ictx = ssh_digest_start(alg)) == NULL ||\n\t    (ret->octx = ssh_digest_start(alg)) == NULL ||\n\t    (ret->digest = ssh_digest_start(alg)) == NULL)\n\t\tgoto fail;\n\tret->buf_len = ssh_digest_blocksize(ret->ictx);\n\tif ((ret->buf = calloc(1, ret->buf_len)) == NULL)\n\t\tgoto fail;\n\treturn ret;\nfail:\n\tssh_hmac_free(ret);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nhmac_test(void *key, size_t klen, void *m, size_t mlen, u_char *e, size_t elen)\n{\n\tstruct ssh_hmac_ctx\t*ctx;\n\tsize_t\t\t\t i;\n\tu_char\t\t\t digest[16];\n\n\tif ((ctx = ssh_hmac_start(SSH_DIGEST_MD5)) == NULL)\n\t\tprintf(\"ssh_hmac_start failed\");\n\tif (ssh_hmac_init(ctx, key, klen) < 0 ||\n\t    ssh_hmac_update(ctx, m, mlen) < 0 ||\n\t    ssh_hmac_final(ctx, digest, sizeof(digest)) < 0)\n\t\tprintf(\"ssh_hmac_xxx failed\");\n\tssh_hmac_free(ctx);\n\n\tif (memcmp(e, digest, elen)) {\n\t\tfor (i = 0; i < elen; i++)\n\t\t\tprintf(\"[%zu] %2.2x %2.2x\\n\", i, e[i], digest[i]);\n\t\tprintf(\"mismatch\\n\");\n\t} else\n\t\tprintf(\"ok\\n\");\n}"
  },
  {
    "function_name": "ssh_hmac_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
    "lines": "121-135",
    "snippet": "void\nssh_hmac_free(struct ssh_hmac_ctx *ctx)\n{\n\tif (ctx != NULL) {\n\t\tssh_digest_free(ctx->ictx);\n\t\tssh_digest_free(ctx->octx);\n\t\tssh_digest_free(ctx->digest);\n\t\tif (ctx->buf) {\n\t\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t\t\tfree(ctx->buf);\n\t\t}\n\t\texplicit_bzero(ctx, sizeof(*ctx));\n\t\tfree(ctx);\n\t}\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ctx"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_hmac_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
          "lines": "121-135",
          "snippet": "void\nssh_hmac_free(struct ssh_hmac_ctx *ctx)\n{\n\tif (ctx != NULL) {\n\t\tssh_digest_free(ctx->ictx);\n\t\tssh_digest_free(ctx->octx);\n\t\tssh_digest_free(ctx->digest);\n\t\tif (ctx->buf) {\n\t\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t\t\tfree(ctx->buf);\n\t\t}\n\t\texplicit_bzero(ctx, sizeof(*ctx));\n\t\tfree(ctx);\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "explicit_bzero",
          "args": [
            "ctx",
            "sizeof(*ctx)"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "explicit_bzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/explicit_bzero.c",
          "lines": "36-53",
          "snippet": "void\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"includes.h\"\n\nvoid\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_free",
          "args": [
            "ctx->digest"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "219-233",
          "snippet": "void\nssh_digest_free(struct ssh_digest_ctx *ctx)\n{\n\tconst struct ssh_digest *digest;\n\n\tif (ctx != NULL) {\n\t\tdigest = ssh_digest_by_alg(ctx->alg);\n\t\tif (digest) {\n\t\t\texplicit_bzero(ctx->mdctx, digest->ctx_len);\n\t\t\tfree(ctx->mdctx);\n\t\t\texplicit_bzero(ctx, sizeof(*ctx));\n\t\t\tfree(ctx);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_digest_free(struct ssh_digest_ctx *ctx)\n{\n\tconst struct ssh_digest *digest;\n\n\tif (ctx != NULL) {\n\t\tdigest = ssh_digest_by_alg(ctx->alg);\n\t\tif (digest) {\n\t\t\texplicit_bzero(ctx->mdctx, digest->ctx_len);\n\t\t\tfree(ctx->mdctx);\n\t\t\texplicit_bzero(ctx, sizeof(*ctx));\n\t\t\tfree(ctx);\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_hmac_free(struct ssh_hmac_ctx *ctx)\n{\n\tif (ctx != NULL) {\n\t\tssh_digest_free(ctx->ictx);\n\t\tssh_digest_free(ctx->octx);\n\t\tssh_digest_free(ctx->digest);\n\t\tif (ctx->buf) {\n\t\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t\t\tfree(ctx->buf);\n\t\t}\n\t\texplicit_bzero(ctx, sizeof(*ctx));\n\t\tfree(ctx);\n\t}\n}"
  },
  {
    "function_name": "ssh_hmac_final",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
    "lines": "104-119",
    "snippet": "int\nssh_hmac_final(struct ssh_hmac_ctx *ctx, u_char *d, size_t dlen)\n{\n\tsize_t len;\n\n\tlen = ssh_digest_bytes(ctx->alg);\n\tif (dlen < len ||\n\t    ssh_digest_final(ctx->digest, ctx->buf, len))\n\t\treturn -1;\n\t/* switch to octx */\n\tif (ssh_digest_copy_state(ctx->octx, ctx->digest) < 0 ||\n\t    ssh_digest_update(ctx->digest, ctx->buf, len) < 0 ||\n\t    ssh_digest_final(ctx->digest, d, dlen) < 0)\n\t\treturn -1;\n\treturn 0;\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_digest_final",
          "args": [
            "ctx->digest",
            "d",
            "dlen"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "204-217",
          "snippet": "int\nssh_digest_final(struct ssh_digest_ctx *ctx, u_char *d, size_t dlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen > UINT_MAX)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen < digest->digest_len) /* No truncation allowed */\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tdigest->md_final(d, ctx->mdctx);\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_final(struct ssh_digest_ctx *ctx, u_char *d, size_t dlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen > UINT_MAX)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen < digest->digest_len) /* No truncation allowed */\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tdigest->md_final(d, ctx->mdctx);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_update",
          "args": [
            "ctx->digest",
            "ctx->buf",
            "len"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "187-196",
          "snippet": "int\nssh_digest_update(struct ssh_digest_ctx *ctx, const void *m, size_t mlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tdigest->md_update(ctx->mdctx, m, mlen);\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_update(struct ssh_digest_ctx *ctx, const void *m, size_t mlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tdigest->md_update(ctx->mdctx, m, mlen);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_copy_state",
          "args": [
            "ctx->octx",
            "ctx->digest"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_copy_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "176-185",
          "snippet": "int\nssh_digest_copy_state(struct ssh_digest_ctx *from, struct ssh_digest_ctx *to)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(from->alg);\n\n\tif (digest == NULL || from->alg != to->alg)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tmemcpy(to->mdctx, from->mdctx, digest->ctx_len);\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_copy_state(struct ssh_digest_ctx *from, struct ssh_digest_ctx *to)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(from->alg);\n\n\tif (digest == NULL || from->alg != to->alg)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tmemcpy(to->mdctx, from->mdctx, digest->ctx_len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_bytes",
          "args": [
            "ctx->alg"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "143-149",
          "snippet": "size_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_hmac_final(struct ssh_hmac_ctx *ctx, u_char *d, size_t dlen)\n{\n\tsize_t len;\n\n\tlen = ssh_digest_bytes(ctx->alg);\n\tif (dlen < len ||\n\t    ssh_digest_final(ctx->digest, ctx->buf, len))\n\t\treturn -1;\n\t/* switch to octx */\n\tif (ssh_digest_copy_state(ctx->octx, ctx->digest) < 0 ||\n\t    ssh_digest_update(ctx->digest, ctx->buf, len) < 0 ||\n\t    ssh_digest_final(ctx->digest, d, dlen) < 0)\n\t\treturn -1;\n\treturn 0;\n}"
  },
  {
    "function_name": "ssh_hmac_update_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
    "lines": "98-102",
    "snippet": "int\nssh_hmac_update_buffer(struct ssh_hmac_ctx *ctx, const struct sshbuf *b)\n{\n\treturn ssh_digest_update_buffer(ctx->digest, b);\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_digest_update_buffer",
          "args": [
            "ctx->digest",
            "b"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_update_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "198-202",
          "snippet": "int\nssh_digest_update_buffer(struct ssh_digest_ctx *ctx, const struct sshbuf *b)\n{\n\treturn ssh_digest_update(ctx, sshbuf_ptr(b), sshbuf_len(b));\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_update_buffer(struct ssh_digest_ctx *ctx, const struct sshbuf *b)\n{\n\treturn ssh_digest_update(ctx, sshbuf_ptr(b), sshbuf_len(b));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_hmac_update_buffer(struct ssh_hmac_ctx *ctx, const struct sshbuf *b)\n{\n\treturn ssh_digest_update_buffer(ctx->digest, b);\n}"
  },
  {
    "function_name": "ssh_hmac_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
    "lines": "92-96",
    "snippet": "int\nssh_hmac_update(struct ssh_hmac_ctx *ctx, const void *m, size_t mlen)\n{\n\treturn ssh_digest_update(ctx->digest, m, mlen);\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_digest_update",
          "args": [
            "ctx->digest",
            "m",
            "mlen"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "187-196",
          "snippet": "int\nssh_digest_update(struct ssh_digest_ctx *ctx, const void *m, size_t mlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tdigest->md_update(ctx->mdctx, m, mlen);\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_update(struct ssh_digest_ctx *ctx, const void *m, size_t mlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tdigest->md_update(ctx->mdctx, m, mlen);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_hmac_update(struct ssh_hmac_ctx *ctx, const void *m, size_t mlen)\n{\n\treturn ssh_digest_update(ctx->digest, m, mlen);\n}"
  },
  {
    "function_name": "ssh_hmac_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
    "lines": "63-90",
    "snippet": "int\nssh_hmac_init(struct ssh_hmac_ctx *ctx, const void *key, size_t klen)\n{\n\tsize_t i;\n\n\t/* reset ictx and octx if no is key given */\n\tif (key != NULL) {\n\t\t/* truncate long keys */\n\t\tif (klen <= ctx->buf_len)\n\t\t\tmemcpy(ctx->buf, key, klen);\n\t\telse if (ssh_digest_memory(ctx->alg, key, klen, ctx->buf,\n\t\t    ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\tfor (i = 0; i < ctx->buf_len; i++)\n\t\t\tctx->buf[i] ^= 0x36;\n\t\tif (ssh_digest_update(ctx->ictx, ctx->buf, ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\tfor (i = 0; i < ctx->buf_len; i++)\n\t\t\tctx->buf[i] ^= 0x36 ^ 0x5c;\n\t\tif (ssh_digest_update(ctx->octx, ctx->buf, ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t}\n\t/* start with ictx */\n\tif (ssh_digest_copy_state(ctx->ictx, ctx->digest) < 0)\n\t\treturn -1;\n\treturn 0;\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_digest_copy_state",
          "args": [
            "ctx->ictx",
            "ctx->digest"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_copy_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "176-185",
          "snippet": "int\nssh_digest_copy_state(struct ssh_digest_ctx *from, struct ssh_digest_ctx *to)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(from->alg);\n\n\tif (digest == NULL || from->alg != to->alg)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tmemcpy(to->mdctx, from->mdctx, digest->ctx_len);\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_copy_state(struct ssh_digest_ctx *from, struct ssh_digest_ctx *to)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(from->alg);\n\n\tif (digest == NULL || from->alg != to->alg)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tmemcpy(to->mdctx, from->mdctx, digest->ctx_len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "explicit_bzero",
          "args": [
            "ctx->buf",
            "ctx->buf_len"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "explicit_bzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/explicit_bzero.c",
          "lines": "36-53",
          "snippet": "void\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"includes.h\"\n\nvoid\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_update",
          "args": [
            "ctx->octx",
            "ctx->buf",
            "ctx->buf_len"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "187-196",
          "snippet": "int\nssh_digest_update(struct ssh_digest_ctx *ctx, const void *m, size_t mlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tdigest->md_update(ctx->mdctx, m, mlen);\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_update(struct ssh_digest_ctx *ctx, const void *m, size_t mlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tdigest->md_update(ctx->mdctx, m, mlen);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_memory",
          "args": [
            "ctx->alg",
            "key",
            "klen",
            "ctx->buf",
            "ctx->buf_len"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_memory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "235-247",
          "snippet": "int\nssh_digest_memory(int alg, const void *m, size_t mlen, u_char *d, size_t dlen)\n{\n\tstruct ssh_digest_ctx *ctx = ssh_digest_start(alg);\n\n\tif (ctx == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (ssh_digest_update(ctx, m, mlen) != 0 ||\n\t    ssh_digest_final(ctx, d, dlen) != 0)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tssh_digest_free(ctx);\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_memory(int alg, const void *m, size_t mlen, u_char *d, size_t dlen)\n{\n\tstruct ssh_digest_ctx *ctx = ssh_digest_start(alg);\n\n\tif (ctx == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (ssh_digest_update(ctx, m, mlen) != 0 ||\n\t    ssh_digest_final(ctx, d, dlen) != 0)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tssh_digest_free(ctx);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ctx->buf",
            "key",
            "klen"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_hmac_init(struct ssh_hmac_ctx *ctx, const void *key, size_t klen)\n{\n\tsize_t i;\n\n\t/* reset ictx and octx if no is key given */\n\tif (key != NULL) {\n\t\t/* truncate long keys */\n\t\tif (klen <= ctx->buf_len)\n\t\t\tmemcpy(ctx->buf, key, klen);\n\t\telse if (ssh_digest_memory(ctx->alg, key, klen, ctx->buf,\n\t\t    ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\tfor (i = 0; i < ctx->buf_len; i++)\n\t\t\tctx->buf[i] ^= 0x36;\n\t\tif (ssh_digest_update(ctx->ictx, ctx->buf, ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\tfor (i = 0; i < ctx->buf_len; i++)\n\t\t\tctx->buf[i] ^= 0x36 ^ 0x5c;\n\t\tif (ssh_digest_update(ctx->octx, ctx->buf, ctx->buf_len) < 0)\n\t\t\treturn -1;\n\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t}\n\t/* start with ictx */\n\tif (ssh_digest_copy_state(ctx->ictx, ctx->digest) < 0)\n\t\treturn -1;\n\treturn 0;\n}"
  },
  {
    "function_name": "ssh_hmac_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
    "lines": "42-61",
    "snippet": "struct ssh_hmac_ctx *\nssh_hmac_start(int alg)\n{\n\tstruct ssh_hmac_ctx\t*ret;\n\n\tif ((ret = calloc(1, sizeof(*ret))) == NULL)\n\t\treturn NULL;\n\tret->alg = alg;\n\tif ((ret->ictx = ssh_digest_start(alg)) == NULL ||\n\t    (ret->octx = ssh_digest_start(alg)) == NULL ||\n\t    (ret->digest = ssh_digest_start(alg)) == NULL)\n\t\tgoto fail;\n\tret->buf_len = ssh_digest_blocksize(ret->ictx);\n\tif ((ret->buf = calloc(1, ret->buf_len)) == NULL)\n\t\tgoto fail;\n\treturn ret;\nfail:\n\tssh_hmac_free(ret);\n\treturn NULL;\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_hmac_free",
          "args": [
            "ret"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_hmac_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
          "lines": "121-135",
          "snippet": "void\nssh_hmac_free(struct ssh_hmac_ctx *ctx)\n{\n\tif (ctx != NULL) {\n\t\tssh_digest_free(ctx->ictx);\n\t\tssh_digest_free(ctx->octx);\n\t\tssh_digest_free(ctx->digest);\n\t\tif (ctx->buf) {\n\t\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t\t\tfree(ctx->buf);\n\t\t}\n\t\texplicit_bzero(ctx, sizeof(*ctx));\n\t\tfree(ctx);\n\t}\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_hmac_free(struct ssh_hmac_ctx *ctx)\n{\n\tif (ctx != NULL) {\n\t\tssh_digest_free(ctx->ictx);\n\t\tssh_digest_free(ctx->octx);\n\t\tssh_digest_free(ctx->digest);\n\t\tif (ctx->buf) {\n\t\t\texplicit_bzero(ctx->buf, ctx->buf_len);\n\t\t\tfree(ctx->buf);\n\t\t}\n\t\texplicit_bzero(ctx, sizeof(*ctx));\n\t\tfree(ctx);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "1",
            "ret->buf_len"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "xcalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "52-66",
          "snippet": "void *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_blocksize",
          "args": [
            "ret->ictx"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_blocksize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "151-157",
          "snippet": "size_t\nssh_digest_blocksize(struct ssh_digest_ctx *ctx)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\n\treturn digest == NULL ? 0 : digest->block_len;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nssh_digest_blocksize(struct ssh_digest_ctx *ctx)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\n\treturn digest == NULL ? 0 : digest->block_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_start",
          "args": [
            "alg"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "159-174",
          "snippet": "struct ssh_digest_ctx *\nssh_digest_start(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\tstruct ssh_digest_ctx *ret;\n\n\tif (digest == NULL || (ret = calloc(1, sizeof(*ret))) == NULL)\n\t\treturn NULL;\n\tif ((ret->mdctx = calloc(1, digest->ctx_len)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\tret->alg = alg;\n\tdigest->md_init(ret->mdctx);\n\treturn ret;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct ssh_digest_ctx *\nssh_digest_start(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\tstruct ssh_digest_ctx *ret;\n\n\tif (digest == NULL || (ret = calloc(1, sizeof(*ret))) == NULL)\n\t\treturn NULL;\n\tif ((ret->mdctx = calloc(1, digest->ctx_len)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\tret->alg = alg;\n\tdigest->md_init(ret->mdctx);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct ssh_hmac_ctx *\nssh_hmac_start(int alg)\n{\n\tstruct ssh_hmac_ctx\t*ret;\n\n\tif ((ret = calloc(1, sizeof(*ret))) == NULL)\n\t\treturn NULL;\n\tret->alg = alg;\n\tif ((ret->ictx = ssh_digest_start(alg)) == NULL ||\n\t    (ret->octx = ssh_digest_start(alg)) == NULL ||\n\t    (ret->digest = ssh_digest_start(alg)) == NULL)\n\t\tgoto fail;\n\tret->buf_len = ssh_digest_blocksize(ret->ictx);\n\tif ((ret->buf = calloc(1, ret->buf_len)) == NULL)\n\t\tgoto fail;\n\treturn ret;\nfail:\n\tssh_hmac_free(ret);\n\treturn NULL;\n}"
  },
  {
    "function_name": "ssh_hmac_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/hmac.c",
    "lines": "36-40",
    "snippet": "size_t\nssh_hmac_bytes(int alg)\n{\n\treturn ssh_digest_bytes(alg);\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_digest_bytes",
          "args": [
            "alg"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "143-149",
          "snippet": "size_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nssh_hmac_bytes(int alg)\n{\n\treturn ssh_digest_bytes(alg);\n}"
  }
]