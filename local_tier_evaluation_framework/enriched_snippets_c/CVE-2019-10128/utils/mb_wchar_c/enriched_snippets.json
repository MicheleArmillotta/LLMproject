[
  {
    "function_name": "report_untranslatable_char",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "2026-2052",
    "snippet": "void\nreport_untranslatable_char(int src_encoding, int dest_encoding,\n\t\t\t\t\t\t   const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(src_encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_UNTRANSLATABLE_CHARACTER),\n\t\t\t errmsg(\"character with byte sequence %s in encoding \\\"%s\\\" has no equivalent in encoding \\\"%s\\\"\",\n\t\t\t\t\tbuf,\n\t\t\t\t\tpg_enc2name_tbl[src_encoding].name,\n\t\t\t\t\tpg_enc2name_tbl[dest_encoding].name)));\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_UNTRANSLATABLE_CHARACTER),\n\t\t\t errmsg(\"character with byte sequence %s in encoding \\\"%s\\\" has no equivalent in encoding \\\"%s\\\"\",\n\t\t\t\t\tbuf,\n\t\t\t\t\tpg_enc2name_tbl[src_encoding].name,\n\t\t\t\t\tpg_enc2name_tbl[dest_encoding].name))"
          ],
          "line": 2046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"character with byte sequence %s in encoding \\\"%s\\\" has no equivalent in encoding \\\"%s\\\"\"",
            "buf",
            "pg_enc2name_tbl[src_encoding].name",
            "pg_enc2name_tbl[dest_encoding].name"
          ],
          "line": 2048
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_UNTRANSLATABLE_CHARACTER"
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "p",
            "\" \""
          ],
          "line": 2043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "p",
            "\"0x%02x\"",
            "(unsigned char) mbstr[j]"
          ],
          "line": 2041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Min",
          "args": [
            "jlimit",
            "8"
          ],
          "line": 2037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Min",
          "args": [
            "l",
            "len"
          ],
          "line": 2036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_encoding_mblen",
          "args": [
            "src_encoding",
            "mbstr"
          ],
          "line": 2030
        },
        "resolved": true,
        "details": {
          "function_name": "pg_encoding_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1784-1790",
          "snippet": "int\npg_encoding_mblen(int encoding, const char *mbstr)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mblen((const unsigned char *) mbstr) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mblen((const unsigned char *) mbstr));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_mblen(int encoding, const char *mbstr)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mblen((const unsigned char *) mbstr) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mblen((const unsigned char *) mbstr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_untranslatable_char(int src_encoding, int dest_encoding,\n\t\t\t\t\t\t   const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(src_encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_UNTRANSLATABLE_CHARACTER),\n\t\t\t errmsg(\"character with byte sequence %s in encoding \\\"%s\\\" has no equivalent in encoding \\\"%s\\\"\",\n\t\t\t\t\tbuf,\n\t\t\t\t\tpg_enc2name_tbl[src_encoding].name,\n\t\t\t\t\tpg_enc2name_tbl[dest_encoding].name)));\n}"
  },
  {
    "function_name": "report_invalid_encoding",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1994-2018",
    "snippet": "void\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf))"
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid byte sequence for encoding \\\"%s\\\": %s\"",
            "pg_enc2name_tbl[encoding].name",
            "buf"
          ],
          "line": 2015
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_CHARACTER_NOT_IN_REPERTOIRE"
          ],
          "line": 2014
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "p",
            "\" \""
          ],
          "line": 2010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "p",
            "\"0x%02x\"",
            "(unsigned char) mbstr[j]"
          ],
          "line": 2008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Min",
          "args": [
            "jlimit",
            "8"
          ],
          "line": 2004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Min",
          "args": [
            "l",
            "len"
          ],
          "line": 2003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_encoding_mblen",
          "args": [
            "encoding",
            "mbstr"
          ],
          "line": 1997
        },
        "resolved": true,
        "details": {
          "function_name": "pg_encoding_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1784-1790",
          "snippet": "int\npg_encoding_mblen(int encoding, const char *mbstr)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mblen((const unsigned char *) mbstr) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mblen((const unsigned char *) mbstr));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_mblen(int encoding, const char *mbstr)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mblen((const unsigned char *) mbstr) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mblen((const unsigned char *) mbstr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}"
  },
  {
    "function_name": "check_encoding_conversion_args",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1965-1986",
    "snippet": "void\ncheck_encoding_conversion_args(int src_encoding,\n\t\t\t\t\t\t\t   int dest_encoding,\n\t\t\t\t\t\t\t   int len,\n\t\t\t\t\t\t\t   int expected_src_encoding,\n\t\t\t\t\t\t\t   int expected_dest_encoding)\n{\n\tif (!PG_VALID_ENCODING(src_encoding))\n\t\telog(ERROR, \"invalid source encoding ID: %d\", src_encoding);\n\tif (src_encoding != expected_src_encoding && expected_src_encoding >= 0)\n\t\telog(ERROR, \"expected source encoding \\\"%s\\\", but got \\\"%s\\\"\",\n\t\t\t pg_enc2name_tbl[expected_src_encoding].name,\n\t\t\t pg_enc2name_tbl[src_encoding].name);\n\tif (!PG_VALID_ENCODING(dest_encoding))\n\t\telog(ERROR, \"invalid destination encoding ID: %d\", dest_encoding);\n\tif (dest_encoding != expected_dest_encoding && expected_dest_encoding >= 0)\n\t\telog(ERROR, \"expected destination encoding \\\"%s\\\", but got \\\"%s\\\"\",\n\t\t\t pg_enc2name_tbl[expected_dest_encoding].name,\n\t\t\t pg_enc2name_tbl[dest_encoding].name);\n\tif (len < 0)\n\t\telog(ERROR, \"encoding conversion length must not be negative\");\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"encoding conversion length must not be negative\""
          ],
          "line": 1985
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_VALID_ENCODING",
          "args": [
            "dest_encoding"
          ],
          "line": 1978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_VALID_ENCODING",
          "args": [
            "src_encoding"
          ],
          "line": 1972
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\ncheck_encoding_conversion_args(int src_encoding,\n\t\t\t\t\t\t\t   int dest_encoding,\n\t\t\t\t\t\t\t   int len,\n\t\t\t\t\t\t\t   int expected_src_encoding,\n\t\t\t\t\t\t\t   int expected_dest_encoding)\n{\n\tif (!PG_VALID_ENCODING(src_encoding))\n\t\telog(ERROR, \"invalid source encoding ID: %d\", src_encoding);\n\tif (src_encoding != expected_src_encoding && expected_src_encoding >= 0)\n\t\telog(ERROR, \"expected source encoding \\\"%s\\\", but got \\\"%s\\\"\",\n\t\t\t pg_enc2name_tbl[expected_src_encoding].name,\n\t\t\t pg_enc2name_tbl[src_encoding].name);\n\tif (!PG_VALID_ENCODING(dest_encoding))\n\t\telog(ERROR, \"invalid destination encoding ID: %d\", dest_encoding);\n\tif (dest_encoding != expected_dest_encoding && expected_dest_encoding >= 0)\n\t\telog(ERROR, \"expected destination encoding \\\"%s\\\", but got \\\"%s\\\"\",\n\t\t\t pg_enc2name_tbl[expected_dest_encoding].name,\n\t\t\t pg_enc2name_tbl[dest_encoding].name);\n\tif (len < 0)\n\t\telog(ERROR, \"encoding conversion length must not be negative\");\n}"
  },
  {
    "function_name": "pg_verify_mbstr_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1893-1953",
    "snippet": "int\npg_verify_mbstr_len(int encoding, const char *mbstr, int len, bool noError)\n{\n\tmbverifier\tmbverify;\n\tint\t\t\tmb_len;\n\n\tAssert(PG_VALID_ENCODING(encoding));\n\n\t/*\n\t * In single-byte encodings, we need only reject nulls (\\0).\n\t */\n\tif (pg_encoding_max_length(encoding) <= 1)\n\t{\n\t\tconst char *nullpos = memchr(mbstr, 0, len);\n\n\t\tif (nullpos == NULL)\n\t\t\treturn len;\n\t\tif (noError)\n\t\t\treturn -1;\n\t\treport_invalid_encoding(encoding, nullpos, 1);\n\t}\n\n\t/* fetch function pointer just once */\n\tmbverify = pg_wchar_table[encoding].mbverify;\n\n\tmb_len = 0;\n\n\twhile (len > 0)\n\t{\n\t\tint\t\t\tl;\n\n\t\t/* fast path for ASCII-subset characters */\n\t\tif (!IS_HIGHBIT_SET(*mbstr))\n\t\t{\n\t\t\tif (*mbstr != '\\0')\n\t\t\t{\n\t\t\t\tmb_len++;\n\t\t\t\tmbstr++;\n\t\t\t\tlen--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tl = (*mbverify) ((const unsigned char *) mbstr, len);\n\n\t\tif (l < 0)\n\t\t{\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tmbstr += l;\n\t\tlen -= l;\n\t\tmb_len++;\n\t}\n\treturn mb_len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "report_invalid_encoding",
          "args": [
            "encoding",
            "mbstr",
            "len"
          ],
          "line": 1945
        },
        "resolved": true,
        "details": {
          "function_name": "report_invalid_encoding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1994-2018",
          "snippet": "void\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "(const unsigned char *) mbstr",
            "len"
          ],
          "line": 1939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*mbstr"
          ],
          "line": 1925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "mbstr",
            "0",
            "len"
          ],
          "line": 1906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_encoding_max_length",
          "args": [
            "encoding"
          ],
          "line": 1904
        },
        "resolved": true,
        "details": {
          "function_name": "pg_encoding_max_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1819-1825",
          "snippet": "int\npg_encoding_max_length(int encoding)\n{\n\tAssert(PG_VALID_ENCODING(encoding));\n\n\treturn pg_wchar_table[encoding].maxmblen;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_max_length(int encoding)\n{\n\tAssert(PG_VALID_ENCODING(encoding));\n\n\treturn pg_wchar_table[encoding].maxmblen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "PG_VALID_ENCODING(encoding)"
          ],
          "line": 1899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_VALID_ENCODING",
          "args": [
            "encoding"
          ],
          "line": 1899
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_verify_mbstr_len(int encoding, const char *mbstr, int len, bool noError)\n{\n\tmbverifier\tmbverify;\n\tint\t\t\tmb_len;\n\n\tAssert(PG_VALID_ENCODING(encoding));\n\n\t/*\n\t * In single-byte encodings, we need only reject nulls (\\0).\n\t */\n\tif (pg_encoding_max_length(encoding) <= 1)\n\t{\n\t\tconst char *nullpos = memchr(mbstr, 0, len);\n\n\t\tif (nullpos == NULL)\n\t\t\treturn len;\n\t\tif (noError)\n\t\t\treturn -1;\n\t\treport_invalid_encoding(encoding, nullpos, 1);\n\t}\n\n\t/* fetch function pointer just once */\n\tmbverify = pg_wchar_table[encoding].mbverify;\n\n\tmb_len = 0;\n\n\twhile (len > 0)\n\t{\n\t\tint\t\t\tl;\n\n\t\t/* fast path for ASCII-subset characters */\n\t\tif (!IS_HIGHBIT_SET(*mbstr))\n\t\t{\n\t\t\tif (*mbstr != '\\0')\n\t\t\t{\n\t\t\t\tmb_len++;\n\t\t\t\tmbstr++;\n\t\t\t\tlen--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tl = (*mbverify) ((const unsigned char *) mbstr, len);\n\n\t\tif (l < 0)\n\t\t{\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tmbstr += l;\n\t\tlen -= l;\n\t\tmb_len++;\n\t}\n\treturn mb_len;\n}"
  },
  {
    "function_name": "pg_verify_mbstr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1876-1880",
    "snippet": "bool\npg_verify_mbstr(int encoding, const char *mbstr, int len, bool noError)\n{\n\treturn pg_verify_mbstr_len(encoding, mbstr, len, noError) >= 0;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_verify_mbstr_len",
          "args": [
            "encoding",
            "mbstr",
            "len",
            "noError"
          ],
          "line": 1879
        },
        "resolved": true,
        "details": {
          "function_name": "pg_verify_mbstr_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1893-1953",
          "snippet": "int\npg_verify_mbstr_len(int encoding, const char *mbstr, int len, bool noError)\n{\n\tmbverifier\tmbverify;\n\tint\t\t\tmb_len;\n\n\tAssert(PG_VALID_ENCODING(encoding));\n\n\t/*\n\t * In single-byte encodings, we need only reject nulls (\\0).\n\t */\n\tif (pg_encoding_max_length(encoding) <= 1)\n\t{\n\t\tconst char *nullpos = memchr(mbstr, 0, len);\n\n\t\tif (nullpos == NULL)\n\t\t\treturn len;\n\t\tif (noError)\n\t\t\treturn -1;\n\t\treport_invalid_encoding(encoding, nullpos, 1);\n\t}\n\n\t/* fetch function pointer just once */\n\tmbverify = pg_wchar_table[encoding].mbverify;\n\n\tmb_len = 0;\n\n\twhile (len > 0)\n\t{\n\t\tint\t\t\tl;\n\n\t\t/* fast path for ASCII-subset characters */\n\t\tif (!IS_HIGHBIT_SET(*mbstr))\n\t\t{\n\t\t\tif (*mbstr != '\\0')\n\t\t\t{\n\t\t\t\tmb_len++;\n\t\t\t\tmbstr++;\n\t\t\t\tlen--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tl = (*mbverify) ((const unsigned char *) mbstr, len);\n\n\t\tif (l < 0)\n\t\t{\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tmbstr += l;\n\t\tlen -= l;\n\t\tmb_len++;\n\t}\n\treturn mb_len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_verify_mbstr_len(int encoding, const char *mbstr, int len, bool noError)\n{\n\tmbverifier\tmbverify;\n\tint\t\t\tmb_len;\n\n\tAssert(PG_VALID_ENCODING(encoding));\n\n\t/*\n\t * In single-byte encodings, we need only reject nulls (\\0).\n\t */\n\tif (pg_encoding_max_length(encoding) <= 1)\n\t{\n\t\tconst char *nullpos = memchr(mbstr, 0, len);\n\n\t\tif (nullpos == NULL)\n\t\t\treturn len;\n\t\tif (noError)\n\t\t\treturn -1;\n\t\treport_invalid_encoding(encoding, nullpos, 1);\n\t}\n\n\t/* fetch function pointer just once */\n\tmbverify = pg_wchar_table[encoding].mbverify;\n\n\tmb_len = 0;\n\n\twhile (len > 0)\n\t{\n\t\tint\t\t\tl;\n\n\t\t/* fast path for ASCII-subset characters */\n\t\tif (!IS_HIGHBIT_SET(*mbstr))\n\t\t{\n\t\t\tif (*mbstr != '\\0')\n\t\t\t{\n\t\t\t\tmb_len++;\n\t\t\t\tmbstr++;\n\t\t\t\tlen--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tl = (*mbverify) ((const unsigned char *) mbstr, len);\n\n\t\tif (l < 0)\n\t\t{\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tmbstr += l;\n\t\tlen -= l;\n\t\tmb_len++;\n\t}\n\treturn mb_len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nbool\npg_verify_mbstr(int encoding, const char *mbstr, int len, bool noError)\n{\n\treturn pg_verify_mbstr_len(encoding, mbstr, len, noError) >= 0;\n}"
  },
  {
    "function_name": "pg_verifymbstr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1865-1870",
    "snippet": "bool\npg_verifymbstr(const char *mbstr, int len, bool noError)\n{\n\treturn\n\t\tpg_verify_mbstr_len(GetDatabaseEncoding(), mbstr, len, noError) >= 0;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_verify_mbstr_len",
          "args": [
            "GetDatabaseEncoding()",
            "mbstr",
            "len",
            "noError"
          ],
          "line": 1869
        },
        "resolved": true,
        "details": {
          "function_name": "pg_verify_mbstr_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1893-1953",
          "snippet": "int\npg_verify_mbstr_len(int encoding, const char *mbstr, int len, bool noError)\n{\n\tmbverifier\tmbverify;\n\tint\t\t\tmb_len;\n\n\tAssert(PG_VALID_ENCODING(encoding));\n\n\t/*\n\t * In single-byte encodings, we need only reject nulls (\\0).\n\t */\n\tif (pg_encoding_max_length(encoding) <= 1)\n\t{\n\t\tconst char *nullpos = memchr(mbstr, 0, len);\n\n\t\tif (nullpos == NULL)\n\t\t\treturn len;\n\t\tif (noError)\n\t\t\treturn -1;\n\t\treport_invalid_encoding(encoding, nullpos, 1);\n\t}\n\n\t/* fetch function pointer just once */\n\tmbverify = pg_wchar_table[encoding].mbverify;\n\n\tmb_len = 0;\n\n\twhile (len > 0)\n\t{\n\t\tint\t\t\tl;\n\n\t\t/* fast path for ASCII-subset characters */\n\t\tif (!IS_HIGHBIT_SET(*mbstr))\n\t\t{\n\t\t\tif (*mbstr != '\\0')\n\t\t\t{\n\t\t\t\tmb_len++;\n\t\t\t\tmbstr++;\n\t\t\t\tlen--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tl = (*mbverify) ((const unsigned char *) mbstr, len);\n\n\t\tif (l < 0)\n\t\t{\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tmbstr += l;\n\t\tlen -= l;\n\t\tmb_len++;\n\t}\n\treturn mb_len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_verify_mbstr_len(int encoding, const char *mbstr, int len, bool noError)\n{\n\tmbverifier\tmbverify;\n\tint\t\t\tmb_len;\n\n\tAssert(PG_VALID_ENCODING(encoding));\n\n\t/*\n\t * In single-byte encodings, we need only reject nulls (\\0).\n\t */\n\tif (pg_encoding_max_length(encoding) <= 1)\n\t{\n\t\tconst char *nullpos = memchr(mbstr, 0, len);\n\n\t\tif (nullpos == NULL)\n\t\t\treturn len;\n\t\tif (noError)\n\t\t\treturn -1;\n\t\treport_invalid_encoding(encoding, nullpos, 1);\n\t}\n\n\t/* fetch function pointer just once */\n\tmbverify = pg_wchar_table[encoding].mbverify;\n\n\tmb_len = 0;\n\n\twhile (len > 0)\n\t{\n\t\tint\t\t\tl;\n\n\t\t/* fast path for ASCII-subset characters */\n\t\tif (!IS_HIGHBIT_SET(*mbstr))\n\t\t{\n\t\t\tif (*mbstr != '\\0')\n\t\t\t{\n\t\t\t\tmb_len++;\n\t\t\t\tmbstr++;\n\t\t\t\tlen--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tl = (*mbverify) ((const unsigned char *) mbstr, len);\n\n\t\tif (l < 0)\n\t\t{\n\t\t\tif (noError)\n\t\t\t\treturn -1;\n\t\t\treport_invalid_encoding(encoding, mbstr, len);\n\t\t}\n\n\t\tmbstr += l;\n\t\tlen -= l;\n\t\tmb_len++;\n\t}\n\treturn mb_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetDatabaseEncoding",
          "args": [],
          "line": 1869
        },
        "resolved": true,
        "details": {
          "function_name": "GetDatabaseEncodingName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/mbutils.c",
          "lines": "1009-1013",
          "snippet": "const char *\nGetDatabaseEncodingName(void)\n{\n\treturn DatabaseEncoding->name;\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/xact.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const pg_enc2name *DatabaseEncoding = &pg_enc2name_tbl[PG_SQL_ASCII];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"mb/pg_wchar.h\"\n#include \"catalog/namespace.h\"\n#include \"access/xact.h\"\n#include \"postgres.h\"\n\nstatic const pg_enc2name *DatabaseEncoding = &pg_enc2name_tbl[PG_SQL_ASCII];\n\nconst char *\nGetDatabaseEncodingName(void)\n{\n\treturn DatabaseEncoding->name;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nbool\npg_verifymbstr(const char *mbstr, int len, bool noError)\n{\n\treturn\n\t\tpg_verify_mbstr_len(GetDatabaseEncoding(), mbstr, len, noError) >= 0;\n}"
  },
  {
    "function_name": "pg_database_encoding_character_incrementer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1841-1859",
    "snippet": "mbcharacter_incrementer\npg_database_encoding_character_incrementer(void)\n{\n\t/*\n\t * Eventually it might be best to add a field to pg_wchar_table[], but for\n\t * now we just use a switch.\n\t */\n\tswitch (GetDatabaseEncoding())\n\t{\n\t\tcase PG_UTF8:\n\t\t\treturn pg_utf8_increment;\n\n\t\tcase PG_EUC_JP:\n\t\t\treturn pg_eucjp_increment;\n\n\t\tdefault:\n\t\t\treturn pg_generic_charinc;\n\t}\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetDatabaseEncoding",
          "args": [],
          "line": 1848
        },
        "resolved": true,
        "details": {
          "function_name": "GetDatabaseEncodingName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/mbutils.c",
          "lines": "1009-1013",
          "snippet": "const char *\nGetDatabaseEncodingName(void)\n{\n\treturn DatabaseEncoding->name;\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/xact.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const pg_enc2name *DatabaseEncoding = &pg_enc2name_tbl[PG_SQL_ASCII];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"mb/pg_wchar.h\"\n#include \"catalog/namespace.h\"\n#include \"access/xact.h\"\n#include \"postgres.h\"\n\nstatic const pg_enc2name *DatabaseEncoding = &pg_enc2name_tbl[PG_SQL_ASCII];\n\nconst char *\nGetDatabaseEncodingName(void)\n{\n\treturn DatabaseEncoding->name;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nmbcharacter_incrementer\npg_database_encoding_character_incrementer(void)\n{\n\t/*\n\t * Eventually it might be best to add a field to pg_wchar_table[], but for\n\t * now we just use a switch.\n\t */\n\tswitch (GetDatabaseEncoding())\n\t{\n\t\tcase PG_UTF8:\n\t\t\treturn pg_utf8_increment;\n\n\t\tcase PG_EUC_JP:\n\t\t\treturn pg_eucjp_increment;\n\n\t\tdefault:\n\t\t\treturn pg_generic_charinc;\n\t}\n}"
  },
  {
    "function_name": "pg_database_encoding_max_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1832-1836",
    "snippet": "int\npg_database_encoding_max_length(void)\n{\n\treturn pg_wchar_table[GetDatabaseEncoding()].maxmblen;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetDatabaseEncoding",
          "args": [],
          "line": 1835
        },
        "resolved": true,
        "details": {
          "function_name": "GetDatabaseEncodingName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/mbutils.c",
          "lines": "1009-1013",
          "snippet": "const char *\nGetDatabaseEncodingName(void)\n{\n\treturn DatabaseEncoding->name;\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/xact.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const pg_enc2name *DatabaseEncoding = &pg_enc2name_tbl[PG_SQL_ASCII];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"mb/pg_wchar.h\"\n#include \"catalog/namespace.h\"\n#include \"access/xact.h\"\n#include \"postgres.h\"\n\nstatic const pg_enc2name *DatabaseEncoding = &pg_enc2name_tbl[PG_SQL_ASCII];\n\nconst char *\nGetDatabaseEncodingName(void)\n{\n\treturn DatabaseEncoding->name;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_database_encoding_max_length(void)\n{\n\treturn pg_wchar_table[GetDatabaseEncoding()].maxmblen;\n}"
  },
  {
    "function_name": "pg_encoding_max_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1819-1825",
    "snippet": "int\npg_encoding_max_length(int encoding)\n{\n\tAssert(PG_VALID_ENCODING(encoding));\n\n\treturn pg_wchar_table[encoding].maxmblen;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "PG_VALID_ENCODING(encoding)"
          ],
          "line": 1822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_VALID_ENCODING",
          "args": [
            "encoding"
          ],
          "line": 1822
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_max_length(int encoding)\n{\n\tAssert(PG_VALID_ENCODING(encoding));\n\n\treturn pg_wchar_table[encoding].maxmblen;\n}"
  },
  {
    "function_name": "pg_encoding_verifymb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1808-1814",
    "snippet": "int\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_wchar_table[PG_SQL_ASCII].mbverify",
          "args": [
            "(const unsigned char *) mbstr",
            "len"
          ],
          "line": 1813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_wchar_table[encoding].mbverify",
          "args": [
            "(const unsigned char *) mbstr",
            "len"
          ],
          "line": 1812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_VALID_ENCODING",
          "args": [
            "encoding"
          ],
          "line": 1811
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}"
  },
  {
    "function_name": "pg_encoding_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1795-1801",
    "snippet": "int\npg_encoding_dsplen(int encoding, const char *mbstr)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].dsplen((const unsigned char *) mbstr) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].dsplen((const unsigned char *) mbstr));\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_wchar_table[PG_SQL_ASCII].dsplen",
          "args": [
            "(const unsigned char *) mbstr"
          ],
          "line": 1800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_wchar_table[encoding].dsplen",
          "args": [
            "(const unsigned char *) mbstr"
          ],
          "line": 1799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_VALID_ENCODING",
          "args": [
            "encoding"
          ],
          "line": 1798
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_dsplen(int encoding, const char *mbstr)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].dsplen((const unsigned char *) mbstr) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].dsplen((const unsigned char *) mbstr));\n}"
  },
  {
    "function_name": "pg_encoding_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1784-1790",
    "snippet": "int\npg_encoding_mblen(int encoding, const char *mbstr)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mblen((const unsigned char *) mbstr) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mblen((const unsigned char *) mbstr));\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_wchar_table[PG_SQL_ASCII].mblen",
          "args": [
            "(const unsigned char *) mbstr"
          ],
          "line": 1789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_wchar_table[encoding].mblen",
          "args": [
            "(const unsigned char *) mbstr"
          ],
          "line": 1788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_VALID_ENCODING",
          "args": [
            "encoding"
          ],
          "line": 1787
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_mblen(int encoding, const char *mbstr)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mblen((const unsigned char *) mbstr) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mblen((const unsigned char *) mbstr));\n}"
  },
  {
    "function_name": "pg_mic_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1775-1779",
    "snippet": "int\npg_mic_mblen(const unsigned char *mbstr)\n{\n\treturn pg_mule_mblen(mbstr);\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_mule_mblen",
          "args": [
            "mbstr"
          ],
          "line": 1778
        },
        "resolved": true,
        "details": {
          "function_name": "pg_mule_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "865-881",
          "snippet": "int\npg_mule_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_LC1(*s))\n\t\tlen = 2;\n\telse if (IS_LCPRV1(*s))\n\t\tlen = 3;\n\telse if (IS_LC2(*s))\n\t\tlen = 3;\n\telse if (IS_LCPRV2(*s))\n\t\tlen = 4;\n\telse\n\t\tlen = 1;\t\t\t\t/* assume ASCII */\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nint\npg_mule_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_LC1(*s))\n\t\tlen = 2;\n\telse if (IS_LCPRV1(*s))\n\t\tlen = 3;\n\telse if (IS_LC2(*s))\n\t\tlen = 3;\n\telse if (IS_LCPRV2(*s))\n\t\tlen = 4;\n\telse\n\t\tlen = 1;\t\t\t\t/* assume ASCII */\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nint\npg_mic_mblen(const unsigned char *mbstr)\n{\n\treturn pg_mule_mblen(mbstr);\n}"
  },
  {
    "function_name": "pg_eucjp_increment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1638-1719",
    "snippet": "static bool\npg_eucjp_increment(unsigned char *charptr, int length)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\tint\t\t\ti;\n\n\tc1 = *charptr;\n\n\tswitch (c1)\n\t{\n\t\tcase SS2:\t\t\t\t/* JIS X 0201 */\n\t\t\tif (length != 2)\n\t\t\t\treturn false;\n\n\t\t\tc2 = charptr[1];\n\n\t\t\tif (c2 >= 0xdf)\n\t\t\t\tcharptr[0] = charptr[1] = 0xa1;\n\t\t\telse if (c2 < 0xa1)\n\t\t\t\tcharptr[1] = 0xa1;\n\t\t\telse\n\t\t\t\tcharptr[1]++;\n\t\t\tbreak;\n\n\t\tcase SS3:\t\t\t\t/* JIS X 0212 */\n\t\t\tif (length != 3)\n\t\t\t\treturn false;\n\n\t\t\tfor (i = 2; i > 0; i--)\n\t\t\t{\n\t\t\t\tc2 = charptr[i];\n\t\t\t\tif (c2 < 0xa1)\n\t\t\t\t{\n\t\t\t\t\tcharptr[i] = 0xa1;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse if (c2 < 0xfe)\n\t\t\t\t{\n\t\t\t\t\tcharptr[i]++;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* Out of 3-byte code region */\n\t\t\treturn false;\n\n\t\tdefault:\n\t\t\tif (IS_HIGHBIT_SET(c1)) /* JIS X 0208? */\n\t\t\t{\n\t\t\t\tif (length != 2)\n\t\t\t\t\treturn false;\n\n\t\t\t\tfor (i = 1; i >= 0; i--)\n\t\t\t\t{\n\t\t\t\t\tc2 = charptr[i];\n\t\t\t\t\tif (c2 < 0xa1)\n\t\t\t\t\t{\n\t\t\t\t\t\tcharptr[i] = 0xa1;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (c2 < 0xfe)\n\t\t\t\t\t{\n\t\t\t\t\t\tcharptr[i]++;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* Out of 2 byte code region */\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\t\t\t\t\t/* ASCII, single byte */\n\t\t\t\tif (c1 > 0x7e)\n\t\t\t\t\treturn false;\n\t\t\t\t(*charptr)++;\n\t\t\t}\n\t\t\tbreak;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c1"
          ],
          "line": 1686
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic bool\npg_eucjp_increment(unsigned char *charptr, int length)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\tint\t\t\ti;\n\n\tc1 = *charptr;\n\n\tswitch (c1)\n\t{\n\t\tcase SS2:\t\t\t\t/* JIS X 0201 */\n\t\t\tif (length != 2)\n\t\t\t\treturn false;\n\n\t\t\tc2 = charptr[1];\n\n\t\t\tif (c2 >= 0xdf)\n\t\t\t\tcharptr[0] = charptr[1] = 0xa1;\n\t\t\telse if (c2 < 0xa1)\n\t\t\t\tcharptr[1] = 0xa1;\n\t\t\telse\n\t\t\t\tcharptr[1]++;\n\t\t\tbreak;\n\n\t\tcase SS3:\t\t\t\t/* JIS X 0212 */\n\t\t\tif (length != 3)\n\t\t\t\treturn false;\n\n\t\t\tfor (i = 2; i > 0; i--)\n\t\t\t{\n\t\t\t\tc2 = charptr[i];\n\t\t\t\tif (c2 < 0xa1)\n\t\t\t\t{\n\t\t\t\t\tcharptr[i] = 0xa1;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse if (c2 < 0xfe)\n\t\t\t\t{\n\t\t\t\t\tcharptr[i]++;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* Out of 3-byte code region */\n\t\t\treturn false;\n\n\t\tdefault:\n\t\t\tif (IS_HIGHBIT_SET(c1)) /* JIS X 0208? */\n\t\t\t{\n\t\t\t\tif (length != 2)\n\t\t\t\t\treturn false;\n\n\t\t\t\tfor (i = 1; i >= 0; i--)\n\t\t\t\t{\n\t\t\t\t\tc2 = charptr[i];\n\t\t\t\t\tif (c2 < 0xa1)\n\t\t\t\t\t{\n\t\t\t\t\t\tcharptr[i] = 0xa1;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (c2 < 0xfe)\n\t\t\t\t\t{\n\t\t\t\t\t\tcharptr[i]++;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* Out of 2 byte code region */\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\t\t\t\t\t/* ASCII, single byte */\n\t\t\t\tif (c1 > 0x7e)\n\t\t\t\t\treturn false;\n\t\t\t\t(*charptr)++;\n\t\t\t}\n\t\t\tbreak;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "pg_utf8_increment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1560-1616",
    "snippet": "static bool\npg_utf8_increment(unsigned char *charptr, int length)\n{\n\tunsigned char a;\n\tunsigned char limit;\n\n\tswitch (length)\n\t{\n\t\tdefault:\n\t\t\t/* reject lengths 5 and 6 for now */\n\t\t\treturn false;\n\t\tcase 4:\n\t\t\ta = charptr[3];\n\t\t\tif (a < 0xBF)\n\t\t\t{\n\t\t\t\tcharptr[3]++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* FALL THRU */\n\t\tcase 3:\n\t\t\ta = charptr[2];\n\t\t\tif (a < 0xBF)\n\t\t\t{\n\t\t\t\tcharptr[2]++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* FALL THRU */\n\t\tcase 2:\n\t\t\ta = charptr[1];\n\t\t\tswitch (*charptr)\n\t\t\t{\n\t\t\t\tcase 0xED:\n\t\t\t\t\tlimit = 0x9F;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xF4:\n\t\t\t\t\tlimit = 0x8F;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tlimit = 0xBF;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (a < limit)\n\t\t\t{\n\t\t\t\tcharptr[1]++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* FALL THRU */\n\t\tcase 1:\n\t\t\ta = *charptr;\n\t\t\tif (a == 0x7F || a == 0xDF || a == 0xEF || a == 0xF4)\n\t\t\t\treturn false;\n\t\t\tcharptr[0]++;\n\t\t\tbreak;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic bool\npg_utf8_increment(unsigned char *charptr, int length)\n{\n\tunsigned char a;\n\tunsigned char limit;\n\n\tswitch (length)\n\t{\n\t\tdefault:\n\t\t\t/* reject lengths 5 and 6 for now */\n\t\t\treturn false;\n\t\tcase 4:\n\t\t\ta = charptr[3];\n\t\t\tif (a < 0xBF)\n\t\t\t{\n\t\t\t\tcharptr[3]++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* FALL THRU */\n\t\tcase 3:\n\t\t\ta = charptr[2];\n\t\t\tif (a < 0xBF)\n\t\t\t{\n\t\t\t\tcharptr[2]++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* FALL THRU */\n\t\tcase 2:\n\t\t\ta = charptr[1];\n\t\t\tswitch (*charptr)\n\t\t\t{\n\t\t\t\tcase 0xED:\n\t\t\t\t\tlimit = 0x9F;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xF4:\n\t\t\t\t\tlimit = 0x8F;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tlimit = 0xBF;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (a < limit)\n\t\t\t{\n\t\t\t\tcharptr[1]++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* FALL THRU */\n\t\tcase 1:\n\t\t\ta = *charptr;\n\t\t\tif (a == 0x7F || a == 0xDF || a == 0xEF || a == 0xF4)\n\t\t\t\treturn false;\n\t\t\tcharptr[0]++;\n\t\t\tbreak;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "pg_generic_charinc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1526-1543",
    "snippet": "static bool\npg_generic_charinc(unsigned char *charptr, int len)\n{\n\tunsigned char *lastbyte = charptr + len - 1;\n\tmbverifier\tmbverify;\n\n\t/* We can just invoke the character verifier directly. */\n\tmbverify = pg_wchar_table[GetDatabaseEncoding()].mbverify;\n\n\twhile (*lastbyte < (unsigned char) 255)\n\t{\n\t\t(*lastbyte)++;\n\t\tif ((*mbverify) (charptr, len) == len)\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "charptr",
            "len"
          ],
          "line": 1538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDatabaseEncoding",
          "args": [],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "GetDatabaseEncodingName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/mbutils.c",
          "lines": "1009-1013",
          "snippet": "const char *\nGetDatabaseEncodingName(void)\n{\n\treturn DatabaseEncoding->name;\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/xact.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const pg_enc2name *DatabaseEncoding = &pg_enc2name_tbl[PG_SQL_ASCII];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"mb/pg_wchar.h\"\n#include \"catalog/namespace.h\"\n#include \"access/xact.h\"\n#include \"postgres.h\"\n\nstatic const pg_enc2name *DatabaseEncoding = &pg_enc2name_tbl[PG_SQL_ASCII];\n\nconst char *\nGetDatabaseEncodingName(void)\n{\n\treturn DatabaseEncoding->name;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nstatic bool\npg_generic_charinc(unsigned char *charptr, int len)\n{\n\tunsigned char *lastbyte = charptr + len - 1;\n\tmbverifier\tmbverify;\n\n\t/* We can just invoke the character verifier directly. */\n\tmbverify = pg_wchar_table[GetDatabaseEncoding()].mbverify;\n\n\twhile (*lastbyte < (unsigned char) 255)\n\t{\n\t\t(*lastbyte)++;\n\t\tif ((*mbverify) (charptr, len) == len)\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "pg_utf8_islegal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1457-1512",
    "snippet": "bool\npg_utf8_islegal(const unsigned char *source, int length)\n{\n\tunsigned char a;\n\n\tswitch (length)\n\t{\n\t\tdefault:\n\t\t\t/* reject lengths 5 and 6 for now */\n\t\t\treturn false;\n\t\tcase 4:\n\t\t\ta = source[3];\n\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\treturn false;\n\t\t\t/* FALL THRU */\n\t\tcase 3:\n\t\t\ta = source[2];\n\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\treturn false;\n\t\t\t/* FALL THRU */\n\t\tcase 2:\n\t\t\ta = source[1];\n\t\t\tswitch (*source)\n\t\t\t{\n\t\t\t\tcase 0xE0:\n\t\t\t\t\tif (a < 0xA0 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xED:\n\t\t\t\t\tif (a < 0x80 || a > 0x9F)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xF0:\n\t\t\t\t\tif (a < 0x90 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xF4:\n\t\t\t\t\tif (a < 0x80 || a > 0x8F)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* FALL THRU */\n\t\tcase 1:\n\t\t\ta = *source;\n\t\t\tif (a >= 0x80 && a < 0xC2)\n\t\t\t\treturn false;\n\t\t\tif (a > 0xF4)\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t}\n\treturn true;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nbool\npg_utf8_islegal(const unsigned char *source, int length)\n{\n\tunsigned char a;\n\n\tswitch (length)\n\t{\n\t\tdefault:\n\t\t\t/* reject lengths 5 and 6 for now */\n\t\t\treturn false;\n\t\tcase 4:\n\t\t\ta = source[3];\n\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\treturn false;\n\t\t\t/* FALL THRU */\n\t\tcase 3:\n\t\t\ta = source[2];\n\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\treturn false;\n\t\t\t/* FALL THRU */\n\t\tcase 2:\n\t\t\ta = source[1];\n\t\t\tswitch (*source)\n\t\t\t{\n\t\t\t\tcase 0xE0:\n\t\t\t\t\tif (a < 0xA0 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xED:\n\t\t\t\t\tif (a < 0x80 || a > 0x9F)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xF0:\n\t\t\t\t\tif (a < 0x90 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xF4:\n\t\t\t\t\tif (a < 0x80 || a > 0x8F)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* FALL THRU */\n\t\tcase 1:\n\t\t\ta = *source;\n\t\t\tif (a >= 0x80 && a < 0xC2)\n\t\t\t\treturn false;\n\t\t\tif (a > 0xF4)\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t}\n\treturn true;\n}"
  },
  {
    "function_name": "pg_utf8_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1429-1441",
    "snippet": "static int\npg_utf8_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl = pg_utf_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\tif (!pg_utf8_islegal(s, l))\n\t\treturn -1;\n\n\treturn l;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_utf8_islegal",
          "args": [
            "s",
            "l"
          ],
          "line": 1437
        },
        "resolved": true,
        "details": {
          "function_name": "pg_utf8_islegal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1457-1512",
          "snippet": "bool\npg_utf8_islegal(const unsigned char *source, int length)\n{\n\tunsigned char a;\n\n\tswitch (length)\n\t{\n\t\tdefault:\n\t\t\t/* reject lengths 5 and 6 for now */\n\t\t\treturn false;\n\t\tcase 4:\n\t\t\ta = source[3];\n\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\treturn false;\n\t\t\t/* FALL THRU */\n\t\tcase 3:\n\t\t\ta = source[2];\n\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\treturn false;\n\t\t\t/* FALL THRU */\n\t\tcase 2:\n\t\t\ta = source[1];\n\t\t\tswitch (*source)\n\t\t\t{\n\t\t\t\tcase 0xE0:\n\t\t\t\t\tif (a < 0xA0 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xED:\n\t\t\t\t\tif (a < 0x80 || a > 0x9F)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xF0:\n\t\t\t\t\tif (a < 0x90 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xF4:\n\t\t\t\t\tif (a < 0x80 || a > 0x8F)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* FALL THRU */\n\t\tcase 1:\n\t\t\ta = *source;\n\t\t\tif (a >= 0x80 && a < 0xC2)\n\t\t\t\treturn false;\n\t\t\tif (a > 0xF4)\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nbool\npg_utf8_islegal(const unsigned char *source, int length)\n{\n\tunsigned char a;\n\n\tswitch (length)\n\t{\n\t\tdefault:\n\t\t\t/* reject lengths 5 and 6 for now */\n\t\t\treturn false;\n\t\tcase 4:\n\t\t\ta = source[3];\n\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\treturn false;\n\t\t\t/* FALL THRU */\n\t\tcase 3:\n\t\t\ta = source[2];\n\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\treturn false;\n\t\t\t/* FALL THRU */\n\t\tcase 2:\n\t\t\ta = source[1];\n\t\t\tswitch (*source)\n\t\t\t{\n\t\t\t\tcase 0xE0:\n\t\t\t\t\tif (a < 0xA0 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xED:\n\t\t\t\t\tif (a < 0x80 || a > 0x9F)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xF0:\n\t\t\t\t\tif (a < 0x90 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xF4:\n\t\t\t\t\tif (a < 0x80 || a > 0x8F)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (a < 0x80 || a > 0xBF)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* FALL THRU */\n\t\tcase 1:\n\t\t\ta = *source;\n\t\t\tif (a >= 0x80 && a < 0xC2)\n\t\t\t\treturn false;\n\t\t\tif (a > 0xF4)\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t}\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_utf_mblen",
          "args": [
            "s"
          ],
          "line": 1432
        },
        "resolved": true,
        "details": {
          "function_name": "pg_utf_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "540-562",
          "snippet": "int\npg_utf_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif ((*s & 0x80) == 0)\n\t\tlen = 1;\n\telse if ((*s & 0xe0) == 0xc0)\n\t\tlen = 2;\n\telse if ((*s & 0xf0) == 0xe0)\n\t\tlen = 3;\n\telse if ((*s & 0xf8) == 0xf0)\n\t\tlen = 4;\n#ifdef NOT_USED\n\telse if ((*s & 0xfc) == 0xf8)\n\t\tlen = 5;\n\telse if ((*s & 0xfe) == 0xfc)\n\t\tlen = 6;\n#endif\n\telse\n\t\tlen = 1;\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nint\npg_utf_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif ((*s & 0x80) == 0)\n\t\tlen = 1;\n\telse if ((*s & 0xe0) == 0xc0)\n\t\tlen = 2;\n\telse if ((*s & 0xf0) == 0xe0)\n\t\tlen = 3;\n\telse if ((*s & 0xf8) == 0xf0)\n\t\tlen = 4;\n#ifdef NOT_USED\n\telse if ((*s & 0xfc) == 0xf8)\n\t\tlen = 5;\n\telse if ((*s & 0xfe) == 0xfc)\n\t\tlen = 6;\n#endif\n\telse\n\t\tlen = 1;\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_utf8_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl = pg_utf_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\tif (!pg_utf8_islegal(s, l))\n\t\treturn -1;\n\n\treturn l;\n}"
  },
  {
    "function_name": "pg_gb18030_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1398-1427",
    "snippet": "static int\npg_gb18030_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl;\n\n\tif (!IS_HIGHBIT_SET(*s))\n\t\tl = 1;\t\t\t\t\t/* ASCII */\n\telse if (len >= 4 && *(s + 1) >= 0x30 && *(s + 1) <= 0x39)\n\t{\n\t\t/* Should be 4-byte, validate remaining bytes */\n\t\tif (*s >= 0x81 && *s <= 0xfe &&\n\t\t\t*(s + 2) >= 0x81 && *(s + 2) <= 0xfe &&\n\t\t\t*(s + 3) >= 0x30 && *(s + 3) <= 0x39)\n\t\t\tl = 4;\n\t\telse\n\t\t\tl = -1;\n\t}\n\telse if (len >= 2 && *s >= 0x81 && *s <= 0xfe)\n\t{\n\t\t/* Should be 2-byte, validate */\n\t\tif ((*(s + 1) >= 0x40 && *(s + 1) <= 0x7e) ||\n\t\t\t(*(s + 1) >= 0x80 && *(s + 1) <= 0xfe))\n\t\t\tl = 2;\n\t\telse\n\t\t\tl = -1;\n\t}\n\telse\n\t\tl = -1;\n\treturn l;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 1403
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_gb18030_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl;\n\n\tif (!IS_HIGHBIT_SET(*s))\n\t\tl = 1;\t\t\t\t\t/* ASCII */\n\telse if (len >= 4 && *(s + 1) >= 0x30 && *(s + 1) <= 0x39)\n\t{\n\t\t/* Should be 4-byte, validate remaining bytes */\n\t\tif (*s >= 0x81 && *s <= 0xfe &&\n\t\t\t*(s + 2) >= 0x81 && *(s + 2) <= 0xfe &&\n\t\t\t*(s + 3) >= 0x30 && *(s + 3) <= 0x39)\n\t\t\tl = 4;\n\t\telse\n\t\t\tl = -1;\n\t}\n\telse if (len >= 2 && *s >= 0x81 && *s <= 0xfe)\n\t{\n\t\t/* Should be 2-byte, validate */\n\t\tif ((*(s + 1) >= 0x40 && *(s + 1) <= 0x7e) ||\n\t\t\t(*(s + 1) >= 0x80 && *(s + 1) <= 0xfe))\n\t\t\tl = 2;\n\t\telse\n\t\t\tl = -1;\n\t}\n\telse\n\t\tl = -1;\n\treturn l;\n}"
  },
  {
    "function_name": "pg_uhc_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1378-1396",
    "snippet": "static int\npg_uhc_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\n\tl = mbl = pg_uhc_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\twhile (--l > 0)\n\t{\n\t\tif (*++s == '\\0')\n\t\t\treturn -1;\n\t}\n\n\treturn mbl;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_uhc_mblen",
          "args": [
            "s"
          ],
          "line": 1384
        },
        "resolved": true,
        "details": {
          "function_name": "pg_uhc_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1048-1058",
          "snippet": "static int\npg_uhc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* 2byte? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_uhc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* 2byte? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_uhc_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\n\tl = mbl = pg_uhc_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\twhile (--l > 0)\n\t{\n\t\tif (*++s == '\\0')\n\t\t\treturn -1;\n\t}\n\n\treturn mbl;\n}"
  },
  {
    "function_name": "pg_gbk_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1358-1376",
    "snippet": "static int\npg_gbk_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\n\tl = mbl = pg_gbk_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\twhile (--l > 0)\n\t{\n\t\tif (*++s == '\\0')\n\t\t\treturn -1;\n\t}\n\n\treturn mbl;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_gbk_mblen",
          "args": [
            "s"
          ],
          "line": 1364
        },
        "resolved": true,
        "details": {
          "function_name": "pg_gbk_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1021-1031",
          "snippet": "static int\npg_gbk_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_gbk_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_gbk_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\n\tl = mbl = pg_gbk_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\twhile (--l > 0)\n\t{\n\t\tif (*++s == '\\0')\n\t\t\treturn -1;\n\t}\n\n\treturn mbl;\n}"
  },
  {
    "function_name": "pg_big5_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1338-1356",
    "snippet": "static int\npg_big5_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\n\tl = mbl = pg_big5_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\twhile (--l > 0)\n\t{\n\t\tif (*++s == '\\0')\n\t\t\treturn -1;\n\t}\n\n\treturn mbl;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_big5_mblen",
          "args": [
            "s"
          ],
          "line": 1344
        },
        "resolved": true,
        "details": {
          "function_name": "pg_big5_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "994-1004",
          "snippet": "static int\npg_big5_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_big5_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_big5_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\n\tl = mbl = pg_big5_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\twhile (--l > 0)\n\t{\n\t\tif (*++s == '\\0')\n\t\t\treturn -1;\n\t}\n\n\treturn mbl;\n}"
  },
  {
    "function_name": "pg_sjis_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1315-1336",
    "snippet": "static int\npg_sjis_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\tl = mbl = pg_sjis_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\tif (l == 1)\t\t\t\t\t/* pg_sjis_mblen already verified it */\n\t\treturn mbl;\n\n\tc1 = *s++;\n\tc2 = *s;\n\tif (!ISSJISHEAD(c1) || !ISSJISTAIL(c2))\n\t\treturn -1;\n\treturn mbl;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ISSJISTAIL",
          "args": [
            "c2"
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISSJISHEAD",
          "args": [
            "c1"
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_sjis_mblen",
          "args": [
            "s"
          ],
          "line": 1323
        },
        "resolved": true,
        "details": {
          "function_name": "pg_sjis_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "963-975",
          "snippet": "static int\npg_sjis_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s >= 0xa1 && *s <= 0xdf)\n\t\tlen = 1;\t\t\t\t/* 1 byte kana? */\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_sjis_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s >= 0xa1 && *s <= 0xdf)\n\t\tlen = 1;\t\t\t\t/* 1 byte kana? */\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_sjis_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\tl = mbl = pg_sjis_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\tif (l == 1)\t\t\t\t\t/* pg_sjis_mblen already verified it */\n\t\treturn mbl;\n\n\tc1 = *s++;\n\tc2 = *s;\n\tif (!ISSJISHEAD(c1) || !ISSJISTAIL(c2))\n\t\treturn -1;\n\treturn mbl;\n}"
  },
  {
    "function_name": "pg_latin1_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1309-1313",
    "snippet": "static int\npg_latin1_verifier(const unsigned char *s, int len)\n{\n\treturn 1;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_latin1_verifier(const unsigned char *s, int len)\n{\n\treturn 1;\n}"
  },
  {
    "function_name": "pg_mule_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1288-1307",
    "snippet": "static int\npg_mule_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\tunsigned char c;\n\n\tl = mbl = pg_mule_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\twhile (--l > 0)\n\t{\n\t\tc = *++s;\n\t\tif (!IS_HIGHBIT_SET(c))\n\t\t\treturn -1;\n\t}\n\treturn mbl;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c"
          ],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_mule_mblen",
          "args": [
            "s"
          ],
          "line": 1295
        },
        "resolved": true,
        "details": {
          "function_name": "pg_mule_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "865-881",
          "snippet": "int\npg_mule_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_LC1(*s))\n\t\tlen = 2;\n\telse if (IS_LCPRV1(*s))\n\t\tlen = 3;\n\telse if (IS_LC2(*s))\n\t\tlen = 3;\n\telse if (IS_LCPRV2(*s))\n\t\tlen = 4;\n\telse\n\t\tlen = 1;\t\t\t\t/* assume ASCII */\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nint\npg_mule_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_LC1(*s))\n\t\tlen = 2;\n\telse if (IS_LCPRV1(*s))\n\t\tlen = 3;\n\telse if (IS_LC2(*s))\n\t\tlen = 3;\n\telse if (IS_LCPRV2(*s))\n\t\tlen = 4;\n\telse\n\t\tlen = 1;\t\t\t\t/* assume ASCII */\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_mule_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\tunsigned char c;\n\n\tl = mbl = pg_mule_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\twhile (--l > 0)\n\t{\n\t\tc = *++s;\n\t\tif (!IS_HIGHBIT_SET(c))\n\t\t\treturn -1;\n\t}\n\treturn mbl;\n}"
  },
  {
    "function_name": "pg_johab_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1264-1286",
    "snippet": "static int\npg_johab_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\tunsigned char c;\n\n\tl = mbl = pg_johab_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\tif (!IS_HIGHBIT_SET(*s))\n\t\treturn mbl;\n\n\twhile (--l > 0)\n\t{\n\t\tc = *++s;\n\t\tif (!IS_EUC_RANGE_VALID(c))\n\t\t\treturn -1;\n\t}\n\treturn mbl;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_EUC_RANGE_VALID",
          "args": [
            "c"
          ],
          "line": 1282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 1276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_johab_mblen",
          "args": [
            "s"
          ],
          "line": 1271
        },
        "resolved": true,
        "details": {
          "function_name": "pg_johab_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "392-396",
          "snippet": "static int\npg_johab_mblen(const unsigned char *s)\n{\n\treturn pg_euc_mblen(s);\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_johab_mblen(const unsigned char *s)\n{\n\treturn pg_euc_mblen(s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_johab_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl,\n\t\t\t\tmbl;\n\tunsigned char c;\n\n\tl = mbl = pg_johab_mblen(s);\n\n\tif (len < l)\n\t\treturn -1;\n\n\tif (!IS_HIGHBIT_SET(*s))\n\t\treturn mbl;\n\n\twhile (--l > 0)\n\t{\n\t\tc = *++s;\n\t\tif (!IS_EUC_RANGE_VALID(c))\n\t\t\treturn -1;\n\t}\n\treturn mbl;\n}"
  },
  {
    "function_name": "pg_euctw_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1214-1262",
    "snippet": "static int\npg_euctw_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl;\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\tc1 = *s++;\n\n\tswitch (c1)\n\t{\n\t\tcase SS2:\t\t\t\t/* CNS 11643 Plane 1-7 */\n\t\t\tl = 4;\n\t\t\tif (l > len)\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (c2 < 0xa1 || c2 > 0xa7)\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\treturn -1;\n\t\t\tbreak;\n\n\t\tcase SS3:\t\t\t\t/* unused */\n\t\t\treturn -1;\n\n\t\tdefault:\n\t\t\tif (IS_HIGHBIT_SET(c1)) /* CNS 11643 Plane 1 */\n\t\t\t{\n\t\t\t\tl = 2;\n\t\t\t\tif (l > len)\n\t\t\t\t\treturn -1;\n\t\t\t\t/* no further range check on c1? */\n\t\t\t\tc2 = *s++;\n\t\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse\n\t\t\t\t/* must be ASCII */\n\t\t\t{\n\t\t\t\tl = 1;\n\t\t\t}\n\t\t\tbreak;\n\t}\n\treturn l;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_EUC_RANGE_VALID",
          "args": [
            "c2"
          ],
          "line": 1251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c1"
          ],
          "line": 1244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EUC_RANGE_VALID",
          "args": [
            "c2"
          ],
          "line": 1236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EUC_RANGE_VALID",
          "args": [
            "c2"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euctw_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl;\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\tc1 = *s++;\n\n\tswitch (c1)\n\t{\n\t\tcase SS2:\t\t\t\t/* CNS 11643 Plane 1-7 */\n\t\t\tl = 4;\n\t\t\tif (l > len)\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (c2 < 0xa1 || c2 > 0xa7)\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\treturn -1;\n\t\t\tbreak;\n\n\t\tcase SS3:\t\t\t\t/* unused */\n\t\t\treturn -1;\n\n\t\tdefault:\n\t\t\tif (IS_HIGHBIT_SET(c1)) /* CNS 11643 Plane 1 */\n\t\t\t{\n\t\t\t\tl = 2;\n\t\t\t\tif (l > len)\n\t\t\t\t\treturn -1;\n\t\t\t\t/* no further range check on c1? */\n\t\t\t\tc2 = *s++;\n\t\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse\n\t\t\t\t/* must be ASCII */\n\t\t\t{\n\t\t\t\tl = 1;\n\t\t\t}\n\t\t\tbreak;\n\t}\n\treturn l;\n}"
  },
  {
    "function_name": "pg_euckr_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1182-1209",
    "snippet": "static int\npg_euckr_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl;\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\tc1 = *s++;\n\n\tif (IS_HIGHBIT_SET(c1))\n\t{\n\t\tl = 2;\n\t\tif (l > len)\n\t\t\treturn -1;\n\t\tif (!IS_EUC_RANGE_VALID(c1))\n\t\t\treturn -1;\n\t\tc2 = *s++;\n\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\treturn -1;\n\t}\n\telse\n\t\t/* must be ASCII */\n\t{\n\t\tl = 1;\n\t}\n\n\treturn l;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_EUC_RANGE_VALID",
          "args": [
            "c2"
          ],
          "line": 1199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EUC_RANGE_VALID",
          "args": [
            "c1"
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c1"
          ],
          "line": 1191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euckr_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl;\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\tc1 = *s++;\n\n\tif (IS_HIGHBIT_SET(c1))\n\t{\n\t\tl = 2;\n\t\tif (l > len)\n\t\t\treturn -1;\n\t\tif (!IS_EUC_RANGE_VALID(c1))\n\t\t\treturn -1;\n\t\tc2 = *s++;\n\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\treturn -1;\n\t}\n\telse\n\t\t/* must be ASCII */\n\t{\n\t\tl = 1;\n\t}\n\n\treturn l;\n}"
  },
  {
    "function_name": "pg_eucjp_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1127-1180",
    "snippet": "static int\npg_eucjp_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl;\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\tc1 = *s++;\n\n\tswitch (c1)\n\t{\n\t\tcase SS2:\t\t\t\t/* JIS X 0201 */\n\t\t\tl = 2;\n\t\t\tif (l > len)\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (c2 < 0xa1 || c2 > 0xdf)\n\t\t\t\treturn -1;\n\t\t\tbreak;\n\n\t\tcase SS3:\t\t\t\t/* JIS X 0212 */\n\t\t\tl = 3;\n\t\t\tif (l > len)\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\treturn -1;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tif (IS_HIGHBIT_SET(c1)) /* JIS X 0208? */\n\t\t\t{\n\t\t\t\tl = 2;\n\t\t\t\tif (l > len)\n\t\t\t\t\treturn -1;\n\t\t\t\tif (!IS_EUC_RANGE_VALID(c1))\n\t\t\t\t\treturn -1;\n\t\t\t\tc2 = *s++;\n\t\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse\n\t\t\t\t/* must be ASCII */\n\t\t\t{\n\t\t\t\tl = 1;\n\t\t\t}\n\t\t\tbreak;\n\t}\n\n\treturn l;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_EUC_RANGE_VALID",
          "args": [
            "c2"
          ],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EUC_RANGE_VALID",
          "args": [
            "c1"
          ],
          "line": 1165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c1"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EUC_RANGE_VALID",
          "args": [
            "c2"
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_EUC_RANGE_VALID",
          "args": [
            "c2"
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_eucjp_verifier(const unsigned char *s, int len)\n{\n\tint\t\t\tl;\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\tc1 = *s++;\n\n\tswitch (c1)\n\t{\n\t\tcase SS2:\t\t\t\t/* JIS X 0201 */\n\t\t\tl = 2;\n\t\t\tif (l > len)\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (c2 < 0xa1 || c2 > 0xdf)\n\t\t\t\treturn -1;\n\t\t\tbreak;\n\n\t\tcase SS3:\t\t\t\t/* JIS X 0212 */\n\t\t\tl = 3;\n\t\t\tif (l > len)\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\treturn -1;\n\t\t\tc2 = *s++;\n\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\treturn -1;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tif (IS_HIGHBIT_SET(c1)) /* JIS X 0208? */\n\t\t\t{\n\t\t\t\tl = 2;\n\t\t\t\tif (l > len)\n\t\t\t\t\treturn -1;\n\t\t\t\tif (!IS_EUC_RANGE_VALID(c1))\n\t\t\t\t\treturn -1;\n\t\t\t\tc2 = *s++;\n\t\t\t\tif (!IS_EUC_RANGE_VALID(c2))\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse\n\t\t\t\t/* must be ASCII */\n\t\t\t{\n\t\t\t\tl = 1;\n\t\t\t}\n\t\t\tbreak;\n\t}\n\n\treturn l;\n}"
  },
  {
    "function_name": "pg_ascii_verifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1119-1123",
    "snippet": "static int\npg_ascii_verifier(const unsigned char *s, int len)\n{\n\treturn 1;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_verifier(const unsigned char *s, int len)\n{\n\treturn 1;\n}"
  },
  {
    "function_name": "pg_gb18030_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1090-1100",
    "snippet": "static int\npg_gb18030_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\t/* ASCII */\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_ascii_dsplen",
          "args": [
            "s"
          ],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "pg_ascii_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "60-69",
          "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_gb18030_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\t/* ASCII */\n\treturn len;\n}"
  },
  {
    "function_name": "pg_gb18030_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1076-1088",
    "snippet": "static int\npg_gb18030_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (!IS_HIGHBIT_SET(*s))\n\t\tlen = 1;\t\t\t\t/* ASCII */\n\telse if (*(s + 1) >= 0x30 && *(s + 1) <= 0x39)\n\t\tlen = 4;\n\telse\n\t\tlen = 2;\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_gb18030_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (!IS_HIGHBIT_SET(*s))\n\t\tlen = 1;\t\t\t\t/* ASCII */\n\telse if (*(s + 1) >= 0x30 && *(s + 1) <= 0x39)\n\t\tlen = 4;\n\telse\n\t\tlen = 2;\n\treturn len;\n}"
  },
  {
    "function_name": "pg_uhc_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1060-1070",
    "snippet": "static int\npg_uhc_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* 2byte? */\n\telse\n\t\tlen = pg_ascii_dsplen(s);\t/* should be ASCII */\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_ascii_dsplen",
          "args": [
            "s"
          ],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "pg_ascii_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "60-69",
          "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_uhc_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* 2byte? */\n\telse\n\t\tlen = pg_ascii_dsplen(s);\t/* should be ASCII */\n\treturn len;\n}"
  },
  {
    "function_name": "pg_uhc_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1048-1058",
    "snippet": "static int\npg_uhc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* 2byte? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 1053
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_uhc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* 2byte? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}"
  },
  {
    "function_name": "pg_gbk_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1033-1043",
    "snippet": "static int\npg_gbk_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = pg_ascii_dsplen(s);\t/* should be ASCII */\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_ascii_dsplen",
          "args": [
            "s"
          ],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "pg_ascii_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "60-69",
          "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 1038
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_gbk_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = pg_ascii_dsplen(s);\t/* should be ASCII */\n\treturn len;\n}"
  },
  {
    "function_name": "pg_gbk_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1021-1031",
    "snippet": "static int\npg_gbk_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_gbk_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}"
  },
  {
    "function_name": "pg_big5_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "1006-1016",
    "snippet": "static int\npg_big5_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = pg_ascii_dsplen(s);\t/* should be ASCII */\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_ascii_dsplen",
          "args": [
            "s"
          ],
          "line": 1014
        },
        "resolved": true,
        "details": {
          "function_name": "pg_ascii_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "60-69",
          "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_big5_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = pg_ascii_dsplen(s);\t/* should be ASCII */\n\treturn len;\n}"
  },
  {
    "function_name": "pg_big5_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "994-1004",
    "snippet": "static int\npg_big5_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_big5_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}"
  },
  {
    "function_name": "pg_sjis_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "977-989",
    "snippet": "static int\npg_sjis_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s >= 0xa1 && *s <= 0xdf)\n\t\tlen = 1;\t\t\t\t/* 1 byte kana? */\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = pg_ascii_dsplen(s);\t/* should be ASCII */\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_ascii_dsplen",
          "args": [
            "s"
          ],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "pg_ascii_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "60-69",
          "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_sjis_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s >= 0xa1 && *s <= 0xdf)\n\t\tlen = 1;\t\t\t\t/* 1 byte kana? */\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = pg_ascii_dsplen(s);\t/* should be ASCII */\n\treturn len;\n}"
  },
  {
    "function_name": "pg_sjis_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "963-975",
    "snippet": "static int\npg_sjis_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s >= 0xa1 && *s <= 0xdf)\n\t\tlen = 1;\t\t\t\t/* 1 byte kana? */\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_sjis_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s >= 0xa1 && *s <= 0xdf)\n\t\tlen = 1;\t\t\t\t/* 1 byte kana? */\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\t\t\t\t/* kanji? */\n\telse\n\t\tlen = 1;\t\t\t\t/* should be ASCII */\n\treturn len;\n}"
  },
  {
    "function_name": "pg_latin1_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "954-958",
    "snippet": "static int\npg_latin1_dsplen(const unsigned char *s)\n{\n\treturn pg_ascii_dsplen(s);\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_ascii_dsplen",
          "args": [
            "s"
          ],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "pg_ascii_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "60-69",
          "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_latin1_dsplen(const unsigned char *s)\n{\n\treturn pg_ascii_dsplen(s);\n}"
  },
  {
    "function_name": "pg_latin1_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "948-952",
    "snippet": "static int\npg_latin1_mblen(const unsigned char *s)\n{\n\treturn 1;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_latin1_mblen(const unsigned char *s)\n{\n\treturn 1;\n}"
  },
  {
    "function_name": "pg_wchar2single_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "933-946",
    "snippet": "static int\npg_wchar2single_with_len(const pg_wchar *from, unsigned char *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\t*to++ = *from++;\n\t\tlen--;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_wchar2single_with_len(const pg_wchar *from, unsigned char *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\t*to++ = *from++;\n\t\tlen--;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  },
  {
    "function_name": "pg_latin12wchar_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "911-924",
    "snippet": "static int\npg_latin12wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\t*to++ = *from++;\n\t\tlen--;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_latin12wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\t*to++ = *from++;\n\t\tlen--;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  },
  {
    "function_name": "pg_mule_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "883-906",
    "snippet": "static int\npg_mule_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\t/*\n\t * Note: it's not really appropriate to assume that all multibyte charsets\n\t * are double-wide on screen.  But this seems an okay approximation for\n\t * the MULE charsets we currently support.\n\t */\n\n\tif (IS_LC1(*s))\n\t\tlen = 1;\n\telse if (IS_LCPRV1(*s))\n\t\tlen = 1;\n\telse if (IS_LC2(*s))\n\t\tlen = 2;\n\telse if (IS_LCPRV2(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\t\t\t\t/* assume ASCII */\n\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_LCPRV2",
          "args": [
            "*s"
          ],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LC2",
          "args": [
            "*s"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LCPRV1",
          "args": [
            "*s"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LC1",
          "args": [
            "*s"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_mule_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\t/*\n\t * Note: it's not really appropriate to assume that all multibyte charsets\n\t * are double-wide on screen.  But this seems an okay approximation for\n\t * the MULE charsets we currently support.\n\t */\n\n\tif (IS_LC1(*s))\n\t\tlen = 1;\n\telse if (IS_LCPRV1(*s))\n\t\tlen = 1;\n\telse if (IS_LC2(*s))\n\t\tlen = 2;\n\telse if (IS_LCPRV2(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\t\t\t\t/* assume ASCII */\n\n\treturn len;\n}"
  },
  {
    "function_name": "pg_mule_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "865-881",
    "snippet": "int\npg_mule_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_LC1(*s))\n\t\tlen = 2;\n\telse if (IS_LCPRV1(*s))\n\t\tlen = 3;\n\telse if (IS_LC2(*s))\n\t\tlen = 3;\n\telse if (IS_LCPRV2(*s))\n\t\tlen = 4;\n\telse\n\t\tlen = 1;\t\t\t\t/* assume ASCII */\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_LCPRV2",
          "args": [
            "*s"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LC2",
          "args": [
            "*s"
          ],
          "line": 874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LCPRV1",
          "args": [
            "*s"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LC1",
          "args": [
            "*s"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nint\npg_mule_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_LC1(*s))\n\t\tlen = 2;\n\telse if (IS_LCPRV1(*s))\n\t\tlen = 3;\n\telse if (IS_LC2(*s))\n\t\tlen = 3;\n\telse if (IS_LCPRV2(*s))\n\t\tlen = 4;\n\telse\n\t\tlen = 1;\t\t\t\t/* assume ASCII */\n\treturn len;\n}"
  },
  {
    "function_name": "pg_wchar2mule_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "800-863",
    "snippet": "static int\npg_wchar2mule_with_len(const pg_wchar *from, unsigned char *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tunsigned char lb;\n\n\t\tlb = (*from >> 16) & 0xff;\n\t\tif (IS_LC1(lb))\n\t\t{\n\t\t\t*to++ = lb;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 2;\n\t\t}\n\t\telse if (IS_LC2(lb))\n\t\t{\n\t\t\t*to++ = lb;\n\t\t\t*to++ = (*from >> 8) & 0xff;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 3;\n\t\t}\n\t\telse if (IS_LCPRV1_A_RANGE(lb))\n\t\t{\n\t\t\t*to++ = LCPRV1_A;\n\t\t\t*to++ = lb;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 3;\n\t\t}\n\t\telse if (IS_LCPRV1_B_RANGE(lb))\n\t\t{\n\t\t\t*to++ = LCPRV1_B;\n\t\t\t*to++ = lb;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 3;\n\t\t}\n\t\telse if (IS_LCPRV2_A_RANGE(lb))\n\t\t{\n\t\t\t*to++ = LCPRV2_A;\n\t\t\t*to++ = lb;\n\t\t\t*to++ = (*from >> 8) & 0xff;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 4;\n\t\t}\n\t\telse if (IS_LCPRV2_B_RANGE(lb))\n\t\t{\n\t\t\t*to++ = LCPRV2_B;\n\t\t\t*to++ = lb;\n\t\t\t*to++ = (*from >> 8) & 0xff;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 4;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 1;\n\t\t}\n\t\tfrom++;\n\t\tlen--;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_LCPRV2_B_RANGE",
          "args": [
            "lb"
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LCPRV2_A_RANGE",
          "args": [
            "lb"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LCPRV1_B_RANGE",
          "args": [
            "lb"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LCPRV1_A_RANGE",
          "args": [
            "lb"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LC2",
          "args": [
            "lb"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LC1",
          "args": [
            "lb"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_wchar2mule_with_len(const pg_wchar *from, unsigned char *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tunsigned char lb;\n\n\t\tlb = (*from >> 16) & 0xff;\n\t\tif (IS_LC1(lb))\n\t\t{\n\t\t\t*to++ = lb;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 2;\n\t\t}\n\t\telse if (IS_LC2(lb))\n\t\t{\n\t\t\t*to++ = lb;\n\t\t\t*to++ = (*from >> 8) & 0xff;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 3;\n\t\t}\n\t\telse if (IS_LCPRV1_A_RANGE(lb))\n\t\t{\n\t\t\t*to++ = LCPRV1_A;\n\t\t\t*to++ = lb;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 3;\n\t\t}\n\t\telse if (IS_LCPRV1_B_RANGE(lb))\n\t\t{\n\t\t\t*to++ = LCPRV1_B;\n\t\t\t*to++ = lb;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 3;\n\t\t}\n\t\telse if (IS_LCPRV2_A_RANGE(lb))\n\t\t{\n\t\t\t*to++ = LCPRV2_A;\n\t\t\t*to++ = lb;\n\t\t\t*to++ = (*from >> 8) & 0xff;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 4;\n\t\t}\n\t\telse if (IS_LCPRV2_B_RANGE(lb))\n\t\t{\n\t\t\t*to++ = LCPRV2_B;\n\t\t\t*to++ = lb;\n\t\t\t*to++ = (*from >> 8) & 0xff;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 4;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 1;\n\t\t}\n\t\tfrom++;\n\t\tlen--;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  },
  {
    "function_name": "pg_mule2wchar_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "747-792",
    "snippet": "static int\npg_mule2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (IS_LC1(*from) && len >= 2)\n\t\t{\n\t\t\t*to = *from++ << 16;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse if (IS_LCPRV1(*from) && len >= 3)\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = *from++ << 16;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_LC2(*from) && len >= 3)\n\t\t{\n\t\t\t*to = *from++ << 16;\n\t\t\t*to |= *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_LCPRV2(*from) && len >= 4)\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = *from++ << 16;\n\t\t\t*to |= *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 4;\n\t\t}\n\t\telse\n\t\t{\t\t\t\t\t\t/* assume ASCII */\n\t\t\t*to = (unsigned char) *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_LCPRV2",
          "args": [
            "*from"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LC2",
          "args": [
            "*from"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LCPRV1",
          "args": [
            "*from"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_LC1",
          "args": [
            "*from"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_mule2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (IS_LC1(*from) && len >= 2)\n\t\t{\n\t\t\t*to = *from++ << 16;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse if (IS_LCPRV1(*from) && len >= 3)\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = *from++ << 16;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_LC2(*from) && len >= 3)\n\t\t{\n\t\t\t*to = *from++ << 16;\n\t\t\t*to |= *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_LCPRV2(*from) && len >= 4)\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = *from++ << 16;\n\t\t\t*to |= *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 4;\n\t\t}\n\t\telse\n\t\t{\t\t\t\t\t\t/* assume ASCII */\n\t\t\t*to = (unsigned char) *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  },
  {
    "function_name": "pg_utf_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "735-739",
    "snippet": "static int\npg_utf_dsplen(const unsigned char *s)\n{\n\treturn ucs_wcwidth(utf8_to_unicode(s));\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ucs_wcwidth",
          "args": [
            "utf8_to_unicode(s)"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "ucs_wcwidth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "636-705",
          "snippet": "static int\nucs_wcwidth(pg_wchar ucs)\n{\n\t/* sorted list of non-overlapping intervals of non-spacing characters */\n\tstatic const struct mbinterval combining[] = {\n\t\t{0x0300, 0x034E}, {0x0360, 0x0362}, {0x0483, 0x0486},\n\t\t{0x0488, 0x0489}, {0x0591, 0x05A1}, {0x05A3, 0x05B9},\n\t\t{0x05BB, 0x05BD}, {0x05BF, 0x05BF}, {0x05C1, 0x05C2},\n\t\t{0x05C4, 0x05C4}, {0x064B, 0x0655}, {0x0670, 0x0670},\n\t\t{0x06D6, 0x06E4}, {0x06E7, 0x06E8}, {0x06EA, 0x06ED},\n\t\t{0x070F, 0x070F}, {0x0711, 0x0711}, {0x0730, 0x074A},\n\t\t{0x07A6, 0x07B0}, {0x0901, 0x0902}, {0x093C, 0x093C},\n\t\t{0x0941, 0x0948}, {0x094D, 0x094D}, {0x0951, 0x0954},\n\t\t{0x0962, 0x0963}, {0x0981, 0x0981}, {0x09BC, 0x09BC},\n\t\t{0x09C1, 0x09C4}, {0x09CD, 0x09CD}, {0x09E2, 0x09E3},\n\t\t{0x0A02, 0x0A02}, {0x0A3C, 0x0A3C}, {0x0A41, 0x0A42},\n\t\t{0x0A47, 0x0A48}, {0x0A4B, 0x0A4D}, {0x0A70, 0x0A71},\n\t\t{0x0A81, 0x0A82}, {0x0ABC, 0x0ABC}, {0x0AC1, 0x0AC5},\n\t\t{0x0AC7, 0x0AC8}, {0x0ACD, 0x0ACD}, {0x0B01, 0x0B01},\n\t\t{0x0B3C, 0x0B3C}, {0x0B3F, 0x0B3F}, {0x0B41, 0x0B43},\n\t\t{0x0B4D, 0x0B4D}, {0x0B56, 0x0B56}, {0x0B82, 0x0B82},\n\t\t{0x0BC0, 0x0BC0}, {0x0BCD, 0x0BCD}, {0x0C3E, 0x0C40},\n\t\t{0x0C46, 0x0C48}, {0x0C4A, 0x0C4D}, {0x0C55, 0x0C56},\n\t\t{0x0CBF, 0x0CBF}, {0x0CC6, 0x0CC6}, {0x0CCC, 0x0CCD},\n\t\t{0x0D41, 0x0D43}, {0x0D4D, 0x0D4D}, {0x0DCA, 0x0DCA},\n\t\t{0x0DD2, 0x0DD4}, {0x0DD6, 0x0DD6}, {0x0E31, 0x0E31},\n\t\t{0x0E34, 0x0E3A}, {0x0E47, 0x0E4E}, {0x0EB1, 0x0EB1},\n\t\t{0x0EB4, 0x0EB9}, {0x0EBB, 0x0EBC}, {0x0EC8, 0x0ECD},\n\t\t{0x0F18, 0x0F19}, {0x0F35, 0x0F35}, {0x0F37, 0x0F37},\n\t\t{0x0F39, 0x0F39}, {0x0F71, 0x0F7E}, {0x0F80, 0x0F84},\n\t\t{0x0F86, 0x0F87}, {0x0F90, 0x0F97}, {0x0F99, 0x0FBC},\n\t\t{0x0FC6, 0x0FC6}, {0x102D, 0x1030}, {0x1032, 0x1032},\n\t\t{0x1036, 0x1037}, {0x1039, 0x1039}, {0x1058, 0x1059},\n\t\t{0x1160, 0x11FF}, {0x17B7, 0x17BD}, {0x17C6, 0x17C6},\n\t\t{0x17C9, 0x17D3}, {0x180B, 0x180E}, {0x18A9, 0x18A9},\n\t\t{0x200B, 0x200F}, {0x202A, 0x202E}, {0x206A, 0x206F},\n\t\t{0x20D0, 0x20E3}, {0x302A, 0x302F}, {0x3099, 0x309A},\n\t\t{0xFB1E, 0xFB1E}, {0xFE20, 0xFE23}, {0xFEFF, 0xFEFF},\n\t\t{0xFFF9, 0xFFFB}\n\t};\n\n\t/* test for 8-bit control characters */\n\tif (ucs == 0)\n\t\treturn 0;\n\n\tif (ucs < 0x20 || (ucs >= 0x7f && ucs < 0xa0) || ucs > 0x0010ffff)\n\t\treturn -1;\n\n\t/* binary search in table of non-spacing characters */\n\tif (mbbisearch(ucs, combining,\n\t\t\t\t   sizeof(combining) / sizeof(struct mbinterval) - 1))\n\t\treturn 0;\n\n\t/*\n\t * if we arrive here, ucs is not a combining or C0/C1 control character\n\t */\n\n\treturn 1 +\n\t\t(ucs >= 0x1100 &&\n\t\t (ucs <= 0x115f ||\t\t/* Hangul Jamo init. consonants */\n\t\t  (ucs >= 0x2e80 && ucs <= 0xa4cf && (ucs & ~0x0011) != 0x300a &&\n\t\t   ucs != 0x303f) ||\t/* CJK ... Yi */\n\t\t  (ucs >= 0xac00 && ucs <= 0xd7a3) ||\t/* Hangul Syllables */\n\t\t  (ucs >= 0xf900 && ucs <= 0xfaff) ||\t/* CJK Compatibility\n\t\t\t\t\t\t\t\t\t\t\t\t * Ideographs */\n\t\t  (ucs >= 0xfe30 && ucs <= 0xfe6f) ||\t/* CJK Compatibility Forms */\n\t\t  (ucs >= 0xff00 && ucs <= 0xff5f) ||\t/* Fullwidth Forms */\n\t\t  (ucs >= 0xffe0 && ucs <= 0xffe6) ||\n\t\t  (ucs >= 0x20000 && ucs <= 0x2ffff)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\nucs_wcwidth(pg_wchar ucs)\n{\n\t/* sorted list of non-overlapping intervals of non-spacing characters */\n\tstatic const struct mbinterval combining[] = {\n\t\t{0x0300, 0x034E}, {0x0360, 0x0362}, {0x0483, 0x0486},\n\t\t{0x0488, 0x0489}, {0x0591, 0x05A1}, {0x05A3, 0x05B9},\n\t\t{0x05BB, 0x05BD}, {0x05BF, 0x05BF}, {0x05C1, 0x05C2},\n\t\t{0x05C4, 0x05C4}, {0x064B, 0x0655}, {0x0670, 0x0670},\n\t\t{0x06D6, 0x06E4}, {0x06E7, 0x06E8}, {0x06EA, 0x06ED},\n\t\t{0x070F, 0x070F}, {0x0711, 0x0711}, {0x0730, 0x074A},\n\t\t{0x07A6, 0x07B0}, {0x0901, 0x0902}, {0x093C, 0x093C},\n\t\t{0x0941, 0x0948}, {0x094D, 0x094D}, {0x0951, 0x0954},\n\t\t{0x0962, 0x0963}, {0x0981, 0x0981}, {0x09BC, 0x09BC},\n\t\t{0x09C1, 0x09C4}, {0x09CD, 0x09CD}, {0x09E2, 0x09E3},\n\t\t{0x0A02, 0x0A02}, {0x0A3C, 0x0A3C}, {0x0A41, 0x0A42},\n\t\t{0x0A47, 0x0A48}, {0x0A4B, 0x0A4D}, {0x0A70, 0x0A71},\n\t\t{0x0A81, 0x0A82}, {0x0ABC, 0x0ABC}, {0x0AC1, 0x0AC5},\n\t\t{0x0AC7, 0x0AC8}, {0x0ACD, 0x0ACD}, {0x0B01, 0x0B01},\n\t\t{0x0B3C, 0x0B3C}, {0x0B3F, 0x0B3F}, {0x0B41, 0x0B43},\n\t\t{0x0B4D, 0x0B4D}, {0x0B56, 0x0B56}, {0x0B82, 0x0B82},\n\t\t{0x0BC0, 0x0BC0}, {0x0BCD, 0x0BCD}, {0x0C3E, 0x0C40},\n\t\t{0x0C46, 0x0C48}, {0x0C4A, 0x0C4D}, {0x0C55, 0x0C56},\n\t\t{0x0CBF, 0x0CBF}, {0x0CC6, 0x0CC6}, {0x0CCC, 0x0CCD},\n\t\t{0x0D41, 0x0D43}, {0x0D4D, 0x0D4D}, {0x0DCA, 0x0DCA},\n\t\t{0x0DD2, 0x0DD4}, {0x0DD6, 0x0DD6}, {0x0E31, 0x0E31},\n\t\t{0x0E34, 0x0E3A}, {0x0E47, 0x0E4E}, {0x0EB1, 0x0EB1},\n\t\t{0x0EB4, 0x0EB9}, {0x0EBB, 0x0EBC}, {0x0EC8, 0x0ECD},\n\t\t{0x0F18, 0x0F19}, {0x0F35, 0x0F35}, {0x0F37, 0x0F37},\n\t\t{0x0F39, 0x0F39}, {0x0F71, 0x0F7E}, {0x0F80, 0x0F84},\n\t\t{0x0F86, 0x0F87}, {0x0F90, 0x0F97}, {0x0F99, 0x0FBC},\n\t\t{0x0FC6, 0x0FC6}, {0x102D, 0x1030}, {0x1032, 0x1032},\n\t\t{0x1036, 0x1037}, {0x1039, 0x1039}, {0x1058, 0x1059},\n\t\t{0x1160, 0x11FF}, {0x17B7, 0x17BD}, {0x17C6, 0x17C6},\n\t\t{0x17C9, 0x17D3}, {0x180B, 0x180E}, {0x18A9, 0x18A9},\n\t\t{0x200B, 0x200F}, {0x202A, 0x202E}, {0x206A, 0x206F},\n\t\t{0x20D0, 0x20E3}, {0x302A, 0x302F}, {0x3099, 0x309A},\n\t\t{0xFB1E, 0xFB1E}, {0xFE20, 0xFE23}, {0xFEFF, 0xFEFF},\n\t\t{0xFFF9, 0xFFFB}\n\t};\n\n\t/* test for 8-bit control characters */\n\tif (ucs == 0)\n\t\treturn 0;\n\n\tif (ucs < 0x20 || (ucs >= 0x7f && ucs < 0xa0) || ucs > 0x0010ffff)\n\t\treturn -1;\n\n\t/* binary search in table of non-spacing characters */\n\tif (mbbisearch(ucs, combining,\n\t\t\t\t   sizeof(combining) / sizeof(struct mbinterval) - 1))\n\t\treturn 0;\n\n\t/*\n\t * if we arrive here, ucs is not a combining or C0/C1 control character\n\t */\n\n\treturn 1 +\n\t\t(ucs >= 0x1100 &&\n\t\t (ucs <= 0x115f ||\t\t/* Hangul Jamo init. consonants */\n\t\t  (ucs >= 0x2e80 && ucs <= 0xa4cf && (ucs & ~0x0011) != 0x300a &&\n\t\t   ucs != 0x303f) ||\t/* CJK ... Yi */\n\t\t  (ucs >= 0xac00 && ucs <= 0xd7a3) ||\t/* Hangul Syllables */\n\t\t  (ucs >= 0xf900 && ucs <= 0xfaff) ||\t/* CJK Compatibility\n\t\t\t\t\t\t\t\t\t\t\t\t * Ideographs */\n\t\t  (ucs >= 0xfe30 && ucs <= 0xfe6f) ||\t/* CJK Compatibility Forms */\n\t\t  (ucs >= 0xff00 && ucs <= 0xff5f) ||\t/* Fullwidth Forms */\n\t\t  (ucs >= 0xffe0 && ucs <= 0xffe6) ||\n\t\t  (ucs >= 0x20000 && ucs <= 0x2ffff)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "utf8_to_unicode",
          "args": [
            "s"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "utf8_to_unicode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "713-733",
          "snippet": "pg_wchar\nutf8_to_unicode(const unsigned char *c)\n{\n\tif ((*c & 0x80) == 0)\n\t\treturn (pg_wchar) c[0];\n\telse if ((*c & 0xe0) == 0xc0)\n\t\treturn (pg_wchar) (((c[0] & 0x1f) << 6) |\n\t\t\t\t\t\t   (c[1] & 0x3f));\n\telse if ((*c & 0xf0) == 0xe0)\n\t\treturn (pg_wchar) (((c[0] & 0x0f) << 12) |\n\t\t\t\t\t\t   ((c[1] & 0x3f) << 6) |\n\t\t\t\t\t\t   (c[2] & 0x3f));\n\telse if ((*c & 0xf8) == 0xf0)\n\t\treturn (pg_wchar) (((c[0] & 0x07) << 18) |\n\t\t\t\t\t\t   ((c[1] & 0x3f) << 12) |\n\t\t\t\t\t\t   ((c[2] & 0x3f) << 6) |\n\t\t\t\t\t\t   (c[3] & 0x3f));\n\telse\n\t\t/* that is an invalid code on purpose */\n\t\treturn 0xffffffff;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\npg_wchar\nutf8_to_unicode(const unsigned char *c)\n{\n\tif ((*c & 0x80) == 0)\n\t\treturn (pg_wchar) c[0];\n\telse if ((*c & 0xe0) == 0xc0)\n\t\treturn (pg_wchar) (((c[0] & 0x1f) << 6) |\n\t\t\t\t\t\t   (c[1] & 0x3f));\n\telse if ((*c & 0xf0) == 0xe0)\n\t\treturn (pg_wchar) (((c[0] & 0x0f) << 12) |\n\t\t\t\t\t\t   ((c[1] & 0x3f) << 6) |\n\t\t\t\t\t\t   (c[2] & 0x3f));\n\telse if ((*c & 0xf8) == 0xf0)\n\t\treturn (pg_wchar) (((c[0] & 0x07) << 18) |\n\t\t\t\t\t\t   ((c[1] & 0x3f) << 12) |\n\t\t\t\t\t\t   ((c[2] & 0x3f) << 6) |\n\t\t\t\t\t\t   (c[3] & 0x3f));\n\telse\n\t\t/* that is an invalid code on purpose */\n\t\treturn 0xffffffff;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_utf_dsplen(const unsigned char *s)\n{\n\treturn ucs_wcwidth(utf8_to_unicode(s));\n}"
  },
  {
    "function_name": "utf8_to_unicode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "713-733",
    "snippet": "pg_wchar\nutf8_to_unicode(const unsigned char *c)\n{\n\tif ((*c & 0x80) == 0)\n\t\treturn (pg_wchar) c[0];\n\telse if ((*c & 0xe0) == 0xc0)\n\t\treturn (pg_wchar) (((c[0] & 0x1f) << 6) |\n\t\t\t\t\t\t   (c[1] & 0x3f));\n\telse if ((*c & 0xf0) == 0xe0)\n\t\treturn (pg_wchar) (((c[0] & 0x0f) << 12) |\n\t\t\t\t\t\t   ((c[1] & 0x3f) << 6) |\n\t\t\t\t\t\t   (c[2] & 0x3f));\n\telse if ((*c & 0xf8) == 0xf0)\n\t\treturn (pg_wchar) (((c[0] & 0x07) << 18) |\n\t\t\t\t\t\t   ((c[1] & 0x3f) << 12) |\n\t\t\t\t\t\t   ((c[2] & 0x3f) << 6) |\n\t\t\t\t\t\t   (c[3] & 0x3f));\n\telse\n\t\t/* that is an invalid code on purpose */\n\t\treturn 0xffffffff;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "((c[0] & 0x07) << 18) |\n\t\t\t\t\t\t   ((c[1] & 0x3f) << 12) |\n\t\t\t\t\t\t   ((c[2] & 0x3f) << 6) |\n\t\t\t\t\t\t   (c[3] & 0x3f)"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "((c[0] & 0x0f) << 12) |\n\t\t\t\t\t\t   ((c[1] & 0x3f) << 6) |\n\t\t\t\t\t\t   (c[2] & 0x3f)"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "((c[0] & 0x1f) << 6) |\n\t\t\t\t\t\t   (c[1] & 0x3f)"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\npg_wchar\nutf8_to_unicode(const unsigned char *c)\n{\n\tif ((*c & 0x80) == 0)\n\t\treturn (pg_wchar) c[0];\n\telse if ((*c & 0xe0) == 0xc0)\n\t\treturn (pg_wchar) (((c[0] & 0x1f) << 6) |\n\t\t\t\t\t\t   (c[1] & 0x3f));\n\telse if ((*c & 0xf0) == 0xe0)\n\t\treturn (pg_wchar) (((c[0] & 0x0f) << 12) |\n\t\t\t\t\t\t   ((c[1] & 0x3f) << 6) |\n\t\t\t\t\t\t   (c[2] & 0x3f));\n\telse if ((*c & 0xf8) == 0xf0)\n\t\treturn (pg_wchar) (((c[0] & 0x07) << 18) |\n\t\t\t\t\t\t   ((c[1] & 0x3f) << 12) |\n\t\t\t\t\t\t   ((c[2] & 0x3f) << 6) |\n\t\t\t\t\t\t   (c[3] & 0x3f));\n\telse\n\t\t/* that is an invalid code on purpose */\n\t\treturn 0xffffffff;\n}"
  },
  {
    "function_name": "ucs_wcwidth",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "636-705",
    "snippet": "static int\nucs_wcwidth(pg_wchar ucs)\n{\n\t/* sorted list of non-overlapping intervals of non-spacing characters */\n\tstatic const struct mbinterval combining[] = {\n\t\t{0x0300, 0x034E}, {0x0360, 0x0362}, {0x0483, 0x0486},\n\t\t{0x0488, 0x0489}, {0x0591, 0x05A1}, {0x05A3, 0x05B9},\n\t\t{0x05BB, 0x05BD}, {0x05BF, 0x05BF}, {0x05C1, 0x05C2},\n\t\t{0x05C4, 0x05C4}, {0x064B, 0x0655}, {0x0670, 0x0670},\n\t\t{0x06D6, 0x06E4}, {0x06E7, 0x06E8}, {0x06EA, 0x06ED},\n\t\t{0x070F, 0x070F}, {0x0711, 0x0711}, {0x0730, 0x074A},\n\t\t{0x07A6, 0x07B0}, {0x0901, 0x0902}, {0x093C, 0x093C},\n\t\t{0x0941, 0x0948}, {0x094D, 0x094D}, {0x0951, 0x0954},\n\t\t{0x0962, 0x0963}, {0x0981, 0x0981}, {0x09BC, 0x09BC},\n\t\t{0x09C1, 0x09C4}, {0x09CD, 0x09CD}, {0x09E2, 0x09E3},\n\t\t{0x0A02, 0x0A02}, {0x0A3C, 0x0A3C}, {0x0A41, 0x0A42},\n\t\t{0x0A47, 0x0A48}, {0x0A4B, 0x0A4D}, {0x0A70, 0x0A71},\n\t\t{0x0A81, 0x0A82}, {0x0ABC, 0x0ABC}, {0x0AC1, 0x0AC5},\n\t\t{0x0AC7, 0x0AC8}, {0x0ACD, 0x0ACD}, {0x0B01, 0x0B01},\n\t\t{0x0B3C, 0x0B3C}, {0x0B3F, 0x0B3F}, {0x0B41, 0x0B43},\n\t\t{0x0B4D, 0x0B4D}, {0x0B56, 0x0B56}, {0x0B82, 0x0B82},\n\t\t{0x0BC0, 0x0BC0}, {0x0BCD, 0x0BCD}, {0x0C3E, 0x0C40},\n\t\t{0x0C46, 0x0C48}, {0x0C4A, 0x0C4D}, {0x0C55, 0x0C56},\n\t\t{0x0CBF, 0x0CBF}, {0x0CC6, 0x0CC6}, {0x0CCC, 0x0CCD},\n\t\t{0x0D41, 0x0D43}, {0x0D4D, 0x0D4D}, {0x0DCA, 0x0DCA},\n\t\t{0x0DD2, 0x0DD4}, {0x0DD6, 0x0DD6}, {0x0E31, 0x0E31},\n\t\t{0x0E34, 0x0E3A}, {0x0E47, 0x0E4E}, {0x0EB1, 0x0EB1},\n\t\t{0x0EB4, 0x0EB9}, {0x0EBB, 0x0EBC}, {0x0EC8, 0x0ECD},\n\t\t{0x0F18, 0x0F19}, {0x0F35, 0x0F35}, {0x0F37, 0x0F37},\n\t\t{0x0F39, 0x0F39}, {0x0F71, 0x0F7E}, {0x0F80, 0x0F84},\n\t\t{0x0F86, 0x0F87}, {0x0F90, 0x0F97}, {0x0F99, 0x0FBC},\n\t\t{0x0FC6, 0x0FC6}, {0x102D, 0x1030}, {0x1032, 0x1032},\n\t\t{0x1036, 0x1037}, {0x1039, 0x1039}, {0x1058, 0x1059},\n\t\t{0x1160, 0x11FF}, {0x17B7, 0x17BD}, {0x17C6, 0x17C6},\n\t\t{0x17C9, 0x17D3}, {0x180B, 0x180E}, {0x18A9, 0x18A9},\n\t\t{0x200B, 0x200F}, {0x202A, 0x202E}, {0x206A, 0x206F},\n\t\t{0x20D0, 0x20E3}, {0x302A, 0x302F}, {0x3099, 0x309A},\n\t\t{0xFB1E, 0xFB1E}, {0xFE20, 0xFE23}, {0xFEFF, 0xFEFF},\n\t\t{0xFFF9, 0xFFFB}\n\t};\n\n\t/* test for 8-bit control characters */\n\tif (ucs == 0)\n\t\treturn 0;\n\n\tif (ucs < 0x20 || (ucs >= 0x7f && ucs < 0xa0) || ucs > 0x0010ffff)\n\t\treturn -1;\n\n\t/* binary search in table of non-spacing characters */\n\tif (mbbisearch(ucs, combining,\n\t\t\t\t   sizeof(combining) / sizeof(struct mbinterval) - 1))\n\t\treturn 0;\n\n\t/*\n\t * if we arrive here, ucs is not a combining or C0/C1 control character\n\t */\n\n\treturn 1 +\n\t\t(ucs >= 0x1100 &&\n\t\t (ucs <= 0x115f ||\t\t/* Hangul Jamo init. consonants */\n\t\t  (ucs >= 0x2e80 && ucs <= 0xa4cf && (ucs & ~0x0011) != 0x300a &&\n\t\t   ucs != 0x303f) ||\t/* CJK ... Yi */\n\t\t  (ucs >= 0xac00 && ucs <= 0xd7a3) ||\t/* Hangul Syllables */\n\t\t  (ucs >= 0xf900 && ucs <= 0xfaff) ||\t/* CJK Compatibility\n\t\t\t\t\t\t\t\t\t\t\t\t * Ideographs */\n\t\t  (ucs >= 0xfe30 && ucs <= 0xfe6f) ||\t/* CJK Compatibility Forms */\n\t\t  (ucs >= 0xff00 && ucs <= 0xff5f) ||\t/* Fullwidth Forms */\n\t\t  (ucs >= 0xffe0 && ucs <= 0xffe6) ||\n\t\t  (ucs >= 0x20000 && ucs <= 0x2ffff)));\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mbbisearch",
          "args": [
            "ucs",
            "combining",
            "sizeof(combining) / sizeof(struct mbinterval) - 1"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "mbbisearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "583-603",
          "snippet": "static int\nmbbisearch(pg_wchar ucs, const struct mbinterval *table, int max)\n{\n\tint\t\t\tmin = 0;\n\tint\t\t\tmid;\n\n\tif (ucs < table[0].first || ucs > table[max].last)\n\t\treturn 0;\n\twhile (max >= min)\n\t{\n\t\tmid = (min + max) / 2;\n\t\tif (ucs > table[mid].last)\n\t\t\tmin = mid + 1;\n\t\telse if (ucs < table[mid].first)\n\t\t\tmax = mid - 1;\n\t\telse\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\nmbbisearch(pg_wchar ucs, const struct mbinterval *table, int max)\n{\n\tint\t\t\tmin = 0;\n\tint\t\t\tmid;\n\n\tif (ucs < table[0].first || ucs > table[max].last)\n\t\treturn 0;\n\twhile (max >= min)\n\t{\n\t\tmid = (min + max) / 2;\n\t\tif (ucs > table[mid].last)\n\t\t\tmin = mid + 1;\n\t\telse if (ucs < table[mid].first)\n\t\t\tmax = mid - 1;\n\t\telse\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\nucs_wcwidth(pg_wchar ucs)\n{\n\t/* sorted list of non-overlapping intervals of non-spacing characters */\n\tstatic const struct mbinterval combining[] = {\n\t\t{0x0300, 0x034E}, {0x0360, 0x0362}, {0x0483, 0x0486},\n\t\t{0x0488, 0x0489}, {0x0591, 0x05A1}, {0x05A3, 0x05B9},\n\t\t{0x05BB, 0x05BD}, {0x05BF, 0x05BF}, {0x05C1, 0x05C2},\n\t\t{0x05C4, 0x05C4}, {0x064B, 0x0655}, {0x0670, 0x0670},\n\t\t{0x06D6, 0x06E4}, {0x06E7, 0x06E8}, {0x06EA, 0x06ED},\n\t\t{0x070F, 0x070F}, {0x0711, 0x0711}, {0x0730, 0x074A},\n\t\t{0x07A6, 0x07B0}, {0x0901, 0x0902}, {0x093C, 0x093C},\n\t\t{0x0941, 0x0948}, {0x094D, 0x094D}, {0x0951, 0x0954},\n\t\t{0x0962, 0x0963}, {0x0981, 0x0981}, {0x09BC, 0x09BC},\n\t\t{0x09C1, 0x09C4}, {0x09CD, 0x09CD}, {0x09E2, 0x09E3},\n\t\t{0x0A02, 0x0A02}, {0x0A3C, 0x0A3C}, {0x0A41, 0x0A42},\n\t\t{0x0A47, 0x0A48}, {0x0A4B, 0x0A4D}, {0x0A70, 0x0A71},\n\t\t{0x0A81, 0x0A82}, {0x0ABC, 0x0ABC}, {0x0AC1, 0x0AC5},\n\t\t{0x0AC7, 0x0AC8}, {0x0ACD, 0x0ACD}, {0x0B01, 0x0B01},\n\t\t{0x0B3C, 0x0B3C}, {0x0B3F, 0x0B3F}, {0x0B41, 0x0B43},\n\t\t{0x0B4D, 0x0B4D}, {0x0B56, 0x0B56}, {0x0B82, 0x0B82},\n\t\t{0x0BC0, 0x0BC0}, {0x0BCD, 0x0BCD}, {0x0C3E, 0x0C40},\n\t\t{0x0C46, 0x0C48}, {0x0C4A, 0x0C4D}, {0x0C55, 0x0C56},\n\t\t{0x0CBF, 0x0CBF}, {0x0CC6, 0x0CC6}, {0x0CCC, 0x0CCD},\n\t\t{0x0D41, 0x0D43}, {0x0D4D, 0x0D4D}, {0x0DCA, 0x0DCA},\n\t\t{0x0DD2, 0x0DD4}, {0x0DD6, 0x0DD6}, {0x0E31, 0x0E31},\n\t\t{0x0E34, 0x0E3A}, {0x0E47, 0x0E4E}, {0x0EB1, 0x0EB1},\n\t\t{0x0EB4, 0x0EB9}, {0x0EBB, 0x0EBC}, {0x0EC8, 0x0ECD},\n\t\t{0x0F18, 0x0F19}, {0x0F35, 0x0F35}, {0x0F37, 0x0F37},\n\t\t{0x0F39, 0x0F39}, {0x0F71, 0x0F7E}, {0x0F80, 0x0F84},\n\t\t{0x0F86, 0x0F87}, {0x0F90, 0x0F97}, {0x0F99, 0x0FBC},\n\t\t{0x0FC6, 0x0FC6}, {0x102D, 0x1030}, {0x1032, 0x1032},\n\t\t{0x1036, 0x1037}, {0x1039, 0x1039}, {0x1058, 0x1059},\n\t\t{0x1160, 0x11FF}, {0x17B7, 0x17BD}, {0x17C6, 0x17C6},\n\t\t{0x17C9, 0x17D3}, {0x180B, 0x180E}, {0x18A9, 0x18A9},\n\t\t{0x200B, 0x200F}, {0x202A, 0x202E}, {0x206A, 0x206F},\n\t\t{0x20D0, 0x20E3}, {0x302A, 0x302F}, {0x3099, 0x309A},\n\t\t{0xFB1E, 0xFB1E}, {0xFE20, 0xFE23}, {0xFEFF, 0xFEFF},\n\t\t{0xFFF9, 0xFFFB}\n\t};\n\n\t/* test for 8-bit control characters */\n\tif (ucs == 0)\n\t\treturn 0;\n\n\tif (ucs < 0x20 || (ucs >= 0x7f && ucs < 0xa0) || ucs > 0x0010ffff)\n\t\treturn -1;\n\n\t/* binary search in table of non-spacing characters */\n\tif (mbbisearch(ucs, combining,\n\t\t\t\t   sizeof(combining) / sizeof(struct mbinterval) - 1))\n\t\treturn 0;\n\n\t/*\n\t * if we arrive here, ucs is not a combining or C0/C1 control character\n\t */\n\n\treturn 1 +\n\t\t(ucs >= 0x1100 &&\n\t\t (ucs <= 0x115f ||\t\t/* Hangul Jamo init. consonants */\n\t\t  (ucs >= 0x2e80 && ucs <= 0xa4cf && (ucs & ~0x0011) != 0x300a &&\n\t\t   ucs != 0x303f) ||\t/* CJK ... Yi */\n\t\t  (ucs >= 0xac00 && ucs <= 0xd7a3) ||\t/* Hangul Syllables */\n\t\t  (ucs >= 0xf900 && ucs <= 0xfaff) ||\t/* CJK Compatibility\n\t\t\t\t\t\t\t\t\t\t\t\t * Ideographs */\n\t\t  (ucs >= 0xfe30 && ucs <= 0xfe6f) ||\t/* CJK Compatibility Forms */\n\t\t  (ucs >= 0xff00 && ucs <= 0xff5f) ||\t/* Fullwidth Forms */\n\t\t  (ucs >= 0xffe0 && ucs <= 0xffe6) ||\n\t\t  (ucs >= 0x20000 && ucs <= 0x2ffff)));\n}"
  },
  {
    "function_name": "mbbisearch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "583-603",
    "snippet": "static int\nmbbisearch(pg_wchar ucs, const struct mbinterval *table, int max)\n{\n\tint\t\t\tmin = 0;\n\tint\t\t\tmid;\n\n\tif (ucs < table[0].first || ucs > table[max].last)\n\t\treturn 0;\n\twhile (max >= min)\n\t{\n\t\tmid = (min + max) / 2;\n\t\tif (ucs > table[mid].last)\n\t\t\tmin = mid + 1;\n\t\telse if (ucs < table[mid].first)\n\t\t\tmax = mid - 1;\n\t\telse\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\nmbbisearch(pg_wchar ucs, const struct mbinterval *table, int max)\n{\n\tint\t\t\tmin = 0;\n\tint\t\t\tmid;\n\n\tif (ucs < table[0].first || ucs > table[max].last)\n\t\treturn 0;\n\twhile (max >= min)\n\t{\n\t\tmid = (min + max) / 2;\n\t\tif (ucs > table[mid].last)\n\t\t\tmin = mid + 1;\n\t\telse if (ucs < table[mid].first)\n\t\t\tmax = mid - 1;\n\t\telse\n\t\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "pg_utf_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "540-562",
    "snippet": "int\npg_utf_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif ((*s & 0x80) == 0)\n\t\tlen = 1;\n\telse if ((*s & 0xe0) == 0xc0)\n\t\tlen = 2;\n\telse if ((*s & 0xf0) == 0xe0)\n\t\tlen = 3;\n\telse if ((*s & 0xf8) == 0xf0)\n\t\tlen = 4;\n#ifdef NOT_USED\n\telse if ((*s & 0xfc) == 0xf8)\n\t\tlen = 5;\n\telse if ((*s & 0xfe) == 0xfc)\n\t\tlen = 6;\n#endif\n\telse\n\t\tlen = 1;\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nint\npg_utf_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif ((*s & 0x80) == 0)\n\t\tlen = 1;\n\telse if ((*s & 0xe0) == 0xc0)\n\t\tlen = 2;\n\telse if ((*s & 0xf0) == 0xe0)\n\t\tlen = 3;\n\telse if ((*s & 0xf8) == 0xf0)\n\t\tlen = 4;\n#ifdef NOT_USED\n\telse if ((*s & 0xfc) == 0xf8)\n\t\tlen = 5;\n\telse if ((*s & 0xfe) == 0xfc)\n\t\tlen = 6;\n#endif\n\telse\n\t\tlen = 1;\n\treturn len;\n}"
  },
  {
    "function_name": "pg_wchar2utf_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "509-527",
    "snippet": "static int\npg_wchar2utf_with_len(const pg_wchar *from, unsigned char *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tint\t\t\tchar_len;\n\n\t\tunicode_to_utf8(*from, to);\n\t\tchar_len = pg_utf_mblen(to);\n\t\tcnt += char_len;\n\t\tto += char_len;\n\t\tfrom++;\n\t\tlen--;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_utf_mblen",
          "args": [
            "to"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "pg_utf_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "540-562",
          "snippet": "int\npg_utf_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif ((*s & 0x80) == 0)\n\t\tlen = 1;\n\telse if ((*s & 0xe0) == 0xc0)\n\t\tlen = 2;\n\telse if ((*s & 0xf0) == 0xe0)\n\t\tlen = 3;\n\telse if ((*s & 0xf8) == 0xf0)\n\t\tlen = 4;\n#ifdef NOT_USED\n\telse if ((*s & 0xfc) == 0xf8)\n\t\tlen = 5;\n\telse if ((*s & 0xfe) == 0xfc)\n\t\tlen = 6;\n#endif\n\telse\n\t\tlen = 1;\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nint\npg_utf_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif ((*s & 0x80) == 0)\n\t\tlen = 1;\n\telse if ((*s & 0xe0) == 0xc0)\n\t\tlen = 2;\n\telse if ((*s & 0xf0) == 0xe0)\n\t\tlen = 3;\n\telse if ((*s & 0xf8) == 0xf0)\n\t\tlen = 4;\n#ifdef NOT_USED\n\telse if ((*s & 0xfc) == 0xf8)\n\t\tlen = 5;\n\telse if ((*s & 0xfe) == 0xfc)\n\t\tlen = 6;\n#endif\n\telse\n\t\tlen = 1;\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unicode_to_utf8",
          "args": [
            "*from",
            "to"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "unicode_to_utf8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "474-501",
          "snippet": "unsigned char *\nunicode_to_utf8(pg_wchar c, unsigned char *utf8string)\n{\n\tif (c <= 0x7F)\n\t{\n\t\tutf8string[0] = c;\n\t}\n\telse if (c <= 0x7FF)\n\t{\n\t\tutf8string[0] = 0xC0 | ((c >> 6) & 0x1F);\n\t\tutf8string[1] = 0x80 | (c & 0x3F);\n\t}\n\telse if (c <= 0xFFFF)\n\t{\n\t\tutf8string[0] = 0xE0 | ((c >> 12) & 0x0F);\n\t\tutf8string[1] = 0x80 | ((c >> 6) & 0x3F);\n\t\tutf8string[2] = 0x80 | (c & 0x3F);\n\t}\n\telse\n\t{\n\t\tutf8string[0] = 0xF0 | ((c >> 18) & 0x07);\n\t\tutf8string[1] = 0x80 | ((c >> 12) & 0x3F);\n\t\tutf8string[2] = 0x80 | ((c >> 6) & 0x3F);\n\t\tutf8string[3] = 0x80 | (c & 0x3F);\n\t}\n\n\treturn utf8string;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nunsigned char *\nunicode_to_utf8(pg_wchar c, unsigned char *utf8string)\n{\n\tif (c <= 0x7F)\n\t{\n\t\tutf8string[0] = c;\n\t}\n\telse if (c <= 0x7FF)\n\t{\n\t\tutf8string[0] = 0xC0 | ((c >> 6) & 0x1F);\n\t\tutf8string[1] = 0x80 | (c & 0x3F);\n\t}\n\telse if (c <= 0xFFFF)\n\t{\n\t\tutf8string[0] = 0xE0 | ((c >> 12) & 0x0F);\n\t\tutf8string[1] = 0x80 | ((c >> 6) & 0x3F);\n\t\tutf8string[2] = 0x80 | (c & 0x3F);\n\t}\n\telse\n\t{\n\t\tutf8string[0] = 0xF0 | ((c >> 18) & 0x07);\n\t\tutf8string[1] = 0x80 | ((c >> 12) & 0x3F);\n\t\tutf8string[2] = 0x80 | ((c >> 6) & 0x3F);\n\t\tutf8string[3] = 0x80 | (c & 0x3F);\n\t}\n\n\treturn utf8string;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_wchar2utf_with_len(const pg_wchar *from, unsigned char *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tint\t\t\tchar_len;\n\n\t\tunicode_to_utf8(*from, to);\n\t\tchar_len = pg_utf_mblen(to);\n\t\tcnt += char_len;\n\t\tto += char_len;\n\t\tfrom++;\n\t\tlen--;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  },
  {
    "function_name": "unicode_to_utf8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "474-501",
    "snippet": "unsigned char *\nunicode_to_utf8(pg_wchar c, unsigned char *utf8string)\n{\n\tif (c <= 0x7F)\n\t{\n\t\tutf8string[0] = c;\n\t}\n\telse if (c <= 0x7FF)\n\t{\n\t\tutf8string[0] = 0xC0 | ((c >> 6) & 0x1F);\n\t\tutf8string[1] = 0x80 | (c & 0x3F);\n\t}\n\telse if (c <= 0xFFFF)\n\t{\n\t\tutf8string[0] = 0xE0 | ((c >> 12) & 0x0F);\n\t\tutf8string[1] = 0x80 | ((c >> 6) & 0x3F);\n\t\tutf8string[2] = 0x80 | (c & 0x3F);\n\t}\n\telse\n\t{\n\t\tutf8string[0] = 0xF0 | ((c >> 18) & 0x07);\n\t\tutf8string[1] = 0x80 | ((c >> 12) & 0x3F);\n\t\tutf8string[2] = 0x80 | ((c >> 6) & 0x3F);\n\t\tutf8string[3] = 0x80 | (c & 0x3F);\n\t}\n\n\treturn utf8string;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nunsigned char *\nunicode_to_utf8(pg_wchar c, unsigned char *utf8string)\n{\n\tif (c <= 0x7F)\n\t{\n\t\tutf8string[0] = c;\n\t}\n\telse if (c <= 0x7FF)\n\t{\n\t\tutf8string[0] = 0xC0 | ((c >> 6) & 0x1F);\n\t\tutf8string[1] = 0x80 | (c & 0x3F);\n\t}\n\telse if (c <= 0xFFFF)\n\t{\n\t\tutf8string[0] = 0xE0 | ((c >> 12) & 0x0F);\n\t\tutf8string[1] = 0x80 | ((c >> 6) & 0x3F);\n\t\tutf8string[2] = 0x80 | (c & 0x3F);\n\t}\n\telse\n\t{\n\t\tutf8string[0] = 0xF0 | ((c >> 18) & 0x07);\n\t\tutf8string[1] = 0x80 | ((c >> 12) & 0x3F);\n\t\tutf8string[2] = 0x80 | ((c >> 6) & 0x3F);\n\t\tutf8string[3] = 0x80 | (c & 0x3F);\n\t}\n\n\treturn utf8string;\n}"
  },
  {
    "function_name": "pg_utf2wchar_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "410-467",
    "snippet": "static int\npg_utf2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\tuint32\t\tc1,\n\t\t\t\tc2,\n\t\t\t\tc3,\n\t\t\t\tc4;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif ((*from & 0x80) == 0)\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\telse if ((*from & 0xe0) == 0xc0)\n\t\t{\n\t\t\tif (len < 2)\n\t\t\t\tbreak;\t\t\t/* drop trailing incomplete char */\n\t\t\tc1 = *from++ & 0x1f;\n\t\t\tc2 = *from++ & 0x3f;\n\t\t\t*to = (c1 << 6) | c2;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse if ((*from & 0xf0) == 0xe0)\n\t\t{\n\t\t\tif (len < 3)\n\t\t\t\tbreak;\t\t\t/* drop trailing incomplete char */\n\t\t\tc1 = *from++ & 0x0f;\n\t\t\tc2 = *from++ & 0x3f;\n\t\t\tc3 = *from++ & 0x3f;\n\t\t\t*to = (c1 << 12) | (c2 << 6) | c3;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if ((*from & 0xf8) == 0xf0)\n\t\t{\n\t\t\tif (len < 4)\n\t\t\t\tbreak;\t\t\t/* drop trailing incomplete char */\n\t\t\tc1 = *from++ & 0x07;\n\t\t\tc2 = *from++ & 0x3f;\n\t\t\tc3 = *from++ & 0x3f;\n\t\t\tc4 = *from++ & 0x3f;\n\t\t\t*to = (c1 << 18) | (c2 << 12) | (c3 << 6) | c4;\n\t\t\tlen -= 4;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t/* treat a bogus char as length 1; not ours to raise error */\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_utf2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\tuint32\t\tc1,\n\t\t\t\tc2,\n\t\t\t\tc3,\n\t\t\t\tc4;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif ((*from & 0x80) == 0)\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\telse if ((*from & 0xe0) == 0xc0)\n\t\t{\n\t\t\tif (len < 2)\n\t\t\t\tbreak;\t\t\t/* drop trailing incomplete char */\n\t\t\tc1 = *from++ & 0x1f;\n\t\t\tc2 = *from++ & 0x3f;\n\t\t\t*to = (c1 << 6) | c2;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse if ((*from & 0xf0) == 0xe0)\n\t\t{\n\t\t\tif (len < 3)\n\t\t\t\tbreak;\t\t\t/* drop trailing incomplete char */\n\t\t\tc1 = *from++ & 0x0f;\n\t\t\tc2 = *from++ & 0x3f;\n\t\t\tc3 = *from++ & 0x3f;\n\t\t\t*to = (c1 << 12) | (c2 << 6) | c3;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if ((*from & 0xf8) == 0xf0)\n\t\t{\n\t\t\tif (len < 4)\n\t\t\t\tbreak;\t\t\t/* drop trailing incomplete char */\n\t\t\tc1 = *from++ & 0x07;\n\t\t\tc2 = *from++ & 0x3f;\n\t\t\tc3 = *from++ & 0x3f;\n\t\t\tc4 = *from++ & 0x3f;\n\t\t\t*to = (c1 << 18) | (c2 << 12) | (c3 << 6) | c4;\n\t\t\tlen -= 4;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t/* treat a bogus char as length 1; not ours to raise error */\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  },
  {
    "function_name": "pg_johab_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "398-402",
    "snippet": "static int\npg_johab_dsplen(const unsigned char *s)\n{\n\treturn pg_euc_dsplen(s);\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_euc_dsplen",
          "args": [
            "s"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "pg_euc_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "129-143",
          "snippet": "static inline int\npg_euc_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 2;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic inline int\npg_euc_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 2;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_johab_dsplen(const unsigned char *s)\n{\n\treturn pg_euc_dsplen(s);\n}"
  },
  {
    "function_name": "pg_johab_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "392-396",
    "snippet": "static int\npg_johab_mblen(const unsigned char *s)\n{\n\treturn pg_euc_mblen(s);\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_euc_mblen",
          "args": [
            "s"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "pg_euc_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "113-127",
          "snippet": "static inline int\npg_euc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 3;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic inline int\npg_euc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 3;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_johab_mblen(const unsigned char *s)\n{\n\treturn pg_euc_mblen(s);\n}"
  },
  {
    "function_name": "pg_wchar2euc_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "346-386",
    "snippet": "static int\npg_wchar2euc_with_len(const pg_wchar *from, unsigned char *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tunsigned char c;\n\n\t\tif ((c = (*from >> 24)))\n\t\t{\n\t\t\t*to++ = c;\n\t\t\t*to++ = (*from >> 16) & 0xff;\n\t\t\t*to++ = (*from >> 8) & 0xff;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 4;\n\t\t}\n\t\telse if ((c = (*from >> 16)))\n\t\t{\n\t\t\t*to++ = c;\n\t\t\t*to++ = (*from >> 8) & 0xff;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 3;\n\t\t}\n\t\telse if ((c = (*from >> 8)))\n\t\t{\n\t\t\t*to++ = c;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 2;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t*to++ = *from;\n\t\t\tcnt++;\n\t\t}\n\t\tfrom++;\n\t\tlen--;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_wchar2euc_with_len(const pg_wchar *from, unsigned char *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tunsigned char c;\n\n\t\tif ((c = (*from >> 24)))\n\t\t{\n\t\t\t*to++ = c;\n\t\t\t*to++ = (*from >> 16) & 0xff;\n\t\t\t*to++ = (*from >> 8) & 0xff;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 4;\n\t\t}\n\t\telse if ((c = (*from >> 16)))\n\t\t{\n\t\t\t*to++ = c;\n\t\t\t*to++ = (*from >> 8) & 0xff;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 3;\n\t\t}\n\t\telse if ((c = (*from >> 8)))\n\t\t{\n\t\t\t*to++ = c;\n\t\t\t*to++ = *from & 0xff;\n\t\t\tcnt += 2;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t*to++ = *from;\n\t\t\tcnt++;\n\t\t}\n\t\tfrom++;\n\t\tlen--;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  },
  {
    "function_name": "pg_euctw_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "324-338",
    "snippet": "static int\npg_euctw_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 2;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_ascii_dsplen",
          "args": [
            "s"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "pg_ascii_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "60-69",
          "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euctw_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 2;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}"
  },
  {
    "function_name": "pg_euctw_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "308-322",
    "snippet": "static int\npg_euctw_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 4;\n\telse if (*s == SS3)\n\t\tlen = 3;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euctw_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 4;\n\telse if (*s == SS3)\n\t\tlen = 3;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}"
  },
  {
    "function_name": "pg_euctw2wchar_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "268-306",
    "snippet": "static int\npg_euctw2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (*from == SS2 && len >= 4)\t/* code set 2 */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (((uint32) SS2) << 24) | (*from++ << 16);\n\t\t\t*to |= *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 4;\n\t\t}\n\t\telse if (*from == SS3 && len >= 3)\t/* code set 3 (unused?) */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS3 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_HIGHBIT_SET(*from) && len >= 2) /* code set 2 */\n\t\t{\n\t\t\t*to = *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*from"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euctw2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (*from == SS2 && len >= 4)\t/* code set 2 */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (((uint32) SS2) << 24) | (*from++ << 16);\n\t\t\t*to |= *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 4;\n\t\t}\n\t\telse if (*from == SS3 && len >= 3)\t/* code set 3 (unused?) */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS3 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_HIGHBIT_SET(*from) && len >= 2) /* code set 2 */\n\t\t{\n\t\t\t*to = *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  },
  {
    "function_name": "pg_euccn_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "252-262",
    "snippet": "static int\npg_euccn_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_ascii_dsplen",
          "args": [
            "s"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "pg_ascii_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "60-69",
          "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euccn_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}"
  },
  {
    "function_name": "pg_euccn_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "240-250",
    "snippet": "static int\npg_euccn_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euccn_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}"
  },
  {
    "function_name": "pg_euccn2wchar_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "201-238",
    "snippet": "static int\npg_euccn2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (*from == SS2 && len >= 3)\t/* code set 2 (unused?) */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS2 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (*from == SS3 && len >= 3)\t/* code set 3 (unused ?) */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS3 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_HIGHBIT_SET(*from) && len >= 2) /* code set 1 */\n\t\t{\n\t\t\t*to = *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*from"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euccn2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (*from == SS2 && len >= 3)\t/* code set 2 (unused?) */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS2 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (*from == SS3 && len >= 3)\t/* code set 3 (unused ?) */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS3 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_HIGHBIT_SET(*from) && len >= 2) /* code set 1 */\n\t\t{\n\t\t\t*to = *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  },
  {
    "function_name": "pg_euckr_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "191-195",
    "snippet": "static int\npg_euckr_dsplen(const unsigned char *s)\n{\n\treturn pg_euc_dsplen(s);\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_euc_dsplen",
          "args": [
            "s"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "pg_euc_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "129-143",
          "snippet": "static inline int\npg_euc_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 2;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic inline int\npg_euc_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 2;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euckr_dsplen(const unsigned char *s)\n{\n\treturn pg_euc_dsplen(s);\n}"
  },
  {
    "function_name": "pg_euckr_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "185-189",
    "snippet": "static int\npg_euckr_mblen(const unsigned char *s)\n{\n\treturn pg_euc_mblen(s);\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_euc_mblen",
          "args": [
            "s"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "pg_euc_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "113-127",
          "snippet": "static inline int\npg_euc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 3;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic inline int\npg_euc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 3;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euckr_mblen(const unsigned char *s)\n{\n\treturn pg_euc_mblen(s);\n}"
  },
  {
    "function_name": "pg_euckr2wchar_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "179-183",
    "snippet": "static int\npg_euckr2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\treturn pg_euc2wchar_with_len(from, to, len);\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_euc2wchar_with_len",
          "args": [
            "from",
            "to",
            "len"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "pg_euc2wchar_with_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "74-111",
          "snippet": "static int\npg_euc2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (*from == SS2 && len >= 2)\t/* JIS X 0201 (so called \"1 byte\n\t\t\t\t\t\t\t\t\t\t * KANA\") */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS2 << 8) | *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse if (*from == SS3 && len >= 3)\t/* JIS X 0212 KANJI */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS3 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_HIGHBIT_SET(*from) && len >= 2) /* JIS X 0208 KANJI */\n\t\t{\n\t\t\t*to = *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse\t\t\t\t\t/* must be ASCII */\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euc2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (*from == SS2 && len >= 2)\t/* JIS X 0201 (so called \"1 byte\n\t\t\t\t\t\t\t\t\t\t * KANA\") */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS2 << 8) | *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse if (*from == SS3 && len >= 3)\t/* JIS X 0212 KANJI */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS3 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_HIGHBIT_SET(*from) && len >= 2) /* JIS X 0208 KANJI */\n\t\t{\n\t\t\t*to = *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse\t\t\t\t\t/* must be ASCII */\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euckr2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\treturn pg_euc2wchar_with_len(from, to, len);\n}"
  },
  {
    "function_name": "pg_eucjp_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "160-174",
    "snippet": "static int\npg_eucjp_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 1;\n\telse if (*s == SS3)\n\t\tlen = 2;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_ascii_dsplen",
          "args": [
            "s"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "pg_ascii_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "60-69",
          "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_eucjp_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 1;\n\telse if (*s == SS3)\n\t\tlen = 2;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}"
  },
  {
    "function_name": "pg_eucjp_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "154-158",
    "snippet": "static int\npg_eucjp_mblen(const unsigned char *s)\n{\n\treturn pg_euc_mblen(s);\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_euc_mblen",
          "args": [
            "s"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "pg_euc_mblen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "113-127",
          "snippet": "static inline int\npg_euc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 3;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic inline int\npg_euc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 3;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_eucjp_mblen(const unsigned char *s)\n{\n\treturn pg_euc_mblen(s);\n}"
  },
  {
    "function_name": "pg_eucjp2wchar_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "148-152",
    "snippet": "static int\npg_eucjp2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\treturn pg_euc2wchar_with_len(from, to, len);\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_euc2wchar_with_len",
          "args": [
            "from",
            "to",
            "len"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "pg_euc2wchar_with_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "74-111",
          "snippet": "static int\npg_euc2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (*from == SS2 && len >= 2)\t/* JIS X 0201 (so called \"1 byte\n\t\t\t\t\t\t\t\t\t\t * KANA\") */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS2 << 8) | *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse if (*from == SS3 && len >= 3)\t/* JIS X 0212 KANJI */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS3 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_HIGHBIT_SET(*from) && len >= 2) /* JIS X 0208 KANJI */\n\t\t{\n\t\t\t*to = *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse\t\t\t\t\t/* must be ASCII */\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euc2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (*from == SS2 && len >= 2)\t/* JIS X 0201 (so called \"1 byte\n\t\t\t\t\t\t\t\t\t\t * KANA\") */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS2 << 8) | *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse if (*from == SS3 && len >= 3)\t/* JIS X 0212 KANJI */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS3 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_HIGHBIT_SET(*from) && len >= 2) /* JIS X 0208 KANJI */\n\t\t{\n\t\t\t*to = *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse\t\t\t\t\t/* must be ASCII */\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_eucjp2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\treturn pg_euc2wchar_with_len(from, to, len);\n}"
  },
  {
    "function_name": "pg_euc_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "129-143",
    "snippet": "static inline int\npg_euc_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 2;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_ascii_dsplen",
          "args": [
            "s"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "pg_ascii_dsplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "60-69",
          "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic inline int\npg_euc_dsplen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 2;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = pg_ascii_dsplen(s);\n\treturn len;\n}"
  },
  {
    "function_name": "pg_euc_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "113-127",
    "snippet": "static inline int\npg_euc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 3;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*s"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic inline int\npg_euc_mblen(const unsigned char *s)\n{\n\tint\t\t\tlen;\n\n\tif (*s == SS2)\n\t\tlen = 2;\n\telse if (*s == SS3)\n\t\tlen = 3;\n\telse if (IS_HIGHBIT_SET(*s))\n\t\tlen = 2;\n\telse\n\t\tlen = 1;\n\treturn len;\n}"
  },
  {
    "function_name": "pg_euc2wchar_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "74-111",
    "snippet": "static int\npg_euc2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (*from == SS2 && len >= 2)\t/* JIS X 0201 (so called \"1 byte\n\t\t\t\t\t\t\t\t\t\t * KANA\") */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS2 << 8) | *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse if (*from == SS3 && len >= 3)\t/* JIS X 0212 KANJI */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS3 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_HIGHBIT_SET(*from) && len >= 2) /* JIS X 0208 KANJI */\n\t\t{\n\t\t\t*to = *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse\t\t\t\t\t/* must be ASCII */\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "*from"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_euc2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\tif (*from == SS2 && len >= 2)\t/* JIS X 0201 (so called \"1 byte\n\t\t\t\t\t\t\t\t\t\t * KANA\") */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS2 << 8) | *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse if (*from == SS3 && len >= 3)\t/* JIS X 0212 KANJI */\n\t\t{\n\t\t\tfrom++;\n\t\t\t*to = (SS3 << 16) | (*from++ << 8);\n\t\t\t*to |= *from++;\n\t\t\tlen -= 3;\n\t\t}\n\t\telse if (IS_HIGHBIT_SET(*from) && len >= 2) /* JIS X 0208 KANJI */\n\t\t{\n\t\t\t*to = *from++ << 8;\n\t\t\t*to |= *from++;\n\t\t\tlen -= 2;\n\t\t}\n\t\telse\t\t\t\t\t/* must be ASCII */\n\t\t{\n\t\t\t*to = *from++;\n\t\t\tlen--;\n\t\t}\n\t\tto++;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  },
  {
    "function_name": "pg_ascii_dsplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "60-69",
    "snippet": "static int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_dsplen(const unsigned char *s)\n{\n\tif (*s == '\\0')\n\t\treturn 0;\n\tif (*s < 0x20 || *s == 0x7f)\n\t\treturn -1;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "pg_ascii_mblen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "54-58",
    "snippet": "static int\npg_ascii_mblen(const unsigned char *s)\n{\n\treturn 1;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii_mblen(const unsigned char *s)\n{\n\treturn 1;\n}"
  },
  {
    "function_name": "pg_ascii2wchar_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
    "lines": "39-52",
    "snippet": "static int\npg_ascii2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\t*to++ = *from++;\n\t\tlen--;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\"",
      "#include \"postgres_fe.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic int\npg_ascii2wchar_with_len(const unsigned char *from, pg_wchar *to, int len)\n{\n\tint\t\t\tcnt = 0;\n\n\twhile (len > 0 && *from)\n\t{\n\t\t*to++ = *from++;\n\t\tlen--;\n\t\tcnt++;\n\t}\n\t*to = 0;\n\treturn cnt;\n}"
  }
]