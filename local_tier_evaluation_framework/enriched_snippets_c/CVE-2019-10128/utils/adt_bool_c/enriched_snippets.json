[
  {
    "function_name": "bool_anytrue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "391-404",
    "snippet": "Datum\nbool_anytrue(PG_FUNCTION_ARGS)\n{\n\tBoolAggState *state;\n\n\tstate = PG_ARGISNULL(0) ? NULL : (BoolAggState *) PG_GETARG_POINTER(0);\n\n\t/* if there were no non-null values, return NULL */\n\tif (state == NULL || state->aggcount == 0)\n\t\tPG_RETURN_NULL();\n\n\t/* true if any non-null value is true */\n\tPG_RETURN_BOOL(state->aggtrue > 0);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "state->aggtrue > 0"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_ARGISNULL",
          "args": [
            "0"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nbool_anytrue(PG_FUNCTION_ARGS)\n{\n\tBoolAggState *state;\n\n\tstate = PG_ARGISNULL(0) ? NULL : (BoolAggState *) PG_GETARG_POINTER(0);\n\n\t/* if there were no non-null values, return NULL */\n\tif (state == NULL || state->aggcount == 0)\n\t\tPG_RETURN_NULL();\n\n\t/* true if any non-null value is true */\n\tPG_RETURN_BOOL(state->aggtrue > 0);\n}"
  },
  {
    "function_name": "bool_alltrue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "376-389",
    "snippet": "Datum\nbool_alltrue(PG_FUNCTION_ARGS)\n{\n\tBoolAggState *state;\n\n\tstate = PG_ARGISNULL(0) ? NULL : (BoolAggState *) PG_GETARG_POINTER(0);\n\n\t/* if there were no non-null values, return NULL */\n\tif (state == NULL || state->aggcount == 0)\n\t\tPG_RETURN_NULL();\n\n\t/* true if all non-null values are true */\n\tPG_RETURN_BOOL(state->aggtrue == state->aggcount);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "state->aggtrue == state->aggcount"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_ARGISNULL",
          "args": [
            "0"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nbool_alltrue(PG_FUNCTION_ARGS)\n{\n\tBoolAggState *state;\n\n\tstate = PG_ARGISNULL(0) ? NULL : (BoolAggState *) PG_GETARG_POINTER(0);\n\n\t/* if there were no non-null values, return NULL */\n\tif (state == NULL || state->aggcount == 0)\n\t\tPG_RETURN_NULL();\n\n\t/* true if all non-null values are true */\n\tPG_RETURN_BOOL(state->aggtrue == state->aggcount);\n}"
  },
  {
    "function_name": "bool_accum_inv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "355-374",
    "snippet": "Datum\nbool_accum_inv(PG_FUNCTION_ARGS)\n{\n\tBoolAggState *state;\n\n\tstate = PG_ARGISNULL(0) ? NULL : (BoolAggState *) PG_GETARG_POINTER(0);\n\n\t/* bool_accum should have created the state data */\n\tif (state == NULL)\n\t\telog(ERROR, \"bool_accum_inv called with NULL state\");\n\n\tif (!PG_ARGISNULL(1))\n\t{\n\t\tstate->aggcount--;\n\t\tif (PG_GETARG_BOOL(1))\n\t\t\tstate->aggtrue--;\n\t}\n\n\tPG_RETURN_POINTER(state);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "state"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "1"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_ARGISNULL",
          "args": [
            "1"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"bool_accum_inv called with NULL state\""
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_ARGISNULL",
          "args": [
            "0"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nbool_accum_inv(PG_FUNCTION_ARGS)\n{\n\tBoolAggState *state;\n\n\tstate = PG_ARGISNULL(0) ? NULL : (BoolAggState *) PG_GETARG_POINTER(0);\n\n\t/* bool_accum should have created the state data */\n\tif (state == NULL)\n\t\telog(ERROR, \"bool_accum_inv called with NULL state\");\n\n\tif (!PG_ARGISNULL(1))\n\t{\n\t\tstate->aggcount--;\n\t\tif (PG_GETARG_BOOL(1))\n\t\t\tstate->aggtrue--;\n\t}\n\n\tPG_RETURN_POINTER(state);\n}"
  },
  {
    "function_name": "bool_accum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "334-353",
    "snippet": "Datum\nbool_accum(PG_FUNCTION_ARGS)\n{\n\tBoolAggState *state;\n\n\tstate = PG_ARGISNULL(0) ? NULL : (BoolAggState *) PG_GETARG_POINTER(0);\n\n\t/* Create the state data on first call */\n\tif (state == NULL)\n\t\tstate = makeBoolAggState(fcinfo);\n\n\tif (!PG_ARGISNULL(1))\n\t{\n\t\tstate->aggcount++;\n\t\tif (PG_GETARG_BOOL(1))\n\t\t\tstate->aggtrue++;\n\t}\n\n\tPG_RETURN_POINTER(state);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "state"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "1"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_ARGISNULL",
          "args": [
            "1"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeBoolAggState",
          "args": [
            "fcinfo"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "makeBoolAggState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
          "lines": "317-332",
          "snippet": "static BoolAggState *\nmakeBoolAggState(FunctionCallInfo fcinfo)\n{\n\tBoolAggState *state;\n\tMemoryContext agg_context;\n\n\tif (!AggCheckCallContext(fcinfo, &agg_context))\n\t\telog(ERROR, \"aggregate function called in non-aggregate context\");\n\n\tstate = (BoolAggState *) MemoryContextAlloc(agg_context,\n\t\t\t\t\t\t\t\t\t\t\t\tsizeof(BoolAggState));\n\tstate->aggcount = 0;\n\tstate->aggtrue = 0;\n\n\treturn state;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic BoolAggState *\nmakeBoolAggState(FunctionCallInfo fcinfo)\n{\n\tBoolAggState *state;\n\tMemoryContext agg_context;\n\n\tif (!AggCheckCallContext(fcinfo, &agg_context))\n\t\telog(ERROR, \"aggregate function called in non-aggregate context\");\n\n\tstate = (BoolAggState *) MemoryContextAlloc(agg_context,\n\t\t\t\t\t\t\t\t\t\t\t\tsizeof(BoolAggState));\n\tstate->aggcount = 0;\n\tstate->aggtrue = 0;\n\n\treturn state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_ARGISNULL",
          "args": [
            "0"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nbool_accum(PG_FUNCTION_ARGS)\n{\n\tBoolAggState *state;\n\n\tstate = PG_ARGISNULL(0) ? NULL : (BoolAggState *) PG_GETARG_POINTER(0);\n\n\t/* Create the state data on first call */\n\tif (state == NULL)\n\t\tstate = makeBoolAggState(fcinfo);\n\n\tif (!PG_ARGISNULL(1))\n\t{\n\t\tstate->aggcount++;\n\t\tif (PG_GETARG_BOOL(1))\n\t\t\tstate->aggtrue++;\n\t}\n\n\tPG_RETURN_POINTER(state);\n}"
  },
  {
    "function_name": "makeBoolAggState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "317-332",
    "snippet": "static BoolAggState *\nmakeBoolAggState(FunctionCallInfo fcinfo)\n{\n\tBoolAggState *state;\n\tMemoryContext agg_context;\n\n\tif (!AggCheckCallContext(fcinfo, &agg_context))\n\t\telog(ERROR, \"aggregate function called in non-aggregate context\");\n\n\tstate = (BoolAggState *) MemoryContextAlloc(agg_context,\n\t\t\t\t\t\t\t\t\t\t\t\tsizeof(BoolAggState));\n\tstate->aggcount = 0;\n\tstate->aggtrue = 0;\n\n\treturn state;\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MemoryContextAlloc",
          "args": [
            "agg_context",
            "sizeof(BoolAggState)"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "MemoryContextAllocHuge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "1079-1106",
          "snippet": "void *\nMemoryContextAllocHuge(MemoryContext context, Size size)\n{\n\tvoid\t   *ret;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocHugeSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\nMemoryContextAllocHuge(MemoryContext context, Size size)\n{\n\tvoid\t   *ret;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocHugeSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"aggregate function called in non-aggregate context\""
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "AggCheckCallContext",
          "args": [
            "fcinfo",
            "&agg_context"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic BoolAggState *\nmakeBoolAggState(FunctionCallInfo fcinfo)\n{\n\tBoolAggState *state;\n\tMemoryContext agg_context;\n\n\tif (!AggCheckCallContext(fcinfo, &agg_context))\n\t\telog(ERROR, \"aggregate function called in non-aggregate context\");\n\n\tstate = (BoolAggState *) MemoryContextAlloc(agg_context,\n\t\t\t\t\t\t\t\t\t\t\t\tsizeof(BoolAggState));\n\tstate->aggcount = 0;\n\tstate->aggtrue = 0;\n\n\treturn state;\n}"
  },
  {
    "function_name": "boolor_statefunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "305-309",
    "snippet": "Datum\nboolor_statefunc(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_BOOL(PG_GETARG_BOOL(0) || PG_GETARG_BOOL(1));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "PG_GETARG_BOOL(0) || PG_GETARG_BOOL(1)"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "1"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nboolor_statefunc(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_BOOL(PG_GETARG_BOOL(0) || PG_GETARG_BOOL(1));\n}"
  },
  {
    "function_name": "booland_statefunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "293-297",
    "snippet": "Datum\nbooland_statefunc(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_BOOL(PG_GETARG_BOOL(0) && PG_GETARG_BOOL(1));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "PG_GETARG_BOOL(0) && PG_GETARG_BOOL(1)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "1"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nbooland_statefunc(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_BOOL(PG_GETARG_BOOL(0) && PG_GETARG_BOOL(1));\n}"
  },
  {
    "function_name": "boolge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "274-281",
    "snippet": "Datum\nboolge(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 >= arg2);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "arg1 >= arg2"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "1"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nboolge(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 >= arg2);\n}"
  },
  {
    "function_name": "boolle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "265-272",
    "snippet": "Datum\nboolle(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 <= arg2);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "arg1 <= arg2"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "1"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nboolle(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 <= arg2);\n}"
  },
  {
    "function_name": "boolgt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "256-263",
    "snippet": "Datum\nboolgt(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 > arg2);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "arg1 > arg2"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "1"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nboolgt(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 > arg2);\n}"
  },
  {
    "function_name": "boollt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "247-254",
    "snippet": "Datum\nboollt(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 < arg2);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "arg1 < arg2"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "1"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nboollt(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 < arg2);\n}"
  },
  {
    "function_name": "boolne",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "238-245",
    "snippet": "Datum\nboolne(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 != arg2);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "arg1 != arg2"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "1"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nboolne(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 != arg2);\n}"
  },
  {
    "function_name": "booleq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "229-236",
    "snippet": "Datum\nbooleq(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 == arg2);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "arg1 == arg2"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "1"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nbooleq(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tbool\t\targ2 = PG_GETARG_BOOL(1);\n\n\tPG_RETURN_BOOL(arg1 == arg2);\n}"
  },
  {
    "function_name": "booltext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "210-222",
    "snippet": "Datum\nbooltext(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tconst char *str;\n\n\tif (arg1)\n\t\tstr = \"true\";\n\telse\n\t\tstr = \"false\";\n\n\tPG_RETURN_TEXT_P(cstring_to_text(str));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "cstring_to_text(str)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cstring_to_text",
          "args": [
            "str"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "cstring_to_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "148-152",
          "snippet": "text *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\ntext *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nbooltext(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tconst char *str;\n\n\tif (arg1)\n\t\tstr = \"true\";\n\telse\n\t\tstr = \"false\";\n\n\tPG_RETURN_TEXT_P(cstring_to_text(str));\n}"
  },
  {
    "function_name": "boolsend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "193-202",
    "snippet": "Datum\nboolsend(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendbyte(&buf, arg1 ? 1 : 0);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BYTEA_P",
          "args": [
            "pq_endtypsend(&buf)"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_endtypsend",
          "args": [
            "&buf"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "arg1 ? 1 : 0"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_begintypsend",
          "args": [
            "&buf"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nboolsend(PG_FUNCTION_ARGS)\n{\n\tbool\t\targ1 = PG_GETARG_BOOL(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendbyte(&buf, arg1 ? 1 : 0);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}"
  },
  {
    "function_name": "boolrecv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "180-188",
    "snippet": "Datum\nboolrecv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\tint\t\t\text;\n\n\text = pq_getmsgbyte(buf);\n\tPG_RETURN_BOOL((ext != 0) ? true : false);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "(ext != 0) ? true : false"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nboolrecv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\tint\t\t\text;\n\n\text = pq_getmsgbyte(buf);\n\tPG_RETURN_BOOL((ext != 0) ? true : false);\n}"
  },
  {
    "function_name": "boolout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "163-172",
    "snippet": "Datum\nboolout(PG_FUNCTION_ARGS)\n{\n\tbool\t\tb = PG_GETARG_BOOL(0);\n\tchar\t   *result = (char *) palloc(2);\n\n\tresult[0] = (b) ? 't' : 'f';\n\tresult[1] = '\\0';\n\tPG_RETURN_CSTRING(result);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_CSTRING",
          "args": [
            "result"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "2"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "0"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nboolout(PG_FUNCTION_ARGS)\n{\n\tbool\t\tb = PG_GETARG_BOOL(0);\n\tchar\t   *result = (char *) palloc(2);\n\n\tresult[0] = (b) ? 't' : 'f';\n\tresult[1] = '\\0';\n\tPG_RETURN_CSTRING(result);\n}"
  },
  {
    "function_name": "boolin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "129-158",
    "snippet": "Datum\nboolin(PG_FUNCTION_ARGS)\n{\n\tconst char *in_str = PG_GETARG_CSTRING(0);\n\tconst char *str;\n\tsize_t\t\tlen;\n\tbool\t\tresult;\n\n\t/*\n\t * Skip leading and trailing whitespace\n\t */\n\tstr = in_str;\n\twhile (isspace((unsigned char) *str))\n\t\tstr++;\n\n\tlen = strlen(str);\n\twhile (len > 0 && isspace((unsigned char) str[len - 1]))\n\t\tlen--;\n\n\tif (parse_bool_with_len(str, len, &result))\n\t\tPG_RETURN_BOOL(result);\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\"boolean\", in_str)));\n\n\t/* not reached */\n\tPG_RETURN_BOOL(false);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "false"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\"boolean\", in_str))"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid input syntax for type %s: \\\"%s\\\"\"",
            "\"boolean\"",
            "in_str"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_TEXT_REPRESENTATION"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "result"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_bool_with_len",
          "args": [
            "str",
            "len",
            "&result"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "parse_bool_with_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
          "lines": "35-115",
          "snippet": "bool\nparse_bool_with_len(const char *value, size_t len, bool *result)\n{\n\tswitch (*value)\n\t{\n\t\tcase 't':\n\t\tcase 'T':\n\t\t\tif (pg_strncasecmp(value, \"true\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'f':\n\t\tcase 'F':\n\t\t\tif (pg_strncasecmp(value, \"false\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'y':\n\t\tcase 'Y':\n\t\t\tif (pg_strncasecmp(value, \"yes\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'n':\n\t\tcase 'N':\n\t\t\tif (pg_strncasecmp(value, \"no\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'o':\n\t\tcase 'O':\n\t\t\t/* 'o' is not unique enough */\n\t\t\tif (pg_strncasecmp(value, \"on\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (pg_strncasecmp(value, \"off\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '1':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '0':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\tif (result)\n\t\t*result = false;\t\t/* suppress compiler warning */\n\treturn false;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\nparse_bool_with_len(const char *value, size_t len, bool *result)\n{\n\tswitch (*value)\n\t{\n\t\tcase 't':\n\t\tcase 'T':\n\t\t\tif (pg_strncasecmp(value, \"true\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'f':\n\t\tcase 'F':\n\t\t\tif (pg_strncasecmp(value, \"false\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'y':\n\t\tcase 'Y':\n\t\t\tif (pg_strncasecmp(value, \"yes\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'n':\n\t\tcase 'N':\n\t\t\tif (pg_strncasecmp(value, \"no\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'o':\n\t\tcase 'O':\n\t\t\t/* 'o' is not unique enough */\n\t\t\tif (pg_strncasecmp(value, \"on\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (pg_strncasecmp(value, \"off\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '1':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '0':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\tif (result)\n\t\t*result = false;\t\t/* suppress compiler warning */\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "(unsigned char) str[len - 1]"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "array_isspace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/arrayfuncs.c",
          "lines": "431-442",
          "snippet": "static bool\narray_isspace(char ch)\n{\n\tif (ch == ' ' ||\n\t\tch == '\\t' ||\n\t\tch == '\\n' ||\n\t\tch == '\\r' ||\n\t\tch == '\\v' ||\n\t\tch == '\\f')\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/arrayaccess.h\"",
            "#include \"utils/array.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"funcapi.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <math.h>",
            "#include <float.h>\t\t\t\t/* for _isnan */",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool array_isspace(char ch);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"utils/arrayaccess.h\"\n#include \"utils/array.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <math.h>\n#include <float.h>\t\t\t\t/* for _isnan */\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool array_isspace(char ch);\n\nstatic bool\narray_isspace(char ch)\n{\n\tif (ch == ' ' ||\n\t\tch == '\\t' ||\n\t\tch == '\\n' ||\n\t\tch == '\\r' ||\n\t\tch == '\\v' ||\n\t\tch == '\\f')\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "calcstrlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_cleanup.c",
          "lines": "361-380",
          "snippet": "static int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nstatic int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "0"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nboolin(PG_FUNCTION_ARGS)\n{\n\tconst char *in_str = PG_GETARG_CSTRING(0);\n\tconst char *str;\n\tsize_t\t\tlen;\n\tbool\t\tresult;\n\n\t/*\n\t * Skip leading and trailing whitespace\n\t */\n\tstr = in_str;\n\twhile (isspace((unsigned char) *str))\n\t\tstr++;\n\n\tlen = strlen(str);\n\twhile (len > 0 && isspace((unsigned char) str[len - 1]))\n\t\tlen--;\n\n\tif (parse_bool_with_len(str, len, &result))\n\t\tPG_RETURN_BOOL(result);\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\"boolean\", in_str)));\n\n\t/* not reached */\n\tPG_RETURN_BOOL(false);\n}"
  },
  {
    "function_name": "parse_bool_with_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "35-115",
    "snippet": "bool\nparse_bool_with_len(const char *value, size_t len, bool *result)\n{\n\tswitch (*value)\n\t{\n\t\tcase 't':\n\t\tcase 'T':\n\t\t\tif (pg_strncasecmp(value, \"true\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'f':\n\t\tcase 'F':\n\t\t\tif (pg_strncasecmp(value, \"false\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'y':\n\t\tcase 'Y':\n\t\t\tif (pg_strncasecmp(value, \"yes\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'n':\n\t\tcase 'N':\n\t\t\tif (pg_strncasecmp(value, \"no\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'o':\n\t\tcase 'O':\n\t\t\t/* 'o' is not unique enough */\n\t\t\tif (pg_strncasecmp(value, \"on\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (pg_strncasecmp(value, \"off\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '1':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '0':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\tif (result)\n\t\t*result = false;\t\t/* suppress compiler warning */\n\treturn false;\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_strncasecmp",
          "args": [
            "value",
            "\"off\"",
            "(len > 2 ? len : 2)"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strncasecmp",
          "args": [
            "value",
            "\"on\"",
            "(len > 2 ? len : 2)"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strncasecmp",
          "args": [
            "value",
            "\"no\"",
            "len"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strncasecmp",
          "args": [
            "value",
            "\"yes\"",
            "len"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strncasecmp",
          "args": [
            "value",
            "\"false\"",
            "len"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strncasecmp",
          "args": [
            "value",
            "\"true\"",
            "len"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\nparse_bool_with_len(const char *value, size_t len, bool *result)\n{\n\tswitch (*value)\n\t{\n\t\tcase 't':\n\t\tcase 'T':\n\t\t\tif (pg_strncasecmp(value, \"true\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'f':\n\t\tcase 'F':\n\t\t\tif (pg_strncasecmp(value, \"false\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'y':\n\t\tcase 'Y':\n\t\t\tif (pg_strncasecmp(value, \"yes\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'n':\n\t\tcase 'N':\n\t\t\tif (pg_strncasecmp(value, \"no\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'o':\n\t\tcase 'O':\n\t\t\t/* 'o' is not unique enough */\n\t\t\tif (pg_strncasecmp(value, \"on\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (pg_strncasecmp(value, \"off\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '1':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '0':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\tif (result)\n\t\t*result = false;\t\t/* suppress compiler warning */\n\treturn false;\n}"
  },
  {
    "function_name": "parse_bool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
    "lines": "29-33",
    "snippet": "bool\nparse_bool(const char *value, bool *result)\n{\n\treturn parse_bool_with_len(value, strlen(value), result);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_bool_with_len",
          "args": [
            "value",
            "strlen(value)",
            "result"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "parse_bool_with_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/bool.c",
          "lines": "35-115",
          "snippet": "bool\nparse_bool_with_len(const char *value, size_t len, bool *result)\n{\n\tswitch (*value)\n\t{\n\t\tcase 't':\n\t\tcase 'T':\n\t\t\tif (pg_strncasecmp(value, \"true\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'f':\n\t\tcase 'F':\n\t\t\tif (pg_strncasecmp(value, \"false\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'y':\n\t\tcase 'Y':\n\t\t\tif (pg_strncasecmp(value, \"yes\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'n':\n\t\tcase 'N':\n\t\t\tif (pg_strncasecmp(value, \"no\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'o':\n\t\tcase 'O':\n\t\t\t/* 'o' is not unique enough */\n\t\t\tif (pg_strncasecmp(value, \"on\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (pg_strncasecmp(value, \"off\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '1':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '0':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\tif (result)\n\t\t*result = false;\t\t/* suppress compiler warning */\n\treturn false;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\nparse_bool_with_len(const char *value, size_t len, bool *result)\n{\n\tswitch (*value)\n\t{\n\t\tcase 't':\n\t\tcase 'T':\n\t\t\tif (pg_strncasecmp(value, \"true\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'f':\n\t\tcase 'F':\n\t\t\tif (pg_strncasecmp(value, \"false\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'y':\n\t\tcase 'Y':\n\t\t\tif (pg_strncasecmp(value, \"yes\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'n':\n\t\tcase 'N':\n\t\t\tif (pg_strncasecmp(value, \"no\", len) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'o':\n\t\tcase 'O':\n\t\t\t/* 'o' is not unique enough */\n\t\t\tif (pg_strncasecmp(value, \"on\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (pg_strncasecmp(value, \"off\", (len > 2 ? len : 2)) == 0)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '1':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '0':\n\t\t\tif (len == 1)\n\t\t\t{\n\t\t\t\tif (result)\n\t\t\t\t\t*result = false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\tif (result)\n\t\t*result = false;\t\t/* suppress compiler warning */\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "calcstrlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_cleanup.c",
          "lines": "361-380",
          "snippet": "static int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nstatic int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\nparse_bool(const char *value, bool *result)\n{\n\treturn parse_bool_with_len(value, strlen(value), result);\n}"
  }
]