[
  {
    "function_name": "cideq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "203-210",
    "snippet": "Datum\ncideq(PG_FUNCTION_ARGS)\n{\n\tCommandId\targ1 = PG_GETARG_COMMANDID(0);\n\tCommandId\targ2 = PG_GETARG_COMMANDID(1);\n\n\tPG_RETURN_BOOL(arg1 == arg2);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "arg1 == arg2"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_COMMANDID",
          "args": [
            "1"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_COMMANDID",
          "args": [
            "0"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\ncideq(PG_FUNCTION_ARGS)\n{\n\tCommandId\targ1 = PG_GETARG_COMMANDID(0);\n\tCommandId\targ2 = PG_GETARG_COMMANDID(1);\n\n\tPG_RETURN_BOOL(arg1 == arg2);\n}"
  },
  {
    "function_name": "cidsend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "192-201",
    "snippet": "Datum\ncidsend(PG_FUNCTION_ARGS)\n{\n\tCommandId\targ1 = PG_GETARG_COMMANDID(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendint32(&buf, arg1);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BYTEA_P",
          "args": [
            "pq_endtypsend(&buf)"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_endtypsend",
          "args": [
            "&buf"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendint32",
          "args": [
            "&buf",
            "arg1"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_begintypsend",
          "args": [
            "&buf"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_COMMANDID",
          "args": [
            "0"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\ncidsend(PG_FUNCTION_ARGS)\n{\n\tCommandId\targ1 = PG_GETARG_COMMANDID(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendint32(&buf, arg1);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}"
  },
  {
    "function_name": "cidrecv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "181-187",
    "snippet": "Datum\ncidrecv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\n\tPG_RETURN_COMMANDID((CommandId) pq_getmsgint(buf, sizeof(CommandId)));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_COMMANDID",
          "args": [
            "(CommandId) pq_getmsgint(buf, sizeof(CommandId))"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgint",
          "args": [
            "buf",
            "sizeof(CommandId)"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\ncidrecv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\n\tPG_RETURN_COMMANDID((CommandId) pq_getmsgint(buf, sizeof(CommandId)));\n}"
  },
  {
    "function_name": "cidout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "168-176",
    "snippet": "Datum\ncidout(PG_FUNCTION_ARGS)\n{\n\tCommandId\tc = PG_GETARG_COMMANDID(0);\n\tchar\t   *result = (char *) palloc(16);\n\n\tsnprintf(result, 16, \"%lu\", (unsigned long) c);\n\tPG_RETURN_CSTRING(result);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_CSTRING",
          "args": [
            "result"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "result",
            "16",
            "\"%lu\"",
            "(unsigned long) c"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "16"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_COMMANDID",
          "args": [
            "0"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\ncidout(PG_FUNCTION_ARGS)\n{\n\tCommandId\tc = PG_GETARG_COMMANDID(0);\n\tchar\t   *result = (char *) palloc(16);\n\n\tsnprintf(result, 16, \"%lu\", (unsigned long) c);\n\tPG_RETURN_CSTRING(result);\n}"
  },
  {
    "function_name": "cidin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "157-163",
    "snippet": "Datum\ncidin(PG_FUNCTION_ARGS)\n{\n\tchar\t   *str = PG_GETARG_CSTRING(0);\n\n\tPG_RETURN_COMMANDID((CommandId) strtoul(str, NULL, 0));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_COMMANDID",
          "args": [
            "(CommandId) strtoul(str, NULL, 0)"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "str",
            "NULL",
            "0"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "0"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\ncidin(PG_FUNCTION_ARGS)\n{\n\tchar\t   *str = PG_GETARG_CSTRING(0);\n\n\tPG_RETURN_COMMANDID((CommandId) strtoul(str, NULL, 0));\n}"
  },
  {
    "function_name": "xidComparator",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "137-148",
    "snippet": "int\nxidComparator(const void *arg1, const void *arg2)\n{\n\tTransactionId xid1 = *(const TransactionId *) arg1;\n\tTransactionId xid2 = *(const TransactionId *) arg2;\n\n\tif (xid1 > xid2)\n\t\treturn 1;\n\tif (xid1 < xid2)\n\t\treturn -1;\n\treturn 0;\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nint\nxidComparator(const void *arg1, const void *arg2)\n{\n\tTransactionId xid1 = *(const TransactionId *) arg1;\n\tTransactionId xid2 = *(const TransactionId *) arg2;\n\n\tif (xid1 > xid2)\n\t\treturn 1;\n\tif (xid1 < xid2)\n\t\treturn -1;\n\treturn 0;\n}"
  },
  {
    "function_name": "mxid_age",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "118-128",
    "snippet": "Datum\nmxid_age(PG_FUNCTION_ARGS)\n{\n\tTransactionId xid = PG_GETARG_TRANSACTIONID(0);\n\tMultiXactId now = ReadNextMultiXactId();\n\n\tif (!MultiXactIdIsValid(xid))\n\t\tPG_RETURN_INT32(INT_MAX);\n\n\tPG_RETURN_INT32((int32) (now - xid));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "(int32) (now - xid)"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "now - xid"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "INT_MAX"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MultiXactIdIsValid",
          "args": [
            "xid"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReadNextMultiXactId",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TRANSACTIONID",
          "args": [
            "0"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\nmxid_age(PG_FUNCTION_ARGS)\n{\n\tTransactionId xid = PG_GETARG_TRANSACTIONID(0);\n\tMultiXactId now = ReadNextMultiXactId();\n\n\tif (!MultiXactIdIsValid(xid))\n\t\tPG_RETURN_INT32(INT_MAX);\n\n\tPG_RETURN_INT32((int32) (now - xid));\n}"
  },
  {
    "function_name": "xid_age",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "102-113",
    "snippet": "Datum\nxid_age(PG_FUNCTION_ARGS)\n{\n\tTransactionId xid = PG_GETARG_TRANSACTIONID(0);\n\tTransactionId now = GetStableLatestTransactionId();\n\n\t/* Permanent XIDs are always infinitely old */\n\tif (!TransactionIdIsNormal(xid))\n\t\tPG_RETURN_INT32(INT_MAX);\n\n\tPG_RETURN_INT32((int32) (now - xid));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "(int32) (now - xid)"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "now - xid"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "INT_MAX"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdIsNormal",
          "args": [
            "xid"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetStableLatestTransactionId",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TRANSACTIONID",
          "args": [
            "0"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\nxid_age(PG_FUNCTION_ARGS)\n{\n\tTransactionId xid = PG_GETARG_TRANSACTIONID(0);\n\tTransactionId now = GetStableLatestTransactionId();\n\n\t/* Permanent XIDs are always infinitely old */\n\tif (!TransactionIdIsNormal(xid))\n\t\tPG_RETURN_INT32(INT_MAX);\n\n\tPG_RETURN_INT32((int32) (now - xid));\n}"
  },
  {
    "function_name": "xidneq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "90-97",
    "snippet": "Datum\nxidneq(PG_FUNCTION_ARGS)\n{\n\tTransactionId xid1 = PG_GETARG_TRANSACTIONID(0);\n\tTransactionId xid2 = PG_GETARG_TRANSACTIONID(1);\n\n\tPG_RETURN_BOOL(!TransactionIdEquals(xid1, xid2));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "!TransactionIdEquals(xid1, xid2)"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdEquals",
          "args": [
            "xid1",
            "xid2"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TRANSACTIONID",
          "args": [
            "1"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TRANSACTIONID",
          "args": [
            "0"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\nxidneq(PG_FUNCTION_ARGS)\n{\n\tTransactionId xid1 = PG_GETARG_TRANSACTIONID(0);\n\tTransactionId xid2 = PG_GETARG_TRANSACTIONID(1);\n\n\tPG_RETURN_BOOL(!TransactionIdEquals(xid1, xid2));\n}"
  },
  {
    "function_name": "xideq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "78-85",
    "snippet": "Datum\nxideq(PG_FUNCTION_ARGS)\n{\n\tTransactionId xid1 = PG_GETARG_TRANSACTIONID(0);\n\tTransactionId xid2 = PG_GETARG_TRANSACTIONID(1);\n\n\tPG_RETURN_BOOL(TransactionIdEquals(xid1, xid2));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "TransactionIdEquals(xid1, xid2)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdEquals",
          "args": [
            "xid1",
            "xid2"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TRANSACTIONID",
          "args": [
            "1"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TRANSACTIONID",
          "args": [
            "0"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\nxideq(PG_FUNCTION_ARGS)\n{\n\tTransactionId xid1 = PG_GETARG_TRANSACTIONID(0);\n\tTransactionId xid2 = PG_GETARG_TRANSACTIONID(1);\n\n\tPG_RETURN_BOOL(TransactionIdEquals(xid1, xid2));\n}"
  },
  {
    "function_name": "xidsend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "64-73",
    "snippet": "Datum\nxidsend(PG_FUNCTION_ARGS)\n{\n\tTransactionId arg1 = PG_GETARG_TRANSACTIONID(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendint32(&buf, arg1);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BYTEA_P",
          "args": [
            "pq_endtypsend(&buf)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_endtypsend",
          "args": [
            "&buf"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendint32",
          "args": [
            "&buf",
            "arg1"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_begintypsend",
          "args": [
            "&buf"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TRANSACTIONID",
          "args": [
            "0"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\nxidsend(PG_FUNCTION_ARGS)\n{\n\tTransactionId arg1 = PG_GETARG_TRANSACTIONID(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendint32(&buf, arg1);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}"
  },
  {
    "function_name": "xidrecv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "53-59",
    "snippet": "Datum\nxidrecv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\n\tPG_RETURN_TRANSACTIONID((TransactionId) pq_getmsgint(buf, sizeof(TransactionId)));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TRANSACTIONID",
          "args": [
            "(TransactionId) pq_getmsgint(buf, sizeof(TransactionId))"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgint",
          "args": [
            "buf",
            "sizeof(TransactionId)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\nxidrecv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\n\tPG_RETURN_TRANSACTIONID((TransactionId) pq_getmsgint(buf, sizeof(TransactionId)));\n}"
  },
  {
    "function_name": "xidout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "40-48",
    "snippet": "Datum\nxidout(PG_FUNCTION_ARGS)\n{\n\tTransactionId transactionId = PG_GETARG_TRANSACTIONID(0);\n\tchar\t   *result = (char *) palloc(16);\n\n\tsnprintf(result, 16, \"%lu\", (unsigned long) transactionId);\n\tPG_RETURN_CSTRING(result);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_CSTRING",
          "args": [
            "result"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "result",
            "16",
            "\"%lu\"",
            "(unsigned long) transactionId"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "16"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TRANSACTIONID",
          "args": [
            "0"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\nxidout(PG_FUNCTION_ARGS)\n{\n\tTransactionId transactionId = PG_GETARG_TRANSACTIONID(0);\n\tchar\t   *result = (char *) palloc(16);\n\n\tsnprintf(result, 16, \"%lu\", (unsigned long) transactionId);\n\tPG_RETURN_CSTRING(result);\n}"
  },
  {
    "function_name": "xidin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xid.c",
    "lines": "32-38",
    "snippet": "Datum\nxidin(PG_FUNCTION_ARGS)\n{\n\tchar\t   *str = PG_GETARG_CSTRING(0);\n\n\tPG_RETURN_TRANSACTIONID((TransactionId) strtoul(str, NULL, 0));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"access/xact.h\"",
      "#include \"access/transam.h\"",
      "#include \"access/multixact.h\"",
      "#include <limits.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TRANSACTIONID",
          "args": [
            "(TransactionId) strtoul(str, NULL, 0)"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "str",
            "NULL",
            "0"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "0"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include \"access/multixact.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nDatum\nxidin(PG_FUNCTION_ARGS)\n{\n\tchar\t   *str = PG_GETARG_CSTRING(0);\n\n\tPG_RETURN_TRANSACTIONID((TransactionId) strtoul(str, NULL, 0));\n}"
  }
]