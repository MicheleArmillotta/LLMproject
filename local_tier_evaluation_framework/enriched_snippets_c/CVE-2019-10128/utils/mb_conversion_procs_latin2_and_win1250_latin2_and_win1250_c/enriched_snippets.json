[
  {
    "function_name": "win1250_to_latin2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/latin2_and_win1250/latin2_and_win1250.c",
    "lines": "151-163",
    "snippet": "Datum\nwin1250_to_latin2(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1250, PG_LATIN2);\n\n\tlocal2local(src, dest, len, PG_WIN1250, PG_LATIN2, win1250_2_iso88592);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char win1250_2_iso88592[] = {\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0xA9, 0x8B, 0xA6, 0xAB, 0xAE, 0xAC,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0xB9, 0x9B, 0xB6, 0xBB, 0xBE, 0xBC,\n\t0xA0, 0xB7, 0xA2, 0xA3, 0xA4, 0xA1, 0x00, 0xA7,\n\t0xA8, 0x00, 0xAA, 0x00, 0x00, 0xAD, 0x00, 0xAF,\n\t0xB0, 0x00, 0xB2, 0xB3, 0xB4, 0x00, 0x00, 0x00,\n\t0xB8, 0xB1, 0xBA, 0x00, 0xA5, 0xBD, 0xB5, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_WIN1250",
            "PG_LATIN2",
            "win1250_2_iso88592"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_WIN1250",
            "PG_LATIN2"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char win1250_2_iso88592[] = {\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0xA9, 0x8B, 0xA6, 0xAB, 0xAE, 0xAC,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0xB9, 0x9B, 0xB6, 0xBB, 0xBE, 0xBC,\n\t0xA0, 0xB7, 0xA2, 0xA3, 0xA4, 0xA1, 0x00, 0xA7,\n\t0xA8, 0x00, 0xAA, 0x00, 0x00, 0xAD, 0x00, 0xAF,\n\t0xB0, 0x00, 0xB2, 0xB3, 0xB4, 0x00, 0x00, 0x00,\n\t0xB8, 0xB1, 0xBA, 0x00, 0xA5, 0xBD, 0xB5, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF\n};\n\nDatum\nwin1250_to_latin2(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1250, PG_LATIN2);\n\n\tlocal2local(src, dest, len, PG_WIN1250, PG_LATIN2, win1250_2_iso88592);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "latin2_to_win1250",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/latin2_and_win1250/latin2_and_win1250.c",
    "lines": "137-149",
    "snippet": "Datum\nlatin2_to_win1250(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_LATIN2, PG_WIN1250);\n\n\tlocal2local(src, dest, len, PG_LATIN2, PG_WIN1250, iso88592_2_win1250);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char iso88592_2_win1250[] = {\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0x00, 0x8B, 0x00, 0x00, 0x00, 0x00,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0x00, 0x9B, 0x00, 0x00, 0x00, 0x00,\n\t0xA0, 0xA5, 0xA2, 0xA3, 0xA4, 0xBC, 0x8C, 0xA7,\n\t0xA8, 0x8A, 0xAA, 0x8D, 0x8F, 0xAD, 0x8E, 0xAF,\n\t0xB0, 0xB9, 0xB2, 0xB3, 0xB4, 0xBE, 0x9C, 0xA1,\n\t0xB8, 0x9A, 0xBA, 0x9D, 0x9F, 0xBD, 0x9E, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_LATIN2",
            "PG_WIN1250",
            "iso88592_2_win1250"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_LATIN2",
            "PG_WIN1250"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char iso88592_2_win1250[] = {\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0x00, 0x8B, 0x00, 0x00, 0x00, 0x00,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0x00, 0x9B, 0x00, 0x00, 0x00, 0x00,\n\t0xA0, 0xA5, 0xA2, 0xA3, 0xA4, 0xBC, 0x8C, 0xA7,\n\t0xA8, 0x8A, 0xAA, 0x8D, 0x8F, 0xAD, 0x8E, 0xAF,\n\t0xB0, 0xB9, 0xB2, 0xB3, 0xB4, 0xBE, 0x9C, 0xA1,\n\t0xB8, 0x9A, 0xBA, 0x9D, 0x9F, 0xBD, 0x9E, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF\n};\n\nDatum\nlatin2_to_win1250(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_LATIN2, PG_WIN1250);\n\n\tlocal2local(src, dest, len, PG_LATIN2, PG_WIN1250, iso88592_2_win1250);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "mic_to_win1250",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/latin2_and_win1250/latin2_and_win1250.c",
    "lines": "122-135",
    "snippet": "Datum\nmic_to_win1250(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_WIN1250);\n\n\tmic2latin_with_table(src, dest, len, LC_ISO8859_2, PG_WIN1250,\n\t\t\t\t\t\t iso88592_2_win1250);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char iso88592_2_win1250[] = {\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0x00, 0x8B, 0x00, 0x00, 0x00, 0x00,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0x00, 0x9B, 0x00, 0x00, 0x00, 0x00,\n\t0xA0, 0xA5, 0xA2, 0xA3, 0xA4, 0xBC, 0x8C, 0xA7,\n\t0xA8, 0x8A, 0xAA, 0x8D, 0x8F, 0xAD, 0x8E, 0xAF,\n\t0xB0, 0xB9, 0xB2, 0xB3, 0xB4, 0xBE, 0x9C, 0xA1,\n\t0xB8, 0x9A, 0xBA, 0x9D, 0x9F, 0xBD, 0x9E, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mic2latin_with_table",
          "args": [
            "src",
            "dest",
            "len",
            "LC_ISO8859_2",
            "PG_WIN1250",
            "iso88592_2_win1250"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "mic2latin_with_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "240-283",
          "snippet": "void\nmic2latin_with_table(const unsigned char *mic,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]) ||\n\t\t\t\t(c2 = tab[mic[1] - HIGHBIT]) == 0)\n\t\t\t{\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t\tbreak;\t\t\t/* keep compiler quiet */\n\t\t\t}\n\t\t\t*p++ = c2;\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nmic2latin_with_table(const unsigned char *mic,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]) ||\n\t\t\t\t(c2 = tab[mic[1] - HIGHBIT]) == 0)\n\t\t\t{\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t\tbreak;\t\t\t/* keep compiler quiet */\n\t\t\t}\n\t\t\t*p++ = c2;\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_MULE_INTERNAL",
            "PG_WIN1250"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char iso88592_2_win1250[] = {\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0x00, 0x8B, 0x00, 0x00, 0x00, 0x00,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0x00, 0x9B, 0x00, 0x00, 0x00, 0x00,\n\t0xA0, 0xA5, 0xA2, 0xA3, 0xA4, 0xBC, 0x8C, 0xA7,\n\t0xA8, 0x8A, 0xAA, 0x8D, 0x8F, 0xAD, 0x8E, 0xAF,\n\t0xB0, 0xB9, 0xB2, 0xB3, 0xB4, 0xBE, 0x9C, 0xA1,\n\t0xB8, 0x9A, 0xBA, 0x9D, 0x9F, 0xBD, 0x9E, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF\n};\n\nDatum\nmic_to_win1250(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_WIN1250);\n\n\tmic2latin_with_table(src, dest, len, LC_ISO8859_2, PG_WIN1250,\n\t\t\t\t\t\t iso88592_2_win1250);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "win1250_to_mic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/latin2_and_win1250/latin2_and_win1250.c",
    "lines": "107-120",
    "snippet": "Datum\nwin1250_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1250, PG_MULE_INTERNAL);\n\n\tlatin2mic_with_table(src, dest, len, LC_ISO8859_2, PG_WIN1250,\n\t\t\t\t\t\t win1250_2_iso88592);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char win1250_2_iso88592[] = {\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0xA9, 0x8B, 0xA6, 0xAB, 0xAE, 0xAC,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0xB9, 0x9B, 0xB6, 0xBB, 0xBE, 0xBC,\n\t0xA0, 0xB7, 0xA2, 0xA3, 0xA4, 0xA1, 0x00, 0xA7,\n\t0xA8, 0x00, 0xAA, 0x00, 0x00, 0xAD, 0x00, 0xAF,\n\t0xB0, 0x00, 0xB2, 0xB3, 0xB4, 0x00, 0x00, 0x00,\n\t0xB8, 0xB1, 0xBA, 0x00, 0xA5, 0xBD, 0xB5, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "latin2mic_with_table",
          "args": [
            "src",
            "dest",
            "len",
            "LC_ISO8859_2",
            "PG_WIN1250",
            "win1250_2_iso88592"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "latin2mic_with_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "192-226",
          "snippet": "void\nlatin2mic_with_table(const unsigned char *l,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t{\n\t\t\t\t*p++ = lc;\n\t\t\t\t*p++ = c2;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_untranslatable_char(encoding, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlatin2mic_with_table(const unsigned char *l,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t{\n\t\t\t\t*p++ = lc;\n\t\t\t\t*p++ = c2;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_untranslatable_char(encoding, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_WIN1250",
            "PG_MULE_INTERNAL"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char win1250_2_iso88592[] = {\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0xA9, 0x8B, 0xA6, 0xAB, 0xAE, 0xAC,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0xB9, 0x9B, 0xB6, 0xBB, 0xBE, 0xBC,\n\t0xA0, 0xB7, 0xA2, 0xA3, 0xA4, 0xA1, 0x00, 0xA7,\n\t0xA8, 0x00, 0xAA, 0x00, 0x00, 0xAD, 0x00, 0xAF,\n\t0xB0, 0x00, 0xB2, 0xB3, 0xB4, 0x00, 0x00, 0x00,\n\t0xB8, 0xB1, 0xBA, 0x00, 0xA5, 0xBD, 0xB5, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF\n};\n\nDatum\nwin1250_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1250, PG_MULE_INTERNAL);\n\n\tlatin2mic_with_table(src, dest, len, LC_ISO8859_2, PG_WIN1250,\n\t\t\t\t\t\t win1250_2_iso88592);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "mic_to_latin2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/latin2_and_win1250/latin2_and_win1250.c",
    "lines": "93-105",
    "snippet": "Datum\nmic_to_latin2(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_LATIN2);\n\n\tmic2latin(src, dest, len, LC_ISO8859_2, PG_LATIN2);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mic2latin",
          "args": [
            "src",
            "dest",
            "len",
            "LC_ISO8859_2",
            "PG_LATIN2"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "mic2latin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "98-132",
          "snippet": "void\nmic2latin(const unsigned char *mic, unsigned char *p, int len,\n\t\t  int lc, int encoding)\n{\n\tint\t\t\tc1;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]))\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t*p++ = mic[1];\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nmic2latin(const unsigned char *mic, unsigned char *p, int len,\n\t\t  int lc, int encoding)\n{\n\tint\t\t\tc1;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]))\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t*p++ = mic[1];\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_MULE_INTERNAL",
            "PG_LATIN2"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nDatum\nmic_to_latin2(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_LATIN2);\n\n\tmic2latin(src, dest, len, LC_ISO8859_2, PG_LATIN2);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "latin2_to_mic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/latin2_and_win1250/latin2_and_win1250.c",
    "lines": "79-91",
    "snippet": "Datum\nlatin2_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_LATIN2, PG_MULE_INTERNAL);\n\n\tlatin2mic(src, dest, len, LC_ISO8859_2, PG_LATIN2);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "latin2mic",
          "args": [
            "src",
            "dest",
            "len",
            "LC_ISO8859_2",
            "PG_LATIN2"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "latin2mic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "70-88",
          "snippet": "void\nlatin2mic(const unsigned char *l, unsigned char *p, int len,\n\t\t  int lc, int encoding)\n{\n\tint\t\t\tc1;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = lc;\n\t\t*p++ = c1;\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlatin2mic(const unsigned char *l, unsigned char *p, int len,\n\t\t  int lc, int encoding)\n{\n\tint\t\t\tc1;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = lc;\n\t\t*p++ = c1;\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_LATIN2",
            "PG_MULE_INTERNAL"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nDatum\nlatin2_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_LATIN2, PG_MULE_INTERNAL);\n\n\tlatin2mic(src, dest, len, LC_ISO8859_2, PG_LATIN2);\n\n\tPG_RETURN_VOID();\n}"
  }
]