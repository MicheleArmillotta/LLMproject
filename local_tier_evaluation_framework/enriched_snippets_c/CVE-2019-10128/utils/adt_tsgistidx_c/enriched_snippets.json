[
  {
    "function_name": "gtsvector_consistent_oldsig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "820-824",
    "snippet": "Datum\ngtsvector_consistent_oldsig(PG_FUNCTION_ARGS)\n{\n\treturn gtsvector_consistent(fcinfo);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gtsvector_consistent",
          "args": [
            "fcinfo"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "gtsvector_consistent_oldsig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "820-824",
          "snippet": "Datum\ngtsvector_consistent_oldsig(PG_FUNCTION_ARGS)\n{\n\treturn gtsvector_consistent(fcinfo);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nDatum\ngtsvector_consistent_oldsig(PG_FUNCTION_ARGS)\n{\n\treturn gtsvector_consistent(fcinfo);\n}"
  },
  {
    "function_name": "gtsvector_picksplit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "627-811",
    "snippet": "Datum\ngtsvector_picksplit(PG_FUNCTION_ARGS)\n{\n\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);\n\tGIST_SPLITVEC *v = (GIST_SPLITVEC *) PG_GETARG_POINTER(1);\n\tOffsetNumber k,\n\t\t\t\tj;\n\tSignTSVector *datum_l,\n\t\t\t   *datum_r;\n\tBITVECP\t\tunion_l,\n\t\t\t\tunion_r;\n\tint32\t\tsize_alpha,\n\t\t\t\tsize_beta;\n\tint32\t\tsize_waste,\n\t\t\t\twaste = -1;\n\tint32\t\tnbytes;\n\tOffsetNumber seed_1 = 0,\n\t\t\t\tseed_2 = 0;\n\tOffsetNumber *left,\n\t\t\t   *right;\n\tOffsetNumber maxoff;\n\tBITVECP\t\tptr;\n\tint\t\t\ti;\n\tCACHESIGN  *cache;\n\tSPLITCOST  *costvector;\n\n\tmaxoff = entryvec->n - 2;\n\tnbytes = (maxoff + 2) * sizeof(OffsetNumber);\n\tv->spl_left = (OffsetNumber *) palloc(nbytes);\n\tv->spl_right = (OffsetNumber *) palloc(nbytes);\n\n\tcache = (CACHESIGN *) palloc(sizeof(CACHESIGN) * (maxoff + 2));\n\tfillcache(&cache[FirstOffsetNumber], GETENTRY(entryvec, FirstOffsetNumber));\n\n\tfor (k = FirstOffsetNumber; k < maxoff; k = OffsetNumberNext(k))\n\t{\n\t\tfor (j = OffsetNumberNext(k); j <= maxoff; j = OffsetNumberNext(j))\n\t\t{\n\t\t\tif (k == FirstOffsetNumber)\n\t\t\t\tfillcache(&cache[j], GETENTRY(entryvec, j));\n\n\t\t\tsize_waste = hemdistcache(&(cache[j]), &(cache[k]));\n\t\t\tif (size_waste > waste)\n\t\t\t{\n\t\t\t\twaste = size_waste;\n\t\t\t\tseed_1 = k;\n\t\t\t\tseed_2 = j;\n\t\t\t}\n\t\t}\n\t}\n\n\tleft = v->spl_left;\n\tv->spl_nleft = 0;\n\tright = v->spl_right;\n\tv->spl_nright = 0;\n\n\tif (seed_1 == 0 || seed_2 == 0)\n\t{\n\t\tseed_1 = 1;\n\t\tseed_2 = 2;\n\t}\n\n\t/* form initial .. */\n\tif (cache[seed_1].allistrue)\n\t{\n\t\tdatum_l = (SignTSVector *) palloc(CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));\n\t\tSET_VARSIZE(datum_l, CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));\n\t\tdatum_l->flag = SIGNKEY | ALLISTRUE;\n\t}\n\telse\n\t{\n\t\tdatum_l = (SignTSVector *) palloc(CALCGTSIZE(SIGNKEY, 0));\n\t\tSET_VARSIZE(datum_l, CALCGTSIZE(SIGNKEY, 0));\n\t\tdatum_l->flag = SIGNKEY;\n\t\tmemcpy((void *) GETSIGN(datum_l), (void *) cache[seed_1].sign, sizeof(BITVEC));\n\t}\n\tif (cache[seed_2].allistrue)\n\t{\n\t\tdatum_r = (SignTSVector *) palloc(CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));\n\t\tSET_VARSIZE(datum_r, CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));\n\t\tdatum_r->flag = SIGNKEY | ALLISTRUE;\n\t}\n\telse\n\t{\n\t\tdatum_r = (SignTSVector *) palloc(CALCGTSIZE(SIGNKEY, 0));\n\t\tSET_VARSIZE(datum_r, CALCGTSIZE(SIGNKEY, 0));\n\t\tdatum_r->flag = SIGNKEY;\n\t\tmemcpy((void *) GETSIGN(datum_r), (void *) cache[seed_2].sign, sizeof(BITVEC));\n\t}\n\n\tunion_l = GETSIGN(datum_l);\n\tunion_r = GETSIGN(datum_r);\n\tmaxoff = OffsetNumberNext(maxoff);\n\tfillcache(&cache[maxoff], GETENTRY(entryvec, maxoff));\n\t/* sort before ... */\n\tcostvector = (SPLITCOST *) palloc(sizeof(SPLITCOST) * maxoff);\n\tfor (j = FirstOffsetNumber; j <= maxoff; j = OffsetNumberNext(j))\n\t{\n\t\tcostvector[j - 1].pos = j;\n\t\tsize_alpha = hemdistcache(&(cache[seed_1]), &(cache[j]));\n\t\tsize_beta = hemdistcache(&(cache[seed_2]), &(cache[j]));\n\t\tcostvector[j - 1].cost = Abs(size_alpha - size_beta);\n\t}\n\tqsort((void *) costvector, maxoff, sizeof(SPLITCOST), comparecost);\n\n\tfor (k = 0; k < maxoff; k++)\n\t{\n\t\tj = costvector[k].pos;\n\t\tif (j == seed_1)\n\t\t{\n\t\t\t*left++ = j;\n\t\t\tv->spl_nleft++;\n\t\t\tcontinue;\n\t\t}\n\t\telse if (j == seed_2)\n\t\t{\n\t\t\t*right++ = j;\n\t\t\tv->spl_nright++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (ISALLTRUE(datum_l) || cache[j].allistrue)\n\t\t{\n\t\t\tif (ISALLTRUE(datum_l) && cache[j].allistrue)\n\t\t\t\tsize_alpha = 0;\n\t\t\telse\n\t\t\t\tsize_alpha = SIGLENBIT - sizebitvec(\n\t\t\t\t\t\t\t\t\t\t\t\t\t(cache[j].allistrue) ? GETSIGN(datum_l) : GETSIGN(cache[j].sign)\n\t\t\t\t\t);\n\t\t}\n\t\telse\n\t\t\tsize_alpha = hemdistsign(cache[j].sign, GETSIGN(datum_l));\n\n\t\tif (ISALLTRUE(datum_r) || cache[j].allistrue)\n\t\t{\n\t\t\tif (ISALLTRUE(datum_r) && cache[j].allistrue)\n\t\t\t\tsize_beta = 0;\n\t\t\telse\n\t\t\t\tsize_beta = SIGLENBIT - sizebitvec(\n\t\t\t\t\t\t\t\t\t\t\t\t   (cache[j].allistrue) ? GETSIGN(datum_r) : GETSIGN(cache[j].sign)\n\t\t\t\t\t);\n\t\t}\n\t\telse\n\t\t\tsize_beta = hemdistsign(cache[j].sign, GETSIGN(datum_r));\n\n\t\tif (size_alpha < size_beta + WISH_F(v->spl_nleft, v->spl_nright, 0.1))\n\t\t{\n\t\t\tif (ISALLTRUE(datum_l) || cache[j].allistrue)\n\t\t\t{\n\t\t\t\tif (!ISALLTRUE(datum_l))\n\t\t\t\t\tMemSet((void *) GETSIGN(datum_l), 0xff, sizeof(BITVEC));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tptr = cache[j].sign;\n\t\t\t\tLOOPBYTE\n\t\t\t\t\tunion_l[i] |= ptr[i];\n\t\t\t}\n\t\t\t*left++ = j;\n\t\t\tv->spl_nleft++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (ISALLTRUE(datum_r) || cache[j].allistrue)\n\t\t\t{\n\t\t\t\tif (!ISALLTRUE(datum_r))\n\t\t\t\t\tMemSet((void *) GETSIGN(datum_r), 0xff, sizeof(BITVEC));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tptr = cache[j].sign;\n\t\t\t\tLOOPBYTE\n\t\t\t\t\tunion_r[i] |= ptr[i];\n\t\t\t}\n\t\t\t*right++ = j;\n\t\t\tv->spl_nright++;\n\t\t}\n\t}\n\n\t*right = *left = FirstOffsetNumber;\n\tv->spl_ldatum = PointerGetDatum(datum_l);\n\tv->spl_rdatum = PointerGetDatum(datum_r);\n\n\tPG_RETURN_POINTER(v);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define ALLISTRUE\t0x04",
      "#define SIGNKEY\t\t0x02",
      "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)",
      "#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)"
    ],
    "globals_used": [
      "static int32 sizebitvec(BITVECP sign);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "v"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerGetDatum",
          "args": [
            "datum_r"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerGetDatum",
          "args": [
            "datum_l"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "(void *) GETSIGN(datum_r)",
            "0xff",
            "sizeof(BITVEC)"
          ],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "datum_r"
          ],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "datum_r"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "datum_r"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "(void *) GETSIGN(datum_l)",
            "0xff",
            "sizeof(BITVEC)"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "datum_l"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "datum_l"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "datum_l"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WISH_F",
          "args": [
            "v->spl_nleft",
            "v->spl_nright",
            "0.1"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hemdistsign",
          "args": [
            "cache[j].sign",
            "GETSIGN(datum_r)"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "hemdistsign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "514-527",
          "snippet": "static int\nhemdistsign(BITVECP a, BITVECP b)\n{\n\tint\t\t\ti,\n\t\t\t\tdiff,\n\t\t\t\tdist = 0;\n\n\tLOOPBYTE\n\t{\n\t\tdiff = (unsigned char) (a[i] ^ b[i]);\n\t\tdist += number_of_ones[diff];\n\t}\n\treturn dist;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
          ],
          "globals_used": [
            "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\n\nstatic int\nhemdistsign(BITVECP a, BITVECP b)\n{\n\tint\t\t\ti,\n\t\t\t\tdiff,\n\t\t\t\tdist = 0;\n\n\tLOOPBYTE\n\t{\n\t\tdiff = (unsigned char) (a[i] ^ b[i]);\n\t\tdist += number_of_ones[diff];\n\t}\n\treturn dist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "datum_r"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sizebitvec",
          "args": [
            "(cache[j].allistrue) ? GETSIGN(datum_r) : GETSIGN(cache[j].sign)"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "sizebitvec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "503-512",
          "snippet": "static int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
          ],
          "globals_used": [
            "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};",
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "cache[j].sign"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "datum_r"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "datum_r"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "datum_r"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "datum_l"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "cache[j].sign"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "datum_l"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "datum_l"
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "datum_l"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qsort",
          "args": [
            "(void *) costvector",
            "maxoff",
            "sizeof(SPLITCOST)",
            "comparecost"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Abs",
          "args": [
            "size_alpha - size_beta"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hemdistcache",
          "args": [
            "&(cache[seed_2])",
            "&(cache[j])"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "hemdistcache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "611-625",
          "snippet": "static int\nhemdistcache(CACHESIGN *a, CACHESIGN *b)\n{\n\tif (a->allistrue)\n\t{\n\t\tif (b->allistrue)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn SIGLENBIT - sizebitvec(b->sign);\n\t}\n\telse if (b->allistrue)\n\t\treturn SIGLENBIT - sizebitvec(a->sign);\n\n\treturn hemdistsign(a->sign, b->sign);\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)"
          ],
          "globals_used": [
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)\n\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic int\nhemdistcache(CACHESIGN *a, CACHESIGN *b)\n{\n\tif (a->allistrue)\n\t{\n\t\tif (b->allistrue)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn SIGLENBIT - sizebitvec(b->sign);\n\t}\n\telse if (b->allistrue)\n\t\treturn SIGLENBIT - sizebitvec(a->sign);\n\n\treturn hemdistsign(a->sign, b->sign);\n}"
        }
      },
      {
        "call_info": {
          "callee": "OffsetNumberNext",
          "args": [
            "j"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(SPLITCOST) * maxoff"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fillcache",
          "args": [
            "&cache[maxoff]",
            "GETENTRY(entryvec, maxoff)"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "fillcache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "579-589",
          "snippet": "static void\nfillcache(CACHESIGN *item, SignTSVector *key)\n{\n\titem->allistrue = false;\n\tif (ISARRKEY(key))\n\t\tmakesign(item->sign, key);\n\telse if (ISALLTRUE(key))\n\t\titem->allistrue = true;\n\telse\n\t\tmemcpy((void *) item->sign, (void *) GETSIGN(key), sizeof(BITVEC));\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic void\nfillcache(CACHESIGN *item, SignTSVector *key)\n{\n\titem->allistrue = false;\n\tif (ISARRKEY(key))\n\t\tmakesign(item->sign, key);\n\telse if (ISALLTRUE(key))\n\t\titem->allistrue = true;\n\telse\n\t\tmemcpy((void *) item->sign, (void *) GETSIGN(key), sizeof(BITVEC));\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "maxoff"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OffsetNumberNext",
          "args": [
            "maxoff"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "datum_r"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "datum_l"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(void *) GETSIGN(datum_r)",
            "(void *) cache[seed_2].sign",
            "sizeof(BITVEC)"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "datum_r"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "datum_r",
            "CALCGTSIZE(SIGNKEY, 0)"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "SIGNKEY",
            "0"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "SIGNKEY",
            "0"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "datum_r",
            "CALCGTSIZE(SIGNKEY | ALLISTRUE, 0)"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "SIGNKEY | ALLISTRUE",
            "0"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "SIGNKEY | ALLISTRUE",
            "0"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(void *) GETSIGN(datum_l)",
            "(void *) cache[seed_1].sign",
            "sizeof(BITVEC)"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "datum_l"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "datum_l",
            "CALCGTSIZE(SIGNKEY, 0)"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "SIGNKEY",
            "0"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "SIGNKEY",
            "0"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "datum_l",
            "CALCGTSIZE(SIGNKEY | ALLISTRUE, 0)"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "SIGNKEY | ALLISTRUE",
            "0"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "SIGNKEY | ALLISTRUE",
            "0"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "j"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OffsetNumberNext",
          "args": [
            "j"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OffsetNumberNext",
          "args": [
            "k"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OffsetNumberNext",
          "args": [
            "k"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "FirstOffsetNumber"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "1"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define ALLISTRUE\t0x04\n#define SIGNKEY\t\t0x02\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)\n\nstatic int32 sizebitvec(BITVECP sign);\n\nDatum\ngtsvector_picksplit(PG_FUNCTION_ARGS)\n{\n\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);\n\tGIST_SPLITVEC *v = (GIST_SPLITVEC *) PG_GETARG_POINTER(1);\n\tOffsetNumber k,\n\t\t\t\tj;\n\tSignTSVector *datum_l,\n\t\t\t   *datum_r;\n\tBITVECP\t\tunion_l,\n\t\t\t\tunion_r;\n\tint32\t\tsize_alpha,\n\t\t\t\tsize_beta;\n\tint32\t\tsize_waste,\n\t\t\t\twaste = -1;\n\tint32\t\tnbytes;\n\tOffsetNumber seed_1 = 0,\n\t\t\t\tseed_2 = 0;\n\tOffsetNumber *left,\n\t\t\t   *right;\n\tOffsetNumber maxoff;\n\tBITVECP\t\tptr;\n\tint\t\t\ti;\n\tCACHESIGN  *cache;\n\tSPLITCOST  *costvector;\n\n\tmaxoff = entryvec->n - 2;\n\tnbytes = (maxoff + 2) * sizeof(OffsetNumber);\n\tv->spl_left = (OffsetNumber *) palloc(nbytes);\n\tv->spl_right = (OffsetNumber *) palloc(nbytes);\n\n\tcache = (CACHESIGN *) palloc(sizeof(CACHESIGN) * (maxoff + 2));\n\tfillcache(&cache[FirstOffsetNumber], GETENTRY(entryvec, FirstOffsetNumber));\n\n\tfor (k = FirstOffsetNumber; k < maxoff; k = OffsetNumberNext(k))\n\t{\n\t\tfor (j = OffsetNumberNext(k); j <= maxoff; j = OffsetNumberNext(j))\n\t\t{\n\t\t\tif (k == FirstOffsetNumber)\n\t\t\t\tfillcache(&cache[j], GETENTRY(entryvec, j));\n\n\t\t\tsize_waste = hemdistcache(&(cache[j]), &(cache[k]));\n\t\t\tif (size_waste > waste)\n\t\t\t{\n\t\t\t\twaste = size_waste;\n\t\t\t\tseed_1 = k;\n\t\t\t\tseed_2 = j;\n\t\t\t}\n\t\t}\n\t}\n\n\tleft = v->spl_left;\n\tv->spl_nleft = 0;\n\tright = v->spl_right;\n\tv->spl_nright = 0;\n\n\tif (seed_1 == 0 || seed_2 == 0)\n\t{\n\t\tseed_1 = 1;\n\t\tseed_2 = 2;\n\t}\n\n\t/* form initial .. */\n\tif (cache[seed_1].allistrue)\n\t{\n\t\tdatum_l = (SignTSVector *) palloc(CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));\n\t\tSET_VARSIZE(datum_l, CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));\n\t\tdatum_l->flag = SIGNKEY | ALLISTRUE;\n\t}\n\telse\n\t{\n\t\tdatum_l = (SignTSVector *) palloc(CALCGTSIZE(SIGNKEY, 0));\n\t\tSET_VARSIZE(datum_l, CALCGTSIZE(SIGNKEY, 0));\n\t\tdatum_l->flag = SIGNKEY;\n\t\tmemcpy((void *) GETSIGN(datum_l), (void *) cache[seed_1].sign, sizeof(BITVEC));\n\t}\n\tif (cache[seed_2].allistrue)\n\t{\n\t\tdatum_r = (SignTSVector *) palloc(CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));\n\t\tSET_VARSIZE(datum_r, CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));\n\t\tdatum_r->flag = SIGNKEY | ALLISTRUE;\n\t}\n\telse\n\t{\n\t\tdatum_r = (SignTSVector *) palloc(CALCGTSIZE(SIGNKEY, 0));\n\t\tSET_VARSIZE(datum_r, CALCGTSIZE(SIGNKEY, 0));\n\t\tdatum_r->flag = SIGNKEY;\n\t\tmemcpy((void *) GETSIGN(datum_r), (void *) cache[seed_2].sign, sizeof(BITVEC));\n\t}\n\n\tunion_l = GETSIGN(datum_l);\n\tunion_r = GETSIGN(datum_r);\n\tmaxoff = OffsetNumberNext(maxoff);\n\tfillcache(&cache[maxoff], GETENTRY(entryvec, maxoff));\n\t/* sort before ... */\n\tcostvector = (SPLITCOST *) palloc(sizeof(SPLITCOST) * maxoff);\n\tfor (j = FirstOffsetNumber; j <= maxoff; j = OffsetNumberNext(j))\n\t{\n\t\tcostvector[j - 1].pos = j;\n\t\tsize_alpha = hemdistcache(&(cache[seed_1]), &(cache[j]));\n\t\tsize_beta = hemdistcache(&(cache[seed_2]), &(cache[j]));\n\t\tcostvector[j - 1].cost = Abs(size_alpha - size_beta);\n\t}\n\tqsort((void *) costvector, maxoff, sizeof(SPLITCOST), comparecost);\n\n\tfor (k = 0; k < maxoff; k++)\n\t{\n\t\tj = costvector[k].pos;\n\t\tif (j == seed_1)\n\t\t{\n\t\t\t*left++ = j;\n\t\t\tv->spl_nleft++;\n\t\t\tcontinue;\n\t\t}\n\t\telse if (j == seed_2)\n\t\t{\n\t\t\t*right++ = j;\n\t\t\tv->spl_nright++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (ISALLTRUE(datum_l) || cache[j].allistrue)\n\t\t{\n\t\t\tif (ISALLTRUE(datum_l) && cache[j].allistrue)\n\t\t\t\tsize_alpha = 0;\n\t\t\telse\n\t\t\t\tsize_alpha = SIGLENBIT - sizebitvec(\n\t\t\t\t\t\t\t\t\t\t\t\t\t(cache[j].allistrue) ? GETSIGN(datum_l) : GETSIGN(cache[j].sign)\n\t\t\t\t\t);\n\t\t}\n\t\telse\n\t\t\tsize_alpha = hemdistsign(cache[j].sign, GETSIGN(datum_l));\n\n\t\tif (ISALLTRUE(datum_r) || cache[j].allistrue)\n\t\t{\n\t\t\tif (ISALLTRUE(datum_r) && cache[j].allistrue)\n\t\t\t\tsize_beta = 0;\n\t\t\telse\n\t\t\t\tsize_beta = SIGLENBIT - sizebitvec(\n\t\t\t\t\t\t\t\t\t\t\t\t   (cache[j].allistrue) ? GETSIGN(datum_r) : GETSIGN(cache[j].sign)\n\t\t\t\t\t);\n\t\t}\n\t\telse\n\t\t\tsize_beta = hemdistsign(cache[j].sign, GETSIGN(datum_r));\n\n\t\tif (size_alpha < size_beta + WISH_F(v->spl_nleft, v->spl_nright, 0.1))\n\t\t{\n\t\t\tif (ISALLTRUE(datum_l) || cache[j].allistrue)\n\t\t\t{\n\t\t\t\tif (!ISALLTRUE(datum_l))\n\t\t\t\t\tMemSet((void *) GETSIGN(datum_l), 0xff, sizeof(BITVEC));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tptr = cache[j].sign;\n\t\t\t\tLOOPBYTE\n\t\t\t\t\tunion_l[i] |= ptr[i];\n\t\t\t}\n\t\t\t*left++ = j;\n\t\t\tv->spl_nleft++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (ISALLTRUE(datum_r) || cache[j].allistrue)\n\t\t\t{\n\t\t\t\tif (!ISALLTRUE(datum_r))\n\t\t\t\t\tMemSet((void *) GETSIGN(datum_r), 0xff, sizeof(BITVEC));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tptr = cache[j].sign;\n\t\t\t\tLOOPBYTE\n\t\t\t\t\tunion_r[i] |= ptr[i];\n\t\t\t}\n\t\t\t*right++ = j;\n\t\t\tv->spl_nright++;\n\t\t}\n\t}\n\n\t*right = *left = FirstOffsetNumber;\n\tv->spl_ldatum = PointerGetDatum(datum_l);\n\tv->spl_rdatum = PointerGetDatum(datum_r);\n\n\tPG_RETURN_POINTER(v);\n}"
  },
  {
    "function_name": "hemdistcache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "611-625",
    "snippet": "static int\nhemdistcache(CACHESIGN *a, CACHESIGN *b)\n{\n\tif (a->allistrue)\n\t{\n\t\tif (b->allistrue)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn SIGLENBIT - sizebitvec(b->sign);\n\t}\n\telse if (b->allistrue)\n\t\treturn SIGLENBIT - sizebitvec(a->sign);\n\n\treturn hemdistsign(a->sign, b->sign);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)"
    ],
    "globals_used": [
      "static int32 sizebitvec(BITVECP sign);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hemdistsign",
          "args": [
            "a->sign",
            "b->sign"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "hemdistsign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "514-527",
          "snippet": "static int\nhemdistsign(BITVECP a, BITVECP b)\n{\n\tint\t\t\ti,\n\t\t\t\tdiff,\n\t\t\t\tdist = 0;\n\n\tLOOPBYTE\n\t{\n\t\tdiff = (unsigned char) (a[i] ^ b[i]);\n\t\tdist += number_of_ones[diff];\n\t}\n\treturn dist;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
          ],
          "globals_used": [
            "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\n\nstatic int\nhemdistsign(BITVECP a, BITVECP b)\n{\n\tint\t\t\ti,\n\t\t\t\tdiff,\n\t\t\t\tdist = 0;\n\n\tLOOPBYTE\n\t{\n\t\tdiff = (unsigned char) (a[i] ^ b[i]);\n\t\tdist += number_of_ones[diff];\n\t}\n\treturn dist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sizebitvec",
          "args": [
            "a->sign"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "sizebitvec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "503-512",
          "snippet": "static int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
          ],
          "globals_used": [
            "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};",
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)\n\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic int\nhemdistcache(CACHESIGN *a, CACHESIGN *b)\n{\n\tif (a->allistrue)\n\t{\n\t\tif (b->allistrue)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn SIGLENBIT - sizebitvec(b->sign);\n\t}\n\telse if (b->allistrue)\n\t\treturn SIGLENBIT - sizebitvec(a->sign);\n\n\treturn hemdistsign(a->sign, b->sign);\n}"
  },
  {
    "function_name": "comparecost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "598-608",
    "snippet": "static int\ncomparecost(const void *va, const void *vb)\n{\n\tconst SPLITCOST *a = (const SPLITCOST *) va;\n\tconst SPLITCOST *b = (const SPLITCOST *) vb;\n\n\tif (a->cost == b->cost)\n\t\treturn 0;\n\telse\n\t\treturn (a->cost > b->cost) ? 1 : -1;\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic int\ncomparecost(const void *va, const void *vb)\n{\n\tconst SPLITCOST *a = (const SPLITCOST *) va;\n\tconst SPLITCOST *b = (const SPLITCOST *) vb;\n\n\tif (a->cost == b->cost)\n\t\treturn 0;\n\telse\n\t\treturn (a->cost > b->cost) ? 1 : -1;\n}"
  },
  {
    "function_name": "fillcache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "579-589",
    "snippet": "static void\nfillcache(CACHESIGN *item, SignTSVector *key)\n{\n\titem->allistrue = false;\n\tif (ISARRKEY(key))\n\t\tmakesign(item->sign, key);\n\telse if (ISALLTRUE(key))\n\t\titem->allistrue = true;\n\telse\n\t\tmemcpy((void *) item->sign, (void *) GETSIGN(key), sizeof(BITVEC));\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 sizebitvec(BITVECP sign);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(void *) item->sign",
            "(void *) GETSIGN(key)",
            "sizeof(BITVEC)"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "key"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "key"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makesign",
          "args": [
            "item->sign",
            "key"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "makesign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "169-179",
          "snippet": "static void\nmakesign(BITVECP sign, SignTSVector *a)\n{\n\tint32\t\tk,\n\t\t\t\tlen = ARRNELEM(a);\n\tint32\t   *ptr = GETARR(a);\n\n\tMemSet((void *) sign, 0, sizeof(BITVEC));\n\tfor (k = 0; k < len; k++)\n\t\tHASH(sign, ptr[k]);\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic void\nmakesign(BITVECP sign, SignTSVector *a)\n{\n\tint32\t\tk,\n\t\t\t\tlen = ARRNELEM(a);\n\tint32\t   *ptr = GETARR(a);\n\n\tMemSet((void *) sign, 0, sizeof(BITVEC));\n\tfor (k = 0; k < len; k++)\n\t\tHASH(sign, ptr[k]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ISARRKEY",
          "args": [
            "key"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic void\nfillcache(CACHESIGN *item, SignTSVector *key)\n{\n\titem->allistrue = false;\n\tif (ISARRKEY(key))\n\t\tmakesign(item->sign, key);\n\telse if (ISALLTRUE(key))\n\t\titem->allistrue = true;\n\telse\n\t\tmemcpy((void *) item->sign, (void *) GETSIGN(key), sizeof(BITVEC));\n}"
  },
  {
    "function_name": "gtsvector_penalty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "545-571",
    "snippet": "Datum\ngtsvector_penalty(PG_FUNCTION_ARGS)\n{\n\tGISTENTRY  *origentry = (GISTENTRY *) PG_GETARG_POINTER(0); /* always ISSIGNKEY */\n\tGISTENTRY  *newentry = (GISTENTRY *) PG_GETARG_POINTER(1);\n\tfloat\t   *penalty = (float *) PG_GETARG_POINTER(2);\n\tSignTSVector *origval = (SignTSVector *) DatumGetPointer(origentry->key);\n\tSignTSVector *newval = (SignTSVector *) DatumGetPointer(newentry->key);\n\tBITVECP\t\torig = GETSIGN(origval);\n\n\t*penalty = 0.0;\n\n\tif (ISARRKEY(newval))\n\t{\n\t\tBITVEC\t\tsign;\n\n\t\tmakesign(sign, newval);\n\n\t\tif (ISALLTRUE(origval))\n\t\t\t*penalty = ((float) (SIGLENBIT - sizebitvec(sign))) / (float) (SIGLENBIT + 1);\n\t\telse\n\t\t\t*penalty = hemdistsign(sign, orig);\n\t}\n\telse\n\t\t*penalty = hemdist(origval, newval);\n\tPG_RETURN_POINTER(penalty);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)"
    ],
    "globals_used": [
      "static int32 sizebitvec(BITVECP sign);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "penalty"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hemdist",
          "args": [
            "origval",
            "newval"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "hemdistcache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "611-625",
          "snippet": "static int\nhemdistcache(CACHESIGN *a, CACHESIGN *b)\n{\n\tif (a->allistrue)\n\t{\n\t\tif (b->allistrue)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn SIGLENBIT - sizebitvec(b->sign);\n\t}\n\telse if (b->allistrue)\n\t\treturn SIGLENBIT - sizebitvec(a->sign);\n\n\treturn hemdistsign(a->sign, b->sign);\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)"
          ],
          "globals_used": [
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)\n\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic int\nhemdistcache(CACHESIGN *a, CACHESIGN *b)\n{\n\tif (a->allistrue)\n\t{\n\t\tif (b->allistrue)\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn SIGLENBIT - sizebitvec(b->sign);\n\t}\n\telse if (b->allistrue)\n\t\treturn SIGLENBIT - sizebitvec(a->sign);\n\n\treturn hemdistsign(a->sign, b->sign);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hemdistsign",
          "args": [
            "sign",
            "orig"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "hemdistsign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "514-527",
          "snippet": "static int\nhemdistsign(BITVECP a, BITVECP b)\n{\n\tint\t\t\ti,\n\t\t\t\tdiff,\n\t\t\t\tdist = 0;\n\n\tLOOPBYTE\n\t{\n\t\tdiff = (unsigned char) (a[i] ^ b[i]);\n\t\tdist += number_of_ones[diff];\n\t}\n\treturn dist;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
          ],
          "globals_used": [
            "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\n\nstatic int\nhemdistsign(BITVECP a, BITVECP b)\n{\n\tint\t\t\ti,\n\t\t\t\tdiff,\n\t\t\t\tdist = 0;\n\n\tLOOPBYTE\n\t{\n\t\tdiff = (unsigned char) (a[i] ^ b[i]);\n\t\tdist += number_of_ones[diff];\n\t}\n\treturn dist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sizebitvec",
          "args": [
            "sign"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "sizebitvec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "503-512",
          "snippet": "static int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
          ],
          "globals_used": [
            "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};",
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "origval"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makesign",
          "args": [
            "sign",
            "newval"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "makesign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "169-179",
          "snippet": "static void\nmakesign(BITVECP sign, SignTSVector *a)\n{\n\tint32\t\tk,\n\t\t\t\tlen = ARRNELEM(a);\n\tint32\t   *ptr = GETARR(a);\n\n\tMemSet((void *) sign, 0, sizeof(BITVEC));\n\tfor (k = 0; k < len; k++)\n\t\tHASH(sign, ptr[k]);\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic void\nmakesign(BITVECP sign, SignTSVector *a)\n{\n\tint32\t\tk,\n\t\t\t\tlen = ARRNELEM(a);\n\tint32\t   *ptr = GETARR(a);\n\n\tMemSet((void *) sign, 0, sizeof(BITVEC));\n\tfor (k = 0; k < len; k++)\n\t\tHASH(sign, ptr[k]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ISARRKEY",
          "args": [
            "newval"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "origval"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "newentry->key"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "origentry->key"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "2"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "1"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)\n\nstatic int32 sizebitvec(BITVECP sign);\n\nDatum\ngtsvector_penalty(PG_FUNCTION_ARGS)\n{\n\tGISTENTRY  *origentry = (GISTENTRY *) PG_GETARG_POINTER(0); /* always ISSIGNKEY */\n\tGISTENTRY  *newentry = (GISTENTRY *) PG_GETARG_POINTER(1);\n\tfloat\t   *penalty = (float *) PG_GETARG_POINTER(2);\n\tSignTSVector *origval = (SignTSVector *) DatumGetPointer(origentry->key);\n\tSignTSVector *newval = (SignTSVector *) DatumGetPointer(newentry->key);\n\tBITVECP\t\torig = GETSIGN(origval);\n\n\t*penalty = 0.0;\n\n\tif (ISARRKEY(newval))\n\t{\n\t\tBITVEC\t\tsign;\n\n\t\tmakesign(sign, newval);\n\n\t\tif (ISALLTRUE(origval))\n\t\t\t*penalty = ((float) (SIGLENBIT - sizebitvec(sign))) / (float) (SIGLENBIT + 1);\n\t\telse\n\t\t\t*penalty = hemdistsign(sign, orig);\n\t}\n\telse\n\t\t*penalty = hemdist(origval, newval);\n\tPG_RETURN_POINTER(penalty);\n}"
  },
  {
    "function_name": "hemdist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "529-543",
    "snippet": "static int\nhemdist(SignTSVector *a, SignTSVector *b)\n{\n\tif (ISALLTRUE(a))\n\t{\n\t\tif (ISALLTRUE(b))\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn SIGLENBIT - sizebitvec(GETSIGN(b));\n\t}\n\telse if (ISALLTRUE(b))\n\t\treturn SIGLENBIT - sizebitvec(GETSIGN(a));\n\n\treturn hemdistsign(GETSIGN(a), GETSIGN(b));\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hemdistsign",
          "args": [
            "GETSIGN(a)",
            "GETSIGN(b)"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "hemdistsign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "514-527",
          "snippet": "static int\nhemdistsign(BITVECP a, BITVECP b)\n{\n\tint\t\t\ti,\n\t\t\t\tdiff,\n\t\t\t\tdist = 0;\n\n\tLOOPBYTE\n\t{\n\t\tdiff = (unsigned char) (a[i] ^ b[i]);\n\t\tdist += number_of_ones[diff];\n\t}\n\treturn dist;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
          ],
          "globals_used": [
            "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\n\nstatic int\nhemdistsign(BITVECP a, BITVECP b)\n{\n\tint\t\t\ti,\n\t\t\t\tdiff,\n\t\t\t\tdist = 0;\n\n\tLOOPBYTE\n\t{\n\t\tdiff = (unsigned char) (a[i] ^ b[i]);\n\t\tdist += number_of_ones[diff];\n\t}\n\treturn dist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "b"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "a"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sizebitvec",
          "args": [
            "GETSIGN(a)"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "sizebitvec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "503-512",
          "snippet": "static int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
          ],
          "globals_used": [
            "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};",
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "a"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "b"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "b"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "b"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "a"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)\n\nstatic int\nhemdist(SignTSVector *a, SignTSVector *b)\n{\n\tif (ISALLTRUE(a))\n\t{\n\t\tif (ISALLTRUE(b))\n\t\t\treturn 0;\n\t\telse\n\t\t\treturn SIGLENBIT - sizebitvec(GETSIGN(b));\n\t}\n\telse if (ISALLTRUE(b))\n\t\treturn SIGLENBIT - sizebitvec(GETSIGN(a));\n\n\treturn hemdistsign(GETSIGN(a), GETSIGN(b));\n}"
  },
  {
    "function_name": "hemdistsign",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "514-527",
    "snippet": "static int\nhemdistsign(BITVECP a, BITVECP b)\n{\n\tint\t\t\ti,\n\t\t\t\tdiff,\n\t\t\t\tdist = 0;\n\n\tLOOPBYTE\n\t{\n\t\tdiff = (unsigned char) (a[i] ^ b[i]);\n\t\tdist += number_of_ones[diff];\n\t}\n\treturn dist;\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
    ],
    "globals_used": [
      "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\n\nstatic int\nhemdistsign(BITVECP a, BITVECP b)\n{\n\tint\t\t\ti,\n\t\t\t\tdiff,\n\t\t\t\tdist = 0;\n\n\tLOOPBYTE\n\t{\n\t\tdiff = (unsigned char) (a[i] ^ b[i]);\n\t\tdist += number_of_ones[diff];\n\t}\n\treturn dist;\n}"
  },
  {
    "function_name": "sizebitvec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "503-512",
    "snippet": "static int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
    ],
    "globals_used": [
      "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};",
      "static int32 sizebitvec(BITVECP sign);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}"
  },
  {
    "function_name": "gtsvector_same",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "445-501",
    "snippet": "Datum\ngtsvector_same(PG_FUNCTION_ARGS)\n{\n\tSignTSVector *a = (SignTSVector *) PG_GETARG_POINTER(0);\n\tSignTSVector *b = (SignTSVector *) PG_GETARG_POINTER(1);\n\tbool\t   *result = (bool *) PG_GETARG_POINTER(2);\n\n\tif (ISSIGNKEY(a))\n\t{\t\t\t\t\t\t\t/* then b also ISSIGNKEY */\n\t\tif (ISALLTRUE(a) && ISALLTRUE(b))\n\t\t\t*result = true;\n\t\telse if (ISALLTRUE(a))\n\t\t\t*result = false;\n\t\telse if (ISALLTRUE(b))\n\t\t\t*result = false;\n\t\telse\n\t\t{\n\t\t\tint32\t\ti;\n\t\t\tBITVECP\t\tsa = GETSIGN(a),\n\t\t\t\t\t\tsb = GETSIGN(b);\n\n\t\t\t*result = true;\n\t\t\tLOOPBYTE\n\t\t\t{\n\t\t\t\tif (sa[i] != sb[i])\n\t\t\t\t{\n\t\t\t\t\t*result = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\t\t\t\t\t\t\t/* a and b ISARRKEY */\n\t\tint32\t\tlena = ARRNELEM(a),\n\t\t\t\t\tlenb = ARRNELEM(b);\n\n\t\tif (lena != lenb)\n\t\t\t*result = false;\n\t\telse\n\t\t{\n\t\t\tint32\t   *ptra = GETARR(a),\n\t\t\t\t\t   *ptrb = GETARR(b);\n\t\t\tint32\t\ti;\n\n\t\t\t*result = true;\n\t\t\tfor (i = 0; i < lena; i++)\n\t\t\t\tif (ptra[i] != ptrb[i])\n\t\t\t\t{\n\t\t\t\t\t*result = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\t}\n\n\tPG_RETURN_POINTER(result);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "result"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETARR",
          "args": [
            "b"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETARR",
          "args": [
            "a"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRNELEM",
          "args": [
            "b"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRNELEM",
          "args": [
            "a"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "b"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "a"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "b"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "a"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "b"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "a"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISSIGNKEY",
          "args": [
            "a"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "2"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "1"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nDatum\ngtsvector_same(PG_FUNCTION_ARGS)\n{\n\tSignTSVector *a = (SignTSVector *) PG_GETARG_POINTER(0);\n\tSignTSVector *b = (SignTSVector *) PG_GETARG_POINTER(1);\n\tbool\t   *result = (bool *) PG_GETARG_POINTER(2);\n\n\tif (ISSIGNKEY(a))\n\t{\t\t\t\t\t\t\t/* then b also ISSIGNKEY */\n\t\tif (ISALLTRUE(a) && ISALLTRUE(b))\n\t\t\t*result = true;\n\t\telse if (ISALLTRUE(a))\n\t\t\t*result = false;\n\t\telse if (ISALLTRUE(b))\n\t\t\t*result = false;\n\t\telse\n\t\t{\n\t\t\tint32\t\ti;\n\t\t\tBITVECP\t\tsa = GETSIGN(a),\n\t\t\t\t\t\tsb = GETSIGN(b);\n\n\t\t\t*result = true;\n\t\t\tLOOPBYTE\n\t\t\t{\n\t\t\t\tif (sa[i] != sb[i])\n\t\t\t\t{\n\t\t\t\t\t*result = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\t\t\t\t\t\t\t/* a and b ISARRKEY */\n\t\tint32\t\tlena = ARRNELEM(a),\n\t\t\t\t\tlenb = ARRNELEM(b);\n\n\t\tif (lena != lenb)\n\t\t\t*result = false;\n\t\telse\n\t\t{\n\t\t\tint32\t   *ptra = GETARR(a),\n\t\t\t\t\t   *ptrb = GETARR(b);\n\t\t\tint32\t\ti;\n\n\t\t\t*result = true;\n\t\t\tfor (i = 0; i < lena; i++)\n\t\t\t\tif (ptra[i] != ptrb[i])\n\t\t\t\t{\n\t\t\t\t\t*result = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\t}\n\n\tPG_RETURN_POINTER(result);\n}"
  },
  {
    "function_name": "gtsvector_union",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "412-443",
    "snippet": "Datum\ngtsvector_union(PG_FUNCTION_ARGS)\n{\n\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);\n\tint\t\t   *size = (int *) PG_GETARG_POINTER(1);\n\tBITVEC\t\tbase;\n\tint32\t\ti,\n\t\t\t\tlen;\n\tint32\t\tflag = 0;\n\tSignTSVector *result;\n\n\tMemSet((void *) base, 0, sizeof(BITVEC));\n\tfor (i = 0; i < entryvec->n; i++)\n\t{\n\t\tif (unionkey(base, GETENTRY(entryvec, i)))\n\t\t{\n\t\t\tflag = ALLISTRUE;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tflag |= SIGNKEY;\n\tlen = CALCGTSIZE(flag, 0);\n\tresult = (SignTSVector *) palloc(len);\n\t*size = len;\n\tSET_VARSIZE(result, len);\n\tresult->flag = flag;\n\tif (!ISALLTRUE(result))\n\t\tmemcpy((void *) GETSIGN(result), (void *) base, sizeof(BITVEC));\n\n\tPG_RETURN_POINTER(result);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define ALLISTRUE\t0x04",
      "#define SIGNKEY\t\t0x02"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "result"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(void *) GETSIGN(result)",
            "(void *) base",
            "sizeof(BITVEC)"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "result"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "result"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "result",
            "len"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "len"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "flag",
            "0"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unionkey",
          "args": [
            "base",
            "GETENTRY(entryvec, i)"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "unionkey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "386-409",
          "snippet": "static int32\nunionkey(BITVECP sbase, SignTSVector *add)\n{\n\tint32\t\ti;\n\n\tif (ISSIGNKEY(add))\n\t{\n\t\tBITVECP\t\tsadd = GETSIGN(add);\n\n\t\tif (ISALLTRUE(add))\n\t\t\treturn 1;\n\n\t\tLOOPBYTE\n\t\t\tsbase[i] |= sadd[i];\n\t}\n\telse\n\t{\n\t\tint32\t   *ptr = GETARR(add);\n\n\t\tfor (i = 0; i < ARRNELEM(add); i++)\n\t\t\tHASH(sbase, ptr[i]);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic int32\nunionkey(BITVECP sbase, SignTSVector *add)\n{\n\tint32\t\ti;\n\n\tif (ISSIGNKEY(add))\n\t{\n\t\tBITVECP\t\tsadd = GETSIGN(add);\n\n\t\tif (ISALLTRUE(add))\n\t\t\treturn 1;\n\n\t\tLOOPBYTE\n\t\t\tsbase[i] |= sadd[i];\n\t}\n\telse\n\t{\n\t\tint32\t   *ptr = GETARR(add);\n\n\t\tfor (i = 0; i < ARRNELEM(add); i++)\n\t\t\tHASH(sbase, ptr[i]);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "i"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "(void *) base",
            "0",
            "sizeof(BITVEC)"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "1"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define ALLISTRUE\t0x04\n#define SIGNKEY\t\t0x02\n\nDatum\ngtsvector_union(PG_FUNCTION_ARGS)\n{\n\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);\n\tint\t\t   *size = (int *) PG_GETARG_POINTER(1);\n\tBITVEC\t\tbase;\n\tint32\t\ti,\n\t\t\t\tlen;\n\tint32\t\tflag = 0;\n\tSignTSVector *result;\n\n\tMemSet((void *) base, 0, sizeof(BITVEC));\n\tfor (i = 0; i < entryvec->n; i++)\n\t{\n\t\tif (unionkey(base, GETENTRY(entryvec, i)))\n\t\t{\n\t\t\tflag = ALLISTRUE;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tflag |= SIGNKEY;\n\tlen = CALCGTSIZE(flag, 0);\n\tresult = (SignTSVector *) palloc(len);\n\t*size = len;\n\tSET_VARSIZE(result, len);\n\tresult->flag = flag;\n\tif (!ISALLTRUE(result))\n\t\tmemcpy((void *) GETSIGN(result), (void *) base, sizeof(BITVEC));\n\n\tPG_RETURN_POINTER(result);\n}"
  },
  {
    "function_name": "unionkey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "386-409",
    "snippet": "static int32\nunionkey(BITVECP sbase, SignTSVector *add)\n{\n\tint32\t\ti;\n\n\tif (ISSIGNKEY(add))\n\t{\n\t\tBITVECP\t\tsadd = GETSIGN(add);\n\n\t\tif (ISALLTRUE(add))\n\t\t\treturn 1;\n\n\t\tLOOPBYTE\n\t\t\tsbase[i] |= sadd[i];\n\t}\n\telse\n\t{\n\t\tint32\t   *ptr = GETARR(add);\n\n\t\tfor (i = 0; i < ARRNELEM(add); i++)\n\t\t\tHASH(sbase, ptr[i]);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HASH",
          "args": [
            "sbase",
            "ptr[i]"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRNELEM",
          "args": [
            "add"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETARR",
          "args": [
            "add"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "add"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "add"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISSIGNKEY",
          "args": [
            "add"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic int32\nunionkey(BITVECP sbase, SignTSVector *add)\n{\n\tint32\t\ti;\n\n\tif (ISSIGNKEY(add))\n\t{\n\t\tBITVECP\t\tsadd = GETSIGN(add);\n\n\t\tif (ISALLTRUE(add))\n\t\t\treturn 1;\n\n\t\tLOOPBYTE\n\t\t\tsbase[i] |= sadd[i];\n\t}\n\telse\n\t{\n\t\tint32\t   *ptr = GETARR(add);\n\n\t\tfor (i = 0; i < ARRNELEM(add); i++)\n\t\t\tHASH(sbase, ptr[i]);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "gtsvector_consistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "345-384",
    "snippet": "Datum\ngtsvector_consistent(PG_FUNCTION_ARGS)\n{\n\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);\n\tTSQuery\t\tquery = PG_GETARG_TSQUERY(1);\n\n\t/* StrategyNumber strategy = (StrategyNumber) PG_GETARG_UINT16(2); */\n\t/* Oid\t\tsubtype = PG_GETARG_OID(3); */\n\tbool\t   *recheck = (bool *) PG_GETARG_POINTER(4);\n\tSignTSVector *key = (SignTSVector *) DatumGetPointer(entry->key);\n\n\t/* All cases served by this function are inexact */\n\t*recheck = true;\n\n\tif (!query->size)\n\t\tPG_RETURN_BOOL(false);\n\n\tif (ISSIGNKEY(key))\n\t{\n\t\tif (ISALLTRUE(key))\n\t\t\tPG_RETURN_BOOL(true);\n\n\t\t/* since signature is lossy, cannot specify CALC_NOT here */\n\t\tPG_RETURN_BOOL(TS_execute(GETQUERY(query),\n\t\t\t\t\t\t\t\t  (void *) GETSIGN(key),\n\t\t\t\t\t\t\t\t  TS_EXEC_PHRASE_NO_POS,\n\t\t\t\t\t\t\t\t  checkcondition_bit));\n\t}\n\telse\n\t{\t\t\t\t\t\t\t/* only leaf pages */\n\t\tCHKVAL\t\tchkval;\n\n\t\tchkval.arrb = GETARR(key);\n\t\tchkval.arre = chkval.arrb + ARRNELEM(key);\n\t\tPG_RETURN_BOOL(TS_execute(GETQUERY(query),\n\t\t\t\t\t\t\t\t  (void *) &chkval,\n\t\t\t\t\t\t\t\t  TS_EXEC_PHRASE_NO_POS | TS_EXEC_CALC_NOT,\n\t\t\t\t\t\t\t\t  checkcondition_arr));\n\t}\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "TS_execute(GETQUERY(query),\n\t\t\t\t\t\t\t\t  (void *) &chkval,\n\t\t\t\t\t\t\t\t  TS_EXEC_PHRASE_NO_POS | TS_EXEC_CALC_NOT,\n\t\t\t\t\t\t\t\t  checkcondition_arr)"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TS_execute",
          "args": [
            "GETQUERY(query)",
            "(void *) &chkval",
            "TS_EXEC_PHRASE_NO_POS | TS_EXEC_CALC_NOT",
            "checkcondition_arr"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "TS_execute",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsvector_op.c",
          "lines": "1814-1854",
          "snippet": "bool\nTS_execute(QueryItem *curitem, void *arg, uint32 flags,\n\t\t   TSExecuteCallback chkcond)\n{\n\t/* since this function recurses, it could be driven to stack overflow */\n\tcheck_stack_depth();\n\n\tif (curitem->type == QI_VAL)\n\t\treturn chkcond(arg, (QueryOperand *) curitem,\n\t\t\t\t\t   NULL /* we don't need position info */ );\n\n\tswitch (curitem->qoperator.oper)\n\t{\n\t\tcase OP_NOT:\n\t\t\tif (flags & TS_EXEC_CALC_NOT)\n\t\t\t\treturn !TS_execute(curitem + 1, arg, flags, chkcond);\n\t\t\telse\n\t\t\t\treturn true;\n\n\t\tcase OP_AND:\n\t\t\tif (TS_execute(curitem + curitem->qoperator.left, arg, flags, chkcond))\n\t\t\t\treturn TS_execute(curitem + 1, arg, flags, chkcond);\n\t\t\telse\n\t\t\t\treturn false;\n\n\t\tcase OP_OR:\n\t\t\tif (TS_execute(curitem + curitem->qoperator.left, arg, flags, chkcond))\n\t\t\t\treturn true;\n\t\t\telse\n\t\t\t\treturn TS_execute(curitem + 1, arg, flags, chkcond);\n\n\t\tcase OP_PHRASE:\n\t\t\treturn TS_phrase_execute(curitem, arg, flags, chkcond, NULL);\n\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized operator: %d\", curitem->qoperator.oper);\n\t}\n\n\t/* not reachable, but keep compiler quiet */\n\treturn false;\n}",
          "includes": [
            "#include \"utils/rel.h\"",
            "#include \"utils/regproc.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"parser/parse_coerce.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"funcapi.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/trigger.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <limits.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/rel.h\"\n#include \"utils/regproc.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"parser/parse_coerce.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"funcapi.h\"\n#include \"executor/spi.h\"\n#include \"commands/trigger.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nbool\nTS_execute(QueryItem *curitem, void *arg, uint32 flags,\n\t\t   TSExecuteCallback chkcond)\n{\n\t/* since this function recurses, it could be driven to stack overflow */\n\tcheck_stack_depth();\n\n\tif (curitem->type == QI_VAL)\n\t\treturn chkcond(arg, (QueryOperand *) curitem,\n\t\t\t\t\t   NULL /* we don't need position info */ );\n\n\tswitch (curitem->qoperator.oper)\n\t{\n\t\tcase OP_NOT:\n\t\t\tif (flags & TS_EXEC_CALC_NOT)\n\t\t\t\treturn !TS_execute(curitem + 1, arg, flags, chkcond);\n\t\t\telse\n\t\t\t\treturn true;\n\n\t\tcase OP_AND:\n\t\t\tif (TS_execute(curitem + curitem->qoperator.left, arg, flags, chkcond))\n\t\t\t\treturn TS_execute(curitem + 1, arg, flags, chkcond);\n\t\t\telse\n\t\t\t\treturn false;\n\n\t\tcase OP_OR:\n\t\t\tif (TS_execute(curitem + curitem->qoperator.left, arg, flags, chkcond))\n\t\t\t\treturn true;\n\t\t\telse\n\t\t\t\treturn TS_execute(curitem + 1, arg, flags, chkcond);\n\n\t\tcase OP_PHRASE:\n\t\t\treturn TS_phrase_execute(curitem, arg, flags, chkcond, NULL);\n\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized operator: %d\", curitem->qoperator.oper);\n\t}\n\n\t/* not reachable, but keep compiler quiet */\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETQUERY",
          "args": [
            "query"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRNELEM",
          "args": [
            "key"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETARR",
          "args": [
            "key"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "TS_execute(GETQUERY(query),\n\t\t\t\t\t\t\t\t  (void *) GETSIGN(key),\n\t\t\t\t\t\t\t\t  TS_EXEC_PHRASE_NO_POS,\n\t\t\t\t\t\t\t\t  checkcondition_bit)"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "key"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETQUERY",
          "args": [
            "query"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "true"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "key"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISSIGNKEY",
          "args": [
            "key"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "false"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "entry->key"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "4"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TSQUERY",
          "args": [
            "1"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nDatum\ngtsvector_consistent(PG_FUNCTION_ARGS)\n{\n\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);\n\tTSQuery\t\tquery = PG_GETARG_TSQUERY(1);\n\n\t/* StrategyNumber strategy = (StrategyNumber) PG_GETARG_UINT16(2); */\n\t/* Oid\t\tsubtype = PG_GETARG_OID(3); */\n\tbool\t   *recheck = (bool *) PG_GETARG_POINTER(4);\n\tSignTSVector *key = (SignTSVector *) DatumGetPointer(entry->key);\n\n\t/* All cases served by this function are inexact */\n\t*recheck = true;\n\n\tif (!query->size)\n\t\tPG_RETURN_BOOL(false);\n\n\tif (ISSIGNKEY(key))\n\t{\n\t\tif (ISALLTRUE(key))\n\t\t\tPG_RETURN_BOOL(true);\n\n\t\t/* since signature is lossy, cannot specify CALC_NOT here */\n\t\tPG_RETURN_BOOL(TS_execute(GETQUERY(query),\n\t\t\t\t\t\t\t\t  (void *) GETSIGN(key),\n\t\t\t\t\t\t\t\t  TS_EXEC_PHRASE_NO_POS,\n\t\t\t\t\t\t\t\t  checkcondition_bit));\n\t}\n\telse\n\t{\t\t\t\t\t\t\t/* only leaf pages */\n\t\tCHKVAL\t\tchkval;\n\n\t\tchkval.arrb = GETARR(key);\n\t\tchkval.arre = chkval.arrb + ARRNELEM(key);\n\t\tPG_RETURN_BOOL(TS_execute(GETQUERY(query),\n\t\t\t\t\t\t\t\t  (void *) &chkval,\n\t\t\t\t\t\t\t\t  TS_EXEC_PHRASE_NO_POS | TS_EXEC_CALC_NOT,\n\t\t\t\t\t\t\t\t  checkcondition_arr));\n\t}\n}"
  },
  {
    "function_name": "checkcondition_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "334-343",
    "snippet": "static bool\ncheckcondition_bit(void *checkval, QueryOperand *val, ExecPhraseData *data)\n{\n\t/*\n\t * we are not able to find a prefix in signature tree\n\t */\n\tif (val->prefix)\n\t\treturn true;\n\treturn GETBIT(checkval, HASHVAL(val->valcrc));\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GETBIT",
          "args": [
            "checkval",
            "HASHVAL(val->valcrc)"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HASHVAL",
          "args": [
            "val->valcrc"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic bool\ncheckcondition_bit(void *checkval, QueryOperand *val, ExecPhraseData *data)\n{\n\t/*\n\t * we are not able to find a prefix in signature tree\n\t */\n\tif (val->prefix)\n\t\treturn true;\n\treturn GETBIT(checkval, HASHVAL(val->valcrc));\n}"
  },
  {
    "function_name": "checkcondition_arr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "305-332",
    "snippet": "static bool\ncheckcondition_arr(void *checkval, QueryOperand *val, ExecPhraseData *data)\n{\n\tint32\t   *StopLow = ((CHKVAL *) checkval)->arrb;\n\tint32\t   *StopHigh = ((CHKVAL *) checkval)->arre;\n\tint32\t   *StopMiddle;\n\n\t/* Loop invariant: StopLow <= val < StopHigh */\n\n\t/*\n\t * we are not able to find a prefix by hash value\n\t */\n\tif (val->prefix)\n\t\treturn true;\n\n\twhile (StopLow < StopHigh)\n\t{\n\t\tStopMiddle = StopLow + (StopHigh - StopLow) / 2;\n\t\tif (*StopMiddle == val->valcrc)\n\t\t\treturn true;\n\t\telse if (*StopMiddle < val->valcrc)\n\t\t\tStopLow = StopMiddle + 1;\n\t\telse\n\t\t\tStopHigh = StopMiddle;\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic bool\ncheckcondition_arr(void *checkval, QueryOperand *val, ExecPhraseData *data)\n{\n\tint32\t   *StopLow = ((CHKVAL *) checkval)->arrb;\n\tint32\t   *StopHigh = ((CHKVAL *) checkval)->arre;\n\tint32\t   *StopMiddle;\n\n\t/* Loop invariant: StopLow <= val < StopHigh */\n\n\t/*\n\t * we are not able to find a prefix by hash value\n\t */\n\tif (val->prefix)\n\t\treturn true;\n\n\twhile (StopLow < StopHigh)\n\t{\n\t\tStopMiddle = StopLow + (StopHigh - StopLow) / 2;\n\t\tif (*StopMiddle == val->valcrc)\n\t\t\treturn true;\n\t\telse if (*StopMiddle < val->valcrc)\n\t\t\tStopLow = StopMiddle + 1;\n\t\telse\n\t\t\tStopHigh = StopMiddle;\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "gtsvector_decompress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "272-294",
    "snippet": "Datum\ngtsvector_decompress(PG_FUNCTION_ARGS)\n{\n\t/*\n\t * We need to detoast the stored value, because the other gtsvector\n\t * support functions don't cope with toasted values.\n\t */\n\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);\n\tSignTSVector *key = (SignTSVector *) PG_DETOAST_DATUM(entry->key);\n\n\tif (key != (SignTSVector *) DatumGetPointer(entry->key))\n\t{\n\t\tGISTENTRY  *retval = (GISTENTRY *) palloc(sizeof(GISTENTRY));\n\n\t\tgistentryinit(*retval, PointerGetDatum(key),\n\t\t\t\t\t  entry->rel, entry->page,\n\t\t\t\t\t  entry->offset, false);\n\n\t\tPG_RETURN_POINTER(retval);\n\t}\n\n\tPG_RETURN_POINTER(entry);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "entry"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "retval"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gistentryinit",
          "args": [
            "*retval",
            "PointerGetDatum(key)",
            "entry->rel",
            "entry->page",
            "entry->offset",
            "false"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerGetDatum",
          "args": [
            "key"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(GISTENTRY)"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "entry->key"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_DETOAST_DATUM",
          "args": [
            "entry->key"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nDatum\ngtsvector_decompress(PG_FUNCTION_ARGS)\n{\n\t/*\n\t * We need to detoast the stored value, because the other gtsvector\n\t * support functions don't cope with toasted values.\n\t */\n\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);\n\tSignTSVector *key = (SignTSVector *) PG_DETOAST_DATUM(entry->key);\n\n\tif (key != (SignTSVector *) DatumGetPointer(entry->key))\n\t{\n\t\tGISTENTRY  *retval = (GISTENTRY *) palloc(sizeof(GISTENTRY));\n\n\t\tgistentryinit(*retval, PointerGetDatum(key),\n\t\t\t\t\t  entry->rel, entry->page,\n\t\t\t\t\t  entry->offset, false);\n\n\t\tPG_RETURN_POINTER(retval);\n\t}\n\n\tPG_RETURN_POINTER(entry);\n}"
  },
  {
    "function_name": "gtsvector_compress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "181-270",
    "snippet": "Datum\ngtsvector_compress(PG_FUNCTION_ARGS)\n{\n\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);\n\tGISTENTRY  *retval = entry;\n\n\tif (entry->leafkey)\n\t{\t\t\t\t\t\t\t/* tsvector */\n\t\tSignTSVector *res;\n\t\tTSVector\tval = DatumGetTSVector(entry->key);\n\t\tint32\t\tlen;\n\t\tint32\t   *arr;\n\t\tWordEntry  *ptr = ARRPTR(val);\n\t\tchar\t   *words = STRPTR(val);\n\n\t\tlen = CALCGTSIZE(ARRKEY, val->size);\n\t\tres = (SignTSVector *) palloc(len);\n\t\tSET_VARSIZE(res, len);\n\t\tres->flag = ARRKEY;\n\t\tarr = GETARR(res);\n\t\tlen = val->size;\n\t\twhile (len--)\n\t\t{\n\t\t\tpg_crc32\tc;\n\n\t\t\tINIT_LEGACY_CRC32(c);\n\t\t\tCOMP_LEGACY_CRC32(c, words + ptr->pos, ptr->len);\n\t\t\tFIN_LEGACY_CRC32(c);\n\n\t\t\t*arr = *(int32 *) &c;\n\t\t\tarr++;\n\t\t\tptr++;\n\t\t}\n\n\t\tlen = uniqueint(GETARR(res), val->size);\n\t\tif (len != val->size)\n\t\t{\n\t\t\t/*\n\t\t\t * there is a collision of hash-function; len is always less than\n\t\t\t * val->size\n\t\t\t */\n\t\t\tlen = CALCGTSIZE(ARRKEY, len);\n\t\t\tres = (SignTSVector *) repalloc((void *) res, len);\n\t\t\tSET_VARSIZE(res, len);\n\t\t}\n\n\t\t/* make signature, if array is too long */\n\t\tif (VARSIZE(res) > TOAST_INDEX_TARGET)\n\t\t{\n\t\t\tSignTSVector *ressign;\n\n\t\t\tlen = CALCGTSIZE(SIGNKEY, 0);\n\t\t\tressign = (SignTSVector *) palloc(len);\n\t\t\tSET_VARSIZE(ressign, len);\n\t\t\tressign->flag = SIGNKEY;\n\t\t\tmakesign(GETSIGN(ressign), res);\n\t\t\tres = ressign;\n\t\t}\n\n\t\tretval = (GISTENTRY *) palloc(sizeof(GISTENTRY));\n\t\tgistentryinit(*retval, PointerGetDatum(res),\n\t\t\t\t\t  entry->rel, entry->page,\n\t\t\t\t\t  entry->offset, false);\n\t}\n\telse if (ISSIGNKEY(DatumGetPointer(entry->key)) &&\n\t\t\t !ISALLTRUE(DatumGetPointer(entry->key)))\n\t{\n\t\tint32\t\ti,\n\t\t\t\t\tlen;\n\t\tSignTSVector *res;\n\t\tBITVECP\t\tsign = GETSIGN(DatumGetPointer(entry->key));\n\n\t\tLOOPBYTE\n\t\t{\n\t\t\tif ((sign[i] & 0xff) != 0xff)\n\t\t\t\tPG_RETURN_POINTER(retval);\n\t\t}\n\n\t\tlen = CALCGTSIZE(SIGNKEY | ALLISTRUE, 0);\n\t\tres = (SignTSVector *) palloc(len);\n\t\tSET_VARSIZE(res, len);\n\t\tres->flag = SIGNKEY | ALLISTRUE;\n\n\t\tretval = (GISTENTRY *) palloc(sizeof(GISTENTRY));\n\t\tgistentryinit(*retval, PointerGetDatum(res),\n\t\t\t\t\t  entry->rel, entry->page,\n\t\t\t\t\t  entry->offset, false);\n\t}\n\tPG_RETURN_POINTER(retval);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define ALLISTRUE\t0x04",
      "#define SIGNKEY\t\t0x02",
      "#define ARRKEY\t\t0x01",
      "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
    ],
    "globals_used": [
      "static int32 sizebitvec(BITVECP sign);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "retval"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gistentryinit",
          "args": [
            "*retval",
            "PointerGetDatum(res)",
            "entry->rel",
            "entry->page",
            "entry->offset",
            "false"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerGetDatum",
          "args": [
            "res"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(GISTENTRY)"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "res",
            "len"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "SIGNKEY | ALLISTRUE",
            "0"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "retval"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "DatumGetPointer(entry->key)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "entry->key"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "DatumGetPointer(entry->key)"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "entry->key"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISSIGNKEY",
          "args": [
            "DatumGetPointer(entry->key)"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "entry->key"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gistentryinit",
          "args": [
            "*retval",
            "PointerGetDatum(res)",
            "entry->rel",
            "entry->page",
            "entry->offset",
            "false"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerGetDatum",
          "args": [
            "res"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makesign",
          "args": [
            "GETSIGN(ressign)",
            "res"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "makesign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "169-179",
          "snippet": "static void\nmakesign(BITVECP sign, SignTSVector *a)\n{\n\tint32\t\tk,\n\t\t\t\tlen = ARRNELEM(a);\n\tint32\t   *ptr = GETARR(a);\n\n\tMemSet((void *) sign, 0, sizeof(BITVEC));\n\tfor (k = 0; k < len; k++)\n\t\tHASH(sign, ptr[k]);\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic void\nmakesign(BITVECP sign, SignTSVector *a)\n{\n\tint32\t\tk,\n\t\t\t\tlen = ARRNELEM(a);\n\tint32\t   *ptr = GETARR(a);\n\n\tMemSet((void *) sign, 0, sizeof(BITVEC));\n\tfor (k = 0; k < len; k++)\n\t\tHASH(sign, ptr[k]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "ressign"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "ressign",
            "len"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "SIGNKEY",
            "0"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARSIZE",
          "args": [
            "res"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "res",
            "len"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "repalloc",
          "args": [
            "(void *) res",
            "len"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "xml_repalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1642-1646",
          "snippet": "static void *\nxml_repalloc(void *ptr, size_t size)\n{\n\treturn repalloc(ptr, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_repalloc(void *ptr, size_t size)\n{\n\treturn repalloc(ptr, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "ARRKEY",
            "len"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uniqueint",
          "args": [
            "GETARR(res)",
            "val->size"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "uniqueint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "148-167",
          "snippet": "static int\nuniqueint(int32 *a, int32 l)\n{\n\tint32\t   *ptr,\n\t\t\t   *res;\n\n\tif (l <= 1)\n\t\treturn l;\n\n\tptr = res = a;\n\n\tqsort((void *) a, l, sizeof(int32), compareint);\n\n\twhile (ptr - a < l)\n\t\tif (*ptr != *res)\n\t\t\t*(++res) = *ptr++;\n\t\telse\n\t\t\tptr++;\n\treturn res + 1 - a;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic int\nuniqueint(int32 *a, int32 l)\n{\n\tint32\t   *ptr,\n\t\t\t   *res;\n\n\tif (l <= 1)\n\t\treturn l;\n\n\tptr = res = a;\n\n\tqsort((void *) a, l, sizeof(int32), compareint);\n\n\twhile (ptr - a < l)\n\t\tif (*ptr != *res)\n\t\t\t*(++res) = *ptr++;\n\t\telse\n\t\t\tptr++;\n\treturn res + 1 - a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETARR",
          "args": [
            "res"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FIN_LEGACY_CRC32",
          "args": [
            "c"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COMP_LEGACY_CRC32",
          "args": [
            "c",
            "words + ptr->pos",
            "ptr->len"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LEGACY_CRC32",
          "args": [
            "c"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETARR",
          "args": [
            "res"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "res",
            "len"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CALCGTSIZE",
          "args": [
            "ARRKEY",
            "val->size"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPTR",
          "args": [
            "val"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRPTR",
          "args": [
            "val"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetTSVector",
          "args": [
            "entry->key"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define ALLISTRUE\t0x04\n#define SIGNKEY\t\t0x02\n#define ARRKEY\t\t0x01\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic int32 sizebitvec(BITVECP sign);\n\nDatum\ngtsvector_compress(PG_FUNCTION_ARGS)\n{\n\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);\n\tGISTENTRY  *retval = entry;\n\n\tif (entry->leafkey)\n\t{\t\t\t\t\t\t\t/* tsvector */\n\t\tSignTSVector *res;\n\t\tTSVector\tval = DatumGetTSVector(entry->key);\n\t\tint32\t\tlen;\n\t\tint32\t   *arr;\n\t\tWordEntry  *ptr = ARRPTR(val);\n\t\tchar\t   *words = STRPTR(val);\n\n\t\tlen = CALCGTSIZE(ARRKEY, val->size);\n\t\tres = (SignTSVector *) palloc(len);\n\t\tSET_VARSIZE(res, len);\n\t\tres->flag = ARRKEY;\n\t\tarr = GETARR(res);\n\t\tlen = val->size;\n\t\twhile (len--)\n\t\t{\n\t\t\tpg_crc32\tc;\n\n\t\t\tINIT_LEGACY_CRC32(c);\n\t\t\tCOMP_LEGACY_CRC32(c, words + ptr->pos, ptr->len);\n\t\t\tFIN_LEGACY_CRC32(c);\n\n\t\t\t*arr = *(int32 *) &c;\n\t\t\tarr++;\n\t\t\tptr++;\n\t\t}\n\n\t\tlen = uniqueint(GETARR(res), val->size);\n\t\tif (len != val->size)\n\t\t{\n\t\t\t/*\n\t\t\t * there is a collision of hash-function; len is always less than\n\t\t\t * val->size\n\t\t\t */\n\t\t\tlen = CALCGTSIZE(ARRKEY, len);\n\t\t\tres = (SignTSVector *) repalloc((void *) res, len);\n\t\t\tSET_VARSIZE(res, len);\n\t\t}\n\n\t\t/* make signature, if array is too long */\n\t\tif (VARSIZE(res) > TOAST_INDEX_TARGET)\n\t\t{\n\t\t\tSignTSVector *ressign;\n\n\t\t\tlen = CALCGTSIZE(SIGNKEY, 0);\n\t\t\tressign = (SignTSVector *) palloc(len);\n\t\t\tSET_VARSIZE(ressign, len);\n\t\t\tressign->flag = SIGNKEY;\n\t\t\tmakesign(GETSIGN(ressign), res);\n\t\t\tres = ressign;\n\t\t}\n\n\t\tretval = (GISTENTRY *) palloc(sizeof(GISTENTRY));\n\t\tgistentryinit(*retval, PointerGetDatum(res),\n\t\t\t\t\t  entry->rel, entry->page,\n\t\t\t\t\t  entry->offset, false);\n\t}\n\telse if (ISSIGNKEY(DatumGetPointer(entry->key)) &&\n\t\t\t !ISALLTRUE(DatumGetPointer(entry->key)))\n\t{\n\t\tint32\t\ti,\n\t\t\t\t\tlen;\n\t\tSignTSVector *res;\n\t\tBITVECP\t\tsign = GETSIGN(DatumGetPointer(entry->key));\n\n\t\tLOOPBYTE\n\t\t{\n\t\t\tif ((sign[i] & 0xff) != 0xff)\n\t\t\t\tPG_RETURN_POINTER(retval);\n\t\t}\n\n\t\tlen = CALCGTSIZE(SIGNKEY | ALLISTRUE, 0);\n\t\tres = (SignTSVector *) palloc(len);\n\t\tSET_VARSIZE(res, len);\n\t\tres->flag = SIGNKEY | ALLISTRUE;\n\n\t\tretval = (GISTENTRY *) palloc(sizeof(GISTENTRY));\n\t\tgistentryinit(*retval, PointerGetDatum(res),\n\t\t\t\t\t  entry->rel, entry->page,\n\t\t\t\t\t  entry->offset, false);\n\t}\n\tPG_RETURN_POINTER(retval);\n}"
  },
  {
    "function_name": "makesign",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "169-179",
    "snippet": "static void\nmakesign(BITVECP sign, SignTSVector *a)\n{\n\tint32\t\tk,\n\t\t\t\tlen = ARRNELEM(a);\n\tint32\t   *ptr = GETARR(a);\n\n\tMemSet((void *) sign, 0, sizeof(BITVEC));\n\tfor (k = 0; k < len; k++)\n\t\tHASH(sign, ptr[k]);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 sizebitvec(BITVECP sign);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "HASH",
          "args": [
            "sign",
            "ptr[k]"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "(void *) sign",
            "0",
            "sizeof(BITVEC)"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETARR",
          "args": [
            "a"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRNELEM",
          "args": [
            "a"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic void\nmakesign(BITVECP sign, SignTSVector *a)\n{\n\tint32\t\tk,\n\t\t\t\tlen = ARRNELEM(a);\n\tint32\t   *ptr = GETARR(a);\n\n\tMemSet((void *) sign, 0, sizeof(BITVEC));\n\tfor (k = 0; k < len; k++)\n\t\tHASH(sign, ptr[k]);\n}"
  },
  {
    "function_name": "uniqueint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "148-167",
    "snippet": "static int\nuniqueint(int32 *a, int32 l)\n{\n\tint32\t   *ptr,\n\t\t\t   *res;\n\n\tif (l <= 1)\n\t\treturn l;\n\n\tptr = res = a;\n\n\tqsort((void *) a, l, sizeof(int32), compareint);\n\n\twhile (ptr - a < l)\n\t\tif (*ptr != *res)\n\t\t\t*(++res) = *ptr++;\n\t\telse\n\t\t\tptr++;\n\treturn res + 1 - a;\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qsort",
          "args": [
            "(void *) a",
            "l",
            "sizeof(int32)",
            "compareint"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic int\nuniqueint(int32 *a, int32 l)\n{\n\tint32\t   *ptr,\n\t\t\t   *res;\n\n\tif (l <= 1)\n\t\treturn l;\n\n\tptr = res = a;\n\n\tqsort((void *) a, l, sizeof(int32), compareint);\n\n\twhile (ptr - a < l)\n\t\tif (*ptr != *res)\n\t\t\t*(++res) = *ptr++;\n\t\telse\n\t\t\tptr++;\n\treturn res + 1 - a;\n}"
  },
  {
    "function_name": "compareint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "133-142",
    "snippet": "static int\ncompareint(const void *va, const void *vb)\n{\n\tint32\t\ta = *((const int32 *) va);\n\tint32\t\tb = *((const int32 *) vb);\n\n\tif (a == b)\n\t\treturn 0;\n\treturn (a > b) ? 1 : -1;\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nstatic int\ncompareint(const void *va, const void *vb)\n{\n\tint32\t\ta = *((const int32 *) va);\n\tint32\t\tb = *((const int32 *) vb);\n\n\tif (a == b)\n\t\treturn 0;\n\treturn (a > b) ? 1 : -1;\n}"
  },
  {
    "function_name": "gtsvectorout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "110-131",
    "snippet": "Datum\ngtsvectorout(PG_FUNCTION_ARGS)\n{\n\tSignTSVector *key = (SignTSVector *) PG_DETOAST_DATUM(PG_GETARG_POINTER(0));\n\tchar\t   *outbuf;\n\n\tif (outbuf_maxlen == 0)\n\t\toutbuf_maxlen = 2 * EXTRALEN + Max(strlen(SINGOUTSTR), strlen(ARROUTSTR)) + 1;\n\toutbuf = palloc(outbuf_maxlen);\n\n\tif (ISARRKEY(key))\n\t\tsprintf(outbuf, ARROUTSTR, (int) ARRNELEM(key));\n\telse\n\t{\n\t\tint\t\t\tcnttrue = (ISALLTRUE(key)) ? SIGLENBIT : sizebitvec(GETSIGN(key));\n\n\t\tsprintf(outbuf, SINGOUTSTR, cnttrue, (int) SIGLENBIT - cnttrue);\n\t}\n\n\tPG_FREE_IF_COPY(key, 0);\n\tPG_RETURN_POINTER(outbuf);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define EXTRALEN\t( 2*13 )",
      "#define ARROUTSTR\t\"%d unique words\"",
      "#define SINGOUTSTR\t\"%d true bits, %d false bits\"",
      "#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)"
    ],
    "globals_used": [
      "static int\toutbuf_maxlen = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "outbuf"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_FREE_IF_COPY",
          "args": [
            "key",
            "0"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "outbuf",
            "SINGOUTSTR",
            "cnttrue",
            "(int) SIGLENBIT - cnttrue"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sizebitvec",
          "args": [
            "GETSIGN(key)"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "sizebitvec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
          "lines": "503-512",
          "snippet": "static int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}",
          "includes": [
            "#include \"utils/pg_crc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/gist.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)"
          ],
          "globals_used": [
            "static const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};",
            "static int32 sizebitvec(BITVECP sign);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define LOOPBYTE \\\n\t\t\tfor(i=0;i<SIGLEN;i++)\n\nstatic const uint8 number_of_ones[256] = {\n\t0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n\t4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8\n};\nstatic int32 sizebitvec(BITVECP sign);\n\nstatic int32\nsizebitvec(BITVECP sign)\n{\n\tint32\t\tsize = 0,\n\t\t\t\ti;\n\n\tLOOPBYTE\n\t\tsize += number_of_ones[(unsigned char) sign[i]];\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSIGN",
          "args": [
            "key"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISALLTRUE",
          "args": [
            "key"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "outbuf",
            "ARROUTSTR",
            "(int) ARRNELEM(key)"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRNELEM",
          "args": [
            "key"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISARRKEY",
          "args": [
            "key"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "outbuf_maxlen"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Max",
          "args": [
            "strlen(SINGOUTSTR)",
            "strlen(ARROUTSTR)"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "ARROUTSTR"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "calcstrlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_cleanup.c",
          "lines": "361-380",
          "snippet": "static int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nstatic int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_DETOAST_DATUM",
          "args": [
            "PG_GETARG_POINTER(0)"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\n#define EXTRALEN\t( 2*13 )\n#define ARROUTSTR\t\"%d unique words\"\n#define SINGOUTSTR\t\"%d true bits, %d false bits\"\n#define SIGLENBIT (SIGLEN * BITS_PER_BYTE)\n\nstatic int\toutbuf_maxlen = 0;\n\nDatum\ngtsvectorout(PG_FUNCTION_ARGS)\n{\n\tSignTSVector *key = (SignTSVector *) PG_DETOAST_DATUM(PG_GETARG_POINTER(0));\n\tchar\t   *outbuf;\n\n\tif (outbuf_maxlen == 0)\n\t\toutbuf_maxlen = 2 * EXTRALEN + Max(strlen(SINGOUTSTR), strlen(ARROUTSTR)) + 1;\n\toutbuf = palloc(outbuf_maxlen);\n\n\tif (ISARRKEY(key))\n\t\tsprintf(outbuf, ARROUTSTR, (int) ARRNELEM(key));\n\telse\n\t{\n\t\tint\t\t\tcnttrue = (ISALLTRUE(key)) ? SIGLENBIT : sizebitvec(GETSIGN(key));\n\n\t\tsprintf(outbuf, SINGOUTSTR, cnttrue, (int) SIGLENBIT - cnttrue);\n\t}\n\n\tPG_FREE_IF_COPY(key, 0);\n\tPG_RETURN_POINTER(outbuf);\n}"
  },
  {
    "function_name": "gtsvectorin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsgistidx.c",
    "lines": "95-102",
    "snippet": "Datum\ngtsvectorin(PG_FUNCTION_ARGS)\n{\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t errmsg(\"gtsvector_in not implemented\")));\n\tPG_RETURN_DATUM(0);\n}",
    "includes": [
      "#include \"utils/pg_crc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/tuptoaster.h\"",
      "#include \"access/gist.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_DATUM",
          "args": [
            "0"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t errmsg(\"gtsvector_in not implemented\"))"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"gtsvector_in not implemented\""
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_FEATURE_NOT_SUPPORTED"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/pg_crc.h\"\n#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/gist.h\"\n#include \"postgres.h\"\n\nDatum\ngtsvectorin(PG_FUNCTION_ARGS)\n{\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t errmsg(\"gtsvector_in not implemented\")));\n\tPG_RETURN_DATUM(0);\n}"
  }
]