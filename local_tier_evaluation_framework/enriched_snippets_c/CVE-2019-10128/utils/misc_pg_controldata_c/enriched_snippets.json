[
  {
    "function_name": "pg_control_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/misc/pg_controldata.c",
    "lines": "263-349",
    "snippet": "Datum\npg_control_init(PG_FUNCTION_ARGS)\n{\n\tDatum\t\tvalues[12];\n\tbool\t\tnulls[12];\n\tTupleDesc\ttupdesc;\n\tHeapTuple\thtup;\n\tControlFileData *ControlFile;\n\tbool\t\tcrc_ok;\n\n\t/*\n\t * Construct a tuple descriptor for the result row.  This must match this\n\t * function's pg_proc entry!\n\t */\n\ttupdesc = CreateTemplateTupleDesc(12, false);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"max_data_alignment\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"database_block_size\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"blocks_per_segment\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"wal_block_size\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 5, \"bytes_per_wal_segment\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 6, \"max_identifier_length\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 7, \"max_index_columns\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 8, \"max_toast_chunk_size\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 9, \"large_object_chunk_size\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 10, \"float4_pass_by_value\",\n\t\t\t\t\t   BOOLOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 11, \"float8_pass_by_value\",\n\t\t\t\t\t   BOOLOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 12, \"data_page_checksum_version\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\ttupdesc = BlessTupleDesc(tupdesc);\n\n\t/* read the control file */\n\tControlFile = get_controlfile(DataDir, NULL, &crc_ok);\n\tif (!crc_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errmsg(\"calculated CRC checksum does not match value stored in file\")));\n\n\tvalues[0] = Int32GetDatum(ControlFile->maxAlign);\n\tnulls[0] = false;\n\n\tvalues[1] = Int32GetDatum(ControlFile->blcksz);\n\tnulls[1] = false;\n\n\tvalues[2] = Int32GetDatum(ControlFile->relseg_size);\n\tnulls[2] = false;\n\n\tvalues[3] = Int32GetDatum(ControlFile->xlog_blcksz);\n\tnulls[3] = false;\n\n\tvalues[4] = Int32GetDatum(ControlFile->xlog_seg_size);\n\tnulls[4] = false;\n\n\tvalues[5] = Int32GetDatum(ControlFile->nameDataLen);\n\tnulls[5] = false;\n\n\tvalues[6] = Int32GetDatum(ControlFile->indexMaxKeys);\n\tnulls[6] = false;\n\n\tvalues[7] = Int32GetDatum(ControlFile->toast_max_chunk_size);\n\tnulls[7] = false;\n\n\tvalues[8] = Int32GetDatum(ControlFile->loblksize);\n\tnulls[8] = false;\n\n\tvalues[9] = BoolGetDatum(ControlFile->float4ByVal);\n\tnulls[9] = false;\n\n\tvalues[10] = BoolGetDatum(ControlFile->float8ByVal);\n\tnulls[10] = false;\n\n\tvalues[11] = Int32GetDatum(ControlFile->data_checksum_version);\n\tnulls[11] = false;\n\n\thtup = heap_form_tuple(tupdesc, values, nulls);\n\n\tPG_RETURN_DATUM(HeapTupleGetDatum(htup));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/controldata_utils.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_control.h\"",
      "#include \"access/xlog.h\"",
      "#include \"access/xlog_internal.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_DATUM",
          "args": [
            "HeapTupleGetDatum(htup)"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleGetDatum",
          "args": [
            "htup"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_form_tuple",
          "args": [
            "tupdesc",
            "values",
            "nulls"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->data_checksum_version"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BoolGetDatum",
          "args": [
            "ControlFile->float8ByVal"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BoolGetDatum",
          "args": [
            "ControlFile->float4ByVal"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->loblksize"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->toast_max_chunk_size"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->indexMaxKeys"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->nameDataLen"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->xlog_seg_size"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->xlog_blcksz"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->relseg_size"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->blcksz"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->maxAlign"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errmsg(\"calculated CRC checksum does not match value stored in file\"))"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"calculated CRC checksum does not match value stored in file\""
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_controlfile",
          "args": [
            "DataDir",
            "NULL",
            "&crc_ok"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BlessTupleDesc",
          "args": [
            "tupdesc"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 12",
            "\"data_page_checksum_version\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 11",
            "\"float8_pass_by_value\"",
            "BOOLOID",
            "-1",
            "0"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 10",
            "\"float4_pass_by_value\"",
            "BOOLOID",
            "-1",
            "0"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 9",
            "\"large_object_chunk_size\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 8",
            "\"max_toast_chunk_size\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 7",
            "\"max_index_columns\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 6",
            "\"max_identifier_length\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 5",
            "\"bytes_per_wal_segment\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 4",
            "\"wal_block_size\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 3",
            "\"blocks_per_segment\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 2",
            "\"database_block_size\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 1",
            "\"max_data_alignment\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CreateTemplateTupleDesc",
          "args": [
            "12",
            "false"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/controldata_utils.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_control.h\"\n#include \"access/xlog.h\"\n#include \"access/xlog_internal.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_control_init(PG_FUNCTION_ARGS)\n{\n\tDatum\t\tvalues[12];\n\tbool\t\tnulls[12];\n\tTupleDesc\ttupdesc;\n\tHeapTuple\thtup;\n\tControlFileData *ControlFile;\n\tbool\t\tcrc_ok;\n\n\t/*\n\t * Construct a tuple descriptor for the result row.  This must match this\n\t * function's pg_proc entry!\n\t */\n\ttupdesc = CreateTemplateTupleDesc(12, false);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"max_data_alignment\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"database_block_size\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"blocks_per_segment\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"wal_block_size\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 5, \"bytes_per_wal_segment\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 6, \"max_identifier_length\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 7, \"max_index_columns\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 8, \"max_toast_chunk_size\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 9, \"large_object_chunk_size\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 10, \"float4_pass_by_value\",\n\t\t\t\t\t   BOOLOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 11, \"float8_pass_by_value\",\n\t\t\t\t\t   BOOLOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 12, \"data_page_checksum_version\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\ttupdesc = BlessTupleDesc(tupdesc);\n\n\t/* read the control file */\n\tControlFile = get_controlfile(DataDir, NULL, &crc_ok);\n\tif (!crc_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errmsg(\"calculated CRC checksum does not match value stored in file\")));\n\n\tvalues[0] = Int32GetDatum(ControlFile->maxAlign);\n\tnulls[0] = false;\n\n\tvalues[1] = Int32GetDatum(ControlFile->blcksz);\n\tnulls[1] = false;\n\n\tvalues[2] = Int32GetDatum(ControlFile->relseg_size);\n\tnulls[2] = false;\n\n\tvalues[3] = Int32GetDatum(ControlFile->xlog_blcksz);\n\tnulls[3] = false;\n\n\tvalues[4] = Int32GetDatum(ControlFile->xlog_seg_size);\n\tnulls[4] = false;\n\n\tvalues[5] = Int32GetDatum(ControlFile->nameDataLen);\n\tnulls[5] = false;\n\n\tvalues[6] = Int32GetDatum(ControlFile->indexMaxKeys);\n\tnulls[6] = false;\n\n\tvalues[7] = Int32GetDatum(ControlFile->toast_max_chunk_size);\n\tnulls[7] = false;\n\n\tvalues[8] = Int32GetDatum(ControlFile->loblksize);\n\tnulls[8] = false;\n\n\tvalues[9] = BoolGetDatum(ControlFile->float4ByVal);\n\tnulls[9] = false;\n\n\tvalues[10] = BoolGetDatum(ControlFile->float8ByVal);\n\tnulls[10] = false;\n\n\tvalues[11] = Int32GetDatum(ControlFile->data_checksum_version);\n\tnulls[11] = false;\n\n\thtup = heap_form_tuple(tupdesc, values, nulls);\n\n\tPG_RETURN_DATUM(HeapTupleGetDatum(htup));\n}"
  },
  {
    "function_name": "pg_control_recovery",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/misc/pg_controldata.c",
    "lines": "210-261",
    "snippet": "Datum\npg_control_recovery(PG_FUNCTION_ARGS)\n{\n\tDatum\t\tvalues[5];\n\tbool\t\tnulls[5];\n\tTupleDesc\ttupdesc;\n\tHeapTuple\thtup;\n\tControlFileData *ControlFile;\n\tbool\t\tcrc_ok;\n\n\t/*\n\t * Construct a tuple descriptor for the result row.  This must match this\n\t * function's pg_proc entry!\n\t */\n\ttupdesc = CreateTemplateTupleDesc(5, false);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"min_recovery_end_lsn\",\n\t\t\t\t\t   LSNOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"min_recovery_end_timeline\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"backup_start_lsn\",\n\t\t\t\t\t   LSNOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"backup_end_lsn\",\n\t\t\t\t\t   LSNOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 5, \"end_of_backup_record_required\",\n\t\t\t\t\t   BOOLOID, -1, 0);\n\ttupdesc = BlessTupleDesc(tupdesc);\n\n\t/* read the control file */\n\tControlFile = get_controlfile(DataDir, NULL, &crc_ok);\n\tif (!crc_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errmsg(\"calculated CRC checksum does not match value stored in file\")));\n\n\tvalues[0] = LSNGetDatum(ControlFile->minRecoveryPoint);\n\tnulls[0] = false;\n\n\tvalues[1] = Int32GetDatum(ControlFile->minRecoveryPointTLI);\n\tnulls[1] = false;\n\n\tvalues[2] = LSNGetDatum(ControlFile->backupStartPoint);\n\tnulls[2] = false;\n\n\tvalues[3] = LSNGetDatum(ControlFile->backupEndPoint);\n\tnulls[3] = false;\n\n\tvalues[4] = BoolGetDatum(ControlFile->backupEndRequired);\n\tnulls[4] = false;\n\n\thtup = heap_form_tuple(tupdesc, values, nulls);\n\n\tPG_RETURN_DATUM(HeapTupleGetDatum(htup));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/controldata_utils.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_control.h\"",
      "#include \"access/xlog.h\"",
      "#include \"access/xlog_internal.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_DATUM",
          "args": [
            "HeapTupleGetDatum(htup)"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleGetDatum",
          "args": [
            "htup"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_form_tuple",
          "args": [
            "tupdesc",
            "values",
            "nulls"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BoolGetDatum",
          "args": [
            "ControlFile->backupEndRequired"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LSNGetDatum",
          "args": [
            "ControlFile->backupEndPoint"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LSNGetDatum",
          "args": [
            "ControlFile->backupStartPoint"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->minRecoveryPointTLI"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LSNGetDatum",
          "args": [
            "ControlFile->minRecoveryPoint"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errmsg(\"calculated CRC checksum does not match value stored in file\"))"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"calculated CRC checksum does not match value stored in file\""
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_controlfile",
          "args": [
            "DataDir",
            "NULL",
            "&crc_ok"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BlessTupleDesc",
          "args": [
            "tupdesc"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 5",
            "\"end_of_backup_record_required\"",
            "BOOLOID",
            "-1",
            "0"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 4",
            "\"backup_end_lsn\"",
            "LSNOID",
            "-1",
            "0"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 3",
            "\"backup_start_lsn\"",
            "LSNOID",
            "-1",
            "0"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 2",
            "\"min_recovery_end_timeline\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 1",
            "\"min_recovery_end_lsn\"",
            "LSNOID",
            "-1",
            "0"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CreateTemplateTupleDesc",
          "args": [
            "5",
            "false"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/controldata_utils.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_control.h\"\n#include \"access/xlog.h\"\n#include \"access/xlog_internal.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_control_recovery(PG_FUNCTION_ARGS)\n{\n\tDatum\t\tvalues[5];\n\tbool\t\tnulls[5];\n\tTupleDesc\ttupdesc;\n\tHeapTuple\thtup;\n\tControlFileData *ControlFile;\n\tbool\t\tcrc_ok;\n\n\t/*\n\t * Construct a tuple descriptor for the result row.  This must match this\n\t * function's pg_proc entry!\n\t */\n\ttupdesc = CreateTemplateTupleDesc(5, false);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"min_recovery_end_lsn\",\n\t\t\t\t\t   LSNOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"min_recovery_end_timeline\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"backup_start_lsn\",\n\t\t\t\t\t   LSNOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"backup_end_lsn\",\n\t\t\t\t\t   LSNOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 5, \"end_of_backup_record_required\",\n\t\t\t\t\t   BOOLOID, -1, 0);\n\ttupdesc = BlessTupleDesc(tupdesc);\n\n\t/* read the control file */\n\tControlFile = get_controlfile(DataDir, NULL, &crc_ok);\n\tif (!crc_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errmsg(\"calculated CRC checksum does not match value stored in file\")));\n\n\tvalues[0] = LSNGetDatum(ControlFile->minRecoveryPoint);\n\tnulls[0] = false;\n\n\tvalues[1] = Int32GetDatum(ControlFile->minRecoveryPointTLI);\n\tnulls[1] = false;\n\n\tvalues[2] = LSNGetDatum(ControlFile->backupStartPoint);\n\tnulls[2] = false;\n\n\tvalues[3] = LSNGetDatum(ControlFile->backupEndPoint);\n\tnulls[3] = false;\n\n\tvalues[4] = BoolGetDatum(ControlFile->backupEndRequired);\n\tnulls[4] = false;\n\n\thtup = heap_form_tuple(tupdesc, values, nulls);\n\n\tPG_RETURN_DATUM(HeapTupleGetDatum(htup));\n}"
  },
  {
    "function_name": "pg_control_checkpoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/misc/pg_controldata.c",
    "lines": "78-208",
    "snippet": "Datum\npg_control_checkpoint(PG_FUNCTION_ARGS)\n{\n\tDatum\t\tvalues[19];\n\tbool\t\tnulls[19];\n\tTupleDesc\ttupdesc;\n\tHeapTuple\thtup;\n\tControlFileData *ControlFile;\n\tXLogSegNo\tsegno;\n\tchar\t\txlogfilename[MAXFNAMELEN];\n\tbool\t\tcrc_ok;\n\n\t/*\n\t * Construct a tuple descriptor for the result row.  This must match this\n\t * function's pg_proc entry!\n\t */\n\ttupdesc = CreateTemplateTupleDesc(18, false);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"checkpoint_lsn\",\n\t\t\t\t\t   LSNOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"redo_lsn\",\n\t\t\t\t\t   LSNOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"redo_wal_file\",\n\t\t\t\t\t   TEXTOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"timeline_id\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 5, \"prev_timeline_id\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 6, \"full_page_writes\",\n\t\t\t\t\t   BOOLOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 7, \"next_xid\",\n\t\t\t\t\t   TEXTOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 8, \"next_oid\",\n\t\t\t\t\t   OIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 9, \"next_multixact_id\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 10, \"next_multi_offset\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 11, \"oldest_xid\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 12, \"oldest_xid_dbid\",\n\t\t\t\t\t   OIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 13, \"oldest_active_xid\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 14, \"oldest_multi_xid\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 15, \"oldest_multi_dbid\",\n\t\t\t\t\t   OIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 16, \"oldest_commit_ts_xid\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 17, \"newest_commit_ts_xid\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 18, \"checkpoint_time\",\n\t\t\t\t\t   TIMESTAMPTZOID, -1, 0);\n\ttupdesc = BlessTupleDesc(tupdesc);\n\n\t/* Read the control file. */\n\tControlFile = get_controlfile(DataDir, NULL, &crc_ok);\n\tif (!crc_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errmsg(\"calculated CRC checksum does not match value stored in file\")));\n\n\t/*\n\t * Calculate name of the WAL file containing the latest checkpoint's REDO\n\t * start point.\n\t */\n\tXLByteToSeg(ControlFile->checkPointCopy.redo, segno, wal_segment_size);\n\tXLogFileName(xlogfilename, ControlFile->checkPointCopy.ThisTimeLineID,\n\t\t\t\t segno, wal_segment_size);\n\n\t/* Populate the values and null arrays */\n\tvalues[0] = LSNGetDatum(ControlFile->checkPoint);\n\tnulls[0] = false;\n\n\tvalues[1] = LSNGetDatum(ControlFile->checkPointCopy.redo);\n\tnulls[1] = false;\n\n\tvalues[2] = CStringGetTextDatum(xlogfilename);\n\tnulls[2] = false;\n\n\tvalues[3] = Int32GetDatum(ControlFile->checkPointCopy.ThisTimeLineID);\n\tnulls[3] = false;\n\n\tvalues[4] = Int32GetDatum(ControlFile->checkPointCopy.PrevTimeLineID);\n\tnulls[4] = false;\n\n\tvalues[5] = BoolGetDatum(ControlFile->checkPointCopy.fullPageWrites);\n\tnulls[5] = false;\n\n\tvalues[6] = CStringGetTextDatum(psprintf(\"%u:%u\",\n\t\t\t\t\t\t\t\t\t\t\t ControlFile->checkPointCopy.nextXidEpoch,\n\t\t\t\t\t\t\t\t\t\t\t ControlFile->checkPointCopy.nextXid));\n\tnulls[6] = false;\n\n\tvalues[7] = ObjectIdGetDatum(ControlFile->checkPointCopy.nextOid);\n\tnulls[7] = false;\n\n\tvalues[8] = TransactionIdGetDatum(ControlFile->checkPointCopy.nextMulti);\n\tnulls[8] = false;\n\n\tvalues[9] = TransactionIdGetDatum(ControlFile->checkPointCopy.nextMultiOffset);\n\tnulls[9] = false;\n\n\tvalues[10] = TransactionIdGetDatum(ControlFile->checkPointCopy.oldestXid);\n\tnulls[10] = false;\n\n\tvalues[11] = ObjectIdGetDatum(ControlFile->checkPointCopy.oldestXidDB);\n\tnulls[11] = false;\n\n\tvalues[12] = TransactionIdGetDatum(ControlFile->checkPointCopy.oldestActiveXid);\n\tnulls[12] = false;\n\n\tvalues[13] = TransactionIdGetDatum(ControlFile->checkPointCopy.oldestMulti);\n\tnulls[13] = false;\n\n\tvalues[14] = ObjectIdGetDatum(ControlFile->checkPointCopy.oldestMultiDB);\n\tnulls[14] = false;\n\n\tvalues[15] = TransactionIdGetDatum(ControlFile->checkPointCopy.oldestCommitTsXid);\n\tnulls[15] = false;\n\n\tvalues[16] = TransactionIdGetDatum(ControlFile->checkPointCopy.newestCommitTsXid);\n\tnulls[16] = false;\n\n\tvalues[17] = TimestampTzGetDatum(\n\t\t\t\t\t\t\t\t\t time_t_to_timestamptz(ControlFile->checkPointCopy.time));\n\tnulls[17] = false;\n\n\thtup = heap_form_tuple(tupdesc, values, nulls);\n\n\tPG_RETURN_DATUM(HeapTupleGetDatum(htup));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/controldata_utils.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_control.h\"",
      "#include \"access/xlog.h\"",
      "#include \"access/xlog_internal.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_DATUM",
          "args": [
            "HeapTupleGetDatum(htup)"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleGetDatum",
          "args": [
            "htup"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_form_tuple",
          "args": [
            "tupdesc",
            "values",
            "nulls"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TimestampTzGetDatum",
          "args": [
            "time_t_to_timestamptz(ControlFile->checkPointCopy.time)"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time_t_to_timestamptz",
          "args": [
            "ControlFile->checkPointCopy.time"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "time_t_to_timestamptz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/timestamp.c",
          "lines": "1669-1679",
          "snippet": "TimestampTz\ntime_t_to_timestamptz(pg_time_t tm)\n{\n\tTimestampTz result;\n\n\tresult = (TimestampTz) tm -\n\t\t((POSTGRES_EPOCH_JDATE - UNIX_EPOCH_JDATE) * SECS_PER_DAY);\n\tresult *= USECS_PER_SEC;\n\n\treturn result;\n}",
          "includes": [
            "#include \"utils/datetime.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"funcapi.h\"",
            "#include \"common/int128.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/hash.h\"",
            "#include <sys/time.h>",
            "#include <limits.h>",
            "#include <float.h>",
            "#include <math.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/datetime.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"parser/scansup.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"common/int128.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/xact.h\"\n#include \"access/hash.h\"\n#include <sys/time.h>\n#include <limits.h>\n#include <float.h>\n#include <math.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nTimestampTz\ntime_t_to_timestamptz(pg_time_t tm)\n{\n\tTimestampTz result;\n\n\tresult = (TimestampTz) tm -\n\t\t((POSTGRES_EPOCH_JDATE - UNIX_EPOCH_JDATE) * SECS_PER_DAY);\n\tresult *= USECS_PER_SEC;\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TransactionIdGetDatum",
          "args": [
            "ControlFile->checkPointCopy.newestCommitTsXid"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdGetDatum",
          "args": [
            "ControlFile->checkPointCopy.oldestCommitTsXid"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "ControlFile->checkPointCopy.oldestMultiDB"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdGetDatum",
          "args": [
            "ControlFile->checkPointCopy.oldestMulti"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdGetDatum",
          "args": [
            "ControlFile->checkPointCopy.oldestActiveXid"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "ControlFile->checkPointCopy.oldestXidDB"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdGetDatum",
          "args": [
            "ControlFile->checkPointCopy.oldestXid"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdGetDatum",
          "args": [
            "ControlFile->checkPointCopy.nextMultiOffset"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdGetDatum",
          "args": [
            "ControlFile->checkPointCopy.nextMulti"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "ControlFile->checkPointCopy.nextOid"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "psprintf(\"%u:%u\",\n\t\t\t\t\t\t\t\t\t\t\t ControlFile->checkPointCopy.nextXidEpoch,\n\t\t\t\t\t\t\t\t\t\t\t ControlFile->checkPointCopy.nextXid)"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "psprintf",
          "args": [
            "\"%u:%u\"",
            "ControlFile->checkPointCopy.nextXidEpoch",
            "ControlFile->checkPointCopy.nextXid"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BoolGetDatum",
          "args": [
            "ControlFile->checkPointCopy.fullPageWrites"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->checkPointCopy.PrevTimeLineID"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->checkPointCopy.ThisTimeLineID"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "xlogfilename"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LSNGetDatum",
          "args": [
            "ControlFile->checkPointCopy.redo"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LSNGetDatum",
          "args": [
            "ControlFile->checkPoint"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XLogFileName",
          "args": [
            "xlogfilename",
            "ControlFile->checkPointCopy.ThisTimeLineID",
            "segno",
            "wal_segment_size"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XLByteToSeg",
          "args": [
            "ControlFile->checkPointCopy.redo",
            "segno",
            "wal_segment_size"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errmsg(\"calculated CRC checksum does not match value stored in file\"))"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"calculated CRC checksum does not match value stored in file\""
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_controlfile",
          "args": [
            "DataDir",
            "NULL",
            "&crc_ok"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BlessTupleDesc",
          "args": [
            "tupdesc"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 18",
            "\"checkpoint_time\"",
            "TIMESTAMPTZOID",
            "-1",
            "0"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 17",
            "\"newest_commit_ts_xid\"",
            "XIDOID",
            "-1",
            "0"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 16",
            "\"oldest_commit_ts_xid\"",
            "XIDOID",
            "-1",
            "0"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 15",
            "\"oldest_multi_dbid\"",
            "OIDOID",
            "-1",
            "0"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 14",
            "\"oldest_multi_xid\"",
            "XIDOID",
            "-1",
            "0"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 13",
            "\"oldest_active_xid\"",
            "XIDOID",
            "-1",
            "0"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 12",
            "\"oldest_xid_dbid\"",
            "OIDOID",
            "-1",
            "0"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 11",
            "\"oldest_xid\"",
            "XIDOID",
            "-1",
            "0"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 10",
            "\"next_multi_offset\"",
            "XIDOID",
            "-1",
            "0"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 9",
            "\"next_multixact_id\"",
            "XIDOID",
            "-1",
            "0"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 8",
            "\"next_oid\"",
            "OIDOID",
            "-1",
            "0"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 7",
            "\"next_xid\"",
            "TEXTOID",
            "-1",
            "0"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 6",
            "\"full_page_writes\"",
            "BOOLOID",
            "-1",
            "0"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 5",
            "\"prev_timeline_id\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 4",
            "\"timeline_id\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 3",
            "\"redo_wal_file\"",
            "TEXTOID",
            "-1",
            "0"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 2",
            "\"redo_lsn\"",
            "LSNOID",
            "-1",
            "0"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 1",
            "\"checkpoint_lsn\"",
            "LSNOID",
            "-1",
            "0"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CreateTemplateTupleDesc",
          "args": [
            "18",
            "false"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/controldata_utils.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_control.h\"\n#include \"access/xlog.h\"\n#include \"access/xlog_internal.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_control_checkpoint(PG_FUNCTION_ARGS)\n{\n\tDatum\t\tvalues[19];\n\tbool\t\tnulls[19];\n\tTupleDesc\ttupdesc;\n\tHeapTuple\thtup;\n\tControlFileData *ControlFile;\n\tXLogSegNo\tsegno;\n\tchar\t\txlogfilename[MAXFNAMELEN];\n\tbool\t\tcrc_ok;\n\n\t/*\n\t * Construct a tuple descriptor for the result row.  This must match this\n\t * function's pg_proc entry!\n\t */\n\ttupdesc = CreateTemplateTupleDesc(18, false);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"checkpoint_lsn\",\n\t\t\t\t\t   LSNOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"redo_lsn\",\n\t\t\t\t\t   LSNOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"redo_wal_file\",\n\t\t\t\t\t   TEXTOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"timeline_id\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 5, \"prev_timeline_id\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 6, \"full_page_writes\",\n\t\t\t\t\t   BOOLOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 7, \"next_xid\",\n\t\t\t\t\t   TEXTOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 8, \"next_oid\",\n\t\t\t\t\t   OIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 9, \"next_multixact_id\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 10, \"next_multi_offset\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 11, \"oldest_xid\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 12, \"oldest_xid_dbid\",\n\t\t\t\t\t   OIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 13, \"oldest_active_xid\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 14, \"oldest_multi_xid\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 15, \"oldest_multi_dbid\",\n\t\t\t\t\t   OIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 16, \"oldest_commit_ts_xid\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 17, \"newest_commit_ts_xid\",\n\t\t\t\t\t   XIDOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 18, \"checkpoint_time\",\n\t\t\t\t\t   TIMESTAMPTZOID, -1, 0);\n\ttupdesc = BlessTupleDesc(tupdesc);\n\n\t/* Read the control file. */\n\tControlFile = get_controlfile(DataDir, NULL, &crc_ok);\n\tif (!crc_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errmsg(\"calculated CRC checksum does not match value stored in file\")));\n\n\t/*\n\t * Calculate name of the WAL file containing the latest checkpoint's REDO\n\t * start point.\n\t */\n\tXLByteToSeg(ControlFile->checkPointCopy.redo, segno, wal_segment_size);\n\tXLogFileName(xlogfilename, ControlFile->checkPointCopy.ThisTimeLineID,\n\t\t\t\t segno, wal_segment_size);\n\n\t/* Populate the values and null arrays */\n\tvalues[0] = LSNGetDatum(ControlFile->checkPoint);\n\tnulls[0] = false;\n\n\tvalues[1] = LSNGetDatum(ControlFile->checkPointCopy.redo);\n\tnulls[1] = false;\n\n\tvalues[2] = CStringGetTextDatum(xlogfilename);\n\tnulls[2] = false;\n\n\tvalues[3] = Int32GetDatum(ControlFile->checkPointCopy.ThisTimeLineID);\n\tnulls[3] = false;\n\n\tvalues[4] = Int32GetDatum(ControlFile->checkPointCopy.PrevTimeLineID);\n\tnulls[4] = false;\n\n\tvalues[5] = BoolGetDatum(ControlFile->checkPointCopy.fullPageWrites);\n\tnulls[5] = false;\n\n\tvalues[6] = CStringGetTextDatum(psprintf(\"%u:%u\",\n\t\t\t\t\t\t\t\t\t\t\t ControlFile->checkPointCopy.nextXidEpoch,\n\t\t\t\t\t\t\t\t\t\t\t ControlFile->checkPointCopy.nextXid));\n\tnulls[6] = false;\n\n\tvalues[7] = ObjectIdGetDatum(ControlFile->checkPointCopy.nextOid);\n\tnulls[7] = false;\n\n\tvalues[8] = TransactionIdGetDatum(ControlFile->checkPointCopy.nextMulti);\n\tnulls[8] = false;\n\n\tvalues[9] = TransactionIdGetDatum(ControlFile->checkPointCopy.nextMultiOffset);\n\tnulls[9] = false;\n\n\tvalues[10] = TransactionIdGetDatum(ControlFile->checkPointCopy.oldestXid);\n\tnulls[10] = false;\n\n\tvalues[11] = ObjectIdGetDatum(ControlFile->checkPointCopy.oldestXidDB);\n\tnulls[11] = false;\n\n\tvalues[12] = TransactionIdGetDatum(ControlFile->checkPointCopy.oldestActiveXid);\n\tnulls[12] = false;\n\n\tvalues[13] = TransactionIdGetDatum(ControlFile->checkPointCopy.oldestMulti);\n\tnulls[13] = false;\n\n\tvalues[14] = ObjectIdGetDatum(ControlFile->checkPointCopy.oldestMultiDB);\n\tnulls[14] = false;\n\n\tvalues[15] = TransactionIdGetDatum(ControlFile->checkPointCopy.oldestCommitTsXid);\n\tnulls[15] = false;\n\n\tvalues[16] = TransactionIdGetDatum(ControlFile->checkPointCopy.newestCommitTsXid);\n\tnulls[16] = false;\n\n\tvalues[17] = TimestampTzGetDatum(\n\t\t\t\t\t\t\t\t\t time_t_to_timestamptz(ControlFile->checkPointCopy.time));\n\tnulls[17] = false;\n\n\thtup = heap_form_tuple(tupdesc, values, nulls);\n\n\tPG_RETURN_DATUM(HeapTupleGetDatum(htup));\n}"
  },
  {
    "function_name": "pg_control_system",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/misc/pg_controldata.c",
    "lines": "30-76",
    "snippet": "Datum\npg_control_system(PG_FUNCTION_ARGS)\n{\n\tDatum\t\tvalues[4];\n\tbool\t\tnulls[4];\n\tTupleDesc\ttupdesc;\n\tHeapTuple\thtup;\n\tControlFileData *ControlFile;\n\tbool\t\tcrc_ok;\n\n\t/*\n\t * Construct a tuple descriptor for the result row.  This must match this\n\t * function's pg_proc entry!\n\t */\n\ttupdesc = CreateTemplateTupleDesc(4, false);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"pg_control_version\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"catalog_version_no\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"system_identifier\",\n\t\t\t\t\t   INT8OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"pg_control_last_modified\",\n\t\t\t\t\t   TIMESTAMPTZOID, -1, 0);\n\ttupdesc = BlessTupleDesc(tupdesc);\n\n\t/* read the control file */\n\tControlFile = get_controlfile(DataDir, NULL, &crc_ok);\n\tif (!crc_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errmsg(\"calculated CRC checksum does not match value stored in file\")));\n\n\tvalues[0] = Int32GetDatum(ControlFile->pg_control_version);\n\tnulls[0] = false;\n\n\tvalues[1] = Int32GetDatum(ControlFile->catalog_version_no);\n\tnulls[1] = false;\n\n\tvalues[2] = Int64GetDatum(ControlFile->system_identifier);\n\tnulls[2] = false;\n\n\tvalues[3] = TimestampTzGetDatum(time_t_to_timestamptz(ControlFile->time));\n\tnulls[3] = false;\n\n\thtup = heap_form_tuple(tupdesc, values, nulls);\n\n\tPG_RETURN_DATUM(HeapTupleGetDatum(htup));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/controldata_utils.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_control.h\"",
      "#include \"access/xlog.h\"",
      "#include \"access/xlog_internal.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_DATUM",
          "args": [
            "HeapTupleGetDatum(htup)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleGetDatum",
          "args": [
            "htup"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_form_tuple",
          "args": [
            "tupdesc",
            "values",
            "nulls"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TimestampTzGetDatum",
          "args": [
            "time_t_to_timestamptz(ControlFile->time)"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time_t_to_timestamptz",
          "args": [
            "ControlFile->time"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "time_t_to_timestamptz",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/timestamp.c",
          "lines": "1669-1679",
          "snippet": "TimestampTz\ntime_t_to_timestamptz(pg_time_t tm)\n{\n\tTimestampTz result;\n\n\tresult = (TimestampTz) tm -\n\t\t((POSTGRES_EPOCH_JDATE - UNIX_EPOCH_JDATE) * SECS_PER_DAY);\n\tresult *= USECS_PER_SEC;\n\n\treturn result;\n}",
          "includes": [
            "#include \"utils/datetime.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"funcapi.h\"",
            "#include \"common/int128.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/hash.h\"",
            "#include <sys/time.h>",
            "#include <limits.h>",
            "#include <float.h>",
            "#include <math.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/datetime.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"parser/scansup.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"common/int128.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/xact.h\"\n#include \"access/hash.h\"\n#include <sys/time.h>\n#include <limits.h>\n#include <float.h>\n#include <math.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nTimestampTz\ntime_t_to_timestamptz(pg_time_t tm)\n{\n\tTimestampTz result;\n\n\tresult = (TimestampTz) tm -\n\t\t((POSTGRES_EPOCH_JDATE - UNIX_EPOCH_JDATE) * SECS_PER_DAY);\n\tresult *= USECS_PER_SEC;\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Int64GetDatum",
          "args": [
            "ControlFile->system_identifier"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "Int64GetDatum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/fmgr/fmgr.c",
          "lines": "1876-1883",
          "snippet": "Datum\nInt64GetDatum(int64 X)\n{\n\tint64\t   *retval = (int64 *) palloc(sizeof(int64));\n\n\t*retval = X;\n\treturn PointerGetDatum(retval);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/fmgrtab.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"pgstat.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"executor/functions.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/guc.h\"\n#include \"utils/fmgrtab.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"pgstat.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"miscadmin.h\"\n#include \"lib/stringinfo.h\"\n#include \"executor/functions.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_language.h\"\n#include \"access/tuptoaster.h\"\n#include \"postgres.h\"\n\nDatum\nInt64GetDatum(int64 X)\n{\n\tint64\t   *retval = (int64 *) palloc(sizeof(int64));\n\n\t*retval = X;\n\treturn PointerGetDatum(retval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->catalog_version_no"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "ControlFile->pg_control_version"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errmsg(\"calculated CRC checksum does not match value stored in file\"))"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"calculated CRC checksum does not match value stored in file\""
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_controlfile",
          "args": [
            "DataDir",
            "NULL",
            "&crc_ok"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BlessTupleDesc",
          "args": [
            "tupdesc"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 4",
            "\"pg_control_last_modified\"",
            "TIMESTAMPTZOID",
            "-1",
            "0"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 3",
            "\"system_identifier\"",
            "INT8OID",
            "-1",
            "0"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 2",
            "\"catalog_version_no\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 1",
            "\"pg_control_version\"",
            "INT4OID",
            "-1",
            "0"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CreateTemplateTupleDesc",
          "args": [
            "4",
            "false"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/controldata_utils.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_control.h\"\n#include \"access/xlog.h\"\n#include \"access/xlog_internal.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_control_system(PG_FUNCTION_ARGS)\n{\n\tDatum\t\tvalues[4];\n\tbool\t\tnulls[4];\n\tTupleDesc\ttupdesc;\n\tHeapTuple\thtup;\n\tControlFileData *ControlFile;\n\tbool\t\tcrc_ok;\n\n\t/*\n\t * Construct a tuple descriptor for the result row.  This must match this\n\t * function's pg_proc entry!\n\t */\n\ttupdesc = CreateTemplateTupleDesc(4, false);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"pg_control_version\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"catalog_version_no\",\n\t\t\t\t\t   INT4OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"system_identifier\",\n\t\t\t\t\t   INT8OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"pg_control_last_modified\",\n\t\t\t\t\t   TIMESTAMPTZOID, -1, 0);\n\ttupdesc = BlessTupleDesc(tupdesc);\n\n\t/* read the control file */\n\tControlFile = get_controlfile(DataDir, NULL, &crc_ok);\n\tif (!crc_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errmsg(\"calculated CRC checksum does not match value stored in file\")));\n\n\tvalues[0] = Int32GetDatum(ControlFile->pg_control_version);\n\tnulls[0] = false;\n\n\tvalues[1] = Int32GetDatum(ControlFile->catalog_version_no);\n\tnulls[1] = false;\n\n\tvalues[2] = Int64GetDatum(ControlFile->system_identifier);\n\tnulls[2] = false;\n\n\tvalues[3] = TimestampTzGetDatum(time_t_to_timestamptz(ControlFile->time));\n\tnulls[3] = false;\n\n\thtup = heap_form_tuple(tupdesc, values, nulls);\n\n\tPG_RETURN_DATUM(HeapTupleGetDatum(htup));\n}"
  }
]