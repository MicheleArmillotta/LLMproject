[
  {
    "function_name": "win866_to_iso",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "569-581",
    "snippet": "Datum\nwin866_to_iso(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN866, PG_ISO_8859_5);\n\n\tlocal2local(src, dest, len, PG_WIN866, PG_ISO_8859_5, win8662iso);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char win8662iso[] = {\n\t0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,\n\t0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xA1, 0xF1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_WIN866",
            "PG_ISO_8859_5",
            "win8662iso"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_WIN866",
            "PG_ISO_8859_5"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char win8662iso[] = {\n\t0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,\n\t0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xA1, 0xF1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\n\nDatum\nwin866_to_iso(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN866, PG_ISO_8859_5);\n\n\tlocal2local(src, dest, len, PG_WIN866, PG_ISO_8859_5, win8662iso);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "iso_to_win866",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "555-567",
    "snippet": "Datum\niso_to_win866(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_ISO_8859_5, PG_WIN866);\n\n\tlocal2local(src, dest, len, PG_ISO_8859_5, PG_WIN866, iso2win866);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char iso2win866[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F,\n\t0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7,\n\t0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0x00, 0xF1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_ISO_8859_5",
            "PG_WIN866",
            "iso2win866"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_ISO_8859_5",
            "PG_WIN866"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char iso2win866[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F,\n\t0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7,\n\t0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0x00, 0xF1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\n\nDatum\niso_to_win866(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_ISO_8859_5, PG_WIN866);\n\n\tlocal2local(src, dest, len, PG_ISO_8859_5, PG_WIN866, iso2win866);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "win1251_to_iso",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "541-553",
    "snippet": "Datum\nwin1251_to_iso(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1251, PG_ISO_8859_5);\n\n\tlocal2local(src, dest, len, PG_WIN1251, PG_ISO_8859_5, win12512iso);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char win12512iso[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xA1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xF1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,\n\t0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_WIN1251",
            "PG_ISO_8859_5",
            "win12512iso"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_WIN1251",
            "PG_ISO_8859_5"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char win12512iso[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xA1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xF1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,\n\t0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF\n};\n\nDatum\nwin1251_to_iso(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1251, PG_ISO_8859_5);\n\n\tlocal2local(src, dest, len, PG_WIN1251, PG_ISO_8859_5, win12512iso);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "iso_to_win1251",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "527-539",
    "snippet": "Datum\niso_to_win1251(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_ISO_8859_5, PG_WIN1251);\n\n\tlocal2local(src, dest, len, PG_ISO_8859_5, PG_WIN1251, iso2win1251);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char iso2win1251[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0xA8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF,\n\t0x00, 0xB8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_ISO_8859_5",
            "PG_WIN1251",
            "iso2win1251"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_ISO_8859_5",
            "PG_WIN1251"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char iso2win1251[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0xA8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF,\n\t0x00, 0xB8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\n\nDatum\niso_to_win1251(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_ISO_8859_5, PG_WIN1251);\n\n\tlocal2local(src, dest, len, PG_ISO_8859_5, PG_WIN1251, iso2win1251);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "koi8r_to_iso",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "513-525",
    "snippet": "Datum\nkoi8r_to_iso(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_KOI8R, PG_ISO_8859_5);\n\n\tlocal2local(src, dest, len, PG_KOI8R, PG_ISO_8859_5, koi2iso);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char koi2iso[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF1, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xA1, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xEE, 0xD0, 0xD1, 0xE6, 0xD4, 0xD5, 0xE4, 0xD3,\n\t0xE5, 0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE,\n\t0xDF, 0xEF, 0xE0, 0xE1, 0xE2, 0xE3, 0xD6, 0xD2,\n\t0xEC, 0xEB, 0xD7, 0xE8, 0xED, 0xE9, 0xE7, 0xEA,\n\t0xCE, 0xB0, 0xB1, 0xC6, 0xB4, 0xB5, 0xC4, 0xB3,\n\t0xC5, 0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE,\n\t0xBF, 0xCF, 0xC0, 0xC1, 0xC2, 0xC3, 0xB6, 0xB2,\n\t0xCC, 0xCB, 0xB7, 0xC8, 0xCD, 0xC9, 0xC7, 0xCA\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_KOI8R",
            "PG_ISO_8859_5",
            "koi2iso"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_KOI8R",
            "PG_ISO_8859_5"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char koi2iso[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF1, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xA1, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xEE, 0xD0, 0xD1, 0xE6, 0xD4, 0xD5, 0xE4, 0xD3,\n\t0xE5, 0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE,\n\t0xDF, 0xEF, 0xE0, 0xE1, 0xE2, 0xE3, 0xD6, 0xD2,\n\t0xEC, 0xEB, 0xD7, 0xE8, 0xED, 0xE9, 0xE7, 0xEA,\n\t0xCE, 0xB0, 0xB1, 0xC6, 0xB4, 0xB5, 0xC4, 0xB3,\n\t0xC5, 0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE,\n\t0xBF, 0xCF, 0xC0, 0xC1, 0xC2, 0xC3, 0xB6, 0xB2,\n\t0xCC, 0xCB, 0xB7, 0xC8, 0xCD, 0xC9, 0xC7, 0xCA\n};\n\nDatum\nkoi8r_to_iso(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_KOI8R, PG_ISO_8859_5);\n\n\tlocal2local(src, dest, len, PG_KOI8R, PG_ISO_8859_5, koi2iso);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "iso_to_koi8r",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "499-511",
    "snippet": "Datum\niso_to_koi8r(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_ISO_8859_5, PG_KOI8R);\n\n\tlocal2local(src, dest, len, PG_ISO_8859_5, PG_KOI8R, iso2koi);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char iso2koi[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0xB3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1,\n\t0x00, 0xA3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_ISO_8859_5",
            "PG_KOI8R",
            "iso2koi"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_ISO_8859_5",
            "PG_KOI8R"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char iso2koi[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0xB3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1,\n\t0x00, 0xA3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\n\nDatum\niso_to_koi8r(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_ISO_8859_5, PG_KOI8R);\n\n\tlocal2local(src, dest, len, PG_ISO_8859_5, PG_KOI8R, iso2koi);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "win1251_to_win866",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "485-497",
    "snippet": "Datum\nwin1251_to_win866(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1251, PG_WIN866);\n\n\tlocal2local(src, dest, len, PG_WIN1251, PG_WIN866, win12512win866);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char win12512win866[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0xF0, 0x00, 0xF2, 0x00, 0x00, 0x00, 0x00, 0xF4,\n\t0x00, 0x00, 0xF8, 0xF9, 0xAD, 0x00, 0x00, 0x00,\n\t0xF1, 0x00, 0xF3, 0x00, 0x00, 0x00, 0x00, 0xF5,\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F,\n\t0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7,\n\t0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_WIN1251",
            "PG_WIN866",
            "win12512win866"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_WIN1251",
            "PG_WIN866"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char win12512win866[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0xF0, 0x00, 0xF2, 0x00, 0x00, 0x00, 0x00, 0xF4,\n\t0x00, 0x00, 0xF8, 0xF9, 0xAD, 0x00, 0x00, 0x00,\n\t0xF1, 0x00, 0xF3, 0x00, 0x00, 0x00, 0x00, 0xF5,\n\t0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,\n\t0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F,\n\t0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,\n\t0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F,\n\t0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7,\n\t0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF\n};\n\nDatum\nwin1251_to_win866(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1251, PG_WIN866);\n\n\tlocal2local(src, dest, len, PG_WIN1251, PG_WIN866, win12512win866);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "win866_to_win1251",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "471-483",
    "snippet": "Datum\nwin866_to_win1251(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN866, PG_WIN1251);\n\n\tlocal2local(src, dest, len, PG_WIN866, PG_WIN1251, win8662win1251);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char win8662win1251[] = {\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xA5, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF,\n\t0xA8, 0xB8, 0xAA, 0xBA, 0xAF, 0xBF, 0x00, 0x00,\n\t0xB2, 0xB3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_WIN866",
            "PG_WIN1251",
            "win8662win1251"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_WIN866",
            "PG_WIN1251"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char win8662win1251[] = {\n\t0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,\n\t0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,\n\t0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,\n\t0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,\n\t0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,\n\t0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xA5, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,\n\t0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF,\n\t0xA8, 0xB8, 0xAA, 0xBA, 0xAF, 0xBF, 0x00, 0x00,\n\t0xB2, 0xB3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\n\nDatum\nwin866_to_win1251(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN866, PG_WIN1251);\n\n\tlocal2local(src, dest, len, PG_WIN866, PG_WIN1251, win8662win1251);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "win866_to_koi8r",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "457-469",
    "snippet": "Datum\nwin866_to_koi8r(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN866, PG_KOI8R);\n\n\tlocal2local(src, dest, len, PG_WIN866, PG_KOI8R, win8662koi);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char win8662koi[] = {\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1,\n\t0xB3, 0xA3, 0xB4, 0xA4, 0xB7, 0xA7, 0x00, 0x00,\n\t0xB6, 0xA6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_WIN866",
            "PG_KOI8R",
            "win8662koi"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_WIN866",
            "PG_KOI8R"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char win8662koi[] = {\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1,\n\t0xB3, 0xA3, 0xB4, 0xA4, 0xB7, 0xA7, 0x00, 0x00,\n\t0xB6, 0xA6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\n\nDatum\nwin866_to_koi8r(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN866, PG_KOI8R);\n\n\tlocal2local(src, dest, len, PG_WIN866, PG_KOI8R, win8662koi);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "koi8r_to_win866",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "443-455",
    "snippet": "Datum\nkoi8r_to_win866(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_KOI8R, PG_WIN866);\n\n\tlocal2local(src, dest, len, PG_KOI8R, PG_WIN866, koi2win866);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char koi2win866[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF1, 0xF3, 0x00, 0xF9, 0xF5,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xAD, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF0, 0xF2, 0x00, 0xF8, 0xF4,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0xEE, 0xA0, 0xA1, 0xE6, 0xA4, 0xA5, 0xE4, 0xA3,\n\t0xE5, 0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE,\n\t0xAF, 0xEF, 0xE0, 0xE1, 0xE2, 0xE3, 0xA6, 0xA2,\n\t0xEC, 0xEB, 0xA7, 0xE8, 0xED, 0xE9, 0xE7, 0xEA,\n\t0x9E, 0x80, 0x81, 0x96, 0x84, 0x85, 0x94, 0x83,\n\t0x95, 0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E,\n\t0x8F, 0x9F, 0x90, 0x91, 0x92, 0x93, 0x86, 0x82,\n\t0x9C, 0x9B, 0x87, 0x98, 0x9D, 0x99, 0x97, 0x9A\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_KOI8R",
            "PG_WIN866",
            "koi2win866"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_KOI8R",
            "PG_WIN866"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char koi2win866[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF1, 0xF3, 0x00, 0xF9, 0xF5,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xAD, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF0, 0xF2, 0x00, 0xF8, 0xF4,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0xEE, 0xA0, 0xA1, 0xE6, 0xA4, 0xA5, 0xE4, 0xA3,\n\t0xE5, 0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE,\n\t0xAF, 0xEF, 0xE0, 0xE1, 0xE2, 0xE3, 0xA6, 0xA2,\n\t0xEC, 0xEB, 0xA7, 0xE8, 0xED, 0xE9, 0xE7, 0xEA,\n\t0x9E, 0x80, 0x81, 0x96, 0x84, 0x85, 0x94, 0x83,\n\t0x95, 0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E,\n\t0x8F, 0x9F, 0x90, 0x91, 0x92, 0x93, 0x86, 0x82,\n\t0x9C, 0x9B, 0x87, 0x98, 0x9D, 0x99, 0x97, 0x9A\n};\n\nDatum\nkoi8r_to_win866(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_KOI8R, PG_WIN866);\n\n\tlocal2local(src, dest, len, PG_KOI8R, PG_WIN866, koi2win866);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "win1251_to_koi8r",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "429-441",
    "snippet": "Datum\nwin1251_to_koi8r(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1251, PG_KOI8R);\n\n\tlocal2local(src, dest, len, PG_WIN1251, PG_KOI8R, win12512koi);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char win12512koi[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0xB3, 0x00, 0xB4, 0x00, 0x00, 0x00, 0x00, 0xB7,\n\t0x00, 0x00, 0xB6, 0xA6, 0xAD, 0x00, 0x00, 0x00,\n\t0xA3, 0x00, 0xA4, 0x00, 0x00, 0x00, 0x00, 0xA7,\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_WIN1251",
            "PG_KOI8R",
            "win12512koi"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_WIN1251",
            "PG_KOI8R"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char win12512koi[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0xB3, 0x00, 0xB4, 0x00, 0x00, 0x00, 0x00, 0xB7,\n\t0x00, 0x00, 0xB6, 0xA6, 0xAD, 0x00, 0x00, 0x00,\n\t0xA3, 0x00, 0xA4, 0x00, 0x00, 0x00, 0x00, 0xA7,\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1\n};\n\nDatum\nwin1251_to_koi8r(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1251, PG_KOI8R);\n\n\tlocal2local(src, dest, len, PG_WIN1251, PG_KOI8R, win12512koi);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "koi8r_to_win1251",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "415-427",
    "snippet": "Datum\nkoi8r_to_win1251(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_KOI8R, PG_WIN1251);\n\n\tlocal2local(src, dest, len, PG_KOI8R, PG_WIN1251, koi2win1251);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char koi2win1251[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xB8, 0xBA, 0x00, 0xB3, 0xBF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xB4, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xA8, 0xAA, 0x00, 0xB2, 0xAF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xA5, 0x00, 0x00,\n\t0xFE, 0xE0, 0xE1, 0xF6, 0xE4, 0xE5, 0xF4, 0xE3,\n\t0xF5, 0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE,\n\t0xEF, 0xFF, 0xF0, 0xF1, 0xF2, 0xF3, 0xE6, 0xE2,\n\t0xFC, 0xFB, 0xE7, 0xF8, 0xFD, 0xF9, 0xF7, 0xFA,\n\t0xDE, 0xC0, 0xC1, 0xD6, 0xC4, 0xC5, 0xD4, 0xC3,\n\t0xD5, 0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE,\n\t0xCF, 0xDF, 0xD0, 0xD1, 0xD2, 0xD3, 0xC6, 0xC2,\n\t0xDC, 0xDB, 0xC7, 0xD8, 0xDD, 0xD9, 0xD7, 0xDA\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local2local",
          "args": [
            "src",
            "dest",
            "len",
            "PG_KOI8R",
            "PG_WIN1251",
            "koi2win1251"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "local2local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "29-60",
          "snippet": "void\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlocal2local(const unsigned char *l,\n\t\t\tunsigned char *p,\n\t\t\tint len,\n\t\t\tint src_encoding,\n\t\t\tint dest_encoding,\n\t\t\tconst unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(src_encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t\t*p++ = c2;\n\t\t\telse\n\t\t\t\treport_untranslatable_char(src_encoding, dest_encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_KOI8R",
            "PG_WIN1251"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char koi2win1251[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xB8, 0xBA, 0x00, 0xB3, 0xBF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xB4, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xA8, 0xAA, 0x00, 0xB2, 0xAF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xA5, 0x00, 0x00,\n\t0xFE, 0xE0, 0xE1, 0xF6, 0xE4, 0xE5, 0xF4, 0xE3,\n\t0xF5, 0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE,\n\t0xEF, 0xFF, 0xF0, 0xF1, 0xF2, 0xF3, 0xE6, 0xE2,\n\t0xFC, 0xFB, 0xE7, 0xF8, 0xFD, 0xF9, 0xF7, 0xFA,\n\t0xDE, 0xC0, 0xC1, 0xD6, 0xC4, 0xC5, 0xD4, 0xC3,\n\t0xD5, 0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE,\n\t0xCF, 0xDF, 0xD0, 0xD1, 0xD2, 0xD3, 0xC6, 0xC2,\n\t0xDC, 0xDB, 0xC7, 0xD8, 0xDD, 0xD9, 0xD7, 0xDA\n};\n\nDatum\nkoi8r_to_win1251(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_KOI8R, PG_WIN1251);\n\n\tlocal2local(src, dest, len, PG_KOI8R, PG_WIN1251, koi2win1251);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "mic_to_win866",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "401-413",
    "snippet": "Datum\nmic_to_win866(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_WIN866);\n\n\tmic2latin_with_table(src, dest, len, LC_KOI8_R, PG_WIN866, koi2win866);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char koi2win866[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF1, 0xF3, 0x00, 0xF9, 0xF5,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xAD, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF0, 0xF2, 0x00, 0xF8, 0xF4,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0xEE, 0xA0, 0xA1, 0xE6, 0xA4, 0xA5, 0xE4, 0xA3,\n\t0xE5, 0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE,\n\t0xAF, 0xEF, 0xE0, 0xE1, 0xE2, 0xE3, 0xA6, 0xA2,\n\t0xEC, 0xEB, 0xA7, 0xE8, 0xED, 0xE9, 0xE7, 0xEA,\n\t0x9E, 0x80, 0x81, 0x96, 0x84, 0x85, 0x94, 0x83,\n\t0x95, 0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E,\n\t0x8F, 0x9F, 0x90, 0x91, 0x92, 0x93, 0x86, 0x82,\n\t0x9C, 0x9B, 0x87, 0x98, 0x9D, 0x99, 0x97, 0x9A\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mic2latin_with_table",
          "args": [
            "src",
            "dest",
            "len",
            "LC_KOI8_R",
            "PG_WIN866",
            "koi2win866"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "mic2latin_with_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "240-283",
          "snippet": "void\nmic2latin_with_table(const unsigned char *mic,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]) ||\n\t\t\t\t(c2 = tab[mic[1] - HIGHBIT]) == 0)\n\t\t\t{\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t\tbreak;\t\t\t/* keep compiler quiet */\n\t\t\t}\n\t\t\t*p++ = c2;\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nmic2latin_with_table(const unsigned char *mic,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]) ||\n\t\t\t\t(c2 = tab[mic[1] - HIGHBIT]) == 0)\n\t\t\t{\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t\tbreak;\t\t\t/* keep compiler quiet */\n\t\t\t}\n\t\t\t*p++ = c2;\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_MULE_INTERNAL",
            "PG_WIN866"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char koi2win866[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF1, 0xF3, 0x00, 0xF9, 0xF5,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xAD, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF0, 0xF2, 0x00, 0xF8, 0xF4,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0xEE, 0xA0, 0xA1, 0xE6, 0xA4, 0xA5, 0xE4, 0xA3,\n\t0xE5, 0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE,\n\t0xAF, 0xEF, 0xE0, 0xE1, 0xE2, 0xE3, 0xA6, 0xA2,\n\t0xEC, 0xEB, 0xA7, 0xE8, 0xED, 0xE9, 0xE7, 0xEA,\n\t0x9E, 0x80, 0x81, 0x96, 0x84, 0x85, 0x94, 0x83,\n\t0x95, 0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E,\n\t0x8F, 0x9F, 0x90, 0x91, 0x92, 0x93, 0x86, 0x82,\n\t0x9C, 0x9B, 0x87, 0x98, 0x9D, 0x99, 0x97, 0x9A\n};\n\nDatum\nmic_to_win866(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_WIN866);\n\n\tmic2latin_with_table(src, dest, len, LC_KOI8_R, PG_WIN866, koi2win866);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "win866_to_mic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "387-399",
    "snippet": "Datum\nwin866_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN866, PG_MULE_INTERNAL);\n\n\tlatin2mic_with_table(src, dest, len, LC_KOI8_R, PG_WIN866, win8662koi);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char win8662koi[] = {\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1,\n\t0xB3, 0xA3, 0xB4, 0xA4, 0xB7, 0xA7, 0x00, 0x00,\n\t0xB6, 0xA6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "latin2mic_with_table",
          "args": [
            "src",
            "dest",
            "len",
            "LC_KOI8_R",
            "PG_WIN866",
            "win8662koi"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "latin2mic_with_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "192-226",
          "snippet": "void\nlatin2mic_with_table(const unsigned char *l,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t{\n\t\t\t\t*p++ = lc;\n\t\t\t\t*p++ = c2;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_untranslatable_char(encoding, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlatin2mic_with_table(const unsigned char *l,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t{\n\t\t\t\t*p++ = lc;\n\t\t\t\t*p++ = c2;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_untranslatable_char(encoding, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_WIN866",
            "PG_MULE_INTERNAL"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char win8662koi[] = {\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1,\n\t0xB3, 0xA3, 0xB4, 0xA4, 0xB7, 0xA7, 0x00, 0x00,\n\t0xB6, 0xA6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\n\nDatum\nwin866_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN866, PG_MULE_INTERNAL);\n\n\tlatin2mic_with_table(src, dest, len, LC_KOI8_R, PG_WIN866, win8662koi);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "mic_to_win1251",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "373-385",
    "snippet": "Datum\nmic_to_win1251(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_WIN1251);\n\n\tmic2latin_with_table(src, dest, len, LC_KOI8_R, PG_WIN1251, koi2win1251);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char koi2win1251[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xB8, 0xBA, 0x00, 0xB3, 0xBF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xB4, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xA8, 0xAA, 0x00, 0xB2, 0xAF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xA5, 0x00, 0x00,\n\t0xFE, 0xE0, 0xE1, 0xF6, 0xE4, 0xE5, 0xF4, 0xE3,\n\t0xF5, 0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE,\n\t0xEF, 0xFF, 0xF0, 0xF1, 0xF2, 0xF3, 0xE6, 0xE2,\n\t0xFC, 0xFB, 0xE7, 0xF8, 0xFD, 0xF9, 0xF7, 0xFA,\n\t0xDE, 0xC0, 0xC1, 0xD6, 0xC4, 0xC5, 0xD4, 0xC3,\n\t0xD5, 0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE,\n\t0xCF, 0xDF, 0xD0, 0xD1, 0xD2, 0xD3, 0xC6, 0xC2,\n\t0xDC, 0xDB, 0xC7, 0xD8, 0xDD, 0xD9, 0xD7, 0xDA\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mic2latin_with_table",
          "args": [
            "src",
            "dest",
            "len",
            "LC_KOI8_R",
            "PG_WIN1251",
            "koi2win1251"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "mic2latin_with_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "240-283",
          "snippet": "void\nmic2latin_with_table(const unsigned char *mic,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]) ||\n\t\t\t\t(c2 = tab[mic[1] - HIGHBIT]) == 0)\n\t\t\t{\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t\tbreak;\t\t\t/* keep compiler quiet */\n\t\t\t}\n\t\t\t*p++ = c2;\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nmic2latin_with_table(const unsigned char *mic,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]) ||\n\t\t\t\t(c2 = tab[mic[1] - HIGHBIT]) == 0)\n\t\t\t{\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t\tbreak;\t\t\t/* keep compiler quiet */\n\t\t\t}\n\t\t\t*p++ = c2;\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_MULE_INTERNAL",
            "PG_WIN1251"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char koi2win1251[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xB8, 0xBA, 0x00, 0xB3, 0xBF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xB4, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xA8, 0xAA, 0x00, 0xB2, 0xAF,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xA5, 0x00, 0x00,\n\t0xFE, 0xE0, 0xE1, 0xF6, 0xE4, 0xE5, 0xF4, 0xE3,\n\t0xF5, 0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE,\n\t0xEF, 0xFF, 0xF0, 0xF1, 0xF2, 0xF3, 0xE6, 0xE2,\n\t0xFC, 0xFB, 0xE7, 0xF8, 0xFD, 0xF9, 0xF7, 0xFA,\n\t0xDE, 0xC0, 0xC1, 0xD6, 0xC4, 0xC5, 0xD4, 0xC3,\n\t0xD5, 0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE,\n\t0xCF, 0xDF, 0xD0, 0xD1, 0xD2, 0xD3, 0xC6, 0xC2,\n\t0xDC, 0xDB, 0xC7, 0xD8, 0xDD, 0xD9, 0xD7, 0xDA\n};\n\nDatum\nmic_to_win1251(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_WIN1251);\n\n\tmic2latin_with_table(src, dest, len, LC_KOI8_R, PG_WIN1251, koi2win1251);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "win1251_to_mic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "359-371",
    "snippet": "Datum\nwin1251_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1251, PG_MULE_INTERNAL);\n\n\tlatin2mic_with_table(src, dest, len, LC_KOI8_R, PG_WIN1251, win12512koi);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char win12512koi[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0xB3, 0x00, 0xB4, 0x00, 0x00, 0x00, 0x00, 0xB7,\n\t0x00, 0x00, 0xB6, 0xA6, 0xAD, 0x00, 0x00, 0x00,\n\t0xA3, 0x00, 0xA4, 0x00, 0x00, 0x00, 0x00, 0xA7,\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "latin2mic_with_table",
          "args": [
            "src",
            "dest",
            "len",
            "LC_KOI8_R",
            "PG_WIN1251",
            "win12512koi"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "latin2mic_with_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "192-226",
          "snippet": "void\nlatin2mic_with_table(const unsigned char *l,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t{\n\t\t\t\t*p++ = lc;\n\t\t\t\t*p++ = c2;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_untranslatable_char(encoding, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlatin2mic_with_table(const unsigned char *l,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t{\n\t\t\t\t*p++ = lc;\n\t\t\t\t*p++ = c2;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_untranslatable_char(encoding, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_WIN1251",
            "PG_MULE_INTERNAL"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char win12512koi[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0xBD, 0x00, 0x00,\n\t0xB3, 0x00, 0xB4, 0x00, 0x00, 0x00, 0x00, 0xB7,\n\t0x00, 0x00, 0xB6, 0xA6, 0xAD, 0x00, 0x00, 0x00,\n\t0xA3, 0x00, 0xA4, 0x00, 0x00, 0x00, 0x00, 0xA7,\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1\n};\n\nDatum\nwin1251_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_WIN1251, PG_MULE_INTERNAL);\n\n\tlatin2mic_with_table(src, dest, len, LC_KOI8_R, PG_WIN1251, win12512koi);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "mic_to_iso",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "345-357",
    "snippet": "Datum\nmic_to_iso(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_ISO_8859_5);\n\n\tmic2latin_with_table(src, dest, len, LC_KOI8_R, PG_ISO_8859_5, koi2iso);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char koi2iso[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF1, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xA1, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xEE, 0xD0, 0xD1, 0xE6, 0xD4, 0xD5, 0xE4, 0xD3,\n\t0xE5, 0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE,\n\t0xDF, 0xEF, 0xE0, 0xE1, 0xE2, 0xE3, 0xD6, 0xD2,\n\t0xEC, 0xEB, 0xD7, 0xE8, 0xED, 0xE9, 0xE7, 0xEA,\n\t0xCE, 0xB0, 0xB1, 0xC6, 0xB4, 0xB5, 0xC4, 0xB3,\n\t0xC5, 0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE,\n\t0xBF, 0xCF, 0xC0, 0xC1, 0xC2, 0xC3, 0xB6, 0xB2,\n\t0xCC, 0xCB, 0xB7, 0xC8, 0xCD, 0xC9, 0xC7, 0xCA\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mic2latin_with_table",
          "args": [
            "src",
            "dest",
            "len",
            "LC_KOI8_R",
            "PG_ISO_8859_5",
            "koi2iso"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "mic2latin_with_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "240-283",
          "snippet": "void\nmic2latin_with_table(const unsigned char *mic,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]) ||\n\t\t\t\t(c2 = tab[mic[1] - HIGHBIT]) == 0)\n\t\t\t{\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t\tbreak;\t\t\t/* keep compiler quiet */\n\t\t\t}\n\t\t\t*p++ = c2;\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nmic2latin_with_table(const unsigned char *mic,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]) ||\n\t\t\t\t(c2 = tab[mic[1] - HIGHBIT]) == 0)\n\t\t\t{\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t\tbreak;\t\t\t/* keep compiler quiet */\n\t\t\t}\n\t\t\t*p++ = c2;\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_MULE_INTERNAL",
            "PG_ISO_8859_5"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char koi2iso[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xF1, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0xA1, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xEE, 0xD0, 0xD1, 0xE6, 0xD4, 0xD5, 0xE4, 0xD3,\n\t0xE5, 0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE,\n\t0xDF, 0xEF, 0xE0, 0xE1, 0xE2, 0xE3, 0xD6, 0xD2,\n\t0xEC, 0xEB, 0xD7, 0xE8, 0xED, 0xE9, 0xE7, 0xEA,\n\t0xCE, 0xB0, 0xB1, 0xC6, 0xB4, 0xB5, 0xC4, 0xB3,\n\t0xC5, 0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE,\n\t0xBF, 0xCF, 0xC0, 0xC1, 0xC2, 0xC3, 0xB6, 0xB2,\n\t0xCC, 0xCB, 0xB7, 0xC8, 0xCD, 0xC9, 0xC7, 0xCA\n};\n\nDatum\nmic_to_iso(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_ISO_8859_5);\n\n\tmic2latin_with_table(src, dest, len, LC_KOI8_R, PG_ISO_8859_5, koi2iso);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "iso_to_mic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "331-343",
    "snippet": "Datum\niso_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_ISO_8859_5, PG_MULE_INTERNAL);\n\n\tlatin2mic_with_table(src, dest, len, LC_KOI8_R, PG_ISO_8859_5, iso2koi);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char iso2koi[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0xB3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1,\n\t0x00, 0xA3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "latin2mic_with_table",
          "args": [
            "src",
            "dest",
            "len",
            "LC_KOI8_R",
            "PG_ISO_8859_5",
            "iso2koi"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "latin2mic_with_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "192-226",
          "snippet": "void\nlatin2mic_with_table(const unsigned char *l,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t{\n\t\t\t\t*p++ = lc;\n\t\t\t\t*p++ = c2;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_untranslatable_char(encoding, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlatin2mic_with_table(const unsigned char *l,\n\t\t\t\t\t unsigned char *p,\n\t\t\t\t\t int len,\n\t\t\t\t\t int lc,\n\t\t\t\t\t int encoding,\n\t\t\t\t\t const unsigned char *tab)\n{\n\tunsigned char c1,\n\t\t\t\tc2;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = c1;\n\t\telse\n\t\t{\n\t\t\tc2 = tab[c1 - HIGHBIT];\n\t\t\tif (c2)\n\t\t\t{\n\t\t\t\t*p++ = lc;\n\t\t\t\t*p++ = c2;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_untranslatable_char(encoding, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t   (const char *) l, len);\n\t\t}\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_ISO_8859_5",
            "PG_MULE_INTERNAL"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic const unsigned char iso2koi[] = {\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0xB3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0xE1, 0xE2, 0xF7, 0xE7, 0xE4, 0xE5, 0xF6, 0xFA,\n\t0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF, 0xF0,\n\t0xF2, 0xF3, 0xF4, 0xF5, 0xE6, 0xE8, 0xE3, 0xFE,\n\t0xFB, 0xFD, 0xFF, 0xF9, 0xF8, 0xFC, 0xE0, 0xF1,\n\t0xC1, 0xC2, 0xD7, 0xC7, 0xC4, 0xC5, 0xD6, 0xDA,\n\t0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0,\n\t0xD2, 0xD3, 0xD4, 0xD5, 0xC6, 0xC8, 0xC3, 0xDE,\n\t0xDB, 0xDD, 0xDF, 0xD9, 0xD8, 0xDC, 0xC0, 0xD1,\n\t0x00, 0xA3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\t0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n};\n\nDatum\niso_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_ISO_8859_5, PG_MULE_INTERNAL);\n\n\tlatin2mic_with_table(src, dest, len, LC_KOI8_R, PG_ISO_8859_5, iso2koi);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "mic_to_koi8r",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "317-329",
    "snippet": "Datum\nmic_to_koi8r(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_KOI8R);\n\n\tmic2latin(src, dest, len, LC_KOI8_R, PG_KOI8R);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mic2latin",
          "args": [
            "src",
            "dest",
            "len",
            "LC_KOI8_R",
            "PG_KOI8R"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "mic2latin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "98-132",
          "snippet": "void\nmic2latin(const unsigned char *mic, unsigned char *p, int len,\n\t\t  int lc, int encoding)\n{\n\tint\t\t\tc1;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]))\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t*p++ = mic[1];\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nmic2latin(const unsigned char *mic, unsigned char *p, int len,\n\t\t  int lc, int encoding)\n{\n\tint\t\t\tc1;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* easy for ASCII */\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint\t\t\tl = pg_mic_mblen(mic);\n\n\t\t\tif (len < l)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL, (const char *) mic,\n\t\t\t\t\t\t\t\t\t\tlen);\n\t\t\tif (l != 2 || c1 != lc || !IS_HIGHBIT_SET(mic[1]))\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, encoding,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t*p++ = mic[1];\n\t\t\tmic += 2;\n\t\t\tlen -= 2;\n\t\t}\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_MULE_INTERNAL",
            "PG_KOI8R"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nDatum\nmic_to_koi8r(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_KOI8R);\n\n\tmic2latin(src, dest, len, LC_KOI8_R, PG_KOI8R);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "koi8r_to_mic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/cyrillic_and_mic/cyrillic_and_mic.c",
    "lines": "303-315",
    "snippet": "Datum\nkoi8r_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_KOI8R, PG_MULE_INTERNAL);\n\n\tlatin2mic(src, dest, len, LC_KOI8_R, PG_KOI8R);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "latin2mic",
          "args": [
            "src",
            "dest",
            "len",
            "LC_KOI8_R",
            "PG_KOI8R"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "latin2mic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conv.c",
          "lines": "70-88",
          "snippet": "void\nlatin2mic(const unsigned char *l, unsigned char *p, int len,\n\t\t  int lc, int encoding)\n{\n\tint\t\t\tc1;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = lc;\n\t\t*p++ = c1;\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nlatin2mic(const unsigned char *l, unsigned char *p, int len,\n\t\t  int lc, int encoding)\n{\n\tint\t\t\tc1;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *l;\n\t\tif (c1 == 0)\n\t\t\treport_invalid_encoding(encoding, (const char *) l, len);\n\t\tif (IS_HIGHBIT_SET(c1))\n\t\t\t*p++ = lc;\n\t\t*p++ = c1;\n\t\tl++;\n\t\tlen--;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_KOI8R",
            "PG_MULE_INTERNAL"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nDatum\nkoi8r_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_KOI8R, PG_MULE_INTERNAL);\n\n\tlatin2mic(src, dest, len, LC_KOI8_R, PG_KOI8R);\n\n\tPG_RETURN_VOID();\n}"
  }
]