[
  {
    "function_name": "quote_nullable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/quote.c",
    "lines": "123-131",
    "snippet": "Datum\nquote_nullable(PG_FUNCTION_ARGS)\n{\n\tif (PG_ARGISNULL(0))\n\t\tPG_RETURN_TEXT_P(cstring_to_text(\"NULL\"));\n\telse\n\t\tPG_RETURN_DATUM(DirectFunctionCall1(quote_literal,\n\t\t\t\t\t\t\t\t\t\t\tPG_GETARG_DATUM(0)));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_DATUM",
          "args": [
            "DirectFunctionCall1(quote_literal,\n\t\t\t\t\t\t\t\t\t\t\tPG_GETARG_DATUM(0))"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectFunctionCall1",
          "args": [
            "quote_literal",
            "PG_GETARG_DATUM(0)"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_DATUM",
          "args": [
            "0"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "cstring_to_text(\"NULL\")"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cstring_to_text",
          "args": [
            "\"NULL\""
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "cstring_to_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "148-152",
          "snippet": "text *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\ntext *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_ARGISNULL",
          "args": [
            "0"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"postgres.h\"\n\nDatum\nquote_nullable(PG_FUNCTION_ARGS)\n{\n\tif (PG_ARGISNULL(0))\n\t\tPG_RETURN_TEXT_P(cstring_to_text(\"NULL\"));\n\telse\n\t\tPG_RETURN_DATUM(DirectFunctionCall1(quote_literal,\n\t\t\t\t\t\t\t\t\t\t\tPG_GETARG_DATUM(0)));\n}"
  },
  {
    "function_name": "quote_literal_cstr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/quote.c",
    "lines": "101-116",
    "snippet": "char *\nquote_literal_cstr(const char *rawstr)\n{\n\tchar\t   *result;\n\tint\t\t\tlen;\n\tint\t\t\tnewlen;\n\n\tlen = strlen(rawstr);\n\t/* We make a worst-case result area; wasting a little space is OK */\n\tresult = palloc(len * 2 + 3 + 1);\n\n\tnewlen = quote_literal_internal(result, rawstr, len);\n\tresult[newlen] = '\\0';\n\n\treturn result;\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "quote_literal_internal",
          "args": [
            "result",
            "rawstr",
            "len"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "quote_literal_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/quote.c",
          "lines": "45-70",
          "snippet": "static size_t\nquote_literal_internal(char *dst, const char *src, size_t len)\n{\n\tconst char *s;\n\tchar\t   *savedst = dst;\n\n\tfor (s = src; s < src + len; s++)\n\t{\n\t\tif (*s == '\\\\')\n\t\t{\n\t\t\t*dst++ = ESCAPE_STRING_SYNTAX;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t*dst++ = '\\'';\n\twhile (len-- > 0)\n\t{\n\t\tif (SQL_STR_DOUBLE(*src, true))\n\t\t\t*dst++ = *src;\n\t\t*dst++ = *src++;\n\t}\n\t*dst++ = '\\'';\n\n\treturn dst - savedst;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"postgres.h\"\n\nstatic size_t\nquote_literal_internal(char *dst, const char *src, size_t len)\n{\n\tconst char *s;\n\tchar\t   *savedst = dst;\n\n\tfor (s = src; s < src + len; s++)\n\t{\n\t\tif (*s == '\\\\')\n\t\t{\n\t\t\t*dst++ = ESCAPE_STRING_SYNTAX;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t*dst++ = '\\'';\n\twhile (len-- > 0)\n\t{\n\t\tif (SQL_STR_DOUBLE(*src, true))\n\t\t\t*dst++ = *src;\n\t\t*dst++ = *src++;\n\t}\n\t*dst++ = '\\'';\n\n\treturn dst - savedst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "len * 2 + 3 + 1"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "rawstr"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "calcstrlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_cleanup.c",
          "lines": "361-380",
          "snippet": "static int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nstatic int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"postgres.h\"\n\nchar *\nquote_literal_cstr(const char *rawstr)\n{\n\tchar\t   *result;\n\tint\t\t\tlen;\n\tint\t\t\tnewlen;\n\n\tlen = strlen(rawstr);\n\t/* We make a worst-case result area; wasting a little space is OK */\n\tresult = palloc(len * 2 + 3 + 1);\n\n\tnewlen = quote_literal_internal(result, rawstr, len);\n\tresult[newlen] = '\\0';\n\n\treturn result;\n}"
  },
  {
    "function_name": "quote_literal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/quote.c",
    "lines": "76-95",
    "snippet": "Datum\nquote_literal(PG_FUNCTION_ARGS)\n{\n\ttext\t   *t = PG_GETARG_TEXT_PP(0);\n\ttext\t   *result;\n\tchar\t   *cp1;\n\tchar\t   *cp2;\n\tint\t\t\tlen;\n\n\tlen = VARSIZE_ANY_EXHDR(t);\n\t/* We make a worst-case result area; wasting a little space is OK */\n\tresult = (text *) palloc(len * 2 + 3 + VARHDRSZ);\n\n\tcp1 = VARDATA_ANY(t);\n\tcp2 = VARDATA(result);\n\n\tSET_VARSIZE(result, VARHDRSZ + quote_literal_internal(cp2, cp1, len));\n\n\tPG_RETURN_TEXT_P(result);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "result"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "result",
            "VARHDRSZ + quote_literal_internal(cp2, cp1, len)"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quote_literal_internal",
          "args": [
            "cp2",
            "cp1",
            "len"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "quote_literal_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/quote.c",
          "lines": "45-70",
          "snippet": "static size_t\nquote_literal_internal(char *dst, const char *src, size_t len)\n{\n\tconst char *s;\n\tchar\t   *savedst = dst;\n\n\tfor (s = src; s < src + len; s++)\n\t{\n\t\tif (*s == '\\\\')\n\t\t{\n\t\t\t*dst++ = ESCAPE_STRING_SYNTAX;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t*dst++ = '\\'';\n\twhile (len-- > 0)\n\t{\n\t\tif (SQL_STR_DOUBLE(*src, true))\n\t\t\t*dst++ = *src;\n\t\t*dst++ = *src++;\n\t}\n\t*dst++ = '\\'';\n\n\treturn dst - savedst;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"postgres.h\"\n\nstatic size_t\nquote_literal_internal(char *dst, const char *src, size_t len)\n{\n\tconst char *s;\n\tchar\t   *savedst = dst;\n\n\tfor (s = src; s < src + len; s++)\n\t{\n\t\tif (*s == '\\\\')\n\t\t{\n\t\t\t*dst++ = ESCAPE_STRING_SYNTAX;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t*dst++ = '\\'';\n\twhile (len-- > 0)\n\t{\n\t\tif (SQL_STR_DOUBLE(*src, true))\n\t\t\t*dst++ = *src;\n\t\t*dst++ = *src++;\n\t}\n\t*dst++ = '\\'';\n\n\treturn dst - savedst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VARDATA",
          "args": [
            "result"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARDATA_ANY",
          "args": [
            "t"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "len * 2 + 3 + VARHDRSZ"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VARSIZE_ANY_EXHDR",
          "args": [
            "t"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"postgres.h\"\n\nDatum\nquote_literal(PG_FUNCTION_ARGS)\n{\n\ttext\t   *t = PG_GETARG_TEXT_PP(0);\n\ttext\t   *result;\n\tchar\t   *cp1;\n\tchar\t   *cp2;\n\tint\t\t\tlen;\n\n\tlen = VARSIZE_ANY_EXHDR(t);\n\t/* We make a worst-case result area; wasting a little space is OK */\n\tresult = (text *) palloc(len * 2 + 3 + VARHDRSZ);\n\n\tcp1 = VARDATA_ANY(t);\n\tcp2 = VARDATA(result);\n\n\tSET_VARSIZE(result, VARHDRSZ + quote_literal_internal(cp2, cp1, len));\n\n\tPG_RETURN_TEXT_P(result);\n}"
  },
  {
    "function_name": "quote_literal_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/quote.c",
    "lines": "45-70",
    "snippet": "static size_t\nquote_literal_internal(char *dst, const char *src, size_t len)\n{\n\tconst char *s;\n\tchar\t   *savedst = dst;\n\n\tfor (s = src; s < src + len; s++)\n\t{\n\t\tif (*s == '\\\\')\n\t\t{\n\t\t\t*dst++ = ESCAPE_STRING_SYNTAX;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t*dst++ = '\\'';\n\twhile (len-- > 0)\n\t{\n\t\tif (SQL_STR_DOUBLE(*src, true))\n\t\t\t*dst++ = *src;\n\t\t*dst++ = *src++;\n\t}\n\t*dst++ = '\\'';\n\n\treturn dst - savedst;\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SQL_STR_DOUBLE",
          "args": [
            "*src",
            "true"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"postgres.h\"\n\nstatic size_t\nquote_literal_internal(char *dst, const char *src, size_t len)\n{\n\tconst char *s;\n\tchar\t   *savedst = dst;\n\n\tfor (s = src; s < src + len; s++)\n\t{\n\t\tif (*s == '\\\\')\n\t\t{\n\t\t\t*dst++ = ESCAPE_STRING_SYNTAX;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t*dst++ = '\\'';\n\twhile (len-- > 0)\n\t{\n\t\tif (SQL_STR_DOUBLE(*src, true))\n\t\t\t*dst++ = *src;\n\t\t*dst++ = *src++;\n\t}\n\t*dst++ = '\\'';\n\n\treturn dst - savedst;\n}"
  },
  {
    "function_name": "quote_ident",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/quote.c",
    "lines": "23-33",
    "snippet": "Datum\nquote_ident(PG_FUNCTION_ARGS)\n{\n\ttext\t   *t = PG_GETARG_TEXT_PP(0);\n\tconst char *qstr;\n\tchar\t   *str;\n\n\tstr = text_to_cstring(t);\n\tqstr = quote_identifier(str);\n\tPG_RETURN_TEXT_P(cstring_to_text(qstr));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "cstring_to_text(qstr)"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cstring_to_text",
          "args": [
            "qstr"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "cstring_to_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "148-152",
          "snippet": "text *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\ntext *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "quote_identifier",
          "args": [
            "str"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "quote_identifier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ruleutils.c",
          "lines": "10550-10628",
          "snippet": "const char *\nquote_identifier(const char *ident)\n{\n\t/*\n\t * Can avoid quoting if ident starts with a lowercase letter or underscore\n\t * and contains only lowercase letters, digits, and underscores, *and* is\n\t * not any SQL keyword.  Otherwise, supply quotes.\n\t */\n\tint\t\t\tnquotes = 0;\n\tbool\t\tsafe;\n\tconst char *ptr;\n\tchar\t   *result;\n\tchar\t   *optr;\n\n\t/*\n\t * would like to use <ctype.h> macros here, but they might yield unwanted\n\t * locale-specific results...\n\t */\n\tsafe = ((ident[0] >= 'a' && ident[0] <= 'z') || ident[0] == '_');\n\n\tfor (ptr = ident; *ptr; ptr++)\n\t{\n\t\tchar\t\tch = *ptr;\n\n\t\tif ((ch >= 'a' && ch <= 'z') ||\n\t\t\t(ch >= '0' && ch <= '9') ||\n\t\t\t(ch == '_'))\n\t\t{\n\t\t\t/* okay */\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsafe = false;\n\t\t\tif (ch == '\"')\n\t\t\t\tnquotes++;\n\t\t}\n\t}\n\n\tif (quote_all_identifiers)\n\t\tsafe = false;\n\n\tif (safe)\n\t{\n\t\t/*\n\t\t * Check for keyword.  We quote keywords except for unreserved ones.\n\t\t * (In some cases we could avoid quoting a col_name or type_func_name\n\t\t * keyword, but it seems much harder than it's worth to tell that.)\n\t\t *\n\t\t * Note: ScanKeywordLookup() does case-insensitive comparison, but\n\t\t * that's fine, since we already know we have all-lower-case.\n\t\t */\n\t\tconst ScanKeyword *keyword = ScanKeywordLookup(ident,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   ScanKeywords,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   NumScanKeywords);\n\n\t\tif (keyword != NULL && keyword->category != UNRESERVED_KEYWORD)\n\t\t\tsafe = false;\n\t}\n\n\tif (safe)\n\t\treturn ident;\t\t\t/* no change needed */\n\n\tresult = (char *) palloc(strlen(ident) + nquotes + 2 + 1);\n\n\toptr = result;\n\t*optr++ = '\"';\n\tfor (ptr = ident; *ptr; ptr++)\n\t{\n\t\tchar\t\tch = *ptr;\n\n\t\tif (ch == '\"')\n\t\t\t*optr++ = '\"';\n\t\t*optr++ = ch;\n\t}\n\t*optr++ = '\"';\n\t*optr = '\\0';\n\n\treturn result;\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/typcache.h\"",
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/snapmgr.h\"",
            "#include \"utils/ruleutils.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/partcache.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/hsearch.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"rewrite/rewriteSupport.h\"",
            "#include \"rewrite/rewriteManip.h\"",
            "#include \"rewrite/rewriteHandler.h\"",
            "#include \"parser/parsetree.h\"",
            "#include \"parser/parser.h\"",
            "#include \"parser/parse_oper.h\"",
            "#include \"parser/parse_func.h\"",
            "#include \"parser/parse_agg.h\"",
            "#include \"parser/parse_node.h\"",
            "#include \"optimizer/tlist.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"funcapi.h\"",
            "#include \"executor/spi.h\"",
            "#include \"common/keywords.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/defrem.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_trigger.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"catalog/dependency.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/amapi.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "bool\t\tquote_all_identifiers = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/varlena.h\"\n#include \"utils/typcache.h\"\n#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/ruleutils.h\"\n#include \"utils/rel.h\"\n#include \"utils/partcache.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/hsearch.h\"\n#include \"utils/guc.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"rewrite/rewriteSupport.h\"\n#include \"rewrite/rewriteManip.h\"\n#include \"rewrite/rewriteHandler.h\"\n#include \"parser/parsetree.h\"\n#include \"parser/parser.h\"\n#include \"parser/parse_oper.h\"\n#include \"parser/parse_func.h\"\n#include \"parser/parse_agg.h\"\n#include \"parser/parse_node.h\"\n#include \"optimizer/tlist.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"funcapi.h\"\n#include \"executor/spi.h\"\n#include \"common/keywords.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/defrem.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_trigger.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"catalog/dependency.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"access/amapi.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\t\tquote_all_identifiers = false;\n\nconst char *\nquote_identifier(const char *ident)\n{\n\t/*\n\t * Can avoid quoting if ident starts with a lowercase letter or underscore\n\t * and contains only lowercase letters, digits, and underscores, *and* is\n\t * not any SQL keyword.  Otherwise, supply quotes.\n\t */\n\tint\t\t\tnquotes = 0;\n\tbool\t\tsafe;\n\tconst char *ptr;\n\tchar\t   *result;\n\tchar\t   *optr;\n\n\t/*\n\t * would like to use <ctype.h> macros here, but they might yield unwanted\n\t * locale-specific results...\n\t */\n\tsafe = ((ident[0] >= 'a' && ident[0] <= 'z') || ident[0] == '_');\n\n\tfor (ptr = ident; *ptr; ptr++)\n\t{\n\t\tchar\t\tch = *ptr;\n\n\t\tif ((ch >= 'a' && ch <= 'z') ||\n\t\t\t(ch >= '0' && ch <= '9') ||\n\t\t\t(ch == '_'))\n\t\t{\n\t\t\t/* okay */\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsafe = false;\n\t\t\tif (ch == '\"')\n\t\t\t\tnquotes++;\n\t\t}\n\t}\n\n\tif (quote_all_identifiers)\n\t\tsafe = false;\n\n\tif (safe)\n\t{\n\t\t/*\n\t\t * Check for keyword.  We quote keywords except for unreserved ones.\n\t\t * (In some cases we could avoid quoting a col_name or type_func_name\n\t\t * keyword, but it seems much harder than it's worth to tell that.)\n\t\t *\n\t\t * Note: ScanKeywordLookup() does case-insensitive comparison, but\n\t\t * that's fine, since we already know we have all-lower-case.\n\t\t */\n\t\tconst ScanKeyword *keyword = ScanKeywordLookup(ident,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   ScanKeywords,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   NumScanKeywords);\n\n\t\tif (keyword != NULL && keyword->category != UNRESERVED_KEYWORD)\n\t\t\tsafe = false;\n\t}\n\n\tif (safe)\n\t\treturn ident;\t\t\t/* no change needed */\n\n\tresult = (char *) palloc(strlen(ident) + nquotes + 2 + 1);\n\n\toptr = result;\n\t*optr++ = '\"';\n\tfor (ptr = ident; *ptr; ptr++)\n\t{\n\t\tchar\t\tch = *ptr;\n\n\t\tif (ch == '\"')\n\t\t\t*optr++ = '\"';\n\t\t*optr++ = ch;\n\t}\n\t*optr++ = '\"';\n\t*optr = '\\0';\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "t"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"postgres.h\"\n\nDatum\nquote_ident(PG_FUNCTION_ARGS)\n{\n\ttext\t   *t = PG_GETARG_TEXT_PP(0);\n\tconst char *qstr;\n\tchar\t   *str;\n\n\tstr = text_to_cstring(t);\n\tqstr = quote_identifier(str);\n\tPG_RETURN_TEXT_P(cstring_to_text(qstr));\n}"
  }
]