[
  {
    "function_name": "currtid_byrelname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "363-396",
    "snippet": "Datum\ncurrtid_byrelname(PG_FUNCTION_ARGS)\n{\n\ttext\t   *relname = PG_GETARG_TEXT_PP(0);\n\tItemPointer tid = PG_GETARG_ITEMPOINTER(1);\n\tItemPointer result;\n\tRangeVar   *relrv;\n\tRelation\trel;\n\tAclResult\taclresult;\n\tSnapshot\tsnapshot;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(relname));\n\trel = heap_openrv(relrv, AccessShareLock);\n\n\taclresult = pg_class_aclcheck(RelationGetRelid(rel), GetUserId(),\n\t\t\t\t\t\t\t\t  ACL_SELECT);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclcheck_error(aclresult, get_relkind_objtype(rel->rd_rel->relkind),\n\t\t\t\t\t   RelationGetRelationName(rel));\n\n\tif (rel->rd_rel->relkind == RELKIND_VIEW)\n\t\treturn currtid_for_view(rel, tid);\n\n\tresult = (ItemPointer) palloc(sizeof(ItemPointerData));\n\tItemPointerCopy(tid, result);\n\n\tsnapshot = RegisterSnapshot(GetLatestSnapshot());\n\theap_get_latest_tid(rel, snapshot, result);\n\tUnregisterSnapshot(snapshot);\n\n\theap_close(rel, AccessShareLock);\n\n\tPG_RETURN_ITEMPOINTER(result);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_ITEMPOINTER",
          "args": [
            "result"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_close",
          "args": [
            "rel",
            "AccessShareLock"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UnregisterSnapshot",
          "args": [
            "snapshot"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "UnregisterSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/time/snapmgr.c",
          "lines": "904-911",
          "snippet": "void\nUnregisterSnapshot(Snapshot snapshot)\n{\n\tif (snapshot == NULL)\n\t\treturn;\n\n\tUnregisterSnapshotFromOwner(snapshot, CurrentResourceOwner);\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/snapmgr.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/spin.h\"",
            "#include \"storage/sinvaladt.h\"",
            "#include \"storage/sinval.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/predicate.h\"",
            "#include \"miscadmin.h\"",
            "#include \"lib/pairingheap.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/xlog.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Snapshot CopySnapshot(Snapshot snapshot);",
            "static void FreeSnapshot(Snapshot snapshot);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"storage/spin.h\"\n#include \"storage/sinvaladt.h\"\n#include \"storage/sinval.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/predicate.h\"\n#include \"miscadmin.h\"\n#include \"lib/pairingheap.h\"\n#include \"catalog/catalog.h\"\n#include \"access/xlog.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include \"postgres.h\"\n\nstatic Snapshot CopySnapshot(Snapshot snapshot);\nstatic void FreeSnapshot(Snapshot snapshot);\n\nvoid\nUnregisterSnapshot(Snapshot snapshot)\n{\n\tif (snapshot == NULL)\n\t\treturn;\n\n\tUnregisterSnapshotFromOwner(snapshot, CurrentResourceOwner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "heap_get_latest_tid",
          "args": [
            "rel",
            "snapshot",
            "result"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegisterSnapshot",
          "args": [
            "GetLatestSnapshot()"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "RegisterSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/time/snapmgr.c",
          "lines": "862-869",
          "snippet": "Snapshot\nRegisterSnapshot(Snapshot snapshot)\n{\n\tif (snapshot == InvalidSnapshot)\n\t\treturn InvalidSnapshot;\n\n\treturn RegisterSnapshotOnOwner(snapshot, CurrentResourceOwner);\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/snapmgr.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/spin.h\"",
            "#include \"storage/sinvaladt.h\"",
            "#include \"storage/sinval.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/predicate.h\"",
            "#include \"miscadmin.h\"",
            "#include \"lib/pairingheap.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/xlog.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Snapshot CopySnapshot(Snapshot snapshot);",
            "static void FreeSnapshot(Snapshot snapshot);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"storage/spin.h\"\n#include \"storage/sinvaladt.h\"\n#include \"storage/sinval.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/predicate.h\"\n#include \"miscadmin.h\"\n#include \"lib/pairingheap.h\"\n#include \"catalog/catalog.h\"\n#include \"access/xlog.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include \"postgres.h\"\n\nstatic Snapshot CopySnapshot(Snapshot snapshot);\nstatic void FreeSnapshot(Snapshot snapshot);\n\nSnapshot\nRegisterSnapshot(Snapshot snapshot)\n{\n\tif (snapshot == InvalidSnapshot)\n\t\treturn InvalidSnapshot;\n\n\treturn RegisterSnapshotOnOwner(snapshot, CurrentResourceOwner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLatestSnapshot",
          "args": [],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "GetLatestSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/time/snapmgr.c",
          "lines": "378-402",
          "snippet": "Snapshot\nGetLatestSnapshot(void)\n{\n\t/*\n\t * We might be able to relax this, but nothing that could otherwise work\n\t * needs it.\n\t */\n\tif (IsInParallelMode())\n\t\telog(ERROR,\n\t\t\t \"cannot update SecondarySnapshot during a parallel operation\");\n\n\t/*\n\t * So far there are no cases requiring support for GetLatestSnapshot()\n\t * during logical decoding, but it wouldn't be hard to add if required.\n\t */\n\tAssert(!HistoricSnapshotActive());\n\n\t/* If first call in transaction, go ahead and set the xact snapshot */\n\tif (!FirstSnapshotSet)\n\t\treturn GetTransactionSnapshot();\n\n\tSecondarySnapshot = GetSnapshotData(&SecondarySnapshotData);\n\n\treturn SecondarySnapshot;\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/snapmgr.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/spin.h\"",
            "#include \"storage/sinvaladt.h\"",
            "#include \"storage/sinval.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/predicate.h\"",
            "#include \"miscadmin.h\"",
            "#include \"lib/pairingheap.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/xlog.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static SnapshotData SecondarySnapshotData = {HeapTupleSatisfiesMVCC};",
            "static Snapshot SecondarySnapshot = NULL;",
            "bool\t\tFirstSnapshotSet = false;",
            "static Snapshot CopySnapshot(Snapshot snapshot);",
            "static void FreeSnapshot(Snapshot snapshot);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"storage/spin.h\"\n#include \"storage/sinvaladt.h\"\n#include \"storage/sinval.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/predicate.h\"\n#include \"miscadmin.h\"\n#include \"lib/pairingheap.h\"\n#include \"catalog/catalog.h\"\n#include \"access/xlog.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include \"postgres.h\"\n\nstatic SnapshotData SecondarySnapshotData = {HeapTupleSatisfiesMVCC};\nstatic Snapshot SecondarySnapshot = NULL;\nbool\t\tFirstSnapshotSet = false;\nstatic Snapshot CopySnapshot(Snapshot snapshot);\nstatic void FreeSnapshot(Snapshot snapshot);\n\nSnapshot\nGetLatestSnapshot(void)\n{\n\t/*\n\t * We might be able to relax this, but nothing that could otherwise work\n\t * needs it.\n\t */\n\tif (IsInParallelMode())\n\t\telog(ERROR,\n\t\t\t \"cannot update SecondarySnapshot during a parallel operation\");\n\n\t/*\n\t * So far there are no cases requiring support for GetLatestSnapshot()\n\t * during logical decoding, but it wouldn't be hard to add if required.\n\t */\n\tAssert(!HistoricSnapshotActive());\n\n\t/* If first call in transaction, go ahead and set the xact snapshot */\n\tif (!FirstSnapshotSet)\n\t\treturn GetTransactionSnapshot();\n\n\tSecondarySnapshot = GetSnapshotData(&SecondarySnapshotData);\n\n\treturn SecondarySnapshot;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ItemPointerCopy",
          "args": [
            "tid",
            "result"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(ItemPointerData)"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "currtid_for_view",
          "args": [
            "rel",
            "tid"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "currtid_for_view",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
          "lines": "262-322",
          "snippet": "static Datum\ncurrtid_for_view(Relation viewrel, ItemPointer tid)\n{\n\tTupleDesc\tatt = RelationGetDescr(viewrel);\n\tRuleLock   *rulelock;\n\tRewriteRule *rewrite;\n\tint\t\t\ti,\n\t\t\t\tnatts = att->natts,\n\t\t\t\ttididx = -1;\n\n\tfor (i = 0; i < natts; i++)\n\t{\n\t\tForm_pg_attribute attr = TupleDescAttr(att, i);\n\n\t\tif (strcmp(NameStr(attr->attname), \"ctid\") == 0)\n\t\t{\n\t\t\tif (attr->atttypid != TIDOID)\n\t\t\t\telog(ERROR, \"ctid isn't of type TID\");\n\t\t\ttididx = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (tididx < 0)\n\t\telog(ERROR, \"currtid cannot handle views with no CTID\");\n\trulelock = viewrel->rd_rules;\n\tif (!rulelock)\n\t\telog(ERROR, \"the view has no rules\");\n\tfor (i = 0; i < rulelock->numLocks; i++)\n\t{\n\t\trewrite = rulelock->rules[i];\n\t\tif (rewrite->event == CMD_SELECT)\n\t\t{\n\t\t\tQuery\t   *query;\n\t\t\tTargetEntry *tle;\n\n\t\t\tif (list_length(rewrite->actions) != 1)\n\t\t\t\telog(ERROR, \"only one select rule is allowed in views\");\n\t\t\tquery = (Query *) linitial(rewrite->actions);\n\t\t\ttle = get_tle_by_resno(query->targetList, tididx + 1);\n\t\t\tif (tle && tle->expr && IsA(tle->expr, Var))\n\t\t\t{\n\t\t\t\tVar\t\t   *var = (Var *) tle->expr;\n\t\t\t\tRangeTblEntry *rte;\n\n\t\t\t\tif (!IS_SPECIAL_VARNO(var->varno) &&\n\t\t\t\t\tvar->varattno == SelfItemPointerAttributeNumber)\n\t\t\t\t{\n\t\t\t\t\trte = rt_fetch(var->varno, query->rtable);\n\t\t\t\t\tif (rte)\n\t\t\t\t\t{\n\t\t\t\t\t\theap_close(viewrel, AccessShareLock);\n\t\t\t\t\t\treturn DirectFunctionCall2(currtid_byreloid, ObjectIdGetDatum(rte->relid), PointerGetDatum(tid));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\telog(ERROR, \"currtid cannot handle this view\");\n\treturn (Datum) 0;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/tqual.h\"",
            "#include \"utils/snapmgr.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"parser/parsetree.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/heapam.h\"",
            "#include <limits.h>",
            "#include <math.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nstatic Datum\ncurrtid_for_view(Relation viewrel, ItemPointer tid)\n{\n\tTupleDesc\tatt = RelationGetDescr(viewrel);\n\tRuleLock   *rulelock;\n\tRewriteRule *rewrite;\n\tint\t\t\ti,\n\t\t\t\tnatts = att->natts,\n\t\t\t\ttididx = -1;\n\n\tfor (i = 0; i < natts; i++)\n\t{\n\t\tForm_pg_attribute attr = TupleDescAttr(att, i);\n\n\t\tif (strcmp(NameStr(attr->attname), \"ctid\") == 0)\n\t\t{\n\t\t\tif (attr->atttypid != TIDOID)\n\t\t\t\telog(ERROR, \"ctid isn't of type TID\");\n\t\t\ttididx = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (tididx < 0)\n\t\telog(ERROR, \"currtid cannot handle views with no CTID\");\n\trulelock = viewrel->rd_rules;\n\tif (!rulelock)\n\t\telog(ERROR, \"the view has no rules\");\n\tfor (i = 0; i < rulelock->numLocks; i++)\n\t{\n\t\trewrite = rulelock->rules[i];\n\t\tif (rewrite->event == CMD_SELECT)\n\t\t{\n\t\t\tQuery\t   *query;\n\t\t\tTargetEntry *tle;\n\n\t\t\tif (list_length(rewrite->actions) != 1)\n\t\t\t\telog(ERROR, \"only one select rule is allowed in views\");\n\t\t\tquery = (Query *) linitial(rewrite->actions);\n\t\t\ttle = get_tle_by_resno(query->targetList, tididx + 1);\n\t\t\tif (tle && tle->expr && IsA(tle->expr, Var))\n\t\t\t{\n\t\t\t\tVar\t\t   *var = (Var *) tle->expr;\n\t\t\t\tRangeTblEntry *rte;\n\n\t\t\t\tif (!IS_SPECIAL_VARNO(var->varno) &&\n\t\t\t\t\tvar->varattno == SelfItemPointerAttributeNumber)\n\t\t\t\t{\n\t\t\t\t\trte = rt_fetch(var->varno, query->rtable);\n\t\t\t\t\tif (rte)\n\t\t\t\t\t{\n\t\t\t\t\t\theap_close(viewrel, AccessShareLock);\n\t\t\t\t\t\treturn DirectFunctionCall2(currtid_byreloid, ObjectIdGetDatum(rte->relid), PointerGetDatum(tid));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\telog(ERROR, \"currtid cannot handle this view\");\n\treturn (Datum) 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "aclcheck_error",
          "args": [
            "aclresult",
            "get_relkind_objtype(rel->rd_rel->relkind)",
            "RelationGetRelationName(rel)"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RelationGetRelationName",
          "args": [
            "rel"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_relkind_objtype",
          "args": [
            "rel->rd_rel->relkind"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "RelationGetRelid(rel)",
            "GetUserId()",
            "ACL_SELECT"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RelationGetRelid",
          "args": [
            "rel"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_openrv",
          "args": [
            "relrv",
            "AccessShareLock"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeRangeVarFromNameList",
          "args": [
            "textToQualifiedNameList(relname)"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "textToQualifiedNameList",
          "args": [
            "relname"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "textToQualifiedNameList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "3231-3264",
          "snippet": "List *\ntextToQualifiedNameList(text *textval)\n{\n\tchar\t   *rawname;\n\tList\t   *result = NIL;\n\tList\t   *namelist;\n\tListCell   *l;\n\n\t/* Convert to C string (handles possible detoasting). */\n\t/* Note we rely on being able to modify rawname below. */\n\trawname = text_to_cstring(textval);\n\n\tif (!SplitIdentifierString(rawname, '.', &namelist))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_NAME),\n\t\t\t\t errmsg(\"invalid name syntax\")));\n\n\tif (namelist == NIL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_NAME),\n\t\t\t\t errmsg(\"invalid name syntax\")));\n\n\tforeach(l, namelist)\n\t{\n\t\tchar\t   *curname = (char *) lfirst(l);\n\n\t\tresult = lappend(result, makeString(pstrdup(curname)));\n\t}\n\n\tpfree(rawname);\n\tlist_free(namelist);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nList *\ntextToQualifiedNameList(text *textval)\n{\n\tchar\t   *rawname;\n\tList\t   *result = NIL;\n\tList\t   *namelist;\n\tListCell   *l;\n\n\t/* Convert to C string (handles possible detoasting). */\n\t/* Note we rely on being able to modify rawname below. */\n\trawname = text_to_cstring(textval);\n\n\tif (!SplitIdentifierString(rawname, '.', &namelist))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_NAME),\n\t\t\t\t errmsg(\"invalid name syntax\")));\n\n\tif (namelist == NIL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_NAME),\n\t\t\t\t errmsg(\"invalid name syntax\")));\n\n\tforeach(l, namelist)\n\t{\n\t\tchar\t   *curname = (char *) lfirst(l);\n\n\t\tresult = lappend(result, makeString(pstrdup(curname)));\n\t}\n\n\tpfree(rawname);\n\tlist_free(namelist);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ncurrtid_byrelname(PG_FUNCTION_ARGS)\n{\n\ttext\t   *relname = PG_GETARG_TEXT_PP(0);\n\tItemPointer tid = PG_GETARG_ITEMPOINTER(1);\n\tItemPointer result;\n\tRangeVar   *relrv;\n\tRelation\trel;\n\tAclResult\taclresult;\n\tSnapshot\tsnapshot;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(relname));\n\trel = heap_openrv(relrv, AccessShareLock);\n\n\taclresult = pg_class_aclcheck(RelationGetRelid(rel), GetUserId(),\n\t\t\t\t\t\t\t\t  ACL_SELECT);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclcheck_error(aclresult, get_relkind_objtype(rel->rd_rel->relkind),\n\t\t\t\t\t   RelationGetRelationName(rel));\n\n\tif (rel->rd_rel->relkind == RELKIND_VIEW)\n\t\treturn currtid_for_view(rel, tid);\n\n\tresult = (ItemPointer) palloc(sizeof(ItemPointerData));\n\tItemPointerCopy(tid, result);\n\n\tsnapshot = RegisterSnapshot(GetLatestSnapshot());\n\theap_get_latest_tid(rel, snapshot, result);\n\tUnregisterSnapshot(snapshot);\n\n\theap_close(rel, AccessShareLock);\n\n\tPG_RETURN_ITEMPOINTER(result);\n}"
  },
  {
    "function_name": "currtid_byreloid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "324-361",
    "snippet": "Datum\ncurrtid_byreloid(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\treloid = PG_GETARG_OID(0);\n\tItemPointer tid = PG_GETARG_ITEMPOINTER(1);\n\tItemPointer result;\n\tRelation\trel;\n\tAclResult\taclresult;\n\tSnapshot\tsnapshot;\n\n\tresult = (ItemPointer) palloc(sizeof(ItemPointerData));\n\tif (!reloid)\n\t{\n\t\t*result = Current_last_tid;\n\t\tPG_RETURN_ITEMPOINTER(result);\n\t}\n\n\trel = heap_open(reloid, AccessShareLock);\n\n\taclresult = pg_class_aclcheck(RelationGetRelid(rel), GetUserId(),\n\t\t\t\t\t\t\t\t  ACL_SELECT);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclcheck_error(aclresult, get_relkind_objtype(rel->rd_rel->relkind),\n\t\t\t\t\t   RelationGetRelationName(rel));\n\n\tif (rel->rd_rel->relkind == RELKIND_VIEW)\n\t\treturn currtid_for_view(rel, tid);\n\n\tItemPointerCopy(tid, result);\n\n\tsnapshot = RegisterSnapshot(GetLatestSnapshot());\n\theap_get_latest_tid(rel, snapshot, result);\n\tUnregisterSnapshot(snapshot);\n\n\theap_close(rel, AccessShareLock);\n\n\tPG_RETURN_ITEMPOINTER(result);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static ItemPointerData Current_last_tid = {{0, 0}, 0};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_ITEMPOINTER",
          "args": [
            "result"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_close",
          "args": [
            "rel",
            "AccessShareLock"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UnregisterSnapshot",
          "args": [
            "snapshot"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "UnregisterSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/time/snapmgr.c",
          "lines": "904-911",
          "snippet": "void\nUnregisterSnapshot(Snapshot snapshot)\n{\n\tif (snapshot == NULL)\n\t\treturn;\n\n\tUnregisterSnapshotFromOwner(snapshot, CurrentResourceOwner);\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/snapmgr.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/spin.h\"",
            "#include \"storage/sinvaladt.h\"",
            "#include \"storage/sinval.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/predicate.h\"",
            "#include \"miscadmin.h\"",
            "#include \"lib/pairingheap.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/xlog.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Snapshot CopySnapshot(Snapshot snapshot);",
            "static void FreeSnapshot(Snapshot snapshot);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"storage/spin.h\"\n#include \"storage/sinvaladt.h\"\n#include \"storage/sinval.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/predicate.h\"\n#include \"miscadmin.h\"\n#include \"lib/pairingheap.h\"\n#include \"catalog/catalog.h\"\n#include \"access/xlog.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include \"postgres.h\"\n\nstatic Snapshot CopySnapshot(Snapshot snapshot);\nstatic void FreeSnapshot(Snapshot snapshot);\n\nvoid\nUnregisterSnapshot(Snapshot snapshot)\n{\n\tif (snapshot == NULL)\n\t\treturn;\n\n\tUnregisterSnapshotFromOwner(snapshot, CurrentResourceOwner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "heap_get_latest_tid",
          "args": [
            "rel",
            "snapshot",
            "result"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegisterSnapshot",
          "args": [
            "GetLatestSnapshot()"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "RegisterSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/time/snapmgr.c",
          "lines": "862-869",
          "snippet": "Snapshot\nRegisterSnapshot(Snapshot snapshot)\n{\n\tif (snapshot == InvalidSnapshot)\n\t\treturn InvalidSnapshot;\n\n\treturn RegisterSnapshotOnOwner(snapshot, CurrentResourceOwner);\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/snapmgr.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/spin.h\"",
            "#include \"storage/sinvaladt.h\"",
            "#include \"storage/sinval.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/predicate.h\"",
            "#include \"miscadmin.h\"",
            "#include \"lib/pairingheap.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/xlog.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Snapshot CopySnapshot(Snapshot snapshot);",
            "static void FreeSnapshot(Snapshot snapshot);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"storage/spin.h\"\n#include \"storage/sinvaladt.h\"\n#include \"storage/sinval.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/predicate.h\"\n#include \"miscadmin.h\"\n#include \"lib/pairingheap.h\"\n#include \"catalog/catalog.h\"\n#include \"access/xlog.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include \"postgres.h\"\n\nstatic Snapshot CopySnapshot(Snapshot snapshot);\nstatic void FreeSnapshot(Snapshot snapshot);\n\nSnapshot\nRegisterSnapshot(Snapshot snapshot)\n{\n\tif (snapshot == InvalidSnapshot)\n\t\treturn InvalidSnapshot;\n\n\treturn RegisterSnapshotOnOwner(snapshot, CurrentResourceOwner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLatestSnapshot",
          "args": [],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "GetLatestSnapshot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/time/snapmgr.c",
          "lines": "378-402",
          "snippet": "Snapshot\nGetLatestSnapshot(void)\n{\n\t/*\n\t * We might be able to relax this, but nothing that could otherwise work\n\t * needs it.\n\t */\n\tif (IsInParallelMode())\n\t\telog(ERROR,\n\t\t\t \"cannot update SecondarySnapshot during a parallel operation\");\n\n\t/*\n\t * So far there are no cases requiring support for GetLatestSnapshot()\n\t * during logical decoding, but it wouldn't be hard to add if required.\n\t */\n\tAssert(!HistoricSnapshotActive());\n\n\t/* If first call in transaction, go ahead and set the xact snapshot */\n\tif (!FirstSnapshotSet)\n\t\treturn GetTransactionSnapshot();\n\n\tSecondarySnapshot = GetSnapshotData(&SecondarySnapshotData);\n\n\treturn SecondarySnapshot;\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/snapmgr.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/spin.h\"",
            "#include \"storage/sinvaladt.h\"",
            "#include \"storage/sinval.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/predicate.h\"",
            "#include \"miscadmin.h\"",
            "#include \"lib/pairingheap.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/xlog.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static SnapshotData SecondarySnapshotData = {HeapTupleSatisfiesMVCC};",
            "static Snapshot SecondarySnapshot = NULL;",
            "bool\t\tFirstSnapshotSet = false;",
            "static Snapshot CopySnapshot(Snapshot snapshot);",
            "static void FreeSnapshot(Snapshot snapshot);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"storage/spin.h\"\n#include \"storage/sinvaladt.h\"\n#include \"storage/sinval.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/predicate.h\"\n#include \"miscadmin.h\"\n#include \"lib/pairingheap.h\"\n#include \"catalog/catalog.h\"\n#include \"access/xlog.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include \"postgres.h\"\n\nstatic SnapshotData SecondarySnapshotData = {HeapTupleSatisfiesMVCC};\nstatic Snapshot SecondarySnapshot = NULL;\nbool\t\tFirstSnapshotSet = false;\nstatic Snapshot CopySnapshot(Snapshot snapshot);\nstatic void FreeSnapshot(Snapshot snapshot);\n\nSnapshot\nGetLatestSnapshot(void)\n{\n\t/*\n\t * We might be able to relax this, but nothing that could otherwise work\n\t * needs it.\n\t */\n\tif (IsInParallelMode())\n\t\telog(ERROR,\n\t\t\t \"cannot update SecondarySnapshot during a parallel operation\");\n\n\t/*\n\t * So far there are no cases requiring support for GetLatestSnapshot()\n\t * during logical decoding, but it wouldn't be hard to add if required.\n\t */\n\tAssert(!HistoricSnapshotActive());\n\n\t/* If first call in transaction, go ahead and set the xact snapshot */\n\tif (!FirstSnapshotSet)\n\t\treturn GetTransactionSnapshot();\n\n\tSecondarySnapshot = GetSnapshotData(&SecondarySnapshotData);\n\n\treturn SecondarySnapshot;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ItemPointerCopy",
          "args": [
            "tid",
            "result"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currtid_for_view",
          "args": [
            "rel",
            "tid"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "currtid_for_view",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
          "lines": "262-322",
          "snippet": "static Datum\ncurrtid_for_view(Relation viewrel, ItemPointer tid)\n{\n\tTupleDesc\tatt = RelationGetDescr(viewrel);\n\tRuleLock   *rulelock;\n\tRewriteRule *rewrite;\n\tint\t\t\ti,\n\t\t\t\tnatts = att->natts,\n\t\t\t\ttididx = -1;\n\n\tfor (i = 0; i < natts; i++)\n\t{\n\t\tForm_pg_attribute attr = TupleDescAttr(att, i);\n\n\t\tif (strcmp(NameStr(attr->attname), \"ctid\") == 0)\n\t\t{\n\t\t\tif (attr->atttypid != TIDOID)\n\t\t\t\telog(ERROR, \"ctid isn't of type TID\");\n\t\t\ttididx = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (tididx < 0)\n\t\telog(ERROR, \"currtid cannot handle views with no CTID\");\n\trulelock = viewrel->rd_rules;\n\tif (!rulelock)\n\t\telog(ERROR, \"the view has no rules\");\n\tfor (i = 0; i < rulelock->numLocks; i++)\n\t{\n\t\trewrite = rulelock->rules[i];\n\t\tif (rewrite->event == CMD_SELECT)\n\t\t{\n\t\t\tQuery\t   *query;\n\t\t\tTargetEntry *tle;\n\n\t\t\tif (list_length(rewrite->actions) != 1)\n\t\t\t\telog(ERROR, \"only one select rule is allowed in views\");\n\t\t\tquery = (Query *) linitial(rewrite->actions);\n\t\t\ttle = get_tle_by_resno(query->targetList, tididx + 1);\n\t\t\tif (tle && tle->expr && IsA(tle->expr, Var))\n\t\t\t{\n\t\t\t\tVar\t\t   *var = (Var *) tle->expr;\n\t\t\t\tRangeTblEntry *rte;\n\n\t\t\t\tif (!IS_SPECIAL_VARNO(var->varno) &&\n\t\t\t\t\tvar->varattno == SelfItemPointerAttributeNumber)\n\t\t\t\t{\n\t\t\t\t\trte = rt_fetch(var->varno, query->rtable);\n\t\t\t\t\tif (rte)\n\t\t\t\t\t{\n\t\t\t\t\t\theap_close(viewrel, AccessShareLock);\n\t\t\t\t\t\treturn DirectFunctionCall2(currtid_byreloid, ObjectIdGetDatum(rte->relid), PointerGetDatum(tid));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\telog(ERROR, \"currtid cannot handle this view\");\n\treturn (Datum) 0;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/tqual.h\"",
            "#include \"utils/snapmgr.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"parser/parsetree.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/heapam.h\"",
            "#include <limits.h>",
            "#include <math.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nstatic Datum\ncurrtid_for_view(Relation viewrel, ItemPointer tid)\n{\n\tTupleDesc\tatt = RelationGetDescr(viewrel);\n\tRuleLock   *rulelock;\n\tRewriteRule *rewrite;\n\tint\t\t\ti,\n\t\t\t\tnatts = att->natts,\n\t\t\t\ttididx = -1;\n\n\tfor (i = 0; i < natts; i++)\n\t{\n\t\tForm_pg_attribute attr = TupleDescAttr(att, i);\n\n\t\tif (strcmp(NameStr(attr->attname), \"ctid\") == 0)\n\t\t{\n\t\t\tif (attr->atttypid != TIDOID)\n\t\t\t\telog(ERROR, \"ctid isn't of type TID\");\n\t\t\ttididx = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (tididx < 0)\n\t\telog(ERROR, \"currtid cannot handle views with no CTID\");\n\trulelock = viewrel->rd_rules;\n\tif (!rulelock)\n\t\telog(ERROR, \"the view has no rules\");\n\tfor (i = 0; i < rulelock->numLocks; i++)\n\t{\n\t\trewrite = rulelock->rules[i];\n\t\tif (rewrite->event == CMD_SELECT)\n\t\t{\n\t\t\tQuery\t   *query;\n\t\t\tTargetEntry *tle;\n\n\t\t\tif (list_length(rewrite->actions) != 1)\n\t\t\t\telog(ERROR, \"only one select rule is allowed in views\");\n\t\t\tquery = (Query *) linitial(rewrite->actions);\n\t\t\ttle = get_tle_by_resno(query->targetList, tididx + 1);\n\t\t\tif (tle && tle->expr && IsA(tle->expr, Var))\n\t\t\t{\n\t\t\t\tVar\t\t   *var = (Var *) tle->expr;\n\t\t\t\tRangeTblEntry *rte;\n\n\t\t\t\tif (!IS_SPECIAL_VARNO(var->varno) &&\n\t\t\t\t\tvar->varattno == SelfItemPointerAttributeNumber)\n\t\t\t\t{\n\t\t\t\t\trte = rt_fetch(var->varno, query->rtable);\n\t\t\t\t\tif (rte)\n\t\t\t\t\t{\n\t\t\t\t\t\theap_close(viewrel, AccessShareLock);\n\t\t\t\t\t\treturn DirectFunctionCall2(currtid_byreloid, ObjectIdGetDatum(rte->relid), PointerGetDatum(tid));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\telog(ERROR, \"currtid cannot handle this view\");\n\treturn (Datum) 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "aclcheck_error",
          "args": [
            "aclresult",
            "get_relkind_objtype(rel->rd_rel->relkind)",
            "RelationGetRelationName(rel)"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RelationGetRelationName",
          "args": [
            "rel"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_relkind_objtype",
          "args": [
            "rel->rd_rel->relkind"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "RelationGetRelid(rel)",
            "GetUserId()",
            "ACL_SELECT"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RelationGetRelid",
          "args": [
            "rel"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_open",
          "args": [
            "reloid",
            "AccessShareLock"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_ITEMPOINTER",
          "args": [
            "result"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(ItemPointerData)"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nstatic ItemPointerData Current_last_tid = {{0, 0}, 0};\n\nDatum\ncurrtid_byreloid(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\treloid = PG_GETARG_OID(0);\n\tItemPointer tid = PG_GETARG_ITEMPOINTER(1);\n\tItemPointer result;\n\tRelation\trel;\n\tAclResult\taclresult;\n\tSnapshot\tsnapshot;\n\n\tresult = (ItemPointer) palloc(sizeof(ItemPointerData));\n\tif (!reloid)\n\t{\n\t\t*result = Current_last_tid;\n\t\tPG_RETURN_ITEMPOINTER(result);\n\t}\n\n\trel = heap_open(reloid, AccessShareLock);\n\n\taclresult = pg_class_aclcheck(RelationGetRelid(rel), GetUserId(),\n\t\t\t\t\t\t\t\t  ACL_SELECT);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclcheck_error(aclresult, get_relkind_objtype(rel->rd_rel->relkind),\n\t\t\t\t\t   RelationGetRelationName(rel));\n\n\tif (rel->rd_rel->relkind == RELKIND_VIEW)\n\t\treturn currtid_for_view(rel, tid);\n\n\tItemPointerCopy(tid, result);\n\n\tsnapshot = RegisterSnapshot(GetLatestSnapshot());\n\theap_get_latest_tid(rel, snapshot, result);\n\tUnregisterSnapshot(snapshot);\n\n\theap_close(rel, AccessShareLock);\n\n\tPG_RETURN_ITEMPOINTER(result);\n}"
  },
  {
    "function_name": "currtid_for_view",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "262-322",
    "snippet": "static Datum\ncurrtid_for_view(Relation viewrel, ItemPointer tid)\n{\n\tTupleDesc\tatt = RelationGetDescr(viewrel);\n\tRuleLock   *rulelock;\n\tRewriteRule *rewrite;\n\tint\t\t\ti,\n\t\t\t\tnatts = att->natts,\n\t\t\t\ttididx = -1;\n\n\tfor (i = 0; i < natts; i++)\n\t{\n\t\tForm_pg_attribute attr = TupleDescAttr(att, i);\n\n\t\tif (strcmp(NameStr(attr->attname), \"ctid\") == 0)\n\t\t{\n\t\t\tif (attr->atttypid != TIDOID)\n\t\t\t\telog(ERROR, \"ctid isn't of type TID\");\n\t\t\ttididx = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (tididx < 0)\n\t\telog(ERROR, \"currtid cannot handle views with no CTID\");\n\trulelock = viewrel->rd_rules;\n\tif (!rulelock)\n\t\telog(ERROR, \"the view has no rules\");\n\tfor (i = 0; i < rulelock->numLocks; i++)\n\t{\n\t\trewrite = rulelock->rules[i];\n\t\tif (rewrite->event == CMD_SELECT)\n\t\t{\n\t\t\tQuery\t   *query;\n\t\t\tTargetEntry *tle;\n\n\t\t\tif (list_length(rewrite->actions) != 1)\n\t\t\t\telog(ERROR, \"only one select rule is allowed in views\");\n\t\t\tquery = (Query *) linitial(rewrite->actions);\n\t\t\ttle = get_tle_by_resno(query->targetList, tididx + 1);\n\t\t\tif (tle && tle->expr && IsA(tle->expr, Var))\n\t\t\t{\n\t\t\t\tVar\t\t   *var = (Var *) tle->expr;\n\t\t\t\tRangeTblEntry *rte;\n\n\t\t\t\tif (!IS_SPECIAL_VARNO(var->varno) &&\n\t\t\t\t\tvar->varattno == SelfItemPointerAttributeNumber)\n\t\t\t\t{\n\t\t\t\t\trte = rt_fetch(var->varno, query->rtable);\n\t\t\t\t\tif (rte)\n\t\t\t\t\t{\n\t\t\t\t\t\theap_close(viewrel, AccessShareLock);\n\t\t\t\t\t\treturn DirectFunctionCall2(currtid_byreloid, ObjectIdGetDatum(rte->relid), PointerGetDatum(tid));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\telog(ERROR, \"currtid cannot handle this view\");\n\treturn (Datum) 0;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"currtid cannot handle this view\""
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DirectFunctionCall2",
          "args": [
            "currtid_byreloid",
            "ObjectIdGetDatum(rte->relid)",
            "PointerGetDatum(tid)"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerGetDatum",
          "args": [
            "tid"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "rte->relid"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_close",
          "args": [
            "viewrel",
            "AccessShareLock"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rt_fetch",
          "args": [
            "var->varno",
            "query->rtable"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_SPECIAL_VARNO",
          "args": [
            "var->varno"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsA",
          "args": [
            "tle->expr",
            "Var"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_tle_by_resno",
          "args": [
            "query->targetList",
            "tididx + 1"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "linitial",
          "args": [
            "rewrite->actions"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_length",
          "args": [
            "rewrite->actions"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "NameStr(attr->attname)",
            "\"ctid\""
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "namestrcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/name.c",
          "lines": "246-256",
          "snippet": "int\nnamestrcmp(Name name, const char *str)\n{\n\tif (!name && !str)\n\t\treturn 0;\n\tif (!name)\n\t\treturn -1;\t\t\t\t/* NULL < anything */\n\tif (!str)\n\t\treturn 1;\t\t\t\t/* NULL < anything */\n\treturn strncmp(NameStr(*name), str, NAMEDATALEN);\n}",
          "includes": [
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/lsyscache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"postgres.h\"\n\nint\nnamestrcmp(Name name, const char *str)\n{\n\tif (!name && !str)\n\t\treturn 0;\n\tif (!name)\n\t\treturn -1;\t\t\t\t/* NULL < anything */\n\tif (!str)\n\t\treturn 1;\t\t\t\t/* NULL < anything */\n\treturn strncmp(NameStr(*name), str, NAMEDATALEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "attr->attname"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescAttr",
          "args": [
            "att",
            "i"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RelationGetDescr",
          "args": [
            "viewrel"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nstatic Datum\ncurrtid_for_view(Relation viewrel, ItemPointer tid)\n{\n\tTupleDesc\tatt = RelationGetDescr(viewrel);\n\tRuleLock   *rulelock;\n\tRewriteRule *rewrite;\n\tint\t\t\ti,\n\t\t\t\tnatts = att->natts,\n\t\t\t\ttididx = -1;\n\n\tfor (i = 0; i < natts; i++)\n\t{\n\t\tForm_pg_attribute attr = TupleDescAttr(att, i);\n\n\t\tif (strcmp(NameStr(attr->attname), \"ctid\") == 0)\n\t\t{\n\t\t\tif (attr->atttypid != TIDOID)\n\t\t\t\telog(ERROR, \"ctid isn't of type TID\");\n\t\t\ttididx = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (tididx < 0)\n\t\telog(ERROR, \"currtid cannot handle views with no CTID\");\n\trulelock = viewrel->rd_rules;\n\tif (!rulelock)\n\t\telog(ERROR, \"the view has no rules\");\n\tfor (i = 0; i < rulelock->numLocks; i++)\n\t{\n\t\trewrite = rulelock->rules[i];\n\t\tif (rewrite->event == CMD_SELECT)\n\t\t{\n\t\t\tQuery\t   *query;\n\t\t\tTargetEntry *tle;\n\n\t\t\tif (list_length(rewrite->actions) != 1)\n\t\t\t\telog(ERROR, \"only one select rule is allowed in views\");\n\t\t\tquery = (Query *) linitial(rewrite->actions);\n\t\t\ttle = get_tle_by_resno(query->targetList, tididx + 1);\n\t\t\tif (tle && tle->expr && IsA(tle->expr, Var))\n\t\t\t{\n\t\t\t\tVar\t\t   *var = (Var *) tle->expr;\n\t\t\t\tRangeTblEntry *rte;\n\n\t\t\t\tif (!IS_SPECIAL_VARNO(var->varno) &&\n\t\t\t\t\tvar->varattno == SelfItemPointerAttributeNumber)\n\t\t\t\t{\n\t\t\t\t\trte = rt_fetch(var->varno, query->rtable);\n\t\t\t\t\tif (rte)\n\t\t\t\t\t{\n\t\t\t\t\t\theap_close(viewrel, AccessShareLock);\n\t\t\t\t\t\treturn DirectFunctionCall2(currtid_byreloid, ObjectIdGetDatum(rte->relid), PointerGetDatum(tid));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\telog(ERROR, \"currtid cannot handle this view\");\n\treturn (Datum) 0;\n}"
  },
  {
    "function_name": "setLastTid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "251-255",
    "snippet": "void\nsetLastTid(const ItemPointer tid)\n{\n\tCurrent_last_tid = *tid;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static ItemPointerData Current_last_tid = {{0, 0}, 0};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nstatic ItemPointerData Current_last_tid = {{0, 0}, 0};\n\nvoid\nsetLastTid(const ItemPointer tid)\n{\n\tCurrent_last_tid = *tid;\n}"
  },
  {
    "function_name": "tidsmaller",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "233-240",
    "snippet": "Datum\ntidsmaller(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_ITEMPOINTER(ItemPointerCompare(arg1, arg2) <= 0 ? arg1 : arg2);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_ITEMPOINTER",
          "args": [
            "ItemPointerCompare(arg1, arg2) <= 0 ? arg1 : arg2"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerCompare",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntidsmaller(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_ITEMPOINTER(ItemPointerCompare(arg1, arg2) <= 0 ? arg1 : arg2);\n}"
  },
  {
    "function_name": "tidlarger",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "224-231",
    "snippet": "Datum\ntidlarger(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_ITEMPOINTER(ItemPointerCompare(arg1, arg2) >= 0 ? arg1 : arg2);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_ITEMPOINTER",
          "args": [
            "ItemPointerCompare(arg1, arg2) >= 0 ? arg1 : arg2"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerCompare",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntidlarger(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_ITEMPOINTER(ItemPointerCompare(arg1, arg2) >= 0 ? arg1 : arg2);\n}"
  },
  {
    "function_name": "bttidcmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "215-222",
    "snippet": "Datum\nbttidcmp(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_INT32(ItemPointerCompare(arg1, arg2));\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "ItemPointerCompare(arg1, arg2)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerCompare",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\nbttidcmp(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_INT32(ItemPointerCompare(arg1, arg2));\n}"
  },
  {
    "function_name": "tidge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "206-213",
    "snippet": "Datum\ntidge(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) >= 0);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ItemPointerCompare(arg1, arg2) >= 0"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerCompare",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntidge(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) >= 0);\n}"
  },
  {
    "function_name": "tidgt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "197-204",
    "snippet": "Datum\ntidgt(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) > 0);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ItemPointerCompare(arg1, arg2) > 0"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerCompare",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntidgt(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) > 0);\n}"
  },
  {
    "function_name": "tidle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "188-195",
    "snippet": "Datum\ntidle(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) <= 0);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ItemPointerCompare(arg1, arg2) <= 0"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerCompare",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntidle(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) <= 0);\n}"
  },
  {
    "function_name": "tidlt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "179-186",
    "snippet": "Datum\ntidlt(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) < 0);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ItemPointerCompare(arg1, arg2) < 0"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerCompare",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntidlt(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) < 0);\n}"
  },
  {
    "function_name": "tidne",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "170-177",
    "snippet": "Datum\ntidne(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) != 0);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ItemPointerCompare(arg1, arg2) != 0"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerCompare",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntidne(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) != 0);\n}"
  },
  {
    "function_name": "tideq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "161-168",
    "snippet": "Datum\ntideq(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) == 0);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ItemPointerCompare(arg1, arg2) == 0"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerCompare",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "1"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntideq(PG_FUNCTION_ARGS)\n{\n\tItemPointer arg1 = PG_GETARG_ITEMPOINTER(0);\n\tItemPointer arg2 = PG_GETARG_ITEMPOINTER(1);\n\n\tPG_RETURN_BOOL(ItemPointerCompare(arg1, arg2) == 0);\n}"
  },
  {
    "function_name": "tidsend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "145-155",
    "snippet": "Datum\ntidsend(PG_FUNCTION_ARGS)\n{\n\tItemPointer itemPtr = PG_GETARG_ITEMPOINTER(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendint32(&buf, ItemPointerGetBlockNumberNoCheck(itemPtr));\n\tpq_sendint16(&buf, ItemPointerGetOffsetNumberNoCheck(itemPtr));\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BYTEA_P",
          "args": [
            "pq_endtypsend(&buf)"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_endtypsend",
          "args": [
            "&buf"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendint16",
          "args": [
            "&buf",
            "ItemPointerGetOffsetNumberNoCheck(itemPtr)"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerGetOffsetNumberNoCheck",
          "args": [
            "itemPtr"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendint32",
          "args": [
            "&buf",
            "ItemPointerGetBlockNumberNoCheck(itemPtr)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerGetBlockNumberNoCheck",
          "args": [
            "itemPtr"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_begintypsend",
          "args": [
            "&buf"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntidsend(PG_FUNCTION_ARGS)\n{\n\tItemPointer itemPtr = PG_GETARG_ITEMPOINTER(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendint32(&buf, ItemPointerGetBlockNumberNoCheck(itemPtr));\n\tpq_sendint16(&buf, ItemPointerGetOffsetNumberNoCheck(itemPtr));\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}"
  },
  {
    "function_name": "tidrecv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "124-140",
    "snippet": "Datum\ntidrecv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\tItemPointer result;\n\tBlockNumber blockNumber;\n\tOffsetNumber offsetNumber;\n\n\tblockNumber = pq_getmsgint(buf, sizeof(blockNumber));\n\toffsetNumber = pq_getmsgint(buf, sizeof(offsetNumber));\n\n\tresult = (ItemPointer) palloc(sizeof(ItemPointerData));\n\n\tItemPointerSet(result, blockNumber, offsetNumber);\n\n\tPG_RETURN_ITEMPOINTER(result);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_ITEMPOINTER",
          "args": [
            "result"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerSet",
          "args": [
            "result",
            "blockNumber",
            "offsetNumber"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(ItemPointerData)"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pq_getmsgint",
          "args": [
            "buf",
            "sizeof(offsetNumber)"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgint",
          "args": [
            "buf",
            "sizeof(blockNumber)"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntidrecv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\tItemPointer result;\n\tBlockNumber blockNumber;\n\tOffsetNumber offsetNumber;\n\n\tblockNumber = pq_getmsgint(buf, sizeof(blockNumber));\n\toffsetNumber = pq_getmsgint(buf, sizeof(offsetNumber));\n\n\tresult = (ItemPointer) palloc(sizeof(ItemPointerData));\n\n\tItemPointerSet(result, blockNumber, offsetNumber);\n\n\tPG_RETURN_ITEMPOINTER(result);\n}"
  },
  {
    "function_name": "tidout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "104-119",
    "snippet": "Datum\ntidout(PG_FUNCTION_ARGS)\n{\n\tItemPointer itemPtr = PG_GETARG_ITEMPOINTER(0);\n\tBlockNumber blockNumber;\n\tOffsetNumber offsetNumber;\n\tchar\t\tbuf[32];\n\n\tblockNumber = ItemPointerGetBlockNumberNoCheck(itemPtr);\n\toffsetNumber = ItemPointerGetOffsetNumberNoCheck(itemPtr);\n\n\t/* Perhaps someday we should output this as a record. */\n\tsnprintf(buf, sizeof(buf), \"(%u,%u)\", blockNumber, offsetNumber);\n\n\tPG_RETURN_CSTRING(pstrdup(buf));\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_CSTRING",
          "args": [
            "pstrdup(buf)"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pstrdup",
          "args": [
            "buf"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pstrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1658-1662",
          "snippet": "static char *\nxml_pstrdup(const char *string)\n{\n\treturn MemoryContextStrdup(LibxmlContext, string);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic char *\nxml_pstrdup(const char *string)\n{\n\treturn MemoryContextStrdup(LibxmlContext, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"(%u,%u)\"",
            "blockNumber",
            "offsetNumber"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerGetOffsetNumberNoCheck",
          "args": [
            "itemPtr"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerGetBlockNumberNoCheck",
          "args": [
            "itemPtr"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ITEMPOINTER",
          "args": [
            "0"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\nDatum\ntidout(PG_FUNCTION_ARGS)\n{\n\tItemPointer itemPtr = PG_GETARG_ITEMPOINTER(0);\n\tBlockNumber blockNumber;\n\tOffsetNumber offsetNumber;\n\tchar\t\tbuf[32];\n\n\tblockNumber = ItemPointerGetBlockNumberNoCheck(itemPtr);\n\toffsetNumber = ItemPointerGetOffsetNumberNoCheck(itemPtr);\n\n\t/* Perhaps someday we should output this as a record. */\n\tsnprintf(buf, sizeof(buf), \"(%u,%u)\", blockNumber, offsetNumber);\n\n\tPG_RETURN_CSTRING(pstrdup(buf));\n}"
  },
  {
    "function_name": "tidin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tid.c",
    "lines": "52-98",
    "snippet": "Datum\ntidin(PG_FUNCTION_ARGS)\n{\n\tchar\t   *str = PG_GETARG_CSTRING(0);\n\tchar\t   *p,\n\t\t\t   *coord[NTIDARGS];\n\tint\t\t\ti;\n\tItemPointer result;\n\tBlockNumber blockNumber;\n\tOffsetNumber offsetNumber;\n\tchar\t   *badp;\n\tint\t\t\thold_offset;\n\n\tfor (i = 0, p = str; *p && i < NTIDARGS && *p != RDELIM; p++)\n\t\tif (*p == DELIM || (*p == LDELIM && !i))\n\t\t\tcoord[i++] = p + 1;\n\n\tif (i < NTIDARGS)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"tid\", str)));\n\n\terrno = 0;\n\tblockNumber = strtoul(coord[0], &badp, 10);\n\tif (errno || *badp != DELIM)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"tid\", str)));\n\n\thold_offset = strtol(coord[1], &badp, 10);\n\tif (errno || *badp != RDELIM ||\n\t\thold_offset > USHRT_MAX || hold_offset < 0)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"tid\", str)));\n\n\toffsetNumber = hold_offset;\n\n\tresult = (ItemPointer) palloc(sizeof(ItemPointerData));\n\n\tItemPointerSet(result, blockNumber, offsetNumber);\n\n\tPG_RETURN_ITEMPOINTER(result);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/tqual.h\"",
      "#include \"utils/snapmgr.h\"",
      "#include \"utils/rel.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"parser/parsetree.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/heapam.h\"",
      "#include <limits.h>",
      "#include <math.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define NTIDARGS\t\t2",
      "#define DELIM\t\t\t','",
      "#define RDELIM\t\t\t')'",
      "#define LDELIM\t\t\t'('"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_ITEMPOINTER",
          "args": [
            "result"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ItemPointerSet",
          "args": [
            "result",
            "blockNumber",
            "offsetNumber"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(ItemPointerData)"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"tid\", str))"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid input syntax for type %s: \\\"%s\\\"\"",
            "\"tid\"",
            "str"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_TEXT_REPRESENTATION"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "coord[1]",
            "&badp",
            "10"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"tid\", str))"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "coord[0]",
            "&badp",
            "10"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"tid\", str))"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "0"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/tqual.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/rel.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"parser/parsetree.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"access/sysattr.h\"\n#include \"access/heapam.h\"\n#include <limits.h>\n#include <math.h>\n#include \"postgres.h\"\n\n#define NTIDARGS\t\t2\n#define DELIM\t\t\t','\n#define RDELIM\t\t\t')'\n#define LDELIM\t\t\t'('\n\nDatum\ntidin(PG_FUNCTION_ARGS)\n{\n\tchar\t   *str = PG_GETARG_CSTRING(0);\n\tchar\t   *p,\n\t\t\t   *coord[NTIDARGS];\n\tint\t\t\ti;\n\tItemPointer result;\n\tBlockNumber blockNumber;\n\tOffsetNumber offsetNumber;\n\tchar\t   *badp;\n\tint\t\t\thold_offset;\n\n\tfor (i = 0, p = str; *p && i < NTIDARGS && *p != RDELIM; p++)\n\t\tif (*p == DELIM || (*p == LDELIM && !i))\n\t\t\tcoord[i++] = p + 1;\n\n\tif (i < NTIDARGS)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"tid\", str)));\n\n\terrno = 0;\n\tblockNumber = strtoul(coord[0], &badp, 10);\n\tif (errno || *badp != DELIM)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"tid\", str)));\n\n\thold_offset = strtol(coord[1], &badp, 10);\n\tif (errno || *badp != RDELIM ||\n\t\thold_offset > USHRT_MAX || hold_offset < 0)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"tid\", str)));\n\n\toffsetNumber = hold_offset;\n\n\tresult = (ItemPointer) palloc(sizeof(ItemPointerData));\n\n\tItemPointerSet(result, blockNumber, offsetNumber);\n\n\tPG_RETURN_ITEMPOINTER(result);\n}"
  }
]