[
  {
    "function_name": "ascii_safe_strlcpy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ascii.c",
    "lines": "172-198",
    "snippet": "void\nascii_safe_strlcpy(char *dest, const char *src, size_t destsiz)\n{\n\tif (destsiz == 0)\t\t\t/* corner case: no room for trailing nul */\n\t\treturn;\n\n\twhile (--destsiz > 0)\n\t{\n\t\t/* use unsigned char here to avoid compiler warning */\n\t\tunsigned char ch = *src++;\n\n\t\tif (ch == '\\0')\n\t\t\tbreak;\n\t\t/* Keep printable ASCII characters */\n\t\tif (32 <= ch && ch <= 127)\n\t\t\t*dest = ch;\n\t\t/* White-space is also OK */\n\t\telse if (ch == '\\n' || ch == '\\r' || ch == '\\t')\n\t\t\t*dest = ch;\n\t\t/* Everything else is replaced with '?' */\n\t\telse\n\t\t\t*dest = '?';\n\t\tdest++;\n\t}\n\n\t*dest = '\\0';\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"utils/ascii.h\"",
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"utils/ascii.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nvoid\nascii_safe_strlcpy(char *dest, const char *src, size_t destsiz)\n{\n\tif (destsiz == 0)\t\t\t/* corner case: no room for trailing nul */\n\t\treturn;\n\n\twhile (--destsiz > 0)\n\t{\n\t\t/* use unsigned char here to avoid compiler warning */\n\t\tunsigned char ch = *src++;\n\n\t\tif (ch == '\\0')\n\t\t\tbreak;\n\t\t/* Keep printable ASCII characters */\n\t\tif (32 <= ch && ch <= 127)\n\t\t\t*dest = ch;\n\t\t/* White-space is also OK */\n\t\telse if (ch == '\\n' || ch == '\\r' || ch == '\\t')\n\t\t\t*dest = ch;\n\t\t/* Everything else is replaced with '?' */\n\t\telse\n\t\t\t*dest = '?';\n\t\tdest++;\n\t}\n\n\t*dest = '\\0';\n}"
  },
  {
    "function_name": "to_ascii_default",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ascii.c",
    "lines": "154-161",
    "snippet": "Datum\nto_ascii_default(PG_FUNCTION_ARGS)\n{\n\ttext\t   *data = PG_GETARG_TEXT_P_COPY(0);\n\tint\t\t\tenc = GetDatabaseEncoding();\n\n\tPG_RETURN_TEXT_P(encode_to_ascii(data, enc));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"utils/ascii.h\"",
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);",
      "static text *encode_to_ascii(text *data, int enc);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "encode_to_ascii(data, enc)"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_to_ascii",
          "args": [
            "data",
            "enc"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "encode_to_ascii",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ascii.c",
          "lines": "102-111",
          "snippet": "static text *\nencode_to_ascii(text *data, int enc)\n{\n\tpg_to_ascii((unsigned char *) VARDATA(data),\t/* src */\n\t\t\t\t(unsigned char *) (data) + VARSIZE(data),\t/* src end */\n\t\t\t\t(unsigned char *) VARDATA(data),\t/* dest */\n\t\t\t\tenc);\t\t\t/* encoding */\n\n\treturn data;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"utils/ascii.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);",
            "static text *encode_to_ascii(text *data, int enc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"utils/ascii.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);\nstatic text *encode_to_ascii(text *data, int enc);\n\nstatic text *\nencode_to_ascii(text *data, int enc)\n{\n\tpg_to_ascii((unsigned char *) VARDATA(data),\t/* src */\n\t\t\t\t(unsigned char *) (data) + VARSIZE(data),\t/* src end */\n\t\t\t\t(unsigned char *) VARDATA(data),\t/* dest */\n\t\t\t\tenc);\t\t\t/* encoding */\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetDatabaseEncoding",
          "args": [],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "GetDatabaseEncodingName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/mbutils.c",
          "lines": "1009-1013",
          "snippet": "const char *\nGetDatabaseEncodingName(void)\n{\n\treturn DatabaseEncoding->name;\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/xact.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const pg_enc2name *DatabaseEncoding = &pg_enc2name_tbl[PG_SQL_ASCII];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/builtins.h\"\n#include \"mb/pg_wchar.h\"\n#include \"catalog/namespace.h\"\n#include \"access/xact.h\"\n#include \"postgres.h\"\n\nstatic const pg_enc2name *DatabaseEncoding = &pg_enc2name_tbl[PG_SQL_ASCII];\n\nconst char *\nGetDatabaseEncodingName(void)\n{\n\treturn DatabaseEncoding->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_P_COPY",
          "args": [
            "0"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"utils/ascii.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);\nstatic text *encode_to_ascii(text *data, int enc);\n\nDatum\nto_ascii_default(PG_FUNCTION_ARGS)\n{\n\ttext\t   *data = PG_GETARG_TEXT_P_COPY(0);\n\tint\t\t\tenc = GetDatabaseEncoding();\n\n\tPG_RETURN_TEXT_P(encode_to_ascii(data, enc));\n}"
  },
  {
    "function_name": "to_ascii_enc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ascii.c",
    "lines": "136-148",
    "snippet": "Datum\nto_ascii_enc(PG_FUNCTION_ARGS)\n{\n\ttext\t   *data = PG_GETARG_TEXT_P_COPY(0);\n\tint\t\t\tenc = PG_GETARG_INT32(1);\n\n\tif (!PG_VALID_ENCODING(enc))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"%d is not a valid encoding code\", enc)));\n\n\tPG_RETURN_TEXT_P(encode_to_ascii(data, enc));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"utils/ascii.h\"",
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);",
      "static text *encode_to_ascii(text *data, int enc);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "encode_to_ascii(data, enc)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_to_ascii",
          "args": [
            "data",
            "enc"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "encode_to_ascii",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ascii.c",
          "lines": "102-111",
          "snippet": "static text *\nencode_to_ascii(text *data, int enc)\n{\n\tpg_to_ascii((unsigned char *) VARDATA(data),\t/* src */\n\t\t\t\t(unsigned char *) (data) + VARSIZE(data),\t/* src end */\n\t\t\t\t(unsigned char *) VARDATA(data),\t/* dest */\n\t\t\t\tenc);\t\t\t/* encoding */\n\n\treturn data;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"utils/ascii.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);",
            "static text *encode_to_ascii(text *data, int enc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"utils/ascii.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);\nstatic text *encode_to_ascii(text *data, int enc);\n\nstatic text *\nencode_to_ascii(text *data, int enc)\n{\n\tpg_to_ascii((unsigned char *) VARDATA(data),\t/* src */\n\t\t\t\t(unsigned char *) (data) + VARSIZE(data),\t/* src end */\n\t\t\t\t(unsigned char *) VARDATA(data),\t/* dest */\n\t\t\t\tenc);\t\t\t/* encoding */\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"%d is not a valid encoding code\", enc))"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"%d is not a valid encoding code\"",
            "enc"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_UNDEFINED_OBJECT"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_VALID_ENCODING",
          "args": [
            "enc"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "1"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_P_COPY",
          "args": [
            "0"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"utils/ascii.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);\nstatic text *encode_to_ascii(text *data, int enc);\n\nDatum\nto_ascii_enc(PG_FUNCTION_ARGS)\n{\n\ttext\t   *data = PG_GETARG_TEXT_P_COPY(0);\n\tint\t\t\tenc = PG_GETARG_INT32(1);\n\n\tif (!PG_VALID_ENCODING(enc))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"%d is not a valid encoding code\", enc)));\n\n\tPG_RETURN_TEXT_P(encode_to_ascii(data, enc));\n}"
  },
  {
    "function_name": "to_ascii_encname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ascii.c",
    "lines": "117-130",
    "snippet": "Datum\nto_ascii_encname(PG_FUNCTION_ARGS)\n{\n\ttext\t   *data = PG_GETARG_TEXT_P_COPY(0);\n\tchar\t   *encname = NameStr(*PG_GETARG_NAME(1));\n\tint\t\t\tenc = pg_char_to_encoding(encname);\n\n\tif (enc < 0)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"%s is not a valid encoding name\", encname)));\n\n\tPG_RETURN_TEXT_P(encode_to_ascii(data, enc));\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"utils/ascii.h\"",
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);",
      "static text *encode_to_ascii(text *data, int enc);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "encode_to_ascii(data, enc)"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_to_ascii",
          "args": [
            "data",
            "enc"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "encode_to_ascii",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ascii.c",
          "lines": "102-111",
          "snippet": "static text *\nencode_to_ascii(text *data, int enc)\n{\n\tpg_to_ascii((unsigned char *) VARDATA(data),\t/* src */\n\t\t\t\t(unsigned char *) (data) + VARSIZE(data),\t/* src end */\n\t\t\t\t(unsigned char *) VARDATA(data),\t/* dest */\n\t\t\t\tenc);\t\t\t/* encoding */\n\n\treturn data;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"utils/ascii.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);",
            "static text *encode_to_ascii(text *data, int enc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"utils/ascii.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);\nstatic text *encode_to_ascii(text *data, int enc);\n\nstatic text *\nencode_to_ascii(text *data, int enc)\n{\n\tpg_to_ascii((unsigned char *) VARDATA(data),\t/* src */\n\t\t\t\t(unsigned char *) (data) + VARSIZE(data),\t/* src end */\n\t\t\t\t(unsigned char *) VARDATA(data),\t/* dest */\n\t\t\t\tenc);\t\t\t/* encoding */\n\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"%s is not a valid encoding name\", encname))"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"%s is not a valid encoding name\"",
            "encname"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_UNDEFINED_OBJECT"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_char_to_encoding",
          "args": [
            "encname"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "pg_char_to_encoding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/encnames.c",
          "lines": "550-594",
          "snippet": "int\npg_char_to_encoding(const char *name)\n{\n\tunsigned int nel = lengthof(pg_encname_tbl);\n\tconst pg_encname *base = pg_encname_tbl,\n\t\t\t   *last = base + nel - 1,\n\t\t\t   *position;\n\tint\t\t\tresult;\n\tchar\t\tbuff[NAMEDATALEN],\n\t\t\t   *key;\n\n\tif (name == NULL || *name == '\\0')\n\t\treturn -1;\n\n\tif (strlen(name) >= NAMEDATALEN)\n\t{\n#ifdef FRONTEND\n\t\tfprintf(stderr, \"encoding name too long\\n\");\n\t\treturn -1;\n#else\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NAME_TOO_LONG),\n\t\t\t\t errmsg(\"encoding name too long\")));\n#endif\n\t}\n\tkey = clean_encoding_name(name, buff);\n\n\twhile (last >= base)\n\t{\n\t\tposition = base + ((last - base) >> 1);\n\t\tresult = key[0] - position->name[0];\n\n\t\tif (result == 0)\n\t\t{\n\t\t\tresult = strcmp(key, position->name);\n\t\t\tif (result == 0)\n\t\t\t\treturn position->encoding;\n\t\t}\n\t\tif (result < 0)\n\t\t\tlast = position - 1;\n\t\telse\n\t\t\tbase = position + 1;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include <unistd.h>",
            "#include <ctype.h>",
            "#include \"utils/builtins.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const pg_encname pg_encname_tbl[] =\n{\n\t{\n\t\t\"abc\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* alias for WIN1258 */\n\t{\n\t\t\"alt\", PG_WIN866\n\t},\t\t\t\t\t\t\t/* IBM866 */\n\t{\n\t\t\"big5\", PG_BIG5\n\t},\t\t\t\t\t\t\t/* Big5; Chinese for Taiwan multibyte set */\n\t{\n\t\t\"euccn\", PG_EUC_CN\n\t},\t\t\t\t\t\t\t/* EUC-CN; Extended Unix Code for simplified\n\t\t\t\t\t\t\t\t * Chinese */\n\t{\n\t\t\"eucjis2004\", PG_EUC_JIS_2004\n\t},\t\t\t\t\t\t\t/* EUC-JIS-2004; Extended UNIX Code fixed\n\t\t\t\t\t\t\t\t * Width for Japanese, standard JIS X 0213 */\n\t{\n\t\t\"eucjp\", PG_EUC_JP\n\t},\t\t\t\t\t\t\t/* EUC-JP; Extended UNIX Code fixed Width for\n\t\t\t\t\t\t\t\t * Japanese, standard OSF */\n\t{\n\t\t\"euckr\", PG_EUC_KR\n\t},\t\t\t\t\t\t\t/* EUC-KR; Extended Unix Code for Korean , KS\n\t\t\t\t\t\t\t\t * X 1001 standard */\n\t{\n\t\t\"euctw\", PG_EUC_TW\n\t},\t\t\t\t\t\t\t/* EUC-TW; Extended Unix Code for\n\t\t\t\t\t\t\t\t *\n\t\t\t\t\t\t\t\t * traditional Chinese */\n\t{\n\t\t\"gb18030\", PG_GB18030\n\t},\t\t\t\t\t\t\t/* GB18030;GB18030 */\n\t{\n\t\t\"gbk\", PG_GBK\n\t},\t\t\t\t\t\t\t/* GBK; Chinese Windows CodePage 936\n\t\t\t\t\t\t\t\t * simplified Chinese */\n\t{\n\t\t\"iso88591\", PG_LATIN1\n\t},\t\t\t\t\t\t\t/* ISO-8859-1; RFC1345,KXS2 */\n\t{\n\t\t\"iso885910\", PG_LATIN6\n\t},\t\t\t\t\t\t\t/* ISO-8859-10; RFC1345,KXS2 */\n\t{\n\t\t\"iso885913\", PG_LATIN7\n\t},\t\t\t\t\t\t\t/* ISO-8859-13; RFC1345,KXS2 */\n\t{\n\t\t\"iso885914\", PG_LATIN8\n\t},\t\t\t\t\t\t\t/* ISO-8859-14; RFC1345,KXS2 */\n\t{\n\t\t\"iso885915\", PG_LATIN9\n\t},\t\t\t\t\t\t\t/* ISO-8859-15; RFC1345,KXS2 */\n\t{\n\t\t\"iso885916\", PG_LATIN10\n\t},\t\t\t\t\t\t\t/* ISO-8859-16; RFC1345,KXS2 */\n\t{\n\t\t\"iso88592\", PG_LATIN2\n\t},\t\t\t\t\t\t\t/* ISO-8859-2; RFC1345,KXS2 */\n\t{\n\t\t\"iso88593\", PG_LATIN3\n\t},\t\t\t\t\t\t\t/* ISO-8859-3; RFC1345,KXS2 */\n\t{\n\t\t\"iso88594\", PG_LATIN4\n\t},\t\t\t\t\t\t\t/* ISO-8859-4; RFC1345,KXS2 */\n\t{\n\t\t\"iso88595\", PG_ISO_8859_5\n\t},\t\t\t\t\t\t\t/* ISO-8859-5; RFC1345,KXS2 */\n\t{\n\t\t\"iso88596\", PG_ISO_8859_6\n\t},\t\t\t\t\t\t\t/* ISO-8859-6; RFC1345,KXS2 */\n\t{\n\t\t\"iso88597\", PG_ISO_8859_7\n\t},\t\t\t\t\t\t\t/* ISO-8859-7; RFC1345,KXS2 */\n\t{\n\t\t\"iso88598\", PG_ISO_8859_8\n\t},\t\t\t\t\t\t\t/* ISO-8859-8; RFC1345,KXS2 */\n\t{\n\t\t\"iso88599\", PG_LATIN5\n\t},\t\t\t\t\t\t\t/* ISO-8859-9; RFC1345,KXS2 */\n\t{\n\t\t\"johab\", PG_JOHAB\n\t},\t\t\t\t\t\t\t/* JOHAB; Extended Unix Code for simplified\n\t\t\t\t\t\t\t\t * Chinese */\n\t{\n\t\t\"koi8\", PG_KOI8R\n\t},\t\t\t\t\t\t\t/* _dirty_ alias for KOI8-R (backward\n\t\t\t\t\t\t\t\t * compatibility) */\n\t{\n\t\t\"koi8r\", PG_KOI8R\n\t},\t\t\t\t\t\t\t/* KOI8-R; RFC1489 */\n\t{\n\t\t\"koi8u\", PG_KOI8U\n\t},\t\t\t\t\t\t\t/* KOI8-U; RFC2319 */\n\t{\n\t\t\"latin1\", PG_LATIN1\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-1 */\n\t{\n\t\t\"latin10\", PG_LATIN10\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-16 */\n\t{\n\t\t\"latin2\", PG_LATIN2\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-2 */\n\t{\n\t\t\"latin3\", PG_LATIN3\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-3 */\n\t{\n\t\t\"latin4\", PG_LATIN4\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-4 */\n\t{\n\t\t\"latin5\", PG_LATIN5\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-9 */\n\t{\n\t\t\"latin6\", PG_LATIN6\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-10 */\n\t{\n\t\t\"latin7\", PG_LATIN7\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-13 */\n\t{\n\t\t\"latin8\", PG_LATIN8\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-14 */\n\t{\n\t\t\"latin9\", PG_LATIN9\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-15 */\n\t{\n\t\t\"mskanji\", PG_SJIS\n\t},\t\t\t\t\t\t\t/* alias for Shift_JIS */\n\t{\n\t\t\"muleinternal\", PG_MULE_INTERNAL\n\t},\n\t{\n\t\t\"shiftjis\", PG_SJIS\n\t},\t\t\t\t\t\t\t/* Shift_JIS; JIS X 0202-1991 */\n\n\t{\n\t\t\"shiftjis2004\", PG_SHIFT_JIS_2004\n\t},\t\t\t\t\t\t\t/* SHIFT-JIS-2004; Shift JIS for Japanese,\n\t\t\t\t\t\t\t\t * standard JIS X 0213 */\n\t{\n\t\t\"sjis\", PG_SJIS\n\t},\t\t\t\t\t\t\t/* alias for Shift_JIS */\n\t{\n\t\t\"sqlascii\", PG_SQL_ASCII\n\t},\n\t{\n\t\t\"tcvn\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* alias for WIN1258 */\n\t{\n\t\t\"tcvn5712\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* alias for WIN1258 */\n\t{\n\t\t\"uhc\", PG_UHC\n\t},\t\t\t\t\t\t\t/* UHC; Korean Windows CodePage 949 */\n\t{\n\t\t\"unicode\", PG_UTF8\n\t},\t\t\t\t\t\t\t/* alias for UTF8 */\n\t{\n\t\t\"utf8\", PG_UTF8\n\t},\t\t\t\t\t\t\t/* alias for UTF8 */\n\t{\n\t\t\"vscii\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* alias for WIN1258 */\n\t{\n\t\t\"win\", PG_WIN1251\n\t},\t\t\t\t\t\t\t/* _dirty_ alias for windows-1251 (backward\n\t\t\t\t\t\t\t\t * compatibility) */\n\t{\n\t\t\"win1250\", PG_WIN1250\n\t},\t\t\t\t\t\t\t/* alias for Windows-1250 */\n\t{\n\t\t\"win1251\", PG_WIN1251\n\t},\t\t\t\t\t\t\t/* alias for Windows-1251 */\n\t{\n\t\t\"win1252\", PG_WIN1252\n\t},\t\t\t\t\t\t\t/* alias for Windows-1252 */\n\t{\n\t\t\"win1253\", PG_WIN1253\n\t},\t\t\t\t\t\t\t/* alias for Windows-1253 */\n\t{\n\t\t\"win1254\", PG_WIN1254\n\t},\t\t\t\t\t\t\t/* alias for Windows-1254 */\n\t{\n\t\t\"win1255\", PG_WIN1255\n\t},\t\t\t\t\t\t\t/* alias for Windows-1255 */\n\t{\n\t\t\"win1256\", PG_WIN1256\n\t},\t\t\t\t\t\t\t/* alias for Windows-1256 */\n\t{\n\t\t\"win1257\", PG_WIN1257\n\t},\t\t\t\t\t\t\t/* alias for Windows-1257 */\n\t{\n\t\t\"win1258\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* alias for Windows-1258 */\n\t{\n\t\t\"win866\", PG_WIN866\n\t},\t\t\t\t\t\t\t/* IBM866 */\n\t{\n\t\t\"win874\", PG_WIN874\n\t},\t\t\t\t\t\t\t/* alias for Windows-874 */\n\t{\n\t\t\"win932\", PG_SJIS\n\t},\t\t\t\t\t\t\t/* alias for Shift_JIS */\n\t{\n\t\t\"win936\", PG_GBK\n\t},\t\t\t\t\t\t\t/* alias for GBK */\n\t{\n\t\t\"win949\", PG_UHC\n\t},\t\t\t\t\t\t\t/* alias for UHC */\n\t{\n\t\t\"win950\", PG_BIG5\n\t},\t\t\t\t\t\t\t/* alias for BIG5 */\n\t{\n\t\t\"windows1250\", PG_WIN1250\n\t},\t\t\t\t\t\t\t/* Windows-1251; Microsoft */\n\t{\n\t\t\"windows1251\", PG_WIN1251\n\t},\t\t\t\t\t\t\t/* Windows-1251; Microsoft */\n\t{\n\t\t\"windows1252\", PG_WIN1252\n\t},\t\t\t\t\t\t\t/* Windows-1252; Microsoft */\n\t{\n\t\t\"windows1253\", PG_WIN1253\n\t},\t\t\t\t\t\t\t/* Windows-1253; Microsoft */\n\t{\n\t\t\"windows1254\", PG_WIN1254\n\t},\t\t\t\t\t\t\t/* Windows-1254; Microsoft */\n\t{\n\t\t\"windows1255\", PG_WIN1255\n\t},\t\t\t\t\t\t\t/* Windows-1255; Microsoft */\n\t{\n\t\t\"windows1256\", PG_WIN1256\n\t},\t\t\t\t\t\t\t/* Windows-1256; Microsoft */\n\t{\n\t\t\"windows1257\", PG_WIN1257\n\t},\t\t\t\t\t\t\t/* Windows-1257; Microsoft */\n\t{\n\t\t\"windows1258\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* Windows-1258; Microsoft */\n\t{\n\t\t\"windows866\", PG_WIN866\n\t},\t\t\t\t\t\t\t/* IBM866 */\n\t{\n\t\t\"windows874\", PG_WIN874\n\t},\t\t\t\t\t\t\t/* Windows-874; Microsoft */\n\t{\n\t\t\"windows932\", PG_SJIS\n\t},\t\t\t\t\t\t\t/* alias for Shift_JIS */\n\t{\n\t\t\"windows936\", PG_GBK\n\t},\t\t\t\t\t\t\t/* alias for GBK */\n\t{\n\t\t\"windows949\", PG_UHC\n\t},\t\t\t\t\t\t\t/* alias for UHC */\n\t{\n\t\t\"windows950\", PG_BIG5\n\t}\t\t\t\t\t\t\t/* alias for BIG5 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include <unistd.h>\n#include <ctype.h>\n#include \"utils/builtins.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nstatic const pg_encname pg_encname_tbl[] =\n{\n\t{\n\t\t\"abc\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* alias for WIN1258 */\n\t{\n\t\t\"alt\", PG_WIN866\n\t},\t\t\t\t\t\t\t/* IBM866 */\n\t{\n\t\t\"big5\", PG_BIG5\n\t},\t\t\t\t\t\t\t/* Big5; Chinese for Taiwan multibyte set */\n\t{\n\t\t\"euccn\", PG_EUC_CN\n\t},\t\t\t\t\t\t\t/* EUC-CN; Extended Unix Code for simplified\n\t\t\t\t\t\t\t\t * Chinese */\n\t{\n\t\t\"eucjis2004\", PG_EUC_JIS_2004\n\t},\t\t\t\t\t\t\t/* EUC-JIS-2004; Extended UNIX Code fixed\n\t\t\t\t\t\t\t\t * Width for Japanese, standard JIS X 0213 */\n\t{\n\t\t\"eucjp\", PG_EUC_JP\n\t},\t\t\t\t\t\t\t/* EUC-JP; Extended UNIX Code fixed Width for\n\t\t\t\t\t\t\t\t * Japanese, standard OSF */\n\t{\n\t\t\"euckr\", PG_EUC_KR\n\t},\t\t\t\t\t\t\t/* EUC-KR; Extended Unix Code for Korean , KS\n\t\t\t\t\t\t\t\t * X 1001 standard */\n\t{\n\t\t\"euctw\", PG_EUC_TW\n\t},\t\t\t\t\t\t\t/* EUC-TW; Extended Unix Code for\n\t\t\t\t\t\t\t\t *\n\t\t\t\t\t\t\t\t * traditional Chinese */\n\t{\n\t\t\"gb18030\", PG_GB18030\n\t},\t\t\t\t\t\t\t/* GB18030;GB18030 */\n\t{\n\t\t\"gbk\", PG_GBK\n\t},\t\t\t\t\t\t\t/* GBK; Chinese Windows CodePage 936\n\t\t\t\t\t\t\t\t * simplified Chinese */\n\t{\n\t\t\"iso88591\", PG_LATIN1\n\t},\t\t\t\t\t\t\t/* ISO-8859-1; RFC1345,KXS2 */\n\t{\n\t\t\"iso885910\", PG_LATIN6\n\t},\t\t\t\t\t\t\t/* ISO-8859-10; RFC1345,KXS2 */\n\t{\n\t\t\"iso885913\", PG_LATIN7\n\t},\t\t\t\t\t\t\t/* ISO-8859-13; RFC1345,KXS2 */\n\t{\n\t\t\"iso885914\", PG_LATIN8\n\t},\t\t\t\t\t\t\t/* ISO-8859-14; RFC1345,KXS2 */\n\t{\n\t\t\"iso885915\", PG_LATIN9\n\t},\t\t\t\t\t\t\t/* ISO-8859-15; RFC1345,KXS2 */\n\t{\n\t\t\"iso885916\", PG_LATIN10\n\t},\t\t\t\t\t\t\t/* ISO-8859-16; RFC1345,KXS2 */\n\t{\n\t\t\"iso88592\", PG_LATIN2\n\t},\t\t\t\t\t\t\t/* ISO-8859-2; RFC1345,KXS2 */\n\t{\n\t\t\"iso88593\", PG_LATIN3\n\t},\t\t\t\t\t\t\t/* ISO-8859-3; RFC1345,KXS2 */\n\t{\n\t\t\"iso88594\", PG_LATIN4\n\t},\t\t\t\t\t\t\t/* ISO-8859-4; RFC1345,KXS2 */\n\t{\n\t\t\"iso88595\", PG_ISO_8859_5\n\t},\t\t\t\t\t\t\t/* ISO-8859-5; RFC1345,KXS2 */\n\t{\n\t\t\"iso88596\", PG_ISO_8859_6\n\t},\t\t\t\t\t\t\t/* ISO-8859-6; RFC1345,KXS2 */\n\t{\n\t\t\"iso88597\", PG_ISO_8859_7\n\t},\t\t\t\t\t\t\t/* ISO-8859-7; RFC1345,KXS2 */\n\t{\n\t\t\"iso88598\", PG_ISO_8859_8\n\t},\t\t\t\t\t\t\t/* ISO-8859-8; RFC1345,KXS2 */\n\t{\n\t\t\"iso88599\", PG_LATIN5\n\t},\t\t\t\t\t\t\t/* ISO-8859-9; RFC1345,KXS2 */\n\t{\n\t\t\"johab\", PG_JOHAB\n\t},\t\t\t\t\t\t\t/* JOHAB; Extended Unix Code for simplified\n\t\t\t\t\t\t\t\t * Chinese */\n\t{\n\t\t\"koi8\", PG_KOI8R\n\t},\t\t\t\t\t\t\t/* _dirty_ alias for KOI8-R (backward\n\t\t\t\t\t\t\t\t * compatibility) */\n\t{\n\t\t\"koi8r\", PG_KOI8R\n\t},\t\t\t\t\t\t\t/* KOI8-R; RFC1489 */\n\t{\n\t\t\"koi8u\", PG_KOI8U\n\t},\t\t\t\t\t\t\t/* KOI8-U; RFC2319 */\n\t{\n\t\t\"latin1\", PG_LATIN1\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-1 */\n\t{\n\t\t\"latin10\", PG_LATIN10\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-16 */\n\t{\n\t\t\"latin2\", PG_LATIN2\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-2 */\n\t{\n\t\t\"latin3\", PG_LATIN3\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-3 */\n\t{\n\t\t\"latin4\", PG_LATIN4\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-4 */\n\t{\n\t\t\"latin5\", PG_LATIN5\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-9 */\n\t{\n\t\t\"latin6\", PG_LATIN6\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-10 */\n\t{\n\t\t\"latin7\", PG_LATIN7\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-13 */\n\t{\n\t\t\"latin8\", PG_LATIN8\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-14 */\n\t{\n\t\t\"latin9\", PG_LATIN9\n\t},\t\t\t\t\t\t\t/* alias for ISO-8859-15 */\n\t{\n\t\t\"mskanji\", PG_SJIS\n\t},\t\t\t\t\t\t\t/* alias for Shift_JIS */\n\t{\n\t\t\"muleinternal\", PG_MULE_INTERNAL\n\t},\n\t{\n\t\t\"shiftjis\", PG_SJIS\n\t},\t\t\t\t\t\t\t/* Shift_JIS; JIS X 0202-1991 */\n\n\t{\n\t\t\"shiftjis2004\", PG_SHIFT_JIS_2004\n\t},\t\t\t\t\t\t\t/* SHIFT-JIS-2004; Shift JIS for Japanese,\n\t\t\t\t\t\t\t\t * standard JIS X 0213 */\n\t{\n\t\t\"sjis\", PG_SJIS\n\t},\t\t\t\t\t\t\t/* alias for Shift_JIS */\n\t{\n\t\t\"sqlascii\", PG_SQL_ASCII\n\t},\n\t{\n\t\t\"tcvn\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* alias for WIN1258 */\n\t{\n\t\t\"tcvn5712\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* alias for WIN1258 */\n\t{\n\t\t\"uhc\", PG_UHC\n\t},\t\t\t\t\t\t\t/* UHC; Korean Windows CodePage 949 */\n\t{\n\t\t\"unicode\", PG_UTF8\n\t},\t\t\t\t\t\t\t/* alias for UTF8 */\n\t{\n\t\t\"utf8\", PG_UTF8\n\t},\t\t\t\t\t\t\t/* alias for UTF8 */\n\t{\n\t\t\"vscii\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* alias for WIN1258 */\n\t{\n\t\t\"win\", PG_WIN1251\n\t},\t\t\t\t\t\t\t/* _dirty_ alias for windows-1251 (backward\n\t\t\t\t\t\t\t\t * compatibility) */\n\t{\n\t\t\"win1250\", PG_WIN1250\n\t},\t\t\t\t\t\t\t/* alias for Windows-1250 */\n\t{\n\t\t\"win1251\", PG_WIN1251\n\t},\t\t\t\t\t\t\t/* alias for Windows-1251 */\n\t{\n\t\t\"win1252\", PG_WIN1252\n\t},\t\t\t\t\t\t\t/* alias for Windows-1252 */\n\t{\n\t\t\"win1253\", PG_WIN1253\n\t},\t\t\t\t\t\t\t/* alias for Windows-1253 */\n\t{\n\t\t\"win1254\", PG_WIN1254\n\t},\t\t\t\t\t\t\t/* alias for Windows-1254 */\n\t{\n\t\t\"win1255\", PG_WIN1255\n\t},\t\t\t\t\t\t\t/* alias for Windows-1255 */\n\t{\n\t\t\"win1256\", PG_WIN1256\n\t},\t\t\t\t\t\t\t/* alias for Windows-1256 */\n\t{\n\t\t\"win1257\", PG_WIN1257\n\t},\t\t\t\t\t\t\t/* alias for Windows-1257 */\n\t{\n\t\t\"win1258\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* alias for Windows-1258 */\n\t{\n\t\t\"win866\", PG_WIN866\n\t},\t\t\t\t\t\t\t/* IBM866 */\n\t{\n\t\t\"win874\", PG_WIN874\n\t},\t\t\t\t\t\t\t/* alias for Windows-874 */\n\t{\n\t\t\"win932\", PG_SJIS\n\t},\t\t\t\t\t\t\t/* alias for Shift_JIS */\n\t{\n\t\t\"win936\", PG_GBK\n\t},\t\t\t\t\t\t\t/* alias for GBK */\n\t{\n\t\t\"win949\", PG_UHC\n\t},\t\t\t\t\t\t\t/* alias for UHC */\n\t{\n\t\t\"win950\", PG_BIG5\n\t},\t\t\t\t\t\t\t/* alias for BIG5 */\n\t{\n\t\t\"windows1250\", PG_WIN1250\n\t},\t\t\t\t\t\t\t/* Windows-1251; Microsoft */\n\t{\n\t\t\"windows1251\", PG_WIN1251\n\t},\t\t\t\t\t\t\t/* Windows-1251; Microsoft */\n\t{\n\t\t\"windows1252\", PG_WIN1252\n\t},\t\t\t\t\t\t\t/* Windows-1252; Microsoft */\n\t{\n\t\t\"windows1253\", PG_WIN1253\n\t},\t\t\t\t\t\t\t/* Windows-1253; Microsoft */\n\t{\n\t\t\"windows1254\", PG_WIN1254\n\t},\t\t\t\t\t\t\t/* Windows-1254; Microsoft */\n\t{\n\t\t\"windows1255\", PG_WIN1255\n\t},\t\t\t\t\t\t\t/* Windows-1255; Microsoft */\n\t{\n\t\t\"windows1256\", PG_WIN1256\n\t},\t\t\t\t\t\t\t/* Windows-1256; Microsoft */\n\t{\n\t\t\"windows1257\", PG_WIN1257\n\t},\t\t\t\t\t\t\t/* Windows-1257; Microsoft */\n\t{\n\t\t\"windows1258\", PG_WIN1258\n\t},\t\t\t\t\t\t\t/* Windows-1258; Microsoft */\n\t{\n\t\t\"windows866\", PG_WIN866\n\t},\t\t\t\t\t\t\t/* IBM866 */\n\t{\n\t\t\"windows874\", PG_WIN874\n\t},\t\t\t\t\t\t\t/* Windows-874; Microsoft */\n\t{\n\t\t\"windows932\", PG_SJIS\n\t},\t\t\t\t\t\t\t/* alias for Shift_JIS */\n\t{\n\t\t\"windows936\", PG_GBK\n\t},\t\t\t\t\t\t\t/* alias for GBK */\n\t{\n\t\t\"windows949\", PG_UHC\n\t},\t\t\t\t\t\t\t/* alias for UHC */\n\t{\n\t\t\"windows950\", PG_BIG5\n\t}\t\t\t\t\t\t\t/* alias for BIG5 */\n};\n\nint\npg_char_to_encoding(const char *name)\n{\n\tunsigned int nel = lengthof(pg_encname_tbl);\n\tconst pg_encname *base = pg_encname_tbl,\n\t\t\t   *last = base + nel - 1,\n\t\t\t   *position;\n\tint\t\t\tresult;\n\tchar\t\tbuff[NAMEDATALEN],\n\t\t\t   *key;\n\n\tif (name == NULL || *name == '\\0')\n\t\treturn -1;\n\n\tif (strlen(name) >= NAMEDATALEN)\n\t{\n#ifdef FRONTEND\n\t\tfprintf(stderr, \"encoding name too long\\n\");\n\t\treturn -1;\n#else\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NAME_TOO_LONG),\n\t\t\t\t errmsg(\"encoding name too long\")));\n#endif\n\t}\n\tkey = clean_encoding_name(name, buff);\n\n\twhile (last >= base)\n\t{\n\t\tposition = base + ((last - base) >> 1);\n\t\tresult = key[0] - position->name[0];\n\n\t\tif (result == 0)\n\t\t{\n\t\t\tresult = strcmp(key, position->name);\n\t\t\tif (result == 0)\n\t\t\t\treturn position->encoding;\n\t\t}\n\t\tif (result < 0)\n\t\t\tlast = position - 1;\n\t\telse\n\t\t\tbase = position + 1;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*PG_GETARG_NAME(1)"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "1"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_P_COPY",
          "args": [
            "0"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"utils/ascii.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);\nstatic text *encode_to_ascii(text *data, int enc);\n\nDatum\nto_ascii_encname(PG_FUNCTION_ARGS)\n{\n\ttext\t   *data = PG_GETARG_TEXT_P_COPY(0);\n\tchar\t   *encname = NameStr(*PG_GETARG_NAME(1));\n\tint\t\t\tenc = pg_char_to_encoding(encname);\n\n\tif (enc < 0)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"%s is not a valid encoding name\", encname)));\n\n\tPG_RETURN_TEXT_P(encode_to_ascii(data, enc));\n}"
  },
  {
    "function_name": "encode_to_ascii",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ascii.c",
    "lines": "102-111",
    "snippet": "static text *\nencode_to_ascii(text *data, int enc)\n{\n\tpg_to_ascii((unsigned char *) VARDATA(data),\t/* src */\n\t\t\t\t(unsigned char *) (data) + VARSIZE(data),\t/* src end */\n\t\t\t\t(unsigned char *) VARDATA(data),\t/* dest */\n\t\t\t\tenc);\t\t\t/* encoding */\n\n\treturn data;\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"utils/ascii.h\"",
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);",
      "static text *encode_to_ascii(text *data, int enc);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_to_ascii",
          "args": [
            "(unsigned char *) VARDATA(data)",
            "/* src */(unsigned char *) (data) + VARSIZE(data)",
            "/* src end */(unsigned char *) VARDATA(data)",
            "/* dest */enc"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "pg_to_ascii",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ascii.c",
          "lines": "27-93",
          "snippet": "static void\npg_to_ascii(unsigned char *src, unsigned char *src_end, unsigned char *dest, int enc)\n{\n\tunsigned char *x;\n\tconst unsigned char *ascii;\n\tint\t\t\trange;\n\n\t/*\n\t * relevant start for an encoding\n\t */\n#define RANGE_128\t128\n#define RANGE_160\t160\n\n\tif (enc == PG_LATIN1)\n\t{\n\t\t/*\n\t\t * ISO-8859-1 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  cL Y  \\\"Ca  -R     'u .,      ?AAAAAAACEEEEIIII NOOOOOxOUUUUYTBaaaaaaaceeeeiiii nooooo/ouuuuyty\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_LATIN2)\n\t{\n\t\t/*\n\t\t * ISO-8859-2 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \" A L LS \\\"SSTZ-ZZ a,l'ls ,sstz\\\"zzRAAAALCCCEEEEIIDDNNOOOOxRUUUUYTBraaaalccceeeeiiddnnoooo/ruuuuyt.\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_LATIN9)\n\t{\n\t\t/*\n\t\t * ISO-8859-15 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  cL YS sCa  -R     Zu .z   EeY?AAAAAAACEEEEIIII NOOOOOxOUUUUYTBaaaaaaaceeeeiiii nooooo/ouuuuyty\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_WIN1250)\n\t{\n\t\t/*\n\t\t * Window CP1250 <range: 128 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  ' \\\"    %S<STZZ `'\\\"\\\".--  s>stzz   L A  \\\"CS  -RZ  ,l'u .,as L\\\"lzRAAAALCCCEEEEIIDDNNOOOOxRUUUUYTBraaaalccceeeeiiddnnoooo/ruuuuyt \";\n\t\trange = RANGE_128;\n\t}\n\telse\n\t{\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"encoding conversion from %s to ASCII not supported\",\n\t\t\t\t\t\tpg_encoding_to_char(enc))));\n\t\treturn;\t\t\t\t\t/* keep compiler quiet */\n\t}\n\n\t/*\n\t * Encode\n\t */\n\tfor (x = src; x < src_end; x++)\n\t{\n\t\tif (*x < 128)\n\t\t\t*dest++ = *x;\n\t\telse if (*x < range)\n\t\t\t*dest++ = ' ';\t\t/* bogus 128 to 'range' */\n\t\telse\n\t\t\t*dest++ = ascii[*x - range];\n\t}\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"utils/ascii.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define RANGE_160\t160",
            "#define RANGE_128\t128"
          ],
          "globals_used": [
            "static void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);",
            "static text *encode_to_ascii(text *data, int enc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"utils/ascii.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\n#define RANGE_160\t160\n#define RANGE_128\t128\n\nstatic void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);\nstatic text *encode_to_ascii(text *data, int enc);\n\nstatic void\npg_to_ascii(unsigned char *src, unsigned char *src_end, unsigned char *dest, int enc)\n{\n\tunsigned char *x;\n\tconst unsigned char *ascii;\n\tint\t\t\trange;\n\n\t/*\n\t * relevant start for an encoding\n\t */\n#define RANGE_128\t128\n#define RANGE_160\t160\n\n\tif (enc == PG_LATIN1)\n\t{\n\t\t/*\n\t\t * ISO-8859-1 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  cL Y  \\\"Ca  -R     'u .,      ?AAAAAAACEEEEIIII NOOOOOxOUUUUYTBaaaaaaaceeeeiiii nooooo/ouuuuyty\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_LATIN2)\n\t{\n\t\t/*\n\t\t * ISO-8859-2 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \" A L LS \\\"SSTZ-ZZ a,l'ls ,sstz\\\"zzRAAAALCCCEEEEIIDDNNOOOOxRUUUUYTBraaaalccceeeeiiddnnoooo/ruuuuyt.\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_LATIN9)\n\t{\n\t\t/*\n\t\t * ISO-8859-15 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  cL YS sCa  -R     Zu .z   EeY?AAAAAAACEEEEIIII NOOOOOxOUUUUYTBaaaaaaaceeeeiiii nooooo/ouuuuyty\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_WIN1250)\n\t{\n\t\t/*\n\t\t * Window CP1250 <range: 128 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  ' \\\"    %S<STZZ `'\\\"\\\".--  s>stzz   L A  \\\"CS  -RZ  ,l'u .,as L\\\"lzRAAAALCCCEEEEIIDDNNOOOOxRUUUUYTBraaaalccceeeeiiddnnoooo/ruuuuyt \";\n\t\trange = RANGE_128;\n\t}\n\telse\n\t{\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"encoding conversion from %s to ASCII not supported\",\n\t\t\t\t\t\tpg_encoding_to_char(enc))));\n\t\treturn;\t\t\t\t\t/* keep compiler quiet */\n\t}\n\n\t/*\n\t * Encode\n\t */\n\tfor (x = src; x < src_end; x++)\n\t{\n\t\tif (*x < 128)\n\t\t\t*dest++ = *x;\n\t\telse if (*x < range)\n\t\t\t*dest++ = ' ';\t\t/* bogus 128 to 'range' */\n\t\telse\n\t\t\t*dest++ = ascii[*x - range];\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "VARDATA",
          "args": [
            "data"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARSIZE",
          "args": [
            "data"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARDATA",
          "args": [
            "data"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"utils/ascii.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);\nstatic text *encode_to_ascii(text *data, int enc);\n\nstatic text *\nencode_to_ascii(text *data, int enc)\n{\n\tpg_to_ascii((unsigned char *) VARDATA(data),\t/* src */\n\t\t\t\t(unsigned char *) (data) + VARSIZE(data),\t/* src end */\n\t\t\t\t(unsigned char *) VARDATA(data),\t/* dest */\n\t\t\t\tenc);\t\t\t/* encoding */\n\n\treturn data;\n}"
  },
  {
    "function_name": "pg_to_ascii",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/ascii.c",
    "lines": "27-93",
    "snippet": "static void\npg_to_ascii(unsigned char *src, unsigned char *src_end, unsigned char *dest, int enc)\n{\n\tunsigned char *x;\n\tconst unsigned char *ascii;\n\tint\t\t\trange;\n\n\t/*\n\t * relevant start for an encoding\n\t */\n#define RANGE_128\t128\n#define RANGE_160\t160\n\n\tif (enc == PG_LATIN1)\n\t{\n\t\t/*\n\t\t * ISO-8859-1 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  cL Y  \\\"Ca  -R     'u .,      ?AAAAAAACEEEEIIII NOOOOOxOUUUUYTBaaaaaaaceeeeiiii nooooo/ouuuuyty\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_LATIN2)\n\t{\n\t\t/*\n\t\t * ISO-8859-2 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \" A L LS \\\"SSTZ-ZZ a,l'ls ,sstz\\\"zzRAAAALCCCEEEEIIDDNNOOOOxRUUUUYTBraaaalccceeeeiiddnnoooo/ruuuuyt.\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_LATIN9)\n\t{\n\t\t/*\n\t\t * ISO-8859-15 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  cL YS sCa  -R     Zu .z   EeY?AAAAAAACEEEEIIII NOOOOOxOUUUUYTBaaaaaaaceeeeiiii nooooo/ouuuuyty\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_WIN1250)\n\t{\n\t\t/*\n\t\t * Window CP1250 <range: 128 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  ' \\\"    %S<STZZ `'\\\"\\\".--  s>stzz   L A  \\\"CS  -RZ  ,l'u .,as L\\\"lzRAAAALCCCEEEEIIDDNNOOOOxRUUUUYTBraaaalccceeeeiiddnnoooo/ruuuuyt \";\n\t\trange = RANGE_128;\n\t}\n\telse\n\t{\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"encoding conversion from %s to ASCII not supported\",\n\t\t\t\t\t\tpg_encoding_to_char(enc))));\n\t\treturn;\t\t\t\t\t/* keep compiler quiet */\n\t}\n\n\t/*\n\t * Encode\n\t */\n\tfor (x = src; x < src_end; x++)\n\t{\n\t\tif (*x < 128)\n\t\t\t*dest++ = *x;\n\t\telse if (*x < range)\n\t\t\t*dest++ = ' ';\t\t/* bogus 128 to 'range' */\n\t\telse\n\t\t\t*dest++ = ascii[*x - range];\n\t}\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"utils/ascii.h\"",
      "#include \"mb/pg_wchar.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define RANGE_160\t160",
      "#define RANGE_128\t128"
    ],
    "globals_used": [
      "static void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);",
      "static text *encode_to_ascii(text *data, int enc);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"encoding conversion from %s to ASCII not supported\",\n\t\t\t\t\t\tpg_encoding_to_char(enc)))"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"encoding conversion from %s to ASCII not supported\"",
            "pg_encoding_to_char(enc)"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_encoding_to_char",
          "args": [
            "enc"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "pg_encoding_to_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/encnames.c",
          "lines": "606-617",
          "snippet": "const char *\npg_encoding_to_char(int encoding)\n{\n\tif (PG_VALID_ENCODING(encoding))\n\t{\n\t\tconst pg_enc2name *p = &pg_enc2name_tbl[encoding];\n\n\t\tAssert(encoding == p->encoding);\n\t\treturn p->name;\n\t}\n\treturn \"\";\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include <unistd.h>",
            "#include <ctype.h>",
            "#include \"utils/builtins.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_enc2name pg_enc2name_tbl[] =\n{\n\tDEF_ENC2NAME(SQL_ASCII, 0),\n\tDEF_ENC2NAME(EUC_JP, 20932),\n\tDEF_ENC2NAME(EUC_CN, 20936),\n\tDEF_ENC2NAME(EUC_KR, 51949),\n\tDEF_ENC2NAME(EUC_TW, 0),\n\tDEF_ENC2NAME(EUC_JIS_2004, 20932),\n\tDEF_ENC2NAME(UTF8, 65001),\n\tDEF_ENC2NAME(MULE_INTERNAL, 0),\n\tDEF_ENC2NAME(LATIN1, 28591),\n\tDEF_ENC2NAME(LATIN2, 28592),\n\tDEF_ENC2NAME(LATIN3, 28593),\n\tDEF_ENC2NAME(LATIN4, 28594),\n\tDEF_ENC2NAME(LATIN5, 28599),\n\tDEF_ENC2NAME(LATIN6, 0),\n\tDEF_ENC2NAME(LATIN7, 0),\n\tDEF_ENC2NAME(LATIN8, 0),\n\tDEF_ENC2NAME(LATIN9, 28605),\n\tDEF_ENC2NAME(LATIN10, 0),\n\tDEF_ENC2NAME(WIN1256, 1256),\n\tDEF_ENC2NAME(WIN1258, 1258),\n\tDEF_ENC2NAME(WIN866, 866),\n\tDEF_ENC2NAME(WIN874, 874),\n\tDEF_ENC2NAME(KOI8R, 20866),\n\tDEF_ENC2NAME(WIN1251, 1251),\n\tDEF_ENC2NAME(WIN1252, 1252),\n\tDEF_ENC2NAME(ISO_8859_5, 28595),\n\tDEF_ENC2NAME(ISO_8859_6, 28596),\n\tDEF_ENC2NAME(ISO_8859_7, 28597),\n\tDEF_ENC2NAME(ISO_8859_8, 28598),\n\tDEF_ENC2NAME(WIN1250, 1250),\n\tDEF_ENC2NAME(WIN1253, 1253),\n\tDEF_ENC2NAME(WIN1254, 1254),\n\tDEF_ENC2NAME(WIN1255, 1255),\n\tDEF_ENC2NAME(WIN1257, 1257),\n\tDEF_ENC2NAME(KOI8U, 21866),\n\tDEF_ENC2NAME(SJIS, 932),\n\tDEF_ENC2NAME(BIG5, 950),\n\tDEF_ENC2NAME(GBK, 936),\n\tDEF_ENC2NAME(UHC, 949),\n\tDEF_ENC2NAME(GB18030, 54936),\n\tDEF_ENC2NAME(JOHAB, 0),\n\tDEF_ENC2NAME(SHIFT_JIS_2004, 932)\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include <unistd.h>\n#include <ctype.h>\n#include \"utils/builtins.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_enc2name pg_enc2name_tbl[] =\n{\n\tDEF_ENC2NAME(SQL_ASCII, 0),\n\tDEF_ENC2NAME(EUC_JP, 20932),\n\tDEF_ENC2NAME(EUC_CN, 20936),\n\tDEF_ENC2NAME(EUC_KR, 51949),\n\tDEF_ENC2NAME(EUC_TW, 0),\n\tDEF_ENC2NAME(EUC_JIS_2004, 20932),\n\tDEF_ENC2NAME(UTF8, 65001),\n\tDEF_ENC2NAME(MULE_INTERNAL, 0),\n\tDEF_ENC2NAME(LATIN1, 28591),\n\tDEF_ENC2NAME(LATIN2, 28592),\n\tDEF_ENC2NAME(LATIN3, 28593),\n\tDEF_ENC2NAME(LATIN4, 28594),\n\tDEF_ENC2NAME(LATIN5, 28599),\n\tDEF_ENC2NAME(LATIN6, 0),\n\tDEF_ENC2NAME(LATIN7, 0),\n\tDEF_ENC2NAME(LATIN8, 0),\n\tDEF_ENC2NAME(LATIN9, 28605),\n\tDEF_ENC2NAME(LATIN10, 0),\n\tDEF_ENC2NAME(WIN1256, 1256),\n\tDEF_ENC2NAME(WIN1258, 1258),\n\tDEF_ENC2NAME(WIN866, 866),\n\tDEF_ENC2NAME(WIN874, 874),\n\tDEF_ENC2NAME(KOI8R, 20866),\n\tDEF_ENC2NAME(WIN1251, 1251),\n\tDEF_ENC2NAME(WIN1252, 1252),\n\tDEF_ENC2NAME(ISO_8859_5, 28595),\n\tDEF_ENC2NAME(ISO_8859_6, 28596),\n\tDEF_ENC2NAME(ISO_8859_7, 28597),\n\tDEF_ENC2NAME(ISO_8859_8, 28598),\n\tDEF_ENC2NAME(WIN1250, 1250),\n\tDEF_ENC2NAME(WIN1253, 1253),\n\tDEF_ENC2NAME(WIN1254, 1254),\n\tDEF_ENC2NAME(WIN1255, 1255),\n\tDEF_ENC2NAME(WIN1257, 1257),\n\tDEF_ENC2NAME(KOI8U, 21866),\n\tDEF_ENC2NAME(SJIS, 932),\n\tDEF_ENC2NAME(BIG5, 950),\n\tDEF_ENC2NAME(GBK, 936),\n\tDEF_ENC2NAME(UHC, 949),\n\tDEF_ENC2NAME(GB18030, 54936),\n\tDEF_ENC2NAME(JOHAB, 0),\n\tDEF_ENC2NAME(SHIFT_JIS_2004, 932)\n};\n\nconst char *\npg_encoding_to_char(int encoding)\n{\n\tif (PG_VALID_ENCODING(encoding))\n\t{\n\t\tconst pg_enc2name *p = &pg_enc2name_tbl[encoding];\n\n\t\tAssert(encoding == p->encoding);\n\t\treturn p->name;\n\t}\n\treturn \"\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_FEATURE_NOT_SUPPORTED"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"utils/ascii.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\n#define RANGE_160\t160\n#define RANGE_128\t128\n\nstatic void pg_to_ascii(unsigned char *src, unsigned char *src_end,\n\t\t\tunsigned char *dest, int enc);\nstatic text *encode_to_ascii(text *data, int enc);\n\nstatic void\npg_to_ascii(unsigned char *src, unsigned char *src_end, unsigned char *dest, int enc)\n{\n\tunsigned char *x;\n\tconst unsigned char *ascii;\n\tint\t\t\trange;\n\n\t/*\n\t * relevant start for an encoding\n\t */\n#define RANGE_128\t128\n#define RANGE_160\t160\n\n\tif (enc == PG_LATIN1)\n\t{\n\t\t/*\n\t\t * ISO-8859-1 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  cL Y  \\\"Ca  -R     'u .,      ?AAAAAAACEEEEIIII NOOOOOxOUUUUYTBaaaaaaaceeeeiiii nooooo/ouuuuyty\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_LATIN2)\n\t{\n\t\t/*\n\t\t * ISO-8859-2 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \" A L LS \\\"SSTZ-ZZ a,l'ls ,sstz\\\"zzRAAAALCCCEEEEIIDDNNOOOOxRUUUUYTBraaaalccceeeeiiddnnoooo/ruuuuyt.\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_LATIN9)\n\t{\n\t\t/*\n\t\t * ISO-8859-15 <range: 160 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  cL YS sCa  -R     Zu .z   EeY?AAAAAAACEEEEIIII NOOOOOxOUUUUYTBaaaaaaaceeeeiiii nooooo/ouuuuyty\";\n\t\trange = RANGE_160;\n\t}\n\telse if (enc == PG_WIN1250)\n\t{\n\t\t/*\n\t\t * Window CP1250 <range: 128 -- 255>\n\t\t */\n\t\tascii = (const unsigned char *) \"  ' \\\"    %S<STZZ `'\\\"\\\".--  s>stzz   L A  \\\"CS  -RZ  ,l'u .,as L\\\"lzRAAAALCCCEEEEIIDDNNOOOOxRUUUUYTBraaaalccceeeeiiddnnoooo/ruuuuyt \";\n\t\trange = RANGE_128;\n\t}\n\telse\n\t{\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"encoding conversion from %s to ASCII not supported\",\n\t\t\t\t\t\tpg_encoding_to_char(enc))));\n\t\treturn;\t\t\t\t\t/* keep compiler quiet */\n\t}\n\n\t/*\n\t * Encode\n\t */\n\tfor (x = src; x < src_end; x++)\n\t{\n\t\tif (*x < 128)\n\t\t\t*dest++ = *x;\n\t\telse if (*x < range)\n\t\t\t*dest++ = ' ';\t\t/* bogus 128 to 'range' */\n\t\telse\n\t\t\t*dest++ = ascii[*x - range];\n\t}\n}"
  }
]