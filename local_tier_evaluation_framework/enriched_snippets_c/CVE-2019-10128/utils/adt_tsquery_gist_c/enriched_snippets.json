[
  {
    "function_name": "gtsquery_consistent_oldsig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
    "lines": "273-277",
    "snippet": "Datum\ngtsquery_consistent_oldsig(PG_FUNCTION_ARGS)\n{\n\treturn gtsquery_consistent(fcinfo);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/gist.h\"",
      "#include \"access/stratnum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gtsquery_consistent",
          "args": [
            "fcinfo"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "gtsquery_consistent_oldsig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
          "lines": "273-277",
          "snippet": "Datum\ngtsquery_consistent_oldsig(PG_FUNCTION_ARGS)\n{\n\treturn gtsquery_consistent(fcinfo);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nDatum\ngtsquery_consistent_oldsig(PG_FUNCTION_ARGS)\n{\n\treturn gtsquery_consistent(fcinfo);\n}"
  },
  {
    "function_name": "gtsquery_picksplit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
    "lines": "167-264",
    "snippet": "Datum\ngtsquery_picksplit(PG_FUNCTION_ARGS)\n{\n\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);\n\tGIST_SPLITVEC *v = (GIST_SPLITVEC *) PG_GETARG_POINTER(1);\n\tOffsetNumber maxoff = entryvec->n - 2;\n\tOffsetNumber k,\n\t\t\t\tj;\n\tTSQuerySign datum_l,\n\t\t\t\tdatum_r;\n\tint32\t\tsize_alpha,\n\t\t\t\tsize_beta;\n\tint32\t\tsize_waste,\n\t\t\t\twaste = -1;\n\tint32\t\tnbytes;\n\tOffsetNumber seed_1 = 0,\n\t\t\t\tseed_2 = 0;\n\tOffsetNumber *left,\n\t\t\t   *right;\n\n\tSPLITCOST  *costvector;\n\n\tnbytes = (maxoff + 2) * sizeof(OffsetNumber);\n\tleft = v->spl_left = (OffsetNumber *) palloc(nbytes);\n\tright = v->spl_right = (OffsetNumber *) palloc(nbytes);\n\tv->spl_nleft = v->spl_nright = 0;\n\n\tfor (k = FirstOffsetNumber; k < maxoff; k = OffsetNumberNext(k))\n\t\tfor (j = OffsetNumberNext(k); j <= maxoff; j = OffsetNumberNext(j))\n\t\t{\n\t\t\tsize_waste = hemdist(GETENTRY(entryvec, j), GETENTRY(entryvec, k));\n\t\t\tif (size_waste > waste)\n\t\t\t{\n\t\t\t\twaste = size_waste;\n\t\t\t\tseed_1 = k;\n\t\t\t\tseed_2 = j;\n\t\t\t}\n\t\t}\n\n\n\tif (seed_1 == 0 || seed_2 == 0)\n\t{\n\t\tseed_1 = 1;\n\t\tseed_2 = 2;\n\t}\n\n\tdatum_l = GETENTRY(entryvec, seed_1);\n\tdatum_r = GETENTRY(entryvec, seed_2);\n\n\tmaxoff = OffsetNumberNext(maxoff);\n\tcostvector = (SPLITCOST *) palloc(sizeof(SPLITCOST) * maxoff);\n\tfor (j = FirstOffsetNumber; j <= maxoff; j = OffsetNumberNext(j))\n\t{\n\t\tcostvector[j - 1].pos = j;\n\t\tsize_alpha = hemdist(GETENTRY(entryvec, seed_1), GETENTRY(entryvec, j));\n\t\tsize_beta = hemdist(GETENTRY(entryvec, seed_2), GETENTRY(entryvec, j));\n\t\tcostvector[j - 1].cost = abs(size_alpha - size_beta);\n\t}\n\tqsort((void *) costvector, maxoff, sizeof(SPLITCOST), comparecost);\n\n\tfor (k = 0; k < maxoff; k++)\n\t{\n\t\tj = costvector[k].pos;\n\t\tif (j == seed_1)\n\t\t{\n\t\t\t*left++ = j;\n\t\t\tv->spl_nleft++;\n\t\t\tcontinue;\n\t\t}\n\t\telse if (j == seed_2)\n\t\t{\n\t\t\t*right++ = j;\n\t\t\tv->spl_nright++;\n\t\t\tcontinue;\n\t\t}\n\t\tsize_alpha = hemdist(datum_l, GETENTRY(entryvec, j));\n\t\tsize_beta = hemdist(datum_r, GETENTRY(entryvec, j));\n\n\t\tif (size_alpha < size_beta + WISH_F(v->spl_nleft, v->spl_nright, 0.05))\n\t\t{\n\t\t\tdatum_l |= GETENTRY(entryvec, j);\n\t\t\t*left++ = j;\n\t\t\tv->spl_nleft++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdatum_r |= GETENTRY(entryvec, j);\n\t\t\t*right++ = j;\n\t\t\tv->spl_nright++;\n\t\t}\n\t}\n\n\t*right = *left = FirstOffsetNumber;\n\tv->spl_ldatum = TSQuerySignGetDatum(datum_l);\n\tv->spl_rdatum = TSQuerySignGetDatum(datum_r);\n\n\tPG_RETURN_POINTER(v);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/gist.h\"",
      "#include \"access/stratnum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "v"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSQuerySignGetDatum",
          "args": [
            "datum_r"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSQuerySignGetDatum",
          "args": [
            "datum_l"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "j"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "j"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WISH_F",
          "args": [
            "v->spl_nleft",
            "v->spl_nright",
            "0.05"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hemdist",
          "args": [
            "datum_r",
            "GETENTRY(entryvec, j)"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "hemdist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
          "lines": "129-135",
          "snippet": "static int\nhemdist(TSQuerySign a, TSQuerySign b)\n{\n\tTSQuerySign res = a ^ b;\n\n\treturn sizebitvec(res);\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/gist.h\"",
            "#include \"access/stratnum.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nstatic int\nhemdist(TSQuerySign a, TSQuerySign b)\n{\n\tTSQuerySign res = a ^ b;\n\n\treturn sizebitvec(res);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "j"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "j"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qsort",
          "args": [
            "(void *) costvector",
            "maxoff",
            "sizeof(SPLITCOST)",
            "comparecost"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abs",
          "args": [
            "size_alpha - size_beta"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "float8abs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/float.c",
          "lines": "726-732",
          "snippet": "Datum\nfloat8abs(PG_FUNCTION_ARGS)\n{\n\tfloat8\t\targ1 = PG_GETARG_FLOAT8(0);\n\n\tPG_RETURN_FLOAT8(fabs(arg1));\n}",
          "includes": [
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include <limits.h>",
            "#include <math.h>",
            "#include <float.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"libpq/pqformat.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include <limits.h>\n#include <math.h>\n#include <float.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nfloat8abs(PG_FUNCTION_ARGS)\n{\n\tfloat8\t\targ1 = PG_GETARG_FLOAT8(0);\n\n\tPG_RETURN_FLOAT8(fabs(arg1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "j"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "seed_2"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "j"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "seed_1"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OffsetNumberNext",
          "args": [
            "j"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(SPLITCOST) * maxoff"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "OffsetNumberNext",
          "args": [
            "maxoff"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "seed_2"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "seed_1"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "k"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "j"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OffsetNumberNext",
          "args": [
            "j"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OffsetNumberNext",
          "args": [
            "k"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OffsetNumberNext",
          "args": [
            "k"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "1"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nDatum\ngtsquery_picksplit(PG_FUNCTION_ARGS)\n{\n\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);\n\tGIST_SPLITVEC *v = (GIST_SPLITVEC *) PG_GETARG_POINTER(1);\n\tOffsetNumber maxoff = entryvec->n - 2;\n\tOffsetNumber k,\n\t\t\t\tj;\n\tTSQuerySign datum_l,\n\t\t\t\tdatum_r;\n\tint32\t\tsize_alpha,\n\t\t\t\tsize_beta;\n\tint32\t\tsize_waste,\n\t\t\t\twaste = -1;\n\tint32\t\tnbytes;\n\tOffsetNumber seed_1 = 0,\n\t\t\t\tseed_2 = 0;\n\tOffsetNumber *left,\n\t\t\t   *right;\n\n\tSPLITCOST  *costvector;\n\n\tnbytes = (maxoff + 2) * sizeof(OffsetNumber);\n\tleft = v->spl_left = (OffsetNumber *) palloc(nbytes);\n\tright = v->spl_right = (OffsetNumber *) palloc(nbytes);\n\tv->spl_nleft = v->spl_nright = 0;\n\n\tfor (k = FirstOffsetNumber; k < maxoff; k = OffsetNumberNext(k))\n\t\tfor (j = OffsetNumberNext(k); j <= maxoff; j = OffsetNumberNext(j))\n\t\t{\n\t\t\tsize_waste = hemdist(GETENTRY(entryvec, j), GETENTRY(entryvec, k));\n\t\t\tif (size_waste > waste)\n\t\t\t{\n\t\t\t\twaste = size_waste;\n\t\t\t\tseed_1 = k;\n\t\t\t\tseed_2 = j;\n\t\t\t}\n\t\t}\n\n\n\tif (seed_1 == 0 || seed_2 == 0)\n\t{\n\t\tseed_1 = 1;\n\t\tseed_2 = 2;\n\t}\n\n\tdatum_l = GETENTRY(entryvec, seed_1);\n\tdatum_r = GETENTRY(entryvec, seed_2);\n\n\tmaxoff = OffsetNumberNext(maxoff);\n\tcostvector = (SPLITCOST *) palloc(sizeof(SPLITCOST) * maxoff);\n\tfor (j = FirstOffsetNumber; j <= maxoff; j = OffsetNumberNext(j))\n\t{\n\t\tcostvector[j - 1].pos = j;\n\t\tsize_alpha = hemdist(GETENTRY(entryvec, seed_1), GETENTRY(entryvec, j));\n\t\tsize_beta = hemdist(GETENTRY(entryvec, seed_2), GETENTRY(entryvec, j));\n\t\tcostvector[j - 1].cost = abs(size_alpha - size_beta);\n\t}\n\tqsort((void *) costvector, maxoff, sizeof(SPLITCOST), comparecost);\n\n\tfor (k = 0; k < maxoff; k++)\n\t{\n\t\tj = costvector[k].pos;\n\t\tif (j == seed_1)\n\t\t{\n\t\t\t*left++ = j;\n\t\t\tv->spl_nleft++;\n\t\t\tcontinue;\n\t\t}\n\t\telse if (j == seed_2)\n\t\t{\n\t\t\t*right++ = j;\n\t\t\tv->spl_nright++;\n\t\t\tcontinue;\n\t\t}\n\t\tsize_alpha = hemdist(datum_l, GETENTRY(entryvec, j));\n\t\tsize_beta = hemdist(datum_r, GETENTRY(entryvec, j));\n\n\t\tif (size_alpha < size_beta + WISH_F(v->spl_nleft, v->spl_nright, 0.05))\n\t\t{\n\t\t\tdatum_l |= GETENTRY(entryvec, j);\n\t\t\t*left++ = j;\n\t\t\tv->spl_nleft++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdatum_r |= GETENTRY(entryvec, j);\n\t\t\t*right++ = j;\n\t\t\tv->spl_nright++;\n\t\t}\n\t}\n\n\t*right = *left = FirstOffsetNumber;\n\tv->spl_ldatum = TSQuerySignGetDatum(datum_l);\n\tv->spl_rdatum = TSQuerySignGetDatum(datum_r);\n\n\tPG_RETURN_POINTER(v);\n}"
  },
  {
    "function_name": "comparecost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
    "lines": "156-163",
    "snippet": "static int\ncomparecost(const void *a, const void *b)\n{\n\tif (((const SPLITCOST *) a)->cost == ((const SPLITCOST *) b)->cost)\n\t\treturn 0;\n\telse\n\t\treturn (((const SPLITCOST *) a)->cost > ((const SPLITCOST *) b)->cost) ? 1 : -1;\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/gist.h\"",
      "#include \"access/stratnum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nstatic int\ncomparecost(const void *a, const void *b)\n{\n\tif (((const SPLITCOST *) a)->cost == ((const SPLITCOST *) b)->cost)\n\t\treturn 0;\n\telse\n\t\treturn (((const SPLITCOST *) a)->cost > ((const SPLITCOST *) b)->cost) ? 1 : -1;\n}"
  },
  {
    "function_name": "gtsquery_penalty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
    "lines": "137-147",
    "snippet": "Datum\ngtsquery_penalty(PG_FUNCTION_ARGS)\n{\n\tTSQuerySign origval = DatumGetTSQuerySign(((GISTENTRY *) PG_GETARG_POINTER(0))->key);\n\tTSQuerySign newval = DatumGetTSQuerySign(((GISTENTRY *) PG_GETARG_POINTER(1))->key);\n\tfloat\t   *penalty = (float *) PG_GETARG_POINTER(2);\n\n\t*penalty = hemdist(origval, newval);\n\n\tPG_RETURN_POINTER(penalty);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/gist.h\"",
      "#include \"access/stratnum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "penalty"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hemdist",
          "args": [
            "origval",
            "newval"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "hemdist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
          "lines": "129-135",
          "snippet": "static int\nhemdist(TSQuerySign a, TSQuerySign b)\n{\n\tTSQuerySign res = a ^ b;\n\n\treturn sizebitvec(res);\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/gist.h\"",
            "#include \"access/stratnum.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nstatic int\nhemdist(TSQuerySign a, TSQuerySign b)\n{\n\tTSQuerySign res = a ^ b;\n\n\treturn sizebitvec(res);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "2"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetTSQuerySign",
          "args": [
            "((GISTENTRY *) PG_GETARG_POINTER(1))->key"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "1"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetTSQuerySign",
          "args": [
            "((GISTENTRY *) PG_GETARG_POINTER(0))->key"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nDatum\ngtsquery_penalty(PG_FUNCTION_ARGS)\n{\n\tTSQuerySign origval = DatumGetTSQuerySign(((GISTENTRY *) PG_GETARG_POINTER(0))->key);\n\tTSQuerySign newval = DatumGetTSQuerySign(((GISTENTRY *) PG_GETARG_POINTER(1))->key);\n\tfloat\t   *penalty = (float *) PG_GETARG_POINTER(2);\n\n\t*penalty = hemdist(origval, newval);\n\n\tPG_RETURN_POINTER(penalty);\n}"
  },
  {
    "function_name": "hemdist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
    "lines": "129-135",
    "snippet": "static int\nhemdist(TSQuerySign a, TSQuerySign b)\n{\n\tTSQuerySign res = a ^ b;\n\n\treturn sizebitvec(res);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/gist.h\"",
      "#include \"access/stratnum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sizebitvec",
          "args": [
            "res"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "sizebitvec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
          "lines": "117-127",
          "snippet": "static int\nsizebitvec(TSQuerySign sign)\n{\n\tint\t\t\tsize = 0,\n\t\t\t\ti;\n\n\tfor (i = 0; i < TSQS_SIGLEN; i++)\n\t\tsize += 0x01 & (sign >> i);\n\n\treturn size;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"access/gist.h\"",
            "#include \"access/stratnum.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nstatic int\nsizebitvec(TSQuerySign sign)\n{\n\tint\t\t\tsize = 0,\n\t\t\t\ti;\n\n\tfor (i = 0; i < TSQS_SIGLEN; i++)\n\t\tsize += 0x01 & (sign >> i);\n\n\treturn size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nstatic int\nhemdist(TSQuerySign a, TSQuerySign b)\n{\n\tTSQuerySign res = a ^ b;\n\n\treturn sizebitvec(res);\n}"
  },
  {
    "function_name": "sizebitvec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
    "lines": "117-127",
    "snippet": "static int\nsizebitvec(TSQuerySign sign)\n{\n\tint\t\t\tsize = 0,\n\t\t\t\ti;\n\n\tfor (i = 0; i < TSQS_SIGLEN; i++)\n\t\tsize += 0x01 & (sign >> i);\n\n\treturn size;\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/gist.h\"",
      "#include \"access/stratnum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nstatic int\nsizebitvec(TSQuerySign sign)\n{\n\tint\t\t\tsize = 0,\n\t\t\t\ti;\n\n\tfor (i = 0; i < TSQS_SIGLEN; i++)\n\t\tsize += 0x01 & (sign >> i);\n\n\treturn size;\n}"
  },
  {
    "function_name": "gtsquery_same",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
    "lines": "105-115",
    "snippet": "Datum\ngtsquery_same(PG_FUNCTION_ARGS)\n{\n\tTSQuerySign a = PG_GETARG_TSQUERYSIGN(0);\n\tTSQuerySign b = PG_GETARG_TSQUERYSIGN(1);\n\tbool\t   *result = (bool *) PG_GETARG_POINTER(2);\n\n\t*result = (a == b) ? true : false;\n\n\tPG_RETURN_POINTER(result);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/gist.h\"",
      "#include \"access/stratnum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "result"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "2"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TSQUERYSIGN",
          "args": [
            "1"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TSQUERYSIGN",
          "args": [
            "0"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nDatum\ngtsquery_same(PG_FUNCTION_ARGS)\n{\n\tTSQuerySign a = PG_GETARG_TSQUERYSIGN(0);\n\tTSQuerySign b = PG_GETARG_TSQUERYSIGN(1);\n\tbool\t   *result = (bool *) PG_GETARG_POINTER(2);\n\n\t*result = (a == b) ? true : false;\n\n\tPG_RETURN_POINTER(result);\n}"
  },
  {
    "function_name": "gtsquery_union",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
    "lines": "87-103",
    "snippet": "Datum\ngtsquery_union(PG_FUNCTION_ARGS)\n{\n\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);\n\tint\t\t   *size = (int *) PG_GETARG_POINTER(1);\n\tTSQuerySign sign;\n\tint\t\t\ti;\n\n\tsign = 0;\n\n\tfor (i = 0; i < entryvec->n; i++)\n\t\tsign |= GETENTRY(entryvec, i);\n\n\t*size = sizeof(TSQuerySign);\n\n\tPG_RETURN_TSQUERYSIGN(sign);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/gist.h\"",
      "#include \"access/stratnum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TSQUERYSIGN",
          "args": [
            "sign"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETENTRY",
          "args": [
            "entryvec",
            "i"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "1"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nDatum\ngtsquery_union(PG_FUNCTION_ARGS)\n{\n\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);\n\tint\t\t   *size = (int *) PG_GETARG_POINTER(1);\n\tTSQuerySign sign;\n\tint\t\t\ti;\n\n\tsign = 0;\n\n\tfor (i = 0; i < entryvec->n; i++)\n\t\tsign |= GETENTRY(entryvec, i);\n\n\t*size = sizeof(TSQuerySign);\n\n\tPG_RETURN_TSQUERYSIGN(sign);\n}"
  },
  {
    "function_name": "gtsquery_consistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
    "lines": "51-85",
    "snippet": "Datum\ngtsquery_consistent(PG_FUNCTION_ARGS)\n{\n\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);\n\tTSQuery\t\tquery = PG_GETARG_TSQUERY(1);\n\tStrategyNumber strategy = (StrategyNumber) PG_GETARG_UINT16(2);\n\n\t/* Oid\t\tsubtype = PG_GETARG_OID(3); */\n\tbool\t   *recheck = (bool *) PG_GETARG_POINTER(4);\n\tTSQuerySign key = DatumGetTSQuerySign(entry->key);\n\tTSQuerySign sq = makeTSQuerySign(query);\n\tbool\t\tretval;\n\n\t/* All cases served by this function are inexact */\n\t*recheck = true;\n\n\tswitch (strategy)\n\t{\n\t\tcase RTContainsStrategyNumber:\n\t\t\tif (GIST_LEAF(entry))\n\t\t\t\tretval = (key & sq) == sq;\n\t\t\telse\n\t\t\t\tretval = (key & sq) != 0;\n\t\t\tbreak;\n\t\tcase RTContainedByStrategyNumber:\n\t\t\tif (GIST_LEAF(entry))\n\t\t\t\tretval = (key & sq) == key;\n\t\t\telse\n\t\t\t\tretval = (key & sq) != 0;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tretval = false;\n\t}\n\tPG_RETURN_BOOL(retval);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/gist.h\"",
      "#include \"access/stratnum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "retval"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIST_LEAF",
          "args": [
            "entry"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GIST_LEAF",
          "args": [
            "entry"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeTSQuerySign",
          "args": [
            "query"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "makeTSQuerySign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_op.c",
          "lines": "248-263",
          "snippet": "TSQuerySign\nmakeTSQuerySign(TSQuery a)\n{\n\tint\t\t\ti;\n\tQueryItem  *ptr = GETQUERY(a);\n\tTSQuerySign sign = 0;\n\n\tfor (i = 0; i < a->size; i++)\n\t{\n\t\tif (ptr->type == QI_VAL)\n\t\t\tsign |= ((TSQuerySign) 1) << (((unsigned int) ptr->qoperand.valcrc) % TSQS_SIGLEN);\n\t\tptr++;\n\t}\n\n\treturn sign;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nTSQuerySign\nmakeTSQuerySign(TSQuery a)\n{\n\tint\t\t\ti;\n\tQueryItem  *ptr = GETQUERY(a);\n\tTSQuerySign sign = 0;\n\n\tfor (i = 0; i < a->size; i++)\n\t{\n\t\tif (ptr->type == QI_VAL)\n\t\t\tsign |= ((TSQuerySign) 1) << (((unsigned int) ptr->qoperand.valcrc) % TSQS_SIGLEN);\n\t\tptr++;\n\t}\n\n\treturn sign;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DatumGetTSQuerySign",
          "args": [
            "entry->key"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "4"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UINT16",
          "args": [
            "2"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TSQUERY",
          "args": [
            "1"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nDatum\ngtsquery_consistent(PG_FUNCTION_ARGS)\n{\n\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);\n\tTSQuery\t\tquery = PG_GETARG_TSQUERY(1);\n\tStrategyNumber strategy = (StrategyNumber) PG_GETARG_UINT16(2);\n\n\t/* Oid\t\tsubtype = PG_GETARG_OID(3); */\n\tbool\t   *recheck = (bool *) PG_GETARG_POINTER(4);\n\tTSQuerySign key = DatumGetTSQuerySign(entry->key);\n\tTSQuerySign sq = makeTSQuerySign(query);\n\tbool\t\tretval;\n\n\t/* All cases served by this function are inexact */\n\t*recheck = true;\n\n\tswitch (strategy)\n\t{\n\t\tcase RTContainsStrategyNumber:\n\t\t\tif (GIST_LEAF(entry))\n\t\t\t\tretval = (key & sq) == sq;\n\t\t\telse\n\t\t\t\tretval = (key & sq) != 0;\n\t\t\tbreak;\n\t\tcase RTContainedByStrategyNumber:\n\t\t\tif (GIST_LEAF(entry))\n\t\t\t\tretval = (key & sq) == key;\n\t\t\telse\n\t\t\t\tretval = (key & sq) != 0;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tretval = false;\n\t}\n\tPG_RETURN_BOOL(retval);\n}"
  },
  {
    "function_name": "gtsquery_compress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_gist.c",
    "lines": "25-44",
    "snippet": "Datum\ngtsquery_compress(PG_FUNCTION_ARGS)\n{\n\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);\n\tGISTENTRY  *retval = entry;\n\n\tif (entry->leafkey)\n\t{\n\t\tTSQuerySign sign;\n\n\t\tretval = (GISTENTRY *) palloc(sizeof(GISTENTRY));\n\t\tsign = makeTSQuerySign(DatumGetTSQuery(entry->key));\n\n\t\tgistentryinit(*retval, TSQuerySignGetDatum(sign),\n\t\t\t\t\t  entry->rel, entry->page,\n\t\t\t\t\t  entry->offset, false);\n\t}\n\n\tPG_RETURN_POINTER(retval);\n}",
    "includes": [
      "#include \"utils/builtins.h\"",
      "#include \"tsearch/ts_utils.h\"",
      "#include \"access/gist.h\"",
      "#include \"access/stratnum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "retval"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gistentryinit",
          "args": [
            "*retval",
            "TSQuerySignGetDatum(sign)",
            "entry->rel",
            "entry->page",
            "entry->offset",
            "false"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSQuerySignGetDatum",
          "args": [
            "sign"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeTSQuerySign",
          "args": [
            "DatumGetTSQuery(entry->key)"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "makeTSQuerySign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_op.c",
          "lines": "248-263",
          "snippet": "TSQuerySign\nmakeTSQuerySign(TSQuery a)\n{\n\tint\t\t\ti;\n\tQueryItem  *ptr = GETQUERY(a);\n\tTSQuerySign sign = 0;\n\n\tfor (i = 0; i < a->size; i++)\n\t{\n\t\tif (ptr->type == QI_VAL)\n\t\t\tsign |= ((TSQuerySign) 1) << (((unsigned int) ptr->qoperand.valcrc) % TSQS_SIGLEN);\n\t\tptr++;\n\t}\n\n\treturn sign;\n}",
          "includes": [
            "#include \"utils/builtins.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nTSQuerySign\nmakeTSQuerySign(TSQuery a)\n{\n\tint\t\t\ti;\n\tQueryItem  *ptr = GETQUERY(a);\n\tTSQuerySign sign = 0;\n\n\tfor (i = 0; i < a->size; i++)\n\t{\n\t\tif (ptr->type == QI_VAL)\n\t\t\tsign |= ((TSQuerySign) 1) << (((unsigned int) ptr->qoperand.valcrc) % TSQS_SIGLEN);\n\t\tptr++;\n\t}\n\n\treturn sign;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DatumGetTSQuery",
          "args": [
            "entry->key"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(GISTENTRY)"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/builtins.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"access/gist.h\"\n#include \"access/stratnum.h\"\n#include \"postgres.h\"\n\nDatum\ngtsquery_compress(PG_FUNCTION_ARGS)\n{\n\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);\n\tGISTENTRY  *retval = entry;\n\n\tif (entry->leafkey)\n\t{\n\t\tTSQuerySign sign;\n\n\t\tretval = (GISTENTRY *) palloc(sizeof(GISTENTRY));\n\t\tsign = makeTSQuerySign(DatumGetTSQuery(entry->key));\n\n\t\tgistentryinit(*retval, TSQuerySignGetDatum(sign),\n\t\t\t\t\t  entry->rel, entry->page,\n\t\t\t\t\t  entry->offset, false);\n\t}\n\n\tPG_RETURN_POINTER(retval);\n}"
  }
]