[
  {
    "function_name": "macaddr_abbrev_convert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "498-548",
    "snippet": "static Datum\nmacaddr_abbrev_convert(Datum original, SortSupport ssup)\n{\n\tmacaddr_sortsupport_state *uss = ssup->ssup_extra;\n\tmacaddr    *authoritative = DatumGetMacaddrP(original);\n\tDatum\t\tres;\n\n\t/*\n\t * On a 64-bit machine, zero out the 8-byte datum and copy the 6 bytes of\n\t * the MAC address in. There will be two bytes of zero padding on the end\n\t * of the least significant bits.\n\t */\n#if SIZEOF_DATUM == 8\n\tmemset(&res, 0, SIZEOF_DATUM);\n\tmemcpy(&res, authoritative, sizeof(macaddr));\n#else\t\t\t\t\t\t\t/* SIZEOF_DATUM != 8 */\n\tmemcpy(&res, authoritative, SIZEOF_DATUM);\n#endif\n\tuss->input_count += 1;\n\n\t/*\n\t * Cardinality estimation. The estimate uses uint32, so on a 64-bit\n\t * architecture, XOR the two 32-bit halves together to produce slightly\n\t * more entropy. The two zeroed bytes won't have any practical impact on\n\t * this operation.\n\t */\n\tif (uss->estimating)\n\t{\n\t\tuint32\t\ttmp;\n\n#if SIZEOF_DATUM == 8\n\t\ttmp = (uint32) res ^ (uint32) ((uint64) res >> 32);\n#else\t\t\t\t\t\t\t/* SIZEOF_DATUM != 8 */\n\t\ttmp = (uint32) res;\n#endif\n\n\t\taddHyperLogLog(&uss->abbr_card, DatumGetUInt32(hash_uint32(tmp)));\n\t}\n\n\t/*\n\t * Byteswap on little-endian machines.\n\t *\n\t * This is needed so that macaddr_cmp_abbrev() (an unsigned integer 3-way\n\t * comparator) works correctly on all platforms. Without this, the\n\t * comparator would have to call memcmp() with a pair of pointers to the\n\t * first byte of each abbreviated key, which is slower.\n\t */\n\tres = DatumBigEndianToNative(res);\n\n\treturn res;\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup);",
      "static int\tmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup);",
      "static bool macaddr_abbrev_abort(int memtupcount, SortSupport ssup);",
      "static Datum macaddr_abbrev_convert(Datum original, SortSupport ssup);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DatumBigEndianToNative",
          "args": [
            "res"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addHyperLogLog",
          "args": [
            "&uss->abbr_card",
            "DatumGetUInt32(hash_uint32(tmp))"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetUInt32",
          "args": [
            "hash_uint32(tmp)"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_uint32",
          "args": [
            "tmp"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "(uint64) res >> 32"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&res",
            "authoritative",
            "SIZEOF_DATUM"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&res",
            "authoritative",
            "sizeof(macaddr)"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&res",
            "0",
            "SIZEOF_DATUM"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetMacaddrP",
          "args": [
            "original"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup);\nstatic int\tmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup);\nstatic bool macaddr_abbrev_abort(int memtupcount, SortSupport ssup);\nstatic Datum macaddr_abbrev_convert(Datum original, SortSupport ssup);\n\nstatic Datum\nmacaddr_abbrev_convert(Datum original, SortSupport ssup)\n{\n\tmacaddr_sortsupport_state *uss = ssup->ssup_extra;\n\tmacaddr    *authoritative = DatumGetMacaddrP(original);\n\tDatum\t\tres;\n\n\t/*\n\t * On a 64-bit machine, zero out the 8-byte datum and copy the 6 bytes of\n\t * the MAC address in. There will be two bytes of zero padding on the end\n\t * of the least significant bits.\n\t */\n#if SIZEOF_DATUM == 8\n\tmemset(&res, 0, SIZEOF_DATUM);\n\tmemcpy(&res, authoritative, sizeof(macaddr));\n#else\t\t\t\t\t\t\t/* SIZEOF_DATUM != 8 */\n\tmemcpy(&res, authoritative, SIZEOF_DATUM);\n#endif\n\tuss->input_count += 1;\n\n\t/*\n\t * Cardinality estimation. The estimate uses uint32, so on a 64-bit\n\t * architecture, XOR the two 32-bit halves together to produce slightly\n\t * more entropy. The two zeroed bytes won't have any practical impact on\n\t * this operation.\n\t */\n\tif (uss->estimating)\n\t{\n\t\tuint32\t\ttmp;\n\n#if SIZEOF_DATUM == 8\n\t\ttmp = (uint32) res ^ (uint32) ((uint64) res >> 32);\n#else\t\t\t\t\t\t\t/* SIZEOF_DATUM != 8 */\n\t\ttmp = (uint32) res;\n#endif\n\n\t\taddHyperLogLog(&uss->abbr_card, DatumGetUInt32(hash_uint32(tmp)));\n\t}\n\n\t/*\n\t * Byteswap on little-endian machines.\n\t *\n\t * This is needed so that macaddr_cmp_abbrev() (an unsigned integer 3-way\n\t * comparator) works correctly on all platforms. Without this, the\n\t * comparator would have to call memcmp() with a pair of pointers to the\n\t * first byte of each abbreviated key, which is slower.\n\t */\n\tres = DatumBigEndianToNative(res);\n\n\treturn res;\n}"
  },
  {
    "function_name": "macaddr_abbrev_abort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "430-487",
    "snippet": "static bool\nmacaddr_abbrev_abort(int memtupcount, SortSupport ssup)\n{\n\tmacaddr_sortsupport_state *uss = ssup->ssup_extra;\n\tdouble\t\tabbr_card;\n\n\tif (memtupcount < 10000 || uss->input_count < 10000 || !uss->estimating)\n\t\treturn false;\n\n\tabbr_card = estimateHyperLogLog(&uss->abbr_card);\n\n\t/*\n\t * If we have >100k distinct values, then even if we were sorting many\n\t * billion rows we'd likely still break even, and the penalty of undoing\n\t * that many rows of abbrevs would probably not be worth it. At this point\n\t * we stop counting because we know that we're now fully committed.\n\t */\n\tif (abbr_card > 100000.0)\n\t{\n#ifdef TRACE_SORT\n\t\tif (trace_sort)\n\t\t\telog(LOG,\n\t\t\t\t \"macaddr_abbrev: estimation ends at cardinality %f\"\n\t\t\t\t \" after \" INT64_FORMAT \" values (%d rows)\",\n\t\t\t\t abbr_card, uss->input_count, memtupcount);\n#endif\n\t\tuss->estimating = false;\n\t\treturn false;\n\t}\n\n\t/*\n\t * Target minimum cardinality is 1 per ~2k of non-null inputs. 0.5 row\n\t * fudge factor allows us to abort earlier on genuinely pathological data\n\t * where we've had exactly one abbreviated value in the first 2k\n\t * (non-null) rows.\n\t */\n\tif (abbr_card < uss->input_count / 2000.0 + 0.5)\n\t{\n#ifdef TRACE_SORT\n\t\tif (trace_sort)\n\t\t\telog(LOG,\n\t\t\t\t \"macaddr_abbrev: aborting abbreviation at cardinality %f\"\n\t\t\t\t \" below threshold %f after \" INT64_FORMAT \" values (%d rows)\",\n\t\t\t\t abbr_card, uss->input_count / 2000.0 + 0.5, uss->input_count,\n\t\t\t\t memtupcount);\n#endif\n\t\treturn true;\n\t}\n\n#ifdef TRACE_SORT\n\tif (trace_sort)\n\t\telog(LOG,\n\t\t\t \"macaddr_abbrev: cardinality %f after \" INT64_FORMAT\n\t\t\t \" values (%d rows)\", abbr_card, uss->input_count, memtupcount);\n#endif\n\n\treturn false;\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup);",
      "static int\tmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup);",
      "static bool macaddr_abbrev_abort(int memtupcount, SortSupport ssup);",
      "static Datum macaddr_abbrev_convert(Datum original, SortSupport ssup);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "LOG",
            "\"macaddr_abbrev: cardinality %f after \" INT64_FORMAT\n\t\t\t \" values (%d rows)\"",
            "abbr_card",
            "uss->input_count",
            "memtupcount"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "estimateHyperLogLog",
          "args": [
            "&uss->abbr_card"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup);\nstatic int\tmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup);\nstatic bool macaddr_abbrev_abort(int memtupcount, SortSupport ssup);\nstatic Datum macaddr_abbrev_convert(Datum original, SortSupport ssup);\n\nstatic bool\nmacaddr_abbrev_abort(int memtupcount, SortSupport ssup)\n{\n\tmacaddr_sortsupport_state *uss = ssup->ssup_extra;\n\tdouble\t\tabbr_card;\n\n\tif (memtupcount < 10000 || uss->input_count < 10000 || !uss->estimating)\n\t\treturn false;\n\n\tabbr_card = estimateHyperLogLog(&uss->abbr_card);\n\n\t/*\n\t * If we have >100k distinct values, then even if we were sorting many\n\t * billion rows we'd likely still break even, and the penalty of undoing\n\t * that many rows of abbrevs would probably not be worth it. At this point\n\t * we stop counting because we know that we're now fully committed.\n\t */\n\tif (abbr_card > 100000.0)\n\t{\n#ifdef TRACE_SORT\n\t\tif (trace_sort)\n\t\t\telog(LOG,\n\t\t\t\t \"macaddr_abbrev: estimation ends at cardinality %f\"\n\t\t\t\t \" after \" INT64_FORMAT \" values (%d rows)\",\n\t\t\t\t abbr_card, uss->input_count, memtupcount);\n#endif\n\t\tuss->estimating = false;\n\t\treturn false;\n\t}\n\n\t/*\n\t * Target minimum cardinality is 1 per ~2k of non-null inputs. 0.5 row\n\t * fudge factor allows us to abort earlier on genuinely pathological data\n\t * where we've had exactly one abbreviated value in the first 2k\n\t * (non-null) rows.\n\t */\n\tif (abbr_card < uss->input_count / 2000.0 + 0.5)\n\t{\n#ifdef TRACE_SORT\n\t\tif (trace_sort)\n\t\t\telog(LOG,\n\t\t\t\t \"macaddr_abbrev: aborting abbreviation at cardinality %f\"\n\t\t\t\t \" below threshold %f after \" INT64_FORMAT \" values (%d rows)\",\n\t\t\t\t abbr_card, uss->input_count / 2000.0 + 0.5, uss->input_count,\n\t\t\t\t memtupcount);\n#endif\n\t\treturn true;\n\t}\n\n#ifdef TRACE_SORT\n\tif (trace_sort)\n\t\telog(LOG,\n\t\t\t \"macaddr_abbrev: cardinality %f after \" INT64_FORMAT\n\t\t\t \" values (%d rows)\", abbr_card, uss->input_count, memtupcount);\n#endif\n\n\treturn false;\n}"
  },
  {
    "function_name": "macaddr_cmp_abbrev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "413-422",
    "snippet": "static int\nmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup)\n{\n\tif (x > y)\n\t\treturn 1;\n\telse if (x == y)\n\t\treturn 0;\n\telse\n\t\treturn -1;\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup);",
      "static int\tmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup);",
      "static bool macaddr_abbrev_abort(int memtupcount, SortSupport ssup);",
      "static Datum macaddr_abbrev_convert(Datum original, SortSupport ssup);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup);\nstatic int\tmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup);\nstatic bool macaddr_abbrev_abort(int memtupcount, SortSupport ssup);\nstatic Datum macaddr_abbrev_convert(Datum original, SortSupport ssup);\n\nstatic int\nmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup)\n{\n\tif (x > y)\n\t\treturn 1;\n\telse if (x == y)\n\t\treturn 0;\n\telse\n\t\treturn -1;\n}"
  },
  {
    "function_name": "macaddr_fast_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "399-406",
    "snippet": "static int\nmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup)\n{\n\tmacaddr    *arg1 = DatumGetMacaddrP(x);\n\tmacaddr    *arg2 = DatumGetMacaddrP(y);\n\n\treturn macaddr_cmp_internal(arg1, arg2);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup);",
      "static int\tmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup);",
      "static bool macaddr_abbrev_abort(int memtupcount, SortSupport ssup);",
      "static Datum macaddr_abbrev_convert(Datum original, SortSupport ssup);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "macaddr_cmp_internal",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "macaddr_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
          "lines": "181-194",
          "snippet": "static int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/inet.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nstatic int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DatumGetMacaddrP",
          "args": [
            "y"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetMacaddrP",
          "args": [
            "x"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup);\nstatic int\tmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup);\nstatic bool macaddr_abbrev_abort(int memtupcount, SortSupport ssup);\nstatic Datum macaddr_abbrev_convert(Datum original, SortSupport ssup);\n\nstatic int\nmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup)\n{\n\tmacaddr    *arg1 = DatumGetMacaddrP(x);\n\tmacaddr    *arg2 = DatumGetMacaddrP(y);\n\n\treturn macaddr_cmp_internal(arg1, arg2);\n}"
  },
  {
    "function_name": "macaddr_sortsupport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "362-393",
    "snippet": "Datum\nmacaddr_sortsupport(PG_FUNCTION_ARGS)\n{\n\tSortSupport ssup = (SortSupport) PG_GETARG_POINTER(0);\n\n\tssup->comparator = macaddr_fast_cmp;\n\tssup->ssup_extra = NULL;\n\n\tif (ssup->abbreviate)\n\t{\n\t\tmacaddr_sortsupport_state *uss;\n\t\tMemoryContext oldcontext;\n\n\t\toldcontext = MemoryContextSwitchTo(ssup->ssup_cxt);\n\n\t\tuss = palloc(sizeof(macaddr_sortsupport_state));\n\t\tuss->input_count = 0;\n\t\tuss->estimating = true;\n\t\tinitHyperLogLog(&uss->abbr_card, 10);\n\n\t\tssup->ssup_extra = uss;\n\n\t\tssup->comparator = macaddr_cmp_abbrev;\n\t\tssup->abbrev_converter = macaddr_abbrev_convert;\n\t\tssup->abbrev_abort = macaddr_abbrev_abort;\n\t\tssup->abbrev_full_comparator = macaddr_fast_cmp;\n\n\t\tMemoryContextSwitchTo(oldcontext);\n\t}\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup);",
      "static int\tmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup);",
      "static bool macaddr_abbrev_abort(int memtupcount, SortSupport ssup);",
      "static Datum macaddr_abbrev_convert(Datum original, SortSupport ssup);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "oldcontext"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initHyperLogLog",
          "args": [
            "&uss->abbr_card",
            "10"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(macaddr_sortsupport_state)"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "ssup->ssup_cxt"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_fast_cmp(Datum x, Datum y, SortSupport ssup);\nstatic int\tmacaddr_cmp_abbrev(Datum x, Datum y, SortSupport ssup);\nstatic bool macaddr_abbrev_abort(int memtupcount, SortSupport ssup);\nstatic Datum macaddr_abbrev_convert(Datum original, SortSupport ssup);\n\nDatum\nmacaddr_sortsupport(PG_FUNCTION_ARGS)\n{\n\tSortSupport ssup = (SortSupport) PG_GETARG_POINTER(0);\n\n\tssup->comparator = macaddr_fast_cmp;\n\tssup->ssup_extra = NULL;\n\n\tif (ssup->abbreviate)\n\t{\n\t\tmacaddr_sortsupport_state *uss;\n\t\tMemoryContext oldcontext;\n\n\t\toldcontext = MemoryContextSwitchTo(ssup->ssup_cxt);\n\n\t\tuss = palloc(sizeof(macaddr_sortsupport_state));\n\t\tuss->input_count = 0;\n\t\tuss->estimating = true;\n\t\tinitHyperLogLog(&uss->abbr_card, 10);\n\n\t\tssup->ssup_extra = uss;\n\n\t\tssup->comparator = macaddr_cmp_abbrev;\n\t\tssup->abbrev_converter = macaddr_abbrev_convert;\n\t\tssup->abbrev_abort = macaddr_abbrev_abort;\n\t\tssup->abbrev_full_comparator = macaddr_fast_cmp;\n\n\t\tMemoryContextSwitchTo(oldcontext);\n\t}\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "macaddr_trunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "340-356",
    "snippet": "Datum\nmacaddr_trunc(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *result;\n\n\tresult = (macaddr *) palloc(sizeof(macaddr));\n\n\tresult->a = addr->a;\n\tresult->b = addr->b;\n\tresult->c = addr->c;\n\tresult->d = 0;\n\tresult->e = 0;\n\tresult->f = 0;\n\n\tPG_RETURN_MACADDR_P(result);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_MACADDR_P",
          "args": [
            "result"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(macaddr)"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nmacaddr_trunc(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *result;\n\n\tresult = (macaddr *) palloc(sizeof(macaddr));\n\n\tresult->a = addr->a;\n\tresult->b = addr->b;\n\tresult->c = addr->c;\n\tresult->d = 0;\n\tresult->e = 0;\n\tresult->f = 0;\n\n\tPG_RETURN_MACADDR_P(result);\n}"
  },
  {
    "function_name": "macaddr_or",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "319-334",
    "snippet": "Datum\nmacaddr_or(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *addr2 = PG_GETARG_MACADDR_P(1);\n\tmacaddr    *result;\n\n\tresult = (macaddr *) palloc(sizeof(macaddr));\n\tresult->a = addr1->a | addr2->a;\n\tresult->b = addr1->b | addr2->b;\n\tresult->c = addr1->c | addr2->c;\n\tresult->d = addr1->d | addr2->d;\n\tresult->e = addr1->e | addr2->e;\n\tresult->f = addr1->f | addr2->f;\n\tPG_RETURN_MACADDR_P(result);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_MACADDR_P",
          "args": [
            "result"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(macaddr)"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "1"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nmacaddr_or(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *addr2 = PG_GETARG_MACADDR_P(1);\n\tmacaddr    *result;\n\n\tresult = (macaddr *) palloc(sizeof(macaddr));\n\tresult->a = addr1->a | addr2->a;\n\tresult->b = addr1->b | addr2->b;\n\tresult->c = addr1->c | addr2->c;\n\tresult->d = addr1->d | addr2->d;\n\tresult->e = addr1->e | addr2->e;\n\tresult->f = addr1->f | addr2->f;\n\tPG_RETURN_MACADDR_P(result);\n}"
  },
  {
    "function_name": "macaddr_and",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "302-317",
    "snippet": "Datum\nmacaddr_and(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *addr2 = PG_GETARG_MACADDR_P(1);\n\tmacaddr    *result;\n\n\tresult = (macaddr *) palloc(sizeof(macaddr));\n\tresult->a = addr1->a & addr2->a;\n\tresult->b = addr1->b & addr2->b;\n\tresult->c = addr1->c & addr2->c;\n\tresult->d = addr1->d & addr2->d;\n\tresult->e = addr1->e & addr2->e;\n\tresult->f = addr1->f & addr2->f;\n\tPG_RETURN_MACADDR_P(result);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_MACADDR_P",
          "args": [
            "result"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(macaddr)"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "1"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nmacaddr_and(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *addr2 = PG_GETARG_MACADDR_P(1);\n\tmacaddr    *result;\n\n\tresult = (macaddr *) palloc(sizeof(macaddr));\n\tresult->a = addr1->a & addr2->a;\n\tresult->b = addr1->b & addr2->b;\n\tresult->c = addr1->c & addr2->c;\n\tresult->d = addr1->d & addr2->d;\n\tresult->e = addr1->e & addr2->e;\n\tresult->f = addr1->f & addr2->f;\n\tPG_RETURN_MACADDR_P(result);\n}"
  },
  {
    "function_name": "macaddr_not",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "286-300",
    "snippet": "Datum\nmacaddr_not(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *result;\n\n\tresult = (macaddr *) palloc(sizeof(macaddr));\n\tresult->a = ~addr->a;\n\tresult->b = ~addr->b;\n\tresult->c = ~addr->c;\n\tresult->d = ~addr->d;\n\tresult->e = ~addr->e;\n\tresult->f = ~addr->f;\n\tPG_RETURN_MACADDR_P(result);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_MACADDR_P",
          "args": [
            "result"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(macaddr)"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nmacaddr_not(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *result;\n\n\tresult = (macaddr *) palloc(sizeof(macaddr));\n\tresult->a = ~addr->a;\n\tresult->b = ~addr->b;\n\tresult->c = ~addr->c;\n\tresult->d = ~addr->d;\n\tresult->e = ~addr->e;\n\tresult->f = ~addr->f;\n\tPG_RETURN_MACADDR_P(result);\n}"
  },
  {
    "function_name": "hashmacaddrextended",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "274-281",
    "snippet": "Datum\nhashmacaddrextended(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *key = PG_GETARG_MACADDR_P(0);\n\n\treturn hash_any_extended((unsigned char *) key, sizeof(macaddr),\n\t\t\t\t\t\t\t PG_GETARG_INT64(1));\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_any_extended",
          "args": [
            "(unsigned char *) key",
            "sizeof(macaddr)",
            "PG_GETARG_INT64(1)"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT64",
          "args": [
            "1"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nhashmacaddrextended(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *key = PG_GETARG_MACADDR_P(0);\n\n\treturn hash_any_extended((unsigned char *) key, sizeof(macaddr),\n\t\t\t\t\t\t\t PG_GETARG_INT64(1));\n}"
  },
  {
    "function_name": "hashmacaddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "266-272",
    "snippet": "Datum\nhashmacaddr(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *key = PG_GETARG_MACADDR_P(0);\n\n\treturn hash_any((unsigned char *) key, sizeof(macaddr));\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_any",
          "args": [
            "(unsigned char *) key",
            "sizeof(macaddr)"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nhashmacaddr(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *key = PG_GETARG_MACADDR_P(0);\n\n\treturn hash_any((unsigned char *) key, sizeof(macaddr));\n}"
  },
  {
    "function_name": "macaddr_ne",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "254-261",
    "snippet": "Datum\nmacaddr_ne(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) != 0);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "macaddr_cmp_internal(a1, a2) != 0"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macaddr_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "macaddr_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
          "lines": "181-194",
          "snippet": "static int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/inet.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nstatic int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "1"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nDatum\nmacaddr_ne(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) != 0);\n}"
  },
  {
    "function_name": "macaddr_gt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "245-252",
    "snippet": "Datum\nmacaddr_gt(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) > 0);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "macaddr_cmp_internal(a1, a2) > 0"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macaddr_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "macaddr_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
          "lines": "181-194",
          "snippet": "static int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/inet.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nstatic int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "1"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nDatum\nmacaddr_gt(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) > 0);\n}"
  },
  {
    "function_name": "macaddr_ge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "236-243",
    "snippet": "Datum\nmacaddr_ge(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) >= 0);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "macaddr_cmp_internal(a1, a2) >= 0"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macaddr_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "macaddr_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
          "lines": "181-194",
          "snippet": "static int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/inet.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nstatic int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "1"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nDatum\nmacaddr_ge(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) >= 0);\n}"
  },
  {
    "function_name": "macaddr_eq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "227-234",
    "snippet": "Datum\nmacaddr_eq(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) == 0);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "macaddr_cmp_internal(a1, a2) == 0"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macaddr_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "macaddr_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
          "lines": "181-194",
          "snippet": "static int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/inet.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nstatic int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "1"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nDatum\nmacaddr_eq(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) == 0);\n}"
  },
  {
    "function_name": "macaddr_le",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "218-225",
    "snippet": "Datum\nmacaddr_le(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) <= 0);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "macaddr_cmp_internal(a1, a2) <= 0"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macaddr_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "macaddr_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
          "lines": "181-194",
          "snippet": "static int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/inet.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nstatic int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "1"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nDatum\nmacaddr_le(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) <= 0);\n}"
  },
  {
    "function_name": "macaddr_lt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "209-216",
    "snippet": "Datum\nmacaddr_lt(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) < 0);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "macaddr_cmp_internal(a1, a2) < 0"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macaddr_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "macaddr_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
          "lines": "181-194",
          "snippet": "static int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/inet.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nstatic int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "1"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nDatum\nmacaddr_lt(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_BOOL(macaddr_cmp_internal(a1, a2) < 0);\n}"
  },
  {
    "function_name": "macaddr_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "196-203",
    "snippet": "Datum\nmacaddr_cmp(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_INT32(macaddr_cmp_internal(a1, a2));\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "macaddr_cmp_internal(a1, a2)"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macaddr_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "macaddr_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
          "lines": "181-194",
          "snippet": "static int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/inet.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nstatic int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "1"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nDatum\nmacaddr_cmp(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *a1 = PG_GETARG_MACADDR_P(0);\n\tmacaddr    *a2 = PG_GETARG_MACADDR_P(1);\n\n\tPG_RETURN_INT32(macaddr_cmp_internal(a1, a2));\n}"
  },
  {
    "function_name": "macaddr_cmp_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "181-194",
    "snippet": "static int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lobits",
          "args": [
            "a2"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lobits",
          "args": [
            "a1"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lobits",
          "args": [
            "a2"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lobits",
          "args": [
            "a1"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hibits",
          "args": [
            "a2"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hibits",
          "args": [
            "a1"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hibits",
          "args": [
            "a2"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hibits",
          "args": [
            "a1"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tmacaddr_cmp_internal(macaddr *a1, macaddr *a2);\n\nstatic int\nmacaddr_cmp_internal(macaddr *a1, macaddr *a2)\n{\n\tif (hibits(a1) < hibits(a2))\n\t\treturn -1;\n\telse if (hibits(a1) > hibits(a2))\n\t\treturn 1;\n\telse if (lobits(a1) < lobits(a2))\n\t\treturn -1;\n\telse if (lobits(a1) > lobits(a2))\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}"
  },
  {
    "function_name": "macaddr_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "160-174",
    "snippet": "Datum\nmacaddr_send(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr = PG_GETARG_MACADDR_P(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendbyte(&buf, addr->a);\n\tpq_sendbyte(&buf, addr->b);\n\tpq_sendbyte(&buf, addr->c);\n\tpq_sendbyte(&buf, addr->d);\n\tpq_sendbyte(&buf, addr->e);\n\tpq_sendbyte(&buf, addr->f);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BYTEA_P",
          "args": [
            "pq_endtypsend(&buf)"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_endtypsend",
          "args": [
            "&buf"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "addr->f"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "addr->e"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "addr->d"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "addr->c"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "addr->b"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "addr->a"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_begintypsend",
          "args": [
            "&buf"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nmacaddr_send(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr = PG_GETARG_MACADDR_P(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendbyte(&buf, addr->a);\n\tpq_sendbyte(&buf, addr->b);\n\tpq_sendbyte(&buf, addr->c);\n\tpq_sendbyte(&buf, addr->d);\n\tpq_sendbyte(&buf, addr->e);\n\tpq_sendbyte(&buf, addr->f);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}"
  },
  {
    "function_name": "macaddr_recv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "139-155",
    "snippet": "Datum\nmacaddr_recv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\tmacaddr    *addr;\n\n\taddr = (macaddr *) palloc(sizeof(macaddr));\n\n\taddr->a = pq_getmsgbyte(buf);\n\taddr->b = pq_getmsgbyte(buf);\n\taddr->c = pq_getmsgbyte(buf);\n\taddr->d = pq_getmsgbyte(buf);\n\taddr->e = pq_getmsgbyte(buf);\n\taddr->f = pq_getmsgbyte(buf);\n\n\tPG_RETURN_MACADDR_P(addr);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_MACADDR_P",
          "args": [
            "addr"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(macaddr)"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nmacaddr_recv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\tmacaddr    *addr;\n\n\taddr = (macaddr *) palloc(sizeof(macaddr));\n\n\taddr->a = pq_getmsgbyte(buf);\n\taddr->b = pq_getmsgbyte(buf);\n\taddr->c = pq_getmsgbyte(buf);\n\taddr->d = pq_getmsgbyte(buf);\n\taddr->e = pq_getmsgbyte(buf);\n\taddr->f = pq_getmsgbyte(buf);\n\n\tPG_RETURN_MACADDR_P(addr);\n}"
  },
  {
    "function_name": "macaddr_out",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "120-132",
    "snippet": "Datum\nmacaddr_out(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr = PG_GETARG_MACADDR_P(0);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(32);\n\n\tsnprintf(result, 32, \"%02x:%02x:%02x:%02x:%02x:%02x\",\n\t\t\t addr->a, addr->b, addr->c, addr->d, addr->e, addr->f);\n\n\tPG_RETURN_CSTRING(result);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_CSTRING",
          "args": [
            "result"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "result",
            "32",
            "\"%02x:%02x:%02x:%02x:%02x:%02x\"",
            "addr->a",
            "addr->b",
            "addr->c",
            "addr->d",
            "addr->e",
            "addr->f"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "32"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_MACADDR_P",
          "args": [
            "0"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nmacaddr_out(PG_FUNCTION_ARGS)\n{\n\tmacaddr    *addr = PG_GETARG_MACADDR_P(0);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(32);\n\n\tsnprintf(result, 32, \"%02x:%02x:%02x:%02x:%02x:%02x\",\n\t\t\t addr->a, addr->b, addr->c, addr->d, addr->e, addr->f);\n\n\tPG_RETURN_CSTRING(result);\n}"
  },
  {
    "function_name": "macaddr_in",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/mac.c",
    "lines": "55-114",
    "snippet": "Datum\nmacaddr_in(PG_FUNCTION_ARGS)\n{\n\tchar\t   *str = PG_GETARG_CSTRING(0);\n\tmacaddr    *result;\n\tint\t\t\ta,\n\t\t\t\tb,\n\t\t\t\tc,\n\t\t\t\td,\n\t\t\t\te,\n\t\t\t\tf;\n\tchar\t\tjunk[2];\n\tint\t\t\tcount;\n\n\t/* %1s matches iff there is trailing non-whitespace garbage */\n\n\tcount = sscanf(str, \"%x:%x:%x:%x:%x:%x%1s\",\n\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%x-%x-%x-%x-%x-%x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%2x%2x%2x:%2x%2x%2x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%2x%2x%2x-%2x%2x%2x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%2x%2x.%2x%2x.%2x%2x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%2x%2x-%2x%2x-%2x%2x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%2x%2x%2x%2x%2x%2x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\", \"macaddr\",\n\t\t\t\t\t\tstr)));\n\n\tif ((a < 0) || (a > 255) || (b < 0) || (b > 255) ||\n\t\t(c < 0) || (c > 255) || (d < 0) || (d > 255) ||\n\t\t(e < 0) || (e > 255) || (f < 0) || (f > 255))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t errmsg(\"invalid octet value in \\\"macaddr\\\" value: \\\"%s\\\"\", str)));\n\n\tresult = (macaddr *) palloc(sizeof(macaddr));\n\n\tresult->a = a;\n\tresult->b = b;\n\tresult->c = c;\n\tresult->d = d;\n\tresult->e = e;\n\tresult->f = f;\n\n\tPG_RETURN_MACADDR_P(result);\n}",
    "includes": [
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_MACADDR_P",
          "args": [
            "result"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(macaddr)"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t errmsg(\"invalid octet value in \\\"macaddr\\\" value: \\\"%s\\\"\", str))"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid octet value in \\\"macaddr\\\" value: \\\"%s\\\"\"",
            "str"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\", \"macaddr\",\n\t\t\t\t\t\tstr))"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "str",
            "\"%2x%2x%2x%2x%2x%2x%1s\"",
            "&a",
            "&b",
            "&c",
            "&d",
            "&e",
            "&f",
            "junk"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "str",
            "\"%2x%2x-%2x%2x-%2x%2x%1s\"",
            "&a",
            "&b",
            "&c",
            "&d",
            "&e",
            "&f",
            "junk"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "str",
            "\"%2x%2x.%2x%2x.%2x%2x%1s\"",
            "&a",
            "&b",
            "&c",
            "&d",
            "&e",
            "&f",
            "junk"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "str",
            "\"%2x%2x%2x-%2x%2x%2x%1s\"",
            "&a",
            "&b",
            "&c",
            "&d",
            "&e",
            "&f",
            "junk"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "str",
            "\"%2x%2x%2x:%2x%2x%2x%1s\"",
            "&a",
            "&b",
            "&c",
            "&d",
            "&e",
            "&f",
            "junk"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "str",
            "\"%x-%x-%x-%x-%x-%x%1s\"",
            "&a",
            "&b",
            "&c",
            "&d",
            "&e",
            "&f",
            "junk"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "str",
            "\"%x:%x:%x:%x:%x:%x%1s\"",
            "&a",
            "&b",
            "&c",
            "&d",
            "&e",
            "&f",
            "junk"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "0"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/sortsupport.h\"\n#include \"utils/inet.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nmacaddr_in(PG_FUNCTION_ARGS)\n{\n\tchar\t   *str = PG_GETARG_CSTRING(0);\n\tmacaddr    *result;\n\tint\t\t\ta,\n\t\t\t\tb,\n\t\t\t\tc,\n\t\t\t\td,\n\t\t\t\te,\n\t\t\t\tf;\n\tchar\t\tjunk[2];\n\tint\t\t\tcount;\n\n\t/* %1s matches iff there is trailing non-whitespace garbage */\n\n\tcount = sscanf(str, \"%x:%x:%x:%x:%x:%x%1s\",\n\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%x-%x-%x-%x-%x-%x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%2x%2x%2x:%2x%2x%2x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%2x%2x%2x-%2x%2x%2x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%2x%2x.%2x%2x.%2x%2x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%2x%2x-%2x%2x-%2x%2x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tcount = sscanf(str, \"%2x%2x%2x%2x%2x%2x%1s\",\n\t\t\t\t\t   &a, &b, &c, &d, &e, &f, junk);\n\tif (count != 6)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\", \"macaddr\",\n\t\t\t\t\t\tstr)));\n\n\tif ((a < 0) || (a > 255) || (b < 0) || (b > 255) ||\n\t\t(c < 0) || (c > 255) || (d < 0) || (d > 255) ||\n\t\t(e < 0) || (e > 255) || (f < 0) || (f > 255))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t errmsg(\"invalid octet value in \\\"macaddr\\\" value: \\\"%s\\\"\", str)));\n\n\tresult = (macaddr *) palloc(sizeof(macaddr));\n\n\tresult->a = a;\n\tresult->b = b;\n\tresult->c = c;\n\tresult->d = d;\n\tresult->e = e;\n\tresult->f = f;\n\n\tPG_RETURN_MACADDR_P(result);\n}"
  }
]