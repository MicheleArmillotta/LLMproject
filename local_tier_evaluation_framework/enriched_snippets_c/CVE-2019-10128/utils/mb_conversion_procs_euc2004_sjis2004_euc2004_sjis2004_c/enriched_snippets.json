[
  {
    "function_name": "shift_jis_20042euc_jis_2004",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc2004_sjis2004/euc2004_sjis2004.c",
    "lines": "215-333",
    "snippet": "static void\nshift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tku,\n\t\t\t\tten,\n\t\t\t\tkubun;\n\tint\t\t\tplane;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *sjis;\n\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t*p++ = c1;\n\t\t\tsjis++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\n\t\tl = pg_encoding_verifymb(PG_SHIFT_JIS_2004, (const char *) sjis, len);\n\n\t\tif (l < 0 || l > len)\n\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\n\t\tif (c1 >= 0xa1 && c1 <= 0xdf && l == 1)\n\t\t{\n\t\t\t/* JIS X0201 (1 byte kana) */\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = c1;\n\t\t}\n\t\telse if (l == 2)\n\t\t{\n\t\t\tint\t\t\tc2 = sjis[1];\n\n\t\t\tplane = 1;\n\t\t\tku = 1;\n\t\t\tten = 1;\n\n\t\t\t/*\n\t\t\t * JIS X 0213\n\t\t\t */\n\t\t\tif (c1 >= 0x81 && c1 <= 0x9f)\t/* plane 1 1ku-62ku */\n\t\t\t{\n\t\t\t\tku = (c1 << 1) - 0x100;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tku -= kubun;\n\t\t\t}\n\t\t\telse if (c1 >= 0xe0 && c1 <= 0xef)\t/* plane 1 62ku-94ku */\n\t\t\t{\n\t\t\t\tku = (c1 << 1) - 0x180;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tku -= kubun;\n\t\t\t}\n\t\t\telse if (c1 >= 0xf0 && c1 <= 0xf3)\t/* plane 2\n\t\t\t\t\t\t\t\t\t\t\t\t * 1,3,4,5,8,12,13,14,15 ku */\n\t\t\t{\n\t\t\t\tplane = 2;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tswitch (c1)\n\t\t\t\t{\n\t\t\t\t\tcase 0xf0:\n\t\t\t\t\t\tku = kubun == 0 ? 8 : 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 0xf1:\n\t\t\t\t\t\tku = kubun == 0 ? 4 : 3;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 0xf2:\n\t\t\t\t\t\tku = kubun == 0 ? 12 : 5;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tku = kubun == 0 ? 14 : 13;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (c1 >= 0xf4 && c1 <= 0xfc)\t/* plane 2 78-94ku */\n\t\t\t{\n\t\t\t\tplane = 2;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tif (c1 == 0xf4 && kubun == 1)\n\t\t\t\t\tku = 15;\n\t\t\t\telse\n\t\t\t\t\tku = (c1 << 1) - 0x19a - kubun;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\n\t\t\tif (plane == 2)\n\t\t\t\t*p++ = SS3;\n\n\t\t\t*p++ = ku + 0xa0;\n\t\t\t*p++ = ten + 0xa0;\n\t\t}\n\t\tsjis += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);",
      "static void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "report_invalid_encoding",
          "args": [
            "PG_SHIFT_JIS_2004",
            "(const char *) sjis",
            "len"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "report_invalid_encoding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1994-2018",
          "snippet": "void\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_ten",
          "args": [
            "c2",
            "&kubun"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "get_ten",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc2004_sjis2004/euc2004_sjis2004.c",
          "lines": "183-209",
          "snippet": "static int\nget_ten(int b, int *ku)\n{\n\tint\t\t\tten;\n\n\tif (b >= 0x40 && b <= 0x7e)\n\t{\n\t\tten = b - 0x3f;\n\t\t*ku = 1;\n\t}\n\telse if (b >= 0x80 && b <= 0x9e)\n\t{\n\t\tten = b - 0x40;\n\t\t*ku = 1;\n\t}\n\telse if (b >= 0x9f && b <= 0xfc)\n\t{\n\t\tten = b - 0x9e;\n\t\t*ku = 0;\n\t}\n\telse\n\t{\n\t\tten = -1;\t\t\t\t/* error */\n\t\t*ku = 0;\t\t\t\t/* keep compiler quiet */\n\t}\n\treturn ten;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic int\nget_ten(int b, int *ku)\n{\n\tint\t\t\tten;\n\n\tif (b >= 0x40 && b <= 0x7e)\n\t{\n\t\tten = b - 0x3f;\n\t\t*ku = 1;\n\t}\n\telse if (b >= 0x80 && b <= 0x9e)\n\t{\n\t\tten = b - 0x40;\n\t\t*ku = 1;\n\t}\n\telse if (b >= 0x9f && b <= 0xfc)\n\t{\n\t\tten = b - 0x9e;\n\t\t*ku = 0;\n\t}\n\telse\n\t{\n\t\tten = -1;\t\t\t\t/* error */\n\t\t*ku = 0;\t\t\t\t/* keep compiler quiet */\n\t}\n\treturn ten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_encoding_verifymb",
          "args": [
            "PG_SHIFT_JIS_2004",
            "(const char *) sjis",
            "len"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "pg_encoding_verifymb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1808-1814",
          "snippet": "int\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c1"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);\nstatic void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);\n\nstatic void\nshift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tku,\n\t\t\t\tten,\n\t\t\t\tkubun;\n\tint\t\t\tplane;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *sjis;\n\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t*p++ = c1;\n\t\t\tsjis++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\n\t\tl = pg_encoding_verifymb(PG_SHIFT_JIS_2004, (const char *) sjis, len);\n\n\t\tif (l < 0 || l > len)\n\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\n\t\tif (c1 >= 0xa1 && c1 <= 0xdf && l == 1)\n\t\t{\n\t\t\t/* JIS X0201 (1 byte kana) */\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = c1;\n\t\t}\n\t\telse if (l == 2)\n\t\t{\n\t\t\tint\t\t\tc2 = sjis[1];\n\n\t\t\tplane = 1;\n\t\t\tku = 1;\n\t\t\tten = 1;\n\n\t\t\t/*\n\t\t\t * JIS X 0213\n\t\t\t */\n\t\t\tif (c1 >= 0x81 && c1 <= 0x9f)\t/* plane 1 1ku-62ku */\n\t\t\t{\n\t\t\t\tku = (c1 << 1) - 0x100;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tku -= kubun;\n\t\t\t}\n\t\t\telse if (c1 >= 0xe0 && c1 <= 0xef)\t/* plane 1 62ku-94ku */\n\t\t\t{\n\t\t\t\tku = (c1 << 1) - 0x180;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tku -= kubun;\n\t\t\t}\n\t\t\telse if (c1 >= 0xf0 && c1 <= 0xf3)\t/* plane 2\n\t\t\t\t\t\t\t\t\t\t\t\t * 1,3,4,5,8,12,13,14,15 ku */\n\t\t\t{\n\t\t\t\tplane = 2;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tswitch (c1)\n\t\t\t\t{\n\t\t\t\t\tcase 0xf0:\n\t\t\t\t\t\tku = kubun == 0 ? 8 : 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 0xf1:\n\t\t\t\t\t\tku = kubun == 0 ? 4 : 3;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 0xf2:\n\t\t\t\t\t\tku = kubun == 0 ? 12 : 5;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tku = kubun == 0 ? 14 : 13;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (c1 >= 0xf4 && c1 <= 0xfc)\t/* plane 2 78-94ku */\n\t\t\t{\n\t\t\t\tplane = 2;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tif (c1 == 0xf4 && kubun == 1)\n\t\t\t\t\tku = 15;\n\t\t\t\telse\n\t\t\t\t\tku = (c1 << 1) - 0x19a - kubun;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\n\t\t\tif (plane == 2)\n\t\t\t\t*p++ = SS3;\n\n\t\t\t*p++ = ku + 0xa0;\n\t\t\t*p++ = ten + 0xa0;\n\t\t}\n\t\tsjis += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
  },
  {
    "function_name": "get_ten",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc2004_sjis2004/euc2004_sjis2004.c",
    "lines": "183-209",
    "snippet": "static int\nget_ten(int b, int *ku)\n{\n\tint\t\t\tten;\n\n\tif (b >= 0x40 && b <= 0x7e)\n\t{\n\t\tten = b - 0x3f;\n\t\t*ku = 1;\n\t}\n\telse if (b >= 0x80 && b <= 0x9e)\n\t{\n\t\tten = b - 0x40;\n\t\t*ku = 1;\n\t}\n\telse if (b >= 0x9f && b <= 0xfc)\n\t{\n\t\tten = b - 0x9e;\n\t\t*ku = 0;\n\t}\n\telse\n\t{\n\t\tten = -1;\t\t\t\t/* error */\n\t\t*ku = 0;\t\t\t\t/* keep compiler quiet */\n\t}\n\treturn ten;\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic int\nget_ten(int b, int *ku)\n{\n\tint\t\t\tten;\n\n\tif (b >= 0x40 && b <= 0x7e)\n\t{\n\t\tten = b - 0x3f;\n\t\t*ku = 1;\n\t}\n\telse if (b >= 0x80 && b <= 0x9e)\n\t{\n\t\tten = b - 0x40;\n\t\t*ku = 1;\n\t}\n\telse if (b >= 0x9f && b <= 0xfc)\n\t{\n\t\tten = b - 0x9e;\n\t\t*ku = 0;\n\t}\n\telse\n\t{\n\t\tten = -1;\t\t\t\t/* error */\n\t\t*ku = 0;\t\t\t\t/* keep compiler quiet */\n\t}\n\treturn ten;\n}"
  },
  {
    "function_name": "euc_jis_20042shift_jis_2004",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc2004_sjis2004/euc2004_sjis2004.c",
    "lines": "67-176",
    "snippet": "static void\neuc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len)\n{\n\tint\t\t\tc1,\n\t\t\t\tku,\n\t\t\t\tten;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *euc;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t*p++ = c1;\n\t\t\teuc++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\n\t\tl = pg_encoding_verifymb(PG_EUC_JIS_2004, (const char *) euc, len);\n\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\tif (c1 == SS2 && l == 2)\t/* JIS X 0201 kana? */\n\t\t{\n\t\t\t*p++ = euc[1];\n\t\t}\n\t\telse if (c1 == SS3 && l == 3)\t/* JIS X 0213 plane 2? */\n\t\t{\n\t\t\tku = euc[1] - 0xa0;\n\t\t\tten = euc[2] - 0xa0;\n\n\t\t\tswitch (ku)\n\t\t\t{\n\t\t\t\tcase 1:\n\t\t\t\tcase 3:\n\t\t\t\tcase 4:\n\t\t\t\tcase 5:\n\t\t\t\tcase 8:\n\t\t\t\tcase 12:\n\t\t\t\tcase 13:\n\t\t\t\tcase 14:\n\t\t\t\tcase 15:\n\t\t\t\t\t*p++ = ((ku + 0x1df) >> 1) - (ku >> 3) * 3;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (ku >= 78 && ku <= 94)\n\t\t\t\t\t{\n\t\t\t\t\t\t*p++ = (ku + 0x19b) >> 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\n\t\t\tif (ku % 2)\n\t\t\t{\n\t\t\t\tif (ten >= 1 && ten <= 63)\n\t\t\t\t\t*p++ = ten + 0x3f;\n\t\t\t\telse if (ten >= 64 && ten <= 94)\n\t\t\t\t\t*p++ = ten + 0x40;\n\t\t\t\telse\n\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\t\t\telse\n\t\t\t\t*p++ = ten + 0x9e;\n\t\t}\n\n\t\telse if (l == 2)\t\t/* JIS X 0213 plane 1? */\n\t\t{\n\t\t\tku = c1 - 0xa0;\n\t\t\tten = euc[1] - 0xa0;\n\n\t\t\tif (ku >= 1 && ku <= 62)\n\t\t\t\t*p++ = (ku + 0x101) >> 1;\n\t\t\telse if (ku >= 63 && ku <= 94)\n\t\t\t\t*p++ = (ku + 0x181) >> 1;\n\t\t\telse\n\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\t\tif (ku % 2)\n\t\t\t{\n\t\t\t\tif (ten >= 1 && ten <= 63)\n\t\t\t\t\t*p++ = ten + 0x3f;\n\t\t\t\telse if (ten >= 64 && ten <= 94)\n\t\t\t\t\t*p++ = ten + 0x40;\n\t\t\t\telse\n\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\t\t\telse\n\t\t\t\t*p++ = ten + 0x9e;\n\t\t}\n\t\telse\n\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\teuc += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);",
      "static void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "report_invalid_encoding",
          "args": [
            "PG_EUC_JIS_2004",
            "(const char *) euc",
            "len"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "report_invalid_encoding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1994-2018",
          "snippet": "void\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_encoding_verifymb",
          "args": [
            "PG_EUC_JIS_2004",
            "(const char *) euc",
            "len"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "pg_encoding_verifymb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1808-1814",
          "snippet": "int\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c1"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);\nstatic void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);\n\nstatic void\neuc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len)\n{\n\tint\t\t\tc1,\n\t\t\t\tku,\n\t\t\t\tten;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *euc;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t*p++ = c1;\n\t\t\teuc++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\n\t\tl = pg_encoding_verifymb(PG_EUC_JIS_2004, (const char *) euc, len);\n\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\tif (c1 == SS2 && l == 2)\t/* JIS X 0201 kana? */\n\t\t{\n\t\t\t*p++ = euc[1];\n\t\t}\n\t\telse if (c1 == SS3 && l == 3)\t/* JIS X 0213 plane 2? */\n\t\t{\n\t\t\tku = euc[1] - 0xa0;\n\t\t\tten = euc[2] - 0xa0;\n\n\t\t\tswitch (ku)\n\t\t\t{\n\t\t\t\tcase 1:\n\t\t\t\tcase 3:\n\t\t\t\tcase 4:\n\t\t\t\tcase 5:\n\t\t\t\tcase 8:\n\t\t\t\tcase 12:\n\t\t\t\tcase 13:\n\t\t\t\tcase 14:\n\t\t\t\tcase 15:\n\t\t\t\t\t*p++ = ((ku + 0x1df) >> 1) - (ku >> 3) * 3;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (ku >= 78 && ku <= 94)\n\t\t\t\t\t{\n\t\t\t\t\t\t*p++ = (ku + 0x19b) >> 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\n\t\t\tif (ku % 2)\n\t\t\t{\n\t\t\t\tif (ten >= 1 && ten <= 63)\n\t\t\t\t\t*p++ = ten + 0x3f;\n\t\t\t\telse if (ten >= 64 && ten <= 94)\n\t\t\t\t\t*p++ = ten + 0x40;\n\t\t\t\telse\n\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\t\t\telse\n\t\t\t\t*p++ = ten + 0x9e;\n\t\t}\n\n\t\telse if (l == 2)\t\t/* JIS X 0213 plane 1? */\n\t\t{\n\t\t\tku = c1 - 0xa0;\n\t\t\tten = euc[1] - 0xa0;\n\n\t\t\tif (ku >= 1 && ku <= 62)\n\t\t\t\t*p++ = (ku + 0x101) >> 1;\n\t\t\telse if (ku >= 63 && ku <= 94)\n\t\t\t\t*p++ = (ku + 0x181) >> 1;\n\t\t\telse\n\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\t\tif (ku % 2)\n\t\t\t{\n\t\t\t\tif (ten >= 1 && ten <= 63)\n\t\t\t\t\t*p++ = ten + 0x3f;\n\t\t\t\telse if (ten >= 64 && ten <= 94)\n\t\t\t\t\t*p++ = ten + 0x40;\n\t\t\t\telse\n\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\t\t\telse\n\t\t\t\t*p++ = ten + 0x9e;\n\t\t}\n\t\telse\n\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\teuc += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
  },
  {
    "function_name": "shift_jis_2004_to_euc_jis_2004",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc2004_sjis2004/euc2004_sjis2004.c",
    "lines": "50-62",
    "snippet": "Datum\nshift_jis_2004_to_euc_jis_2004(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_SHIFT_JIS_2004, PG_EUC_JIS_2004);\n\n\tshift_jis_20042euc_jis_2004(src, dest, len);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);",
      "static void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shift_jis_20042euc_jis_2004",
          "args": [
            "src",
            "dest",
            "len"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "shift_jis_20042euc_jis_2004",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc2004_sjis2004/euc2004_sjis2004.c",
          "lines": "215-333",
          "snippet": "static void\nshift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tku,\n\t\t\t\tten,\n\t\t\t\tkubun;\n\tint\t\t\tplane;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *sjis;\n\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t*p++ = c1;\n\t\t\tsjis++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\n\t\tl = pg_encoding_verifymb(PG_SHIFT_JIS_2004, (const char *) sjis, len);\n\n\t\tif (l < 0 || l > len)\n\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\n\t\tif (c1 >= 0xa1 && c1 <= 0xdf && l == 1)\n\t\t{\n\t\t\t/* JIS X0201 (1 byte kana) */\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = c1;\n\t\t}\n\t\telse if (l == 2)\n\t\t{\n\t\t\tint\t\t\tc2 = sjis[1];\n\n\t\t\tplane = 1;\n\t\t\tku = 1;\n\t\t\tten = 1;\n\n\t\t\t/*\n\t\t\t * JIS X 0213\n\t\t\t */\n\t\t\tif (c1 >= 0x81 && c1 <= 0x9f)\t/* plane 1 1ku-62ku */\n\t\t\t{\n\t\t\t\tku = (c1 << 1) - 0x100;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tku -= kubun;\n\t\t\t}\n\t\t\telse if (c1 >= 0xe0 && c1 <= 0xef)\t/* plane 1 62ku-94ku */\n\t\t\t{\n\t\t\t\tku = (c1 << 1) - 0x180;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tku -= kubun;\n\t\t\t}\n\t\t\telse if (c1 >= 0xf0 && c1 <= 0xf3)\t/* plane 2\n\t\t\t\t\t\t\t\t\t\t\t\t * 1,3,4,5,8,12,13,14,15 ku */\n\t\t\t{\n\t\t\t\tplane = 2;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tswitch (c1)\n\t\t\t\t{\n\t\t\t\t\tcase 0xf0:\n\t\t\t\t\t\tku = kubun == 0 ? 8 : 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 0xf1:\n\t\t\t\t\t\tku = kubun == 0 ? 4 : 3;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 0xf2:\n\t\t\t\t\t\tku = kubun == 0 ? 12 : 5;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tku = kubun == 0 ? 14 : 13;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (c1 >= 0xf4 && c1 <= 0xfc)\t/* plane 2 78-94ku */\n\t\t\t{\n\t\t\t\tplane = 2;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tif (c1 == 0xf4 && kubun == 1)\n\t\t\t\t\tku = 15;\n\t\t\t\telse\n\t\t\t\t\tku = (c1 << 1) - 0x19a - kubun;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\n\t\t\tif (plane == 2)\n\t\t\t\t*p++ = SS3;\n\n\t\t\t*p++ = ku + 0xa0;\n\t\t\t*p++ = ten + 0xa0;\n\t\t}\n\t\tsjis += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);",
            "static void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);\nstatic void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);\n\nstatic void\nshift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tku,\n\t\t\t\tten,\n\t\t\t\tkubun;\n\tint\t\t\tplane;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *sjis;\n\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t*p++ = c1;\n\t\t\tsjis++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\n\t\tl = pg_encoding_verifymb(PG_SHIFT_JIS_2004, (const char *) sjis, len);\n\n\t\tif (l < 0 || l > len)\n\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\n\t\tif (c1 >= 0xa1 && c1 <= 0xdf && l == 1)\n\t\t{\n\t\t\t/* JIS X0201 (1 byte kana) */\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = c1;\n\t\t}\n\t\telse if (l == 2)\n\t\t{\n\t\t\tint\t\t\tc2 = sjis[1];\n\n\t\t\tplane = 1;\n\t\t\tku = 1;\n\t\t\tten = 1;\n\n\t\t\t/*\n\t\t\t * JIS X 0213\n\t\t\t */\n\t\t\tif (c1 >= 0x81 && c1 <= 0x9f)\t/* plane 1 1ku-62ku */\n\t\t\t{\n\t\t\t\tku = (c1 << 1) - 0x100;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tku -= kubun;\n\t\t\t}\n\t\t\telse if (c1 >= 0xe0 && c1 <= 0xef)\t/* plane 1 62ku-94ku */\n\t\t\t{\n\t\t\t\tku = (c1 << 1) - 0x180;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tku -= kubun;\n\t\t\t}\n\t\t\telse if (c1 >= 0xf0 && c1 <= 0xf3)\t/* plane 2\n\t\t\t\t\t\t\t\t\t\t\t\t * 1,3,4,5,8,12,13,14,15 ku */\n\t\t\t{\n\t\t\t\tplane = 2;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tswitch (c1)\n\t\t\t\t{\n\t\t\t\t\tcase 0xf0:\n\t\t\t\t\t\tku = kubun == 0 ? 8 : 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 0xf1:\n\t\t\t\t\t\tku = kubun == 0 ? 4 : 3;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 0xf2:\n\t\t\t\t\t\tku = kubun == 0 ? 12 : 5;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tku = kubun == 0 ? 14 : 13;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (c1 >= 0xf4 && c1 <= 0xfc)\t/* plane 2 78-94ku */\n\t\t\t{\n\t\t\t\tplane = 2;\n\t\t\t\tten = get_ten(c2, &kubun);\n\t\t\t\tif (ten < 0)\n\t\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\t\t\t\tif (c1 == 0xf4 && kubun == 1)\n\t\t\t\t\tku = 15;\n\t\t\t\telse\n\t\t\t\t\tku = (c1 << 1) - 0x19a - kubun;\n\t\t\t}\n\t\t\telse\n\t\t\t\treport_invalid_encoding(PG_SHIFT_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) sjis, len);\n\n\t\t\tif (plane == 2)\n\t\t\t\t*p++ = SS3;\n\n\t\t\t*p++ = ku + 0xa0;\n\t\t\t*p++ = ten + 0xa0;\n\t\t}\n\t\tsjis += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_SHIFT_JIS_2004",
            "PG_EUC_JIS_2004"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);\nstatic void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);\n\nDatum\nshift_jis_2004_to_euc_jis_2004(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_SHIFT_JIS_2004, PG_EUC_JIS_2004);\n\n\tshift_jis_20042euc_jis_2004(src, dest, len);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "euc_jis_2004_to_shift_jis_2004",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc2004_sjis2004/euc2004_sjis2004.c",
    "lines": "36-48",
    "snippet": "Datum\neuc_jis_2004_to_shift_jis_2004(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_EUC_JIS_2004, PG_SHIFT_JIS_2004);\n\n\teuc_jis_20042shift_jis_2004(src, dest, len);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);",
      "static void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "euc_jis_20042shift_jis_2004",
          "args": [
            "src",
            "dest",
            "len"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "euc_jis_20042shift_jis_2004",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc2004_sjis2004/euc2004_sjis2004.c",
          "lines": "67-176",
          "snippet": "static void\neuc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len)\n{\n\tint\t\t\tc1,\n\t\t\t\tku,\n\t\t\t\tten;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *euc;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t*p++ = c1;\n\t\t\teuc++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\n\t\tl = pg_encoding_verifymb(PG_EUC_JIS_2004, (const char *) euc, len);\n\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\tif (c1 == SS2 && l == 2)\t/* JIS X 0201 kana? */\n\t\t{\n\t\t\t*p++ = euc[1];\n\t\t}\n\t\telse if (c1 == SS3 && l == 3)\t/* JIS X 0213 plane 2? */\n\t\t{\n\t\t\tku = euc[1] - 0xa0;\n\t\t\tten = euc[2] - 0xa0;\n\n\t\t\tswitch (ku)\n\t\t\t{\n\t\t\t\tcase 1:\n\t\t\t\tcase 3:\n\t\t\t\tcase 4:\n\t\t\t\tcase 5:\n\t\t\t\tcase 8:\n\t\t\t\tcase 12:\n\t\t\t\tcase 13:\n\t\t\t\tcase 14:\n\t\t\t\tcase 15:\n\t\t\t\t\t*p++ = ((ku + 0x1df) >> 1) - (ku >> 3) * 3;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (ku >= 78 && ku <= 94)\n\t\t\t\t\t{\n\t\t\t\t\t\t*p++ = (ku + 0x19b) >> 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\n\t\t\tif (ku % 2)\n\t\t\t{\n\t\t\t\tif (ten >= 1 && ten <= 63)\n\t\t\t\t\t*p++ = ten + 0x3f;\n\t\t\t\telse if (ten >= 64 && ten <= 94)\n\t\t\t\t\t*p++ = ten + 0x40;\n\t\t\t\telse\n\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\t\t\telse\n\t\t\t\t*p++ = ten + 0x9e;\n\t\t}\n\n\t\telse if (l == 2)\t\t/* JIS X 0213 plane 1? */\n\t\t{\n\t\t\tku = c1 - 0xa0;\n\t\t\tten = euc[1] - 0xa0;\n\n\t\t\tif (ku >= 1 && ku <= 62)\n\t\t\t\t*p++ = (ku + 0x101) >> 1;\n\t\t\telse if (ku >= 63 && ku <= 94)\n\t\t\t\t*p++ = (ku + 0x181) >> 1;\n\t\t\telse\n\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\t\tif (ku % 2)\n\t\t\t{\n\t\t\t\tif (ten >= 1 && ten <= 63)\n\t\t\t\t\t*p++ = ten + 0x3f;\n\t\t\t\telse if (ten >= 64 && ten <= 94)\n\t\t\t\t\t*p++ = ten + 0x40;\n\t\t\t\telse\n\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\t\t\telse\n\t\t\t\t*p++ = ten + 0x9e;\n\t\t}\n\t\telse\n\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\teuc += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);",
            "static void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);\nstatic void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);\n\nstatic void\neuc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len)\n{\n\tint\t\t\tc1,\n\t\t\t\tku,\n\t\t\t\tten;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *euc;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t*p++ = c1;\n\t\t\teuc++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\n\t\tl = pg_encoding_verifymb(PG_EUC_JIS_2004, (const char *) euc, len);\n\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\tif (c1 == SS2 && l == 2)\t/* JIS X 0201 kana? */\n\t\t{\n\t\t\t*p++ = euc[1];\n\t\t}\n\t\telse if (c1 == SS3 && l == 3)\t/* JIS X 0213 plane 2? */\n\t\t{\n\t\t\tku = euc[1] - 0xa0;\n\t\t\tten = euc[2] - 0xa0;\n\n\t\t\tswitch (ku)\n\t\t\t{\n\t\t\t\tcase 1:\n\t\t\t\tcase 3:\n\t\t\t\tcase 4:\n\t\t\t\tcase 5:\n\t\t\t\tcase 8:\n\t\t\t\tcase 12:\n\t\t\t\tcase 13:\n\t\t\t\tcase 14:\n\t\t\t\tcase 15:\n\t\t\t\t\t*p++ = ((ku + 0x1df) >> 1) - (ku >> 3) * 3;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (ku >= 78 && ku <= 94)\n\t\t\t\t\t{\n\t\t\t\t\t\t*p++ = (ku + 0x19b) >> 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\n\t\t\tif (ku % 2)\n\t\t\t{\n\t\t\t\tif (ten >= 1 && ten <= 63)\n\t\t\t\t\t*p++ = ten + 0x3f;\n\t\t\t\telse if (ten >= 64 && ten <= 94)\n\t\t\t\t\t*p++ = ten + 0x40;\n\t\t\t\telse\n\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\t\t\telse\n\t\t\t\t*p++ = ten + 0x9e;\n\t\t}\n\n\t\telse if (l == 2)\t\t/* JIS X 0213 plane 1? */\n\t\t{\n\t\t\tku = c1 - 0xa0;\n\t\t\tten = euc[1] - 0xa0;\n\n\t\t\tif (ku >= 1 && ku <= 62)\n\t\t\t\t*p++ = (ku + 0x101) >> 1;\n\t\t\telse if (ku >= 63 && ku <= 94)\n\t\t\t\t*p++ = (ku + 0x181) >> 1;\n\t\t\telse\n\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\t\tif (ku % 2)\n\t\t\t{\n\t\t\t\tif (ten >= 1 && ten <= 63)\n\t\t\t\t\t*p++ = ten + 0x3f;\n\t\t\t\telse if (ten >= 64 && ten <= 94)\n\t\t\t\t\t*p++ = ten + 0x40;\n\t\t\t\telse\n\t\t\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t}\n\t\t\telse\n\t\t\t\t*p++ = ten + 0x9e;\n\t\t}\n\t\telse\n\t\t\treport_invalid_encoding(PG_EUC_JIS_2004,\n\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\n\t\teuc += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_EUC_JIS_2004",
            "PG_SHIFT_JIS_2004"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void euc_jis_20042shift_jis_2004(const unsigned char *euc, unsigned char *p, int len);\nstatic void shift_jis_20042euc_jis_2004(const unsigned char *sjis, unsigned char *p, int len);\n\nDatum\neuc_jis_2004_to_shift_jis_2004(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_EUC_JIS_2004, PG_SHIFT_JIS_2004);\n\n\teuc_jis_20042shift_jis_2004(src, dest, len);\n\n\tPG_RETURN_VOID();\n}"
  }
]