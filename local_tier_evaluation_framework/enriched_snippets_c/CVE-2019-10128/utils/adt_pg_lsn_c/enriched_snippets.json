[
  {
    "function_name": "pg_lsn_mi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "193-214",
    "snippet": "Datum\npg_lsn_mi(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\tchar\t\tbuf[256];\n\tDatum\t\tresult;\n\n\t/* Output could be as large as plus or minus 2^63 - 1. */\n\tif (lsn1 < lsn2)\n\t\tsnprintf(buf, sizeof buf, \"-\" UINT64_FORMAT, lsn2 - lsn1);\n\telse\n\t\tsnprintf(buf, sizeof buf, UINT64_FORMAT, lsn1 - lsn2);\n\n\t/* Convert to numeric. */\n\tresult = DirectFunctionCall3(numeric_in,\n\t\t\t\t\t\t\t\t CStringGetDatum(buf),\n\t\t\t\t\t\t\t\t ObjectIdGetDatum(0),\n\t\t\t\t\t\t\t\t Int32GetDatum(-1));\n\n\treturn result;\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DirectFunctionCall3",
          "args": [
            "numeric_in",
            "CStringGetDatum(buf)",
            "ObjectIdGetDatum(0)",
            "Int32GetDatum(-1)"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "-1"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "0"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "buf"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof buf",
            "UINT64_FORMAT",
            "lsn1 - lsn2"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof buf",
            "\"-\" UINT64_FORMAT",
            "lsn2 - lsn1"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "1"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "0"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_mi(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\tchar\t\tbuf[256];\n\tDatum\t\tresult;\n\n\t/* Output could be as large as plus or minus 2^63 - 1. */\n\tif (lsn1 < lsn2)\n\t\tsnprintf(buf, sizeof buf, \"-\" UINT64_FORMAT, lsn2 - lsn1);\n\telse\n\t\tsnprintf(buf, sizeof buf, UINT64_FORMAT, lsn1 - lsn2);\n\n\t/* Convert to numeric. */\n\tresult = DirectFunctionCall3(numeric_in,\n\t\t\t\t\t\t\t\t CStringGetDatum(buf),\n\t\t\t\t\t\t\t\t ObjectIdGetDatum(0),\n\t\t\t\t\t\t\t\t Int32GetDatum(-1));\n\n\treturn result;\n}"
  },
  {
    "function_name": "pg_lsn_hash_extended",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "182-186",
    "snippet": "Datum\npg_lsn_hash_extended(PG_FUNCTION_ARGS)\n{\n\treturn hashint8extended(fcinfo);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hashint8extended",
          "args": [
            "fcinfo"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_hash_extended(PG_FUNCTION_ARGS)\n{\n\treturn hashint8extended(fcinfo);\n}"
  },
  {
    "function_name": "pg_lsn_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "175-180",
    "snippet": "Datum\npg_lsn_hash(PG_FUNCTION_ARGS)\n{\n\t/* We can use hashint8 directly */\n\treturn hashint8(fcinfo);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hashint8",
          "args": [
            "fcinfo"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_hash(PG_FUNCTION_ARGS)\n{\n\t/* We can use hashint8 directly */\n\treturn hashint8(fcinfo);\n}"
  },
  {
    "function_name": "pg_lsn_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "160-172",
    "snippet": "Datum\npg_lsn_cmp(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\ta = PG_GETARG_LSN(0);\n\tXLogRecPtr\tb = PG_GETARG_LSN(1);\n\n\tif (a > b)\n\t\tPG_RETURN_INT32(1);\n\telse if (a == b)\n\t\tPG_RETURN_INT32(0);\n\telse\n\t\tPG_RETURN_INT32(-1);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "-1"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "0"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "1"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "1"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "0"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_cmp(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\ta = PG_GETARG_LSN(0);\n\tXLogRecPtr\tb = PG_GETARG_LSN(1);\n\n\tif (a > b)\n\t\tPG_RETURN_INT32(1);\n\telse if (a == b)\n\t\tPG_RETURN_INT32(0);\n\telse\n\t\tPG_RETURN_INT32(-1);\n}"
  },
  {
    "function_name": "pg_lsn_ge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "150-157",
    "snippet": "Datum\npg_lsn_ge(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 >= lsn2);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "lsn1 >= lsn2"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "1"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "0"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_ge(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 >= lsn2);\n}"
  },
  {
    "function_name": "pg_lsn_le",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "141-148",
    "snippet": "Datum\npg_lsn_le(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 <= lsn2);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "lsn1 <= lsn2"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "1"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "0"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_le(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 <= lsn2);\n}"
  },
  {
    "function_name": "pg_lsn_gt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "132-139",
    "snippet": "Datum\npg_lsn_gt(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 > lsn2);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "lsn1 > lsn2"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "1"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "0"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_gt(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 > lsn2);\n}"
  },
  {
    "function_name": "pg_lsn_lt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "123-130",
    "snippet": "Datum\npg_lsn_lt(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 < lsn2);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "lsn1 < lsn2"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "1"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "0"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_lt(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 < lsn2);\n}"
  },
  {
    "function_name": "pg_lsn_ne",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "114-121",
    "snippet": "Datum\npg_lsn_ne(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 != lsn2);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "lsn1 != lsn2"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "1"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "0"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_ne(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 != lsn2);\n}"
  },
  {
    "function_name": "pg_lsn_eq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "105-112",
    "snippet": "Datum\npg_lsn_eq(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 == lsn2);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "lsn1 == lsn2"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "1"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "0"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_eq(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn1 = PG_GETARG_LSN(0);\n\tXLogRecPtr\tlsn2 = PG_GETARG_LSN(1);\n\n\tPG_RETURN_BOOL(lsn1 == lsn2);\n}"
  },
  {
    "function_name": "pg_lsn_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "89-98",
    "snippet": "Datum\npg_lsn_send(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn = PG_GETARG_LSN(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendint64(&buf, lsn);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BYTEA_P",
          "args": [
            "pq_endtypsend(&buf)"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_endtypsend",
          "args": [
            "&buf"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendint64",
          "args": [
            "&buf",
            "lsn"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_begintypsend",
          "args": [
            "&buf"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "0"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_send(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn = PG_GETARG_LSN(0);\n\tStringInfoData buf;\n\n\tpq_begintypsend(&buf);\n\tpq_sendint64(&buf, lsn);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));\n}"
  },
  {
    "function_name": "pg_lsn_recv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "79-87",
    "snippet": "Datum\npg_lsn_recv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\tXLogRecPtr\tresult;\n\n\tresult = pq_getmsgint64(buf);\n\tPG_RETURN_LSN(result);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_LSN",
          "args": [
            "result"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgint64",
          "args": [
            "buf"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\npg_lsn_recv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\tXLogRecPtr\tresult;\n\n\tresult = pq_getmsgint64(buf);\n\tPG_RETURN_LSN(result);\n}"
  },
  {
    "function_name": "pg_lsn_out",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "61-77",
    "snippet": "Datum\npg_lsn_out(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn = PG_GETARG_LSN(0);\n\tchar\t\tbuf[MAXPG_LSNLEN + 1];\n\tchar\t   *result;\n\tuint32\t\tid,\n\t\t\t\toff;\n\n\t/* Decode ID and offset */\n\tid = (uint32) (lsn >> 32);\n\toff = (uint32) lsn;\n\n\tsnprintf(buf, sizeof buf, \"%X/%X\", id, off);\n\tresult = pstrdup(buf);\n\tPG_RETURN_CSTRING(result);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define MAXPG_LSNLEN\t\t\t17"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_CSTRING",
          "args": [
            "result"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pstrdup",
          "args": [
            "buf"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pstrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1658-1662",
          "snippet": "static char *\nxml_pstrdup(const char *string)\n{\n\treturn MemoryContextStrdup(LibxmlContext, string);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic char *\nxml_pstrdup(const char *string)\n{\n\treturn MemoryContextStrdup(LibxmlContext, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof buf",
            "\"%X/%X\"",
            "id",
            "off"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "lsn >> 32"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_LSN",
          "args": [
            "0"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\n#define MAXPG_LSNLEN\t\t\t17\n\nDatum\npg_lsn_out(PG_FUNCTION_ARGS)\n{\n\tXLogRecPtr\tlsn = PG_GETARG_LSN(0);\n\tchar\t\tbuf[MAXPG_LSNLEN + 1];\n\tchar\t   *result;\n\tuint32\t\tid,\n\t\t\t\toff;\n\n\t/* Decode ID and offset */\n\tid = (uint32) (lsn >> 32);\n\toff = (uint32) lsn;\n\n\tsnprintf(buf, sizeof buf, \"%X/%X\", id, off);\n\tresult = pstrdup(buf);\n\tPG_RETURN_CSTRING(result);\n}"
  },
  {
    "function_name": "pg_lsn_in",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pg_lsn.c",
    "lines": "29-59",
    "snippet": "Datum\npg_lsn_in(PG_FUNCTION_ARGS)\n{\n\tchar\t   *str = PG_GETARG_CSTRING(0);\n\tint\t\t\tlen1,\n\t\t\t\tlen2;\n\tuint32\t\tid,\n\t\t\t\toff;\n\tXLogRecPtr\tresult;\n\n\t/* Sanity check input format. */\n\tlen1 = strspn(str, \"0123456789abcdefABCDEF\");\n\tif (len1 < 1 || len1 > MAXPG_LSNCOMPONENT || str[len1] != '/')\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"pg_lsn\", str)));\n\tlen2 = strspn(str + len1 + 1, \"0123456789abcdefABCDEF\");\n\tif (len2 < 1 || len2 > MAXPG_LSNCOMPONENT || str[len1 + 1 + len2] != '\\0')\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"pg_lsn\", str)));\n\n\t/* Decode result. */\n\tid = (uint32) strtoul(str, NULL, 16);\n\toff = (uint32) strtoul(str + len1 + 1, NULL, 16);\n\tresult = ((uint64) id << 32) | off;\n\n\tPG_RETURN_LSN(result);\n}",
    "includes": [
      "#include \"utils/pg_lsn.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"funcapi.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define MAXPG_LSNCOMPONENT\t8"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_LSN",
          "args": [
            "result"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "str + len1 + 1",
            "NULL",
            "16"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "str",
            "NULL",
            "16"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"pg_lsn\", str))"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid input syntax for type %s: \\\"%s\\\"\"",
            "\"pg_lsn\"",
            "str"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_TEXT_REPRESENTATION"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "strspn",
          "args": [
            "str + len1 + 1",
            "\"0123456789abcdefABCDEF\""
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"pg_lsn\", str))"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strspn",
          "args": [
            "str",
            "\"0123456789abcdefABCDEF\""
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "0"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/pg_lsn.h\"\n#include \"utils/builtins.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\n#define MAXPG_LSNCOMPONENT\t8\n\nDatum\npg_lsn_in(PG_FUNCTION_ARGS)\n{\n\tchar\t   *str = PG_GETARG_CSTRING(0);\n\tint\t\t\tlen1,\n\t\t\t\tlen2;\n\tuint32\t\tid,\n\t\t\t\toff;\n\tXLogRecPtr\tresult;\n\n\t/* Sanity check input format. */\n\tlen1 = strspn(str, \"0123456789abcdefABCDEF\");\n\tif (len1 < 1 || len1 > MAXPG_LSNCOMPONENT || str[len1] != '/')\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"pg_lsn\", str)));\n\tlen2 = strspn(str + len1 + 1, \"0123456789abcdefABCDEF\");\n\tif (len2 < 1 || len2 > MAXPG_LSNCOMPONENT || str[len1 + 1 + len2] != '\\0')\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\t\"pg_lsn\", str)));\n\n\t/* Decode result. */\n\tid = (uint32) strtoul(str, NULL, 16);\n\toff = (uint32) strtoul(str + len1 + 1, NULL, 16);\n\tresult = ((uint64) id << 32) | off;\n\n\tPG_RETURN_LSN(result);\n}"
  }
]