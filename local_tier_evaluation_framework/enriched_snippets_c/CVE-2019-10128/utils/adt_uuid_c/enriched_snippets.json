[
  {
    "function_name": "uuid_hash_extended",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "412-418",
    "snippet": "Datum\nuuid_hash_extended(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *key = PG_GETARG_UUID_P(0);\n\n\treturn hash_any_extended(key->data, UUID_LEN, PG_GETARG_INT64(1));\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_any_extended",
          "args": [
            "key->data",
            "UUID_LEN",
            "PG_GETARG_INT64(1)"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT64",
          "args": [
            "1"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nuuid_hash_extended(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *key = PG_GETARG_UUID_P(0);\n\n\treturn hash_any_extended(key->data, UUID_LEN, PG_GETARG_INT64(1));\n}"
  },
  {
    "function_name": "uuid_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "404-410",
    "snippet": "Datum\nuuid_hash(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *key = PG_GETARG_UUID_P(0);\n\n\treturn hash_any(key->data, UUID_LEN);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_any",
          "args": [
            "key->data",
            "UUID_LEN"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nDatum\nuuid_hash(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *key = PG_GETARG_UUID_P(0);\n\n\treturn hash_any(key->data, UUID_LEN);\n}"
  },
  {
    "function_name": "uuid_abbrev_convert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "367-401",
    "snippet": "static Datum\nuuid_abbrev_convert(Datum original, SortSupport ssup)\n{\n\tuuid_sortsupport_state *uss = ssup->ssup_extra;\n\tpg_uuid_t  *authoritative = DatumGetUUIDP(original);\n\tDatum\t\tres;\n\n\tmemcpy(&res, authoritative->data, sizeof(Datum));\n\tuss->input_count += 1;\n\n\tif (uss->estimating)\n\t{\n\t\tuint32\t\ttmp;\n\n#if SIZEOF_DATUM == 8\n\t\ttmp = (uint32) res ^ (uint32) ((uint64) res >> 32);\n#else\t\t\t\t\t\t\t/* SIZEOF_DATUM != 8 */\n\t\ttmp = (uint32) res;\n#endif\n\n\t\taddHyperLogLog(&uss->abbr_card, DatumGetUInt32(hash_uint32(tmp)));\n\t}\n\n\t/*\n\t * Byteswap on little-endian machines.\n\t *\n\t * This is needed so that uuid_cmp_abbrev() (an unsigned integer 3-way\n\t * comparator) works correctly on all platforms.  If we didn't do this,\n\t * the comparator would have to call memcmp() with a pair of pointers to\n\t * the first byte of each abbreviated key, which is slower.\n\t */\n\tres = DatumBigEndianToNative(res);\n\n\treturn res;\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_fast_cmp(Datum x, Datum y, SortSupport ssup);",
      "static int\tuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup);",
      "static bool uuid_abbrev_abort(int memtupcount, SortSupport ssup);",
      "static Datum uuid_abbrev_convert(Datum original, SortSupport ssup);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DatumBigEndianToNative",
          "args": [
            "res"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addHyperLogLog",
          "args": [
            "&uss->abbr_card",
            "DatumGetUInt32(hash_uint32(tmp))"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetUInt32",
          "args": [
            "hash_uint32(tmp)"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_uint32",
          "args": [
            "tmp"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "(uint64) res >> 32"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&res",
            "authoritative->data",
            "sizeof(Datum)"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetUUIDP",
          "args": [
            "original"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_fast_cmp(Datum x, Datum y, SortSupport ssup);\nstatic int\tuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup);\nstatic bool uuid_abbrev_abort(int memtupcount, SortSupport ssup);\nstatic Datum uuid_abbrev_convert(Datum original, SortSupport ssup);\n\nstatic Datum\nuuid_abbrev_convert(Datum original, SortSupport ssup)\n{\n\tuuid_sortsupport_state *uss = ssup->ssup_extra;\n\tpg_uuid_t  *authoritative = DatumGetUUIDP(original);\n\tDatum\t\tres;\n\n\tmemcpy(&res, authoritative->data, sizeof(Datum));\n\tuss->input_count += 1;\n\n\tif (uss->estimating)\n\t{\n\t\tuint32\t\ttmp;\n\n#if SIZEOF_DATUM == 8\n\t\ttmp = (uint32) res ^ (uint32) ((uint64) res >> 32);\n#else\t\t\t\t\t\t\t/* SIZEOF_DATUM != 8 */\n\t\ttmp = (uint32) res;\n#endif\n\n\t\taddHyperLogLog(&uss->abbr_card, DatumGetUInt32(hash_uint32(tmp)));\n\t}\n\n\t/*\n\t * Byteswap on little-endian machines.\n\t *\n\t * This is needed so that uuid_cmp_abbrev() (an unsigned integer 3-way\n\t * comparator) works correctly on all platforms.  If we didn't do this,\n\t * the comparator would have to call memcmp() with a pair of pointers to\n\t * the first byte of each abbreviated key, which is slower.\n\t */\n\tres = DatumBigEndianToNative(res);\n\n\treturn res;\n}"
  },
  {
    "function_name": "uuid_abbrev_abort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "301-358",
    "snippet": "static bool\nuuid_abbrev_abort(int memtupcount, SortSupport ssup)\n{\n\tuuid_sortsupport_state *uss = ssup->ssup_extra;\n\tdouble\t\tabbr_card;\n\n\tif (memtupcount < 10000 || uss->input_count < 10000 || !uss->estimating)\n\t\treturn false;\n\n\tabbr_card = estimateHyperLogLog(&uss->abbr_card);\n\n\t/*\n\t * If we have >100k distinct values, then even if we were sorting many\n\t * billion rows we'd likely still break even, and the penalty of undoing\n\t * that many rows of abbrevs would probably not be worth it.  Stop even\n\t * counting at that point.\n\t */\n\tif (abbr_card > 100000.0)\n\t{\n#ifdef TRACE_SORT\n\t\tif (trace_sort)\n\t\t\telog(LOG,\n\t\t\t\t \"uuid_abbrev: estimation ends at cardinality %f\"\n\t\t\t\t \" after \" INT64_FORMAT \" values (%d rows)\",\n\t\t\t\t abbr_card, uss->input_count, memtupcount);\n#endif\n\t\tuss->estimating = false;\n\t\treturn false;\n\t}\n\n\t/*\n\t * Target minimum cardinality is 1 per ~2k of non-null inputs.  0.5 row\n\t * fudge factor allows us to abort earlier on genuinely pathological data\n\t * where we've had exactly one abbreviated value in the first 2k\n\t * (non-null) rows.\n\t */\n\tif (abbr_card < uss->input_count / 2000.0 + 0.5)\n\t{\n#ifdef TRACE_SORT\n\t\tif (trace_sort)\n\t\t\telog(LOG,\n\t\t\t\t \"uuid_abbrev: aborting abbreviation at cardinality %f\"\n\t\t\t\t \" below threshold %f after \" INT64_FORMAT \" values (%d rows)\",\n\t\t\t\t abbr_card, uss->input_count / 2000.0 + 0.5, uss->input_count,\n\t\t\t\t memtupcount);\n#endif\n\t\treturn true;\n\t}\n\n#ifdef TRACE_SORT\n\tif (trace_sort)\n\t\telog(LOG,\n\t\t\t \"uuid_abbrev: cardinality %f after \" INT64_FORMAT\n\t\t\t \" values (%d rows)\", abbr_card, uss->input_count, memtupcount);\n#endif\n\n\treturn false;\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_fast_cmp(Datum x, Datum y, SortSupport ssup);",
      "static int\tuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup);",
      "static bool uuid_abbrev_abort(int memtupcount, SortSupport ssup);",
      "static Datum uuid_abbrev_convert(Datum original, SortSupport ssup);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "LOG",
            "\"uuid_abbrev: cardinality %f after \" INT64_FORMAT\n\t\t\t \" values (%d rows)\"",
            "abbr_card",
            "uss->input_count",
            "memtupcount"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "estimateHyperLogLog",
          "args": [
            "&uss->abbr_card"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_fast_cmp(Datum x, Datum y, SortSupport ssup);\nstatic int\tuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup);\nstatic bool uuid_abbrev_abort(int memtupcount, SortSupport ssup);\nstatic Datum uuid_abbrev_convert(Datum original, SortSupport ssup);\n\nstatic bool\nuuid_abbrev_abort(int memtupcount, SortSupport ssup)\n{\n\tuuid_sortsupport_state *uss = ssup->ssup_extra;\n\tdouble\t\tabbr_card;\n\n\tif (memtupcount < 10000 || uss->input_count < 10000 || !uss->estimating)\n\t\treturn false;\n\n\tabbr_card = estimateHyperLogLog(&uss->abbr_card);\n\n\t/*\n\t * If we have >100k distinct values, then even if we were sorting many\n\t * billion rows we'd likely still break even, and the penalty of undoing\n\t * that many rows of abbrevs would probably not be worth it.  Stop even\n\t * counting at that point.\n\t */\n\tif (abbr_card > 100000.0)\n\t{\n#ifdef TRACE_SORT\n\t\tif (trace_sort)\n\t\t\telog(LOG,\n\t\t\t\t \"uuid_abbrev: estimation ends at cardinality %f\"\n\t\t\t\t \" after \" INT64_FORMAT \" values (%d rows)\",\n\t\t\t\t abbr_card, uss->input_count, memtupcount);\n#endif\n\t\tuss->estimating = false;\n\t\treturn false;\n\t}\n\n\t/*\n\t * Target minimum cardinality is 1 per ~2k of non-null inputs.  0.5 row\n\t * fudge factor allows us to abort earlier on genuinely pathological data\n\t * where we've had exactly one abbreviated value in the first 2k\n\t * (non-null) rows.\n\t */\n\tif (abbr_card < uss->input_count / 2000.0 + 0.5)\n\t{\n#ifdef TRACE_SORT\n\t\tif (trace_sort)\n\t\t\telog(LOG,\n\t\t\t\t \"uuid_abbrev: aborting abbreviation at cardinality %f\"\n\t\t\t\t \" below threshold %f after \" INT64_FORMAT \" values (%d rows)\",\n\t\t\t\t abbr_card, uss->input_count / 2000.0 + 0.5, uss->input_count,\n\t\t\t\t memtupcount);\n#endif\n\t\treturn true;\n\t}\n\n#ifdef TRACE_SORT\n\tif (trace_sort)\n\t\telog(LOG,\n\t\t\t \"uuid_abbrev: cardinality %f after \" INT64_FORMAT\n\t\t\t \" values (%d rows)\", abbr_card, uss->input_count, memtupcount);\n#endif\n\n\treturn false;\n}"
  },
  {
    "function_name": "uuid_cmp_abbrev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "284-293",
    "snippet": "static int\nuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup)\n{\n\tif (x > y)\n\t\treturn 1;\n\telse if (x == y)\n\t\treturn 0;\n\telse\n\t\treturn -1;\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_fast_cmp(Datum x, Datum y, SortSupport ssup);",
      "static int\tuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup);",
      "static bool uuid_abbrev_abort(int memtupcount, SortSupport ssup);",
      "static Datum uuid_abbrev_convert(Datum original, SortSupport ssup);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_fast_cmp(Datum x, Datum y, SortSupport ssup);\nstatic int\tuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup);\nstatic bool uuid_abbrev_abort(int memtupcount, SortSupport ssup);\nstatic Datum uuid_abbrev_convert(Datum original, SortSupport ssup);\n\nstatic int\nuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup)\n{\n\tif (x > y)\n\t\treturn 1;\n\telse if (x == y)\n\t\treturn 0;\n\telse\n\t\treturn -1;\n}"
  },
  {
    "function_name": "uuid_fast_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "272-279",
    "snippet": "static int\nuuid_fast_cmp(Datum x, Datum y, SortSupport ssup)\n{\n\tpg_uuid_t  *arg1 = DatumGetUUIDP(x);\n\tpg_uuid_t  *arg2 = DatumGetUUIDP(y);\n\n\treturn uuid_internal_cmp(arg1, arg2);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);",
      "static int\tuuid_fast_cmp(Datum x, Datum y, SortSupport ssup);",
      "static int\tuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup);",
      "static bool uuid_abbrev_abort(int memtupcount, SortSupport ssup);",
      "static Datum uuid_abbrev_convert(Datum original, SortSupport ssup);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "uuid_internal_cmp",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_internal_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
          "lines": "163-167",
          "snippet": "static int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}",
          "includes": [
            "#include \"utils/uuid.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nstatic int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DatumGetUUIDP",
          "args": [
            "y"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetUUIDP",
          "args": [
            "x"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\nstatic int\tuuid_fast_cmp(Datum x, Datum y, SortSupport ssup);\nstatic int\tuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup);\nstatic bool uuid_abbrev_abort(int memtupcount, SortSupport ssup);\nstatic Datum uuid_abbrev_convert(Datum original, SortSupport ssup);\n\nstatic int\nuuid_fast_cmp(Datum x, Datum y, SortSupport ssup)\n{\n\tpg_uuid_t  *arg1 = DatumGetUUIDP(x);\n\tpg_uuid_t  *arg2 = DatumGetUUIDP(y);\n\n\treturn uuid_internal_cmp(arg1, arg2);\n}"
  },
  {
    "function_name": "uuid_sortsupport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "236-267",
    "snippet": "Datum\nuuid_sortsupport(PG_FUNCTION_ARGS)\n{\n\tSortSupport ssup = (SortSupport) PG_GETARG_POINTER(0);\n\n\tssup->comparator = uuid_fast_cmp;\n\tssup->ssup_extra = NULL;\n\n\tif (ssup->abbreviate)\n\t{\n\t\tuuid_sortsupport_state *uss;\n\t\tMemoryContext oldcontext;\n\n\t\toldcontext = MemoryContextSwitchTo(ssup->ssup_cxt);\n\n\t\tuss = palloc(sizeof(uuid_sortsupport_state));\n\t\tuss->input_count = 0;\n\t\tuss->estimating = true;\n\t\tinitHyperLogLog(&uss->abbr_card, 10);\n\n\t\tssup->ssup_extra = uss;\n\n\t\tssup->comparator = uuid_cmp_abbrev;\n\t\tssup->abbrev_converter = uuid_abbrev_convert;\n\t\tssup->abbrev_abort = uuid_abbrev_abort;\n\t\tssup->abbrev_full_comparator = uuid_fast_cmp;\n\n\t\tMemoryContextSwitchTo(oldcontext);\n\t}\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_fast_cmp(Datum x, Datum y, SortSupport ssup);",
      "static int\tuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup);",
      "static bool uuid_abbrev_abort(int memtupcount, SortSupport ssup);",
      "static Datum uuid_abbrev_convert(Datum original, SortSupport ssup);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "oldcontext"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initHyperLogLog",
          "args": [
            "&uss->abbr_card",
            "10"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(uuid_sortsupport_state)"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "ssup->ssup_cxt"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_fast_cmp(Datum x, Datum y, SortSupport ssup);\nstatic int\tuuid_cmp_abbrev(Datum x, Datum y, SortSupport ssup);\nstatic bool uuid_abbrev_abort(int memtupcount, SortSupport ssup);\nstatic Datum uuid_abbrev_convert(Datum original, SortSupport ssup);\n\nDatum\nuuid_sortsupport(PG_FUNCTION_ARGS)\n{\n\tSortSupport ssup = (SortSupport) PG_GETARG_POINTER(0);\n\n\tssup->comparator = uuid_fast_cmp;\n\tssup->ssup_extra = NULL;\n\n\tif (ssup->abbreviate)\n\t{\n\t\tuuid_sortsupport_state *uss;\n\t\tMemoryContext oldcontext;\n\n\t\toldcontext = MemoryContextSwitchTo(ssup->ssup_cxt);\n\n\t\tuss = palloc(sizeof(uuid_sortsupport_state));\n\t\tuss->input_count = 0;\n\t\tuss->estimating = true;\n\t\tinitHyperLogLog(&uss->abbr_card, 10);\n\n\t\tssup->ssup_extra = uss;\n\n\t\tssup->comparator = uuid_cmp_abbrev;\n\t\tssup->abbrev_converter = uuid_abbrev_convert;\n\t\tssup->abbrev_abort = uuid_abbrev_abort;\n\t\tssup->abbrev_full_comparator = uuid_fast_cmp;\n\n\t\tMemoryContextSwitchTo(oldcontext);\n\t}\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "uuid_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "224-231",
    "snippet": "Datum\nuuid_cmp(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_INT32(uuid_internal_cmp(arg1, arg2));\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "uuid_internal_cmp(arg1, arg2)"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uuid_internal_cmp",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_internal_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
          "lines": "163-167",
          "snippet": "static int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}",
          "includes": [
            "#include \"utils/uuid.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nstatic int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "1"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nDatum\nuuid_cmp(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_INT32(uuid_internal_cmp(arg1, arg2));\n}"
  },
  {
    "function_name": "uuid_ne",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "214-221",
    "snippet": "Datum\nuuid_ne(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) != 0);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "uuid_internal_cmp(arg1, arg2) != 0"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uuid_internal_cmp",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_internal_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
          "lines": "163-167",
          "snippet": "static int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}",
          "includes": [
            "#include \"utils/uuid.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nstatic int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "1"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nDatum\nuuid_ne(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) != 0);\n}"
  },
  {
    "function_name": "uuid_gt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "205-212",
    "snippet": "Datum\nuuid_gt(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) > 0);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "uuid_internal_cmp(arg1, arg2) > 0"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uuid_internal_cmp",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_internal_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
          "lines": "163-167",
          "snippet": "static int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}",
          "includes": [
            "#include \"utils/uuid.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nstatic int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "1"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nDatum\nuuid_gt(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) > 0);\n}"
  },
  {
    "function_name": "uuid_ge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "196-203",
    "snippet": "Datum\nuuid_ge(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) >= 0);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "uuid_internal_cmp(arg1, arg2) >= 0"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uuid_internal_cmp",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_internal_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
          "lines": "163-167",
          "snippet": "static int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}",
          "includes": [
            "#include \"utils/uuid.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nstatic int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "1"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nDatum\nuuid_ge(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) >= 0);\n}"
  },
  {
    "function_name": "uuid_eq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "187-194",
    "snippet": "Datum\nuuid_eq(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) == 0);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "uuid_internal_cmp(arg1, arg2) == 0"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uuid_internal_cmp",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_internal_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
          "lines": "163-167",
          "snippet": "static int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}",
          "includes": [
            "#include \"utils/uuid.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nstatic int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "1"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nDatum\nuuid_eq(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) == 0);\n}"
  },
  {
    "function_name": "uuid_le",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "178-185",
    "snippet": "Datum\nuuid_le(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) <= 0);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "uuid_internal_cmp(arg1, arg2) <= 0"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uuid_internal_cmp",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_internal_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
          "lines": "163-167",
          "snippet": "static int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}",
          "includes": [
            "#include \"utils/uuid.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nstatic int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "1"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nDatum\nuuid_le(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) <= 0);\n}"
  },
  {
    "function_name": "uuid_lt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "169-176",
    "snippet": "Datum\nuuid_lt(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) < 0);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "uuid_internal_cmp(arg1, arg2) < 0"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uuid_internal_cmp",
          "args": [
            "arg1",
            "arg2"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_internal_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
          "lines": "163-167",
          "snippet": "static int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}",
          "includes": [
            "#include \"utils/uuid.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nstatic int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "1"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nDatum\nuuid_lt(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *arg1 = PG_GETARG_UUID_P(0);\n\tpg_uuid_t  *arg2 = PG_GETARG_UUID_P(1);\n\n\tPG_RETURN_BOOL(uuid_internal_cmp(arg1, arg2) < 0);\n}"
  },
  {
    "function_name": "uuid_internal_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "163-167",
    "snippet": "static int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "arg1->data",
            "arg2->data",
            "UUID_LEN"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic int\tuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2);\n\nstatic int\nuuid_internal_cmp(const pg_uuid_t *arg1, const pg_uuid_t *arg2)\n{\n\treturn memcmp(arg1->data, arg2->data, UUID_LEN);\n}"
  },
  {
    "function_name": "uuid_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "151-160",
    "snippet": "Datum\nuuid_send(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *uuid = PG_GETARG_UUID_P(0);\n\tStringInfoData buffer;\n\n\tpq_begintypsend(&buffer);\n\tpq_sendbytes(&buffer, (char *) uuid->data, UUID_LEN);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buffer));\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void string_to_uuid(const char *source, pg_uuid_t *uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BYTEA_P",
          "args": [
            "pq_endtypsend(&buffer)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_endtypsend",
          "args": [
            "&buffer"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbytes",
          "args": [
            "&buffer",
            "(char *) uuid->data",
            "UUID_LEN"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_begintypsend",
          "args": [
            "&buffer"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic void string_to_uuid(const char *source, pg_uuid_t *uuid);\n\nDatum\nuuid_send(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *uuid = PG_GETARG_UUID_P(0);\n\tStringInfoData buffer;\n\n\tpq_begintypsend(&buffer);\n\tpq_sendbytes(&buffer, (char *) uuid->data, UUID_LEN);\n\tPG_RETURN_BYTEA_P(pq_endtypsend(&buffer));\n}"
  },
  {
    "function_name": "uuid_recv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "140-149",
    "snippet": "Datum\nuuid_recv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuffer = (StringInfo) PG_GETARG_POINTER(0);\n\tpg_uuid_t  *uuid;\n\n\tuuid = (pg_uuid_t *) palloc(UUID_LEN);\n\tmemcpy(uuid->data, pq_getmsgbytes(buffer, UUID_LEN), UUID_LEN);\n\tPG_RETURN_POINTER(uuid);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void string_to_uuid(const char *source, pg_uuid_t *uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_POINTER",
          "args": [
            "uuid"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "uuid->data",
            "pq_getmsgbytes(buffer, UUID_LEN)",
            "UUID_LEN"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbytes",
          "args": [
            "buffer",
            "UUID_LEN"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "UUID_LEN"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic void string_to_uuid(const char *source, pg_uuid_t *uuid);\n\nDatum\nuuid_recv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuffer = (StringInfo) PG_GETARG_POINTER(0);\n\tpg_uuid_t  *uuid;\n\n\tuuid = (pg_uuid_t *) palloc(UUID_LEN);\n\tmemcpy(uuid->data, pq_getmsgbytes(buffer, UUID_LEN), UUID_LEN);\n\tPG_RETURN_POINTER(uuid);\n}"
  },
  {
    "function_name": "string_to_uuid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "90-138",
    "snippet": "static void\nstring_to_uuid(const char *source, pg_uuid_t *uuid)\n{\n\tconst char *src = source;\n\tbool\t\tbraces = false;\n\tint\t\t\ti;\n\n\tif (src[0] == '{')\n\t{\n\t\tsrc++;\n\t\tbraces = true;\n\t}\n\n\tfor (i = 0; i < UUID_LEN; i++)\n\t{\n\t\tchar\t\tstr_buf[3];\n\n\t\tif (src[0] == '\\0' || src[1] == '\\0')\n\t\t\tgoto syntax_error;\n\t\tmemcpy(str_buf, src, 2);\n\t\tif (!isxdigit((unsigned char) str_buf[0]) ||\n\t\t\t!isxdigit((unsigned char) str_buf[1]))\n\t\t\tgoto syntax_error;\n\n\t\tstr_buf[2] = '\\0';\n\t\tuuid->data[i] = (unsigned char) strtoul(str_buf, NULL, 16);\n\t\tsrc += 2;\n\t\tif (src[0] == '-' && (i % 2) == 1 && i < UUID_LEN - 1)\n\t\t\tsrc++;\n\t}\n\n\tif (braces)\n\t{\n\t\tif (*src != '}')\n\t\t\tgoto syntax_error;\n\t\tsrc++;\n\t}\n\n\tif (*src != '\\0')\n\t\tgoto syntax_error;\n\n\treturn;\n\nsyntax_error:\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\"uuid\", source)));\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void string_to_uuid(const char *source, pg_uuid_t *uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\"uuid\", source))"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid input syntax for type %s: \\\"%s\\\"\"",
            "\"uuid\"",
            "source"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_TEXT_REPRESENTATION"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "str_buf",
            "NULL",
            "16"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isxdigit",
          "args": [
            "(unsigned char) str_buf[1]"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isxdigit",
          "args": [
            "(unsigned char) str_buf[0]"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "str_buf",
            "src",
            "2"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic void string_to_uuid(const char *source, pg_uuid_t *uuid);\n\nstatic void\nstring_to_uuid(const char *source, pg_uuid_t *uuid)\n{\n\tconst char *src = source;\n\tbool\t\tbraces = false;\n\tint\t\t\ti;\n\n\tif (src[0] == '{')\n\t{\n\t\tsrc++;\n\t\tbraces = true;\n\t}\n\n\tfor (i = 0; i < UUID_LEN; i++)\n\t{\n\t\tchar\t\tstr_buf[3];\n\n\t\tif (src[0] == '\\0' || src[1] == '\\0')\n\t\t\tgoto syntax_error;\n\t\tmemcpy(str_buf, src, 2);\n\t\tif (!isxdigit((unsigned char) str_buf[0]) ||\n\t\t\t!isxdigit((unsigned char) str_buf[1]))\n\t\t\tgoto syntax_error;\n\n\t\tstr_buf[2] = '\\0';\n\t\tuuid->data[i] = (unsigned char) strtoul(str_buf, NULL, 16);\n\t\tsrc += 2;\n\t\tif (src[0] == '-' && (i % 2) == 1 && i < UUID_LEN - 1)\n\t\t\tsrc++;\n\t}\n\n\tif (braces)\n\t{\n\t\tif (*src != '}')\n\t\t\tgoto syntax_error;\n\t\tsrc++;\n\t}\n\n\tif (*src != '\\0')\n\t\tgoto syntax_error;\n\n\treturn;\n\nsyntax_error:\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\"uuid\", source)));\n}"
  },
  {
    "function_name": "uuid_out",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "52-82",
    "snippet": "Datum\nuuid_out(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *uuid = PG_GETARG_UUID_P(0);\n\tstatic const char hex_chars[] = \"0123456789abcdef\";\n\tStringInfoData buf;\n\tint\t\t\ti;\n\n\tinitStringInfo(&buf);\n\tfor (i = 0; i < UUID_LEN; i++)\n\t{\n\t\tint\t\t\thi;\n\t\tint\t\t\tlo;\n\n\t\t/*\n\t\t * We print uuid values as a string of 8, 4, 4, 4, and then 12\n\t\t * hexadecimal characters, with each group is separated by a hyphen\n\t\t * (\"-\"). Therefore, add the hyphens at the appropriate places here.\n\t\t */\n\t\tif (i == 4 || i == 6 || i == 8 || i == 10)\n\t\t\tappendStringInfoChar(&buf, '-');\n\n\t\thi = uuid->data[i] >> 4;\n\t\tlo = uuid->data[i] & 0x0F;\n\n\t\tappendStringInfoChar(&buf, hex_chars[hi]);\n\t\tappendStringInfoChar(&buf, hex_chars[lo]);\n\t}\n\n\tPG_RETURN_CSTRING(buf.data);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void string_to_uuid(const char *source, pg_uuid_t *uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_CSTRING",
          "args": [
            "buf.data"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appendStringInfoChar",
          "args": [
            "&buf",
            "hex_chars[lo]"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appendStringInfoChar",
          "args": [
            "&buf",
            "hex_chars[hi]"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appendStringInfoChar",
          "args": [
            "&buf",
            "'-'"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initStringInfo",
          "args": [
            "&buf"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_UUID_P",
          "args": [
            "0"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic void string_to_uuid(const char *source, pg_uuid_t *uuid);\n\nDatum\nuuid_out(PG_FUNCTION_ARGS)\n{\n\tpg_uuid_t  *uuid = PG_GETARG_UUID_P(0);\n\tstatic const char hex_chars[] = \"0123456789abcdef\";\n\tStringInfoData buf;\n\tint\t\t\ti;\n\n\tinitStringInfo(&buf);\n\tfor (i = 0; i < UUID_LEN; i++)\n\t{\n\t\tint\t\t\thi;\n\t\tint\t\t\tlo;\n\n\t\t/*\n\t\t * We print uuid values as a string of 8, 4, 4, 4, and then 12\n\t\t * hexadecimal characters, with each group is separated by a hyphen\n\t\t * (\"-\"). Therefore, add the hyphens at the appropriate places here.\n\t\t */\n\t\tif (i == 4 || i == 6 || i == 8 || i == 10)\n\t\t\tappendStringInfoChar(&buf, '-');\n\n\t\thi = uuid->data[i] >> 4;\n\t\tlo = uuid->data[i] & 0x0F;\n\n\t\tappendStringInfoChar(&buf, hex_chars[hi]);\n\t\tappendStringInfoChar(&buf, hex_chars[lo]);\n\t}\n\n\tPG_RETURN_CSTRING(buf.data);\n}"
  },
  {
    "function_name": "uuid_in",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
    "lines": "41-50",
    "snippet": "Datum\nuuid_in(PG_FUNCTION_ARGS)\n{\n\tchar\t   *uuid_str = PG_GETARG_CSTRING(0);\n\tpg_uuid_t  *uuid;\n\n\tuuid = (pg_uuid_t *) palloc(sizeof(*uuid));\n\tstring_to_uuid(uuid_str, uuid);\n\tPG_RETURN_UUID_P(uuid);\n}",
    "includes": [
      "#include \"utils/uuid.h\"",
      "#include \"utils/sortsupport.h\"",
      "#include \"utils/guc.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"port/pg_bswap.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"lib/hyperloglog.h\"",
      "#include \"access/hash.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void string_to_uuid(const char *source, pg_uuid_t *uuid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_UUID_P",
          "args": [
            "uuid"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "string_to_uuid",
          "args": [
            "uuid_str",
            "uuid"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "string_to_uuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/uuid.c",
          "lines": "90-138",
          "snippet": "static void\nstring_to_uuid(const char *source, pg_uuid_t *uuid)\n{\n\tconst char *src = source;\n\tbool\t\tbraces = false;\n\tint\t\t\ti;\n\n\tif (src[0] == '{')\n\t{\n\t\tsrc++;\n\t\tbraces = true;\n\t}\n\n\tfor (i = 0; i < UUID_LEN; i++)\n\t{\n\t\tchar\t\tstr_buf[3];\n\n\t\tif (src[0] == '\\0' || src[1] == '\\0')\n\t\t\tgoto syntax_error;\n\t\tmemcpy(str_buf, src, 2);\n\t\tif (!isxdigit((unsigned char) str_buf[0]) ||\n\t\t\t!isxdigit((unsigned char) str_buf[1]))\n\t\t\tgoto syntax_error;\n\n\t\tstr_buf[2] = '\\0';\n\t\tuuid->data[i] = (unsigned char) strtoul(str_buf, NULL, 16);\n\t\tsrc += 2;\n\t\tif (src[0] == '-' && (i % 2) == 1 && i < UUID_LEN - 1)\n\t\t\tsrc++;\n\t}\n\n\tif (braces)\n\t{\n\t\tif (*src != '}')\n\t\t\tgoto syntax_error;\n\t\tsrc++;\n\t}\n\n\tif (*src != '\\0')\n\t\tgoto syntax_error;\n\n\treturn;\n\nsyntax_error:\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\"uuid\", source)));\n}",
          "includes": [
            "#include \"utils/uuid.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void string_to_uuid(const char *source, pg_uuid_t *uuid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic void string_to_uuid(const char *source, pg_uuid_t *uuid);\n\nstatic void\nstring_to_uuid(const char *source, pg_uuid_t *uuid)\n{\n\tconst char *src = source;\n\tbool\t\tbraces = false;\n\tint\t\t\ti;\n\n\tif (src[0] == '{')\n\t{\n\t\tsrc++;\n\t\tbraces = true;\n\t}\n\n\tfor (i = 0; i < UUID_LEN; i++)\n\t{\n\t\tchar\t\tstr_buf[3];\n\n\t\tif (src[0] == '\\0' || src[1] == '\\0')\n\t\t\tgoto syntax_error;\n\t\tmemcpy(str_buf, src, 2);\n\t\tif (!isxdigit((unsigned char) str_buf[0]) ||\n\t\t\t!isxdigit((unsigned char) str_buf[1]))\n\t\t\tgoto syntax_error;\n\n\t\tstr_buf[2] = '\\0';\n\t\tuuid->data[i] = (unsigned char) strtoul(str_buf, NULL, 16);\n\t\tsrc += 2;\n\t\tif (src[0] == '-' && (i % 2) == 1 && i < UUID_LEN - 1)\n\t\t\tsrc++;\n\t}\n\n\tif (braces)\n\t{\n\t\tif (*src != '}')\n\t\t\tgoto syntax_error;\n\t\tsrc++;\n\t}\n\n\tif (*src != '\\0')\n\t\tgoto syntax_error;\n\n\treturn;\n\nsyntax_error:\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\"uuid\", source)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(*uuid)"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "0"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/uuid.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"port/pg_bswap.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nstatic void string_to_uuid(const char *source, pg_uuid_t *uuid);\n\nDatum\nuuid_in(PG_FUNCTION_ARGS)\n{\n\tchar\t   *uuid_str = PG_GETARG_CSTRING(0);\n\tpg_uuid_t  *uuid;\n\n\tuuid = (pg_uuid_t *) palloc(sizeof(*uuid));\n\tstring_to_uuid(uuid_str, uuid);\n\tPG_RETURN_UUID_P(uuid);\n}"
  }
]