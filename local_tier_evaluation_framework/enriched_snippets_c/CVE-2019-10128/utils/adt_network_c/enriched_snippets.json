[
  {
    "function_name": "clean_ipv6_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1510-1522",
    "snippet": "void\nclean_ipv6_addr(int addr_family, char *addr)\n{\n#ifdef HAVE_IPV6\n\tif (addr_family == AF_INET6)\n\t{\n\t\tchar\t   *pct = strchr(addr, '%');\n\n\t\tif (pct)\n\t\t\t*pct = '\\0';\n\t}\n#endif\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "addr",
            "'%'"
          ],
          "line": 1516
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nvoid\nclean_ipv6_addr(int addr_family, char *addr)\n{\n#ifdef HAVE_IPV6\n\tif (addr_family == AF_INET6)\n\t{\n\t\tchar\t   *pct = strchr(addr, '%');\n\n\t\tif (pct)\n\t\t\t*pct = '\\0';\n\t}\n#endif\n}"
  },
  {
    "function_name": "inetmi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1433-1493",
    "snippet": "Datum\ninetmi(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *ip2 = PG_GETARG_INET_PP(1);\n\tint64\t\tres = 0;\n\n\tif (ip_family(ip) != ip_family(ip2))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot subtract inet values of different sizes\")));\n\telse\n\t{\n\t\t/*\n\t\t * We form the difference using the traditional complement, increment,\n\t\t * and add rule, with the increment part being handled by starting the\n\t\t * carry off at 1.  If you don't think integer arithmetic is done in\n\t\t * two's complement, too bad.\n\t\t */\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tint\t\t\tbyte = 0;\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pip2 = ip_addr(ip2);\n\t\tint\t\t\tcarry = 1;\n\n\t\twhile (nb-- > 0)\n\t\t{\n\t\t\tint\t\t\tlobyte;\n\n\t\t\tcarry = pip[nb] + (~pip2[nb] & 0xFF) + carry;\n\t\t\tlobyte = carry & 0xFF;\n\t\t\tif (byte < sizeof(int64))\n\t\t\t{\n\t\t\t\tres |= ((int64) lobyte) << (byte * 8);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t/*\n\t\t\t\t * Input wider than int64: check for overflow.  All bytes to\n\t\t\t\t * the left of what will fit should be 0 or 0xFF, depending on\n\t\t\t\t * sign of the now-complete result.\n\t\t\t\t */\n\t\t\t\tif ((res < 0) ? (lobyte != 0xFF) : (lobyte != 0))\n\t\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t\t(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t\t\t\t errmsg(\"result is out of range\")));\n\t\t\t}\n\t\t\tcarry >>= 8;\n\t\t\tbyte++;\n\t\t}\n\n\t\t/*\n\t\t * If input is narrower than int64, overflow is not possible, but we\n\t\t * have to do proper sign extension.\n\t\t */\n\t\tif (carry == 0 && byte < sizeof(int64))\n\t\t\tres |= ((uint64) (int64) -1) << (byte * 8);\n\t}\n\n\tPG_RETURN_INT64(res);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "res"
          ],
          "line": 1492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "int64"
          ],
          "line": 1489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t\t\t\t errmsg(\"result is out of range\"))"
          ],
          "line": 1476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"result is out of range\""
          ],
          "line": 1478
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE"
          ],
          "line": 1477
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip2"
          ],
          "line": 1455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 1454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "ip"
          ],
          "line": 1452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot subtract inet values of different sizes\"))"
          ],
          "line": 1441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip2"
          ],
          "line": 1440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 1440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 1437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 1436
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninetmi(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *ip2 = PG_GETARG_INET_PP(1);\n\tint64\t\tres = 0;\n\n\tif (ip_family(ip) != ip_family(ip2))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot subtract inet values of different sizes\")));\n\telse\n\t{\n\t\t/*\n\t\t * We form the difference using the traditional complement, increment,\n\t\t * and add rule, with the increment part being handled by starting the\n\t\t * carry off at 1.  If you don't think integer arithmetic is done in\n\t\t * two's complement, too bad.\n\t\t */\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tint\t\t\tbyte = 0;\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pip2 = ip_addr(ip2);\n\t\tint\t\t\tcarry = 1;\n\n\t\twhile (nb-- > 0)\n\t\t{\n\t\t\tint\t\t\tlobyte;\n\n\t\t\tcarry = pip[nb] + (~pip2[nb] & 0xFF) + carry;\n\t\t\tlobyte = carry & 0xFF;\n\t\t\tif (byte < sizeof(int64))\n\t\t\t{\n\t\t\t\tres |= ((int64) lobyte) << (byte * 8);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t/*\n\t\t\t\t * Input wider than int64: check for overflow.  All bytes to\n\t\t\t\t * the left of what will fit should be 0 or 0xFF, depending on\n\t\t\t\t * sign of the now-complete result.\n\t\t\t\t */\n\t\t\t\tif ((res < 0) ? (lobyte != 0xFF) : (lobyte != 0))\n\t\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t\t(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t\t\t\t errmsg(\"result is out of range\")));\n\t\t\t}\n\t\t\tcarry >>= 8;\n\t\t\tbyte++;\n\t\t}\n\n\t\t/*\n\t\t * If input is narrower than int64, overflow is not possible, but we\n\t\t * have to do proper sign extension.\n\t\t */\n\t\tif (carry == 0 && byte < sizeof(int64))\n\t\t\tres |= ((uint64) (int64) -1) << (byte * 8);\n\t}\n\n\tPG_RETURN_INT64(res);\n}"
  },
  {
    "function_name": "inetmi_int8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1423-1430",
    "snippet": "Datum\ninetmi_int8(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tint64\t\taddend = PG_GETARG_INT64(1);\n\n\tPG_RETURN_INET_P(internal_inetpl(ip, -addend));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static inet *internal_inetpl(inet *ip, int64 addend);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "internal_inetpl(ip, -addend)"
          ],
          "line": 1429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "internal_inetpl",
          "args": [
            "ip",
            "-addend"
          ],
          "line": 1429
        },
        "resolved": true,
        "details": {
          "function_name": "internal_inetpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "1361-1410",
          "snippet": "static inet *\ninternal_inetpl(inet *ip, int64 addend)\n{\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pdst = ip_addr(dst);\n\t\tint\t\t\tcarry = 0;\n\n\t\twhile (nb-- > 0)\n\t\t{\n\t\t\tcarry = pip[nb] + (int) (addend & 0xFF) + carry;\n\t\t\tpdst[nb] = (unsigned char) (carry & 0xFF);\n\t\t\tcarry >>= 8;\n\n\t\t\t/*\n\t\t\t * We have to be careful about right-shifting addend because\n\t\t\t * right-shift isn't portable for negative values, while simply\n\t\t\t * dividing by 256 doesn't work (the standard rounding is in the\n\t\t\t * wrong direction, besides which there may be machines out there\n\t\t\t * that round the wrong way).  So, explicitly clear the low-order\n\t\t\t * byte to remove any doubt about the correct result of the\n\t\t\t * division, and then divide rather than shift.\n\t\t\t */\n\t\t\taddend &= ~((int64) 0xFF);\n\t\t\taddend /= 0x100;\n\t\t}\n\n\t\t/*\n\t\t * At this point we should have addend and carry both zero if original\n\t\t * addend was >= 0, or addend -1 and carry 1 if original addend was <\n\t\t * 0.  Anything else means overflow.\n\t\t */\n\t\tif (!((addend == 0 && carry == 0) ||\n\t\t\t  (addend == -1 && carry == 1)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t\t errmsg(\"result is out of range\")));\n\t}\n\n\tip_bits(dst) = ip_bits(ip);\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static inet *internal_inetpl(inet *ip, int64 addend);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic inet *internal_inetpl(inet *ip, int64 addend);\n\nstatic inet *\ninternal_inetpl(inet *ip, int64 addend)\n{\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pdst = ip_addr(dst);\n\t\tint\t\t\tcarry = 0;\n\n\t\twhile (nb-- > 0)\n\t\t{\n\t\t\tcarry = pip[nb] + (int) (addend & 0xFF) + carry;\n\t\t\tpdst[nb] = (unsigned char) (carry & 0xFF);\n\t\t\tcarry >>= 8;\n\n\t\t\t/*\n\t\t\t * We have to be careful about right-shifting addend because\n\t\t\t * right-shift isn't portable for negative values, while simply\n\t\t\t * dividing by 256 doesn't work (the standard rounding is in the\n\t\t\t * wrong direction, besides which there may be machines out there\n\t\t\t * that round the wrong way).  So, explicitly clear the low-order\n\t\t\t * byte to remove any doubt about the correct result of the\n\t\t\t * division, and then divide rather than shift.\n\t\t\t */\n\t\t\taddend &= ~((int64) 0xFF);\n\t\t\taddend /= 0x100;\n\t\t}\n\n\t\t/*\n\t\t * At this point we should have addend and carry both zero if original\n\t\t * addend was >= 0, or addend -1 and carry 1 if original addend was <\n\t\t * 0.  Anything else means overflow.\n\t\t */\n\t\tif (!((addend == 0 && carry == 0) ||\n\t\t\t  (addend == -1 && carry == 1)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t\t errmsg(\"result is out of range\")));\n\t}\n\n\tip_bits(dst) = ip_bits(ip);\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT64",
          "args": [
            "1"
          ],
          "line": 1427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 1426
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic inet *internal_inetpl(inet *ip, int64 addend);\n\nDatum\ninetmi_int8(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tint64\t\taddend = PG_GETARG_INT64(1);\n\n\tPG_RETURN_INET_P(internal_inetpl(ip, -addend));\n}"
  },
  {
    "function_name": "inetpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1413-1420",
    "snippet": "Datum\ninetpl(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tint64\t\taddend = PG_GETARG_INT64(1);\n\n\tPG_RETURN_INET_P(internal_inetpl(ip, addend));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static inet *internal_inetpl(inet *ip, int64 addend);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "internal_inetpl(ip, addend)"
          ],
          "line": 1419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "internal_inetpl",
          "args": [
            "ip",
            "addend"
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "internal_inetpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "1361-1410",
          "snippet": "static inet *\ninternal_inetpl(inet *ip, int64 addend)\n{\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pdst = ip_addr(dst);\n\t\tint\t\t\tcarry = 0;\n\n\t\twhile (nb-- > 0)\n\t\t{\n\t\t\tcarry = pip[nb] + (int) (addend & 0xFF) + carry;\n\t\t\tpdst[nb] = (unsigned char) (carry & 0xFF);\n\t\t\tcarry >>= 8;\n\n\t\t\t/*\n\t\t\t * We have to be careful about right-shifting addend because\n\t\t\t * right-shift isn't portable for negative values, while simply\n\t\t\t * dividing by 256 doesn't work (the standard rounding is in the\n\t\t\t * wrong direction, besides which there may be machines out there\n\t\t\t * that round the wrong way).  So, explicitly clear the low-order\n\t\t\t * byte to remove any doubt about the correct result of the\n\t\t\t * division, and then divide rather than shift.\n\t\t\t */\n\t\t\taddend &= ~((int64) 0xFF);\n\t\t\taddend /= 0x100;\n\t\t}\n\n\t\t/*\n\t\t * At this point we should have addend and carry both zero if original\n\t\t * addend was >= 0, or addend -1 and carry 1 if original addend was <\n\t\t * 0.  Anything else means overflow.\n\t\t */\n\t\tif (!((addend == 0 && carry == 0) ||\n\t\t\t  (addend == -1 && carry == 1)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t\t errmsg(\"result is out of range\")));\n\t}\n\n\tip_bits(dst) = ip_bits(ip);\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static inet *internal_inetpl(inet *ip, int64 addend);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic inet *internal_inetpl(inet *ip, int64 addend);\n\nstatic inet *\ninternal_inetpl(inet *ip, int64 addend)\n{\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pdst = ip_addr(dst);\n\t\tint\t\t\tcarry = 0;\n\n\t\twhile (nb-- > 0)\n\t\t{\n\t\t\tcarry = pip[nb] + (int) (addend & 0xFF) + carry;\n\t\t\tpdst[nb] = (unsigned char) (carry & 0xFF);\n\t\t\tcarry >>= 8;\n\n\t\t\t/*\n\t\t\t * We have to be careful about right-shifting addend because\n\t\t\t * right-shift isn't portable for negative values, while simply\n\t\t\t * dividing by 256 doesn't work (the standard rounding is in the\n\t\t\t * wrong direction, besides which there may be machines out there\n\t\t\t * that round the wrong way).  So, explicitly clear the low-order\n\t\t\t * byte to remove any doubt about the correct result of the\n\t\t\t * division, and then divide rather than shift.\n\t\t\t */\n\t\t\taddend &= ~((int64) 0xFF);\n\t\t\taddend /= 0x100;\n\t\t}\n\n\t\t/*\n\t\t * At this point we should have addend and carry both zero if original\n\t\t * addend was >= 0, or addend -1 and carry 1 if original addend was <\n\t\t * 0.  Anything else means overflow.\n\t\t */\n\t\tif (!((addend == 0 && carry == 0) ||\n\t\t\t  (addend == -1 && carry == 1)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t\t errmsg(\"result is out of range\")));\n\t}\n\n\tip_bits(dst) = ip_bits(ip);\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT64",
          "args": [
            "1"
          ],
          "line": 1417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 1416
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic inet *internal_inetpl(inet *ip, int64 addend);\n\nDatum\ninetpl(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tint64\t\taddend = PG_GETARG_INT64(1);\n\n\tPG_RETURN_INET_P(internal_inetpl(ip, addend));\n}"
  },
  {
    "function_name": "internal_inetpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1361-1410",
    "snippet": "static inet *\ninternal_inetpl(inet *ip, int64 addend)\n{\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pdst = ip_addr(dst);\n\t\tint\t\t\tcarry = 0;\n\n\t\twhile (nb-- > 0)\n\t\t{\n\t\t\tcarry = pip[nb] + (int) (addend & 0xFF) + carry;\n\t\t\tpdst[nb] = (unsigned char) (carry & 0xFF);\n\t\t\tcarry >>= 8;\n\n\t\t\t/*\n\t\t\t * We have to be careful about right-shifting addend because\n\t\t\t * right-shift isn't portable for negative values, while simply\n\t\t\t * dividing by 256 doesn't work (the standard rounding is in the\n\t\t\t * wrong direction, besides which there may be machines out there\n\t\t\t * that round the wrong way).  So, explicitly clear the low-order\n\t\t\t * byte to remove any doubt about the correct result of the\n\t\t\t * division, and then divide rather than shift.\n\t\t\t */\n\t\t\taddend &= ~((int64) 0xFF);\n\t\t\taddend /= 0x100;\n\t\t}\n\n\t\t/*\n\t\t * At this point we should have addend and carry both zero if original\n\t\t * addend was >= 0, or addend -1 and carry 1 if original addend was <\n\t\t * 0.  Anything else means overflow.\n\t\t */\n\t\tif (!((addend == 0 && carry == 0) ||\n\t\t\t  (addend == -1 && carry == 1)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t\t errmsg(\"result is out of range\")));\n\t}\n\n\tip_bits(dst) = ip_bits(ip);\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static inet *internal_inetpl(inet *ip, int64 addend);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "dst"
          ],
          "line": 1407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 1406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 1406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 1405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 1405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t\t errmsg(\"result is out of range\"))"
          ],
          "line": 1400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"result is out of range\""
          ],
          "line": 1402
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE"
          ],
          "line": 1401
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 1371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "ip"
          ],
          "line": 1369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 1366
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic inet *internal_inetpl(inet *ip, int64 addend);\n\nstatic inet *\ninternal_inetpl(inet *ip, int64 addend)\n{\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pdst = ip_addr(dst);\n\t\tint\t\t\tcarry = 0;\n\n\t\twhile (nb-- > 0)\n\t\t{\n\t\t\tcarry = pip[nb] + (int) (addend & 0xFF) + carry;\n\t\t\tpdst[nb] = (unsigned char) (carry & 0xFF);\n\t\t\tcarry >>= 8;\n\n\t\t\t/*\n\t\t\t * We have to be careful about right-shifting addend because\n\t\t\t * right-shift isn't portable for negative values, while simply\n\t\t\t * dividing by 256 doesn't work (the standard rounding is in the\n\t\t\t * wrong direction, besides which there may be machines out there\n\t\t\t * that round the wrong way).  So, explicitly clear the low-order\n\t\t\t * byte to remove any doubt about the correct result of the\n\t\t\t * division, and then divide rather than shift.\n\t\t\t */\n\t\t\taddend &= ~((int64) 0xFF);\n\t\t\taddend /= 0x100;\n\t\t}\n\n\t\t/*\n\t\t * At this point we should have addend and carry both zero if original\n\t\t * addend was >= 0, or addend -1 and carry 1 if original addend was <\n\t\t * 0.  Anything else means overflow.\n\t\t */\n\t\tif (!((addend == 0 && carry == 0) ||\n\t\t\t  (addend == -1 && carry == 1)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),\n\t\t\t\t\t errmsg(\"result is out of range\")));\n\t}\n\n\tip_bits(dst) = ip_bits(ip);\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
  },
  {
    "function_name": "inetor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1329-1358",
    "snippet": "Datum\ninetor(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *ip2 = PG_GETARG_INET_PP(1);\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tif (ip_family(ip) != ip_family(ip2))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot OR inet values of different sizes\")));\n\telse\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pip2 = ip_addr(ip2);\n\t\tunsigned char *pdst = ip_addr(dst);\n\n\t\twhile (nb-- > 0)\n\t\t\tpdst[nb] = pip[nb] | pip2[nb];\n\t}\n\tip_bits(dst) = Max(ip_bits(ip), ip_bits(ip2));\n\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "dst"
          ],
          "line": 1357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "dst"
          ],
          "line": 1355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Max",
          "args": [
            "ip_bits(ip)",
            "ip_bits(ip2)"
          ],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip2"
          ],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip2"
          ],
          "line": 1346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 1345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "ip"
          ],
          "line": 1344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot OR inet values of different sizes\"))"
          ],
          "line": 1339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"cannot OR inet values of different sizes\""
          ],
          "line": 1341
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_PARAMETER_VALUE"
          ],
          "line": 1340
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip2"
          ],
          "line": 1338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 1338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 1332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninetor(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *ip2 = PG_GETARG_INET_PP(1);\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tif (ip_family(ip) != ip_family(ip2))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot OR inet values of different sizes\")));\n\telse\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pip2 = ip_addr(ip2);\n\t\tunsigned char *pdst = ip_addr(dst);\n\n\t\twhile (nb-- > 0)\n\t\t\tpdst[nb] = pip[nb] | pip2[nb];\n\t}\n\tip_bits(dst) = Max(ip_bits(ip), ip_bits(ip2));\n\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}"
  },
  {
    "function_name": "inetand",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1297-1326",
    "snippet": "Datum\ninetand(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *ip2 = PG_GETARG_INET_PP(1);\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tif (ip_family(ip) != ip_family(ip2))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot AND inet values of different sizes\")));\n\telse\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pip2 = ip_addr(ip2);\n\t\tunsigned char *pdst = ip_addr(dst);\n\n\t\twhile (nb-- > 0)\n\t\t\tpdst[nb] = pip[nb] & pip2[nb];\n\t}\n\tip_bits(dst) = Max(ip_bits(ip), ip_bits(ip2));\n\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "dst"
          ],
          "line": 1325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "dst"
          ],
          "line": 1323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 1322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 1322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Max",
          "args": [
            "ip_bits(ip)",
            "ip_bits(ip2)"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip2"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 1315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip2"
          ],
          "line": 1314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 1313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "ip"
          ],
          "line": 1312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot AND inet values of different sizes\"))"
          ],
          "line": 1307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"cannot AND inet values of different sizes\""
          ],
          "line": 1309
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_PARAMETER_VALUE"
          ],
          "line": 1308
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip2"
          ],
          "line": 1306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 1306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 1304
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 1301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninetand(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *ip2 = PG_GETARG_INET_PP(1);\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tif (ip_family(ip) != ip_family(ip2))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot AND inet values of different sizes\")));\n\telse\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pip2 = ip_addr(ip2);\n\t\tunsigned char *pdst = ip_addr(dst);\n\n\t\twhile (nb-- > 0)\n\t\t\tpdst[nb] = pip[nb] & pip2[nb];\n\t}\n\tip_bits(dst) = Max(ip_bits(ip), ip_bits(ip2));\n\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}"
  },
  {
    "function_name": "inetnot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1272-1294",
    "snippet": "Datum\ninetnot(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pdst = ip_addr(dst);\n\n\t\twhile (nb-- > 0)\n\t\t\tpdst[nb] = ~pip[nb];\n\t}\n\tip_bits(dst) = ip_bits(ip);\n\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "dst"
          ],
          "line": 1293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "dst"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 1290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 1290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 1288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 1288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 1283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 1282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "ip"
          ],
          "line": 1281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 1278
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 1275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninetnot(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t{\n\t\tint\t\t\tnb = ip_addrsize(ip);\n\t\tunsigned char *pip = ip_addr(ip);\n\t\tunsigned char *pdst = ip_addr(dst);\n\n\t\twhile (nb-- > 0)\n\t\t\tpdst[nb] = ~pip[nb];\n\t}\n\tip_bits(dst) = ip_bits(ip);\n\n\tip_family(dst) = ip_family(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}"
  },
  {
    "function_name": "inet_server_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1238-1269",
    "snippet": "Datum\ninet_server_port(PG_FUNCTION_ARGS)\n{\n\tPort\t   *port = MyProcPort;\n\tchar\t\tlocal_port[NI_MAXSERV];\n\tint\t\t\tret;\n\n\tif (port == NULL)\n\t\tPG_RETURN_NULL();\n\n\tswitch (port->laddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tlocal_port[0] = '\\0';\n\n\tret = pg_getnameinfo_all(&port->laddr.addr, port->laddr.salen,\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t local_port, sizeof(local_port),\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_DATUM(DirectFunctionCall1(int4in, CStringGetDatum(local_port)));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_DATUM",
          "args": [
            "DirectFunctionCall1(int4in, CStringGetDatum(local_port))"
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectFunctionCall1",
          "args": [
            "int4in",
            "CStringGetDatum(local_port)"
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "local_port"
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_getnameinfo_all",
          "args": [
            "&port->laddr.addr",
            "port->laddr.salen",
            "NULL",
            "0",
            "local_port",
            "sizeof(local_port)",
            "NI_NUMERICHOST | NI_NUMERICSERV"
          ],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_server_port(PG_FUNCTION_ARGS)\n{\n\tPort\t   *port = MyProcPort;\n\tchar\t\tlocal_port[NI_MAXSERV];\n\tint\t\t\tret;\n\n\tif (port == NULL)\n\t\tPG_RETURN_NULL();\n\n\tswitch (port->laddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tlocal_port[0] = '\\0';\n\n\tret = pg_getnameinfo_all(&port->laddr.addr, port->laddr.salen,\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t local_port, sizeof(local_port),\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_DATUM(DirectFunctionCall1(int4in, CStringGetDatum(local_port)));\n}"
  },
  {
    "function_name": "inet_server_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1199-1232",
    "snippet": "Datum\ninet_server_addr(PG_FUNCTION_ARGS)\n{\n\tPort\t   *port = MyProcPort;\n\tchar\t\tlocal_host[NI_MAXHOST];\n\tint\t\t\tret;\n\n\tif (port == NULL)\n\t\tPG_RETURN_NULL();\n\n\tswitch (port->laddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tlocal_host[0] = '\\0';\n\n\tret = pg_getnameinfo_all(&port->laddr.addr, port->laddr.salen,\n\t\t\t\t\t\t\t local_host, sizeof(local_host),\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tclean_ipv6_addr(port->laddr.addr.ss_family, local_host);\n\n\tPG_RETURN_INET_P(network_in(local_host, false));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "network_in(local_host, false)"
          ],
          "line": 1231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_in",
          "args": [
            "local_host",
            "false"
          ],
          "line": 1231
        },
        "resolved": true,
        "details": {
          "function_name": "network_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "33-77",
          "snippet": "static inet *\nnetwork_in(char *src, bool is_cidr)\n{\n\tint\t\t\tbits;\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t/*\n\t * First, check to see if this is an IPv6 or IPv4 address.  IPv6 addresses\n\t * will have a : somewhere in them (several, in fact) so if there is one\n\t * present, assume it's V6, otherwise assume it's V4.\n\t */\n\n\tif (strchr(src, ':') != NULL)\n\t\tip_family(dst) = PGSQL_AF_INET6;\n\telse\n\t\tip_family(dst) = PGSQL_AF_INET;\n\n\tbits = inet_net_pton(ip_family(dst), src, ip_addr(dst),\n\t\t\t\t\t\t is_cidr ? ip_addrsize(dst) : -1);\n\tif ((bits < 0) || (bits > ip_maxbits(dst)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src)));\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(dst), bits, ip_family(dst)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tip_bits(dst) = bits;\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic inet *\nnetwork_in(char *src, bool is_cidr)\n{\n\tint\t\t\tbits;\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t/*\n\t * First, check to see if this is an IPv6 or IPv4 address.  IPv6 addresses\n\t * will have a : somewhere in them (several, in fact) so if there is one\n\t * present, assume it's V6, otherwise assume it's V4.\n\t */\n\n\tif (strchr(src, ':') != NULL)\n\t\tip_family(dst) = PGSQL_AF_INET6;\n\telse\n\t\tip_family(dst) = PGSQL_AF_INET;\n\n\tbits = inet_net_pton(ip_family(dst), src, ip_addr(dst),\n\t\t\t\t\t\t is_cidr ? ip_addrsize(dst) : -1);\n\tif ((bits < 0) || (bits > ip_maxbits(dst)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src)));\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(dst), bits, ip_family(dst)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tip_bits(dst) = bits;\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clean_ipv6_addr",
          "args": [
            "port->laddr.addr.ss_family",
            "local_host"
          ],
          "line": 1229
        },
        "resolved": true,
        "details": {
          "function_name": "clean_ipv6_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "1510-1522",
          "snippet": "void\nclean_ipv6_addr(int addr_family, char *addr)\n{\n#ifdef HAVE_IPV6\n\tif (addr_family == AF_INET6)\n\t{\n\t\tchar\t   *pct = strchr(addr, '%');\n\n\t\tif (pct)\n\t\t\t*pct = '\\0';\n\t}\n#endif\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nvoid\nclean_ipv6_addr(int addr_family, char *addr)\n{\n#ifdef HAVE_IPV6\n\tif (addr_family == AF_INET6)\n\t{\n\t\tchar\t   *pct = strchr(addr, '%');\n\n\t\tif (pct)\n\t\t\t*pct = '\\0';\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_getnameinfo_all",
          "args": [
            "&port->laddr.addr",
            "port->laddr.salen",
            "local_host",
            "sizeof(local_host)",
            "NULL",
            "0",
            "NI_NUMERICHOST | NI_NUMERICSERV"
          ],
          "line": 1222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_server_addr(PG_FUNCTION_ARGS)\n{\n\tPort\t   *port = MyProcPort;\n\tchar\t\tlocal_host[NI_MAXHOST];\n\tint\t\t\tret;\n\n\tif (port == NULL)\n\t\tPG_RETURN_NULL();\n\n\tswitch (port->laddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tlocal_host[0] = '\\0';\n\n\tret = pg_getnameinfo_all(&port->laddr.addr, port->laddr.salen,\n\t\t\t\t\t\t\t local_host, sizeof(local_host),\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tclean_ipv6_addr(port->laddr.addr.ss_family, local_host);\n\n\tPG_RETURN_INET_P(network_in(local_host, false));\n}"
  },
  {
    "function_name": "inet_client_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1162-1193",
    "snippet": "Datum\ninet_client_port(PG_FUNCTION_ARGS)\n{\n\tPort\t   *port = MyProcPort;\n\tchar\t\tremote_port[NI_MAXSERV];\n\tint\t\t\tret;\n\n\tif (port == NULL)\n\t\tPG_RETURN_NULL();\n\n\tswitch (port->raddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tremote_port[0] = '\\0';\n\n\tret = pg_getnameinfo_all(&port->raddr.addr, port->raddr.salen,\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t remote_port, sizeof(remote_port),\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_DATUM(DirectFunctionCall1(int4in, CStringGetDatum(remote_port)));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_DATUM",
          "args": [
            "DirectFunctionCall1(int4in, CStringGetDatum(remote_port))"
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectFunctionCall1",
          "args": [
            "int4in",
            "CStringGetDatum(remote_port)"
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "remote_port"
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_getnameinfo_all",
          "args": [
            "&port->raddr.addr",
            "port->raddr.salen",
            "NULL",
            "0",
            "remote_port",
            "sizeof(remote_port)",
            "NI_NUMERICHOST | NI_NUMERICSERV"
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_client_port(PG_FUNCTION_ARGS)\n{\n\tPort\t   *port = MyProcPort;\n\tchar\t\tremote_port[NI_MAXSERV];\n\tint\t\t\tret;\n\n\tif (port == NULL)\n\t\tPG_RETURN_NULL();\n\n\tswitch (port->raddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tremote_port[0] = '\\0';\n\n\tret = pg_getnameinfo_all(&port->raddr.addr, port->raddr.salen,\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t remote_port, sizeof(remote_port),\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_DATUM(DirectFunctionCall1(int4in, CStringGetDatum(remote_port)));\n}"
  },
  {
    "function_name": "inet_client_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1123-1156",
    "snippet": "Datum\ninet_client_addr(PG_FUNCTION_ARGS)\n{\n\tPort\t   *port = MyProcPort;\n\tchar\t\tremote_host[NI_MAXHOST];\n\tint\t\t\tret;\n\n\tif (port == NULL)\n\t\tPG_RETURN_NULL();\n\n\tswitch (port->raddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tremote_host[0] = '\\0';\n\n\tret = pg_getnameinfo_all(&port->raddr.addr, port->raddr.salen,\n\t\t\t\t\t\t\t remote_host, sizeof(remote_host),\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tclean_ipv6_addr(port->raddr.addr.ss_family, remote_host);\n\n\tPG_RETURN_INET_P(network_in(remote_host, false));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "network_in(remote_host, false)"
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_in",
          "args": [
            "remote_host",
            "false"
          ],
          "line": 1155
        },
        "resolved": true,
        "details": {
          "function_name": "network_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "33-77",
          "snippet": "static inet *\nnetwork_in(char *src, bool is_cidr)\n{\n\tint\t\t\tbits;\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t/*\n\t * First, check to see if this is an IPv6 or IPv4 address.  IPv6 addresses\n\t * will have a : somewhere in them (several, in fact) so if there is one\n\t * present, assume it's V6, otherwise assume it's V4.\n\t */\n\n\tif (strchr(src, ':') != NULL)\n\t\tip_family(dst) = PGSQL_AF_INET6;\n\telse\n\t\tip_family(dst) = PGSQL_AF_INET;\n\n\tbits = inet_net_pton(ip_family(dst), src, ip_addr(dst),\n\t\t\t\t\t\t is_cidr ? ip_addrsize(dst) : -1);\n\tif ((bits < 0) || (bits > ip_maxbits(dst)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src)));\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(dst), bits, ip_family(dst)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tip_bits(dst) = bits;\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic inet *\nnetwork_in(char *src, bool is_cidr)\n{\n\tint\t\t\tbits;\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t/*\n\t * First, check to see if this is an IPv6 or IPv4 address.  IPv6 addresses\n\t * will have a : somewhere in them (several, in fact) so if there is one\n\t * present, assume it's V6, otherwise assume it's V4.\n\t */\n\n\tif (strchr(src, ':') != NULL)\n\t\tip_family(dst) = PGSQL_AF_INET6;\n\telse\n\t\tip_family(dst) = PGSQL_AF_INET;\n\n\tbits = inet_net_pton(ip_family(dst), src, ip_addr(dst),\n\t\t\t\t\t\t is_cidr ? ip_addrsize(dst) : -1);\n\tif ((bits < 0) || (bits > ip_maxbits(dst)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src)));\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(dst), bits, ip_family(dst)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tip_bits(dst) = bits;\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clean_ipv6_addr",
          "args": [
            "port->raddr.addr.ss_family",
            "remote_host"
          ],
          "line": 1153
        },
        "resolved": true,
        "details": {
          "function_name": "clean_ipv6_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "1510-1522",
          "snippet": "void\nclean_ipv6_addr(int addr_family, char *addr)\n{\n#ifdef HAVE_IPV6\n\tif (addr_family == AF_INET6)\n\t{\n\t\tchar\t   *pct = strchr(addr, '%');\n\n\t\tif (pct)\n\t\t\t*pct = '\\0';\n\t}\n#endif\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nvoid\nclean_ipv6_addr(int addr_family, char *addr)\n{\n#ifdef HAVE_IPV6\n\tif (addr_family == AF_INET6)\n\t{\n\t\tchar\t   *pct = strchr(addr, '%');\n\n\t\tif (pct)\n\t\t\t*pct = '\\0';\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_getnameinfo_all",
          "args": [
            "&port->raddr.addr",
            "port->raddr.salen",
            "remote_host",
            "sizeof(remote_host)",
            "NULL",
            "0",
            "NI_NUMERICHOST | NI_NUMERICSERV"
          ],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_client_addr(PG_FUNCTION_ARGS)\n{\n\tPort\t   *port = MyProcPort;\n\tchar\t\tremote_host[NI_MAXHOST];\n\tint\t\t\tret;\n\n\tif (port == NULL)\n\t\tPG_RETURN_NULL();\n\n\tswitch (port->raddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tremote_host[0] = '\\0';\n\n\tret = pg_getnameinfo_all(&port->raddr.addr, port->raddr.salen,\n\t\t\t\t\t\t\t remote_host, sizeof(remote_host),\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tclean_ipv6_addr(port->raddr.addr.ss_family, remote_host);\n\n\tPG_RETURN_INET_P(network_in(remote_host, false));\n}"
  },
  {
    "function_name": "network_scan_last",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1111-1117",
    "snippet": "Datum\nnetwork_scan_last(Datum in)\n{\n\treturn DirectFunctionCall2(inet_set_masklen,\n\t\t\t\t\t\t\t   DirectFunctionCall1(network_broadcast, in),\n\t\t\t\t\t\t\t   Int32GetDatum(-1));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DirectFunctionCall2",
          "args": [
            "inet_set_masklen",
            "DirectFunctionCall1(network_broadcast, in)",
            "Int32GetDatum(-1)"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "-1"
          ],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectFunctionCall1",
          "args": [
            "network_broadcast",
            "in"
          ],
          "line": 1115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nnetwork_scan_last(Datum in)\n{\n\treturn DirectFunctionCall2(inet_set_masklen,\n\t\t\t\t\t\t\t   DirectFunctionCall1(network_broadcast, in),\n\t\t\t\t\t\t\t   Int32GetDatum(-1));\n}"
  },
  {
    "function_name": "network_scan_first",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1097-1101",
    "snippet": "Datum\nnetwork_scan_first(Datum in)\n{\n\treturn DirectFunctionCall1(network_network, in);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DirectFunctionCall1",
          "args": [
            "network_network",
            "in"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nnetwork_scan_first(Datum in)\n{\n\treturn DirectFunctionCall1(network_network, in);\n}"
  },
  {
    "function_name": "addressOK",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1048-1088",
    "snippet": "static bool\naddressOK(unsigned char *a, int bits, int family)\n{\n\tint\t\t\tbyte;\n\tint\t\t\tnbits;\n\tint\t\t\tmaxbits;\n\tint\t\t\tmaxbytes;\n\tunsigned char mask;\n\n\tif (family == PGSQL_AF_INET)\n\t{\n\t\tmaxbits = 32;\n\t\tmaxbytes = 4;\n\t}\n\telse\n\t{\n\t\tmaxbits = 128;\n\t\tmaxbytes = 16;\n\t}\n\tAssert(bits <= maxbits);\n\n\tif (bits == maxbits)\n\t\treturn true;\n\n\tbyte = bits / 8;\n\n\tnbits = bits % 8;\n\tmask = 0xff;\n\tif (bits != 0)\n\t\tmask >>= nbits;\n\n\twhile (byte < maxbytes)\n\t{\n\t\tif ((a[byte] & mask) != 0)\n\t\t\treturn false;\n\t\tmask = 0xff;\n\t\tbyte++;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static bool addressOK(unsigned char *a, int bits, int family);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "bits <= maxbits"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic bool addressOK(unsigned char *a, int bits, int family);\n\nstatic bool\naddressOK(unsigned char *a, int bits, int family)\n{\n\tint\t\t\tbyte;\n\tint\t\t\tnbits;\n\tint\t\t\tmaxbits;\n\tint\t\t\tmaxbytes;\n\tunsigned char mask;\n\n\tif (family == PGSQL_AF_INET)\n\t{\n\t\tmaxbits = 32;\n\t\tmaxbytes = 4;\n\t}\n\telse\n\t{\n\t\tmaxbits = 128;\n\t\tmaxbytes = 16;\n\t}\n\tAssert(bits <= maxbits);\n\n\tif (bits == maxbits)\n\t\treturn true;\n\n\tbyte = bits / 8;\n\n\tnbits = bits % 8;\n\tmask = 0xff;\n\tif (bits != 0)\n\t\tmask >>= nbits;\n\n\twhile (byte < maxbytes)\n\t{\n\t\tif ((a[byte] & mask) != 0)\n\t\t\treturn false;\n\t\tmask = 0xff;\n\t\tbyte++;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "bitncommon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "1010-1042",
    "snippet": "int\nbitncommon(const unsigned char *l, const unsigned char *r, int n)\n{\n\tint\t\t\tbyte,\n\t\t\t\tnbits;\n\n\t/* number of bits to examine in last byte */\n\tnbits = n % 8;\n\n\t/* check whole bytes */\n\tfor (byte = 0; byte < n / 8; byte++)\n\t{\n\t\tif (l[byte] != r[byte])\n\t\t{\n\t\t\t/* at least one bit in the last byte is not common */\n\t\t\tnbits = 7;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* check bits in last partial byte */\n\tif (nbits != 0)\n\t{\n\t\t/* calculate diff of first non-matching bytes */\n\t\tunsigned int diff = l[byte] ^ r[byte];\n\n\t\t/* compare the bits from the most to the least */\n\t\twhile ((diff >> (8 - nbits)) != 0)\n\t\t\tnbits--;\n\t}\n\n\treturn (8 * byte) + nbits;\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nint\nbitncommon(const unsigned char *l, const unsigned char *r, int n)\n{\n\tint\t\t\tbyte,\n\t\t\t\tnbits;\n\n\t/* number of bits to examine in last byte */\n\tnbits = n % 8;\n\n\t/* check whole bytes */\n\tfor (byte = 0; byte < n / 8; byte++)\n\t{\n\t\tif (l[byte] != r[byte])\n\t\t{\n\t\t\t/* at least one bit in the last byte is not common */\n\t\t\tnbits = 7;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* check bits in last partial byte */\n\tif (nbits != 0)\n\t{\n\t\t/* calculate diff of first non-matching bytes */\n\t\tunsigned int diff = l[byte] ^ r[byte];\n\n\t\t/* compare the bits from the most to the least */\n\t\twhile ((diff >> (8 - nbits)) != 0)\n\t\t\tnbits--;\n\t}\n\n\treturn (8 * byte) + nbits;\n}"
  },
  {
    "function_name": "bitncmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "976-1003",
    "snippet": "int\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "lb"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "rb"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "lb"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "l",
            "r",
            "b"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nint\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "convert_network_to_scalar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "909-962",
    "snippet": "double\nconvert_network_to_scalar(Datum value, Oid typid, bool *failure)\n{\n\tswitch (typid)\n\t{\n\t\tcase INETOID:\n\t\tcase CIDROID:\n\t\t\t{\n\t\t\t\tinet\t   *ip = DatumGetInetPP(value);\n\t\t\t\tint\t\t\tlen;\n\t\t\t\tdouble\t\tres;\n\t\t\t\tint\t\t\ti;\n\n\t\t\t\t/*\n\t\t\t\t * Note that we don't use the full address for IPv6.\n\t\t\t\t */\n\t\t\t\tif (ip_family(ip) == PGSQL_AF_INET)\n\t\t\t\t\tlen = 4;\n\t\t\t\telse\n\t\t\t\t\tlen = 5;\n\n\t\t\t\tres = ip_family(ip);\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t{\n\t\t\t\t\tres *= 256;\n\t\t\t\t\tres += ip_addr(ip)[i];\n\t\t\t\t}\n\t\t\t\treturn res;\n\t\t\t}\n\t\tcase MACADDROID:\n\t\t\t{\n\t\t\t\tmacaddr    *mac = DatumGetMacaddrP(value);\n\t\t\t\tdouble\t\tres;\n\n\t\t\t\tres = (mac->a << 16) | (mac->b << 8) | (mac->c);\n\t\t\t\tres *= 256 * 256 * 256;\n\t\t\t\tres += (mac->d << 16) | (mac->e << 8) | (mac->f);\n\t\t\t\treturn res;\n\t\t\t}\n\t\tcase MACADDR8OID:\n\t\t\t{\n\t\t\t\tmacaddr8   *mac = DatumGetMacaddr8P(value);\n\t\t\t\tdouble\t\tres;\n\n\t\t\t\tres = (mac->a << 24) | (mac->b << 16) | (mac->c << 8) | (mac->d);\n\t\t\t\tres *= ((double) 256) * 256 * 256 * 256;\n\t\t\t\tres += (mac->e << 24) | (mac->f << 16) | (mac->g << 8) | (mac->h);\n\t\t\t\treturn res;\n\t\t\t}\n\t}\n\n\t*failure = true;\n\treturn 0;\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DatumGetMacaddr8P",
          "args": [
            "value"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetMacaddrP",
          "args": [
            "value"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetInetPP",
          "args": [
            "value"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\ndouble\nconvert_network_to_scalar(Datum value, Oid typid, bool *failure)\n{\n\tswitch (typid)\n\t{\n\t\tcase INETOID:\n\t\tcase CIDROID:\n\t\t\t{\n\t\t\t\tinet\t   *ip = DatumGetInetPP(value);\n\t\t\t\tint\t\t\tlen;\n\t\t\t\tdouble\t\tres;\n\t\t\t\tint\t\t\ti;\n\n\t\t\t\t/*\n\t\t\t\t * Note that we don't use the full address for IPv6.\n\t\t\t\t */\n\t\t\t\tif (ip_family(ip) == PGSQL_AF_INET)\n\t\t\t\t\tlen = 4;\n\t\t\t\telse\n\t\t\t\t\tlen = 5;\n\n\t\t\t\tres = ip_family(ip);\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t{\n\t\t\t\t\tres *= 256;\n\t\t\t\t\tres += ip_addr(ip)[i];\n\t\t\t\t}\n\t\t\t\treturn res;\n\t\t\t}\n\t\tcase MACADDROID:\n\t\t\t{\n\t\t\t\tmacaddr    *mac = DatumGetMacaddrP(value);\n\t\t\t\tdouble\t\tres;\n\n\t\t\t\tres = (mac->a << 16) | (mac->b << 8) | (mac->c);\n\t\t\t\tres *= 256 * 256 * 256;\n\t\t\t\tres += (mac->d << 16) | (mac->e << 8) | (mac->f);\n\t\t\t\treturn res;\n\t\t\t}\n\t\tcase MACADDR8OID:\n\t\t\t{\n\t\t\t\tmacaddr8   *mac = DatumGetMacaddr8P(value);\n\t\t\t\tdouble\t\tres;\n\n\t\t\t\tres = (mac->a << 24) | (mac->b << 16) | (mac->c << 8) | (mac->d);\n\t\t\t\tres *= ((double) 256) * 256 * 256 * 256;\n\t\t\t\tres += (mac->e << 24) | (mac->f << 16) | (mac->g << 8) | (mac->h);\n\t\t\t\treturn res;\n\t\t\t}\n\t}\n\n\t*failure = true;\n\treturn 0;\n}"
  },
  {
    "function_name": "inet_merge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "883-899",
    "snippet": "Datum\ninet_merge(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0),\n\t\t\t   *a2 = PG_GETARG_INET_PP(1);\n\tint\t\t\tcommonbits;\n\n\tif (ip_family(a1) != ip_family(a2))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot merge addresses from different families\")));\n\n\tcommonbits = bitncommon(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\n\tPG_RETURN_INET_P(cidr_set_masklen_internal(a1, commonbits));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "cidr_set_masklen_internal(a1, commonbits)"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cidr_set_masklen_internal",
          "args": [
            "a1",
            "commonbits"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "cidr_set_masklen_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "326-350",
          "snippet": "inet *\ncidr_set_masklen_internal(const inet *src, int bits)\n{\n\tinet\t   *dst = (inet *) palloc0(sizeof(inet));\n\n\tip_family(dst) = ip_family(src);\n\tip_bits(dst) = bits;\n\n\tif (bits > 0)\n\t{\n\t\tAssert(bits <= ip_maxbits(dst));\n\n\t\t/* Clone appropriate bytes of the address, leaving the rest 0 */\n\t\tmemcpy(ip_addr(dst), ip_addr(src), (bits + 7) / 8);\n\n\t\t/* Clear any unwanted bits in the last partial byte */\n\t\tif (bits % 8)\n\t\t\tip_addr(dst)[bits / 8] &= ~(0xFF >> (bits % 8));\n\t}\n\n\t/* Set varlena header correctly */\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\ninet *\ncidr_set_masklen_internal(const inet *src, int bits)\n{\n\tinet\t   *dst = (inet *) palloc0(sizeof(inet));\n\n\tip_family(dst) = ip_family(src);\n\tip_bits(dst) = bits;\n\n\tif (bits > 0)\n\t{\n\t\tAssert(bits <= ip_maxbits(dst));\n\n\t\t/* Clone appropriate bytes of the address, leaving the rest 0 */\n\t\tmemcpy(ip_addr(dst), ip_addr(src), (bits + 7) / 8);\n\n\t\t/* Clear any unwanted bits in the last partial byte */\n\t\tif (bits % 8)\n\t\t\tip_addr(dst)[bits / 8] &= ~(0xFF >> (bits % 8));\n\t}\n\n\t/* Set varlena header correctly */\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitncommon",
          "args": [
            "ip_addr(a1)",
            "ip_addr(a2)",
            "Min(ip_bits(a1), ip_bits(a2))"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "bitncommon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "1010-1042",
          "snippet": "int\nbitncommon(const unsigned char *l, const unsigned char *r, int n)\n{\n\tint\t\t\tbyte,\n\t\t\t\tnbits;\n\n\t/* number of bits to examine in last byte */\n\tnbits = n % 8;\n\n\t/* check whole bytes */\n\tfor (byte = 0; byte < n / 8; byte++)\n\t{\n\t\tif (l[byte] != r[byte])\n\t\t{\n\t\t\t/* at least one bit in the last byte is not common */\n\t\t\tnbits = 7;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* check bits in last partial byte */\n\tif (nbits != 0)\n\t{\n\t\t/* calculate diff of first non-matching bytes */\n\t\tunsigned int diff = l[byte] ^ r[byte];\n\n\t\t/* compare the bits from the most to the least */\n\t\twhile ((diff >> (8 - nbits)) != 0)\n\t\t\tnbits--;\n\t}\n\n\treturn (8 * byte) + nbits;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nint\nbitncommon(const unsigned char *l, const unsigned char *r, int n)\n{\n\tint\t\t\tbyte,\n\t\t\t\tnbits;\n\n\t/* number of bits to examine in last byte */\n\tnbits = n % 8;\n\n\t/* check whole bytes */\n\tfor (byte = 0; byte < n / 8; byte++)\n\t{\n\t\tif (l[byte] != r[byte])\n\t\t{\n\t\t\t/* at least one bit in the last byte is not common */\n\t\t\tnbits = 7;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* check bits in last partial byte */\n\tif (nbits != 0)\n\t{\n\t\t/* calculate diff of first non-matching bytes */\n\t\tunsigned int diff = l[byte] ^ r[byte];\n\n\t\t/* compare the bits from the most to the least */\n\t\twhile ((diff >> (8 - nbits)) != 0)\n\t\t\tnbits--;\n\t}\n\n\treturn (8 * byte) + nbits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Min",
          "args": [
            "ip_bits(a1)",
            "ip_bits(a2)"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a2"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a1"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a2"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a1"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot merge addresses from different families\"))"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"cannot merge addresses from different families\""
          ],
          "line": 893
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_PARAMETER_VALUE"
          ],
          "line": 892
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a2"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a1"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\ninet_merge(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0),\n\t\t\t   *a2 = PG_GETARG_INET_PP(1);\n\tint\t\t\tcommonbits;\n\n\tif (ip_family(a1) != ip_family(a2))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"cannot merge addresses from different families\")));\n\n\tcommonbits = bitncommon(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\n\tPG_RETURN_INET_P(cidr_set_masklen_internal(a1, commonbits));\n}"
  },
  {
    "function_name": "inet_same_family",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "871-878",
    "snippet": "Datum\ninet_same_family(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(ip_family(a1) == ip_family(a2));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ip_family(a1) == ip_family(a2)"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a2"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a1"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 874
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\ninet_same_family(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(ip_family(a1) == ip_family(a2));\n}"
  },
  {
    "function_name": "network_hostmask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "823-865",
    "snippet": "Datum\nnetwork_hostmask(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *dst;\n\tint\t\t\tbyte;\n\tint\t\t\tbits;\n\tint\t\t\tmaxbytes;\n\tunsigned char mask;\n\tunsigned char *b;\n\n\t/* make sure any unused bits are zeroed */\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tmaxbytes = ip_addrsize(ip);\n\tbits = ip_maxbits(ip) - ip_bits(ip);\n\tb = ip_addr(dst);\n\n\tbyte = maxbytes - 1;\n\n\twhile (bits)\n\t{\n\t\tif (bits >= 8)\n\t\t{\n\t\t\tmask = 0xff;\n\t\t\tbits -= 8;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmask = 0xff >> (8 - bits);\n\t\t\tbits = 0;\n\t\t}\n\n\t\tb[byte] = mask;\n\t\tbyte--;\n\t}\n\n\tip_family(dst) = ip_family(ip);\n\tip_bits(dst) = ip_maxbits(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "dst"
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "dst"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "ip"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "ip"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "ip"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 835
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nnetwork_hostmask(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *dst;\n\tint\t\t\tbyte;\n\tint\t\t\tbits;\n\tint\t\t\tmaxbytes;\n\tunsigned char mask;\n\tunsigned char *b;\n\n\t/* make sure any unused bits are zeroed */\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tmaxbytes = ip_addrsize(ip);\n\tbits = ip_maxbits(ip) - ip_bits(ip);\n\tb = ip_addr(dst);\n\n\tbyte = maxbytes - 1;\n\n\twhile (bits)\n\t{\n\t\tif (bits >= 8)\n\t\t{\n\t\t\tmask = 0xff;\n\t\t\tbits -= 8;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmask = 0xff >> (8 - bits);\n\t\t\tbits = 0;\n\t\t}\n\n\t\tb[byte] = mask;\n\t\tbyte--;\n\t}\n\n\tip_family(dst) = ip_family(ip);\n\tip_bits(dst) = ip_maxbits(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}"
  },
  {
    "function_name": "network_netmask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "781-821",
    "snippet": "Datum\nnetwork_netmask(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *dst;\n\tint\t\t\tbyte;\n\tint\t\t\tbits;\n\tunsigned char mask;\n\tunsigned char *b;\n\n\t/* make sure any unused bits are zeroed */\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tbits = ip_bits(ip);\n\tb = ip_addr(dst);\n\n\tbyte = 0;\n\n\twhile (bits)\n\t{\n\t\tif (bits >= 8)\n\t\t{\n\t\t\tmask = 0xff;\n\t\t\tbits -= 8;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmask = 0xff << (8 - bits);\n\t\t\tbits = 0;\n\t\t}\n\n\t\tb[byte] = mask;\n\t\tbyte++;\n\t}\n\n\tip_family(dst) = ip_family(ip);\n\tip_bits(dst) = ip_maxbits(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "dst"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "dst"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "ip"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nnetwork_netmask(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *dst;\n\tint\t\t\tbyte;\n\tint\t\t\tbits;\n\tunsigned char mask;\n\tunsigned char *b;\n\n\t/* make sure any unused bits are zeroed */\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tbits = ip_bits(ip);\n\tb = ip_addr(dst);\n\n\tbyte = 0;\n\n\twhile (bits)\n\t{\n\t\tif (bits >= 8)\n\t\t{\n\t\t\tmask = 0xff;\n\t\t\tbits -= 8;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmask = 0xff << (8 - bits);\n\t\t\tbits = 0;\n\t\t}\n\n\t\tb[byte] = mask;\n\t\tbyte++;\n\t}\n\n\tip_family(dst) = ip_family(ip);\n\tip_bits(dst) = ip_maxbits(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}"
  },
  {
    "function_name": "network_network",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "737-779",
    "snippet": "Datum\nnetwork_network(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *dst;\n\tint\t\t\tbyte;\n\tint\t\t\tbits;\n\tunsigned char mask;\n\tunsigned char *a,\n\t\t\t   *b;\n\n\t/* make sure any unused bits are zeroed */\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tbits = ip_bits(ip);\n\ta = ip_addr(ip);\n\tb = ip_addr(dst);\n\n\tbyte = 0;\n\n\twhile (bits)\n\t{\n\t\tif (bits >= 8)\n\t\t{\n\t\t\tmask = 0xff;\n\t\t\tbits -= 8;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmask = 0xff << (8 - bits);\n\t\t\tbits = 0;\n\t\t}\n\n\t\tb[byte] = a[byte] & mask;\n\t\tbyte++;\n\t}\n\n\tip_family(dst) = ip_family(ip);\n\tip_bits(dst) = ip_bits(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "dst"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "dst"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nnetwork_network(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *dst;\n\tint\t\t\tbyte;\n\tint\t\t\tbits;\n\tunsigned char mask;\n\tunsigned char *a,\n\t\t\t   *b;\n\n\t/* make sure any unused bits are zeroed */\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tbits = ip_bits(ip);\n\ta = ip_addr(ip);\n\tb = ip_addr(dst);\n\n\tbyte = 0;\n\n\twhile (bits)\n\t{\n\t\tif (bits >= 8)\n\t\t{\n\t\t\tmask = 0xff;\n\t\t\tbits -= 8;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmask = 0xff << (8 - bits);\n\t\t\tbits = 0;\n\t\t}\n\n\t\tb[byte] = a[byte] & mask;\n\t\tbyte++;\n\t}\n\n\tip_family(dst) = ip_family(ip);\n\tip_bits(dst) = ip_bits(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}"
  },
  {
    "function_name": "network_broadcast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "692-735",
    "snippet": "Datum\nnetwork_broadcast(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *dst;\n\tint\t\t\tbyte;\n\tint\t\t\tbits;\n\tint\t\t\tmaxbytes;\n\tunsigned char mask;\n\tunsigned char *a,\n\t\t\t   *b;\n\n\t/* make sure any unused bits are zeroed */\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tmaxbytes = ip_addrsize(ip);\n\tbits = ip_bits(ip);\n\ta = ip_addr(ip);\n\tb = ip_addr(dst);\n\n\tfor (byte = 0; byte < maxbytes; byte++)\n\t{\n\t\tif (bits >= 8)\n\t\t{\n\t\t\tmask = 0x00;\n\t\t\tbits -= 8;\n\t\t}\n\t\telse if (bits == 0)\n\t\t\tmask = 0xff;\n\t\telse\n\t\t{\n\t\t\tmask = 0xff >> bits;\n\t\t\tbits = 0;\n\t\t}\n\n\t\tb[byte] = a[byte] | mask;\n\t}\n\n\tip_family(dst) = ip_family(ip);\n\tip_bits(dst) = ip_bits(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "dst"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "dst"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "ip"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nnetwork_broadcast(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tinet\t   *dst;\n\tint\t\t\tbyte;\n\tint\t\t\tbits;\n\tint\t\t\tmaxbytes;\n\tunsigned char mask;\n\tunsigned char *a,\n\t\t\t   *b;\n\n\t/* make sure any unused bits are zeroed */\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\tmaxbytes = ip_addrsize(ip);\n\tbits = ip_bits(ip);\n\ta = ip_addr(ip);\n\tb = ip_addr(dst);\n\n\tfor (byte = 0; byte < maxbytes; byte++)\n\t{\n\t\tif (bits >= 8)\n\t\t{\n\t\t\tmask = 0x00;\n\t\t\tbits -= 8;\n\t\t}\n\t\telse if (bits == 0)\n\t\t\tmask = 0xff;\n\t\telse\n\t\t{\n\t\t\tmask = 0xff >> bits;\n\t\t\tbits = 0;\n\t\t}\n\n\t\tb[byte] = a[byte] | mask;\n\t}\n\n\tip_family(dst) = ip_family(ip);\n\tip_bits(dst) = ip_bits(ip);\n\tSET_INET_VARSIZE(dst);\n\n\tPG_RETURN_INET_P(dst);\n}"
  },
  {
    "function_name": "network_family",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "673-690",
    "snippet": "Datum\nnetwork_family(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\n\tswitch (ip_family(ip))\n\t{\n\t\tcase PGSQL_AF_INET:\n\t\t\tPG_RETURN_INT32(4);\n\t\t\tbreak;\n\t\tcase PGSQL_AF_INET6:\n\t\t\tPG_RETURN_INT32(6);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_INT32(0);\n\t\t\tbreak;\n\t}\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "0"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "6"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "4"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nnetwork_family(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\n\tswitch (ip_family(ip))\n\t{\n\t\tcase PGSQL_AF_INET:\n\t\t\tPG_RETURN_INT32(4);\n\t\t\tbreak;\n\t\tcase PGSQL_AF_INET6:\n\t\t\tPG_RETURN_INT32(6);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_INT32(0);\n\t\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "network_masklen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "665-671",
    "snippet": "Datum\nnetwork_masklen(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\n\tPG_RETURN_INT32(ip_bits(ip));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "ip_bits(ip)"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nnetwork_masklen(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\n\tPG_RETURN_INT32(ip_bits(ip));\n}"
  },
  {
    "function_name": "cidr_abbrev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "647-663",
    "snippet": "Datum\ncidr_abbrev(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tchar\t   *dst;\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\n\tdst = inet_cidr_ntop(ip_family(ip), ip_addr(ip),\n\t\t\t\t\t\t ip_bits(ip), tmp, sizeof(tmp));\n\n\tif (dst == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format cidr value: %m\")));\n\n\tPG_RETURN_TEXT_P(cstring_to_text(tmp));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "cstring_to_text(tmp)"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cstring_to_text",
          "args": [
            "tmp"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "cstring_to_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "148-152",
          "snippet": "text *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\ntext *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format cidr value: %m\"))"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"could not format cidr value: %m\""
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_BINARY_REPRESENTATION"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "inet_cidr_ntop",
          "args": [
            "ip_family(ip)",
            "ip_addr(ip)",
            "ip_bits(ip)",
            "tmp",
            "sizeof(tmp)"
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "inet_cidr_ntop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/inet_cidr_ntop.c",
          "lines": "55-68",
          "snippet": "char *\ninet_cidr_ntop(int af, const void *src, int bits, char *dst, size_t size)\n{\n\tswitch (af)\n\t{\n\t\tcase PGSQL_AF_INET:\n\t\t\treturn inet_cidr_ntop_ipv4(src, bits, dst, size);\n\t\tcase PGSQL_AF_INET6:\n\t\t\treturn inet_cidr_ntop_ipv6(src, bits, dst, size);\n\t\tdefault:\n\t\t\terrno = EAFNOSUPPORT;\n\t\t\treturn NULL;\n\t}\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *inet_cidr_ntop_ipv4(const u_char *src, int bits,\n\t\t\t\t\tchar *dst, size_t size);",
            "static char *inet_cidr_ntop_ipv6(const u_char *src, int bits,\n\t\t\t\t\tchar *dst, size_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic char *inet_cidr_ntop_ipv4(const u_char *src, int bits,\n\t\t\t\t\tchar *dst, size_t size);\nstatic char *inet_cidr_ntop_ipv6(const u_char *src, int bits,\n\t\t\t\t\tchar *dst, size_t size);\n\nchar *\ninet_cidr_ntop(int af, const void *src, int bits, char *dst, size_t size)\n{\n\tswitch (af)\n\t{\n\t\tcase PGSQL_AF_INET:\n\t\t\treturn inet_cidr_ntop_ipv4(src, bits, dst, size);\n\t\tcase PGSQL_AF_INET6:\n\t\t\treturn inet_cidr_ntop_ipv6(src, bits, dst, size);\n\t\tdefault:\n\t\t\terrno = EAFNOSUPPORT;\n\t\t\treturn NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ncidr_abbrev(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tchar\t   *dst;\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\n\tdst = inet_cidr_ntop(ip_family(ip), ip_addr(ip),\n\t\t\t\t\t\t ip_bits(ip), tmp, sizeof(tmp));\n\n\tif (dst == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format cidr value: %m\")));\n\n\tPG_RETURN_TEXT_P(cstring_to_text(tmp));\n}"
  },
  {
    "function_name": "inet_abbrev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "629-645",
    "snippet": "Datum\ninet_abbrev(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tchar\t   *dst;\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\n\tdst = inet_net_ntop(ip_family(ip), ip_addr(ip),\n\t\t\t\t\t\tip_bits(ip), tmp, sizeof(tmp));\n\n\tif (dst == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\tPG_RETURN_TEXT_P(cstring_to_text(tmp));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "cstring_to_text(tmp)"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cstring_to_text",
          "args": [
            "tmp"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "cstring_to_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "148-152",
          "snippet": "text *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\ntext *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\"))"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"could not format inet value: %m\""
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_BINARY_REPRESENTATION"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "inet_net_ntop",
          "args": [
            "ip_family(ip)",
            "ip_addr(ip)",
            "ip_bits(ip)",
            "tmp",
            "sizeof(tmp)"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_abbrev(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tchar\t   *dst;\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\n\tdst = inet_net_ntop(ip_family(ip), ip_addr(ip),\n\t\t\t\t\t\tip_bits(ip), tmp, sizeof(tmp));\n\n\tif (dst == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\tPG_RETURN_TEXT_P(cstring_to_text(tmp));\n}"
  },
  {
    "function_name": "network_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "606-627",
    "snippet": "Datum\nnetwork_show(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tint\t\t\tlen;\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\n\tif (inet_net_ntop(ip_family(ip), ip_addr(ip), ip_maxbits(ip),\n\t\t\t\t\t  tmp, sizeof(tmp)) == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\t/* Add /n if not present (which it won't be) */\n\tif (strchr(tmp, '/') == NULL)\n\t{\n\t\tlen = strlen(tmp);\n\t\tsnprintf(tmp + len, sizeof(tmp) - len, \"/%u\", ip_bits(ip));\n\t}\n\n\tPG_RETURN_TEXT_P(cstring_to_text(tmp));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "cstring_to_text(tmp)"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cstring_to_text",
          "args": [
            "tmp"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "cstring_to_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "148-152",
          "snippet": "text *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\ntext *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "tmp + len",
            "sizeof(tmp) - len",
            "\"/%u\"",
            "ip_bits(ip)"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "ip"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tmp"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "calcstrlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_cleanup.c",
          "lines": "361-380",
          "snippet": "static int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nstatic int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "tmp",
            "'/'"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\"))"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"could not format inet value: %m\""
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_BINARY_REPRESENTATION"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "inet_net_ntop",
          "args": [
            "ip_family(ip)",
            "ip_addr(ip)",
            "ip_maxbits(ip)",
            "tmp",
            "sizeof(tmp)"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "ip"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nnetwork_show(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tint\t\t\tlen;\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\n\tif (inet_net_ntop(ip_family(ip), ip_addr(ip), ip_maxbits(ip),\n\t\t\t\t\t  tmp, sizeof(tmp)) == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\t/* Add /n if not present (which it won't be) */\n\tif (strchr(tmp, '/') == NULL)\n\t{\n\t\tlen = strlen(tmp);\n\t\tsnprintf(tmp + len, sizeof(tmp) - len, \"/%u\", ip_bits(ip));\n\t}\n\n\tPG_RETURN_TEXT_P(cstring_to_text(tmp));\n}"
  },
  {
    "function_name": "network_host",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "580-599",
    "snippet": "Datum\nnetwork_host(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tchar\t   *ptr;\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\n\t/* force display of max bits, regardless of masklen... */\n\tif (inet_net_ntop(ip_family(ip), ip_addr(ip), ip_maxbits(ip),\n\t\t\t\t\t  tmp, sizeof(tmp)) == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\t/* Suppress /n if present (shouldn't happen now) */\n\tif ((ptr = strchr(tmp, '/')) != NULL)\n\t\t*ptr = '\\0';\n\n\tPG_RETURN_TEXT_P(cstring_to_text(tmp));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "cstring_to_text(tmp)"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cstring_to_text",
          "args": [
            "tmp"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "cstring_to_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "148-152",
          "snippet": "text *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\ntext *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "tmp",
            "'/'"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\"))"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"could not format inet value: %m\""
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_BINARY_REPRESENTATION"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "inet_net_ntop",
          "args": [
            "ip_family(ip)",
            "ip_addr(ip)",
            "ip_maxbits(ip)",
            "tmp",
            "sizeof(tmp)"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "ip"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "ip"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "ip"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nnetwork_host(PG_FUNCTION_ARGS)\n{\n\tinet\t   *ip = PG_GETARG_INET_PP(0);\n\tchar\t   *ptr;\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\n\t/* force display of max bits, regardless of masklen... */\n\tif (inet_net_ntop(ip_family(ip), ip_addr(ip), ip_maxbits(ip),\n\t\t\t\t\t  tmp, sizeof(tmp)) == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\t/* Suppress /n if present (shouldn't happen now) */\n\tif ((ptr = strchr(tmp, '/')) != NULL)\n\t\t*ptr = '\\0';\n\n\tPG_RETURN_TEXT_P(cstring_to_text(tmp));\n}"
  },
  {
    "function_name": "network_overlap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "562-575",
    "snippet": "Datum\nnetwork_overlap(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tPG_RETURN_BOOL(bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\t\t   Min(ip_bits(a1), ip_bits(a2))) == 0);\n\t}\n\n\tPG_RETURN_BOOL(false);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "false"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\t\t   Min(ip_bits(a1), ip_bits(a2))) == 0"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitncmp",
          "args": [
            "ip_addr(a1)",
            "ip_addr(a2)",
            "Min(ip_bits(a1), ip_bits(a2))"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "bitncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "976-1003",
          "snippet": "int\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nint\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Min",
          "args": [
            "ip_bits(a1)",
            "ip_bits(a2)"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a2"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a1"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a2"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a1"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a2"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a1"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_overlap(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tPG_RETURN_BOOL(bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\t\t   Min(ip_bits(a1), ip_bits(a2))) == 0);\n\t}\n\n\tPG_RETURN_BOOL(false);\n}"
  },
  {
    "function_name": "network_supeq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "547-560",
    "snippet": "Datum\nnetwork_supeq(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tPG_RETURN_BOOL(ip_bits(a1) <= ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a1)) == 0);\n\t}\n\n\tPG_RETURN_BOOL(false);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "false"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ip_bits(a1) <= ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a1)) == 0"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitncmp",
          "args": [
            "ip_addr(a1)",
            "ip_addr(a2)",
            "ip_bits(a1)"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "bitncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "976-1003",
          "snippet": "int\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nint\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a1"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a2"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a1"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a2"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a1"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a2"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a1"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_supeq(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tPG_RETURN_BOOL(ip_bits(a1) <= ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a1)) == 0);\n\t}\n\n\tPG_RETURN_BOOL(false);\n}"
  },
  {
    "function_name": "network_sup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "532-545",
    "snippet": "Datum\nnetwork_sup(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tPG_RETURN_BOOL(ip_bits(a1) < ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a1)) == 0);\n\t}\n\n\tPG_RETURN_BOOL(false);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "false"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ip_bits(a1) < ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a1)) == 0"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitncmp",
          "args": [
            "ip_addr(a1)",
            "ip_addr(a2)",
            "ip_bits(a1)"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "bitncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "976-1003",
          "snippet": "int\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nint\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a1"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a2"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a1"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a2"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a1"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a2"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a1"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_sup(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tPG_RETURN_BOOL(ip_bits(a1) < ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a1)) == 0);\n\t}\n\n\tPG_RETURN_BOOL(false);\n}"
  },
  {
    "function_name": "network_subeq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "517-530",
    "snippet": "Datum\nnetwork_subeq(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tPG_RETURN_BOOL(ip_bits(a1) >= ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a2)) == 0);\n\t}\n\n\tPG_RETURN_BOOL(false);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "false"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ip_bits(a1) >= ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a2)) == 0"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitncmp",
          "args": [
            "ip_addr(a1)",
            "ip_addr(a2)",
            "ip_bits(a2)"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "bitncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "976-1003",
          "snippet": "int\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nint\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a2"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a2"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a1"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a2"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a1"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a2"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a1"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_subeq(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tPG_RETURN_BOOL(ip_bits(a1) >= ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a2)) == 0);\n\t}\n\n\tPG_RETURN_BOOL(false);\n}"
  },
  {
    "function_name": "network_sub",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "502-515",
    "snippet": "Datum\nnetwork_sub(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tPG_RETURN_BOOL(ip_bits(a1) > ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a2)) == 0);\n\t}\n\n\tPG_RETURN_BOOL(false);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "false"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "ip_bits(a1) > ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a2)) == 0"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitncmp",
          "args": [
            "ip_addr(a1)",
            "ip_addr(a2)",
            "ip_bits(a2)"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "bitncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "976-1003",
          "snippet": "int\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nint\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a2"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a2"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a1"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a2"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a1"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a2"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a1"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_sub(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tPG_RETURN_BOOL(ip_bits(a1) > ip_bits(a2) &&\n\t\t\t\t\t   bitncmp(ip_addr(a1), ip_addr(a2), ip_bits(a2)) == 0);\n\t}\n\n\tPG_RETURN_BOOL(false);\n}"
  },
  {
    "function_name": "hashinetextended",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "489-497",
    "snippet": "Datum\nhashinetextended(PG_FUNCTION_ARGS)\n{\n\tinet\t   *addr = PG_GETARG_INET_PP(0);\n\tint\t\t\taddrsize = ip_addrsize(addr);\n\n\treturn hash_any_extended((unsigned char *) VARDATA_ANY(addr), addrsize + 2,\n\t\t\t\t\t\t\t PG_GETARG_INT64(1));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_any_extended",
          "args": [
            "(unsigned char *) VARDATA_ANY(addr)",
            "addrsize + 2",
            "PG_GETARG_INT64(1)"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT64",
          "args": [
            "1"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARDATA_ANY",
          "args": [
            "addr"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "addr"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nhashinetextended(PG_FUNCTION_ARGS)\n{\n\tinet\t   *addr = PG_GETARG_INET_PP(0);\n\tint\t\t\taddrsize = ip_addrsize(addr);\n\n\treturn hash_any_extended((unsigned char *) VARDATA_ANY(addr), addrsize + 2,\n\t\t\t\t\t\t\t PG_GETARG_INT64(1));\n}"
  },
  {
    "function_name": "hashinet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "479-487",
    "snippet": "Datum\nhashinet(PG_FUNCTION_ARGS)\n{\n\tinet\t   *addr = PG_GETARG_INET_PP(0);\n\tint\t\t\taddrsize = ip_addrsize(addr);\n\n\t/* XXX this assumes there are no pad bytes in the data structure */\n\treturn hash_any((unsigned char *) VARDATA_ANY(addr), addrsize + 2);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_any",
          "args": [
            "(unsigned char *) VARDATA_ANY(addr)",
            "addrsize + 2"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARDATA_ANY",
          "args": [
            "addr"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "addr"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\nhashinet(PG_FUNCTION_ARGS)\n{\n\tinet\t   *addr = PG_GETARG_INET_PP(0);\n\tint\t\t\taddrsize = ip_addrsize(addr);\n\n\t/* XXX this assumes there are no pad bytes in the data structure */\n\treturn hash_any((unsigned char *) VARDATA_ANY(addr), addrsize + 2);\n}"
  },
  {
    "function_name": "network_larger",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "464-474",
    "snippet": "Datum\nnetwork_larger(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (network_cmp_internal(a1, a2) > 0)\n\t\tPG_RETURN_INET_P(a1);\n\telse\n\t\tPG_RETURN_INET_P(a2);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "a2"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "a1"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "network_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "363-381",
          "snippet": "static int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 network_cmp_internal(inet *a1, inet *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nstatic int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_larger(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (network_cmp_internal(a1, a2) > 0)\n\t\tPG_RETURN_INET_P(a1);\n\telse\n\t\tPG_RETURN_INET_P(a2);\n}"
  },
  {
    "function_name": "network_smaller",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "452-462",
    "snippet": "Datum\nnetwork_smaller(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (network_cmp_internal(a1, a2) < 0)\n\t\tPG_RETURN_INET_P(a1);\n\telse\n\t\tPG_RETURN_INET_P(a2);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "a2"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "a1"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "network_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "363-381",
          "snippet": "static int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 network_cmp_internal(inet *a1, inet *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nstatic int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_smaller(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tif (network_cmp_internal(a1, a2) < 0)\n\t\tPG_RETURN_INET_P(a1);\n\telse\n\t\tPG_RETURN_INET_P(a2);\n}"
  },
  {
    "function_name": "network_ne",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "440-447",
    "snippet": "Datum\nnetwork_ne(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) != 0);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "network_cmp_internal(a1, a2) != 0"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "network_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "363-381",
          "snippet": "static int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 network_cmp_internal(inet *a1, inet *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nstatic int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_ne(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) != 0);\n}"
  },
  {
    "function_name": "network_gt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "431-438",
    "snippet": "Datum\nnetwork_gt(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) > 0);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "network_cmp_internal(a1, a2) > 0"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "network_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "363-381",
          "snippet": "static int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 network_cmp_internal(inet *a1, inet *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nstatic int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_gt(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) > 0);\n}"
  },
  {
    "function_name": "network_ge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "422-429",
    "snippet": "Datum\nnetwork_ge(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) >= 0);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "network_cmp_internal(a1, a2) >= 0"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "network_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "363-381",
          "snippet": "static int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 network_cmp_internal(inet *a1, inet *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nstatic int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_ge(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) >= 0);\n}"
  },
  {
    "function_name": "network_eq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "413-420",
    "snippet": "Datum\nnetwork_eq(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) == 0);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "network_cmp_internal(a1, a2) == 0"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "network_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "363-381",
          "snippet": "static int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 network_cmp_internal(inet *a1, inet *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nstatic int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_eq(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) == 0);\n}"
  },
  {
    "function_name": "network_le",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "404-411",
    "snippet": "Datum\nnetwork_le(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) <= 0);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "network_cmp_internal(a1, a2) <= 0"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "network_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "363-381",
          "snippet": "static int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 network_cmp_internal(inet *a1, inet *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nstatic int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_le(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) <= 0);\n}"
  },
  {
    "function_name": "network_lt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "395-402",
    "snippet": "Datum\nnetwork_lt(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) < 0);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "network_cmp_internal(a1, a2) < 0"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "network_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "363-381",
          "snippet": "static int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 network_cmp_internal(inet *a1, inet *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nstatic int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_lt(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_BOOL(network_cmp_internal(a1, a2) < 0);\n}"
  },
  {
    "function_name": "network_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "383-390",
    "snippet": "Datum\nnetwork_cmp(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_INT32(network_cmp_internal(a1, a2));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "network_cmp_internal(a1, a2)"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_cmp_internal",
          "args": [
            "a1",
            "a2"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "network_cmp_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "363-381",
          "snippet": "static int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int32 network_cmp_internal(inet *a1, inet *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nstatic int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "1"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nDatum\nnetwork_cmp(PG_FUNCTION_ARGS)\n{\n\tinet\t   *a1 = PG_GETARG_INET_PP(0);\n\tinet\t   *a2 = PG_GETARG_INET_PP(1);\n\n\tPG_RETURN_INT32(network_cmp_internal(a1, a2));\n}"
  },
  {
    "function_name": "network_cmp_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "363-381",
    "snippet": "static int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int32 network_cmp_internal(inet *a1, inet *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a2"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a1"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitncmp",
          "args": [
            "ip_addr(a1)",
            "ip_addr(a2)",
            "ip_maxbits(a1)"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "bitncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "976-1003",
          "snippet": "int\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nint\nbitncmp(const unsigned char *l, const unsigned char *r, int n)\n{\n\tunsigned int lb,\n\t\t\t\trb;\n\tint\t\t\tx,\n\t\t\t\tb;\n\n\tb = n / 8;\n\tx = memcmp(l, r, b);\n\tif (x || (n % 8) == 0)\n\t\treturn x;\n\n\tlb = l[b];\n\trb = r[b];\n\tfor (b = n % 8; b > 0; b--)\n\t{\n\t\tif (IS_HIGHBIT_SET(lb) != IS_HIGHBIT_SET(rb))\n\t\t{\n\t\t\tif (IS_HIGHBIT_SET(lb))\n\t\t\t\treturn 1;\n\t\t\treturn -1;\n\t\t}\n\t\tlb <<= 1;\n\t\trb <<= 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "a1"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a2"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a1"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a2"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a1"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Min",
          "args": [
            "ip_bits(a1)",
            "ip_bits(a2)"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a2"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "a1"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a2"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "a1"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a2"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "a1"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int32 network_cmp_internal(inet *a1, inet *a2);\n\nstatic int32\nnetwork_cmp_internal(inet *a1, inet *a2)\n{\n\tif (ip_family(a1) == ip_family(a2))\n\t{\n\t\tint\t\t\torder;\n\n\t\torder = bitncmp(ip_addr(a1), ip_addr(a2),\n\t\t\t\t\t\tMin(ip_bits(a1), ip_bits(a2)));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\torder = ((int) ip_bits(a1)) - ((int) ip_bits(a2));\n\t\tif (order != 0)\n\t\t\treturn order;\n\t\treturn bitncmp(ip_addr(a1), ip_addr(a2), ip_maxbits(a1));\n\t}\n\n\treturn ip_family(a1) - ip_family(a2);\n}"
  },
  {
    "function_name": "cidr_set_masklen_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "326-350",
    "snippet": "inet *\ncidr_set_masklen_internal(const inet *src, int bits)\n{\n\tinet\t   *dst = (inet *) palloc0(sizeof(inet));\n\n\tip_family(dst) = ip_family(src);\n\tip_bits(dst) = bits;\n\n\tif (bits > 0)\n\t{\n\t\tAssert(bits <= ip_maxbits(dst));\n\n\t\t/* Clone appropriate bytes of the address, leaving the rest 0 */\n\t\tmemcpy(ip_addr(dst), ip_addr(src), (bits + 7) / 8);\n\n\t\t/* Clear any unwanted bits in the last partial byte */\n\t\tif (bits % 8)\n\t\t\tip_addr(dst)[bits / 8] &= ~(0xFF >> (bits % 8));\n\t}\n\n\t/* Set varlena header correctly */\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "dst"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ip_addr(dst)",
            "ip_addr(src)",
            "(bits + 7) / 8"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "src"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "bits <= ip_maxbits(dst)"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "dst"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "src"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\ninet *\ncidr_set_masklen_internal(const inet *src, int bits)\n{\n\tinet\t   *dst = (inet *) palloc0(sizeof(inet));\n\n\tip_family(dst) = ip_family(src);\n\tip_bits(dst) = bits;\n\n\tif (bits > 0)\n\t{\n\t\tAssert(bits <= ip_maxbits(dst));\n\n\t\t/* Clone appropriate bytes of the address, leaving the rest 0 */\n\t\tmemcpy(ip_addr(dst), ip_addr(src), (bits + 7) / 8);\n\n\t\t/* Clear any unwanted bits in the last partial byte */\n\t\tif (bits % 8)\n\t\t\tip_addr(dst)[bits / 8] &= ~(0xFF >> (bits % 8));\n\t}\n\n\t/* Set varlena header correctly */\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
  },
  {
    "function_name": "cidr_set_masklen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "306-321",
    "snippet": "Datum\ncidr_set_masklen(PG_FUNCTION_ARGS)\n{\n\tinet\t   *src = PG_GETARG_INET_PP(0);\n\tint\t\t\tbits = PG_GETARG_INT32(1);\n\n\tif (bits == -1)\n\t\tbits = ip_maxbits(src);\n\n\tif ((bits < 0) || (bits > ip_maxbits(src)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"invalid mask length: %d\", bits)));\n\n\tPG_RETURN_INET_P(cidr_set_masklen_internal(src, bits));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "cidr_set_masklen_internal(src, bits)"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cidr_set_masklen_internal",
          "args": [
            "src",
            "bits"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "cidr_set_masklen_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "326-350",
          "snippet": "inet *\ncidr_set_masklen_internal(const inet *src, int bits)\n{\n\tinet\t   *dst = (inet *) palloc0(sizeof(inet));\n\n\tip_family(dst) = ip_family(src);\n\tip_bits(dst) = bits;\n\n\tif (bits > 0)\n\t{\n\t\tAssert(bits <= ip_maxbits(dst));\n\n\t\t/* Clone appropriate bytes of the address, leaving the rest 0 */\n\t\tmemcpy(ip_addr(dst), ip_addr(src), (bits + 7) / 8);\n\n\t\t/* Clear any unwanted bits in the last partial byte */\n\t\tif (bits % 8)\n\t\t\tip_addr(dst)[bits / 8] &= ~(0xFF >> (bits % 8));\n\t}\n\n\t/* Set varlena header correctly */\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\ninet *\ncidr_set_masklen_internal(const inet *src, int bits)\n{\n\tinet\t   *dst = (inet *) palloc0(sizeof(inet));\n\n\tip_family(dst) = ip_family(src);\n\tip_bits(dst) = bits;\n\n\tif (bits > 0)\n\t{\n\t\tAssert(bits <= ip_maxbits(dst));\n\n\t\t/* Clone appropriate bytes of the address, leaving the rest 0 */\n\t\tmemcpy(ip_addr(dst), ip_addr(src), (bits + 7) / 8);\n\n\t\t/* Clear any unwanted bits in the last partial byte */\n\t\tif (bits % 8)\n\t\t\tip_addr(dst)[bits / 8] &= ~(0xFF >> (bits % 8));\n\t}\n\n\t/* Set varlena header correctly */\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"invalid mask length: %d\", bits))"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid mask length: %d\"",
            "bits"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_PARAMETER_VALUE"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "src"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "src"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "1"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ncidr_set_masklen(PG_FUNCTION_ARGS)\n{\n\tinet\t   *src = PG_GETARG_INET_PP(0);\n\tint\t\t\tbits = PG_GETARG_INT32(1);\n\n\tif (bits == -1)\n\t\tbits = ip_maxbits(src);\n\n\tif ((bits < 0) || (bits > ip_maxbits(src)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"invalid mask length: %d\", bits)));\n\n\tPG_RETURN_INET_P(cidr_set_masklen_internal(src, bits));\n}"
  },
  {
    "function_name": "inet_set_masklen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "282-304",
    "snippet": "Datum\ninet_set_masklen(PG_FUNCTION_ARGS)\n{\n\tinet\t   *src = PG_GETARG_INET_PP(0);\n\tint\t\t\tbits = PG_GETARG_INT32(1);\n\tinet\t   *dst;\n\n\tif (bits == -1)\n\t\tbits = ip_maxbits(src);\n\n\tif ((bits < 0) || (bits > ip_maxbits(src)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"invalid mask length: %d\", bits)));\n\n\t/* clone the original data */\n\tdst = (inet *) palloc(VARSIZE_ANY(src));\n\tmemcpy(dst, src, VARSIZE_ANY(src));\n\n\tip_bits(dst) = bits;\n\n\tPG_RETURN_INET_P(dst);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "dst"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "src",
            "VARSIZE_ANY(src)"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARSIZE_ANY",
          "args": [
            "src"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "VARSIZE_ANY(src)"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VARSIZE_ANY",
          "args": [
            "src"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"invalid mask length: %d\", bits))"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid mask length: %d\"",
            "bits"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_PARAMETER_VALUE"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "src"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "src"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "1"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_set_masklen(PG_FUNCTION_ARGS)\n{\n\tinet\t   *src = PG_GETARG_INET_PP(0);\n\tint\t\t\tbits = PG_GETARG_INT32(1);\n\tinet\t   *dst;\n\n\tif (bits == -1)\n\t\tbits = ip_maxbits(src);\n\n\tif ((bits < 0) || (bits > ip_maxbits(src)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"invalid mask length: %d\", bits)));\n\n\t/* clone the original data */\n\tdst = (inet *) palloc(VARSIZE_ANY(src));\n\tmemcpy(dst, src, VARSIZE_ANY(src));\n\n\tip_bits(dst) = bits;\n\n\tPG_RETURN_INET_P(dst);\n}"
  },
  {
    "function_name": "inet_to_cidr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "267-280",
    "snippet": "Datum\ninet_to_cidr(PG_FUNCTION_ARGS)\n{\n\tinet\t   *src = PG_GETARG_INET_PP(0);\n\tint\t\t\tbits;\n\n\tbits = ip_bits(src);\n\n\t/* safety check */\n\tif ((bits < 0) || (bits > ip_maxbits(src)))\n\t\telog(ERROR, \"invalid inet bit length: %d\", bits);\n\n\tPG_RETURN_INET_P(cidr_set_masklen_internal(src, bits));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "cidr_set_masklen_internal(src, bits)"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cidr_set_masklen_internal",
          "args": [
            "src",
            "bits"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "cidr_set_masklen_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "326-350",
          "snippet": "inet *\ncidr_set_masklen_internal(const inet *src, int bits)\n{\n\tinet\t   *dst = (inet *) palloc0(sizeof(inet));\n\n\tip_family(dst) = ip_family(src);\n\tip_bits(dst) = bits;\n\n\tif (bits > 0)\n\t{\n\t\tAssert(bits <= ip_maxbits(dst));\n\n\t\t/* Clone appropriate bytes of the address, leaving the rest 0 */\n\t\tmemcpy(ip_addr(dst), ip_addr(src), (bits + 7) / 8);\n\n\t\t/* Clear any unwanted bits in the last partial byte */\n\t\tif (bits % 8)\n\t\t\tip_addr(dst)[bits / 8] &= ~(0xFF >> (bits % 8));\n\t}\n\n\t/* Set varlena header correctly */\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\ninet *\ncidr_set_masklen_internal(const inet *src, int bits)\n{\n\tinet\t   *dst = (inet *) palloc0(sizeof(inet));\n\n\tip_family(dst) = ip_family(src);\n\tip_bits(dst) = bits;\n\n\tif (bits > 0)\n\t{\n\t\tAssert(bits <= ip_maxbits(dst));\n\n\t\t/* Clone appropriate bytes of the address, leaving the rest 0 */\n\t\tmemcpy(ip_addr(dst), ip_addr(src), (bits + 7) / 8);\n\n\t\t/* Clear any unwanted bits in the last partial byte */\n\t\tif (bits % 8)\n\t\t\tip_addr(dst)[bits / 8] &= ~(0xFF >> (bits % 8));\n\t}\n\n\t/* Set varlena header correctly */\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"invalid inet bit length: %d\"",
            "bits"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "src"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "src"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_to_cidr(PG_FUNCTION_ARGS)\n{\n\tinet\t   *src = PG_GETARG_INET_PP(0);\n\tint\t\t\tbits;\n\n\tbits = ip_bits(src);\n\n\t/* safety check */\n\tif ((bits < 0) || (bits > ip_maxbits(src)))\n\t\telog(ERROR, \"invalid inet bit length: %d\", bits);\n\n\tPG_RETURN_INET_P(cidr_set_masklen_internal(src, bits));\n}"
  },
  {
    "function_name": "cidr_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "258-264",
    "snippet": "Datum\ncidr_send(PG_FUNCTION_ARGS)\n{\n\tinet\t   *addr = PG_GETARG_INET_PP(0);\n\n\tPG_RETURN_BYTEA_P(network_send(addr, true));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BYTEA_P",
          "args": [
            "network_send(addr, true)"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_send",
          "args": [
            "addr",
            "true"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "network_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "228-248",
          "snippet": "static bytea *\nnetwork_send(inet *addr, bool is_cidr)\n{\n\tStringInfoData buf;\n\tchar\t   *addrptr;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\tpq_begintypsend(&buf);\n\tpq_sendbyte(&buf, ip_family(addr));\n\tpq_sendbyte(&buf, ip_bits(addr));\n\tpq_sendbyte(&buf, is_cidr);\n\tnb = ip_addrsize(addr);\n\tif (nb < 0)\n\t\tnb = 0;\n\tpq_sendbyte(&buf, nb);\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\tpq_sendbyte(&buf, addrptr[i]);\n\treturn pq_endtypsend(&buf);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic bytea *\nnetwork_send(inet *addr, bool is_cidr)\n{\n\tStringInfoData buf;\n\tchar\t   *addrptr;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\tpq_begintypsend(&buf);\n\tpq_sendbyte(&buf, ip_family(addr));\n\tpq_sendbyte(&buf, ip_bits(addr));\n\tpq_sendbyte(&buf, is_cidr);\n\tnb = ip_addrsize(addr);\n\tif (nb < 0)\n\t\tnb = 0;\n\tpq_sendbyte(&buf, nb);\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\tpq_sendbyte(&buf, addrptr[i]);\n\treturn pq_endtypsend(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ncidr_send(PG_FUNCTION_ARGS)\n{\n\tinet\t   *addr = PG_GETARG_INET_PP(0);\n\n\tPG_RETURN_BYTEA_P(network_send(addr, true));\n}"
  },
  {
    "function_name": "inet_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "250-256",
    "snippet": "Datum\ninet_send(PG_FUNCTION_ARGS)\n{\n\tinet\t   *addr = PG_GETARG_INET_PP(0);\n\n\tPG_RETURN_BYTEA_P(network_send(addr, false));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BYTEA_P",
          "args": [
            "network_send(addr, false)"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_send",
          "args": [
            "addr",
            "false"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "network_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "228-248",
          "snippet": "static bytea *\nnetwork_send(inet *addr, bool is_cidr)\n{\n\tStringInfoData buf;\n\tchar\t   *addrptr;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\tpq_begintypsend(&buf);\n\tpq_sendbyte(&buf, ip_family(addr));\n\tpq_sendbyte(&buf, ip_bits(addr));\n\tpq_sendbyte(&buf, is_cidr);\n\tnb = ip_addrsize(addr);\n\tif (nb < 0)\n\t\tnb = 0;\n\tpq_sendbyte(&buf, nb);\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\tpq_sendbyte(&buf, addrptr[i]);\n\treturn pq_endtypsend(&buf);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic bytea *\nnetwork_send(inet *addr, bool is_cidr)\n{\n\tStringInfoData buf;\n\tchar\t   *addrptr;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\tpq_begintypsend(&buf);\n\tpq_sendbyte(&buf, ip_family(addr));\n\tpq_sendbyte(&buf, ip_bits(addr));\n\tpq_sendbyte(&buf, is_cidr);\n\tnb = ip_addrsize(addr);\n\tif (nb < 0)\n\t\tnb = 0;\n\tpq_sendbyte(&buf, nb);\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\tpq_sendbyte(&buf, addrptr[i]);\n\treturn pq_endtypsend(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_send(PG_FUNCTION_ARGS)\n{\n\tinet\t   *addr = PG_GETARG_INET_PP(0);\n\n\tPG_RETURN_BYTEA_P(network_send(addr, false));\n}"
  },
  {
    "function_name": "network_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "228-248",
    "snippet": "static bytea *\nnetwork_send(inet *addr, bool is_cidr)\n{\n\tStringInfoData buf;\n\tchar\t   *addrptr;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\tpq_begintypsend(&buf);\n\tpq_sendbyte(&buf, ip_family(addr));\n\tpq_sendbyte(&buf, ip_bits(addr));\n\tpq_sendbyte(&buf, is_cidr);\n\tnb = ip_addrsize(addr);\n\tif (nb < 0)\n\t\tnb = 0;\n\tpq_sendbyte(&buf, nb);\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\tpq_sendbyte(&buf, addrptr[i]);\n\treturn pq_endtypsend(&buf);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pq_endtypsend",
          "args": [
            "&buf"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "addrptr[i]"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "addr"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "nb"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "addr"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "is_cidr"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "ip_bits(addr)"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "addr"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_sendbyte",
          "args": [
            "&buf",
            "ip_family(addr)"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "addr"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_begintypsend",
          "args": [
            "&buf"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic bytea *\nnetwork_send(inet *addr, bool is_cidr)\n{\n\tStringInfoData buf;\n\tchar\t   *addrptr;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\tpq_begintypsend(&buf);\n\tpq_sendbyte(&buf, ip_family(addr));\n\tpq_sendbyte(&buf, ip_bits(addr));\n\tpq_sendbyte(&buf, is_cidr);\n\tnb = ip_addrsize(addr);\n\tif (nb < 0)\n\t\tnb = 0;\n\tpq_sendbyte(&buf, nb);\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\tpq_sendbyte(&buf, addrptr[i]);\n\treturn pq_endtypsend(&buf);\n}"
  },
  {
    "function_name": "cidr_recv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "216-222",
    "snippet": "Datum\ncidr_recv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\n\tPG_RETURN_INET_P(network_recv(buf, true));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "network_recv(buf, true)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_recv",
          "args": [
            "buf",
            "true"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "network_recv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "150-206",
          "snippet": "static inet *\nnetwork_recv(StringInfo buf, bool is_cidr)\n{\n\tinet\t   *addr;\n\tchar\t   *addrptr;\n\tint\t\t\tbits;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\t/* make sure any unused bits in a CIDR value are zeroed */\n\taddr = (inet *) palloc0(sizeof(inet));\n\n\tip_family(addr) = pq_getmsgbyte(buf);\n\tif (ip_family(addr) != PGSQL_AF_INET &&\n\t\tip_family(addr) != PGSQL_AF_INET6)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid address family in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tbits = pq_getmsgbyte(buf);\n\tif (bits < 0 || bits > ip_maxbits(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid bits in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tip_bits(addr) = bits;\n\ti = pq_getmsgbyte(buf);\t\t/* ignore is_cidr */\n\tnb = pq_getmsgbyte(buf);\n\tif (nb != ip_addrsize(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid length in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\taddrptr[i] = pq_getmsgbyte(buf);\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(addr), bits, ip_family(addr)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid external \\\"cidr\\\" value\"),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tSET_INET_VARSIZE(addr);\n\n\treturn addr;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool addressOK(unsigned char *a, int bits, int family);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic bool addressOK(unsigned char *a, int bits, int family);\n\nstatic inet *\nnetwork_recv(StringInfo buf, bool is_cidr)\n{\n\tinet\t   *addr;\n\tchar\t   *addrptr;\n\tint\t\t\tbits;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\t/* make sure any unused bits in a CIDR value are zeroed */\n\taddr = (inet *) palloc0(sizeof(inet));\n\n\tip_family(addr) = pq_getmsgbyte(buf);\n\tif (ip_family(addr) != PGSQL_AF_INET &&\n\t\tip_family(addr) != PGSQL_AF_INET6)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid address family in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tbits = pq_getmsgbyte(buf);\n\tif (bits < 0 || bits > ip_maxbits(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid bits in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tip_bits(addr) = bits;\n\ti = pq_getmsgbyte(buf);\t\t/* ignore is_cidr */\n\tnb = pq_getmsgbyte(buf);\n\tif (nb != ip_addrsize(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid length in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\taddrptr[i] = pq_getmsgbyte(buf);\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(addr), bits, ip_family(addr)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid external \\\"cidr\\\" value\"),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tSET_INET_VARSIZE(addr);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ncidr_recv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\n\tPG_RETURN_INET_P(network_recv(buf, true));\n}"
  },
  {
    "function_name": "inet_recv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "208-214",
    "snippet": "Datum\ninet_recv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\n\tPG_RETURN_INET_P(network_recv(buf, false));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "network_recv(buf, false)"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_recv",
          "args": [
            "buf",
            "false"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "network_recv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "150-206",
          "snippet": "static inet *\nnetwork_recv(StringInfo buf, bool is_cidr)\n{\n\tinet\t   *addr;\n\tchar\t   *addrptr;\n\tint\t\t\tbits;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\t/* make sure any unused bits in a CIDR value are zeroed */\n\taddr = (inet *) palloc0(sizeof(inet));\n\n\tip_family(addr) = pq_getmsgbyte(buf);\n\tif (ip_family(addr) != PGSQL_AF_INET &&\n\t\tip_family(addr) != PGSQL_AF_INET6)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid address family in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tbits = pq_getmsgbyte(buf);\n\tif (bits < 0 || bits > ip_maxbits(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid bits in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tip_bits(addr) = bits;\n\ti = pq_getmsgbyte(buf);\t\t/* ignore is_cidr */\n\tnb = pq_getmsgbyte(buf);\n\tif (nb != ip_addrsize(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid length in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\taddrptr[i] = pq_getmsgbyte(buf);\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(addr), bits, ip_family(addr)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid external \\\"cidr\\\" value\"),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tSET_INET_VARSIZE(addr);\n\n\treturn addr;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool addressOK(unsigned char *a, int bits, int family);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic bool addressOK(unsigned char *a, int bits, int family);\n\nstatic inet *\nnetwork_recv(StringInfo buf, bool is_cidr)\n{\n\tinet\t   *addr;\n\tchar\t   *addrptr;\n\tint\t\t\tbits;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\t/* make sure any unused bits in a CIDR value are zeroed */\n\taddr = (inet *) palloc0(sizeof(inet));\n\n\tip_family(addr) = pq_getmsgbyte(buf);\n\tif (ip_family(addr) != PGSQL_AF_INET &&\n\t\tip_family(addr) != PGSQL_AF_INET6)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid address family in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tbits = pq_getmsgbyte(buf);\n\tif (bits < 0 || bits > ip_maxbits(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid bits in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tip_bits(addr) = bits;\n\ti = pq_getmsgbyte(buf);\t\t/* ignore is_cidr */\n\tnb = pq_getmsgbyte(buf);\n\tif (nb != ip_addrsize(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid length in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\taddrptr[i] = pq_getmsgbyte(buf);\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(addr), bits, ip_family(addr)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid external \\\"cidr\\\" value\"),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tSET_INET_VARSIZE(addr);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_POINTER",
          "args": [
            "0"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_recv(PG_FUNCTION_ARGS)\n{\n\tStringInfo\tbuf = (StringInfo) PG_GETARG_POINTER(0);\n\n\tPG_RETURN_INET_P(network_recv(buf, false));\n}"
  },
  {
    "function_name": "network_recv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "150-206",
    "snippet": "static inet *\nnetwork_recv(StringInfo buf, bool is_cidr)\n{\n\tinet\t   *addr;\n\tchar\t   *addrptr;\n\tint\t\t\tbits;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\t/* make sure any unused bits in a CIDR value are zeroed */\n\taddr = (inet *) palloc0(sizeof(inet));\n\n\tip_family(addr) = pq_getmsgbyte(buf);\n\tif (ip_family(addr) != PGSQL_AF_INET &&\n\t\tip_family(addr) != PGSQL_AF_INET6)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid address family in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tbits = pq_getmsgbyte(buf);\n\tif (bits < 0 || bits > ip_maxbits(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid bits in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tip_bits(addr) = bits;\n\ti = pq_getmsgbyte(buf);\t\t/* ignore is_cidr */\n\tnb = pq_getmsgbyte(buf);\n\tif (nb != ip_addrsize(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid length in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\taddrptr[i] = pq_getmsgbyte(buf);\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(addr), bits, ip_family(addr)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid external \\\"cidr\\\" value\"),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tSET_INET_VARSIZE(addr);\n\n\treturn addr;\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static bool addressOK(unsigned char *a, int bits, int family);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "addr"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid external \\\"cidr\\\" value\"),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\"))"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errdetail",
          "args": [
            "\"Value has bits set to right of mask.\""
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "errdetail_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "918-933",
          "snippet": "int\nerrdetail_log(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, detail_log, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrdetail_log(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, detail_log, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid external \\\"cidr\\\" value\""
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_BINARY_REPRESENTATION"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "addressOK",
          "args": [
            "ip_addr(addr)",
            "bits",
            "ip_family(addr)"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "addressOK",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "1048-1088",
          "snippet": "static bool\naddressOK(unsigned char *a, int bits, int family)\n{\n\tint\t\t\tbyte;\n\tint\t\t\tnbits;\n\tint\t\t\tmaxbits;\n\tint\t\t\tmaxbytes;\n\tunsigned char mask;\n\n\tif (family == PGSQL_AF_INET)\n\t{\n\t\tmaxbits = 32;\n\t\tmaxbytes = 4;\n\t}\n\telse\n\t{\n\t\tmaxbits = 128;\n\t\tmaxbytes = 16;\n\t}\n\tAssert(bits <= maxbits);\n\n\tif (bits == maxbits)\n\t\treturn true;\n\n\tbyte = bits / 8;\n\n\tnbits = bits % 8;\n\tmask = 0xff;\n\tif (bits != 0)\n\t\tmask >>= nbits;\n\n\twhile (byte < maxbytes)\n\t{\n\t\tif ((a[byte] & mask) != 0)\n\t\t\treturn false;\n\t\tmask = 0xff;\n\t\tbyte++;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool addressOK(unsigned char *a, int bits, int family);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic bool addressOK(unsigned char *a, int bits, int family);\n\nstatic bool\naddressOK(unsigned char *a, int bits, int family)\n{\n\tint\t\t\tbyte;\n\tint\t\t\tnbits;\n\tint\t\t\tmaxbits;\n\tint\t\t\tmaxbytes;\n\tunsigned char mask;\n\n\tif (family == PGSQL_AF_INET)\n\t{\n\t\tmaxbits = 32;\n\t\tmaxbytes = 4;\n\t}\n\telse\n\t{\n\t\tmaxbits = 128;\n\t\tmaxbytes = 16;\n\t}\n\tAssert(bits <= maxbits);\n\n\tif (bits == maxbits)\n\t\treturn true;\n\n\tbyte = bits / 8;\n\n\tnbits = bits % 8;\n\tmask = 0xff;\n\tif (bits != 0)\n\t\tmask >>= nbits;\n\n\twhile (byte < maxbytes)\n\t{\n\t\tif ((a[byte] & mask) != 0)\n\t\t\treturn false;\n\t\tmask = 0xff;\n\t\tbyte++;\n\t}\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "addr"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "addr"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "addr"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid length in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\"))"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "addr"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "addr"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid bits in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\"))"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "addr"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid address family in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\"))"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "addr"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "addr"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pq_getmsgbyte",
          "args": [
            "buf"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "addr"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic bool addressOK(unsigned char *a, int bits, int family);\n\nstatic inet *\nnetwork_recv(StringInfo buf, bool is_cidr)\n{\n\tinet\t   *addr;\n\tchar\t   *addrptr;\n\tint\t\t\tbits;\n\tint\t\t\tnb,\n\t\t\t\ti;\n\n\t/* make sure any unused bits in a CIDR value are zeroed */\n\taddr = (inet *) palloc0(sizeof(inet));\n\n\tip_family(addr) = pq_getmsgbyte(buf);\n\tif (ip_family(addr) != PGSQL_AF_INET &&\n\t\tip_family(addr) != PGSQL_AF_INET6)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid address family in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tbits = pq_getmsgbyte(buf);\n\tif (bits < 0 || bits > ip_maxbits(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid bits in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\tip_bits(addr) = bits;\n\ti = pq_getmsgbyte(buf);\t\t/* ignore is_cidr */\n\tnb = pq_getmsgbyte(buf);\n\tif (nb != ip_addrsize(addr))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t/* translator: %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid length in external \\\"%s\\\" value\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\")));\n\n\taddrptr = (char *) ip_addr(addr);\n\tfor (i = 0; i < nb; i++)\n\t\taddrptr[i] = pq_getmsgbyte(buf);\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(addr), bits, ip_family(addr)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid external \\\"cidr\\\" value\"),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tSET_INET_VARSIZE(addr);\n\n\treturn addr;\n}"
  },
  {
    "function_name": "cidr_out",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "131-137",
    "snippet": "Datum\ncidr_out(PG_FUNCTION_ARGS)\n{\n\tinet\t   *src = PG_GETARG_INET_PP(0);\n\n\tPG_RETURN_CSTRING(network_out(src, true));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_CSTRING",
          "args": [
            "network_out(src, true)"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_out",
          "args": [
            "src",
            "true"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "network_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "99-121",
          "snippet": "static char *\nnetwork_out(inet *src, bool is_cidr)\n{\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\tchar\t   *dst;\n\tint\t\t\tlen;\n\n\tdst = inet_net_ntop(ip_family(src), ip_addr(src), ip_bits(src),\n\t\t\t\t\t\ttmp, sizeof(tmp));\n\tif (dst == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\t/* For CIDR, add /n if not present */\n\tif (is_cidr && strchr(tmp, '/') == NULL)\n\t{\n\t\tlen = strlen(tmp);\n\t\tsnprintf(tmp + len, sizeof(tmp) - len, \"/%u\", ip_bits(src));\n\t}\n\n\treturn pstrdup(tmp);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic char *\nnetwork_out(inet *src, bool is_cidr)\n{\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\tchar\t   *dst;\n\tint\t\t\tlen;\n\n\tdst = inet_net_ntop(ip_family(src), ip_addr(src), ip_bits(src),\n\t\t\t\t\t\ttmp, sizeof(tmp));\n\tif (dst == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\t/* For CIDR, add /n if not present */\n\tif (is_cidr && strchr(tmp, '/') == NULL)\n\t{\n\t\tlen = strlen(tmp);\n\t\tsnprintf(tmp + len, sizeof(tmp) - len, \"/%u\", ip_bits(src));\n\t}\n\n\treturn pstrdup(tmp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ncidr_out(PG_FUNCTION_ARGS)\n{\n\tinet\t   *src = PG_GETARG_INET_PP(0);\n\n\tPG_RETURN_CSTRING(network_out(src, true));\n}"
  },
  {
    "function_name": "inet_out",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "123-129",
    "snippet": "Datum\ninet_out(PG_FUNCTION_ARGS)\n{\n\tinet\t   *src = PG_GETARG_INET_PP(0);\n\n\tPG_RETURN_CSTRING(network_out(src, false));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_CSTRING",
          "args": [
            "network_out(src, false)"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_out",
          "args": [
            "src",
            "false"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "network_out",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "99-121",
          "snippet": "static char *\nnetwork_out(inet *src, bool is_cidr)\n{\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\tchar\t   *dst;\n\tint\t\t\tlen;\n\n\tdst = inet_net_ntop(ip_family(src), ip_addr(src), ip_bits(src),\n\t\t\t\t\t\ttmp, sizeof(tmp));\n\tif (dst == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\t/* For CIDR, add /n if not present */\n\tif (is_cidr && strchr(tmp, '/') == NULL)\n\t{\n\t\tlen = strlen(tmp);\n\t\tsnprintf(tmp + len, sizeof(tmp) - len, \"/%u\", ip_bits(src));\n\t}\n\n\treturn pstrdup(tmp);\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic char *\nnetwork_out(inet *src, bool is_cidr)\n{\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\tchar\t   *dst;\n\tint\t\t\tlen;\n\n\tdst = inet_net_ntop(ip_family(src), ip_addr(src), ip_bits(src),\n\t\t\t\t\t\ttmp, sizeof(tmp));\n\tif (dst == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\t/* For CIDR, add /n if not present */\n\tif (is_cidr && strchr(tmp, '/') == NULL)\n\t{\n\t\tlen = strlen(tmp);\n\t\tsnprintf(tmp + len, sizeof(tmp) - len, \"/%u\", ip_bits(src));\n\t}\n\n\treturn pstrdup(tmp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INET_PP",
          "args": [
            "0"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_out(PG_FUNCTION_ARGS)\n{\n\tinet\t   *src = PG_GETARG_INET_PP(0);\n\n\tPG_RETURN_CSTRING(network_out(src, false));\n}"
  },
  {
    "function_name": "network_out",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "99-121",
    "snippet": "static char *\nnetwork_out(inet *src, bool is_cidr)\n{\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\tchar\t   *dst;\n\tint\t\t\tlen;\n\n\tdst = inet_net_ntop(ip_family(src), ip_addr(src), ip_bits(src),\n\t\t\t\t\t\ttmp, sizeof(tmp));\n\tif (dst == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\t/* For CIDR, add /n if not present */\n\tif (is_cidr && strchr(tmp, '/') == NULL)\n\t{\n\t\tlen = strlen(tmp);\n\t\tsnprintf(tmp + len, sizeof(tmp) - len, \"/%u\", ip_bits(src));\n\t}\n\n\treturn pstrdup(tmp);\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pstrdup",
          "args": [
            "tmp"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pstrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1658-1662",
          "snippet": "static char *\nxml_pstrdup(const char *string)\n{\n\treturn MemoryContextStrdup(LibxmlContext, string);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic char *\nxml_pstrdup(const char *string)\n{\n\treturn MemoryContextStrdup(LibxmlContext, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "tmp + len",
            "sizeof(tmp) - len",
            "\"/%u\"",
            "ip_bits(src)"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "src"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tmp"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "calcstrlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_cleanup.c",
          "lines": "361-380",
          "snippet": "static int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nstatic int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "tmp",
            "'/'"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\"))"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"could not format inet value: %m\""
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_BINARY_REPRESENTATION"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "inet_net_ntop",
          "args": [
            "ip_family(src)",
            "ip_addr(src)",
            "ip_bits(src)",
            "tmp",
            "sizeof(tmp)"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "src"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "src"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "src"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic char *\nnetwork_out(inet *src, bool is_cidr)\n{\n\tchar\t\ttmp[sizeof(\"xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:255.255.255.255/128\")];\n\tchar\t   *dst;\n\tint\t\t\tlen;\n\n\tdst = inet_net_ntop(ip_family(src), ip_addr(src), ip_bits(src),\n\t\t\t\t\t\ttmp, sizeof(tmp));\n\tif (dst == NULL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_BINARY_REPRESENTATION),\n\t\t\t\t errmsg(\"could not format inet value: %m\")));\n\n\t/* For CIDR, add /n if not present */\n\tif (is_cidr && strchr(tmp, '/') == NULL)\n\t{\n\t\tlen = strlen(tmp);\n\t\tsnprintf(tmp + len, sizeof(tmp) - len, \"/%u\", ip_bits(src));\n\t}\n\n\treturn pstrdup(tmp);\n}"
  },
  {
    "function_name": "cidr_in",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "87-93",
    "snippet": "Datum\ncidr_in(PG_FUNCTION_ARGS)\n{\n\tchar\t   *src = PG_GETARG_CSTRING(0);\n\n\tPG_RETURN_INET_P(network_in(src, true));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "network_in(src, true)"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_in",
          "args": [
            "src",
            "true"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "network_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "33-77",
          "snippet": "static inet *\nnetwork_in(char *src, bool is_cidr)\n{\n\tint\t\t\tbits;\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t/*\n\t * First, check to see if this is an IPv6 or IPv4 address.  IPv6 addresses\n\t * will have a : somewhere in them (several, in fact) so if there is one\n\t * present, assume it's V6, otherwise assume it's V4.\n\t */\n\n\tif (strchr(src, ':') != NULL)\n\t\tip_family(dst) = PGSQL_AF_INET6;\n\telse\n\t\tip_family(dst) = PGSQL_AF_INET;\n\n\tbits = inet_net_pton(ip_family(dst), src, ip_addr(dst),\n\t\t\t\t\t\t is_cidr ? ip_addrsize(dst) : -1);\n\tif ((bits < 0) || (bits > ip_maxbits(dst)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src)));\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(dst), bits, ip_family(dst)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tip_bits(dst) = bits;\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic inet *\nnetwork_in(char *src, bool is_cidr)\n{\n\tint\t\t\tbits;\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t/*\n\t * First, check to see if this is an IPv6 or IPv4 address.  IPv6 addresses\n\t * will have a : somewhere in them (several, in fact) so if there is one\n\t * present, assume it's V6, otherwise assume it's V4.\n\t */\n\n\tif (strchr(src, ':') != NULL)\n\t\tip_family(dst) = PGSQL_AF_INET6;\n\telse\n\t\tip_family(dst) = PGSQL_AF_INET;\n\n\tbits = inet_net_pton(ip_family(dst), src, ip_addr(dst),\n\t\t\t\t\t\t is_cidr ? ip_addrsize(dst) : -1);\n\tif ((bits < 0) || (bits > ip_maxbits(dst)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src)));\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(dst), bits, ip_family(dst)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tip_bits(dst) = bits;\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "0"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ncidr_in(PG_FUNCTION_ARGS)\n{\n\tchar\t   *src = PG_GETARG_CSTRING(0);\n\n\tPG_RETURN_INET_P(network_in(src, true));\n}"
  },
  {
    "function_name": "inet_in",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "79-85",
    "snippet": "Datum\ninet_in(PG_FUNCTION_ARGS)\n{\n\tchar\t   *src = PG_GETARG_CSTRING(0);\n\n\tPG_RETURN_INET_P(network_in(src, false));\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "network_in(src, false)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_in",
          "args": [
            "src",
            "false"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "network_in",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "33-77",
          "snippet": "static inet *\nnetwork_in(char *src, bool is_cidr)\n{\n\tint\t\t\tbits;\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t/*\n\t * First, check to see if this is an IPv6 or IPv4 address.  IPv6 addresses\n\t * will have a : somewhere in them (several, in fact) so if there is one\n\t * present, assume it's V6, otherwise assume it's V4.\n\t */\n\n\tif (strchr(src, ':') != NULL)\n\t\tip_family(dst) = PGSQL_AF_INET6;\n\telse\n\t\tip_family(dst) = PGSQL_AF_INET;\n\n\tbits = inet_net_pton(ip_family(dst), src, ip_addr(dst),\n\t\t\t\t\t\t is_cidr ? ip_addrsize(dst) : -1);\n\tif ((bits < 0) || (bits > ip_maxbits(dst)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src)));\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(dst), bits, ip_family(dst)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tip_bits(dst) = bits;\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic inet *\nnetwork_in(char *src, bool is_cidr)\n{\n\tint\t\t\tbits;\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t/*\n\t * First, check to see if this is an IPv6 or IPv4 address.  IPv6 addresses\n\t * will have a : somewhere in them (several, in fact) so if there is one\n\t * present, assume it's V6, otherwise assume it's V4.\n\t */\n\n\tif (strchr(src, ':') != NULL)\n\t\tip_family(dst) = PGSQL_AF_INET6;\n\telse\n\t\tip_family(dst) = PGSQL_AF_INET;\n\n\tbits = inet_net_pton(ip_family(dst), src, ip_addr(dst),\n\t\t\t\t\t\t is_cidr ? ip_addrsize(dst) : -1);\n\tif ((bits < 0) || (bits > ip_maxbits(dst)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src)));\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(dst), bits, ip_family(dst)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tip_bits(dst) = bits;\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "0"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nDatum\ninet_in(PG_FUNCTION_ARGS)\n{\n\tchar\t   *src = PG_GETARG_CSTRING(0);\n\n\tPG_RETURN_INET_P(network_in(src, false));\n}"
  },
  {
    "function_name": "network_in",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
    "lines": "33-77",
    "snippet": "static inet *\nnetwork_in(char *src, bool is_cidr)\n{\n\tint\t\t\tbits;\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t/*\n\t * First, check to see if this is an IPv6 or IPv4 address.  IPv6 addresses\n\t * will have a : somewhere in them (several, in fact) so if there is one\n\t * present, assume it's V6, otherwise assume it's V4.\n\t */\n\n\tif (strchr(src, ':') != NULL)\n\t\tip_family(dst) = PGSQL_AF_INET6;\n\telse\n\t\tip_family(dst) = PGSQL_AF_INET;\n\n\tbits = inet_net_pton(ip_family(dst), src, ip_addr(dst),\n\t\t\t\t\t\t is_cidr ? ip_addrsize(dst) : -1);\n\tif ((bits < 0) || (bits > ip_maxbits(dst)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src)));\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(dst), bits, ip_family(dst)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tip_bits(dst) = bits;\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}",
    "includes": [
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"miscadmin.h\"",
      "#include \"libpq/pqformat.h\"",
      "#include \"libpq/libpq-be.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"access/hash.h\"",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SET_INET_VARSIZE",
          "args": [
            "dst"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_bits",
          "args": [
            "dst"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\"))"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errdetail",
          "args": [
            "\"Value has bits set to right of mask.\""
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "errdetail_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "918-933",
          "snippet": "int\nerrdetail_log(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, detail_log, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrdetail_log(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, detail_log, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid cidr value: \\\"%s\\\"\"",
            "src"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_TEXT_REPRESENTATION"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "addressOK",
          "args": [
            "ip_addr(dst)",
            "bits",
            "ip_family(dst)"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "addressOK",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "1048-1088",
          "snippet": "static bool\naddressOK(unsigned char *a, int bits, int family)\n{\n\tint\t\t\tbyte;\n\tint\t\t\tnbits;\n\tint\t\t\tmaxbits;\n\tint\t\t\tmaxbytes;\n\tunsigned char mask;\n\n\tif (family == PGSQL_AF_INET)\n\t{\n\t\tmaxbits = 32;\n\t\tmaxbytes = 4;\n\t}\n\telse\n\t{\n\t\tmaxbits = 128;\n\t\tmaxbytes = 16;\n\t}\n\tAssert(bits <= maxbits);\n\n\tif (bits == maxbits)\n\t\treturn true;\n\n\tbyte = bits / 8;\n\n\tnbits = bits % 8;\n\tmask = 0xff;\n\tif (bits != 0)\n\t\tmask >>= nbits;\n\n\twhile (byte < maxbytes)\n\t{\n\t\tif ((a[byte] & mask) != 0)\n\t\t\treturn false;\n\t\tmask = 0xff;\n\t\tbyte++;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool addressOK(unsigned char *a, int bits, int family);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic bool addressOK(unsigned char *a, int bits, int family);\n\nstatic bool\naddressOK(unsigned char *a, int bits, int family)\n{\n\tint\t\t\tbyte;\n\tint\t\t\tnbits;\n\tint\t\t\tmaxbits;\n\tint\t\t\tmaxbytes;\n\tunsigned char mask;\n\n\tif (family == PGSQL_AF_INET)\n\t{\n\t\tmaxbits = 32;\n\t\tmaxbytes = 4;\n\t}\n\telse\n\t{\n\t\tmaxbits = 128;\n\t\tmaxbytes = 16;\n\t}\n\tAssert(bits <= maxbits);\n\n\tif (bits == maxbits)\n\t\treturn true;\n\n\tbyte = bits / 8;\n\n\tnbits = bits % 8;\n\tmask = 0xff;\n\tif (bits != 0)\n\t\tmask >>= nbits;\n\n\twhile (byte < maxbytes)\n\t{\n\t\tif ((a[byte] & mask) != 0)\n\t\t\treturn false;\n\t\tmask = 0xff;\n\t\tbyte++;\n\t}\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src))"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_maxbits",
          "args": [
            "dst"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_net_pton",
          "args": [
            "ip_family(dst)",
            "src",
            "ip_addr(dst)",
            "is_cidr ? ip_addrsize(dst) : -1"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "inet_net_pton",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/inet_net_pton.c",
          "lines": "61-78",
          "snippet": "int\ninet_net_pton(int af, const char *src, void *dst, size_t size)\n{\n\tswitch (af)\n\t{\n\t\tcase PGSQL_AF_INET:\n\t\t\treturn size == -1 ?\n\t\t\t\tinet_net_pton_ipv4(src, dst) :\n\t\t\t\tinet_cidr_pton_ipv4(src, dst, size);\n\t\tcase PGSQL_AF_INET6:\n\t\t\treturn size == -1 ?\n\t\t\t\tinet_net_pton_ipv6(src, dst) :\n\t\t\t\tinet_cidr_pton_ipv6(src, dst, size);\n\t\tdefault:\n\t\t\terrno = EAFNOSUPPORT;\n\t\t\treturn -1;\n\t}\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\" /* pgrminclude ignore */\t/* needed on some\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t * platforms */",
            "#include <ctype.h>",
            "#include <assert.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tinet_net_pton_ipv4(const char *src, u_char *dst);",
            "static int\tinet_cidr_pton_ipv4(const char *src, u_char *dst, size_t size);",
            "static int\tinet_net_pton_ipv6(const char *src, u_char *dst);",
            "static int\tinet_cidr_pton_ipv6(const char *src, u_char *dst, size_t size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\" /* pgrminclude ignore */\t/* needed on some\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t * platforms */\n#include <ctype.h>\n#include <assert.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic int\tinet_net_pton_ipv4(const char *src, u_char *dst);\nstatic int\tinet_cidr_pton_ipv4(const char *src, u_char *dst, size_t size);\nstatic int\tinet_net_pton_ipv6(const char *src, u_char *dst);\nstatic int\tinet_cidr_pton_ipv6(const char *src, u_char *dst, size_t size);\n\nint\ninet_net_pton(int af, const char *src, void *dst, size_t size)\n{\n\tswitch (af)\n\t{\n\t\tcase PGSQL_AF_INET:\n\t\t\treturn size == -1 ?\n\t\t\t\tinet_net_pton_ipv4(src, dst) :\n\t\t\t\tinet_cidr_pton_ipv4(src, dst, size);\n\t\tcase PGSQL_AF_INET6:\n\t\t\treturn size == -1 ?\n\t\t\t\tinet_net_pton_ipv6(src, dst) :\n\t\t\t\tinet_cidr_pton_ipv6(src, dst, size);\n\t\tdefault:\n\t\t\terrno = EAFNOSUPPORT;\n\t\t\treturn -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip_addrsize",
          "args": [
            "dst"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_addr",
          "args": [
            "dst"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip_family",
          "args": [
            "dst"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "src",
            "':'"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "sizeof(inet)"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nstatic inet *\nnetwork_in(char *src, bool is_cidr)\n{\n\tint\t\t\tbits;\n\tinet\t   *dst;\n\n\tdst = (inet *) palloc0(sizeof(inet));\n\n\t/*\n\t * First, check to see if this is an IPv6 or IPv4 address.  IPv6 addresses\n\t * will have a : somewhere in them (several, in fact) so if there is one\n\t * present, assume it's V6, otherwise assume it's V4.\n\t */\n\n\tif (strchr(src, ':') != NULL)\n\t\tip_family(dst) = PGSQL_AF_INET6;\n\telse\n\t\tip_family(dst) = PGSQL_AF_INET;\n\n\tbits = inet_net_pton(ip_family(dst), src, ip_addr(dst),\n\t\t\t\t\t\t is_cidr ? ip_addrsize(dst) : -1);\n\tif ((bits < 0) || (bits > ip_maxbits(dst)))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t/* translator: first %s is inet or cidr */\n\t\t\t\t errmsg(\"invalid input syntax for type %s: \\\"%s\\\"\",\n\t\t\t\t\t\tis_cidr ? \"cidr\" : \"inet\", src)));\n\n\t/*\n\t * Error check: CIDR values must not have any bits set beyond the masklen.\n\t */\n\tif (is_cidr)\n\t{\n\t\tif (!addressOK(ip_addr(dst), bits, ip_family(dst)))\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"invalid cidr value: \\\"%s\\\"\", src),\n\t\t\t\t\t errdetail(\"Value has bits set to right of mask.\")));\n\t}\n\n\tip_bits(dst) = bits;\n\tSET_INET_VARSIZE(dst);\n\n\treturn dst;\n}"
  }
]