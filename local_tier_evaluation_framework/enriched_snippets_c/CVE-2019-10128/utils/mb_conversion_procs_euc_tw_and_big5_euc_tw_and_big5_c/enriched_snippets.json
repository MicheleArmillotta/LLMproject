[
  {
    "function_name": "mic2big5",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
    "lines": "302-353",
    "snippet": "static void\nmic2big5(const unsigned char *mic, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1 || c1 == LC_CNS11643_2 || c1 == LCPRV2_B)\n\t\t{\n\t\t\tif (c1 == LCPRV2_B)\n\t\t\t{\n\t\t\t\tc1 = mic[1];\t/* get plane no. */\n\t\t\t\tcnsBuf = (mic[2] << 8) | mic[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcnsBuf = (mic[1] << 8) | mic[2];\n\t\t\t}\n\t\t\tbig5buf = CNStoBIG5(cnsBuf, c1);\n\t\t\tif (big5buf == 0)\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t*p++ = (big5buf >> 8) & 0x00ff;\n\t\t\t*p++ = big5buf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
      "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
      "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
      "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "report_untranslatable_char",
          "args": [
            "PG_MULE_INTERNAL",
            "PG_BIG5",
            "(const char *) mic",
            "len"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "report_untranslatable_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "2026-2052",
          "snippet": "void\nreport_untranslatable_char(int src_encoding, int dest_encoding,\n\t\t\t\t\t\t   const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(src_encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_UNTRANSLATABLE_CHARACTER),\n\t\t\t errmsg(\"character with byte sequence %s in encoding \\\"%s\\\" has no equivalent in encoding \\\"%s\\\"\",\n\t\t\t\t\tbuf,\n\t\t\t\t\tpg_enc2name_tbl[src_encoding].name,\n\t\t\t\t\tpg_enc2name_tbl[dest_encoding].name)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_untranslatable_char(int src_encoding, int dest_encoding,\n\t\t\t\t\t\t   const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(src_encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_UNTRANSLATABLE_CHARACTER),\n\t\t\t errmsg(\"character with byte sequence %s in encoding \\\"%s\\\" has no equivalent in encoding \\\"%s\\\"\",\n\t\t\t\t\tbuf,\n\t\t\t\t\tpg_enc2name_tbl[src_encoding].name,\n\t\t\t\t\tpg_enc2name_tbl[dest_encoding].name)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "CNStoBIG5",
          "args": [
            "cnsBuf",
            "c1"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "CNStoBIG5",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/big5.c",
          "lines": "344-377",
          "snippet": "unsigned short\nCNStoBIG5(unsigned short cns, unsigned char lc)\n{\n\tint\t\t\ti;\n\tunsigned int big5 = 0;\n\n\tcns &= 0x7f7f;\n\n\tswitch (lc)\n\t{\n\t\tcase LC_CNS11643_1:\n\t\t\tbig5 = BinarySearchRange(cnsPlane1ToBig5Level1, 24, cns);\n\t\t\tbreak;\n\t\tcase LC_CNS11643_2:\n\t\t\tbig5 = BinarySearchRange(cnsPlane2ToBig5Level2, 47, cns);\n\t\t\tbreak;\n\t\tcase LC_CNS11643_3:\n\t\t\tfor (i = 0; i < sizeof(b2c3) / (sizeof(unsigned short) * 2); i++)\n\t\t\t{\n\t\t\t\tif (b2c3[i][1] == cns)\n\t\t\t\t\treturn b2c3[i][0];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase LC_CNS11643_4:\n\t\t\tfor (i = 0; i < sizeof(b1c4) / (sizeof(unsigned short) * 2); i++)\n\t\t\t{\n\t\t\t\tif (b1c4[i][1] == cns)\n\t\t\t\t\treturn b1c4[i][0];\n\t\t\t}\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn big5;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const codes_t cnsPlane1ToBig5Level1[26] = {\t/* range */\n\t{0x2121, 0xA140},\n\t{0x2257, 0xA1F7},\n\t{0x2258, 0xA1F6},\n\t{0x2259, 0xA1F8},\n\t{0x234f, 0x0000},\n\t{0x2421, 0xA2AF},\n\t{0x2571, 0x0000},\n\t{0x4221, 0xA3C0},\n\t{0x4242, 0x0000},\n\t{0x4421, 0xA440},\n\t{0x5323, 0xAD40},\n\t{0x5753, 0xACFE},\n\t{0x5754, 0xAFD0},\n\t{0x6B50, 0xBE52},\n\t{0x6B51, 0xBBC8},\n\t{0x6F5C, 0xBE53},\n\t{0x7535, 0xC2CB},\n\t{0x7536, 0xC1AB},\n\t{0x7737, 0xC2CC},\n\t{0x782D, 0xC456},\n\t{0x782E, 0xC361},\n\t{0x7864, 0xC3BA},\n\t{0x7865, 0xC3B9},\n\t{0x7866, 0xC3BB},\n\t{0x7962, 0xC457},\n\t{0x7d4c, 0x0000}\n};",
            "static const codes_t cnsPlane2ToBig5Level2[49] = {\t/* range */\n\t{0x2121, 0xC940},\n\t{0x212B, 0xC94B},\n\t{0x214C, 0xC9BE},\n\t{0x214D, 0xC96C},\n\t{0x217D, 0xC9BF},\n\t{0x224D, 0xCAF7},\n\t{0x224E, 0xC9ED},\n\t{0x2439, 0xCAF8},\n\t{0x387E, 0xD77B},\n\t{0x3F6A, 0xD77A},\n\t{0x3F6B, 0xDBA7},\n\t{0x4424, 0x0000},\n\t{0x4176, 0xDDFC},\n\t{0x4177, 0x0000},\n\t{0x4424, 0xDDFD},\n\t{0x554B, 0xEBF1},\n\t{0x554C, 0xE8A3},\n\t{0x5722, 0xECDE},\n\t{0x5723, 0xE976},\n\t{0x5A28, 0xF0CB},\n\t{0x5A29, 0xEB5B},\n\t{0x5B3F, 0xEBF2},\n\t{0x5C6A, 0xECDF},\n\t{0x5D74, 0xF056},\n\t{0x5D75, 0xEDAA},\n\t{0x6039, 0xEEEC},\n\t{0x6243, 0xF057},\n\t{0x6337, 0xF0CC},\n\t{0x642F, 0xEEEB},\n\t{0x6430, 0xF163},\n\t{0x6438, 0xF16C},\n\t{0x6573, 0xF269},\n\t{0x664D, 0xF4B5},\n\t{0x664E, 0xF2C3},\n\t{0x6761, 0xF16B},\n\t{0x6762, 0xF375},\n\t{0x6934, 0xF268},\n\t{0x6935, 0xF466},\n\t{0x6962, 0xF4B6},\n\t{0x6A4B, 0xF663},\n\t{0x6A4C, 0xF4FD},\n\t{0x6C52, 0xF664},\n\t{0x7166, 0xF9C4},\n\t{0x7167, 0xF977},\n\t{0x7234, 0xF9C5},\n\t{0x7235, 0xF9C7},\n\t{0x7240, 0xF9C6},\n\t{0x7241, 0xF9D2},\n\t{0x7245, 0x0000}\n};",
            "static const unsigned short b1c4[][2] = {\n\t{0xC879, 0x2123},\n\t{0xC87B, 0x2124},\n\t{0xC87D, 0x212A},\n\t{0xC8A2, 0x2152}\n};",
            "static const unsigned short b2c3[][2] = {\n\t{0xF9D6, 0x4337},\n\t{0xF9D7, 0x4F50},\n\t{0xF9D8, 0x444E},\n\t{0xF9D9, 0x504A},\n\t{0xF9DA, 0x2C5D},\n\t{0xF9DB, 0x3D7E},\n\t{0xF9DC, 0x4B5C}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres_fe.h\"\n\nstatic const codes_t cnsPlane1ToBig5Level1[26] = {\t/* range */\n\t{0x2121, 0xA140},\n\t{0x2257, 0xA1F7},\n\t{0x2258, 0xA1F6},\n\t{0x2259, 0xA1F8},\n\t{0x234f, 0x0000},\n\t{0x2421, 0xA2AF},\n\t{0x2571, 0x0000},\n\t{0x4221, 0xA3C0},\n\t{0x4242, 0x0000},\n\t{0x4421, 0xA440},\n\t{0x5323, 0xAD40},\n\t{0x5753, 0xACFE},\n\t{0x5754, 0xAFD0},\n\t{0x6B50, 0xBE52},\n\t{0x6B51, 0xBBC8},\n\t{0x6F5C, 0xBE53},\n\t{0x7535, 0xC2CB},\n\t{0x7536, 0xC1AB},\n\t{0x7737, 0xC2CC},\n\t{0x782D, 0xC456},\n\t{0x782E, 0xC361},\n\t{0x7864, 0xC3BA},\n\t{0x7865, 0xC3B9},\n\t{0x7866, 0xC3BB},\n\t{0x7962, 0xC457},\n\t{0x7d4c, 0x0000}\n};\nstatic const codes_t cnsPlane2ToBig5Level2[49] = {\t/* range */\n\t{0x2121, 0xC940},\n\t{0x212B, 0xC94B},\n\t{0x214C, 0xC9BE},\n\t{0x214D, 0xC96C},\n\t{0x217D, 0xC9BF},\n\t{0x224D, 0xCAF7},\n\t{0x224E, 0xC9ED},\n\t{0x2439, 0xCAF8},\n\t{0x387E, 0xD77B},\n\t{0x3F6A, 0xD77A},\n\t{0x3F6B, 0xDBA7},\n\t{0x4424, 0x0000},\n\t{0x4176, 0xDDFC},\n\t{0x4177, 0x0000},\n\t{0x4424, 0xDDFD},\n\t{0x554B, 0xEBF1},\n\t{0x554C, 0xE8A3},\n\t{0x5722, 0xECDE},\n\t{0x5723, 0xE976},\n\t{0x5A28, 0xF0CB},\n\t{0x5A29, 0xEB5B},\n\t{0x5B3F, 0xEBF2},\n\t{0x5C6A, 0xECDF},\n\t{0x5D74, 0xF056},\n\t{0x5D75, 0xEDAA},\n\t{0x6039, 0xEEEC},\n\t{0x6243, 0xF057},\n\t{0x6337, 0xF0CC},\n\t{0x642F, 0xEEEB},\n\t{0x6430, 0xF163},\n\t{0x6438, 0xF16C},\n\t{0x6573, 0xF269},\n\t{0x664D, 0xF4B5},\n\t{0x664E, 0xF2C3},\n\t{0x6761, 0xF16B},\n\t{0x6762, 0xF375},\n\t{0x6934, 0xF268},\n\t{0x6935, 0xF466},\n\t{0x6962, 0xF4B6},\n\t{0x6A4B, 0xF663},\n\t{0x6A4C, 0xF4FD},\n\t{0x6C52, 0xF664},\n\t{0x7166, 0xF9C4},\n\t{0x7167, 0xF977},\n\t{0x7234, 0xF9C5},\n\t{0x7235, 0xF9C7},\n\t{0x7240, 0xF9C6},\n\t{0x7241, 0xF9D2},\n\t{0x7245, 0x0000}\n};\nstatic const unsigned short b1c4[][2] = {\n\t{0xC879, 0x2123},\n\t{0xC87B, 0x2124},\n\t{0xC87D, 0x212A},\n\t{0xC8A2, 0x2152}\n};\nstatic const unsigned short b2c3[][2] = {\n\t{0xF9D6, 0x4337},\n\t{0xF9D7, 0x4F50},\n\t{0xF9D8, 0x444E},\n\t{0xF9D9, 0x504A},\n\t{0xF9DA, 0x2C5D},\n\t{0xF9DB, 0x3D7E},\n\t{0xF9DC, 0x4B5C}\n};\n\nunsigned short\nCNStoBIG5(unsigned short cns, unsigned char lc)\n{\n\tint\t\t\ti;\n\tunsigned int big5 = 0;\n\n\tcns &= 0x7f7f;\n\n\tswitch (lc)\n\t{\n\t\tcase LC_CNS11643_1:\n\t\t\tbig5 = BinarySearchRange(cnsPlane1ToBig5Level1, 24, cns);\n\t\t\tbreak;\n\t\tcase LC_CNS11643_2:\n\t\t\tbig5 = BinarySearchRange(cnsPlane2ToBig5Level2, 47, cns);\n\t\t\tbreak;\n\t\tcase LC_CNS11643_3:\n\t\t\tfor (i = 0; i < sizeof(b2c3) / (sizeof(unsigned short) * 2); i++)\n\t\t\t{\n\t\t\t\tif (b2c3[i][1] == cns)\n\t\t\t\t\treturn b2c3[i][0];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase LC_CNS11643_4:\n\t\t\tfor (i = 0; i < sizeof(b1c4) / (sizeof(unsigned short) * 2); i++)\n\t\t\t{\n\t\t\t\tif (b1c4[i][1] == cns)\n\t\t\t\t\treturn b1c4[i][0];\n\t\t\t}\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn big5;\n}"
        }
      },
      {
        "call_info": {
          "callee": "report_invalid_encoding",
          "args": [
            "PG_MULE_INTERNAL",
            "(const char *) mic",
            "len"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "report_invalid_encoding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1994-2018",
          "snippet": "void\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_encoding_verifymb",
          "args": [
            "PG_MULE_INTERNAL",
            "(const char *) mic",
            "len"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "pg_encoding_verifymb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1808-1814",
          "snippet": "int\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c1"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\nmic2big5(const unsigned char *mic, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1 || c1 == LC_CNS11643_2 || c1 == LCPRV2_B)\n\t\t{\n\t\t\tif (c1 == LCPRV2_B)\n\t\t\t{\n\t\t\t\tc1 = mic[1];\t/* get plane no. */\n\t\t\t\tcnsBuf = (mic[2] << 8) | mic[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcnsBuf = (mic[1] << 8) | mic[2];\n\t\t\t}\n\t\t\tbig5buf = CNStoBIG5(cnsBuf, c1);\n\t\t\tif (big5buf == 0)\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t*p++ = (big5buf >> 8) & 0x00ff;\n\t\t\t*p++ = big5buf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
  },
  {
    "function_name": "big52mic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
    "lines": "252-297",
    "snippet": "static void\nbig52mic(const unsigned char *big5, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tunsigned char lc;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *big5;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\t\t*p++ = c1;\n\t\t\tbig5++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_BIG5, (const char *) big5, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\tbig5buf = (c1 << 8) | big5[1];\n\t\tcnsBuf = BIG5toCNS(big5buf, &lc);\n\t\tif (lc != 0)\n\t\t{\n\t\t\t/* Planes 3 and 4 are MULE private charsets */\n\t\t\tif (lc == LC_CNS11643_3 || lc == LC_CNS11643_4)\n\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t*p++ = lc;\t\t\t/* Plane No. */\n\t\t\t*p++ = (cnsBuf >> 8) & 0x00ff;\n\t\t\t*p++ = cnsBuf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_BIG5, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t   (const char *) big5, len);\n\t\tbig5 += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
      "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
      "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
      "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "report_untranslatable_char",
          "args": [
            "PG_BIG5",
            "PG_MULE_INTERNAL",
            "(const char *) big5",
            "len"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "report_untranslatable_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "2026-2052",
          "snippet": "void\nreport_untranslatable_char(int src_encoding, int dest_encoding,\n\t\t\t\t\t\t   const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(src_encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_UNTRANSLATABLE_CHARACTER),\n\t\t\t errmsg(\"character with byte sequence %s in encoding \\\"%s\\\" has no equivalent in encoding \\\"%s\\\"\",\n\t\t\t\t\tbuf,\n\t\t\t\t\tpg_enc2name_tbl[src_encoding].name,\n\t\t\t\t\tpg_enc2name_tbl[dest_encoding].name)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_untranslatable_char(int src_encoding, int dest_encoding,\n\t\t\t\t\t\t   const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(src_encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_UNTRANSLATABLE_CHARACTER),\n\t\t\t errmsg(\"character with byte sequence %s in encoding \\\"%s\\\" has no equivalent in encoding \\\"%s\\\"\",\n\t\t\t\t\tbuf,\n\t\t\t\t\tpg_enc2name_tbl[src_encoding].name,\n\t\t\t\t\tpg_enc2name_tbl[dest_encoding].name)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIG5toCNS",
          "args": [
            "big5buf",
            "&lc"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "BIG5toCNS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/big5.c",
          "lines": "291-342",
          "snippet": "unsigned short\nBIG5toCNS(unsigned short big5, unsigned char *lc)\n{\n\tunsigned short cns = 0;\n\tint\t\t\ti;\n\n\tif (big5 < 0xc940U)\n\t{\n\t\t/* level 1 */\n\n\t\tfor (i = 0; i < sizeof(b1c4) / (sizeof(unsigned short) * 2); i++)\n\t\t{\n\t\t\tif (b1c4[i][0] == big5)\n\t\t\t{\n\t\t\t\t*lc = LC_CNS11643_4;\n\t\t\t\treturn (b1c4[i][1] | 0x8080U);\n\t\t\t}\n\t\t}\n\n\t\tif (0 < (cns = BinarySearchRange(big5Level1ToCnsPlane1, 23, big5)))\n\t\t\t*lc = LC_CNS11643_1;\n\t}\n\telse if (big5 == 0xc94aU)\n\t{\n\t\t/* level 2 */\n\t\t*lc = LC_CNS11643_1;\n\t\tcns = 0x4442;\n\t}\n\telse\n\t{\n\t\t/* level 2 */\n\t\tfor (i = 0; i < sizeof(b2c3) / (sizeof(unsigned short) * 2); i++)\n\t\t{\n\t\t\tif (b2c3[i][0] == big5)\n\t\t\t{\n\t\t\t\t*lc = LC_CNS11643_3;\n\t\t\t\treturn (b2c3[i][1] | 0x8080U);\n\t\t\t}\n\t\t}\n\n\t\tif (0 < (cns = BinarySearchRange(big5Level2ToCnsPlane2, 46, big5)))\n\t\t\t*lc = LC_CNS11643_2;\n\t}\n\n\tif (0 == cns)\n\t{\t\t\t\t\t\t\t/* no mapping Big5 to CNS 11643-1992 */\n\t\t*lc = 0;\n\t\treturn (unsigned short) '?';\n\t}\n\n\treturn cns | 0x8080;\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const codes_t big5Level1ToCnsPlane1[25] = {\t/* range */\n\t{0xA140, 0x2121},\n\t{0xA1F6, 0x2258},\n\t{0xA1F7, 0x2257},\n\t{0xA1F8, 0x2259},\n\t{0xA2AF, 0x2421},\n\t{0xA3C0, 0x4221},\n\t{0xa3e1, 0x0000},\n\t{0xA440, 0x4421},\n\t{0xACFE, 0x5753},\n\t{0xacff, 0x0000},\n\t{0xAD40, 0x5323},\n\t{0xAFD0, 0x5754},\n\t{0xBBC8, 0x6B51},\n\t{0xBE52, 0x6B50},\n\t{0xBE53, 0x6F5C},\n\t{0xC1AB, 0x7536},\n\t{0xC2CB, 0x7535},\n\t{0xC2CC, 0x7737},\n\t{0xC361, 0x782E},\n\t{0xC3B9, 0x7865},\n\t{0xC3BA, 0x7864},\n\t{0xC3BB, 0x7866},\n\t{0xC456, 0x782D},\n\t{0xC457, 0x7962},\n\t{0xc67f, 0x0000}\n};",
            "static const codes_t big5Level2ToCnsPlane2[48] = {\t/* range */\n\t{0xC940, 0x2121},\n\t{0xc94a, 0x0000},\n\t{0xC94B, 0x212B},\n\t{0xC96C, 0x214D},\n\t{0xC9BE, 0x214C},\n\t{0xC9BF, 0x217D},\n\t{0xC9ED, 0x224E},\n\t{0xCAF7, 0x224D},\n\t{0xCAF8, 0x2439},\n\t{0xD77A, 0x3F6A},\n\t{0xD77B, 0x387E},\n\t{0xDBA7, 0x3F6B},\n\t{0xDDFC, 0x4176},\n\t{0xDDFD, 0x4424},\n\t{0xE8A3, 0x554C},\n\t{0xE976, 0x5723},\n\t{0xEB5B, 0x5A29},\n\t{0xEBF1, 0x554B},\n\t{0xEBF2, 0x5B3F},\n\t{0xECDE, 0x5722},\n\t{0xECDF, 0x5C6A},\n\t{0xEDAA, 0x5D75},\n\t{0xEEEB, 0x642F},\n\t{0xEEEC, 0x6039},\n\t{0xF056, 0x5D74},\n\t{0xF057, 0x6243},\n\t{0xF0CB, 0x5A28},\n\t{0xF0CC, 0x6337},\n\t{0xF163, 0x6430},\n\t{0xF16B, 0x6761},\n\t{0xF16C, 0x6438},\n\t{0xF268, 0x6934},\n\t{0xF269, 0x6573},\n\t{0xF2C3, 0x664E},\n\t{0xF375, 0x6762},\n\t{0xF466, 0x6935},\n\t{0xF4B5, 0x664D},\n\t{0xF4B6, 0x6962},\n\t{0xF4FD, 0x6A4C},\n\t{0xF663, 0x6A4B},\n\t{0xF664, 0x6C52},\n\t{0xF977, 0x7167},\n\t{0xF9C4, 0x7166},\n\t{0xF9C5, 0x7234},\n\t{0xF9C6, 0x7240},\n\t{0xF9C7, 0x7235},\n\t{0xF9D2, 0x7241},\n\t{0xf9d6, 0x0000}\n};",
            "static const unsigned short b1c4[][2] = {\n\t{0xC879, 0x2123},\n\t{0xC87B, 0x2124},\n\t{0xC87D, 0x212A},\n\t{0xC8A2, 0x2152}\n};",
            "static const unsigned short b2c3[][2] = {\n\t{0xF9D6, 0x4337},\n\t{0xF9D7, 0x4F50},\n\t{0xF9D8, 0x444E},\n\t{0xF9D9, 0x504A},\n\t{0xF9DA, 0x2C5D},\n\t{0xF9DB, 0x3D7E},\n\t{0xF9DC, 0x4B5C}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres_fe.h\"\n\nstatic const codes_t big5Level1ToCnsPlane1[25] = {\t/* range */\n\t{0xA140, 0x2121},\n\t{0xA1F6, 0x2258},\n\t{0xA1F7, 0x2257},\n\t{0xA1F8, 0x2259},\n\t{0xA2AF, 0x2421},\n\t{0xA3C0, 0x4221},\n\t{0xa3e1, 0x0000},\n\t{0xA440, 0x4421},\n\t{0xACFE, 0x5753},\n\t{0xacff, 0x0000},\n\t{0xAD40, 0x5323},\n\t{0xAFD0, 0x5754},\n\t{0xBBC8, 0x6B51},\n\t{0xBE52, 0x6B50},\n\t{0xBE53, 0x6F5C},\n\t{0xC1AB, 0x7536},\n\t{0xC2CB, 0x7535},\n\t{0xC2CC, 0x7737},\n\t{0xC361, 0x782E},\n\t{0xC3B9, 0x7865},\n\t{0xC3BA, 0x7864},\n\t{0xC3BB, 0x7866},\n\t{0xC456, 0x782D},\n\t{0xC457, 0x7962},\n\t{0xc67f, 0x0000}\n};\nstatic const codes_t big5Level2ToCnsPlane2[48] = {\t/* range */\n\t{0xC940, 0x2121},\n\t{0xc94a, 0x0000},\n\t{0xC94B, 0x212B},\n\t{0xC96C, 0x214D},\n\t{0xC9BE, 0x214C},\n\t{0xC9BF, 0x217D},\n\t{0xC9ED, 0x224E},\n\t{0xCAF7, 0x224D},\n\t{0xCAF8, 0x2439},\n\t{0xD77A, 0x3F6A},\n\t{0xD77B, 0x387E},\n\t{0xDBA7, 0x3F6B},\n\t{0xDDFC, 0x4176},\n\t{0xDDFD, 0x4424},\n\t{0xE8A3, 0x554C},\n\t{0xE976, 0x5723},\n\t{0xEB5B, 0x5A29},\n\t{0xEBF1, 0x554B},\n\t{0xEBF2, 0x5B3F},\n\t{0xECDE, 0x5722},\n\t{0xECDF, 0x5C6A},\n\t{0xEDAA, 0x5D75},\n\t{0xEEEB, 0x642F},\n\t{0xEEEC, 0x6039},\n\t{0xF056, 0x5D74},\n\t{0xF057, 0x6243},\n\t{0xF0CB, 0x5A28},\n\t{0xF0CC, 0x6337},\n\t{0xF163, 0x6430},\n\t{0xF16B, 0x6761},\n\t{0xF16C, 0x6438},\n\t{0xF268, 0x6934},\n\t{0xF269, 0x6573},\n\t{0xF2C3, 0x664E},\n\t{0xF375, 0x6762},\n\t{0xF466, 0x6935},\n\t{0xF4B5, 0x664D},\n\t{0xF4B6, 0x6962},\n\t{0xF4FD, 0x6A4C},\n\t{0xF663, 0x6A4B},\n\t{0xF664, 0x6C52},\n\t{0xF977, 0x7167},\n\t{0xF9C4, 0x7166},\n\t{0xF9C5, 0x7234},\n\t{0xF9C6, 0x7240},\n\t{0xF9C7, 0x7235},\n\t{0xF9D2, 0x7241},\n\t{0xf9d6, 0x0000}\n};\nstatic const unsigned short b1c4[][2] = {\n\t{0xC879, 0x2123},\n\t{0xC87B, 0x2124},\n\t{0xC87D, 0x212A},\n\t{0xC8A2, 0x2152}\n};\nstatic const unsigned short b2c3[][2] = {\n\t{0xF9D6, 0x4337},\n\t{0xF9D7, 0x4F50},\n\t{0xF9D8, 0x444E},\n\t{0xF9D9, 0x504A},\n\t{0xF9DA, 0x2C5D},\n\t{0xF9DB, 0x3D7E},\n\t{0xF9DC, 0x4B5C}\n};\n\nunsigned short\nBIG5toCNS(unsigned short big5, unsigned char *lc)\n{\n\tunsigned short cns = 0;\n\tint\t\t\ti;\n\n\tif (big5 < 0xc940U)\n\t{\n\t\t/* level 1 */\n\n\t\tfor (i = 0; i < sizeof(b1c4) / (sizeof(unsigned short) * 2); i++)\n\t\t{\n\t\t\tif (b1c4[i][0] == big5)\n\t\t\t{\n\t\t\t\t*lc = LC_CNS11643_4;\n\t\t\t\treturn (b1c4[i][1] | 0x8080U);\n\t\t\t}\n\t\t}\n\n\t\tif (0 < (cns = BinarySearchRange(big5Level1ToCnsPlane1, 23, big5)))\n\t\t\t*lc = LC_CNS11643_1;\n\t}\n\telse if (big5 == 0xc94aU)\n\t{\n\t\t/* level 2 */\n\t\t*lc = LC_CNS11643_1;\n\t\tcns = 0x4442;\n\t}\n\telse\n\t{\n\t\t/* level 2 */\n\t\tfor (i = 0; i < sizeof(b2c3) / (sizeof(unsigned short) * 2); i++)\n\t\t{\n\t\t\tif (b2c3[i][0] == big5)\n\t\t\t{\n\t\t\t\t*lc = LC_CNS11643_3;\n\t\t\t\treturn (b2c3[i][1] | 0x8080U);\n\t\t\t}\n\t\t}\n\n\t\tif (0 < (cns = BinarySearchRange(big5Level2ToCnsPlane2, 46, big5)))\n\t\t\t*lc = LC_CNS11643_2;\n\t}\n\n\tif (0 == cns)\n\t{\t\t\t\t\t\t\t/* no mapping Big5 to CNS 11643-1992 */\n\t\t*lc = 0;\n\t\treturn (unsigned short) '?';\n\t}\n\n\treturn cns | 0x8080;\n}"
        }
      },
      {
        "call_info": {
          "callee": "report_invalid_encoding",
          "args": [
            "PG_BIG5",
            "(const char *) big5",
            "len"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "report_invalid_encoding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1994-2018",
          "snippet": "void\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_encoding_verifymb",
          "args": [
            "PG_BIG5",
            "(const char *) big5",
            "len"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "pg_encoding_verifymb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1808-1814",
          "snippet": "int\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c1"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\nbig52mic(const unsigned char *big5, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tunsigned char lc;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *big5;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\t\t*p++ = c1;\n\t\t\tbig5++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_BIG5, (const char *) big5, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\tbig5buf = (c1 << 8) | big5[1];\n\t\tcnsBuf = BIG5toCNS(big5buf, &lc);\n\t\tif (lc != 0)\n\t\t{\n\t\t\t/* Planes 3 and 4 are MULE private charsets */\n\t\t\tif (lc == LC_CNS11643_3 || lc == LC_CNS11643_4)\n\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t*p++ = lc;\t\t\t/* Plane No. */\n\t\t\t*p++ = (cnsBuf >> 8) & 0x00ff;\n\t\t\t*p++ = cnsBuf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_BIG5, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t   (const char *) big5, len);\n\t\tbig5 += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
  },
  {
    "function_name": "mic2euc_tw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
    "lines": "196-247",
    "snippet": "static void\nmic2euc_tw(const unsigned char *mic, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1)\n\t\t{\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LC_CNS11643_2)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = 0xa2;\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LCPRV2_B &&\n\t\t\t\t mic[1] >= LC_CNS11643_3 && mic[1] <= LC_CNS11643_7)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = mic[1] - LC_CNS11643_3 + 0xa3;\n\t\t\t*p++ = mic[2];\n\t\t\t*p++ = mic[3];\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
      "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
      "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
      "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "report_untranslatable_char",
          "args": [
            "PG_MULE_INTERNAL",
            "PG_EUC_TW",
            "(const char *) mic",
            "len"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "report_untranslatable_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "2026-2052",
          "snippet": "void\nreport_untranslatable_char(int src_encoding, int dest_encoding,\n\t\t\t\t\t\t   const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(src_encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_UNTRANSLATABLE_CHARACTER),\n\t\t\t errmsg(\"character with byte sequence %s in encoding \\\"%s\\\" has no equivalent in encoding \\\"%s\\\"\",\n\t\t\t\t\tbuf,\n\t\t\t\t\tpg_enc2name_tbl[src_encoding].name,\n\t\t\t\t\tpg_enc2name_tbl[dest_encoding].name)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_untranslatable_char(int src_encoding, int dest_encoding,\n\t\t\t\t\t\t   const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(src_encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_UNTRANSLATABLE_CHARACTER),\n\t\t\t errmsg(\"character with byte sequence %s in encoding \\\"%s\\\" has no equivalent in encoding \\\"%s\\\"\",\n\t\t\t\t\tbuf,\n\t\t\t\t\tpg_enc2name_tbl[src_encoding].name,\n\t\t\t\t\tpg_enc2name_tbl[dest_encoding].name)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "report_invalid_encoding",
          "args": [
            "PG_MULE_INTERNAL",
            "(const char *) mic",
            "len"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "report_invalid_encoding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1994-2018",
          "snippet": "void\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_encoding_verifymb",
          "args": [
            "PG_MULE_INTERNAL",
            "(const char *) mic",
            "len"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "pg_encoding_verifymb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1808-1814",
          "snippet": "int\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c1"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\nmic2euc_tw(const unsigned char *mic, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1)\n\t\t{\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LC_CNS11643_2)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = 0xa2;\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LCPRV2_B &&\n\t\t\t\t mic[1] >= LC_CNS11643_3 && mic[1] <= LC_CNS11643_7)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = mic[1] - LC_CNS11643_3 + 0xa3;\n\t\t\t*p++ = mic[2];\n\t\t\t*p++ = mic[3];\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
  },
  {
    "function_name": "euc_tw2mic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
    "lines": "140-191",
    "snippet": "static void\neuc_tw2mic(const unsigned char *euc, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *euc;\n\t\tif (IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\tl = pg_encoding_verifymb(PG_EUC_TW, (const char *) euc, len);\n\t\t\tif (l < 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\tif (c1 == SS2)\n\t\t\t{\n\t\t\t\tc1 = euc[1];\t/* plane No. */\n\t\t\t\tif (c1 == 0xa1)\n\t\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\telse if (c1 == 0xa2)\n\t\t\t\t\t*p++ = LC_CNS11643_2;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t/* other planes are MULE private charsets */\n\t\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t\t\t*p++ = c1 - 0xa3 + LC_CNS11643_3;\n\t\t\t\t}\n\t\t\t\t*p++ = euc[2];\n\t\t\t\t*p++ = euc[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\t\t\t\t\t/* CNS11643-1 */\n\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\t*p++ = c1;\n\t\t\t\t*p++ = euc[1];\n\t\t\t}\n\t\t\teuc += l;\n\t\t\tlen -= l;\n\t\t}\n\t\telse\n\t\t{\t\t\t\t\t\t/* should be ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t*p++ = c1;\n\t\t\teuc++;\n\t\t\tlen--;\n\t\t}\n\t}\n\t*p = '\\0';\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
      "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
      "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
      "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "report_invalid_encoding",
          "args": [
            "PG_EUC_TW",
            "(const char *) euc",
            "len"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "report_invalid_encoding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1994-2018",
          "snippet": "void\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nvoid\nreport_invalid_encoding(int encoding, const char *mbstr, int len)\n{\n\tint\t\t\tl = pg_encoding_mblen(encoding, mbstr);\n\tchar\t\tbuf[8 * 5 + 1];\n\tchar\t   *p = buf;\n\tint\t\t\tj,\n\t\t\t\tjlimit;\n\n\tjlimit = Min(l, len);\n\tjlimit = Min(jlimit, 8);\t/* prevent buffer overrun */\n\n\tfor (j = 0; j < jlimit; j++)\n\t{\n\t\tp += sprintf(p, \"0x%02x\", (unsigned char) mbstr[j]);\n\t\tif (j < jlimit - 1)\n\t\t\tp += sprintf(p, \" \");\n\t}\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_CHARACTER_NOT_IN_REPERTOIRE),\n\t\t\t errmsg(\"invalid byte sequence for encoding \\\"%s\\\": %s\",\n\t\t\t\t\tpg_enc2name_tbl[encoding].name,\n\t\t\t\t\tbuf)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_encoding_verifymb",
          "args": [
            "PG_EUC_TW",
            "(const char *) euc",
            "len"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "pg_encoding_verifymb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/wchar.c",
          "lines": "1808-1814",
          "snippet": "int\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\"",
            "#include \"postgres_fe.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n#include \"postgres_fe.h\"\n\nconst pg_wchar_tbl pg_wchar_table[] = {\n\t{pg_ascii2wchar_with_len, pg_wchar2single_with_len, pg_ascii_mblen, pg_ascii_dsplen, pg_ascii_verifier, 1}, /* PG_SQL_ASCII */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JP */\n\t{pg_euccn2wchar_with_len, pg_wchar2euc_with_len, pg_euccn_mblen, pg_euccn_dsplen, pg_euccn_verifier, 2},\t/* PG_EUC_CN */\n\t{pg_euckr2wchar_with_len, pg_wchar2euc_with_len, pg_euckr_mblen, pg_euckr_dsplen, pg_euckr_verifier, 3},\t/* PG_EUC_KR */\n\t{pg_euctw2wchar_with_len, pg_wchar2euc_with_len, pg_euctw_mblen, pg_euctw_dsplen, pg_euctw_verifier, 4},\t/* PG_EUC_TW */\n\t{pg_eucjp2wchar_with_len, pg_wchar2euc_with_len, pg_eucjp_mblen, pg_eucjp_dsplen, pg_eucjp_verifier, 3},\t/* PG_EUC_JIS_2004 */\n\t{pg_utf2wchar_with_len, pg_wchar2utf_with_len, pg_utf_mblen, pg_utf_dsplen, pg_utf8_verifier, 4},\t/* PG_UTF8 */\n\t{pg_mule2wchar_with_len, pg_wchar2mule_with_len, pg_mule_mblen, pg_mule_dsplen, pg_mule_verifier, 4},\t/* PG_MULE_INTERNAL */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN1 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN2 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN3 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN4 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN9 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_LATIN10 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1256 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1258 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN866 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN874 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8R */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1251 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1252 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-5 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-6 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-7 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* ISO-8859-8 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1250 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1253 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1254 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1255 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_WIN1257 */\n\t{pg_latin12wchar_with_len, pg_wchar2single_with_len, pg_latin1_mblen, pg_latin1_dsplen, pg_latin1_verifier, 1}, /* PG_KOI8U */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}, /* PG_SJIS */\n\t{0, 0, pg_big5_mblen, pg_big5_dsplen, pg_big5_verifier, 2}, /* PG_BIG5 */\n\t{0, 0, pg_gbk_mblen, pg_gbk_dsplen, pg_gbk_verifier, 2},\t/* PG_GBK */\n\t{0, 0, pg_uhc_mblen, pg_uhc_dsplen, pg_uhc_verifier, 2},\t/* PG_UHC */\n\t{0, 0, pg_gb18030_mblen, pg_gb18030_dsplen, pg_gb18030_verifier, 4},\t/* PG_GB18030 */\n\t{0, 0, pg_johab_mblen, pg_johab_dsplen, pg_johab_verifier, 3},\t/* PG_JOHAB */\n\t{0, 0, pg_sjis_mblen, pg_sjis_dsplen, pg_sjis_verifier, 2}\t/* PG_SHIFT_JIS_2004 */\n};\n\nint\npg_encoding_verifymb(int encoding, const char *mbstr, int len)\n{\n\treturn (PG_VALID_ENCODING(encoding) ?\n\t\t\tpg_wchar_table[encoding].mbverify((const unsigned char *) mbstr, len) :\n\t\t\tpg_wchar_table[PG_SQL_ASCII].mbverify((const unsigned char *) mbstr, len));\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_HIGHBIT_SET",
          "args": [
            "c1"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\neuc_tw2mic(const unsigned char *euc, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *euc;\n\t\tif (IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\tl = pg_encoding_verifymb(PG_EUC_TW, (const char *) euc, len);\n\t\t\tif (l < 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\tif (c1 == SS2)\n\t\t\t{\n\t\t\t\tc1 = euc[1];\t/* plane No. */\n\t\t\t\tif (c1 == 0xa1)\n\t\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\telse if (c1 == 0xa2)\n\t\t\t\t\t*p++ = LC_CNS11643_2;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t/* other planes are MULE private charsets */\n\t\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t\t\t*p++ = c1 - 0xa3 + LC_CNS11643_3;\n\t\t\t\t}\n\t\t\t\t*p++ = euc[2];\n\t\t\t\t*p++ = euc[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\t\t\t\t\t/* CNS11643-1 */\n\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\t*p++ = c1;\n\t\t\t\t*p++ = euc[1];\n\t\t\t}\n\t\t\teuc += l;\n\t\t\tlen -= l;\n\t\t}\n\t\telse\n\t\t{\t\t\t\t\t\t/* should be ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t*p++ = c1;\n\t\t\teuc++;\n\t\t\tlen--;\n\t\t}\n\t}\n\t*p = '\\0';\n}"
  },
  {
    "function_name": "mic_to_big5",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
    "lines": "123-135",
    "snippet": "Datum\nmic_to_big5(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_BIG5);\n\n\tmic2big5(src, dest, len);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
      "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
      "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
      "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mic2big5",
          "args": [
            "src",
            "dest",
            "len"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "mic2big5",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
          "lines": "302-353",
          "snippet": "static void\nmic2big5(const unsigned char *mic, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1 || c1 == LC_CNS11643_2 || c1 == LCPRV2_B)\n\t\t{\n\t\t\tif (c1 == LCPRV2_B)\n\t\t\t{\n\t\t\t\tc1 = mic[1];\t/* get plane no. */\n\t\t\t\tcnsBuf = (mic[2] << 8) | mic[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcnsBuf = (mic[1] << 8) | mic[2];\n\t\t\t}\n\t\t\tbig5buf = CNStoBIG5(cnsBuf, c1);\n\t\t\tif (big5buf == 0)\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t*p++ = (big5buf >> 8) & 0x00ff;\n\t\t\t*p++ = big5buf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
            "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
            "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
            "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\nmic2big5(const unsigned char *mic, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1 || c1 == LC_CNS11643_2 || c1 == LCPRV2_B)\n\t\t{\n\t\t\tif (c1 == LCPRV2_B)\n\t\t\t{\n\t\t\t\tc1 = mic[1];\t/* get plane no. */\n\t\t\t\tcnsBuf = (mic[2] << 8) | mic[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcnsBuf = (mic[1] << 8) | mic[2];\n\t\t\t}\n\t\t\tbig5buf = CNStoBIG5(cnsBuf, c1);\n\t\t\tif (big5buf == 0)\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t*p++ = (big5buf >> 8) & 0x00ff;\n\t\t\t*p++ = big5buf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_MULE_INTERNAL",
            "PG_BIG5"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nDatum\nmic_to_big5(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_BIG5);\n\n\tmic2big5(src, dest, len);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "big5_to_mic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
    "lines": "109-121",
    "snippet": "Datum\nbig5_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_BIG5, PG_MULE_INTERNAL);\n\n\tbig52mic(src, dest, len);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
      "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
      "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
      "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "big52mic",
          "args": [
            "src",
            "dest",
            "len"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "big52mic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
          "lines": "252-297",
          "snippet": "static void\nbig52mic(const unsigned char *big5, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tunsigned char lc;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *big5;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\t\t*p++ = c1;\n\t\t\tbig5++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_BIG5, (const char *) big5, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\tbig5buf = (c1 << 8) | big5[1];\n\t\tcnsBuf = BIG5toCNS(big5buf, &lc);\n\t\tif (lc != 0)\n\t\t{\n\t\t\t/* Planes 3 and 4 are MULE private charsets */\n\t\t\tif (lc == LC_CNS11643_3 || lc == LC_CNS11643_4)\n\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t*p++ = lc;\t\t\t/* Plane No. */\n\t\t\t*p++ = (cnsBuf >> 8) & 0x00ff;\n\t\t\t*p++ = cnsBuf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_BIG5, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t   (const char *) big5, len);\n\t\tbig5 += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
            "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
            "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
            "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\nbig52mic(const unsigned char *big5, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tunsigned char lc;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *big5;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\t\t*p++ = c1;\n\t\t\tbig5++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_BIG5, (const char *) big5, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\tbig5buf = (c1 << 8) | big5[1];\n\t\tcnsBuf = BIG5toCNS(big5buf, &lc);\n\t\tif (lc != 0)\n\t\t{\n\t\t\t/* Planes 3 and 4 are MULE private charsets */\n\t\t\tif (lc == LC_CNS11643_3 || lc == LC_CNS11643_4)\n\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t*p++ = lc;\t\t\t/* Plane No. */\n\t\t\t*p++ = (cnsBuf >> 8) & 0x00ff;\n\t\t\t*p++ = cnsBuf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_BIG5, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t   (const char *) big5, len);\n\t\tbig5 += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_BIG5",
            "PG_MULE_INTERNAL"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nDatum\nbig5_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_BIG5, PG_MULE_INTERNAL);\n\n\tbig52mic(src, dest, len);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "mic_to_euc_tw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
    "lines": "95-107",
    "snippet": "Datum\nmic_to_euc_tw(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_EUC_TW);\n\n\tmic2euc_tw(src, dest, len);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
      "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
      "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
      "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mic2euc_tw",
          "args": [
            "src",
            "dest",
            "len"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "mic2euc_tw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
          "lines": "196-247",
          "snippet": "static void\nmic2euc_tw(const unsigned char *mic, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1)\n\t\t{\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LC_CNS11643_2)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = 0xa2;\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LCPRV2_B &&\n\t\t\t\t mic[1] >= LC_CNS11643_3 && mic[1] <= LC_CNS11643_7)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = mic[1] - LC_CNS11643_3 + 0xa3;\n\t\t\t*p++ = mic[2];\n\t\t\t*p++ = mic[3];\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
            "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
            "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
            "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\nmic2euc_tw(const unsigned char *mic, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1)\n\t\t{\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LC_CNS11643_2)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = 0xa2;\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LCPRV2_B &&\n\t\t\t\t mic[1] >= LC_CNS11643_3 && mic[1] <= LC_CNS11643_7)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = mic[1] - LC_CNS11643_3 + 0xa3;\n\t\t\t*p++ = mic[2];\n\t\t\t*p++ = mic[3];\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_MULE_INTERNAL",
            "PG_EUC_TW"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nDatum\nmic_to_euc_tw(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_MULE_INTERNAL, PG_EUC_TW);\n\n\tmic2euc_tw(src, dest, len);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "euc_tw_to_mic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
    "lines": "81-93",
    "snippet": "Datum\neuc_tw_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_EUC_TW, PG_MULE_INTERNAL);\n\n\teuc_tw2mic(src, dest, len);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
      "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
      "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
      "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "euc_tw2mic",
          "args": [
            "src",
            "dest",
            "len"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "euc_tw2mic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
          "lines": "140-191",
          "snippet": "static void\neuc_tw2mic(const unsigned char *euc, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *euc;\n\t\tif (IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\tl = pg_encoding_verifymb(PG_EUC_TW, (const char *) euc, len);\n\t\t\tif (l < 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\tif (c1 == SS2)\n\t\t\t{\n\t\t\t\tc1 = euc[1];\t/* plane No. */\n\t\t\t\tif (c1 == 0xa1)\n\t\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\telse if (c1 == 0xa2)\n\t\t\t\t\t*p++ = LC_CNS11643_2;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t/* other planes are MULE private charsets */\n\t\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t\t\t*p++ = c1 - 0xa3 + LC_CNS11643_3;\n\t\t\t\t}\n\t\t\t\t*p++ = euc[2];\n\t\t\t\t*p++ = euc[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\t\t\t\t\t/* CNS11643-1 */\n\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\t*p++ = c1;\n\t\t\t\t*p++ = euc[1];\n\t\t\t}\n\t\t\teuc += l;\n\t\t\tlen -= l;\n\t\t}\n\t\telse\n\t\t{\t\t\t\t\t\t/* should be ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t*p++ = c1;\n\t\t\teuc++;\n\t\t\tlen--;\n\t\t}\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
            "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
            "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
            "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\neuc_tw2mic(const unsigned char *euc, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *euc;\n\t\tif (IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\tl = pg_encoding_verifymb(PG_EUC_TW, (const char *) euc, len);\n\t\t\tif (l < 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\tif (c1 == SS2)\n\t\t\t{\n\t\t\t\tc1 = euc[1];\t/* plane No. */\n\t\t\t\tif (c1 == 0xa1)\n\t\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\telse if (c1 == 0xa2)\n\t\t\t\t\t*p++ = LC_CNS11643_2;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t/* other planes are MULE private charsets */\n\t\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t\t\t*p++ = c1 - 0xa3 + LC_CNS11643_3;\n\t\t\t\t}\n\t\t\t\t*p++ = euc[2];\n\t\t\t\t*p++ = euc[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\t\t\t\t\t/* CNS11643-1 */\n\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\t*p++ = c1;\n\t\t\t\t*p++ = euc[1];\n\t\t\t}\n\t\t\teuc += l;\n\t\t\tlen -= l;\n\t\t}\n\t\telse\n\t\t{\t\t\t\t\t\t/* should be ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t*p++ = c1;\n\t\t\teuc++;\n\t\t\tlen--;\n\t\t}\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_EUC_TW",
            "PG_MULE_INTERNAL"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nDatum\neuc_tw_to_mic(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_EUC_TW, PG_MULE_INTERNAL);\n\n\teuc_tw2mic(src, dest, len);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "big5_to_euc_tw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
    "lines": "63-79",
    "snippet": "Datum\nbig5_to_euc_tw(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\tunsigned char *buf;\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_BIG5, PG_EUC_TW);\n\n\tbuf = palloc(len * ENCODING_GROWTH_RATE + 1);\n\tbig52mic(src, buf, len);\n\tmic2euc_tw(buf, dest, strlen((char *) buf));\n\tpfree(buf);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define ENCODING_GROWTH_RATE 4"
    ],
    "globals_used": [
      "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
      "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
      "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
      "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfree",
          "args": [
            "buf"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "pfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "1030-1037",
          "snippet": "void\npfree(void *pointer)\n{\n\tMemoryContext context = GetMemoryChunkContext(pointer);\n\n\tcontext->methods->free_p(context, pointer);\n\tVALGRIND_MEMPOOL_FREE(context, pointer);\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid\npfree(void *pointer)\n{\n\tMemoryContext context = GetMemoryChunkContext(pointer);\n\n\tcontext->methods->free_p(context, pointer);\n\tVALGRIND_MEMPOOL_FREE(context, pointer);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mic2euc_tw",
          "args": [
            "buf",
            "dest",
            "strlen((char *) buf)"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "mic2euc_tw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
          "lines": "196-247",
          "snippet": "static void\nmic2euc_tw(const unsigned char *mic, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1)\n\t\t{\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LC_CNS11643_2)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = 0xa2;\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LCPRV2_B &&\n\t\t\t\t mic[1] >= LC_CNS11643_3 && mic[1] <= LC_CNS11643_7)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = mic[1] - LC_CNS11643_3 + 0xa3;\n\t\t\t*p++ = mic[2];\n\t\t\t*p++ = mic[3];\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
            "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
            "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
            "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\nmic2euc_tw(const unsigned char *mic, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1)\n\t\t{\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LC_CNS11643_2)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = 0xa2;\n\t\t\t*p++ = mic[1];\n\t\t\t*p++ = mic[2];\n\t\t}\n\t\telse if (c1 == LCPRV2_B &&\n\t\t\t\t mic[1] >= LC_CNS11643_3 && mic[1] <= LC_CNS11643_7)\n\t\t{\n\t\t\t*p++ = SS2;\n\t\t\t*p++ = mic[1] - LC_CNS11643_3 + 0xa3;\n\t\t\t*p++ = mic[2];\n\t\t\t*p++ = mic[3];\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "(char *) buf"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "calcstrlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_cleanup.c",
          "lines": "361-380",
          "snippet": "static int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nstatic int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "big52mic",
          "args": [
            "src",
            "buf",
            "len"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "big52mic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
          "lines": "252-297",
          "snippet": "static void\nbig52mic(const unsigned char *big5, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tunsigned char lc;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *big5;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\t\t*p++ = c1;\n\t\t\tbig5++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_BIG5, (const char *) big5, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\tbig5buf = (c1 << 8) | big5[1];\n\t\tcnsBuf = BIG5toCNS(big5buf, &lc);\n\t\tif (lc != 0)\n\t\t{\n\t\t\t/* Planes 3 and 4 are MULE private charsets */\n\t\t\tif (lc == LC_CNS11643_3 || lc == LC_CNS11643_4)\n\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t*p++ = lc;\t\t\t/* Plane No. */\n\t\t\t*p++ = (cnsBuf >> 8) & 0x00ff;\n\t\t\t*p++ = cnsBuf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_BIG5, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t   (const char *) big5, len);\n\t\tbig5 += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
            "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
            "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
            "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\nbig52mic(const unsigned char *big5, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tunsigned char lc;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *big5;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\t\t*p++ = c1;\n\t\t\tbig5++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_BIG5, (const char *) big5, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_BIG5,\n\t\t\t\t\t\t\t\t\t(const char *) big5, len);\n\t\tbig5buf = (c1 << 8) | big5[1];\n\t\tcnsBuf = BIG5toCNS(big5buf, &lc);\n\t\tif (lc != 0)\n\t\t{\n\t\t\t/* Planes 3 and 4 are MULE private charsets */\n\t\t\tif (lc == LC_CNS11643_3 || lc == LC_CNS11643_4)\n\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t*p++ = lc;\t\t\t/* Plane No. */\n\t\t\t*p++ = (cnsBuf >> 8) & 0x00ff;\n\t\t\t*p++ = cnsBuf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_BIG5, PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t   (const char *) big5, len);\n\t\tbig5 += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "len * ENCODING_GROWTH_RATE + 1"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_BIG5",
            "PG_EUC_TW"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\n#define ENCODING_GROWTH_RATE 4\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nDatum\nbig5_to_euc_tw(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\tunsigned char *buf;\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_BIG5, PG_EUC_TW);\n\n\tbuf = palloc(len * ENCODING_GROWTH_RATE + 1);\n\tbig52mic(src, buf, len);\n\tmic2euc_tw(buf, dest, strlen((char *) buf));\n\tpfree(buf);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "euc_tw_to_big5",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
    "lines": "45-61",
    "snippet": "Datum\neuc_tw_to_big5(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\tunsigned char *buf;\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_EUC_TW, PG_BIG5);\n\n\tbuf = palloc(len * ENCODING_GROWTH_RATE + 1);\n\teuc_tw2mic(src, buf, len);\n\tmic2big5(buf, dest, strlen((char *) buf));\n\tpfree(buf);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"mb/pg_wchar.h\"",
      "#include \"fmgr.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define ENCODING_GROWTH_RATE 4"
    ],
    "globals_used": [
      "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
      "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
      "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
      "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfree",
          "args": [
            "buf"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "pfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "1030-1037",
          "snippet": "void\npfree(void *pointer)\n{\n\tMemoryContext context = GetMemoryChunkContext(pointer);\n\n\tcontext->methods->free_p(context, pointer);\n\tVALGRIND_MEMPOOL_FREE(context, pointer);\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid\npfree(void *pointer)\n{\n\tMemoryContext context = GetMemoryChunkContext(pointer);\n\n\tcontext->methods->free_p(context, pointer);\n\tVALGRIND_MEMPOOL_FREE(context, pointer);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mic2big5",
          "args": [
            "buf",
            "dest",
            "strlen((char *) buf)"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "mic2big5",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
          "lines": "302-353",
          "snippet": "static void\nmic2big5(const unsigned char *mic, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1 || c1 == LC_CNS11643_2 || c1 == LCPRV2_B)\n\t\t{\n\t\t\tif (c1 == LCPRV2_B)\n\t\t\t{\n\t\t\t\tc1 = mic[1];\t/* get plane no. */\n\t\t\t\tcnsBuf = (mic[2] << 8) | mic[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcnsBuf = (mic[1] << 8) | mic[2];\n\t\t\t}\n\t\t\tbig5buf = CNStoBIG5(cnsBuf, c1);\n\t\t\tif (big5buf == 0)\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t*p++ = (big5buf >> 8) & 0x00ff;\n\t\t\t*p++ = big5buf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
            "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
            "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
            "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\nmic2big5(const unsigned char *mic, unsigned char *p, int len)\n{\n\tunsigned short c1;\n\tunsigned short big5buf,\n\t\t\t\tcnsBuf;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *mic;\n\t\tif (!IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\t/* ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\t\t*p++ = c1;\n\t\t\tmic++;\n\t\t\tlen--;\n\t\t\tcontinue;\n\t\t}\n\t\tl = pg_encoding_verifymb(PG_MULE_INTERNAL, (const char *) mic, len);\n\t\tif (l < 0)\n\t\t\treport_invalid_encoding(PG_MULE_INTERNAL,\n\t\t\t\t\t\t\t\t\t(const char *) mic, len);\n\t\tif (c1 == LC_CNS11643_1 || c1 == LC_CNS11643_2 || c1 == LCPRV2_B)\n\t\t{\n\t\t\tif (c1 == LCPRV2_B)\n\t\t\t{\n\t\t\t\tc1 = mic[1];\t/* get plane no. */\n\t\t\t\tcnsBuf = (mic[2] << 8) | mic[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcnsBuf = (mic[1] << 8) | mic[2];\n\t\t\t}\n\t\t\tbig5buf = CNStoBIG5(cnsBuf, c1);\n\t\t\tif (big5buf == 0)\n\t\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\t\t*p++ = (big5buf >> 8) & 0x00ff;\n\t\t\t*p++ = big5buf & 0x00ff;\n\t\t}\n\t\telse\n\t\t\treport_untranslatable_char(PG_MULE_INTERNAL, PG_BIG5,\n\t\t\t\t\t\t\t\t\t   (const char *) mic, len);\n\t\tmic += l;\n\t\tlen -= l;\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "(char *) buf"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "calcstrlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_cleanup.c",
          "lines": "361-380",
          "snippet": "static int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nstatic int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "euc_tw2mic",
          "args": [
            "src",
            "buf",
            "len"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "euc_tw2mic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mb/conversion_procs/euc_tw_and_big5/euc_tw_and_big5.c",
          "lines": "140-191",
          "snippet": "static void\neuc_tw2mic(const unsigned char *euc, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *euc;\n\t\tif (IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\tl = pg_encoding_verifymb(PG_EUC_TW, (const char *) euc, len);\n\t\t\tif (l < 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\tif (c1 == SS2)\n\t\t\t{\n\t\t\t\tc1 = euc[1];\t/* plane No. */\n\t\t\t\tif (c1 == 0xa1)\n\t\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\telse if (c1 == 0xa2)\n\t\t\t\t\t*p++ = LC_CNS11643_2;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t/* other planes are MULE private charsets */\n\t\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t\t\t*p++ = c1 - 0xa3 + LC_CNS11643_3;\n\t\t\t\t}\n\t\t\t\t*p++ = euc[2];\n\t\t\t\t*p++ = euc[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\t\t\t\t\t/* CNS11643-1 */\n\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\t*p++ = c1;\n\t\t\t\t*p++ = euc[1];\n\t\t\t}\n\t\t\teuc += l;\n\t\t\tlen -= l;\n\t\t}\n\t\telse\n\t\t{\t\t\t\t\t\t/* should be ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t*p++ = c1;\n\t\t\teuc++;\n\t\t\tlen--;\n\t\t}\n\t}\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"mb/pg_wchar.h\"",
            "#include \"fmgr.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void big52mic(const unsigned char *big5, unsigned char *p, int len);",
            "static void mic2big5(const unsigned char *mic, unsigned char *p, int len);",
            "static void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);",
            "static void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nstatic void\neuc_tw2mic(const unsigned char *euc, unsigned char *p, int len)\n{\n\tint\t\t\tc1;\n\tint\t\t\tl;\n\n\twhile (len > 0)\n\t{\n\t\tc1 = *euc;\n\t\tif (IS_HIGHBIT_SET(c1))\n\t\t{\n\t\t\tl = pg_encoding_verifymb(PG_EUC_TW, (const char *) euc, len);\n\t\t\tif (l < 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\tif (c1 == SS2)\n\t\t\t{\n\t\t\t\tc1 = euc[1];\t/* plane No. */\n\t\t\t\tif (c1 == 0xa1)\n\t\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\telse if (c1 == 0xa2)\n\t\t\t\t\t*p++ = LC_CNS11643_2;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t/* other planes are MULE private charsets */\n\t\t\t\t\t*p++ = LCPRV2_B;\n\t\t\t\t\t*p++ = c1 - 0xa3 + LC_CNS11643_3;\n\t\t\t\t}\n\t\t\t\t*p++ = euc[2];\n\t\t\t\t*p++ = euc[3];\n\t\t\t}\n\t\t\telse\n\t\t\t{\t\t\t\t\t/* CNS11643-1 */\n\t\t\t\t*p++ = LC_CNS11643_1;\n\t\t\t\t*p++ = c1;\n\t\t\t\t*p++ = euc[1];\n\t\t\t}\n\t\t\teuc += l;\n\t\t\tlen -= l;\n\t\t}\n\t\telse\n\t\t{\t\t\t\t\t\t/* should be ASCII */\n\t\t\tif (c1 == 0)\n\t\t\t\treport_invalid_encoding(PG_EUC_TW,\n\t\t\t\t\t\t\t\t\t\t(const char *) euc, len);\n\t\t\t*p++ = c1;\n\t\t\teuc++;\n\t\t\tlen--;\n\t\t}\n\t}\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "len * ENCODING_GROWTH_RATE + 1"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CHECK_ENCODING_CONVERSION_ARGS",
          "args": [
            "PG_EUC_TW",
            "PG_BIG5"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "4"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "3"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "2"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mb/pg_wchar.h\"\n#include \"fmgr.h\"\n#include \"postgres.h\"\n\n#define ENCODING_GROWTH_RATE 4\n\nstatic void big52mic(const unsigned char *big5, unsigned char *p, int len);\nstatic void mic2big5(const unsigned char *mic, unsigned char *p, int len);\nstatic void euc_tw2mic(const unsigned char *euc, unsigned char *p, int len);\nstatic void mic2euc_tw(const unsigned char *mic, unsigned char *p, int len);\n\nDatum\neuc_tw_to_big5(PG_FUNCTION_ARGS)\n{\n\tunsigned char *src = (unsigned char *) PG_GETARG_CSTRING(2);\n\tunsigned char *dest = (unsigned char *) PG_GETARG_CSTRING(3);\n\tint\t\t\tlen = PG_GETARG_INT32(4);\n\tunsigned char *buf;\n\n\tCHECK_ENCODING_CONVERSION_ARGS(PG_EUC_TW, PG_BIG5);\n\n\tbuf = palloc(len * ENCODING_GROWTH_RATE + 1);\n\teuc_tw2mic(src, buf, len);\n\tmic2big5(buf, dest, strlen((char *) buf));\n\tpfree(buf);\n\n\tPG_RETURN_VOID();\n}"
  }
]