[
  {
    "function_name": "oid_compare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1536-1545",
    "snippet": "static int\noid_compare(const void *a, const void *b)\n{\n\tOid\t\t\toa = *((const Oid *) a);\n\tOid\t\t\tob = *((const Oid *) b);\n\n\tif (oa == ob)\n\t\treturn 0;\n\treturn (oa > ob) ? 1 : -1;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int\toid_compare(const void *a, const void *b);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic int\toid_compare(const void *a, const void *b);\n\nstatic int\noid_compare(const void *a, const void *b)\n{\n\tOid\t\t\toa = *((const Oid *) a);\n\tOid\t\t\tob = *((const Oid *) b);\n\n\tif (oa == ob)\n\t\treturn 0;\n\treturn (oa > ob) ? 1 : -1;\n}"
  },
  {
    "function_name": "RelationSupportsSysCache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1511-1530",
    "snippet": "bool\nRelationSupportsSysCache(Oid relid)\n{\n\tint\t\t\tlow = 0,\n\t\t\t\thigh = SysCacheSupportingRelOidSize - 1;\n\n\twhile (low <= high)\n\t{\n\t\tint\t\t\tmiddle = low + (high - low) / 2;\n\n\t\tif (SysCacheSupportingRelOid[middle] == relid)\n\t\t\treturn true;\n\t\tif (SysCacheSupportingRelOid[middle] < relid)\n\t\t\tlow = middle + 1;\n\t\telse\n\t\t\thigh = middle - 1;\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tSysCacheSupportingRelOid[SysCacheSize * 2];",
      "static int\tSysCacheSupportingRelOidSize;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic Oid\tSysCacheSupportingRelOid[SysCacheSize * 2];\nstatic int\tSysCacheSupportingRelOidSize;\n\nbool\nRelationSupportsSysCache(Oid relid)\n{\n\tint\t\t\tlow = 0,\n\t\t\t\thigh = SysCacheSupportingRelOidSize - 1;\n\n\twhile (low <= high)\n\t{\n\t\tint\t\t\tmiddle = low + (high - low) / 2;\n\n\t\tif (SysCacheSupportingRelOid[middle] == relid)\n\t\t\treturn true;\n\t\tif (SysCacheSupportingRelOid[middle] < relid)\n\t\t\tlow = middle + 1;\n\t\telse\n\t\t\thigh = middle - 1;\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "RelationHasSysCache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1486-1505",
    "snippet": "bool\nRelationHasSysCache(Oid relid)\n{\n\tint\t\t\tlow = 0,\n\t\t\t\thigh = SysCacheRelationOidSize - 1;\n\n\twhile (low <= high)\n\t{\n\t\tint\t\t\tmiddle = low + (high - low) / 2;\n\n\t\tif (SysCacheRelationOid[middle] == relid)\n\t\t\treturn true;\n\t\tif (SysCacheRelationOid[middle] < relid)\n\t\t\tlow = middle + 1;\n\t\telse\n\t\t\thigh = middle - 1;\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tSysCacheRelationOid[SysCacheSize];",
      "static int\tSysCacheRelationOidSize;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic Oid\tSysCacheRelationOid[SysCacheSize];\nstatic int\tSysCacheRelationOidSize;\n\nbool\nRelationHasSysCache(Oid relid)\n{\n\tint\t\t\tlow = 0,\n\t\t\t\thigh = SysCacheRelationOidSize - 1;\n\n\twhile (low <= high)\n\t{\n\t\tint\t\t\tmiddle = low + (high - low) / 2;\n\n\t\tif (SysCacheRelationOid[middle] == relid)\n\t\t\treturn true;\n\t\tif (SysCacheRelationOid[middle] < relid)\n\t\t\tlow = middle + 1;\n\t\telse\n\t\t\thigh = middle - 1;\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "RelationInvalidatesSnapshotsOnly",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1463-1481",
    "snippet": "bool\nRelationInvalidatesSnapshotsOnly(Oid relid)\n{\n\tswitch (relid)\n\t{\n\t\tcase DbRoleSettingRelationId:\n\t\tcase DependRelationId:\n\t\tcase SharedDependRelationId:\n\t\tcase DescriptionRelationId:\n\t\tcase SharedDescriptionRelationId:\n\t\tcase SecLabelRelationId:\n\t\tcase SharedSecLabelRelationId:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nbool\nRelationInvalidatesSnapshotsOnly(Oid relid)\n{\n\tswitch (relid)\n\t{\n\t\tcase DbRoleSettingRelationId:\n\t\tcase DependRelationId:\n\t\tcase SharedDependRelationId:\n\t\tcase DescriptionRelationId:\n\t\tcase SharedDescriptionRelationId:\n\t\tcase SecLabelRelationId:\n\t\tcase SharedSecLabelRelationId:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "SysCacheInvalidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1439-1450",
    "snippet": "void\nSysCacheInvalidate(int cacheId, uint32 hashValue)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize)\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\t/* if this cache isn't initialized yet, no need to do anything */\n\tif (!PointerIsValid(SysCache[cacheId]))\n\t\treturn;\n\n\tCatCacheInvalidate(SysCache[cacheId], hashValue);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CatCache *SysCache[SysCacheSize];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "CatCacheInvalidate",
          "args": [
            "SysCache[cacheId]",
            "hashValue"
          ],
          "line": 1449
        },
        "resolved": true,
        "details": {
          "function_name": "CatCacheInvalidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "567-620",
          "snippet": "void\nCatCacheInvalidate(CatCache *cache, uint32 hashValue)\n{\n\tIndex\t\thashIndex;\n\tdlist_mutable_iter iter;\n\n\tCACHE1_elog(DEBUG2, \"CatCacheInvalidate: called\");\n\n\t/*\n\t * We don't bother to check whether the cache has finished initialization\n\t * yet; if not, there will be no entries in it so no problem.\n\t */\n\n\t/*\n\t * Invalidate *all* CatCLists in this cache; it's too hard to tell which\n\t * searches might still be correct, so just zap 'em all.\n\t */\n\tdlist_foreach_modify(iter, &cache->cc_lists)\n\t{\n\t\tCatCList   *cl = dlist_container(CatCList, cache_elem, iter.cur);\n\n\t\tif (cl->refcount > 0)\n\t\t\tcl->dead = true;\n\t\telse\n\t\t\tCatCacheRemoveCList(cache, cl);\n\t}\n\n\t/*\n\t * inspect the proper hash bucket for tuple matches\n\t */\n\thashIndex = HASH_INDEX(hashValue, cache->cc_nbuckets);\n\tdlist_foreach_modify(iter, &cache->cc_bucket[hashIndex])\n\t{\n\t\tCatCTup    *ct = dlist_container(CatCTup, cache_elem, iter.cur);\n\n\t\tif (hashValue == ct->hash_value)\n\t\t{\n\t\t\tif (ct->refcount > 0 ||\n\t\t\t\t(ct->c_list && ct->c_list->refcount > 0))\n\t\t\t{\n\t\t\t\tct->dead = true;\n\t\t\t\t/* list, if any, was marked dead above */\n\t\t\t\tAssert(ct->c_list == NULL || ct->c_list->dead);\n\t\t\t}\n\t\t\telse\n\t\t\t\tCatCacheRemoveCTup(cache, ct);\n\t\t\tCACHE1_elog(DEBUG2, \"CatCacheInvalidate: invalidated\");\n#ifdef CATCACHE_STATS\n\t\t\tcache->cc_invals++;\n#endif\n\t\t\t/* could be multiple matches, so keep looking! */\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static uint32 CatalogCacheComputeTupleHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t\t  HeapTuple tuple);",
            "static void CatCacheRemoveCTup(CatCache *cache, CatCTup *ct);",
            "static void CatCacheRemoveCList(CatCache *cache, CatCList *cl);",
            "static void CatalogCacheInitializeCache(CatCache *cache);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic uint32 CatalogCacheComputeTupleHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t\t  HeapTuple tuple);\nstatic void CatCacheRemoveCTup(CatCache *cache, CatCTup *ct);\nstatic void CatCacheRemoveCList(CatCache *cache, CatCList *cl);\nstatic void CatalogCacheInitializeCache(CatCache *cache);\n\nvoid\nCatCacheInvalidate(CatCache *cache, uint32 hashValue)\n{\n\tIndex\t\thashIndex;\n\tdlist_mutable_iter iter;\n\n\tCACHE1_elog(DEBUG2, \"CatCacheInvalidate: called\");\n\n\t/*\n\t * We don't bother to check whether the cache has finished initialization\n\t * yet; if not, there will be no entries in it so no problem.\n\t */\n\n\t/*\n\t * Invalidate *all* CatCLists in this cache; it's too hard to tell which\n\t * searches might still be correct, so just zap 'em all.\n\t */\n\tdlist_foreach_modify(iter, &cache->cc_lists)\n\t{\n\t\tCatCList   *cl = dlist_container(CatCList, cache_elem, iter.cur);\n\n\t\tif (cl->refcount > 0)\n\t\t\tcl->dead = true;\n\t\telse\n\t\t\tCatCacheRemoveCList(cache, cl);\n\t}\n\n\t/*\n\t * inspect the proper hash bucket for tuple matches\n\t */\n\thashIndex = HASH_INDEX(hashValue, cache->cc_nbuckets);\n\tdlist_foreach_modify(iter, &cache->cc_bucket[hashIndex])\n\t{\n\t\tCatCTup    *ct = dlist_container(CatCTup, cache_elem, iter.cur);\n\n\t\tif (hashValue == ct->hash_value)\n\t\t{\n\t\t\tif (ct->refcount > 0 ||\n\t\t\t\t(ct->c_list && ct->c_list->refcount > 0))\n\t\t\t{\n\t\t\t\tct->dead = true;\n\t\t\t\t/* list, if any, was marked dead above */\n\t\t\t\tAssert(ct->c_list == NULL || ct->c_list->dead);\n\t\t\t}\n\t\t\telse\n\t\t\t\tCatCacheRemoveCTup(cache, ct);\n\t\t\tCACHE1_elog(DEBUG2, \"CatCacheInvalidate: invalidated\");\n#ifdef CATCACHE_STATS\n\t\t\tcache->cc_invals++;\n#endif\n\t\t\t/* could be multiple matches, so keep looking! */\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]"
          ],
          "line": 1446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"invalid cache ID: %d\"",
            "cacheId"
          ],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nvoid\nSysCacheInvalidate(int cacheId, uint32 hashValue)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize)\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\t/* if this cache isn't initialized yet, no need to do anything */\n\tif (!PointerIsValid(SysCache[cacheId]))\n\t\treturn;\n\n\tCatCacheInvalidate(SysCache[cacheId], hashValue);\n}"
  },
  {
    "function_name": "SearchSysCacheList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1419-1429",
    "snippet": "struct catclist *\nSearchSysCacheList(int cacheId, int nkeys,\n\t\t\t\t   Datum key1, Datum key2, Datum key3)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\treturn SearchCatCacheList(SysCache[cacheId], nkeys,\n\t\t\t\t\t\t\t  key1, key2, key3);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CatCache *SysCache[SysCacheSize];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SearchCatCacheList",
          "args": [
            "SysCache[cacheId]",
            "nkeys",
            "key1",
            "key2",
            "key3"
          ],
          "line": 1427
        },
        "resolved": true,
        "details": {
          "function_name": "SearchCatCacheList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "1523-1792",
          "snippet": "CatCList *\nSearchCatCacheList(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   Datum v1,\n\t\t\t\t   Datum v2,\n\t\t\t\t   Datum v3)\n{\n\tDatum\t\tv4 = 0;\t\t\t/* dummy last-column value */\n\tDatum\t\targuments[CATCACHE_MAXKEYS];\n\tuint32\t\tlHashValue;\n\tdlist_iter\titer;\n\tCatCList   *cl;\n\tCatCTup    *ct;\n\tList\t   *volatile ctlist;\n\tListCell   *ctlist_item;\n\tint\t\t\tnmembers;\n\tbool\t\tordered;\n\tHeapTuple\tntp;\n\tMemoryContext oldcxt;\n\tint\t\t\ti;\n\n\t/*\n\t * one-time startup overhead for each cache\n\t */\n\tif (cache->cc_tupdesc == NULL)\n\t\tCatalogCacheInitializeCache(cache);\n\n\tAssert(nkeys > 0 && nkeys < cache->cc_nkeys);\n\n#ifdef CATCACHE_STATS\n\tcache->cc_lsearches++;\n#endif\n\n\t/* Initialize local parameter array */\n\targuments[0] = v1;\n\targuments[1] = v2;\n\targuments[2] = v3;\n\targuments[3] = v4;\n\n\t/*\n\t * compute a hash value of the given keys for faster search.  We don't\n\t * presently divide the CatCList items into buckets, but this still lets\n\t * us skip non-matching items quickly most of the time.\n\t */\n\tlHashValue = CatalogCacheComputeHashValue(cache, nkeys, v1, v2, v3, v4);\n\n\t/*\n\t * scan the items until we find a match or exhaust our list\n\t *\n\t * Note: it's okay to use dlist_foreach here, even though we modify the\n\t * dlist within the loop, because we don't continue the loop afterwards.\n\t */\n\tdlist_foreach(iter, &cache->cc_lists)\n\t{\n\t\tcl = dlist_container(CatCList, cache_elem, iter.cur);\n\n\t\tif (cl->dead)\n\t\t\tcontinue;\t\t\t/* ignore dead entries */\n\n\t\tif (cl->hash_value != lHashValue)\n\t\t\tcontinue;\t\t\t/* quickly skip entry if wrong hash val */\n\n\t\t/*\n\t\t * see if the cached list matches our key.\n\t\t */\n\t\tif (cl->nkeys != nkeys)\n\t\t\tcontinue;\n\n\t\tif (!CatalogCacheCompareTuple(cache, nkeys, cl->keys, arguments))\n\t\t\tcontinue;\n\n\t\t/*\n\t\t * We found a matching list.  Move the list to the front of the\n\t\t * cache's list-of-lists, to speed subsequent searches.  (We do not\n\t\t * move the members to the fronts of their hashbucket lists, however,\n\t\t * since there's no point in that unless they are searched for\n\t\t * individually.)\n\t\t */\n\t\tdlist_move_head(&cache->cc_lists, &cl->cache_elem);\n\n\t\t/* Bump the list's refcount and return it */\n\t\tResourceOwnerEnlargeCatCacheListRefs(CurrentResourceOwner);\n\t\tcl->refcount++;\n\t\tResourceOwnerRememberCatCacheListRef(CurrentResourceOwner, cl);\n\n\t\tCACHE2_elog(DEBUG2, \"SearchCatCacheList(%s): found list\",\n\t\t\t\t\tcache->cc_relname);\n\n#ifdef CATCACHE_STATS\n\t\tcache->cc_lhits++;\n#endif\n\n\t\treturn cl;\n\t}\n\n\t/*\n\t * List was not found in cache, so we have to build it by reading the\n\t * relation.  For each matching tuple found in the relation, use an\n\t * existing cache entry if possible, else build a new one.\n\t *\n\t * We have to bump the member refcounts temporarily to ensure they won't\n\t * get dropped from the cache while loading other members. We use a PG_TRY\n\t * block to ensure we can undo those refcounts if we get an error before\n\t * we finish constructing the CatCList.\n\t */\n\tResourceOwnerEnlargeCatCacheListRefs(CurrentResourceOwner);\n\n\tctlist = NIL;\n\n\tPG_TRY();\n\t{\n\t\tScanKeyData cur_skey[CATCACHE_MAXKEYS];\n\t\tRelation\trelation;\n\t\tSysScanDesc scandesc;\n\n\t\t/*\n\t\t * Ok, need to make a lookup in the relation, copy the scankey and\n\t\t * fill out any per-call fields.\n\t\t */\n\t\tmemcpy(cur_skey, cache->cc_skey, sizeof(ScanKeyData) * cache->cc_nkeys);\n\t\tcur_skey[0].sk_argument = v1;\n\t\tcur_skey[1].sk_argument = v2;\n\t\tcur_skey[2].sk_argument = v3;\n\t\tcur_skey[3].sk_argument = v4;\n\n\t\trelation = heap_open(cache->cc_reloid, AccessShareLock);\n\n\t\tscandesc = systable_beginscan(relation,\n\t\t\t\t\t\t\t\t\t  cache->cc_indexoid,\n\t\t\t\t\t\t\t\t\t  IndexScanOK(cache, cur_skey),\n\t\t\t\t\t\t\t\t\t  NULL,\n\t\t\t\t\t\t\t\t\t  nkeys,\n\t\t\t\t\t\t\t\t\t  cur_skey);\n\n\t\t/* The list will be ordered iff we are doing an index scan */\n\t\tordered = (scandesc->irel != NULL);\n\n\t\twhile (HeapTupleIsValid(ntp = systable_getnext(scandesc)))\n\t\t{\n\t\t\tuint32\t\thashValue;\n\t\t\tIndex\t\thashIndex;\n\t\t\tbool\t\tfound = false;\n\t\t\tdlist_head *bucket;\n\n\t\t\t/*\n\t\t\t * See if there's an entry for this tuple already.\n\t\t\t */\n\t\t\tct = NULL;\n\t\t\thashValue = CatalogCacheComputeTupleHashValue(cache, cache->cc_nkeys, ntp);\n\t\t\thashIndex = HASH_INDEX(hashValue, cache->cc_nbuckets);\n\n\t\t\tbucket = &cache->cc_bucket[hashIndex];\n\t\t\tdlist_foreach(iter, bucket)\n\t\t\t{\n\t\t\t\tct = dlist_container(CatCTup, cache_elem, iter.cur);\n\n\t\t\t\tif (ct->dead || ct->negative)\n\t\t\t\t\tcontinue;\t/* ignore dead and negative entries */\n\n\t\t\t\tif (ct->hash_value != hashValue)\n\t\t\t\t\tcontinue;\t/* quickly skip entry if wrong hash val */\n\n\t\t\t\tif (!ItemPointerEquals(&(ct->tuple.t_self), &(ntp->t_self)))\n\t\t\t\t\tcontinue;\t/* not same tuple */\n\n\t\t\t\t/*\n\t\t\t\t * Found a match, but can't use it if it belongs to another\n\t\t\t\t * list already\n\t\t\t\t */\n\t\t\t\tif (ct->c_list)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\t\t\t/* A-OK */\n\t\t\t}\n\n\t\t\tif (!found)\n\t\t\t{\n\t\t\t\t/* We didn't find a usable entry, so make a new one */\n\t\t\t\tct = CatalogCacheCreateEntry(cache, ntp, arguments,\n\t\t\t\t\t\t\t\t\t\t\t hashValue, hashIndex,\n\t\t\t\t\t\t\t\t\t\t\t false);\n\t\t\t}\n\n\t\t\t/* Careful here: add entry to ctlist, then bump its refcount */\n\t\t\t/* This way leaves state correct if lappend runs out of memory */\n\t\t\tctlist = lappend(ctlist, ct);\n\t\t\tct->refcount++;\n\t\t}\n\n\t\tsystable_endscan(scandesc);\n\n\t\theap_close(relation, AccessShareLock);\n\n\t\t/* Now we can build the CatCList entry. */\n\t\toldcxt = MemoryContextSwitchTo(CacheMemoryContext);\n\t\tnmembers = list_length(ctlist);\n\t\tcl = (CatCList *)\n\t\t\tpalloc(offsetof(CatCList, members) + nmembers * sizeof(CatCTup *));\n\n\t\t/* Extract key values */\n\t\tCatCacheCopyKeys(cache->cc_tupdesc, nkeys, cache->cc_keyno,\n\t\t\t\t\t\t arguments, cl->keys);\n\t\tMemoryContextSwitchTo(oldcxt);\n\n\t\t/*\n\t\t * We are now past the last thing that could trigger an elog before we\n\t\t * have finished building the CatCList and remembering it in the\n\t\t * resource owner.  So it's OK to fall out of the PG_TRY, and indeed\n\t\t * we'd better do so before we start marking the members as belonging\n\t\t * to the list.\n\t\t */\n\n\t}\n\tPG_CATCH();\n\t{\n\t\tforeach(ctlist_item, ctlist)\n\t\t{\n\t\t\tct = (CatCTup *) lfirst(ctlist_item);\n\t\t\tAssert(ct->c_list == NULL);\n\t\t\tAssert(ct->refcount > 0);\n\t\t\tct->refcount--;\n\t\t\tif (\n#ifndef CATCACHE_FORCE_RELEASE\n\t\t\t\tct->dead &&\n#endif\n\t\t\t\tct->refcount == 0 &&\n\t\t\t\t(ct->c_list == NULL || ct->c_list->refcount == 0))\n\t\t\t\tCatCacheRemoveCTup(cache, ct);\n\t\t}\n\n\t\tPG_RE_THROW();\n\t}\n\tPG_END_TRY();\n\n\tcl->cl_magic = CL_MAGIC;\n\tcl->my_cache = cache;\n\tcl->refcount = 0;\t\t\t/* for the moment */\n\tcl->dead = false;\n\tcl->ordered = ordered;\n\tcl->nkeys = nkeys;\n\tcl->hash_value = lHashValue;\n\tcl->n_members = nmembers;\n\n\ti = 0;\n\tforeach(ctlist_item, ctlist)\n\t{\n\t\tcl->members[i++] = ct = (CatCTup *) lfirst(ctlist_item);\n\t\tAssert(ct->c_list == NULL);\n\t\tct->c_list = cl;\n\t\t/* release the temporary refcount on the member */\n\t\tAssert(ct->refcount > 0);\n\t\tct->refcount--;\n\t\t/* mark list dead if any members already dead */\n\t\tif (ct->dead)\n\t\t\tcl->dead = true;\n\t}\n\tAssert(i == nmembers);\n\n\tdlist_push_head(&cache->cc_lists, &cl->cache_elem);\n\n\t/* Finally, bump the list's refcount and return it */\n\tcl->refcount++;\n\tResourceOwnerRememberCatCacheListRef(CurrentResourceOwner, cl);\n\n\tCACHE3_elog(DEBUG2, \"SearchCatCacheList(%s): made list of %d members\",\n\t\t\t\tcache->cc_relname, nmembers);\n\n\treturn cl;\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static inline HeapTuple SearchCatCacheInternal(CatCache *cache,\n\t\t\t\t\t   int nkeys,\n\t\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t\t   Datum v3, Datum v4);",
            "static pg_noinline HeapTuple SearchCatCacheMiss(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   uint32 hashValue,\n\t\t\t\t   Index hashIndex,\n\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t   Datum v3, Datum v4);",
            "static uint32 CatalogCacheComputeHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t Datum v1, Datum v2, Datum v3, Datum v4);",
            "static uint32 CatalogCacheComputeTupleHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t\t  HeapTuple tuple);",
            "static void CatCacheRemoveCTup(CatCache *cache, CatCTup *ct);",
            "static void CatCacheRemoveCList(CatCache *cache, CatCList *cl);",
            "static void CatalogCacheInitializeCache(CatCache *cache);",
            "static CatCTup *CatalogCacheCreateEntry(CatCache *cache, HeapTuple ntp,\n\t\t\t\t\t\tDatum *arguments,\n\t\t\t\t\t\tuint32 hashValue, Index hashIndex,\n\t\t\t\t\t\tbool negative);",
            "static void CatCacheFreeKeys(TupleDesc tupdesc, int nkeys, int *attnos,\n\t\t\t\t Datum *keys);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic inline HeapTuple SearchCatCacheInternal(CatCache *cache,\n\t\t\t\t\t   int nkeys,\n\t\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t\t   Datum v3, Datum v4);\nstatic pg_noinline HeapTuple SearchCatCacheMiss(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   uint32 hashValue,\n\t\t\t\t   Index hashIndex,\n\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t   Datum v3, Datum v4);\nstatic uint32 CatalogCacheComputeHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t Datum v1, Datum v2, Datum v3, Datum v4);\nstatic uint32 CatalogCacheComputeTupleHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t\t  HeapTuple tuple);\nstatic void CatCacheRemoveCTup(CatCache *cache, CatCTup *ct);\nstatic void CatCacheRemoveCList(CatCache *cache, CatCList *cl);\nstatic void CatalogCacheInitializeCache(CatCache *cache);\nstatic CatCTup *CatalogCacheCreateEntry(CatCache *cache, HeapTuple ntp,\n\t\t\t\t\t\tDatum *arguments,\n\t\t\t\t\t\tuint32 hashValue, Index hashIndex,\n\t\t\t\t\t\tbool negative);\nstatic void CatCacheFreeKeys(TupleDesc tupdesc, int nkeys, int *attnos,\n\t\t\t\t Datum *keys);\n\nCatCList *\nSearchCatCacheList(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   Datum v1,\n\t\t\t\t   Datum v2,\n\t\t\t\t   Datum v3)\n{\n\tDatum\t\tv4 = 0;\t\t\t/* dummy last-column value */\n\tDatum\t\targuments[CATCACHE_MAXKEYS];\n\tuint32\t\tlHashValue;\n\tdlist_iter\titer;\n\tCatCList   *cl;\n\tCatCTup    *ct;\n\tList\t   *volatile ctlist;\n\tListCell   *ctlist_item;\n\tint\t\t\tnmembers;\n\tbool\t\tordered;\n\tHeapTuple\tntp;\n\tMemoryContext oldcxt;\n\tint\t\t\ti;\n\n\t/*\n\t * one-time startup overhead for each cache\n\t */\n\tif (cache->cc_tupdesc == NULL)\n\t\tCatalogCacheInitializeCache(cache);\n\n\tAssert(nkeys > 0 && nkeys < cache->cc_nkeys);\n\n#ifdef CATCACHE_STATS\n\tcache->cc_lsearches++;\n#endif\n\n\t/* Initialize local parameter array */\n\targuments[0] = v1;\n\targuments[1] = v2;\n\targuments[2] = v3;\n\targuments[3] = v4;\n\n\t/*\n\t * compute a hash value of the given keys for faster search.  We don't\n\t * presently divide the CatCList items into buckets, but this still lets\n\t * us skip non-matching items quickly most of the time.\n\t */\n\tlHashValue = CatalogCacheComputeHashValue(cache, nkeys, v1, v2, v3, v4);\n\n\t/*\n\t * scan the items until we find a match or exhaust our list\n\t *\n\t * Note: it's okay to use dlist_foreach here, even though we modify the\n\t * dlist within the loop, because we don't continue the loop afterwards.\n\t */\n\tdlist_foreach(iter, &cache->cc_lists)\n\t{\n\t\tcl = dlist_container(CatCList, cache_elem, iter.cur);\n\n\t\tif (cl->dead)\n\t\t\tcontinue;\t\t\t/* ignore dead entries */\n\n\t\tif (cl->hash_value != lHashValue)\n\t\t\tcontinue;\t\t\t/* quickly skip entry if wrong hash val */\n\n\t\t/*\n\t\t * see if the cached list matches our key.\n\t\t */\n\t\tif (cl->nkeys != nkeys)\n\t\t\tcontinue;\n\n\t\tif (!CatalogCacheCompareTuple(cache, nkeys, cl->keys, arguments))\n\t\t\tcontinue;\n\n\t\t/*\n\t\t * We found a matching list.  Move the list to the front of the\n\t\t * cache's list-of-lists, to speed subsequent searches.  (We do not\n\t\t * move the members to the fronts of their hashbucket lists, however,\n\t\t * since there's no point in that unless they are searched for\n\t\t * individually.)\n\t\t */\n\t\tdlist_move_head(&cache->cc_lists, &cl->cache_elem);\n\n\t\t/* Bump the list's refcount and return it */\n\t\tResourceOwnerEnlargeCatCacheListRefs(CurrentResourceOwner);\n\t\tcl->refcount++;\n\t\tResourceOwnerRememberCatCacheListRef(CurrentResourceOwner, cl);\n\n\t\tCACHE2_elog(DEBUG2, \"SearchCatCacheList(%s): found list\",\n\t\t\t\t\tcache->cc_relname);\n\n#ifdef CATCACHE_STATS\n\t\tcache->cc_lhits++;\n#endif\n\n\t\treturn cl;\n\t}\n\n\t/*\n\t * List was not found in cache, so we have to build it by reading the\n\t * relation.  For each matching tuple found in the relation, use an\n\t * existing cache entry if possible, else build a new one.\n\t *\n\t * We have to bump the member refcounts temporarily to ensure they won't\n\t * get dropped from the cache while loading other members. We use a PG_TRY\n\t * block to ensure we can undo those refcounts if we get an error before\n\t * we finish constructing the CatCList.\n\t */\n\tResourceOwnerEnlargeCatCacheListRefs(CurrentResourceOwner);\n\n\tctlist = NIL;\n\n\tPG_TRY();\n\t{\n\t\tScanKeyData cur_skey[CATCACHE_MAXKEYS];\n\t\tRelation\trelation;\n\t\tSysScanDesc scandesc;\n\n\t\t/*\n\t\t * Ok, need to make a lookup in the relation, copy the scankey and\n\t\t * fill out any per-call fields.\n\t\t */\n\t\tmemcpy(cur_skey, cache->cc_skey, sizeof(ScanKeyData) * cache->cc_nkeys);\n\t\tcur_skey[0].sk_argument = v1;\n\t\tcur_skey[1].sk_argument = v2;\n\t\tcur_skey[2].sk_argument = v3;\n\t\tcur_skey[3].sk_argument = v4;\n\n\t\trelation = heap_open(cache->cc_reloid, AccessShareLock);\n\n\t\tscandesc = systable_beginscan(relation,\n\t\t\t\t\t\t\t\t\t  cache->cc_indexoid,\n\t\t\t\t\t\t\t\t\t  IndexScanOK(cache, cur_skey),\n\t\t\t\t\t\t\t\t\t  NULL,\n\t\t\t\t\t\t\t\t\t  nkeys,\n\t\t\t\t\t\t\t\t\t  cur_skey);\n\n\t\t/* The list will be ordered iff we are doing an index scan */\n\t\tordered = (scandesc->irel != NULL);\n\n\t\twhile (HeapTupleIsValid(ntp = systable_getnext(scandesc)))\n\t\t{\n\t\t\tuint32\t\thashValue;\n\t\t\tIndex\t\thashIndex;\n\t\t\tbool\t\tfound = false;\n\t\t\tdlist_head *bucket;\n\n\t\t\t/*\n\t\t\t * See if there's an entry for this tuple already.\n\t\t\t */\n\t\t\tct = NULL;\n\t\t\thashValue = CatalogCacheComputeTupleHashValue(cache, cache->cc_nkeys, ntp);\n\t\t\thashIndex = HASH_INDEX(hashValue, cache->cc_nbuckets);\n\n\t\t\tbucket = &cache->cc_bucket[hashIndex];\n\t\t\tdlist_foreach(iter, bucket)\n\t\t\t{\n\t\t\t\tct = dlist_container(CatCTup, cache_elem, iter.cur);\n\n\t\t\t\tif (ct->dead || ct->negative)\n\t\t\t\t\tcontinue;\t/* ignore dead and negative entries */\n\n\t\t\t\tif (ct->hash_value != hashValue)\n\t\t\t\t\tcontinue;\t/* quickly skip entry if wrong hash val */\n\n\t\t\t\tif (!ItemPointerEquals(&(ct->tuple.t_self), &(ntp->t_self)))\n\t\t\t\t\tcontinue;\t/* not same tuple */\n\n\t\t\t\t/*\n\t\t\t\t * Found a match, but can't use it if it belongs to another\n\t\t\t\t * list already\n\t\t\t\t */\n\t\t\t\tif (ct->c_list)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\t\t\t/* A-OK */\n\t\t\t}\n\n\t\t\tif (!found)\n\t\t\t{\n\t\t\t\t/* We didn't find a usable entry, so make a new one */\n\t\t\t\tct = CatalogCacheCreateEntry(cache, ntp, arguments,\n\t\t\t\t\t\t\t\t\t\t\t hashValue, hashIndex,\n\t\t\t\t\t\t\t\t\t\t\t false);\n\t\t\t}\n\n\t\t\t/* Careful here: add entry to ctlist, then bump its refcount */\n\t\t\t/* This way leaves state correct if lappend runs out of memory */\n\t\t\tctlist = lappend(ctlist, ct);\n\t\t\tct->refcount++;\n\t\t}\n\n\t\tsystable_endscan(scandesc);\n\n\t\theap_close(relation, AccessShareLock);\n\n\t\t/* Now we can build the CatCList entry. */\n\t\toldcxt = MemoryContextSwitchTo(CacheMemoryContext);\n\t\tnmembers = list_length(ctlist);\n\t\tcl = (CatCList *)\n\t\t\tpalloc(offsetof(CatCList, members) + nmembers * sizeof(CatCTup *));\n\n\t\t/* Extract key values */\n\t\tCatCacheCopyKeys(cache->cc_tupdesc, nkeys, cache->cc_keyno,\n\t\t\t\t\t\t arguments, cl->keys);\n\t\tMemoryContextSwitchTo(oldcxt);\n\n\t\t/*\n\t\t * We are now past the last thing that could trigger an elog before we\n\t\t * have finished building the CatCList and remembering it in the\n\t\t * resource owner.  So it's OK to fall out of the PG_TRY, and indeed\n\t\t * we'd better do so before we start marking the members as belonging\n\t\t * to the list.\n\t\t */\n\n\t}\n\tPG_CATCH();\n\t{\n\t\tforeach(ctlist_item, ctlist)\n\t\t{\n\t\t\tct = (CatCTup *) lfirst(ctlist_item);\n\t\t\tAssert(ct->c_list == NULL);\n\t\t\tAssert(ct->refcount > 0);\n\t\t\tct->refcount--;\n\t\t\tif (\n#ifndef CATCACHE_FORCE_RELEASE\n\t\t\t\tct->dead &&\n#endif\n\t\t\t\tct->refcount == 0 &&\n\t\t\t\t(ct->c_list == NULL || ct->c_list->refcount == 0))\n\t\t\t\tCatCacheRemoveCTup(cache, ct);\n\t\t}\n\n\t\tPG_RE_THROW();\n\t}\n\tPG_END_TRY();\n\n\tcl->cl_magic = CL_MAGIC;\n\tcl->my_cache = cache;\n\tcl->refcount = 0;\t\t\t/* for the moment */\n\tcl->dead = false;\n\tcl->ordered = ordered;\n\tcl->nkeys = nkeys;\n\tcl->hash_value = lHashValue;\n\tcl->n_members = nmembers;\n\n\ti = 0;\n\tforeach(ctlist_item, ctlist)\n\t{\n\t\tcl->members[i++] = ct = (CatCTup *) lfirst(ctlist_item);\n\t\tAssert(ct->c_list == NULL);\n\t\tct->c_list = cl;\n\t\t/* release the temporary refcount on the member */\n\t\tAssert(ct->refcount > 0);\n\t\tct->refcount--;\n\t\t/* mark list dead if any members already dead */\n\t\tif (ct->dead)\n\t\t\tcl->dead = true;\n\t}\n\tAssert(i == nmembers);\n\n\tdlist_push_head(&cache->cc_lists, &cl->cache_elem);\n\n\t/* Finally, bump the list's refcount and return it */\n\tcl->refcount++;\n\tResourceOwnerRememberCatCacheListRef(CurrentResourceOwner, cl);\n\n\tCACHE3_elog(DEBUG2, \"SearchCatCacheList(%s): made list of %d members\",\n\t\t\t\tcache->cc_relname, nmembers);\n\n\treturn cl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"invalid cache ID: %d\"",
            "cacheId"
          ],
          "line": 1425
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]"
          ],
          "line": 1424
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nstruct catclist *\nSearchSysCacheList(int cacheId, int nkeys,\n\t\t\t\t   Datum key1, Datum key2, Datum key3)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\treturn SearchCatCacheList(SysCache[cacheId], nkeys,\n\t\t\t\t\t\t\t  key1, key2, key3);\n}"
  },
  {
    "function_name": "GetSysCacheHashValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1402-1414",
    "snippet": "uint32\nGetSysCacheHashValue(int cacheId,\n\t\t\t\t\t Datum key1,\n\t\t\t\t\t Datum key2,\n\t\t\t\t\t Datum key3,\n\t\t\t\t\t Datum key4)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\treturn GetCatCacheHashValue(SysCache[cacheId], key1, key2, key3, key4);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CatCache *SysCache[SysCacheSize];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetCatCacheHashValue",
          "args": [
            "SysCache[cacheId]",
            "key1",
            "key2",
            "key3",
            "key4"
          ],
          "line": 1413
        },
        "resolved": true,
        "details": {
          "function_name": "GetCatCacheHashValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "1489-1506",
          "snippet": "uint32\nGetCatCacheHashValue(CatCache *cache,\n\t\t\t\t\t Datum v1,\n\t\t\t\t\t Datum v2,\n\t\t\t\t\t Datum v3,\n\t\t\t\t\t Datum v4)\n{\n\t/*\n\t * one-time startup overhead for each cache\n\t */\n\tif (cache->cc_tupdesc == NULL)\n\t\tCatalogCacheInitializeCache(cache);\n\n\t/*\n\t * calculate the hash value\n\t */\n\treturn CatalogCacheComputeHashValue(cache, cache->cc_nkeys, v1, v2, v3, v4);\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static inline HeapTuple SearchCatCacheInternal(CatCache *cache,\n\t\t\t\t\t   int nkeys,\n\t\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t\t   Datum v3, Datum v4);",
            "static pg_noinline HeapTuple SearchCatCacheMiss(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   uint32 hashValue,\n\t\t\t\t   Index hashIndex,\n\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t   Datum v3, Datum v4);",
            "static uint32 CatalogCacheComputeHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t Datum v1, Datum v2, Datum v3, Datum v4);",
            "static void CatalogCacheInitializeCache(CatCache *cache);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic inline HeapTuple SearchCatCacheInternal(CatCache *cache,\n\t\t\t\t\t   int nkeys,\n\t\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t\t   Datum v3, Datum v4);\nstatic pg_noinline HeapTuple SearchCatCacheMiss(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   uint32 hashValue,\n\t\t\t\t   Index hashIndex,\n\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t   Datum v3, Datum v4);\nstatic uint32 CatalogCacheComputeHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t Datum v1, Datum v2, Datum v3, Datum v4);\nstatic void CatalogCacheInitializeCache(CatCache *cache);\n\nuint32\nGetCatCacheHashValue(CatCache *cache,\n\t\t\t\t\t Datum v1,\n\t\t\t\t\t Datum v2,\n\t\t\t\t\t Datum v3,\n\t\t\t\t\t Datum v4)\n{\n\t/*\n\t * one-time startup overhead for each cache\n\t */\n\tif (cache->cc_tupdesc == NULL)\n\t\tCatalogCacheInitializeCache(cache);\n\n\t/*\n\t * calculate the hash value\n\t */\n\treturn CatalogCacheComputeHashValue(cache, cache->cc_nkeys, v1, v2, v3, v4);\n}"
        }
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"invalid cache ID: %d\"",
            "cacheId"
          ],
          "line": 1411
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]"
          ],
          "line": 1410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nuint32\nGetSysCacheHashValue(int cacheId,\n\t\t\t\t\t Datum key1,\n\t\t\t\t\t Datum key2,\n\t\t\t\t\t Datum key3,\n\t\t\t\t\t Datum key4)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\treturn GetCatCacheHashValue(SysCache[cacheId], key1, key2, key3, key4);\n}"
  },
  {
    "function_name": "SysCacheGetAttr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1367-1390",
    "snippet": "Datum\nSysCacheGetAttr(int cacheId, HeapTuple tup,\n\t\t\t\tAttrNumber attributeNumber,\n\t\t\t\tbool *isNull)\n{\n\t/*\n\t * We just need to get the TupleDesc out of the cache entry, and then we\n\t * can apply heap_getattr().  Normally the cache control data is already\n\t * valid (because the caller recently fetched the tuple via this same\n\t * cache), but there are cases where we have to initialize the cache here.\n\t */\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\tif (!PointerIsValid(SysCache[cacheId]->cc_tupdesc))\n\t{\n\t\tInitCatCachePhase2(SysCache[cacheId], false);\n\t\tAssert(PointerIsValid(SysCache[cacheId]->cc_tupdesc));\n\t}\n\n\treturn heap_getattr(tup, attributeNumber,\n\t\t\t\t\t\tSysCache[cacheId]->cc_tupdesc,\n\t\t\t\t\t\tisNull);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CatCache *SysCache[SysCacheSize];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "heap_getattr",
          "args": [
            "tup",
            "attributeNumber",
            "SysCache[cacheId]->cc_tupdesc",
            "isNull"
          ],
          "line": 1387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "PointerIsValid(SysCache[cacheId]->cc_tupdesc)"
          ],
          "line": 1384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]->cc_tupdesc"
          ],
          "line": 1384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InitCatCachePhase2",
          "args": [
            "SysCache[cacheId]",
            "false"
          ],
          "line": 1383
        },
        "resolved": true,
        "details": {
          "function_name": "InitCatCachePhase2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "1049-1082",
          "snippet": "void\nInitCatCachePhase2(CatCache *cache, bool touch_index)\n{\n\tif (cache->cc_tupdesc == NULL)\n\t\tCatalogCacheInitializeCache(cache);\n\n\tif (touch_index &&\n\t\tcache->id != AMOID &&\n\t\tcache->id != AMNAME)\n\t{\n\t\tRelation\tidesc;\n\n\t\t/*\n\t\t * We must lock the underlying catalog before opening the index to\n\t\t * avoid deadlock, since index_open could possibly result in reading\n\t\t * this same catalog, and if anyone else is exclusive-locking this\n\t\t * catalog and index they'll be doing it in that order.\n\t\t */\n\t\tLockRelationOid(cache->cc_reloid, AccessShareLock);\n\t\tidesc = index_open(cache->cc_indexoid, AccessShareLock);\n\n\t\t/*\n\t\t * While we've got the index open, let's check that it's unique (and\n\t\t * not just deferrable-unique, thank you very much).  This is just to\n\t\t * catch thinkos in definitions of new catcaches, so we don't worry\n\t\t * about the pg_am indexes not getting tested.\n\t\t */\n\t\tAssert(idesc->rd_index->indisunique &&\n\t\t\t   idesc->rd_index->indimmediate);\n\n\t\tindex_close(idesc, AccessShareLock);\n\t\tUnlockRelationOid(cache->cc_reloid, AccessShareLock);\n\t}\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void CatalogCacheInitializeCache(CatCache *cache);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic void CatalogCacheInitializeCache(CatCache *cache);\n\nvoid\nInitCatCachePhase2(CatCache *cache, bool touch_index)\n{\n\tif (cache->cc_tupdesc == NULL)\n\t\tCatalogCacheInitializeCache(cache);\n\n\tif (touch_index &&\n\t\tcache->id != AMOID &&\n\t\tcache->id != AMNAME)\n\t{\n\t\tRelation\tidesc;\n\n\t\t/*\n\t\t * We must lock the underlying catalog before opening the index to\n\t\t * avoid deadlock, since index_open could possibly result in reading\n\t\t * this same catalog, and if anyone else is exclusive-locking this\n\t\t * catalog and index they'll be doing it in that order.\n\t\t */\n\t\tLockRelationOid(cache->cc_reloid, AccessShareLock);\n\t\tidesc = index_open(cache->cc_indexoid, AccessShareLock);\n\n\t\t/*\n\t\t * While we've got the index open, let's check that it's unique (and\n\t\t * not just deferrable-unique, thank you very much).  This is just to\n\t\t * catch thinkos in definitions of new catcaches, so we don't worry\n\t\t * about the pg_am indexes not getting tested.\n\t\t */\n\t\tAssert(idesc->rd_index->indisunique &&\n\t\t\t   idesc->rd_index->indimmediate);\n\n\t\tindex_close(idesc, AccessShareLock);\n\t\tUnlockRelationOid(cache->cc_reloid, AccessShareLock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]->cc_tupdesc"
          ],
          "line": 1381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"invalid cache ID: %d\"",
            "cacheId"
          ],
          "line": 1380
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]"
          ],
          "line": 1379
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nDatum\nSysCacheGetAttr(int cacheId, HeapTuple tup,\n\t\t\t\tAttrNumber attributeNumber,\n\t\t\t\tbool *isNull)\n{\n\t/*\n\t * We just need to get the TupleDesc out of the cache entry, and then we\n\t * can apply heap_getattr().  Normally the cache control data is already\n\t * valid (because the caller recently fetched the tuple via this same\n\t * cache), but there are cases where we have to initialize the cache here.\n\t */\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\tif (!PointerIsValid(SysCache[cacheId]->cc_tupdesc))\n\t{\n\t\tInitCatCachePhase2(SysCache[cacheId], false);\n\t\tAssert(PointerIsValid(SysCache[cacheId]->cc_tupdesc));\n\t}\n\n\treturn heap_getattr(tup, attributeNumber,\n\t\t\t\t\t\tSysCache[cacheId]->cc_tupdesc,\n\t\t\t\t\t\tisNull);\n}"
  },
  {
    "function_name": "SearchSysCacheCopyAttNum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1333-1345",
    "snippet": "HeapTuple\nSearchSysCacheCopyAttNum(Oid relid, int16 attnum)\n{\n\tHeapTuple\ttuple,\n\t\t\t\tnewtuple;\n\n\ttuple = SearchSysCacheAttNum(relid, attnum);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tnewtuple = heap_copytuple(tuple);\n\tReleaseSysCache(tuple);\n\treturn newtuple;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "tuple"
          ],
          "line": 1343
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "heap_copytuple",
          "args": [
            "tuple"
          ],
          "line": 1342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 1340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheAttNum",
          "args": [
            "relid",
            "attnum"
          ],
          "line": 1339
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCacheAttNum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1310-1326",
          "snippet": "HeapTuple\nSearchSysCacheAttNum(Oid relid, int16 attnum)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\tObjectIdGetDatum(relid),\n\t\t\t\t\t\t\tInt16GetDatum(attnum));\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tif (((Form_pg_attribute) GETSTRUCT(tuple))->attisdropped)\n\t{\n\t\tReleaseSysCache(tuple);\n\t\treturn NULL;\n\t}\n\treturn tuple;\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nHeapTuple\nSearchSysCacheAttNum(Oid relid, int16 attnum)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\tObjectIdGetDatum(relid),\n\t\t\t\t\t\t\tInt16GetDatum(attnum));\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tif (((Form_pg_attribute) GETSTRUCT(tuple))->attisdropped)\n\t{\n\t\tReleaseSysCache(tuple);\n\t\treturn NULL;\n\t}\n\treturn tuple;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nHeapTuple\nSearchSysCacheCopyAttNum(Oid relid, int16 attnum)\n{\n\tHeapTuple\ttuple,\n\t\t\t\tnewtuple;\n\n\ttuple = SearchSysCacheAttNum(relid, attnum);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tnewtuple = heap_copytuple(tuple);\n\tReleaseSysCache(tuple);\n\treturn newtuple;\n}"
  },
  {
    "function_name": "SearchSysCacheAttNum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1310-1326",
    "snippet": "HeapTuple\nSearchSysCacheAttNum(Oid relid, int16 attnum)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\tObjectIdGetDatum(relid),\n\t\t\t\t\t\t\tInt16GetDatum(attnum));\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tif (((Form_pg_attribute) GETSTRUCT(tuple))->attisdropped)\n\t{\n\t\tReleaseSysCache(tuple);\n\t\treturn NULL;\n\t}\n\treturn tuple;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "tuple"
          ],
          "line": 1322
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "tuple"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCache2",
          "args": [
            "ATTNUM",
            "ObjectIdGetDatum(relid)",
            "Int16GetDatum(attnum)"
          ],
          "line": 1315
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCache2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1122-1131",
          "snippet": "HeapTuple\nSearchSysCache2(int cacheId,\n\t\t\t\tDatum key1, Datum key2)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 2);\n\n\treturn SearchCatCache2(SysCache[cacheId], key1, key2);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static CatCache *SysCache[SysCacheSize];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache2(int cacheId,\n\t\t\t\tDatum key1, Datum key2)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 2);\n\n\treturn SearchCatCache2(SysCache[cacheId], key1, key2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Int16GetDatum",
          "args": [
            "attnum"
          ],
          "line": 1317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "relid"
          ],
          "line": 1316
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nHeapTuple\nSearchSysCacheAttNum(Oid relid, int16 attnum)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\tObjectIdGetDatum(relid),\n\t\t\t\t\t\t\tInt16GetDatum(attnum));\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tif (((Form_pg_attribute) GETSTRUCT(tuple))->attisdropped)\n\t{\n\t\tReleaseSysCache(tuple);\n\t\treturn NULL;\n\t}\n\treturn tuple;\n}"
  },
  {
    "function_name": "SearchSysCacheExistsAttName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1289-1299",
    "snippet": "bool\nSearchSysCacheExistsAttName(Oid relid, const char *attname)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCacheAttName(relid, attname);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn false;\n\tReleaseSysCache(tuple);\n\treturn true;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "tuple"
          ],
          "line": 1297
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 1295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheAttName",
          "args": [
            "relid",
            "attname"
          ],
          "line": 1294
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCacheAttName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1247-1263",
          "snippet": "HeapTuple\nSearchSysCacheAttName(Oid relid, const char *attname)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\tObjectIdGetDatum(relid),\n\t\t\t\t\t\t\tCStringGetDatum(attname));\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tif (((Form_pg_attribute) GETSTRUCT(tuple))->attisdropped)\n\t{\n\t\tReleaseSysCache(tuple);\n\t\treturn NULL;\n\t}\n\treturn tuple;\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nHeapTuple\nSearchSysCacheAttName(Oid relid, const char *attname)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\tObjectIdGetDatum(relid),\n\t\t\t\t\t\t\tCStringGetDatum(attname));\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tif (((Form_pg_attribute) GETSTRUCT(tuple))->attisdropped)\n\t{\n\t\tReleaseSysCache(tuple);\n\t\treturn NULL;\n\t}\n\treturn tuple;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nbool\nSearchSysCacheExistsAttName(Oid relid, const char *attname)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCacheAttName(relid, attname);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn false;\n\tReleaseSysCache(tuple);\n\treturn true;\n}"
  },
  {
    "function_name": "SearchSysCacheCopyAttName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1270-1282",
    "snippet": "HeapTuple\nSearchSysCacheCopyAttName(Oid relid, const char *attname)\n{\n\tHeapTuple\ttuple,\n\t\t\t\tnewtuple;\n\n\ttuple = SearchSysCacheAttName(relid, attname);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn tuple;\n\tnewtuple = heap_copytuple(tuple);\n\tReleaseSysCache(tuple);\n\treturn newtuple;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "tuple"
          ],
          "line": 1280
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "heap_copytuple",
          "args": [
            "tuple"
          ],
          "line": 1279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 1277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheAttName",
          "args": [
            "relid",
            "attname"
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCacheAttName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1247-1263",
          "snippet": "HeapTuple\nSearchSysCacheAttName(Oid relid, const char *attname)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\tObjectIdGetDatum(relid),\n\t\t\t\t\t\t\tCStringGetDatum(attname));\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tif (((Form_pg_attribute) GETSTRUCT(tuple))->attisdropped)\n\t{\n\t\tReleaseSysCache(tuple);\n\t\treturn NULL;\n\t}\n\treturn tuple;\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nHeapTuple\nSearchSysCacheAttName(Oid relid, const char *attname)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\tObjectIdGetDatum(relid),\n\t\t\t\t\t\t\tCStringGetDatum(attname));\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tif (((Form_pg_attribute) GETSTRUCT(tuple))->attisdropped)\n\t{\n\t\tReleaseSysCache(tuple);\n\t\treturn NULL;\n\t}\n\treturn tuple;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nHeapTuple\nSearchSysCacheCopyAttName(Oid relid, const char *attname)\n{\n\tHeapTuple\ttuple,\n\t\t\t\tnewtuple;\n\n\ttuple = SearchSysCacheAttName(relid, attname);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn tuple;\n\tnewtuple = heap_copytuple(tuple);\n\tReleaseSysCache(tuple);\n\treturn newtuple;\n}"
  },
  {
    "function_name": "SearchSysCacheAttName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1247-1263",
    "snippet": "HeapTuple\nSearchSysCacheAttName(Oid relid, const char *attname)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\tObjectIdGetDatum(relid),\n\t\t\t\t\t\t\tCStringGetDatum(attname));\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tif (((Form_pg_attribute) GETSTRUCT(tuple))->attisdropped)\n\t{\n\t\tReleaseSysCache(tuple);\n\t\treturn NULL;\n\t}\n\treturn tuple;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "tuple"
          ],
          "line": 1259
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "tuple"
          ],
          "line": 1257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCache2",
          "args": [
            "ATTNAME",
            "ObjectIdGetDatum(relid)",
            "CStringGetDatum(attname)"
          ],
          "line": 1252
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCache2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1122-1131",
          "snippet": "HeapTuple\nSearchSysCache2(int cacheId,\n\t\t\t\tDatum key1, Datum key2)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 2);\n\n\treturn SearchCatCache2(SysCache[cacheId], key1, key2);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static CatCache *SysCache[SysCacheSize];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache2(int cacheId,\n\t\t\t\tDatum key1, Datum key2)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 2);\n\n\treturn SearchCatCache2(SysCache[cacheId], key1, key2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "attname"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "relid"
          ],
          "line": 1253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nHeapTuple\nSearchSysCacheAttName(Oid relid, const char *attname)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\tObjectIdGetDatum(relid),\n\t\t\t\t\t\t\tCStringGetDatum(attname));\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn NULL;\n\tif (((Form_pg_attribute) GETSTRUCT(tuple))->attisdropped)\n\t{\n\t\tReleaseSysCache(tuple);\n\t\treturn NULL;\n\t}\n\treturn tuple;\n}"
  },
  {
    "function_name": "GetSysCacheOid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1220-1236",
    "snippet": "Oid\nGetSysCacheOid(int cacheId,\n\t\t\t   Datum key1,\n\t\t\t   Datum key2,\n\t\t\t   Datum key3,\n\t\t\t   Datum key4)\n{\n\tHeapTuple\ttuple;\n\tOid\t\t\tresult;\n\n\ttuple = SearchSysCache(cacheId, key1, key2, key3, key4);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn InvalidOid;\n\tresult = HeapTupleGetOid(tuple);\n\tReleaseSysCache(tuple);\n\treturn result;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "tuple"
          ],
          "line": 1234
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HeapTupleGetOid",
          "args": [
            "tuple"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 1231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCache",
          "args": [
            "cacheId",
            "key1",
            "key2",
            "key3",
            "key4"
          ],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCacheList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1419-1429",
          "snippet": "struct catclist *\nSearchSysCacheList(int cacheId, int nkeys,\n\t\t\t\t   Datum key1, Datum key2, Datum key3)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\treturn SearchCatCacheList(SysCache[cacheId], nkeys,\n\t\t\t\t\t\t\t  key1, key2, key3);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static CatCache *SysCache[SysCacheSize];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nstruct catclist *\nSearchSysCacheList(int cacheId, int nkeys,\n\t\t\t\t   Datum key1, Datum key2, Datum key3)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\treturn SearchCatCacheList(SysCache[cacheId], nkeys,\n\t\t\t\t\t\t\t  key1, key2, key3);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nOid\nGetSysCacheOid(int cacheId,\n\t\t\t   Datum key1,\n\t\t\t   Datum key2,\n\t\t\t   Datum key3,\n\t\t\t   Datum key4)\n{\n\tHeapTuple\ttuple;\n\tOid\t\t\tresult;\n\n\ttuple = SearchSysCache(cacheId, key1, key2, key3, key4);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn InvalidOid;\n\tresult = HeapTupleGetOid(tuple);\n\tReleaseSysCache(tuple);\n\treturn result;\n}"
  },
  {
    "function_name": "SearchSysCacheExists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1197-1211",
    "snippet": "bool\nSearchSysCacheExists(int cacheId,\n\t\t\t\t\t Datum key1,\n\t\t\t\t\t Datum key2,\n\t\t\t\t\t Datum key3,\n\t\t\t\t\t Datum key4)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache(cacheId, key1, key2, key3, key4);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn false;\n\tReleaseSysCache(tuple);\n\treturn true;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "tuple"
          ],
          "line": 1209
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCache",
          "args": [
            "cacheId",
            "key1",
            "key2",
            "key3",
            "key4"
          ],
          "line": 1206
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCacheList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1419-1429",
          "snippet": "struct catclist *\nSearchSysCacheList(int cacheId, int nkeys,\n\t\t\t\t   Datum key1, Datum key2, Datum key3)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\treturn SearchCatCacheList(SysCache[cacheId], nkeys,\n\t\t\t\t\t\t\t  key1, key2, key3);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static CatCache *SysCache[SysCacheSize];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nstruct catclist *\nSearchSysCacheList(int cacheId, int nkeys,\n\t\t\t\t   Datum key1, Datum key2, Datum key3)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\treturn SearchCatCacheList(SysCache[cacheId], nkeys,\n\t\t\t\t\t\t\t  key1, key2, key3);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nbool\nSearchSysCacheExists(int cacheId,\n\t\t\t\t\t Datum key1,\n\t\t\t\t\t Datum key2,\n\t\t\t\t\t Datum key3,\n\t\t\t\t\t Datum key4)\n{\n\tHeapTuple\ttuple;\n\n\ttuple = SearchSysCache(cacheId, key1, key2, key3, key4);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn false;\n\tReleaseSysCache(tuple);\n\treturn true;\n}"
  },
  {
    "function_name": "SearchSysCacheCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1173-1189",
    "snippet": "HeapTuple\nSearchSysCacheCopy(int cacheId,\n\t\t\t\t   Datum key1,\n\t\t\t\t   Datum key2,\n\t\t\t\t   Datum key3,\n\t\t\t\t   Datum key4)\n{\n\tHeapTuple\ttuple,\n\t\t\t\tnewtuple;\n\n\ttuple = SearchSysCache(cacheId, key1, key2, key3, key4);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn tuple;\n\tnewtuple = heap_copytuple(tuple);\n\tReleaseSysCache(tuple);\n\treturn newtuple;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "tuple"
          ],
          "line": 1187
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "heap_copytuple",
          "args": [
            "tuple"
          ],
          "line": 1186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCache",
          "args": [
            "cacheId",
            "key1",
            "key2",
            "key3",
            "key4"
          ],
          "line": 1183
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCacheList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1419-1429",
          "snippet": "struct catclist *\nSearchSysCacheList(int cacheId, int nkeys,\n\t\t\t\t   Datum key1, Datum key2, Datum key3)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\treturn SearchCatCacheList(SysCache[cacheId], nkeys,\n\t\t\t\t\t\t\t  key1, key2, key3);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static CatCache *SysCache[SysCacheSize];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nstruct catclist *\nSearchSysCacheList(int cacheId, int nkeys,\n\t\t\t\t   Datum key1, Datum key2, Datum key3)\n{\n\tif (cacheId < 0 || cacheId >= SysCacheSize ||\n\t\t!PointerIsValid(SysCache[cacheId]))\n\t\telog(ERROR, \"invalid cache ID: %d\", cacheId);\n\n\treturn SearchCatCacheList(SysCache[cacheId], nkeys,\n\t\t\t\t\t\t\t  key1, key2, key3);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nHeapTuple\nSearchSysCacheCopy(int cacheId,\n\t\t\t\t   Datum key1,\n\t\t\t\t   Datum key2,\n\t\t\t\t   Datum key3,\n\t\t\t\t   Datum key4)\n{\n\tHeapTuple\ttuple,\n\t\t\t\tnewtuple;\n\n\ttuple = SearchSysCache(cacheId, key1, key2, key3, key4);\n\tif (!HeapTupleIsValid(tuple))\n\t\treturn tuple;\n\tnewtuple = heap_copytuple(tuple);\n\tReleaseSysCache(tuple);\n\treturn newtuple;\n}"
  },
  {
    "function_name": "ReleaseSysCache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1159-1163",
    "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseCatCache",
          "args": [
            "tuple"
          ],
          "line": 1162
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseCatCacheList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "1799-1814",
          "snippet": "void\nReleaseCatCacheList(CatCList *list)\n{\n\t/* Safety checks to ensure we were handed a cache entry */\n\tAssert(list->cl_magic == CL_MAGIC);\n\tAssert(list->refcount > 0);\n\tlist->refcount--;\n\tResourceOwnerForgetCatCacheListRef(CurrentResourceOwner, list);\n\n\tif (\n#ifndef CATCACHE_FORCE_RELEASE\n\t\tlist->dead &&\n#endif\n\t\tlist->refcount == 0)\n\t\tCatCacheRemoveCList(list->my_cache, list);\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void CatalogCacheInitializeCache(CatCache *cache);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic void CatalogCacheInitializeCache(CatCache *cache);\n\nvoid\nReleaseCatCacheList(CatCList *list)\n{\n\t/* Safety checks to ensure we were handed a cache entry */\n\tAssert(list->cl_magic == CL_MAGIC);\n\tAssert(list->refcount > 0);\n\tlist->refcount--;\n\tResourceOwnerForgetCatCacheListRef(CurrentResourceOwner, list);\n\n\tif (\n#ifndef CATCACHE_FORCE_RELEASE\n\t\tlist->dead &&\n#endif\n\t\tlist->refcount == 0)\n\t\tCatCacheRemoveCList(list->my_cache, list);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
  },
  {
    "function_name": "SearchSysCache4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1144-1153",
    "snippet": "HeapTuple\nSearchSysCache4(int cacheId,\n\t\t\t\tDatum key1, Datum key2, Datum key3, Datum key4)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 4);\n\n\treturn SearchCatCache4(SysCache[cacheId], key1, key2, key3, key4);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CatCache *SysCache[SysCacheSize];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SearchCatCache4",
          "args": [
            "SysCache[cacheId]",
            "key1",
            "key2",
            "key3",
            "key4"
          ],
          "line": 1152
        },
        "resolved": true,
        "details": {
          "function_name": "SearchCatCache4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "1205-1210",
          "snippet": "HeapTuple\nSearchCatCache4(CatCache *cache,\n\t\t\t\tDatum v1, Datum v2, Datum v3, Datum v4)\n{\n\treturn SearchCatCacheInternal(cache, 4, v1, v2, v3, v4);\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static inline HeapTuple SearchCatCacheInternal(CatCache *cache,\n\t\t\t\t\t   int nkeys,\n\t\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t\t   Datum v3, Datum v4);",
            "static pg_noinline HeapTuple SearchCatCacheMiss(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   uint32 hashValue,\n\t\t\t\t   Index hashIndex,\n\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t   Datum v3, Datum v4);",
            "static uint32 CatalogCacheComputeHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t Datum v1, Datum v2, Datum v3, Datum v4);",
            "static void CatalogCacheInitializeCache(CatCache *cache);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic inline HeapTuple SearchCatCacheInternal(CatCache *cache,\n\t\t\t\t\t   int nkeys,\n\t\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t\t   Datum v3, Datum v4);\nstatic pg_noinline HeapTuple SearchCatCacheMiss(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   uint32 hashValue,\n\t\t\t\t   Index hashIndex,\n\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t   Datum v3, Datum v4);\nstatic uint32 CatalogCacheComputeHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t Datum v1, Datum v2, Datum v3, Datum v4);\nstatic void CatalogCacheInitializeCache(CatCache *cache);\n\nHeapTuple\nSearchCatCache4(CatCache *cache,\n\t\t\t\tDatum v1, Datum v2, Datum v3, Datum v4)\n{\n\treturn SearchCatCacheInternal(cache, 4, v1, v2, v3, v4);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "SysCache[cacheId]->cc_nkeys == 4"
          ],
          "line": 1150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId])"
          ],
          "line": 1148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]"
          ],
          "line": 1149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache4(int cacheId,\n\t\t\t\tDatum key1, Datum key2, Datum key3, Datum key4)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 4);\n\n\treturn SearchCatCache4(SysCache[cacheId], key1, key2, key3, key4);\n}"
  },
  {
    "function_name": "SearchSysCache3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1133-1142",
    "snippet": "HeapTuple\nSearchSysCache3(int cacheId,\n\t\t\t\tDatum key1, Datum key2, Datum key3)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 3);\n\n\treturn SearchCatCache3(SysCache[cacheId], key1, key2, key3);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CatCache *SysCache[SysCacheSize];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SearchCatCache3",
          "args": [
            "SysCache[cacheId]",
            "key1",
            "key2",
            "key3"
          ],
          "line": 1141
        },
        "resolved": true,
        "details": {
          "function_name": "SearchCatCache3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "1197-1202",
          "snippet": "HeapTuple\nSearchCatCache3(CatCache *cache,\n\t\t\t\tDatum v1, Datum v2, Datum v3)\n{\n\treturn SearchCatCacheInternal(cache, 3, v1, v2, v3, 0);\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void CatalogCacheInitializeCache(CatCache *cache);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic void CatalogCacheInitializeCache(CatCache *cache);\n\nHeapTuple\nSearchCatCache3(CatCache *cache,\n\t\t\t\tDatum v1, Datum v2, Datum v3)\n{\n\treturn SearchCatCacheInternal(cache, 3, v1, v2, v3, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "SysCache[cacheId]->cc_nkeys == 3"
          ],
          "line": 1139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId])"
          ],
          "line": 1137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]"
          ],
          "line": 1138
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache3(int cacheId,\n\t\t\t\tDatum key1, Datum key2, Datum key3)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 3);\n\n\treturn SearchCatCache3(SysCache[cacheId], key1, key2, key3);\n}"
  },
  {
    "function_name": "SearchSysCache2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1122-1131",
    "snippet": "HeapTuple\nSearchSysCache2(int cacheId,\n\t\t\t\tDatum key1, Datum key2)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 2);\n\n\treturn SearchCatCache2(SysCache[cacheId], key1, key2);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CatCache *SysCache[SysCacheSize];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SearchCatCache2",
          "args": [
            "SysCache[cacheId]",
            "key1",
            "key2"
          ],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "SearchCatCache2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "1189-1194",
          "snippet": "HeapTuple\nSearchCatCache2(CatCache *cache,\n\t\t\t\tDatum v1, Datum v2)\n{\n\treturn SearchCatCacheInternal(cache, 2, v1, v2, 0, 0);\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void CatalogCacheInitializeCache(CatCache *cache);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic void CatalogCacheInitializeCache(CatCache *cache);\n\nHeapTuple\nSearchCatCache2(CatCache *cache,\n\t\t\t\tDatum v1, Datum v2)\n{\n\treturn SearchCatCacheInternal(cache, 2, v1, v2, 0, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "SysCache[cacheId]->cc_nkeys == 2"
          ],
          "line": 1128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId])"
          ],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]"
          ],
          "line": 1127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache2(int cacheId,\n\t\t\t\tDatum key1, Datum key2)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 2);\n\n\treturn SearchCatCache2(SysCache[cacheId], key1, key2);\n}"
  },
  {
    "function_name": "SearchSysCache1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1111-1120",
    "snippet": "HeapTuple\nSearchSysCache1(int cacheId,\n\t\t\t\tDatum key1)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 1);\n\n\treturn SearchCatCache1(SysCache[cacheId], key1);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CatCache *SysCache[SysCacheSize];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SearchCatCache1",
          "args": [
            "SysCache[cacheId]",
            "key1"
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "SearchCatCache1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "1181-1186",
          "snippet": "HeapTuple\nSearchCatCache1(CatCache *cache,\n\t\t\t\tDatum v1)\n{\n\treturn SearchCatCacheInternal(cache, 1, v1, 0, 0, 0);\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void CatalogCacheInitializeCache(CatCache *cache);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic void CatalogCacheInitializeCache(CatCache *cache);\n\nHeapTuple\nSearchCatCache1(CatCache *cache,\n\t\t\t\tDatum v1)\n{\n\treturn SearchCatCacheInternal(cache, 1, v1, 0, 0, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "SysCache[cacheId]->cc_nkeys == 1"
          ],
          "line": 1117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId])"
          ],
          "line": 1115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]"
          ],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache1(int cacheId,\n\t\t\t\tDatum key1)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 1);\n\n\treturn SearchCatCache1(SysCache[cacheId], key1);\n}"
  },
  {
    "function_name": "SearchSysCache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1098-1109",
    "snippet": "HeapTuple\nSearchSysCache(int cacheId,\n\t\t\t   Datum key1,\n\t\t\t   Datum key2,\n\t\t\t   Datum key3,\n\t\t\t   Datum key4)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\n\treturn SearchCatCache(SysCache[cacheId], key1, key2, key3, key4);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CatCache *SysCache[SysCacheSize];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SearchCatCache",
          "args": [
            "SysCache[cacheId]",
            "key1",
            "key2",
            "key3",
            "key4"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "SearchCatCacheList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "1523-1792",
          "snippet": "CatCList *\nSearchCatCacheList(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   Datum v1,\n\t\t\t\t   Datum v2,\n\t\t\t\t   Datum v3)\n{\n\tDatum\t\tv4 = 0;\t\t\t/* dummy last-column value */\n\tDatum\t\targuments[CATCACHE_MAXKEYS];\n\tuint32\t\tlHashValue;\n\tdlist_iter\titer;\n\tCatCList   *cl;\n\tCatCTup    *ct;\n\tList\t   *volatile ctlist;\n\tListCell   *ctlist_item;\n\tint\t\t\tnmembers;\n\tbool\t\tordered;\n\tHeapTuple\tntp;\n\tMemoryContext oldcxt;\n\tint\t\t\ti;\n\n\t/*\n\t * one-time startup overhead for each cache\n\t */\n\tif (cache->cc_tupdesc == NULL)\n\t\tCatalogCacheInitializeCache(cache);\n\n\tAssert(nkeys > 0 && nkeys < cache->cc_nkeys);\n\n#ifdef CATCACHE_STATS\n\tcache->cc_lsearches++;\n#endif\n\n\t/* Initialize local parameter array */\n\targuments[0] = v1;\n\targuments[1] = v2;\n\targuments[2] = v3;\n\targuments[3] = v4;\n\n\t/*\n\t * compute a hash value of the given keys for faster search.  We don't\n\t * presently divide the CatCList items into buckets, but this still lets\n\t * us skip non-matching items quickly most of the time.\n\t */\n\tlHashValue = CatalogCacheComputeHashValue(cache, nkeys, v1, v2, v3, v4);\n\n\t/*\n\t * scan the items until we find a match or exhaust our list\n\t *\n\t * Note: it's okay to use dlist_foreach here, even though we modify the\n\t * dlist within the loop, because we don't continue the loop afterwards.\n\t */\n\tdlist_foreach(iter, &cache->cc_lists)\n\t{\n\t\tcl = dlist_container(CatCList, cache_elem, iter.cur);\n\n\t\tif (cl->dead)\n\t\t\tcontinue;\t\t\t/* ignore dead entries */\n\n\t\tif (cl->hash_value != lHashValue)\n\t\t\tcontinue;\t\t\t/* quickly skip entry if wrong hash val */\n\n\t\t/*\n\t\t * see if the cached list matches our key.\n\t\t */\n\t\tif (cl->nkeys != nkeys)\n\t\t\tcontinue;\n\n\t\tif (!CatalogCacheCompareTuple(cache, nkeys, cl->keys, arguments))\n\t\t\tcontinue;\n\n\t\t/*\n\t\t * We found a matching list.  Move the list to the front of the\n\t\t * cache's list-of-lists, to speed subsequent searches.  (We do not\n\t\t * move the members to the fronts of their hashbucket lists, however,\n\t\t * since there's no point in that unless they are searched for\n\t\t * individually.)\n\t\t */\n\t\tdlist_move_head(&cache->cc_lists, &cl->cache_elem);\n\n\t\t/* Bump the list's refcount and return it */\n\t\tResourceOwnerEnlargeCatCacheListRefs(CurrentResourceOwner);\n\t\tcl->refcount++;\n\t\tResourceOwnerRememberCatCacheListRef(CurrentResourceOwner, cl);\n\n\t\tCACHE2_elog(DEBUG2, \"SearchCatCacheList(%s): found list\",\n\t\t\t\t\tcache->cc_relname);\n\n#ifdef CATCACHE_STATS\n\t\tcache->cc_lhits++;\n#endif\n\n\t\treturn cl;\n\t}\n\n\t/*\n\t * List was not found in cache, so we have to build it by reading the\n\t * relation.  For each matching tuple found in the relation, use an\n\t * existing cache entry if possible, else build a new one.\n\t *\n\t * We have to bump the member refcounts temporarily to ensure they won't\n\t * get dropped from the cache while loading other members. We use a PG_TRY\n\t * block to ensure we can undo those refcounts if we get an error before\n\t * we finish constructing the CatCList.\n\t */\n\tResourceOwnerEnlargeCatCacheListRefs(CurrentResourceOwner);\n\n\tctlist = NIL;\n\n\tPG_TRY();\n\t{\n\t\tScanKeyData cur_skey[CATCACHE_MAXKEYS];\n\t\tRelation\trelation;\n\t\tSysScanDesc scandesc;\n\n\t\t/*\n\t\t * Ok, need to make a lookup in the relation, copy the scankey and\n\t\t * fill out any per-call fields.\n\t\t */\n\t\tmemcpy(cur_skey, cache->cc_skey, sizeof(ScanKeyData) * cache->cc_nkeys);\n\t\tcur_skey[0].sk_argument = v1;\n\t\tcur_skey[1].sk_argument = v2;\n\t\tcur_skey[2].sk_argument = v3;\n\t\tcur_skey[3].sk_argument = v4;\n\n\t\trelation = heap_open(cache->cc_reloid, AccessShareLock);\n\n\t\tscandesc = systable_beginscan(relation,\n\t\t\t\t\t\t\t\t\t  cache->cc_indexoid,\n\t\t\t\t\t\t\t\t\t  IndexScanOK(cache, cur_skey),\n\t\t\t\t\t\t\t\t\t  NULL,\n\t\t\t\t\t\t\t\t\t  nkeys,\n\t\t\t\t\t\t\t\t\t  cur_skey);\n\n\t\t/* The list will be ordered iff we are doing an index scan */\n\t\tordered = (scandesc->irel != NULL);\n\n\t\twhile (HeapTupleIsValid(ntp = systable_getnext(scandesc)))\n\t\t{\n\t\t\tuint32\t\thashValue;\n\t\t\tIndex\t\thashIndex;\n\t\t\tbool\t\tfound = false;\n\t\t\tdlist_head *bucket;\n\n\t\t\t/*\n\t\t\t * See if there's an entry for this tuple already.\n\t\t\t */\n\t\t\tct = NULL;\n\t\t\thashValue = CatalogCacheComputeTupleHashValue(cache, cache->cc_nkeys, ntp);\n\t\t\thashIndex = HASH_INDEX(hashValue, cache->cc_nbuckets);\n\n\t\t\tbucket = &cache->cc_bucket[hashIndex];\n\t\t\tdlist_foreach(iter, bucket)\n\t\t\t{\n\t\t\t\tct = dlist_container(CatCTup, cache_elem, iter.cur);\n\n\t\t\t\tif (ct->dead || ct->negative)\n\t\t\t\t\tcontinue;\t/* ignore dead and negative entries */\n\n\t\t\t\tif (ct->hash_value != hashValue)\n\t\t\t\t\tcontinue;\t/* quickly skip entry if wrong hash val */\n\n\t\t\t\tif (!ItemPointerEquals(&(ct->tuple.t_self), &(ntp->t_self)))\n\t\t\t\t\tcontinue;\t/* not same tuple */\n\n\t\t\t\t/*\n\t\t\t\t * Found a match, but can't use it if it belongs to another\n\t\t\t\t * list already\n\t\t\t\t */\n\t\t\t\tif (ct->c_list)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\t\t\t/* A-OK */\n\t\t\t}\n\n\t\t\tif (!found)\n\t\t\t{\n\t\t\t\t/* We didn't find a usable entry, so make a new one */\n\t\t\t\tct = CatalogCacheCreateEntry(cache, ntp, arguments,\n\t\t\t\t\t\t\t\t\t\t\t hashValue, hashIndex,\n\t\t\t\t\t\t\t\t\t\t\t false);\n\t\t\t}\n\n\t\t\t/* Careful here: add entry to ctlist, then bump its refcount */\n\t\t\t/* This way leaves state correct if lappend runs out of memory */\n\t\t\tctlist = lappend(ctlist, ct);\n\t\t\tct->refcount++;\n\t\t}\n\n\t\tsystable_endscan(scandesc);\n\n\t\theap_close(relation, AccessShareLock);\n\n\t\t/* Now we can build the CatCList entry. */\n\t\toldcxt = MemoryContextSwitchTo(CacheMemoryContext);\n\t\tnmembers = list_length(ctlist);\n\t\tcl = (CatCList *)\n\t\t\tpalloc(offsetof(CatCList, members) + nmembers * sizeof(CatCTup *));\n\n\t\t/* Extract key values */\n\t\tCatCacheCopyKeys(cache->cc_tupdesc, nkeys, cache->cc_keyno,\n\t\t\t\t\t\t arguments, cl->keys);\n\t\tMemoryContextSwitchTo(oldcxt);\n\n\t\t/*\n\t\t * We are now past the last thing that could trigger an elog before we\n\t\t * have finished building the CatCList and remembering it in the\n\t\t * resource owner.  So it's OK to fall out of the PG_TRY, and indeed\n\t\t * we'd better do so before we start marking the members as belonging\n\t\t * to the list.\n\t\t */\n\n\t}\n\tPG_CATCH();\n\t{\n\t\tforeach(ctlist_item, ctlist)\n\t\t{\n\t\t\tct = (CatCTup *) lfirst(ctlist_item);\n\t\t\tAssert(ct->c_list == NULL);\n\t\t\tAssert(ct->refcount > 0);\n\t\t\tct->refcount--;\n\t\t\tif (\n#ifndef CATCACHE_FORCE_RELEASE\n\t\t\t\tct->dead &&\n#endif\n\t\t\t\tct->refcount == 0 &&\n\t\t\t\t(ct->c_list == NULL || ct->c_list->refcount == 0))\n\t\t\t\tCatCacheRemoveCTup(cache, ct);\n\t\t}\n\n\t\tPG_RE_THROW();\n\t}\n\tPG_END_TRY();\n\n\tcl->cl_magic = CL_MAGIC;\n\tcl->my_cache = cache;\n\tcl->refcount = 0;\t\t\t/* for the moment */\n\tcl->dead = false;\n\tcl->ordered = ordered;\n\tcl->nkeys = nkeys;\n\tcl->hash_value = lHashValue;\n\tcl->n_members = nmembers;\n\n\ti = 0;\n\tforeach(ctlist_item, ctlist)\n\t{\n\t\tcl->members[i++] = ct = (CatCTup *) lfirst(ctlist_item);\n\t\tAssert(ct->c_list == NULL);\n\t\tct->c_list = cl;\n\t\t/* release the temporary refcount on the member */\n\t\tAssert(ct->refcount > 0);\n\t\tct->refcount--;\n\t\t/* mark list dead if any members already dead */\n\t\tif (ct->dead)\n\t\t\tcl->dead = true;\n\t}\n\tAssert(i == nmembers);\n\n\tdlist_push_head(&cache->cc_lists, &cl->cache_elem);\n\n\t/* Finally, bump the list's refcount and return it */\n\tcl->refcount++;\n\tResourceOwnerRememberCatCacheListRef(CurrentResourceOwner, cl);\n\n\tCACHE3_elog(DEBUG2, \"SearchCatCacheList(%s): made list of %d members\",\n\t\t\t\tcache->cc_relname, nmembers);\n\n\treturn cl;\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static inline HeapTuple SearchCatCacheInternal(CatCache *cache,\n\t\t\t\t\t   int nkeys,\n\t\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t\t   Datum v3, Datum v4);",
            "static pg_noinline HeapTuple SearchCatCacheMiss(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   uint32 hashValue,\n\t\t\t\t   Index hashIndex,\n\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t   Datum v3, Datum v4);",
            "static uint32 CatalogCacheComputeHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t Datum v1, Datum v2, Datum v3, Datum v4);",
            "static uint32 CatalogCacheComputeTupleHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t\t  HeapTuple tuple);",
            "static void CatCacheRemoveCTup(CatCache *cache, CatCTup *ct);",
            "static void CatCacheRemoveCList(CatCache *cache, CatCList *cl);",
            "static void CatalogCacheInitializeCache(CatCache *cache);",
            "static CatCTup *CatalogCacheCreateEntry(CatCache *cache, HeapTuple ntp,\n\t\t\t\t\t\tDatum *arguments,\n\t\t\t\t\t\tuint32 hashValue, Index hashIndex,\n\t\t\t\t\t\tbool negative);",
            "static void CatCacheFreeKeys(TupleDesc tupdesc, int nkeys, int *attnos,\n\t\t\t\t Datum *keys);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic inline HeapTuple SearchCatCacheInternal(CatCache *cache,\n\t\t\t\t\t   int nkeys,\n\t\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t\t   Datum v3, Datum v4);\nstatic pg_noinline HeapTuple SearchCatCacheMiss(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   uint32 hashValue,\n\t\t\t\t   Index hashIndex,\n\t\t\t\t   Datum v1, Datum v2,\n\t\t\t\t   Datum v3, Datum v4);\nstatic uint32 CatalogCacheComputeHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t Datum v1, Datum v2, Datum v3, Datum v4);\nstatic uint32 CatalogCacheComputeTupleHashValue(CatCache *cache, int nkeys,\n\t\t\t\t\t\t\t\t  HeapTuple tuple);\nstatic void CatCacheRemoveCTup(CatCache *cache, CatCTup *ct);\nstatic void CatCacheRemoveCList(CatCache *cache, CatCList *cl);\nstatic void CatalogCacheInitializeCache(CatCache *cache);\nstatic CatCTup *CatalogCacheCreateEntry(CatCache *cache, HeapTuple ntp,\n\t\t\t\t\t\tDatum *arguments,\n\t\t\t\t\t\tuint32 hashValue, Index hashIndex,\n\t\t\t\t\t\tbool negative);\nstatic void CatCacheFreeKeys(TupleDesc tupdesc, int nkeys, int *attnos,\n\t\t\t\t Datum *keys);\n\nCatCList *\nSearchCatCacheList(CatCache *cache,\n\t\t\t\t   int nkeys,\n\t\t\t\t   Datum v1,\n\t\t\t\t   Datum v2,\n\t\t\t\t   Datum v3)\n{\n\tDatum\t\tv4 = 0;\t\t\t/* dummy last-column value */\n\tDatum\t\targuments[CATCACHE_MAXKEYS];\n\tuint32\t\tlHashValue;\n\tdlist_iter\titer;\n\tCatCList   *cl;\n\tCatCTup    *ct;\n\tList\t   *volatile ctlist;\n\tListCell   *ctlist_item;\n\tint\t\t\tnmembers;\n\tbool\t\tordered;\n\tHeapTuple\tntp;\n\tMemoryContext oldcxt;\n\tint\t\t\ti;\n\n\t/*\n\t * one-time startup overhead for each cache\n\t */\n\tif (cache->cc_tupdesc == NULL)\n\t\tCatalogCacheInitializeCache(cache);\n\n\tAssert(nkeys > 0 && nkeys < cache->cc_nkeys);\n\n#ifdef CATCACHE_STATS\n\tcache->cc_lsearches++;\n#endif\n\n\t/* Initialize local parameter array */\n\targuments[0] = v1;\n\targuments[1] = v2;\n\targuments[2] = v3;\n\targuments[3] = v4;\n\n\t/*\n\t * compute a hash value of the given keys for faster search.  We don't\n\t * presently divide the CatCList items into buckets, but this still lets\n\t * us skip non-matching items quickly most of the time.\n\t */\n\tlHashValue = CatalogCacheComputeHashValue(cache, nkeys, v1, v2, v3, v4);\n\n\t/*\n\t * scan the items until we find a match or exhaust our list\n\t *\n\t * Note: it's okay to use dlist_foreach here, even though we modify the\n\t * dlist within the loop, because we don't continue the loop afterwards.\n\t */\n\tdlist_foreach(iter, &cache->cc_lists)\n\t{\n\t\tcl = dlist_container(CatCList, cache_elem, iter.cur);\n\n\t\tif (cl->dead)\n\t\t\tcontinue;\t\t\t/* ignore dead entries */\n\n\t\tif (cl->hash_value != lHashValue)\n\t\t\tcontinue;\t\t\t/* quickly skip entry if wrong hash val */\n\n\t\t/*\n\t\t * see if the cached list matches our key.\n\t\t */\n\t\tif (cl->nkeys != nkeys)\n\t\t\tcontinue;\n\n\t\tif (!CatalogCacheCompareTuple(cache, nkeys, cl->keys, arguments))\n\t\t\tcontinue;\n\n\t\t/*\n\t\t * We found a matching list.  Move the list to the front of the\n\t\t * cache's list-of-lists, to speed subsequent searches.  (We do not\n\t\t * move the members to the fronts of their hashbucket lists, however,\n\t\t * since there's no point in that unless they are searched for\n\t\t * individually.)\n\t\t */\n\t\tdlist_move_head(&cache->cc_lists, &cl->cache_elem);\n\n\t\t/* Bump the list's refcount and return it */\n\t\tResourceOwnerEnlargeCatCacheListRefs(CurrentResourceOwner);\n\t\tcl->refcount++;\n\t\tResourceOwnerRememberCatCacheListRef(CurrentResourceOwner, cl);\n\n\t\tCACHE2_elog(DEBUG2, \"SearchCatCacheList(%s): found list\",\n\t\t\t\t\tcache->cc_relname);\n\n#ifdef CATCACHE_STATS\n\t\tcache->cc_lhits++;\n#endif\n\n\t\treturn cl;\n\t}\n\n\t/*\n\t * List was not found in cache, so we have to build it by reading the\n\t * relation.  For each matching tuple found in the relation, use an\n\t * existing cache entry if possible, else build a new one.\n\t *\n\t * We have to bump the member refcounts temporarily to ensure they won't\n\t * get dropped from the cache while loading other members. We use a PG_TRY\n\t * block to ensure we can undo those refcounts if we get an error before\n\t * we finish constructing the CatCList.\n\t */\n\tResourceOwnerEnlargeCatCacheListRefs(CurrentResourceOwner);\n\n\tctlist = NIL;\n\n\tPG_TRY();\n\t{\n\t\tScanKeyData cur_skey[CATCACHE_MAXKEYS];\n\t\tRelation\trelation;\n\t\tSysScanDesc scandesc;\n\n\t\t/*\n\t\t * Ok, need to make a lookup in the relation, copy the scankey and\n\t\t * fill out any per-call fields.\n\t\t */\n\t\tmemcpy(cur_skey, cache->cc_skey, sizeof(ScanKeyData) * cache->cc_nkeys);\n\t\tcur_skey[0].sk_argument = v1;\n\t\tcur_skey[1].sk_argument = v2;\n\t\tcur_skey[2].sk_argument = v3;\n\t\tcur_skey[3].sk_argument = v4;\n\n\t\trelation = heap_open(cache->cc_reloid, AccessShareLock);\n\n\t\tscandesc = systable_beginscan(relation,\n\t\t\t\t\t\t\t\t\t  cache->cc_indexoid,\n\t\t\t\t\t\t\t\t\t  IndexScanOK(cache, cur_skey),\n\t\t\t\t\t\t\t\t\t  NULL,\n\t\t\t\t\t\t\t\t\t  nkeys,\n\t\t\t\t\t\t\t\t\t  cur_skey);\n\n\t\t/* The list will be ordered iff we are doing an index scan */\n\t\tordered = (scandesc->irel != NULL);\n\n\t\twhile (HeapTupleIsValid(ntp = systable_getnext(scandesc)))\n\t\t{\n\t\t\tuint32\t\thashValue;\n\t\t\tIndex\t\thashIndex;\n\t\t\tbool\t\tfound = false;\n\t\t\tdlist_head *bucket;\n\n\t\t\t/*\n\t\t\t * See if there's an entry for this tuple already.\n\t\t\t */\n\t\t\tct = NULL;\n\t\t\thashValue = CatalogCacheComputeTupleHashValue(cache, cache->cc_nkeys, ntp);\n\t\t\thashIndex = HASH_INDEX(hashValue, cache->cc_nbuckets);\n\n\t\t\tbucket = &cache->cc_bucket[hashIndex];\n\t\t\tdlist_foreach(iter, bucket)\n\t\t\t{\n\t\t\t\tct = dlist_container(CatCTup, cache_elem, iter.cur);\n\n\t\t\t\tif (ct->dead || ct->negative)\n\t\t\t\t\tcontinue;\t/* ignore dead and negative entries */\n\n\t\t\t\tif (ct->hash_value != hashValue)\n\t\t\t\t\tcontinue;\t/* quickly skip entry if wrong hash val */\n\n\t\t\t\tif (!ItemPointerEquals(&(ct->tuple.t_self), &(ntp->t_self)))\n\t\t\t\t\tcontinue;\t/* not same tuple */\n\n\t\t\t\t/*\n\t\t\t\t * Found a match, but can't use it if it belongs to another\n\t\t\t\t * list already\n\t\t\t\t */\n\t\t\t\tif (ct->c_list)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\t\t\t/* A-OK */\n\t\t\t}\n\n\t\t\tif (!found)\n\t\t\t{\n\t\t\t\t/* We didn't find a usable entry, so make a new one */\n\t\t\t\tct = CatalogCacheCreateEntry(cache, ntp, arguments,\n\t\t\t\t\t\t\t\t\t\t\t hashValue, hashIndex,\n\t\t\t\t\t\t\t\t\t\t\t false);\n\t\t\t}\n\n\t\t\t/* Careful here: add entry to ctlist, then bump its refcount */\n\t\t\t/* This way leaves state correct if lappend runs out of memory */\n\t\t\tctlist = lappend(ctlist, ct);\n\t\t\tct->refcount++;\n\t\t}\n\n\t\tsystable_endscan(scandesc);\n\n\t\theap_close(relation, AccessShareLock);\n\n\t\t/* Now we can build the CatCList entry. */\n\t\toldcxt = MemoryContextSwitchTo(CacheMemoryContext);\n\t\tnmembers = list_length(ctlist);\n\t\tcl = (CatCList *)\n\t\t\tpalloc(offsetof(CatCList, members) + nmembers * sizeof(CatCTup *));\n\n\t\t/* Extract key values */\n\t\tCatCacheCopyKeys(cache->cc_tupdesc, nkeys, cache->cc_keyno,\n\t\t\t\t\t\t arguments, cl->keys);\n\t\tMemoryContextSwitchTo(oldcxt);\n\n\t\t/*\n\t\t * We are now past the last thing that could trigger an elog before we\n\t\t * have finished building the CatCList and remembering it in the\n\t\t * resource owner.  So it's OK to fall out of the PG_TRY, and indeed\n\t\t * we'd better do so before we start marking the members as belonging\n\t\t * to the list.\n\t\t */\n\n\t}\n\tPG_CATCH();\n\t{\n\t\tforeach(ctlist_item, ctlist)\n\t\t{\n\t\t\tct = (CatCTup *) lfirst(ctlist_item);\n\t\t\tAssert(ct->c_list == NULL);\n\t\t\tAssert(ct->refcount > 0);\n\t\t\tct->refcount--;\n\t\t\tif (\n#ifndef CATCACHE_FORCE_RELEASE\n\t\t\t\tct->dead &&\n#endif\n\t\t\t\tct->refcount == 0 &&\n\t\t\t\t(ct->c_list == NULL || ct->c_list->refcount == 0))\n\t\t\t\tCatCacheRemoveCTup(cache, ct);\n\t\t}\n\n\t\tPG_RE_THROW();\n\t}\n\tPG_END_TRY();\n\n\tcl->cl_magic = CL_MAGIC;\n\tcl->my_cache = cache;\n\tcl->refcount = 0;\t\t\t/* for the moment */\n\tcl->dead = false;\n\tcl->ordered = ordered;\n\tcl->nkeys = nkeys;\n\tcl->hash_value = lHashValue;\n\tcl->n_members = nmembers;\n\n\ti = 0;\n\tforeach(ctlist_item, ctlist)\n\t{\n\t\tcl->members[i++] = ct = (CatCTup *) lfirst(ctlist_item);\n\t\tAssert(ct->c_list == NULL);\n\t\tct->c_list = cl;\n\t\t/* release the temporary refcount on the member */\n\t\tAssert(ct->refcount > 0);\n\t\tct->refcount--;\n\t\t/* mark list dead if any members already dead */\n\t\tif (ct->dead)\n\t\t\tcl->dead = true;\n\t}\n\tAssert(i == nmembers);\n\n\tdlist_push_head(&cache->cc_lists, &cl->cache_elem);\n\n\t/* Finally, bump the list's refcount and return it */\n\tcl->refcount++;\n\tResourceOwnerRememberCatCacheListRef(CurrentResourceOwner, cl);\n\n\tCACHE3_elog(DEBUG2, \"SearchCatCacheList(%s): made list of %d members\",\n\t\t\t\tcache->cc_relname, nmembers);\n\n\treturn cl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId])"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache(int cacheId,\n\t\t\t   Datum key1,\n\t\t\t   Datum key2,\n\t\t\t   Datum key3,\n\t\t\t   Datum key4)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\n\treturn SearchCatCache(SysCache[cacheId], key1, key2, key3, key4);\n}"
  },
  {
    "function_name": "InitCatalogCachePhase2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "1070-1079",
    "snippet": "void\nInitCatalogCachePhase2(void)\n{\n\tint\t\t\tcacheId;\n\n\tAssert(CacheInitialized);\n\n\tfor (cacheId = 0; cacheId < SysCacheSize; cacheId++)\n\t\tInitCatCachePhase2(SysCache[cacheId], true);\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static CatCache *SysCache[SysCacheSize];",
      "static bool CacheInitialized = false;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "InitCatCachePhase2",
          "args": [
            "SysCache[cacheId]",
            "true"
          ],
          "line": 1078
        },
        "resolved": true,
        "details": {
          "function_name": "InitCatCachePhase2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "1049-1082",
          "snippet": "void\nInitCatCachePhase2(CatCache *cache, bool touch_index)\n{\n\tif (cache->cc_tupdesc == NULL)\n\t\tCatalogCacheInitializeCache(cache);\n\n\tif (touch_index &&\n\t\tcache->id != AMOID &&\n\t\tcache->id != AMNAME)\n\t{\n\t\tRelation\tidesc;\n\n\t\t/*\n\t\t * We must lock the underlying catalog before opening the index to\n\t\t * avoid deadlock, since index_open could possibly result in reading\n\t\t * this same catalog, and if anyone else is exclusive-locking this\n\t\t * catalog and index they'll be doing it in that order.\n\t\t */\n\t\tLockRelationOid(cache->cc_reloid, AccessShareLock);\n\t\tidesc = index_open(cache->cc_indexoid, AccessShareLock);\n\n\t\t/*\n\t\t * While we've got the index open, let's check that it's unique (and\n\t\t * not just deferrable-unique, thank you very much).  This is just to\n\t\t * catch thinkos in definitions of new catcaches, so we don't worry\n\t\t * about the pg_am indexes not getting tested.\n\t\t */\n\t\tAssert(idesc->rd_index->indisunique &&\n\t\t\t   idesc->rd_index->indimmediate);\n\n\t\tindex_close(idesc, AccessShareLock);\n\t\tUnlockRelationOid(cache->cc_reloid, AccessShareLock);\n\t}\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void CatalogCacheInitializeCache(CatCache *cache);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\nstatic void CatalogCacheInitializeCache(CatCache *cache);\n\nvoid\nInitCatCachePhase2(CatCache *cache, bool touch_index)\n{\n\tif (cache->cc_tupdesc == NULL)\n\t\tCatalogCacheInitializeCache(cache);\n\n\tif (touch_index &&\n\t\tcache->id != AMOID &&\n\t\tcache->id != AMNAME)\n\t{\n\t\tRelation\tidesc;\n\n\t\t/*\n\t\t * We must lock the underlying catalog before opening the index to\n\t\t * avoid deadlock, since index_open could possibly result in reading\n\t\t * this same catalog, and if anyone else is exclusive-locking this\n\t\t * catalog and index they'll be doing it in that order.\n\t\t */\n\t\tLockRelationOid(cache->cc_reloid, AccessShareLock);\n\t\tidesc = index_open(cache->cc_indexoid, AccessShareLock);\n\n\t\t/*\n\t\t * While we've got the index open, let's check that it's unique (and\n\t\t * not just deferrable-unique, thank you very much).  This is just to\n\t\t * catch thinkos in definitions of new catcaches, so we don't worry\n\t\t * about the pg_am indexes not getting tested.\n\t\t */\n\t\tAssert(idesc->rd_index->indisunique &&\n\t\t\t   idesc->rd_index->indimmediate);\n\n\t\tindex_close(idesc, AccessShareLock);\n\t\tUnlockRelationOid(cache->cc_reloid, AccessShareLock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "CacheInitialized"
          ],
          "line": 1075
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\nstatic bool CacheInitialized = false;\n\nvoid\nInitCatalogCachePhase2(void)\n{\n\tint\t\t\tcacheId;\n\n\tAssert(CacheInitialized);\n\n\tfor (cacheId = 0; cacheId < SysCacheSize; cacheId++)\n\t\tInitCatCachePhase2(SysCache[cacheId], true);\n}"
  },
  {
    "function_name": "InitCatalogCache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
    "lines": "997-1056",
    "snippet": "void\nInitCatalogCache(void)\n{\n\tint\t\t\tcacheId;\n\tint\t\t\ti,\n\t\t\t\tj;\n\n\tStaticAssertStmt(SysCacheSize == (int) lengthof(cacheinfo),\n\t\t\t\t\t \"SysCacheSize does not match syscache.c's array\");\n\n\tAssert(!CacheInitialized);\n\n\tSysCacheRelationOidSize = SysCacheSupportingRelOidSize = 0;\n\n\tfor (cacheId = 0; cacheId < SysCacheSize; cacheId++)\n\t{\n\t\tSysCache[cacheId] = InitCatCache(cacheId,\n\t\t\t\t\t\t\t\t\t\t cacheinfo[cacheId].reloid,\n\t\t\t\t\t\t\t\t\t\t cacheinfo[cacheId].indoid,\n\t\t\t\t\t\t\t\t\t\t cacheinfo[cacheId].nkeys,\n\t\t\t\t\t\t\t\t\t\t cacheinfo[cacheId].key,\n\t\t\t\t\t\t\t\t\t\t cacheinfo[cacheId].nbuckets);\n\t\tif (!PointerIsValid(SysCache[cacheId]))\n\t\t\telog(ERROR, \"could not initialize cache %u (%d)\",\n\t\t\t\t cacheinfo[cacheId].reloid, cacheId);\n\t\t/* Accumulate data for OID lists, too */\n\t\tSysCacheRelationOid[SysCacheRelationOidSize++] =\n\t\t\tcacheinfo[cacheId].reloid;\n\t\tSysCacheSupportingRelOid[SysCacheSupportingRelOidSize++] =\n\t\t\tcacheinfo[cacheId].reloid;\n\t\tSysCacheSupportingRelOid[SysCacheSupportingRelOidSize++] =\n\t\t\tcacheinfo[cacheId].indoid;\n\t\t/* see comments for RelationInvalidatesSnapshotsOnly */\n\t\tAssert(!RelationInvalidatesSnapshotsOnly(cacheinfo[cacheId].reloid));\n\t}\n\n\tAssert(SysCacheRelationOidSize <= lengthof(SysCacheRelationOid));\n\tAssert(SysCacheSupportingRelOidSize <= lengthof(SysCacheSupportingRelOid));\n\n\t/* Sort and de-dup OID arrays, so we can use binary search. */\n\tpg_qsort(SysCacheRelationOid, SysCacheRelationOidSize,\n\t\t\t sizeof(Oid), oid_compare);\n\tfor (i = 1, j = 0; i < SysCacheRelationOidSize; i++)\n\t{\n\t\tif (SysCacheRelationOid[i] != SysCacheRelationOid[j])\n\t\t\tSysCacheRelationOid[++j] = SysCacheRelationOid[i];\n\t}\n\tSysCacheRelationOidSize = j + 1;\n\n\tpg_qsort(SysCacheSupportingRelOid, SysCacheSupportingRelOidSize,\n\t\t\t sizeof(Oid), oid_compare);\n\tfor (i = 1, j = 0; i < SysCacheSupportingRelOidSize; i++)\n\t{\n\t\tif (SysCacheSupportingRelOid[i] != SysCacheSupportingRelOid[j])\n\t\t\tSysCacheSupportingRelOid[++j] = SysCacheSupportingRelOid[i];\n\t}\n\tSysCacheSupportingRelOidSize = j + 1;\n\n\tCacheInitialized = true;\n}",
    "includes": [
      "#include \"utils/syscache.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/rel.h\"",
      "#include \"catalog/pg_user_mapping.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_ts_template.h\"",
      "#include \"catalog/pg_ts_parser.h\"",
      "#include \"catalog/pg_ts_dict.h\"",
      "#include \"catalog/pg_ts_config_map.h\"",
      "#include \"catalog/pg_ts_config.h\"",
      "#include \"catalog/pg_transform.h\"",
      "#include \"catalog/pg_tablespace.h\"",
      "#include \"catalog/pg_subscription_rel.h\"",
      "#include \"catalog/pg_subscription.h\"",
      "#include \"catalog/pg_statistic_ext.h\"",
      "#include \"catalog/pg_statistic.h\"",
      "#include \"catalog/pg_replication_origin.h\"",
      "#include \"catalog/pg_shseclabel.h\"",
      "#include \"catalog/pg_shdescription.h\"",
      "#include \"catalog/pg_shdepend.h\"",
      "#include \"catalog/pg_sequence.h\"",
      "#include \"catalog/pg_seclabel.h\"",
      "#include \"catalog/pg_rewrite.h\"",
      "#include \"catalog/pg_range.h\"",
      "#include \"catalog/pg_publication_rel.h\"",
      "#include \"catalog/pg_publication.h\"",
      "#include \"catalog/pg_proc.h\"",
      "#include \"catalog/pg_partitioned_table.h\"",
      "#include \"catalog/pg_opfamily.h\"",
      "#include \"catalog/pg_operator.h\"",
      "#include \"catalog/pg_opclass.h\"",
      "#include \"catalog/pg_namespace.h\"",
      "#include \"catalog/pg_language.h\"",
      "#include \"catalog/pg_foreign_table.h\"",
      "#include \"catalog/pg_foreign_server.h\"",
      "#include \"catalog/pg_foreign_data_wrapper.h\"",
      "#include \"catalog/pg_event_trigger.h\"",
      "#include \"catalog/pg_enum.h\"",
      "#include \"catalog/pg_description.h\"",
      "#include \"catalog/pg_depend.h\"",
      "#include \"catalog/pg_default_acl.h\"",
      "#include \"catalog/pg_db_role_setting.h\"",
      "#include \"catalog/pg_database.h\"",
      "#include \"catalog/pg_conversion.h\"",
      "#include \"catalog/pg_constraint.h\"",
      "#include \"catalog/pg_collation.h\"",
      "#include \"catalog/pg_cast.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_amproc.h\"",
      "#include \"catalog/pg_amop.h\"",
      "#include \"catalog/pg_am.h\"",
      "#include \"catalog/pg_aggregate.h\"",
      "#include \"catalog/indexing.h\"",
      "#include \"access/sysattr.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct cachedesc cacheinfo[] = {\n\t{AggregateRelationId,\t\t/* AGGFNOID */\n\t\tAggregateFnoidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_aggregate_aggfnoid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t16\n\t},\n\t{AccessMethodRelationId,\t/* AMNAME */\n\t\tAmNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_am_amname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{AccessMethodRelationId,\t/* AMOID */\n\t\tAmOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{AccessMethodOperatorRelationId,\t/* AMOPOPID */\n\t\tAccessMethodOperatorIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_amop_amopopr,\n\t\t\tAnum_pg_amop_amoppurpose,\n\t\t\tAnum_pg_amop_amopfamily,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{AccessMethodOperatorRelationId,\t/* AMOPSTRATEGY */\n\t\tAccessMethodStrategyIndexId,\n\t\t4,\n\t\t{\n\t\t\tAnum_pg_amop_amopfamily,\n\t\t\tAnum_pg_amop_amoplefttype,\n\t\t\tAnum_pg_amop_amoprighttype,\n\t\t\tAnum_pg_amop_amopstrategy\n\t\t},\n\t\t64\n\t},\n\t{AccessMethodProcedureRelationId,\t/* AMPROCNUM */\n\t\tAccessMethodProcedureIndexId,\n\t\t4,\n\t\t{\n\t\t\tAnum_pg_amproc_amprocfamily,\n\t\t\tAnum_pg_amproc_amproclefttype,\n\t\t\tAnum_pg_amproc_amprocrighttype,\n\t\t\tAnum_pg_amproc_amprocnum\n\t\t},\n\t\t16\n\t},\n\t{AttributeRelationId,\t\t/* ATTNAME */\n\t\tAttributeRelidNameIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_attribute_attrelid,\n\t\t\tAnum_pg_attribute_attname,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t32\n\t},\n\t{AttributeRelationId,\t\t/* ATTNUM */\n\t\tAttributeRelidNumIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_attribute_attrelid,\n\t\t\tAnum_pg_attribute_attnum,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{AuthMemRelationId,\t\t\t/* AUTHMEMMEMROLE */\n\t\tAuthMemMemRoleIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_auth_members_member,\n\t\t\tAnum_pg_auth_members_roleid,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{AuthMemRelationId,\t\t\t/* AUTHMEMROLEMEM */\n\t\tAuthMemRoleMemIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_auth_members_roleid,\n\t\t\tAnum_pg_auth_members_member,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{AuthIdRelationId,\t\t\t/* AUTHNAME */\n\t\tAuthIdRolnameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_authid_rolname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{AuthIdRelationId,\t\t\t/* AUTHOID */\n\t\tAuthIdOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{\n\t\tCastRelationId,\t\t\t/* CASTSOURCETARGET */\n\t\tCastSourceTargetIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_cast_castsource,\n\t\t\tAnum_pg_cast_casttarget,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t256\n\t},\n\t{OperatorClassRelationId,\t/* CLAAMNAMENSP */\n\t\tOpclassAmNameNspIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_opclass_opcmethod,\n\t\t\tAnum_pg_opclass_opcname,\n\t\t\tAnum_pg_opclass_opcnamespace,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{OperatorClassRelationId,\t/* CLAOID */\n\t\tOpclassOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{CollationRelationId,\t\t/* COLLNAMEENCNSP */\n\t\tCollationNameEncNspIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_collation_collname,\n\t\t\tAnum_pg_collation_collencoding,\n\t\t\tAnum_pg_collation_collnamespace,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{CollationRelationId,\t\t/* COLLOID */\n\t\tCollationOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{ConversionRelationId,\t\t/* CONDEFAULT */\n\t\tConversionDefaultIndexId,\n\t\t4,\n\t\t{\n\t\t\tAnum_pg_conversion_connamespace,\n\t\t\tAnum_pg_conversion_conforencoding,\n\t\t\tAnum_pg_conversion_contoencoding,\n\t\t\tObjectIdAttributeNumber,\n\t\t},\n\t\t8\n\t},\n\t{ConversionRelationId,\t\t/* CONNAMENSP */\n\t\tConversionNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_conversion_conname,\n\t\t\tAnum_pg_conversion_connamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{ConstraintRelationId,\t\t/* CONSTROID */\n\t\tConstraintOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t16\n\t},\n\t{ConversionRelationId,\t\t/* CONVOID */\n\t\tConversionOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{DatabaseRelationId,\t\t/* DATABASEOID */\n\t\tDatabaseOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{DefaultAclRelationId,\t\t/* DEFACLROLENSPOBJ */\n\t\tDefaultAclRoleNspObjIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_default_acl_defaclrole,\n\t\t\tAnum_pg_default_acl_defaclnamespace,\n\t\t\tAnum_pg_default_acl_defaclobjtype,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{EnumRelationId,\t\t\t/* ENUMOID */\n\t\tEnumOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{EnumRelationId,\t\t\t/* ENUMTYPOIDNAME */\n\t\tEnumTypIdLabelIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_enum_enumtypid,\n\t\t\tAnum_pg_enum_enumlabel,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{EventTriggerRelationId,\t/* EVENTTRIGGERNAME */\n\t\tEventTriggerNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_event_trigger_evtname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{EventTriggerRelationId,\t/* EVENTTRIGGEROID */\n\t\tEventTriggerOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{ForeignDataWrapperRelationId,\t/* FOREIGNDATAWRAPPERNAME */\n\t\tForeignDataWrapperNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_foreign_data_wrapper_fdwname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{ForeignDataWrapperRelationId,\t/* FOREIGNDATAWRAPPEROID */\n\t\tForeignDataWrapperOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{ForeignServerRelationId,\t/* FOREIGNSERVERNAME */\n\t\tForeignServerNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_foreign_server_srvname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{ForeignServerRelationId,\t/* FOREIGNSERVEROID */\n\t\tForeignServerOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{ForeignTableRelationId,\t/* FOREIGNTABLEREL */\n\t\tForeignTableRelidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_foreign_table_ftrelid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{IndexRelationId,\t\t\t/* INDEXRELID */\n\t\tIndexRelidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_index_indexrelid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{LanguageRelationId,\t\t/* LANGNAME */\n\t\tLanguageNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_language_lanname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{LanguageRelationId,\t\t/* LANGOID */\n\t\tLanguageOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{NamespaceRelationId,\t\t/* NAMESPACENAME */\n\t\tNamespaceNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_namespace_nspname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{NamespaceRelationId,\t\t/* NAMESPACEOID */\n\t\tNamespaceOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t16\n\t},\n\t{OperatorRelationId,\t\t/* OPERNAMENSP */\n\t\tOperatorNameNspIndexId,\n\t\t4,\n\t\t{\n\t\t\tAnum_pg_operator_oprname,\n\t\t\tAnum_pg_operator_oprleft,\n\t\t\tAnum_pg_operator_oprright,\n\t\t\tAnum_pg_operator_oprnamespace\n\t\t},\n\t\t256\n\t},\n\t{OperatorRelationId,\t\t/* OPEROID */\n\t\tOperatorOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t32\n\t},\n\t{OperatorFamilyRelationId,\t/* OPFAMILYAMNAMENSP */\n\t\tOpfamilyAmNameNspIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_opfamily_opfmethod,\n\t\t\tAnum_pg_opfamily_opfname,\n\t\t\tAnum_pg_opfamily_opfnamespace,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{OperatorFamilyRelationId,\t/* OPFAMILYOID */\n\t\tOpfamilyOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{PartitionedRelationId,\t\t/* PARTRELID */\n\t\tPartitionedRelidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_partitioned_table_partrelid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t32\n\t},\n\t{ProcedureRelationId,\t\t/* PROCNAMEARGSNSP */\n\t\tProcedureNameArgsNspIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_proc_proname,\n\t\t\tAnum_pg_proc_proargtypes,\n\t\t\tAnum_pg_proc_pronamespace,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{ProcedureRelationId,\t\t/* PROCOID */\n\t\tProcedureOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{PublicationRelationId,\t\t/* PUBLICATIONNAME */\n\t\tPublicationNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_publication_pubname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{PublicationRelationId,\t\t/* PUBLICATIONOID */\n\t\tPublicationObjectIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{PublicationRelRelationId,\t/* PUBLICATIONREL */\n\t\tPublicationRelObjectIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{PublicationRelRelationId,\t/* PUBLICATIONRELMAP */\n\t\tPublicationRelPrrelidPrpubidIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_publication_rel_prrelid,\n\t\t\tAnum_pg_publication_rel_prpubid,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{RangeRelationId,\t\t\t/* RANGETYPE */\n\t\tRangeTypidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_range_rngtypid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{RelationRelationId,\t\t/* RELNAMENSP */\n\t\tClassNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_class_relname,\n\t\t\tAnum_pg_class_relnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{RelationRelationId,\t\t/* RELOID */\n\t\tClassOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{ReplicationOriginRelationId,\t/* REPLORIGIDENT */\n\t\tReplicationOriginIdentIndex,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_replication_origin_roident,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t16\n\t},\n\t{ReplicationOriginRelationId,\t/* REPLORIGNAME */\n\t\tReplicationOriginNameIndex,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_replication_origin_roname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t16\n\t},\n\t{RewriteRelationId,\t\t\t/* RULERELNAME */\n\t\tRewriteRelRulenameIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_rewrite_ev_class,\n\t\t\tAnum_pg_rewrite_rulename,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{SequenceRelationId,\t\t/* SEQRELID */\n\t\tSequenceRelidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_sequence_seqrelid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t32\n\t},\n\t{StatisticExtRelationId,\t/* STATEXTNAMENSP */\n\t\tStatisticExtNameIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_statistic_ext_stxname,\n\t\t\tAnum_pg_statistic_ext_stxnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{StatisticExtRelationId,\t/* STATEXTOID */\n\t\tStatisticExtOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{StatisticRelationId,\t\t/* STATRELATTINH */\n\t\tStatisticRelidAttnumInhIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_statistic_starelid,\n\t\t\tAnum_pg_statistic_staattnum,\n\t\t\tAnum_pg_statistic_stainherit,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{SubscriptionRelationId,\t/* SUBSCRIPTIONNAME */\n\t\tSubscriptionNameIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_subscription_subdbid,\n\t\t\tAnum_pg_subscription_subname,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{SubscriptionRelationId,\t/* SUBSCRIPTIONOID */\n\t\tSubscriptionObjectIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{SubscriptionRelRelationId, /* SUBSCRIPTIONRELMAP */\n\t\tSubscriptionRelSrrelidSrsubidIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_subscription_rel_srrelid,\n\t\t\tAnum_pg_subscription_rel_srsubid,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{TableSpaceRelationId,\t\t/* TABLESPACEOID */\n\t\tTablespaceOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0,\n\t\t},\n\t\t4\n\t},\n\t{TransformRelationId,\t\t/* TRFOID */\n\t\tTransformOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0,\n\t\t},\n\t\t16\n\t},\n\t{TransformRelationId,\t\t/* TRFTYPELANG */\n\t\tTransformTypeLangIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_transform_trftype,\n\t\t\tAnum_pg_transform_trflang,\n\t\t\t0,\n\t\t\t0,\n\t\t},\n\t\t16\n\t},\n\t{TSConfigMapRelationId,\t\t/* TSCONFIGMAP */\n\t\tTSConfigMapIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_ts_config_map_mapcfg,\n\t\t\tAnum_pg_ts_config_map_maptokentype,\n\t\t\tAnum_pg_ts_config_map_mapseqno,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSConfigRelationId,\t\t/* TSCONFIGNAMENSP */\n\t\tTSConfigNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_ts_config_cfgname,\n\t\t\tAnum_pg_ts_config_cfgnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSConfigRelationId,\t\t/* TSCONFIGOID */\n\t\tTSConfigOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSDictionaryRelationId,\t/* TSDICTNAMENSP */\n\t\tTSDictionaryNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_ts_dict_dictname,\n\t\t\tAnum_pg_ts_dict_dictnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSDictionaryRelationId,\t/* TSDICTOID */\n\t\tTSDictionaryOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSParserRelationId,\t\t/* TSPARSERNAMENSP */\n\t\tTSParserNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_ts_parser_prsname,\n\t\t\tAnum_pg_ts_parser_prsnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSParserRelationId,\t\t/* TSPARSEROID */\n\t\tTSParserOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSTemplateRelationId,\t\t/* TSTEMPLATENAMENSP */\n\t\tTSTemplateNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_ts_template_tmplname,\n\t\t\tAnum_pg_ts_template_tmplnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSTemplateRelationId,\t\t/* TSTEMPLATEOID */\n\t\tTSTemplateOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TypeRelationId,\t\t\t/* TYPENAMENSP */\n\t\tTypeNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_type_typname,\n\t\t\tAnum_pg_type_typnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{TypeRelationId,\t\t\t/* TYPEOID */\n\t\tTypeOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{UserMappingRelationId,\t\t/* USERMAPPINGOID */\n\t\tUserMappingOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{UserMappingRelationId,\t\t/* USERMAPPINGUSERSERVER */\n\t\tUserMappingUserServerIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_user_mapping_umuser,\n\t\t\tAnum_pg_user_mapping_umserver,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t}\n};",
      "static CatCache *SysCache[SysCacheSize];",
      "static bool CacheInitialized = false;",
      "static Oid\tSysCacheRelationOid[SysCacheSize];",
      "static int\tSysCacheRelationOidSize;",
      "static Oid\tSysCacheSupportingRelOid[SysCacheSize * 2];",
      "static int\tSysCacheSupportingRelOidSize;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_qsort",
          "args": [
            "SysCacheSupportingRelOid",
            "SysCacheSupportingRelOidSize",
            "sizeof(Oid)",
            "oid_compare"
          ],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_qsort",
          "args": [
            "SysCacheRelationOid",
            "SysCacheRelationOidSize",
            "sizeof(Oid)",
            "oid_compare"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "SysCacheSupportingRelOidSize <= lengthof(SysCacheSupportingRelOid)"
          ],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lengthof",
          "args": [
            "SysCacheSupportingRelOid"
          ],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "SysCacheRelationOidSize <= lengthof(SysCacheRelationOid)"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lengthof",
          "args": [
            "SysCacheRelationOid"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "!RelationInvalidatesSnapshotsOnly(cacheinfo[cacheId].reloid)"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RelationInvalidatesSnapshotsOnly",
          "args": [
            "cacheinfo[cacheId].reloid"
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "RelationInvalidatesSnapshotsOnly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1463-1481",
          "snippet": "bool\nRelationInvalidatesSnapshotsOnly(Oid relid)\n{\n\tswitch (relid)\n\t{\n\t\tcase DbRoleSettingRelationId:\n\t\tcase DependRelationId:\n\t\tcase SharedDependRelationId:\n\t\tcase DescriptionRelationId:\n\t\tcase SharedDescriptionRelationId:\n\t\tcase SecLabelRelationId:\n\t\tcase SharedSecLabelRelationId:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn false;\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nbool\nRelationInvalidatesSnapshotsOnly(Oid relid)\n{\n\tswitch (relid)\n\t{\n\t\tcase DbRoleSettingRelationId:\n\t\tcase DependRelationId:\n\t\tcase SharedDependRelationId:\n\t\tcase DescriptionRelationId:\n\t\tcase SharedDescriptionRelationId:\n\t\tcase SecLabelRelationId:\n\t\tcase SharedSecLabelRelationId:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"could not initialize cache %u (%d)\"",
            "cacheinfo[cacheId].reloid",
            "cacheId"
          ],
          "line": 1020
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PointerIsValid",
          "args": [
            "SysCache[cacheId]"
          ],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InitCatCache",
          "args": [
            "cacheId",
            "cacheinfo[cacheId].reloid",
            "cacheinfo[cacheId].indoid",
            "cacheinfo[cacheId].nkeys",
            "cacheinfo[cacheId].key",
            "cacheinfo[cacheId].nbuckets"
          ],
          "line": 1013
        },
        "resolved": true,
        "details": {
          "function_name": "InitCatCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/catcache.c",
          "lines": "778-870",
          "snippet": "CatCache *\nInitCatCache(int id,\n\t\t\t Oid reloid,\n\t\t\t Oid indexoid,\n\t\t\t int nkeys,\n\t\t\t const int *key,\n\t\t\t int nbuckets)\n{\n\tCatCache   *cp;\n\tMemoryContext oldcxt;\n\tsize_t\t\tsz;\n\tint\t\t\ti;\n\n\t/*\n\t * nbuckets is the initial number of hash buckets to use in this catcache.\n\t * It will be enlarged later if it becomes too full.\n\t *\n\t * nbuckets must be a power of two.  We check this via Assert rather than\n\t * a full runtime check because the values will be coming from constant\n\t * tables.\n\t *\n\t * If you're confused by the power-of-two check, see comments in\n\t * bitmapset.c for an explanation.\n\t */\n\tAssert(nbuckets > 0 && (nbuckets & -nbuckets) == nbuckets);\n\n\t/*\n\t * first switch to the cache context so our allocations do not vanish at\n\t * the end of a transaction\n\t */\n\tif (!CacheMemoryContext)\n\t\tCreateCacheMemoryContext();\n\n\toldcxt = MemoryContextSwitchTo(CacheMemoryContext);\n\n\t/*\n\t * if first time through, initialize the cache group header\n\t */\n\tif (CacheHdr == NULL)\n\t{\n\t\tCacheHdr = (CatCacheHeader *) palloc(sizeof(CatCacheHeader));\n\t\tslist_init(&CacheHdr->ch_caches);\n\t\tCacheHdr->ch_ntup = 0;\n#ifdef CATCACHE_STATS\n\t\t/* set up to dump stats at backend exit */\n\t\ton_proc_exit(CatCachePrintStats, 0);\n#endif\n\t}\n\n\t/*\n\t * Allocate a new cache structure, aligning to a cacheline boundary\n\t *\n\t * Note: we rely on zeroing to initialize all the dlist headers correctly\n\t */\n\tsz = sizeof(CatCache) + PG_CACHE_LINE_SIZE;\n\tcp = (CatCache *) CACHELINEALIGN(palloc0(sz));\n\tcp->cc_bucket = palloc0(nbuckets * sizeof(dlist_head));\n\n\t/*\n\t * initialize the cache's relation information for the relation\n\t * corresponding to this cache, and initialize some of the new cache's\n\t * other internal fields.  But don't open the relation yet.\n\t */\n\tcp->id = id;\n\tcp->cc_relname = \"(not known yet)\";\n\tcp->cc_reloid = reloid;\n\tcp->cc_indexoid = indexoid;\n\tcp->cc_relisshared = false; /* temporary */\n\tcp->cc_tupdesc = (TupleDesc) NULL;\n\tcp->cc_ntup = 0;\n\tcp->cc_nbuckets = nbuckets;\n\tcp->cc_nkeys = nkeys;\n\tfor (i = 0; i < nkeys; ++i)\n\t\tcp->cc_keyno[i] = key[i];\n\n\t/*\n\t * new cache is initialized as far as we can go for now. print some\n\t * debugging information, if appropriate.\n\t */\n\tInitCatCache_DEBUG2;\n\n\t/*\n\t * add completed cache to top of group header's list\n\t */\n\tslist_push_head(&CacheHdr->ch_caches, &cp->cc_next);\n\n\t/*\n\t * back to the old context before we return...\n\t */\n\tMemoryContextSwitchTo(oldcxt);\n\n\treturn cp;\n}",
          "includes": [
            "#include \"utils/tqual.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/resowner_private.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/hashutils.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/lmgr.h\"",
            "#include \"storage/ipc.h\"\t\t/* for on_proc_exit */",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/valid.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/relscan.h\"",
            "#include \"access/heapam.h\"",
            "#include \"access/hash.h\"",
            "#include \"access/genam.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define InitCatCache_DEBUG2",
            "#define InitCatCache_DEBUG2 \\\ndo { \\\n\telog(DEBUG2, \"InitCatCache: rel=%u ind=%u id=%d nkeys=%d size=%d\", \\\n\t\t cp->cc_reloid, cp->cc_indexoid, cp->id, \\\n\t\t cp->cc_nkeys, cp->cc_nbuckets); \\\n} while(0)"
          ],
          "globals_used": [
            "static CatCacheHeader *CacheHdr = NULL;",
            "static void CatalogCacheInitializeCache(CatCache *cache);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/tqual.h\"\n#include \"utils/syscache.h\"\n#include \"utils/resowner_private.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/inval.h\"\n#include \"utils/hashutils.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"storage/lmgr.h\"\n#include \"storage/ipc.h\"\t\t/* for on_proc_exit */\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_operator.h\"\n#include \"access/xact.h\"\n#include \"access/valid.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/sysattr.h\"\n#include \"access/relscan.h\"\n#include \"access/heapam.h\"\n#include \"access/hash.h\"\n#include \"access/genam.h\"\n#include \"postgres.h\"\n\n#define InitCatCache_DEBUG2\n#define InitCatCache_DEBUG2 \\\ndo { \\\n\telog(DEBUG2, \"InitCatCache: rel=%u ind=%u id=%d nkeys=%d size=%d\", \\\n\t\t cp->cc_reloid, cp->cc_indexoid, cp->id, \\\n\t\t cp->cc_nkeys, cp->cc_nbuckets); \\\n} while(0)\n\nstatic CatCacheHeader *CacheHdr = NULL;\nstatic void CatalogCacheInitializeCache(CatCache *cache);\n\nCatCache *\nInitCatCache(int id,\n\t\t\t Oid reloid,\n\t\t\t Oid indexoid,\n\t\t\t int nkeys,\n\t\t\t const int *key,\n\t\t\t int nbuckets)\n{\n\tCatCache   *cp;\n\tMemoryContext oldcxt;\n\tsize_t\t\tsz;\n\tint\t\t\ti;\n\n\t/*\n\t * nbuckets is the initial number of hash buckets to use in this catcache.\n\t * It will be enlarged later if it becomes too full.\n\t *\n\t * nbuckets must be a power of two.  We check this via Assert rather than\n\t * a full runtime check because the values will be coming from constant\n\t * tables.\n\t *\n\t * If you're confused by the power-of-two check, see comments in\n\t * bitmapset.c for an explanation.\n\t */\n\tAssert(nbuckets > 0 && (nbuckets & -nbuckets) == nbuckets);\n\n\t/*\n\t * first switch to the cache context so our allocations do not vanish at\n\t * the end of a transaction\n\t */\n\tif (!CacheMemoryContext)\n\t\tCreateCacheMemoryContext();\n\n\toldcxt = MemoryContextSwitchTo(CacheMemoryContext);\n\n\t/*\n\t * if first time through, initialize the cache group header\n\t */\n\tif (CacheHdr == NULL)\n\t{\n\t\tCacheHdr = (CatCacheHeader *) palloc(sizeof(CatCacheHeader));\n\t\tslist_init(&CacheHdr->ch_caches);\n\t\tCacheHdr->ch_ntup = 0;\n#ifdef CATCACHE_STATS\n\t\t/* set up to dump stats at backend exit */\n\t\ton_proc_exit(CatCachePrintStats, 0);\n#endif\n\t}\n\n\t/*\n\t * Allocate a new cache structure, aligning to a cacheline boundary\n\t *\n\t * Note: we rely on zeroing to initialize all the dlist headers correctly\n\t */\n\tsz = sizeof(CatCache) + PG_CACHE_LINE_SIZE;\n\tcp = (CatCache *) CACHELINEALIGN(palloc0(sz));\n\tcp->cc_bucket = palloc0(nbuckets * sizeof(dlist_head));\n\n\t/*\n\t * initialize the cache's relation information for the relation\n\t * corresponding to this cache, and initialize some of the new cache's\n\t * other internal fields.  But don't open the relation yet.\n\t */\n\tcp->id = id;\n\tcp->cc_relname = \"(not known yet)\";\n\tcp->cc_reloid = reloid;\n\tcp->cc_indexoid = indexoid;\n\tcp->cc_relisshared = false; /* temporary */\n\tcp->cc_tupdesc = (TupleDesc) NULL;\n\tcp->cc_ntup = 0;\n\tcp->cc_nbuckets = nbuckets;\n\tcp->cc_nkeys = nkeys;\n\tfor (i = 0; i < nkeys; ++i)\n\t\tcp->cc_keyno[i] = key[i];\n\n\t/*\n\t * new cache is initialized as far as we can go for now. print some\n\t * debugging information, if appropriate.\n\t */\n\tInitCatCache_DEBUG2;\n\n\t/*\n\t * add completed cache to top of group header's list\n\t */\n\tslist_push_head(&CacheHdr->ch_caches, &cp->cc_next);\n\n\t/*\n\t * back to the old context before we return...\n\t */\n\tMemoryContextSwitchTo(oldcxt);\n\n\treturn cp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "!CacheInitialized"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StaticAssertStmt",
          "args": [
            "SysCacheSize == (int) lengthof(cacheinfo)",
            "\"SysCacheSize does not match syscache.c's array\""
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lengthof",
          "args": [
            "cacheinfo"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic const struct cachedesc cacheinfo[] = {\n\t{AggregateRelationId,\t\t/* AGGFNOID */\n\t\tAggregateFnoidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_aggregate_aggfnoid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t16\n\t},\n\t{AccessMethodRelationId,\t/* AMNAME */\n\t\tAmNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_am_amname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{AccessMethodRelationId,\t/* AMOID */\n\t\tAmOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{AccessMethodOperatorRelationId,\t/* AMOPOPID */\n\t\tAccessMethodOperatorIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_amop_amopopr,\n\t\t\tAnum_pg_amop_amoppurpose,\n\t\t\tAnum_pg_amop_amopfamily,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{AccessMethodOperatorRelationId,\t/* AMOPSTRATEGY */\n\t\tAccessMethodStrategyIndexId,\n\t\t4,\n\t\t{\n\t\t\tAnum_pg_amop_amopfamily,\n\t\t\tAnum_pg_amop_amoplefttype,\n\t\t\tAnum_pg_amop_amoprighttype,\n\t\t\tAnum_pg_amop_amopstrategy\n\t\t},\n\t\t64\n\t},\n\t{AccessMethodProcedureRelationId,\t/* AMPROCNUM */\n\t\tAccessMethodProcedureIndexId,\n\t\t4,\n\t\t{\n\t\t\tAnum_pg_amproc_amprocfamily,\n\t\t\tAnum_pg_amproc_amproclefttype,\n\t\t\tAnum_pg_amproc_amprocrighttype,\n\t\t\tAnum_pg_amproc_amprocnum\n\t\t},\n\t\t16\n\t},\n\t{AttributeRelationId,\t\t/* ATTNAME */\n\t\tAttributeRelidNameIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_attribute_attrelid,\n\t\t\tAnum_pg_attribute_attname,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t32\n\t},\n\t{AttributeRelationId,\t\t/* ATTNUM */\n\t\tAttributeRelidNumIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_attribute_attrelid,\n\t\t\tAnum_pg_attribute_attnum,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{AuthMemRelationId,\t\t\t/* AUTHMEMMEMROLE */\n\t\tAuthMemMemRoleIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_auth_members_member,\n\t\t\tAnum_pg_auth_members_roleid,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{AuthMemRelationId,\t\t\t/* AUTHMEMROLEMEM */\n\t\tAuthMemRoleMemIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_auth_members_roleid,\n\t\t\tAnum_pg_auth_members_member,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{AuthIdRelationId,\t\t\t/* AUTHNAME */\n\t\tAuthIdRolnameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_authid_rolname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{AuthIdRelationId,\t\t\t/* AUTHOID */\n\t\tAuthIdOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{\n\t\tCastRelationId,\t\t\t/* CASTSOURCETARGET */\n\t\tCastSourceTargetIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_cast_castsource,\n\t\t\tAnum_pg_cast_casttarget,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t256\n\t},\n\t{OperatorClassRelationId,\t/* CLAAMNAMENSP */\n\t\tOpclassAmNameNspIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_opclass_opcmethod,\n\t\t\tAnum_pg_opclass_opcname,\n\t\t\tAnum_pg_opclass_opcnamespace,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{OperatorClassRelationId,\t/* CLAOID */\n\t\tOpclassOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{CollationRelationId,\t\t/* COLLNAMEENCNSP */\n\t\tCollationNameEncNspIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_collation_collname,\n\t\t\tAnum_pg_collation_collencoding,\n\t\t\tAnum_pg_collation_collnamespace,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{CollationRelationId,\t\t/* COLLOID */\n\t\tCollationOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{ConversionRelationId,\t\t/* CONDEFAULT */\n\t\tConversionDefaultIndexId,\n\t\t4,\n\t\t{\n\t\t\tAnum_pg_conversion_connamespace,\n\t\t\tAnum_pg_conversion_conforencoding,\n\t\t\tAnum_pg_conversion_contoencoding,\n\t\t\tObjectIdAttributeNumber,\n\t\t},\n\t\t8\n\t},\n\t{ConversionRelationId,\t\t/* CONNAMENSP */\n\t\tConversionNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_conversion_conname,\n\t\t\tAnum_pg_conversion_connamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{ConstraintRelationId,\t\t/* CONSTROID */\n\t\tConstraintOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t16\n\t},\n\t{ConversionRelationId,\t\t/* CONVOID */\n\t\tConversionOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{DatabaseRelationId,\t\t/* DATABASEOID */\n\t\tDatabaseOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{DefaultAclRelationId,\t\t/* DEFACLROLENSPOBJ */\n\t\tDefaultAclRoleNspObjIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_default_acl_defaclrole,\n\t\t\tAnum_pg_default_acl_defaclnamespace,\n\t\t\tAnum_pg_default_acl_defaclobjtype,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{EnumRelationId,\t\t\t/* ENUMOID */\n\t\tEnumOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{EnumRelationId,\t\t\t/* ENUMTYPOIDNAME */\n\t\tEnumTypIdLabelIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_enum_enumtypid,\n\t\t\tAnum_pg_enum_enumlabel,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{EventTriggerRelationId,\t/* EVENTTRIGGERNAME */\n\t\tEventTriggerNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_event_trigger_evtname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{EventTriggerRelationId,\t/* EVENTTRIGGEROID */\n\t\tEventTriggerOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{ForeignDataWrapperRelationId,\t/* FOREIGNDATAWRAPPERNAME */\n\t\tForeignDataWrapperNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_foreign_data_wrapper_fdwname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{ForeignDataWrapperRelationId,\t/* FOREIGNDATAWRAPPEROID */\n\t\tForeignDataWrapperOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{ForeignServerRelationId,\t/* FOREIGNSERVERNAME */\n\t\tForeignServerNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_foreign_server_srvname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{ForeignServerRelationId,\t/* FOREIGNSERVEROID */\n\t\tForeignServerOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{ForeignTableRelationId,\t/* FOREIGNTABLEREL */\n\t\tForeignTableRelidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_foreign_table_ftrelid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{IndexRelationId,\t\t\t/* INDEXRELID */\n\t\tIndexRelidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_index_indexrelid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{LanguageRelationId,\t\t/* LANGNAME */\n\t\tLanguageNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_language_lanname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{LanguageRelationId,\t\t/* LANGOID */\n\t\tLanguageOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{NamespaceRelationId,\t\t/* NAMESPACENAME */\n\t\tNamespaceNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_namespace_nspname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{NamespaceRelationId,\t\t/* NAMESPACEOID */\n\t\tNamespaceOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t16\n\t},\n\t{OperatorRelationId,\t\t/* OPERNAMENSP */\n\t\tOperatorNameNspIndexId,\n\t\t4,\n\t\t{\n\t\t\tAnum_pg_operator_oprname,\n\t\t\tAnum_pg_operator_oprleft,\n\t\t\tAnum_pg_operator_oprright,\n\t\t\tAnum_pg_operator_oprnamespace\n\t\t},\n\t\t256\n\t},\n\t{OperatorRelationId,\t\t/* OPEROID */\n\t\tOperatorOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t32\n\t},\n\t{OperatorFamilyRelationId,\t/* OPFAMILYAMNAMENSP */\n\t\tOpfamilyAmNameNspIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_opfamily_opfmethod,\n\t\t\tAnum_pg_opfamily_opfname,\n\t\t\tAnum_pg_opfamily_opfnamespace,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{OperatorFamilyRelationId,\t/* OPFAMILYOID */\n\t\tOpfamilyOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{PartitionedRelationId,\t\t/* PARTRELID */\n\t\tPartitionedRelidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_partitioned_table_partrelid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t32\n\t},\n\t{ProcedureRelationId,\t\t/* PROCNAMEARGSNSP */\n\t\tProcedureNameArgsNspIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_proc_proname,\n\t\t\tAnum_pg_proc_proargtypes,\n\t\t\tAnum_pg_proc_pronamespace,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{ProcedureRelationId,\t\t/* PROCOID */\n\t\tProcedureOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{PublicationRelationId,\t\t/* PUBLICATIONNAME */\n\t\tPublicationNameIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_publication_pubname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{PublicationRelationId,\t\t/* PUBLICATIONOID */\n\t\tPublicationObjectIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{PublicationRelRelationId,\t/* PUBLICATIONREL */\n\t\tPublicationRelObjectIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{PublicationRelRelationId,\t/* PUBLICATIONRELMAP */\n\t\tPublicationRelPrrelidPrpubidIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_publication_rel_prrelid,\n\t\t\tAnum_pg_publication_rel_prpubid,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{RangeRelationId,\t\t\t/* RANGETYPE */\n\t\tRangeTypidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_range_rngtypid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{RelationRelationId,\t\t/* RELNAMENSP */\n\t\tClassNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_class_relname,\n\t\t\tAnum_pg_class_relnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{RelationRelationId,\t\t/* RELOID */\n\t\tClassOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{ReplicationOriginRelationId,\t/* REPLORIGIDENT */\n\t\tReplicationOriginIdentIndex,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_replication_origin_roident,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t16\n\t},\n\t{ReplicationOriginRelationId,\t/* REPLORIGNAME */\n\t\tReplicationOriginNameIndex,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_replication_origin_roname,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t16\n\t},\n\t{RewriteRelationId,\t\t\t/* RULERELNAME */\n\t\tRewriteRelRulenameIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_rewrite_ev_class,\n\t\t\tAnum_pg_rewrite_rulename,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t8\n\t},\n\t{SequenceRelationId,\t\t/* SEQRELID */\n\t\tSequenceRelidIndexId,\n\t\t1,\n\t\t{\n\t\t\tAnum_pg_sequence_seqrelid,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t32\n\t},\n\t{StatisticExtRelationId,\t/* STATEXTNAMENSP */\n\t\tStatisticExtNameIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_statistic_ext_stxname,\n\t\t\tAnum_pg_statistic_ext_stxnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{StatisticExtRelationId,\t/* STATEXTOID */\n\t\tStatisticExtOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{StatisticRelationId,\t\t/* STATRELATTINH */\n\t\tStatisticRelidAttnumInhIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_statistic_starelid,\n\t\t\tAnum_pg_statistic_staattnum,\n\t\t\tAnum_pg_statistic_stainherit,\n\t\t\t0\n\t\t},\n\t\t128\n\t},\n\t{SubscriptionRelationId,\t/* SUBSCRIPTIONNAME */\n\t\tSubscriptionNameIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_subscription_subdbid,\n\t\t\tAnum_pg_subscription_subname,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{SubscriptionRelationId,\t/* SUBSCRIPTIONOID */\n\t\tSubscriptionObjectIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t4\n\t},\n\t{SubscriptionRelRelationId, /* SUBSCRIPTIONRELMAP */\n\t\tSubscriptionRelSrrelidSrsubidIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_subscription_rel_srrelid,\n\t\t\tAnum_pg_subscription_rel_srsubid,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{TableSpaceRelationId,\t\t/* TABLESPACEOID */\n\t\tTablespaceOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0,\n\t\t},\n\t\t4\n\t},\n\t{TransformRelationId,\t\t/* TRFOID */\n\t\tTransformOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0,\n\t\t},\n\t\t16\n\t},\n\t{TransformRelationId,\t\t/* TRFTYPELANG */\n\t\tTransformTypeLangIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_transform_trftype,\n\t\t\tAnum_pg_transform_trflang,\n\t\t\t0,\n\t\t\t0,\n\t\t},\n\t\t16\n\t},\n\t{TSConfigMapRelationId,\t\t/* TSCONFIGMAP */\n\t\tTSConfigMapIndexId,\n\t\t3,\n\t\t{\n\t\t\tAnum_pg_ts_config_map_mapcfg,\n\t\t\tAnum_pg_ts_config_map_maptokentype,\n\t\t\tAnum_pg_ts_config_map_mapseqno,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSConfigRelationId,\t\t/* TSCONFIGNAMENSP */\n\t\tTSConfigNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_ts_config_cfgname,\n\t\t\tAnum_pg_ts_config_cfgnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSConfigRelationId,\t\t/* TSCONFIGOID */\n\t\tTSConfigOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSDictionaryRelationId,\t/* TSDICTNAMENSP */\n\t\tTSDictionaryNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_ts_dict_dictname,\n\t\t\tAnum_pg_ts_dict_dictnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSDictionaryRelationId,\t/* TSDICTOID */\n\t\tTSDictionaryOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSParserRelationId,\t\t/* TSPARSERNAMENSP */\n\t\tTSParserNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_ts_parser_prsname,\n\t\t\tAnum_pg_ts_parser_prsnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSParserRelationId,\t\t/* TSPARSEROID */\n\t\tTSParserOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSTemplateRelationId,\t\t/* TSTEMPLATENAMENSP */\n\t\tTSTemplateNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_ts_template_tmplname,\n\t\t\tAnum_pg_ts_template_tmplnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TSTemplateRelationId,\t\t/* TSTEMPLATEOID */\n\t\tTSTemplateOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{TypeRelationId,\t\t\t/* TYPENAMENSP */\n\t\tTypeNameNspIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_type_typname,\n\t\t\tAnum_pg_type_typnamespace,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{TypeRelationId,\t\t\t/* TYPEOID */\n\t\tTypeOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t64\n\t},\n\t{UserMappingRelationId,\t\t/* USERMAPPINGOID */\n\t\tUserMappingOidIndexId,\n\t\t1,\n\t\t{\n\t\t\tObjectIdAttributeNumber,\n\t\t\t0,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t},\n\t{UserMappingRelationId,\t\t/* USERMAPPINGUSERSERVER */\n\t\tUserMappingUserServerIndexId,\n\t\t2,\n\t\t{\n\t\t\tAnum_pg_user_mapping_umuser,\n\t\t\tAnum_pg_user_mapping_umserver,\n\t\t\t0,\n\t\t\t0\n\t\t},\n\t\t2\n\t}\n};\nstatic CatCache *SysCache[SysCacheSize];\nstatic bool CacheInitialized = false;\nstatic Oid\tSysCacheRelationOid[SysCacheSize];\nstatic int\tSysCacheRelationOidSize;\nstatic Oid\tSysCacheSupportingRelOid[SysCacheSize * 2];\nstatic int\tSysCacheSupportingRelOidSize;\n\nvoid\nInitCatalogCache(void)\n{\n\tint\t\t\tcacheId;\n\tint\t\t\ti,\n\t\t\t\tj;\n\n\tStaticAssertStmt(SysCacheSize == (int) lengthof(cacheinfo),\n\t\t\t\t\t \"SysCacheSize does not match syscache.c's array\");\n\n\tAssert(!CacheInitialized);\n\n\tSysCacheRelationOidSize = SysCacheSupportingRelOidSize = 0;\n\n\tfor (cacheId = 0; cacheId < SysCacheSize; cacheId++)\n\t{\n\t\tSysCache[cacheId] = InitCatCache(cacheId,\n\t\t\t\t\t\t\t\t\t\t cacheinfo[cacheId].reloid,\n\t\t\t\t\t\t\t\t\t\t cacheinfo[cacheId].indoid,\n\t\t\t\t\t\t\t\t\t\t cacheinfo[cacheId].nkeys,\n\t\t\t\t\t\t\t\t\t\t cacheinfo[cacheId].key,\n\t\t\t\t\t\t\t\t\t\t cacheinfo[cacheId].nbuckets);\n\t\tif (!PointerIsValid(SysCache[cacheId]))\n\t\t\telog(ERROR, \"could not initialize cache %u (%d)\",\n\t\t\t\t cacheinfo[cacheId].reloid, cacheId);\n\t\t/* Accumulate data for OID lists, too */\n\t\tSysCacheRelationOid[SysCacheRelationOidSize++] =\n\t\t\tcacheinfo[cacheId].reloid;\n\t\tSysCacheSupportingRelOid[SysCacheSupportingRelOidSize++] =\n\t\t\tcacheinfo[cacheId].reloid;\n\t\tSysCacheSupportingRelOid[SysCacheSupportingRelOidSize++] =\n\t\t\tcacheinfo[cacheId].indoid;\n\t\t/* see comments for RelationInvalidatesSnapshotsOnly */\n\t\tAssert(!RelationInvalidatesSnapshotsOnly(cacheinfo[cacheId].reloid));\n\t}\n\n\tAssert(SysCacheRelationOidSize <= lengthof(SysCacheRelationOid));\n\tAssert(SysCacheSupportingRelOidSize <= lengthof(SysCacheSupportingRelOid));\n\n\t/* Sort and de-dup OID arrays, so we can use binary search. */\n\tpg_qsort(SysCacheRelationOid, SysCacheRelationOidSize,\n\t\t\t sizeof(Oid), oid_compare);\n\tfor (i = 1, j = 0; i < SysCacheRelationOidSize; i++)\n\t{\n\t\tif (SysCacheRelationOid[i] != SysCacheRelationOid[j])\n\t\t\tSysCacheRelationOid[++j] = SysCacheRelationOid[i];\n\t}\n\tSysCacheRelationOidSize = j + 1;\n\n\tpg_qsort(SysCacheSupportingRelOid, SysCacheSupportingRelOidSize,\n\t\t\t sizeof(Oid), oid_compare);\n\tfor (i = 1, j = 0; i < SysCacheSupportingRelOidSize; i++)\n\t{\n\t\tif (SysCacheSupportingRelOid[i] != SysCacheSupportingRelOid[j])\n\t\t\tSysCacheSupportingRelOid[++j] = SysCacheSupportingRelOid[i];\n\t}\n\tSysCacheSupportingRelOidSize = j + 1;\n\n\tCacheInitialized = true;\n}"
  }
]