[
  {
    "function_name": "check_rolespec_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "5328-5351",
    "snippet": "void\ncheck_rolespec_name(const RoleSpec *role, const char *detail_msg)\n{\n\tif (!role)\n\t\treturn;\n\n\tif (role->roletype != ROLESPEC_CSTRING)\n\t\treturn;\n\n\tif (IsReservedName(role->rolename))\n\t{\n\t\tif (detail_msg)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_RESERVED_NAME),\n\t\t\t\t\t errmsg(\"role name \\\"%s\\\" is reserved\",\n\t\t\t\t\t\t\trole->rolename),\n\t\t\t\t\t errdetail(\"%s\", detail_msg)));\n\t\telse\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_RESERVED_NAME),\n\t\t\t\t\t errmsg(\"role name \\\"%s\\\" is reserved\",\n\t\t\t\t\t\t\trole->rolename)));\n\t}\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_RESERVED_NAME),\n\t\t\t\t\t errmsg(\"role name \\\"%s\\\" is reserved\",\n\t\t\t\t\t\t\trole->rolename))"
          ],
          "line": 5346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"role name \\\"%s\\\" is reserved\"",
            "role->rolename"
          ],
          "line": 5348
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_RESERVED_NAME"
          ],
          "line": 5347
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_RESERVED_NAME),\n\t\t\t\t\t errmsg(\"role name \\\"%s\\\" is reserved\",\n\t\t\t\t\t\t\trole->rolename),\n\t\t\t\t\t errdetail(\"%s\", detail_msg))"
          ],
          "line": 5340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errdetail",
          "args": [
            "\"%s\"",
            "detail_msg"
          ],
          "line": 5344
        },
        "resolved": true,
        "details": {
          "function_name": "errdetail_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "918-933",
          "snippet": "int\nerrdetail_log(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, detail_log, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrdetail_log(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, detail_log, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsReservedName",
          "args": [
            "role->rolename"
          ],
          "line": 5337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nvoid\ncheck_rolespec_name(const RoleSpec *role, const char *detail_msg)\n{\n\tif (!role)\n\t\treturn;\n\n\tif (role->roletype != ROLESPEC_CSTRING)\n\t\treturn;\n\n\tif (IsReservedName(role->rolename))\n\t{\n\t\tif (detail_msg)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_RESERVED_NAME),\n\t\t\t\t\t errmsg(\"role name \\\"%s\\\" is reserved\",\n\t\t\t\t\t\t\trole->rolename),\n\t\t\t\t\t errdetail(\"%s\", detail_msg)));\n\t\telse\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_RESERVED_NAME),\n\t\t\t\t\t errmsg(\"role name \\\"%s\\\" is reserved\",\n\t\t\t\t\t\t\trole->rolename)));\n\t}\n}"
  },
  {
    "function_name": "get_rolespec_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "5306-5319",
    "snippet": "char *\nget_rolespec_name(const RoleSpec *role)\n{\n\tHeapTuple\ttp;\n\tForm_pg_authid authForm;\n\tchar\t   *rolename;\n\n\ttp = get_rolespec_tuple(role);\n\tauthForm = (Form_pg_authid) GETSTRUCT(tp);\n\trolename = pstrdup(NameStr(authForm->rolname));\n\tReleaseSysCache(tp);\n\n\treturn rolename;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "tp"
          ],
          "line": 5316
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pstrdup",
          "args": [
            "NameStr(authForm->rolname)"
          ],
          "line": 5315
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pstrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1658-1662",
          "snippet": "static char *\nxml_pstrdup(const char *string)\n{\n\treturn MemoryContextStrdup(LibxmlContext, string);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic char *\nxml_pstrdup(const char *string)\n{\n\treturn MemoryContextStrdup(LibxmlContext, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "authForm->rolname"
          ],
          "line": 5315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "tp"
          ],
          "line": 5314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rolespec_tuple",
          "args": [
            "role"
          ],
          "line": 5313
        },
        "resolved": true,
        "details": {
          "function_name": "get_rolespec_tuple",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5261-5301",
          "snippet": "HeapTuple\nget_rolespec_tuple(const RoleSpec *role)\n{\n\tHeapTuple\ttuple;\n\n\tswitch (role->roletype)\n\t{\n\t\tcase ROLESPEC_CSTRING:\n\t\t\tAssert(role->rolename);\n\t\t\ttuple = SearchSysCache1(AUTHNAME, CStringGetDatum(role->rolename));\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", role->rolename)));\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_CURRENT_USER:\n\t\t\ttuple = SearchSysCache1(AUTHOID, GetUserId());\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\telog(ERROR, \"cache lookup failed for role %u\", GetUserId());\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_SESSION_USER:\n\t\t\ttuple = SearchSysCache1(AUTHOID, GetSessionUserId());\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\telog(ERROR, \"cache lookup failed for role %u\", GetSessionUserId());\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_PUBLIC:\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", \"public\")));\n\t\t\ttuple = NULL;\t\t/* make compiler happy */\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\telog(ERROR, \"unexpected role type %d\", role->roletype);\n\t}\n\n\treturn tuple;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nHeapTuple\nget_rolespec_tuple(const RoleSpec *role)\n{\n\tHeapTuple\ttuple;\n\n\tswitch (role->roletype)\n\t{\n\t\tcase ROLESPEC_CSTRING:\n\t\t\tAssert(role->rolename);\n\t\t\ttuple = SearchSysCache1(AUTHNAME, CStringGetDatum(role->rolename));\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", role->rolename)));\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_CURRENT_USER:\n\t\t\ttuple = SearchSysCache1(AUTHOID, GetUserId());\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\telog(ERROR, \"cache lookup failed for role %u\", GetUserId());\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_SESSION_USER:\n\t\t\ttuple = SearchSysCache1(AUTHOID, GetSessionUserId());\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\telog(ERROR, \"cache lookup failed for role %u\", GetSessionUserId());\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_PUBLIC:\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", \"public\")));\n\t\t\ttuple = NULL;\t\t/* make compiler happy */\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\telog(ERROR, \"unexpected role type %d\", role->roletype);\n\t}\n\n\treturn tuple;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nchar *\nget_rolespec_name(const RoleSpec *role)\n{\n\tHeapTuple\ttp;\n\tForm_pg_authid authForm;\n\tchar\t   *rolename;\n\n\ttp = get_rolespec_tuple(role);\n\tauthForm = (Form_pg_authid) GETSTRUCT(tp);\n\trolename = pstrdup(NameStr(authForm->rolname));\n\tReleaseSysCache(tp);\n\n\treturn rolename;\n}"
  },
  {
    "function_name": "get_rolespec_tuple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "5261-5301",
    "snippet": "HeapTuple\nget_rolespec_tuple(const RoleSpec *role)\n{\n\tHeapTuple\ttuple;\n\n\tswitch (role->roletype)\n\t{\n\t\tcase ROLESPEC_CSTRING:\n\t\t\tAssert(role->rolename);\n\t\t\ttuple = SearchSysCache1(AUTHNAME, CStringGetDatum(role->rolename));\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", role->rolename)));\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_CURRENT_USER:\n\t\t\ttuple = SearchSysCache1(AUTHOID, GetUserId());\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\telog(ERROR, \"cache lookup failed for role %u\", GetUserId());\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_SESSION_USER:\n\t\t\ttuple = SearchSysCache1(AUTHOID, GetSessionUserId());\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\telog(ERROR, \"cache lookup failed for role %u\", GetSessionUserId());\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_PUBLIC:\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", \"public\")));\n\t\t\ttuple = NULL;\t\t/* make compiler happy */\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\telog(ERROR, \"unexpected role type %d\", role->roletype);\n\t}\n\n\treturn tuple;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"unexpected role type %d\"",
            "role->roletype"
          ],
          "line": 5297
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", \"public\"))"
          ],
          "line": 5290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"role \\\"%s\\\" does not exist\"",
            "\"public\""
          ],
          "line": 5292
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_UNDEFINED_OBJECT"
          ],
          "line": 5291
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetSessionUserId",
          "args": [],
          "line": 5286
        },
        "resolved": true,
        "details": {
          "function_name": "GetSessionUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "420-425",
          "snippet": "Oid\nGetSessionUserId(void)\n{\n\tAssertState(OidIsValid(SessionUserId));\n\treturn SessionUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tSessionUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tSessionUserId = InvalidOid;\n\nOid\nGetSessionUserId(void)\n{\n\tAssertState(OidIsValid(SessionUserId));\n\treturn SessionUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 5285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCache1",
          "args": [
            "AUTHOID",
            "GetSessionUserId()"
          ],
          "line": 5284
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCache1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1111-1120",
          "snippet": "HeapTuple\nSearchSysCache1(int cacheId,\n\t\t\t\tDatum key1)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 1);\n\n\treturn SearchCatCache1(SysCache[cacheId], key1);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static CatCache *SysCache[SysCacheSize];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache1(int cacheId,\n\t\t\t\tDatum key1)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 1);\n\n\treturn SearchCatCache1(SysCache[cacheId], key1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 5280
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 5279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", role->rolename))"
          ],
          "line": 5272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "tuple"
          ],
          "line": 5271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "role->rolename"
          ],
          "line": 5270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "role->rolename"
          ],
          "line": 5269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nHeapTuple\nget_rolespec_tuple(const RoleSpec *role)\n{\n\tHeapTuple\ttuple;\n\n\tswitch (role->roletype)\n\t{\n\t\tcase ROLESPEC_CSTRING:\n\t\t\tAssert(role->rolename);\n\t\t\ttuple = SearchSysCache1(AUTHNAME, CStringGetDatum(role->rolename));\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", role->rolename)));\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_CURRENT_USER:\n\t\t\ttuple = SearchSysCache1(AUTHOID, GetUserId());\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\telog(ERROR, \"cache lookup failed for role %u\", GetUserId());\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_SESSION_USER:\n\t\t\ttuple = SearchSysCache1(AUTHOID, GetSessionUserId());\n\t\t\tif (!HeapTupleIsValid(tuple))\n\t\t\t\telog(ERROR, \"cache lookup failed for role %u\", GetSessionUserId());\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_PUBLIC:\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", \"public\")));\n\t\t\ttuple = NULL;\t\t/* make compiler happy */\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\telog(ERROR, \"unexpected role type %d\", role->roletype);\n\t}\n\n\treturn tuple;\n}"
  },
  {
    "function_name": "get_rolespec_oid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "5223-5255",
    "snippet": "Oid\nget_rolespec_oid(const RoleSpec *role, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\tswitch (role->roletype)\n\t{\n\t\tcase ROLESPEC_CSTRING:\n\t\t\tAssert(role->rolename);\n\t\t\toid = get_role_oid(role->rolename, missing_ok);\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_CURRENT_USER:\n\t\t\toid = GetUserId();\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_SESSION_USER:\n\t\t\toid = GetSessionUserId();\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_PUBLIC:\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", \"public\")));\n\t\t\toid = InvalidOid;\t/* make compiler happy */\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\telog(ERROR, \"unexpected role type %d\", role->roletype);\n\t}\n\n\treturn oid;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"unexpected role type %d\"",
            "role->roletype"
          ],
          "line": 5251
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", \"public\"))"
          ],
          "line": 5244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"role \\\"%s\\\" does not exist\"",
            "\"public\""
          ],
          "line": 5246
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_UNDEFINED_OBJECT"
          ],
          "line": 5245
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetSessionUserId",
          "args": [],
          "line": 5240
        },
        "resolved": true,
        "details": {
          "function_name": "GetSessionUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "420-425",
          "snippet": "Oid\nGetSessionUserId(void)\n{\n\tAssertState(OidIsValid(SessionUserId));\n\treturn SessionUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tSessionUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tSessionUserId = InvalidOid;\n\nOid\nGetSessionUserId(void)\n{\n\tAssertState(OidIsValid(SessionUserId));\n\treturn SessionUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 5236
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid",
          "args": [
            "role->rolename",
            "missing_ok"
          ],
          "line": 5232
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5190-5201",
          "snippet": "Oid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nOid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "role->rolename"
          ],
          "line": 5231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nOid\nget_rolespec_oid(const RoleSpec *role, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\tswitch (role->roletype)\n\t{\n\t\tcase ROLESPEC_CSTRING:\n\t\t\tAssert(role->rolename);\n\t\t\toid = get_role_oid(role->rolename, missing_ok);\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_CURRENT_USER:\n\t\t\toid = GetUserId();\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_SESSION_USER:\n\t\t\toid = GetSessionUserId();\n\t\t\tbreak;\n\n\t\tcase ROLESPEC_PUBLIC:\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", \"public\")));\n\t\t\toid = InvalidOid;\t/* make compiler happy */\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\telog(ERROR, \"unexpected role type %d\", role->roletype);\n\t}\n\n\treturn oid;\n}"
  },
  {
    "function_name": "get_role_oid_or_public",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "5207-5214",
    "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_role_oid",
          "args": [
            "rolname",
            "false"
          ],
          "line": 5213
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5190-5201",
          "snippet": "Oid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nOid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "rolname",
            "\"public\""
          ],
          "line": 5210
        },
        "resolved": true,
        "details": {
          "function_name": "namestrcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/name.c",
          "lines": "246-256",
          "snippet": "int\nnamestrcmp(Name name, const char *str)\n{\n\tif (!name && !str)\n\t\treturn 0;\n\tif (!name)\n\t\treturn -1;\t\t\t\t/* NULL < anything */\n\tif (!str)\n\t\treturn 1;\t\t\t\t/* NULL < anything */\n\treturn strncmp(NameStr(*name), str, NAMEDATALEN);\n}",
          "includes": [
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/lsyscache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"postgres.h\"\n\nint\nnamestrcmp(Name name, const char *str)\n{\n\tif (!name && !str)\n\t\treturn 0;\n\tif (!name)\n\t\treturn -1;\t\t\t\t/* NULL < anything */\n\tif (!str)\n\t\treturn 1;\t\t\t\t/* NULL < anything */\n\treturn strncmp(NameStr(*name), str, NAMEDATALEN);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
  },
  {
    "function_name": "get_role_oid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "5190-5201",
    "snippet": "Oid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname))"
          ],
          "line": 5197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"role \\\"%s\\\" does not exist\"",
            "rolname"
          ],
          "line": 5199
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_UNDEFINED_OBJECT"
          ],
          "line": 5198
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "OidIsValid",
          "args": [
            "oid"
          ],
          "line": 5196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSysCacheOid1",
          "args": [
            "AUTHNAME",
            "CStringGetDatum(rolname)"
          ],
          "line": 5195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "rolname"
          ],
          "line": 5195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nOid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}"
  },
  {
    "function_name": "select_best_grantor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "5115-5182",
    "snippet": "void\nselect_best_grantor(Oid roleId, AclMode privileges,\n\t\t\t\t\tconst Acl *acl, Oid ownerId,\n\t\t\t\t\tOid *grantorId, AclMode *grantOptions)\n{\n\tAclMode\t\tneeded_goptions = ACL_GRANT_OPTION_FOR(privileges);\n\tList\t   *roles_list;\n\tint\t\t\tnrights;\n\tListCell   *l;\n\n\t/*\n\t * The object owner is always treated as having all grant options, so if\n\t * roleId is the owner it's easy.  Also, if roleId is a superuser it's\n\t * easy: superusers are implicitly members of every role, so they act as\n\t * the object owner.\n\t */\n\tif (roleId == ownerId || superuser_arg(roleId))\n\t{\n\t\t*grantorId = ownerId;\n\t\t*grantOptions = needed_goptions;\n\t\treturn;\n\t}\n\n\t/*\n\t * Otherwise we have to do a careful search to see if roleId has the\n\t * privileges of any suitable role.  Note: we can hang onto the result of\n\t * roles_has_privs_of() throughout this loop, because aclmask_direct()\n\t * doesn't query any role memberships.\n\t */\n\troles_list = roles_has_privs_of(roleId);\n\n\t/* initialize candidate result as default */\n\t*grantorId = roleId;\n\t*grantOptions = ACL_NO_RIGHTS;\n\tnrights = 0;\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\totherrole = lfirst_oid(l);\n\t\tAclMode\t\totherprivs;\n\n\t\totherprivs = aclmask_direct(acl, otherrole, ownerId,\n\t\t\t\t\t\t\t\t\tneeded_goptions, ACLMASK_ALL);\n\t\tif (otherprivs == needed_goptions)\n\t\t{\n\t\t\t/* Found a suitable grantor */\n\t\t\t*grantorId = otherrole;\n\t\t\t*grantOptions = otherprivs;\n\t\t\treturn;\n\t\t}\n\n\t\t/*\n\t\t * If it has just some of the needed privileges, remember best\n\t\t * candidate.\n\t\t */\n\t\tif (otherprivs != ACL_NO_RIGHTS)\n\t\t{\n\t\t\tint\t\t\tnnewrights = count_one_bits(otherprivs);\n\n\t\t\tif (nnewrights > nrights)\n\t\t\t{\n\t\t\t\t*grantorId = otherrole;\n\t\t\t\t*grantOptions = otherprivs;\n\t\t\t\tnrights = nnewrights;\n\t\t\t}\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static void check_acl(const Acl *acl);",
      "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "count_one_bits",
          "args": [
            "otherprivs"
          ],
          "line": 5172
        },
        "resolved": true,
        "details": {
          "function_name": "count_one_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5075-5088",
          "snippet": "static int\ncount_one_bits(AclMode mask)\n{\n\tint\t\t\tnbits = 0;\n\n\t/* this code relies on AclMode being an unsigned type */\n\twhile (mask)\n\t{\n\t\tif (mask & 1)\n\t\t\tnbits++;\n\t\tmask >>= 1;\n\t}\n\treturn nbits;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic int\ncount_one_bits(AclMode mask)\n{\n\tint\t\t\tnbits = 0;\n\n\t/* this code relies on AclMode being an unsigned type */\n\twhile (mask)\n\t{\n\t\tif (mask & 1)\n\t\t\tnbits++;\n\t\tmask >>= 1;\n\t}\n\treturn nbits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "aclmask_direct",
          "args": [
            "acl",
            "otherrole",
            "ownerId",
            "needed_goptions",
            "ACLMASK_ALL"
          ],
          "line": 5156
        },
        "resolved": true,
        "details": {
          "function_name": "aclmask_direct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1409-1461",
          "snippet": "static AclMode\naclmask_direct(const Acl *acl, Oid roleid, Oid ownerId,\n\t\t\t   AclMode mask, AclMaskHow how)\n{\n\tAclMode\t\tresult;\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/*\n\t * Null ACL should not happen, since caller should have inserted\n\t * appropriate default\n\t */\n\tif (acl == NULL)\n\t\telog(ERROR, \"null ACL\");\n\n\tcheck_acl(acl);\n\n\t/* Quick exit for mask == 0 */\n\tif (mask == 0)\n\t\treturn 0;\n\n\tresult = 0;\n\n\t/* Owner always implicitly has all grant options */\n\tif ((mask & ACLITEM_ALL_GOPTION_BITS) &&\n\t\troleid == ownerId)\n\t{\n\t\tresult = mask & ACLITEM_ALL_GOPTION_BITS;\n\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\treturn result;\n\t}\n\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\n\t/*\n\t * Check privileges granted directly to roleid (and not to public)\n\t */\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == roleid)\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);",
            "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nstatic AclMode\naclmask_direct(const Acl *acl, Oid roleid, Oid ownerId,\n\t\t\t   AclMode mask, AclMaskHow how)\n{\n\tAclMode\t\tresult;\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/*\n\t * Null ACL should not happen, since caller should have inserted\n\t * appropriate default\n\t */\n\tif (acl == NULL)\n\t\telog(ERROR, \"null ACL\");\n\n\tcheck_acl(acl);\n\n\t/* Quick exit for mask == 0 */\n\tif (mask == 0)\n\t\treturn 0;\n\n\tresult = 0;\n\n\t/* Owner always implicitly has all grant options */\n\tif ((mask & ACLITEM_ALL_GOPTION_BITS) &&\n\t\troleid == ownerId)\n\t{\n\t\tresult = mask & ACLITEM_ALL_GOPTION_BITS;\n\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\treturn result;\n\t}\n\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\n\t/*\n\t * Check privileges granted directly to roleid (and not to public)\n\t */\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == roleid)\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lfirst_oid",
          "args": [
            "l"
          ],
          "line": 5153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "foreach",
          "args": [
            "l",
            "roles_list"
          ],
          "line": 5151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roles_has_privs_of",
          "args": [
            "roleId"
          ],
          "line": 5144
        },
        "resolved": true,
        "details": {
          "function_name": "roles_has_privs_of",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4747-4818",
          "snippet": "static List *\nroles_has_privs_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_privs_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_privs_role) && cached_privs_role == roleid)\n\t\treturn cached_privs_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Ignore non-inheriting roles */\n\t\tif (!has_rolinherit(memberid))\n\t\t\tcontinue;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_privs_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_privs_role = InvalidOid; /* just paranoia */\n\tlist_free(cached_privs_roles);\n\tcached_privs_roles = new_cached_privs_roles;\n\tcached_privs_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_privs_roles;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tcached_privs_role = InvalidOid;",
            "static List *cached_privs_roles = NIL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tcached_privs_role = InvalidOid;\nstatic List *cached_privs_roles = NIL;\n\nstatic List *\nroles_has_privs_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_privs_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_privs_role) && cached_privs_role == roleid)\n\t\treturn cached_privs_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Ignore non-inheriting roles */\n\t\tif (!has_rolinherit(memberid))\n\t\t\tcontinue;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_privs_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_privs_role = InvalidOid; /* just paranoia */\n\tlist_free(cached_privs_roles);\n\tcached_privs_roles = new_cached_privs_roles;\n\tcached_privs_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_privs_roles;\n}"
        }
      },
      {
        "call_info": {
          "callee": "superuser_arg",
          "args": [
            "roleId"
          ],
          "line": 5131
        },
        "resolved": true,
        "details": {
          "function_name": "superuser_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/misc/superuser.c",
          "lines": "56-97",
          "snippet": "bool\nsuperuser_arg(Oid roleid)\n{\n\tbool\t\tresult;\n\tHeapTuple\trtup;\n\n\t/* Quick out for cache hit */\n\tif (OidIsValid(last_roleid) && last_roleid == roleid)\n\t\treturn last_roleid_is_super;\n\n\t/* Special escape path in case you deleted all your users. */\n\tif (!IsUnderPostmaster && roleid == BOOTSTRAP_SUPERUSERID)\n\t\treturn true;\n\n\t/* OK, look up the information in pg_authid */\n\trtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(rtup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(rtup))->rolsuper;\n\t\tReleaseSysCache(rtup);\n\t}\n\telse\n\t{\n\t\t/* Report \"not superuser\" for invalid roleids */\n\t\tresult = false;\n\t}\n\n\t/* If first time through, set up callback for cache flushes */\n\tif (!roleid_callback_registered)\n\t{\n\t\tCacheRegisterSyscacheCallback(AUTHOID,\n\t\t\t\t\t\t\t\t\t  RoleidCallback,\n\t\t\t\t\t\t\t\t\t  (Datum) 0);\n\t\troleid_callback_registered = true;\n\t}\n\n\t/* Cache the result for next time */\n\tlast_roleid = roleid;\n\tlast_roleid_is_super = result;\n\n\treturn result;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tlast_roleid = InvalidOid;",
            "static bool last_roleid_is_super = false;",
            "static bool roleid_callback_registered = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"utils/syscache.h\"\n#include \"utils/inval.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic Oid\tlast_roleid = InvalidOid;\nstatic bool last_roleid_is_super = false;\nstatic bool roleid_callback_registered = false;\n\nbool\nsuperuser_arg(Oid roleid)\n{\n\tbool\t\tresult;\n\tHeapTuple\trtup;\n\n\t/* Quick out for cache hit */\n\tif (OidIsValid(last_roleid) && last_roleid == roleid)\n\t\treturn last_roleid_is_super;\n\n\t/* Special escape path in case you deleted all your users. */\n\tif (!IsUnderPostmaster && roleid == BOOTSTRAP_SUPERUSERID)\n\t\treturn true;\n\n\t/* OK, look up the information in pg_authid */\n\trtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(rtup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(rtup))->rolsuper;\n\t\tReleaseSysCache(rtup);\n\t}\n\telse\n\t{\n\t\t/* Report \"not superuser\" for invalid roleids */\n\t\tresult = false;\n\t}\n\n\t/* If first time through, set up callback for cache flushes */\n\tif (!roleid_callback_registered)\n\t{\n\t\tCacheRegisterSyscacheCallback(AUTHOID,\n\t\t\t\t\t\t\t\t\t  RoleidCallback,\n\t\t\t\t\t\t\t\t\t  (Datum) 0);\n\t\troleid_callback_registered = true;\n\t}\n\n\t/* Cache the result for next time */\n\tlast_roleid = roleid;\n\tlast_roleid_is_super = result;\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "privileges"
          ],
          "line": 5120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic void check_acl(const Acl *acl);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nvoid\nselect_best_grantor(Oid roleId, AclMode privileges,\n\t\t\t\t\tconst Acl *acl, Oid ownerId,\n\t\t\t\t\tOid *grantorId, AclMode *grantOptions)\n{\n\tAclMode\t\tneeded_goptions = ACL_GRANT_OPTION_FOR(privileges);\n\tList\t   *roles_list;\n\tint\t\t\tnrights;\n\tListCell   *l;\n\n\t/*\n\t * The object owner is always treated as having all grant options, so if\n\t * roleId is the owner it's easy.  Also, if roleId is a superuser it's\n\t * easy: superusers are implicitly members of every role, so they act as\n\t * the object owner.\n\t */\n\tif (roleId == ownerId || superuser_arg(roleId))\n\t{\n\t\t*grantorId = ownerId;\n\t\t*grantOptions = needed_goptions;\n\t\treturn;\n\t}\n\n\t/*\n\t * Otherwise we have to do a careful search to see if roleId has the\n\t * privileges of any suitable role.  Note: we can hang onto the result of\n\t * roles_has_privs_of() throughout this loop, because aclmask_direct()\n\t * doesn't query any role memberships.\n\t */\n\troles_list = roles_has_privs_of(roleId);\n\n\t/* initialize candidate result as default */\n\t*grantorId = roleId;\n\t*grantOptions = ACL_NO_RIGHTS;\n\tnrights = 0;\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\totherrole = lfirst_oid(l);\n\t\tAclMode\t\totherprivs;\n\n\t\totherprivs = aclmask_direct(acl, otherrole, ownerId,\n\t\t\t\t\t\t\t\t\tneeded_goptions, ACLMASK_ALL);\n\t\tif (otherprivs == needed_goptions)\n\t\t{\n\t\t\t/* Found a suitable grantor */\n\t\t\t*grantorId = otherrole;\n\t\t\t*grantOptions = otherprivs;\n\t\t\treturn;\n\t\t}\n\n\t\t/*\n\t\t * If it has just some of the needed privileges, remember best\n\t\t * candidate.\n\t\t */\n\t\tif (otherprivs != ACL_NO_RIGHTS)\n\t\t{\n\t\t\tint\t\t\tnnewrights = count_one_bits(otherprivs);\n\n\t\t\tif (nnewrights > nrights)\n\t\t\t{\n\t\t\t\t*grantorId = otherrole;\n\t\t\t\t*grantOptions = otherprivs;\n\t\t\t\tnrights = nnewrights;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "count_one_bits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "5075-5088",
    "snippet": "static int\ncount_one_bits(AclMode mask)\n{\n\tint\t\t\tnbits = 0;\n\n\t/* this code relies on AclMode being an unsigned type */\n\twhile (mask)\n\t{\n\t\tif (mask & 1)\n\t\t\tnbits++;\n\t\tmask >>= 1;\n\t}\n\treturn nbits;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic int\ncount_one_bits(AclMode mask)\n{\n\tint\t\t\tnbits = 0;\n\n\t/* this code relies on AclMode being an unsigned type */\n\twhile (mask)\n\t{\n\t\tif (mask & 1)\n\t\t\tnbits++;\n\t\tmask >>= 1;\n\t}\n\treturn nbits;\n}"
  },
  {
    "function_name": "is_admin_of_role",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4989-5071",
    "snippet": "bool\nis_admin_of_role(Oid member, Oid role)\n{\n\tbool\t\tresult = false;\n\tList\t   *roles_list;\n\tListCell   *l;\n\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\tif (member == role)\n\n\t\t/*\n\t\t * A role can admin itself when it matches the session user and we're\n\t\t * outside any security-restricted operation, SECURITY DEFINER or\n\t\t * similar context.  SQL-standard roles cannot self-admin.  However,\n\t\t * SQL-standard users are distinct from roles, and they are not\n\t\t * grantable like roles: PostgreSQL's role-user duality extends the\n\t\t * standard.  Checking for a session user match has the effect of\n\t\t * letting a role self-admin only when it's conspicuously behaving\n\t\t * like a user.  Note that allowing self-admin under a mere SET ROLE\n\t\t * would make WITH ADMIN OPTION largely irrelevant; any member could\n\t\t * SET ROLE to issue the otherwise-forbidden command.\n\t\t *\n\t\t * Withholding self-admin in a security-restricted operation prevents\n\t\t * object owners from harnessing the session user identity during\n\t\t * administrative maintenance.  Suppose Alice owns a database, has\n\t\t * issued \"GRANT alice TO bob\", and runs a daily ANALYZE.  Bob creates\n\t\t * an alice-owned SECURITY DEFINER function that issues \"REVOKE alice\n\t\t * FROM carol\".  If he creates an expression index calling that\n\t\t * function, Alice will attempt the REVOKE during each ANALYZE.\n\t\t * Checking InSecurityRestrictedOperation() thwarts that attack.\n\t\t *\n\t\t * Withholding self-admin in SECURITY DEFINER functions makes their\n\t\t * behavior independent of the calling user.  There's no security or\n\t\t * SQL-standard-conformance need for that restriction, though.\n\t\t *\n\t\t * A role cannot have actual WITH ADMIN OPTION on itself, because that\n\t\t * would imply a membership loop.  Therefore, we're done either way.\n\t\t */\n\t\treturn member == GetSessionUserId() &&\n\t\t\t!InLocalUserIdChange() && !InSecurityRestrictedOperation();\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion.  We build a list in the same way that is_member_of_role does\n\t * to track visited and unvisited roles.\n\t */\n\troles_list = list_make1_oid(member);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\tif (otherid == role &&\n\t\t\t\t((Form_pg_auth_members) GETSTRUCT(tup))->admin_option)\n\t\t\t{\n\t\t\t\t/* Found what we came for, so can stop searching */\n\t\t\t\tresult = true;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t\tif (result)\n\t\t\tbreak;\n\t}\n\n\tlist_free(roles_list);\n\n\treturn result;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free",
          "args": [
            "roles_list"
          ],
          "line": 5068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReleaseSysCacheList",
          "args": [
            "memlist"
          ],
          "line": 5063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_append_unique_oid",
          "args": [
            "roles_list",
            "otherid"
          ],
          "line": 5061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "tup"
          ],
          "line": 5054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "tup"
          ],
          "line": 5051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheList1",
          "args": [
            "AUTHMEMMEMROLE",
            "ObjectIdGetDatum(memberid)"
          ],
          "line": 5046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "memberid"
          ],
          "line": 5047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lfirst_oid",
          "args": [
            "l"
          ],
          "line": 5041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "foreach",
          "args": [
            "l",
            "roles_list"
          ],
          "line": 5039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_make1_oid",
          "args": [
            "member"
          ],
          "line": 5037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InSecurityRestrictedOperation",
          "args": [],
          "line": 5030
        },
        "resolved": true,
        "details": {
          "function_name": "InSecurityRestrictedOperation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "518-522",
          "snippet": "bool\nInSecurityRestrictedOperation(void)\n{\n\treturn (SecurityRestrictionContext & SECURITY_RESTRICTED_OPERATION) != 0;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tSecurityRestrictionContext = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic int\tSecurityRestrictionContext = 0;\n\nbool\nInSecurityRestrictedOperation(void)\n{\n\treturn (SecurityRestrictionContext & SECURITY_RESTRICTED_OPERATION) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "InLocalUserIdChange",
          "args": [],
          "line": 5030
        },
        "resolved": true,
        "details": {
          "function_name": "InLocalUserIdChange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "509-513",
          "snippet": "bool\nInLocalUserIdChange(void)\n{\n\treturn (SecurityRestrictionContext & SECURITY_LOCAL_USERID_CHANGE) != 0;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\tSecurityRestrictionContext = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic int\tSecurityRestrictionContext = 0;\n\nbool\nInLocalUserIdChange(void)\n{\n\treturn (SecurityRestrictionContext & SECURITY_LOCAL_USERID_CHANGE) != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetSessionUserId",
          "args": [],
          "line": 5029
        },
        "resolved": true,
        "details": {
          "function_name": "GetSessionUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "420-425",
          "snippet": "Oid\nGetSessionUserId(void)\n{\n\tAssertState(OidIsValid(SessionUserId));\n\treturn SessionUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tSessionUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tSessionUserId = InvalidOid;\n\nOid\nGetSessionUserId(void)\n{\n\tAssertState(OidIsValid(SessionUserId));\n\treturn SessionUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "superuser_arg",
          "args": [
            "member"
          ],
          "line": 4996
        },
        "resolved": true,
        "details": {
          "function_name": "superuser_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/misc/superuser.c",
          "lines": "56-97",
          "snippet": "bool\nsuperuser_arg(Oid roleid)\n{\n\tbool\t\tresult;\n\tHeapTuple\trtup;\n\n\t/* Quick out for cache hit */\n\tif (OidIsValid(last_roleid) && last_roleid == roleid)\n\t\treturn last_roleid_is_super;\n\n\t/* Special escape path in case you deleted all your users. */\n\tif (!IsUnderPostmaster && roleid == BOOTSTRAP_SUPERUSERID)\n\t\treturn true;\n\n\t/* OK, look up the information in pg_authid */\n\trtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(rtup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(rtup))->rolsuper;\n\t\tReleaseSysCache(rtup);\n\t}\n\telse\n\t{\n\t\t/* Report \"not superuser\" for invalid roleids */\n\t\tresult = false;\n\t}\n\n\t/* If first time through, set up callback for cache flushes */\n\tif (!roleid_callback_registered)\n\t{\n\t\tCacheRegisterSyscacheCallback(AUTHOID,\n\t\t\t\t\t\t\t\t\t  RoleidCallback,\n\t\t\t\t\t\t\t\t\t  (Datum) 0);\n\t\troleid_callback_registered = true;\n\t}\n\n\t/* Cache the result for next time */\n\tlast_roleid = roleid;\n\tlast_roleid_is_super = result;\n\n\treturn result;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tlast_roleid = InvalidOid;",
            "static bool last_roleid_is_super = false;",
            "static bool roleid_callback_registered = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"utils/syscache.h\"\n#include \"utils/inval.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic Oid\tlast_roleid = InvalidOid;\nstatic bool last_roleid_is_super = false;\nstatic bool roleid_callback_registered = false;\n\nbool\nsuperuser_arg(Oid roleid)\n{\n\tbool\t\tresult;\n\tHeapTuple\trtup;\n\n\t/* Quick out for cache hit */\n\tif (OidIsValid(last_roleid) && last_roleid == roleid)\n\t\treturn last_roleid_is_super;\n\n\t/* Special escape path in case you deleted all your users. */\n\tif (!IsUnderPostmaster && roleid == BOOTSTRAP_SUPERUSERID)\n\t\treturn true;\n\n\t/* OK, look up the information in pg_authid */\n\trtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(rtup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(rtup))->rolsuper;\n\t\tReleaseSysCache(rtup);\n\t}\n\telse\n\t{\n\t\t/* Report \"not superuser\" for invalid roleids */\n\t\tresult = false;\n\t}\n\n\t/* If first time through, set up callback for cache flushes */\n\tif (!roleid_callback_registered)\n\t{\n\t\tCacheRegisterSyscacheCallback(AUTHOID,\n\t\t\t\t\t\t\t\t\t  RoleidCallback,\n\t\t\t\t\t\t\t\t\t  (Datum) 0);\n\t\troleid_callback_registered = true;\n\t}\n\n\t/* Cache the result for next time */\n\tlast_roleid = roleid;\n\tlast_roleid_is_super = result;\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);\n\nbool\nis_admin_of_role(Oid member, Oid role)\n{\n\tbool\t\tresult = false;\n\tList\t   *roles_list;\n\tListCell   *l;\n\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\tif (member == role)\n\n\t\t/*\n\t\t * A role can admin itself when it matches the session user and we're\n\t\t * outside any security-restricted operation, SECURITY DEFINER or\n\t\t * similar context.  SQL-standard roles cannot self-admin.  However,\n\t\t * SQL-standard users are distinct from roles, and they are not\n\t\t * grantable like roles: PostgreSQL's role-user duality extends the\n\t\t * standard.  Checking for a session user match has the effect of\n\t\t * letting a role self-admin only when it's conspicuously behaving\n\t\t * like a user.  Note that allowing self-admin under a mere SET ROLE\n\t\t * would make WITH ADMIN OPTION largely irrelevant; any member could\n\t\t * SET ROLE to issue the otherwise-forbidden command.\n\t\t *\n\t\t * Withholding self-admin in a security-restricted operation prevents\n\t\t * object owners from harnessing the session user identity during\n\t\t * administrative maintenance.  Suppose Alice owns a database, has\n\t\t * issued \"GRANT alice TO bob\", and runs a daily ANALYZE.  Bob creates\n\t\t * an alice-owned SECURITY DEFINER function that issues \"REVOKE alice\n\t\t * FROM carol\".  If he creates an expression index calling that\n\t\t * function, Alice will attempt the REVOKE during each ANALYZE.\n\t\t * Checking InSecurityRestrictedOperation() thwarts that attack.\n\t\t *\n\t\t * Withholding self-admin in SECURITY DEFINER functions makes their\n\t\t * behavior independent of the calling user.  There's no security or\n\t\t * SQL-standard-conformance need for that restriction, though.\n\t\t *\n\t\t * A role cannot have actual WITH ADMIN OPTION on itself, because that\n\t\t * would imply a membership loop.  Therefore, we're done either way.\n\t\t */\n\t\treturn member == GetSessionUserId() &&\n\t\t\t!InLocalUserIdChange() && !InSecurityRestrictedOperation();\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion.  We build a list in the same way that is_member_of_role does\n\t * to track visited and unvisited roles.\n\t */\n\troles_list = list_make1_oid(member);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\tif (otherid == role &&\n\t\t\t\t((Form_pg_auth_members) GETSTRUCT(tup))->admin_option)\n\t\t\t{\n\t\t\t\t/* Found what we came for, so can stop searching */\n\t\t\t\tresult = true;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t\tif (result)\n\t\t\tbreak;\n\t}\n\n\tlist_free(roles_list);\n\n\treturn result;\n}"
  },
  {
    "function_name": "is_member_of_role_nosuper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4969-4981",
    "snippet": "bool\nis_member_of_role_nosuper(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_is_member_of(member), role);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_member_oid",
          "args": [
            "roles_is_member_of(member)",
            "role"
          ],
          "line": 4980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roles_is_member_of",
          "args": [
            "member"
          ],
          "line": 4980
        },
        "resolved": true,
        "details": {
          "function_name": "roles_is_member_of",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4830-4897",
          "snippet": "static List *\nroles_is_member_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_membership_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_member_role) && cached_member_role == roleid)\n\t\treturn cached_membership_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_membership_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_member_role = InvalidOid;\t/* just paranoia */\n\tlist_free(cached_membership_roles);\n\tcached_membership_roles = new_cached_membership_roles;\n\tcached_member_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_membership_roles;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tcached_member_role = InvalidOid;",
            "static List *cached_membership_roles = NIL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tcached_member_role = InvalidOid;\nstatic List *cached_membership_roles = NIL;\n\nstatic List *\nroles_is_member_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_membership_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_member_role) && cached_member_role == roleid)\n\t\treturn cached_membership_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_membership_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_member_role = InvalidOid;\t/* just paranoia */\n\tlist_free(cached_membership_roles);\n\tcached_membership_roles = new_cached_membership_roles;\n\tcached_member_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_membership_roles;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\nis_member_of_role_nosuper(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_is_member_of(member), role);\n}"
  },
  {
    "function_name": "check_is_member_of_role",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4953-4961",
    "snippet": "void\ncheck_is_member_of_role(Oid member, Oid role)\n{\n\tif (!is_member_of_role(member, role))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INSUFFICIENT_PRIVILEGE),\n\t\t\t\t errmsg(\"must be member of role \\\"%s\\\"\",\n\t\t\t\t\t\tGetUserNameFromId(role, false))));\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INSUFFICIENT_PRIVILEGE),\n\t\t\t\t errmsg(\"must be member of role \\\"%s\\\"\",\n\t\t\t\t\t\tGetUserNameFromId(role, false)))"
          ],
          "line": 4957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"must be member of role \\\"%s\\\"\"",
            "GetUserNameFromId(role, false)"
          ],
          "line": 4959
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserNameFromId",
          "args": [
            "role",
            "false"
          ],
          "line": 4960
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserNameFromId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "794-815",
          "snippet": "char *\nGetUserNameFromId(Oid roleid, bool noerr)\n{\n\tHeapTuple\ttuple;\n\tchar\t   *result;\n\n\ttuple = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (!HeapTupleIsValid(tuple))\n\t{\n\t\tif (!noerr)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t errmsg(\"invalid role OID: %u\", roleid)));\n\t\tresult = NULL;\n\t}\n\telse\n\t{\n\t\tresult = pstrdup(NameStr(((Form_pg_authid) GETSTRUCT(tuple))->rolname));\n\t\tReleaseSysCache(tuple);\n\t}\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nchar *\nGetUserNameFromId(Oid roleid, bool noerr)\n{\n\tHeapTuple\ttuple;\n\tchar\t   *result;\n\n\ttuple = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (!HeapTupleIsValid(tuple))\n\t{\n\t\tif (!noerr)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t\t errmsg(\"invalid role OID: %u\", roleid)));\n\t\tresult = NULL;\n\t}\n\telse\n\t{\n\t\tresult = pstrdup(NameStr(((Form_pg_authid) GETSTRUCT(tuple))->rolname));\n\t\tReleaseSysCache(tuple);\n\t}\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INSUFFICIENT_PRIVILEGE"
          ],
          "line": 4958
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_member_of_role",
          "args": [
            "member",
            "role"
          ],
          "line": 4956
        },
        "resolved": true,
        "details": {
          "function_name": "is_member_of_role_nosuper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4969-4981",
          "snippet": "bool\nis_member_of_role_nosuper(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_is_member_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\nis_member_of_role_nosuper(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_is_member_of(member), role);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nvoid\ncheck_is_member_of_role(Oid member, Oid role)\n{\n\tif (!is_member_of_role(member, role))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INSUFFICIENT_PRIVILEGE),\n\t\t\t\t errmsg(\"must be member of role \\\"%s\\\"\",\n\t\t\t\t\t\tGetUserNameFromId(role, false))));\n}"
  },
  {
    "function_name": "is_member_of_role",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4931-4947",
    "snippet": "bool\nis_member_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_is_member_of(member), role);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_member_oid",
          "args": [
            "roles_is_member_of(member)",
            "role"
          ],
          "line": 4946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roles_is_member_of",
          "args": [
            "member"
          ],
          "line": 4946
        },
        "resolved": true,
        "details": {
          "function_name": "roles_is_member_of",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4830-4897",
          "snippet": "static List *\nroles_is_member_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_membership_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_member_role) && cached_member_role == roleid)\n\t\treturn cached_membership_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_membership_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_member_role = InvalidOid;\t/* just paranoia */\n\tlist_free(cached_membership_roles);\n\tcached_membership_roles = new_cached_membership_roles;\n\tcached_member_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_membership_roles;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tcached_member_role = InvalidOid;",
            "static List *cached_membership_roles = NIL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tcached_member_role = InvalidOid;\nstatic List *cached_membership_roles = NIL;\n\nstatic List *\nroles_is_member_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_membership_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_member_role) && cached_member_role == roleid)\n\t\treturn cached_membership_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_membership_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_member_role = InvalidOid;\t/* just paranoia */\n\tlist_free(cached_membership_roles);\n\tcached_membership_roles = new_cached_membership_roles;\n\tcached_member_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_membership_roles;\n}"
        }
      },
      {
        "call_info": {
          "callee": "superuser_arg",
          "args": [
            "member"
          ],
          "line": 4939
        },
        "resolved": true,
        "details": {
          "function_name": "superuser_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/misc/superuser.c",
          "lines": "56-97",
          "snippet": "bool\nsuperuser_arg(Oid roleid)\n{\n\tbool\t\tresult;\n\tHeapTuple\trtup;\n\n\t/* Quick out for cache hit */\n\tif (OidIsValid(last_roleid) && last_roleid == roleid)\n\t\treturn last_roleid_is_super;\n\n\t/* Special escape path in case you deleted all your users. */\n\tif (!IsUnderPostmaster && roleid == BOOTSTRAP_SUPERUSERID)\n\t\treturn true;\n\n\t/* OK, look up the information in pg_authid */\n\trtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(rtup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(rtup))->rolsuper;\n\t\tReleaseSysCache(rtup);\n\t}\n\telse\n\t{\n\t\t/* Report \"not superuser\" for invalid roleids */\n\t\tresult = false;\n\t}\n\n\t/* If first time through, set up callback for cache flushes */\n\tif (!roleid_callback_registered)\n\t{\n\t\tCacheRegisterSyscacheCallback(AUTHOID,\n\t\t\t\t\t\t\t\t\t  RoleidCallback,\n\t\t\t\t\t\t\t\t\t  (Datum) 0);\n\t\troleid_callback_registered = true;\n\t}\n\n\t/* Cache the result for next time */\n\tlast_roleid = roleid;\n\tlast_roleid_is_super = result;\n\n\treturn result;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tlast_roleid = InvalidOid;",
            "static bool last_roleid_is_super = false;",
            "static bool roleid_callback_registered = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"utils/syscache.h\"\n#include \"utils/inval.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic Oid\tlast_roleid = InvalidOid;\nstatic bool last_roleid_is_super = false;\nstatic bool roleid_callback_registered = false;\n\nbool\nsuperuser_arg(Oid roleid)\n{\n\tbool\t\tresult;\n\tHeapTuple\trtup;\n\n\t/* Quick out for cache hit */\n\tif (OidIsValid(last_roleid) && last_roleid == roleid)\n\t\treturn last_roleid_is_super;\n\n\t/* Special escape path in case you deleted all your users. */\n\tif (!IsUnderPostmaster && roleid == BOOTSTRAP_SUPERUSERID)\n\t\treturn true;\n\n\t/* OK, look up the information in pg_authid */\n\trtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(rtup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(rtup))->rolsuper;\n\t\tReleaseSysCache(rtup);\n\t}\n\telse\n\t{\n\t\t/* Report \"not superuser\" for invalid roleids */\n\t\tresult = false;\n\t}\n\n\t/* If first time through, set up callback for cache flushes */\n\tif (!roleid_callback_registered)\n\t{\n\t\tCacheRegisterSyscacheCallback(AUTHOID,\n\t\t\t\t\t\t\t\t\t  RoleidCallback,\n\t\t\t\t\t\t\t\t\t  (Datum) 0);\n\t\troleid_callback_registered = true;\n\t}\n\n\t/* Cache the result for next time */\n\tlast_roleid = roleid;\n\tlast_roleid_is_super = result;\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\nis_member_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_is_member_of(member), role);\n}"
  },
  {
    "function_name": "has_privs_of_role",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4907-4923",
    "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_member_oid",
          "args": [
            "roles_has_privs_of(member)",
            "role"
          ],
          "line": 4922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roles_has_privs_of",
          "args": [
            "member"
          ],
          "line": 4922
        },
        "resolved": true,
        "details": {
          "function_name": "roles_has_privs_of",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4747-4818",
          "snippet": "static List *\nroles_has_privs_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_privs_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_privs_role) && cached_privs_role == roleid)\n\t\treturn cached_privs_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Ignore non-inheriting roles */\n\t\tif (!has_rolinherit(memberid))\n\t\t\tcontinue;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_privs_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_privs_role = InvalidOid; /* just paranoia */\n\tlist_free(cached_privs_roles);\n\tcached_privs_roles = new_cached_privs_roles;\n\tcached_privs_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_privs_roles;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tcached_privs_role = InvalidOid;",
            "static List *cached_privs_roles = NIL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tcached_privs_role = InvalidOid;\nstatic List *cached_privs_roles = NIL;\n\nstatic List *\nroles_has_privs_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_privs_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_privs_role) && cached_privs_role == roleid)\n\t\treturn cached_privs_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Ignore non-inheriting roles */\n\t\tif (!has_rolinherit(memberid))\n\t\t\tcontinue;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_privs_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_privs_role = InvalidOid; /* just paranoia */\n\tlist_free(cached_privs_roles);\n\tcached_privs_roles = new_cached_privs_roles;\n\tcached_privs_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_privs_roles;\n}"
        }
      },
      {
        "call_info": {
          "callee": "superuser_arg",
          "args": [
            "member"
          ],
          "line": 4915
        },
        "resolved": true,
        "details": {
          "function_name": "superuser_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/misc/superuser.c",
          "lines": "56-97",
          "snippet": "bool\nsuperuser_arg(Oid roleid)\n{\n\tbool\t\tresult;\n\tHeapTuple\trtup;\n\n\t/* Quick out for cache hit */\n\tif (OidIsValid(last_roleid) && last_roleid == roleid)\n\t\treturn last_roleid_is_super;\n\n\t/* Special escape path in case you deleted all your users. */\n\tif (!IsUnderPostmaster && roleid == BOOTSTRAP_SUPERUSERID)\n\t\treturn true;\n\n\t/* OK, look up the information in pg_authid */\n\trtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(rtup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(rtup))->rolsuper;\n\t\tReleaseSysCache(rtup);\n\t}\n\telse\n\t{\n\t\t/* Report \"not superuser\" for invalid roleids */\n\t\tresult = false;\n\t}\n\n\t/* If first time through, set up callback for cache flushes */\n\tif (!roleid_callback_registered)\n\t{\n\t\tCacheRegisterSyscacheCallback(AUTHOID,\n\t\t\t\t\t\t\t\t\t  RoleidCallback,\n\t\t\t\t\t\t\t\t\t  (Datum) 0);\n\t\troleid_callback_registered = true;\n\t}\n\n\t/* Cache the result for next time */\n\tlast_roleid = roleid;\n\tlast_roleid_is_super = result;\n\n\treturn result;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tlast_roleid = InvalidOid;",
            "static bool last_roleid_is_super = false;",
            "static bool roleid_callback_registered = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"utils/syscache.h\"\n#include \"utils/inval.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic Oid\tlast_roleid = InvalidOid;\nstatic bool last_roleid_is_super = false;\nstatic bool roleid_callback_registered = false;\n\nbool\nsuperuser_arg(Oid roleid)\n{\n\tbool\t\tresult;\n\tHeapTuple\trtup;\n\n\t/* Quick out for cache hit */\n\tif (OidIsValid(last_roleid) && last_roleid == roleid)\n\t\treturn last_roleid_is_super;\n\n\t/* Special escape path in case you deleted all your users. */\n\tif (!IsUnderPostmaster && roleid == BOOTSTRAP_SUPERUSERID)\n\t\treturn true;\n\n\t/* OK, look up the information in pg_authid */\n\trtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(rtup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(rtup))->rolsuper;\n\t\tReleaseSysCache(rtup);\n\t}\n\telse\n\t{\n\t\t/* Report \"not superuser\" for invalid roleids */\n\t\tresult = false;\n\t}\n\n\t/* If first time through, set up callback for cache flushes */\n\tif (!roleid_callback_registered)\n\t{\n\t\tCacheRegisterSyscacheCallback(AUTHOID,\n\t\t\t\t\t\t\t\t\t  RoleidCallback,\n\t\t\t\t\t\t\t\t\t  (Datum) 0);\n\t\troleid_callback_registered = true;\n\t}\n\n\t/* Cache the result for next time */\n\tlast_roleid = roleid;\n\tlast_roleid_is_super = result;\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
  },
  {
    "function_name": "roles_is_member_of",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4830-4897",
    "snippet": "static List *\nroles_is_member_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_membership_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_member_role) && cached_member_role == roleid)\n\t\treturn cached_membership_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_membership_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_member_role = InvalidOid;\t/* just paranoia */\n\tlist_free(cached_membership_roles);\n\tcached_membership_roles = new_cached_membership_roles;\n\tcached_member_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_membership_roles;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tcached_member_role = InvalidOid;",
      "static List *cached_membership_roles = NIL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free",
          "args": [
            "cached_membership_roles"
          ],
          "line": 4891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_free",
          "args": [
            "roles_list"
          ],
          "line": 4885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "oldctx"
          ],
          "line": 4884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy",
          "args": [
            "roles_list"
          ],
          "line": 4883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "TopMemoryContext"
          ],
          "line": 4882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReleaseSysCacheList",
          "args": [
            "memlist"
          ],
          "line": 4876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_append_unique_oid",
          "args": [
            "roles_list",
            "otherid"
          ],
          "line": 4874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "tup"
          ],
          "line": 4867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheList1",
          "args": [
            "AUTHMEMMEMROLE",
            "ObjectIdGetDatum(memberid)"
          ],
          "line": 4862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "memberid"
          ],
          "line": 4863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lfirst_oid",
          "args": [
            "l"
          ],
          "line": 4857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "foreach",
          "args": [
            "l",
            "roles_list"
          ],
          "line": 4855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_make1_oid",
          "args": [
            "roleid"
          ],
          "line": 4853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OidIsValid",
          "args": [
            "cached_member_role"
          ],
          "line": 4839
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tcached_member_role = InvalidOid;\nstatic List *cached_membership_roles = NIL;\n\nstatic List *\nroles_is_member_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_membership_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_member_role) && cached_member_role == roleid)\n\t\treturn cached_membership_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_membership_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_member_role = InvalidOid;\t/* just paranoia */\n\tlist_free(cached_membership_roles);\n\tcached_membership_roles = new_cached_membership_roles;\n\tcached_member_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_membership_roles;\n}"
  },
  {
    "function_name": "roles_has_privs_of",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4747-4818",
    "snippet": "static List *\nroles_has_privs_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_privs_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_privs_role) && cached_privs_role == roleid)\n\t\treturn cached_privs_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Ignore non-inheriting roles */\n\t\tif (!has_rolinherit(memberid))\n\t\t\tcontinue;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_privs_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_privs_role = InvalidOid; /* just paranoia */\n\tlist_free(cached_privs_roles);\n\tcached_privs_roles = new_cached_privs_roles;\n\tcached_privs_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_privs_roles;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tcached_privs_role = InvalidOid;",
      "static List *cached_privs_roles = NIL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free",
          "args": [
            "cached_privs_roles"
          ],
          "line": 4812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_free",
          "args": [
            "roles_list"
          ],
          "line": 4806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "oldctx"
          ],
          "line": 4805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy",
          "args": [
            "roles_list"
          ],
          "line": 4804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "TopMemoryContext"
          ],
          "line": 4803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReleaseSysCacheList",
          "args": [
            "memlist"
          ],
          "line": 4797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_append_unique_oid",
          "args": [
            "roles_list",
            "otherid"
          ],
          "line": 4795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "tup"
          ],
          "line": 4788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheList1",
          "args": [
            "AUTHMEMMEMROLE",
            "ObjectIdGetDatum(memberid)"
          ],
          "line": 4783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "memberid"
          ],
          "line": 4784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_rolinherit",
          "args": [
            "memberid"
          ],
          "line": 4779
        },
        "resolved": true,
        "details": {
          "function_name": "has_rolinherit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4717-4730",
          "snippet": "static bool\nhas_rolinherit(Oid roleid)\n{\n\tbool\t\tresult = false;\n\tHeapTuple\tutup;\n\n\tutup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(utup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(utup))->rolinherit;\n\t\tReleaseSysCache(utup);\n\t}\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool\nhas_rolinherit(Oid roleid)\n{\n\tbool\t\tresult = false;\n\tHeapTuple\tutup;\n\n\tutup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(utup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(utup))->rolinherit;\n\t\tReleaseSysCache(utup);\n\t}\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lfirst_oid",
          "args": [
            "l"
          ],
          "line": 4774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "foreach",
          "args": [
            "l",
            "roles_list"
          ],
          "line": 4772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_make1_oid",
          "args": [
            "roleid"
          ],
          "line": 4770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OidIsValid",
          "args": [
            "cached_privs_role"
          ],
          "line": 4756
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tcached_privs_role = InvalidOid;\nstatic List *cached_privs_roles = NIL;\n\nstatic List *\nroles_has_privs_of(Oid roleid)\n{\n\tList\t   *roles_list;\n\tListCell   *l;\n\tList\t   *new_cached_privs_roles;\n\tMemoryContext oldctx;\n\n\t/* If cache is already valid, just return the list */\n\tif (OidIsValid(cached_privs_role) && cached_privs_role == roleid)\n\t\treturn cached_privs_roles;\n\n\t/*\n\t * Find all the roles that roleid is a member of, including multi-level\n\t * recursion.  The role itself will always be the first element of the\n\t * resulting list.\n\t *\n\t * Each element of the list is scanned to see if it adds any indirect\n\t * memberships.  We can use a single list as both the record of\n\t * already-found memberships and the agenda of roles yet to be scanned.\n\t * This is a bit tricky but works because the foreach() macro doesn't\n\t * fetch the next list element until the bottom of the loop.\n\t */\n\troles_list = list_make1_oid(roleid);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Ignore non-inheriting roles */\n\t\tif (!has_rolinherit(memberid))\n\t\t\tcontinue;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\t/*\n\t\t\t * Even though there shouldn't be any loops in the membership\n\t\t\t * graph, we must test for having already seen this role. It is\n\t\t\t * legal for instance to have both A->B and A->C->B.\n\t\t\t */\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t}\n\n\t/*\n\t * Copy the completed list into TopMemoryContext so it will persist.\n\t */\n\toldctx = MemoryContextSwitchTo(TopMemoryContext);\n\tnew_cached_privs_roles = list_copy(roles_list);\n\tMemoryContextSwitchTo(oldctx);\n\tlist_free(roles_list);\n\n\t/*\n\t * Now safe to assign to state variable\n\t */\n\tcached_privs_role = InvalidOid; /* just paranoia */\n\tlist_free(cached_privs_roles);\n\tcached_privs_roles = new_cached_privs_roles;\n\tcached_privs_role = roleid;\n\n\t/* And now we can return the answer */\n\treturn cached_privs_roles;\n}"
  },
  {
    "function_name": "has_rolinherit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4717-4730",
    "snippet": "static bool\nhas_rolinherit(Oid roleid)\n{\n\tbool\t\tresult = false;\n\tHeapTuple\tutup;\n\n\tutup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(utup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(utup))->rolinherit;\n\t\tReleaseSysCache(utup);\n\t}\n\treturn result;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "utup"
          ],
          "line": 4727
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "utup"
          ],
          "line": 4726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "utup"
          ],
          "line": 4724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCache1",
          "args": [
            "AUTHOID",
            "ObjectIdGetDatum(roleid)"
          ],
          "line": 4723
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCache1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1111-1120",
          "snippet": "HeapTuple\nSearchSysCache1(int cacheId,\n\t\t\t\tDatum key1)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 1);\n\n\treturn SearchCatCache1(SysCache[cacheId], key1);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static CatCache *SysCache[SysCacheSize];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache1(int cacheId,\n\t\t\t\tDatum key1)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 1);\n\n\treturn SearchCatCache1(SysCache[cacheId], key1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "roleid"
          ],
          "line": 4723
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool\nhas_rolinherit(Oid roleid)\n{\n\tbool\t\tresult = false;\n\tHeapTuple\tutup;\n\n\tutup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(roleid));\n\tif (HeapTupleIsValid(utup))\n\t{\n\t\tresult = ((Form_pg_authid) GETSTRUCT(utup))->rolinherit;\n\t\tReleaseSysCache(utup);\n\t}\n\treturn result;\n}"
  },
  {
    "function_name": "RoleMembershipCacheCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4707-4713",
    "snippet": "static void\nRoleMembershipCacheCallback(Datum arg, int cacheid, uint32 hashvalue)\n{\n\t/* Force membership caches to be recomputed on next use */\n\tcached_privs_role = InvalidOid;\n\tcached_member_role = InvalidOid;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tcached_privs_role = InvalidOid;",
      "static Oid\tcached_member_role = InvalidOid;",
      "static void RoleMembershipCacheCallback(Datum arg, int cacheid, uint32 hashvalue);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tcached_privs_role = InvalidOid;\nstatic Oid\tcached_member_role = InvalidOid;\nstatic void RoleMembershipCacheCallback(Datum arg, int cacheid, uint32 hashvalue);\n\nstatic void\nRoleMembershipCacheCallback(Datum arg, int cacheid, uint32 hashvalue)\n{\n\t/* Force membership caches to be recomputed on next use */\n\tcached_privs_role = InvalidOid;\n\tcached_member_role = InvalidOid;\n}"
  },
  {
    "function_name": "initialize_acl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4688-4701",
    "snippet": "void\ninitialize_acl(void)\n{\n\tif (!IsBootstrapProcessingMode())\n\t{\n\t\t/*\n\t\t * In normal mode, set a callback on any syscache invalidation of\n\t\t * pg_auth_members rows\n\t\t */\n\t\tCacheRegisterSyscacheCallback(AUTHMEMROLEMEM,\n\t\t\t\t\t\t\t\t\t  RoleMembershipCacheCallback,\n\t\t\t\t\t\t\t\t\t  (Datum) 0);\n\t}\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "CacheRegisterSyscacheCallback",
          "args": [
            "AUTHMEMROLEMEM",
            "RoleMembershipCacheCallback",
            "(Datum) 0"
          ],
          "line": 4697
        },
        "resolved": true,
        "details": {
          "function_name": "CacheRegisterSyscacheCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/inval.c",
          "lines": "1425-1456",
          "snippet": "void\nCacheRegisterSyscacheCallback(int cacheid,\n\t\t\t\t\t\t\t  SyscacheCallbackFunction func,\n\t\t\t\t\t\t\t  Datum arg)\n{\n\tif (cacheid < 0 || cacheid >= SysCacheSize)\n\t\telog(FATAL, \"invalid cache ID: %d\", cacheid);\n\tif (syscache_callback_count >= MAX_SYSCACHE_CALLBACKS)\n\t\telog(FATAL, \"out of syscache_callback_list slots\");\n\n\tif (syscache_callback_links[cacheid] == 0)\n\t{\n\t\t/* first callback for this cache */\n\t\tsyscache_callback_links[cacheid] = syscache_callback_count + 1;\n\t}\n\telse\n\t{\n\t\t/* add to end of chain, so that older callbacks are called first */\n\t\tint\t\t\ti = syscache_callback_links[cacheid] - 1;\n\n\t\twhile (syscache_callback_list[i].link > 0)\n\t\t\ti = syscache_callback_list[i].link - 1;\n\t\tsyscache_callback_list[i].link = syscache_callback_count + 1;\n\t}\n\n\tsyscache_callback_list[syscache_callback_count].id = cacheid;\n\tsyscache_callback_list[syscache_callback_count].link = 0;\n\tsyscache_callback_list[syscache_callback_count].function = func;\n\tsyscache_callback_list[syscache_callback_count].arg = arg;\n\n\t++syscache_callback_count;\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/snapmgr.h\"",
            "#include \"utils/relmapper.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"storage/smgr.h\"",
            "#include \"storage/sinval.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/htup_details.h\"",
            "#include <limits.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [
            "#define MAX_SYSCACHE_CALLBACKS 64"
          ],
          "globals_used": [
            "static struct SYSCACHECALLBACK\n{\n\tint16\t\tid;\t\t\t\t/* cache number */\n\tint16\t\tlink;\t\t\t/* next callback index+1 for same cache */\n\tSyscacheCallbackFunction function;\n\tDatum\t\targ;\n}\t\t\tsyscache_callback_list[MAX_SYSCACHE_CALLBACKS];",
            "static int16 syscache_callback_links[SysCacheSize];",
            "static int\tsyscache_callback_count = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/snapmgr.h\"\n#include \"utils/relmapper.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"storage/smgr.h\"\n#include \"storage/sinval.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/catalog.h\"\n#include \"access/xact.h\"\n#include \"access/htup_details.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\n#define MAX_SYSCACHE_CALLBACKS 64\n\nstatic struct SYSCACHECALLBACK\n{\n\tint16\t\tid;\t\t\t\t/* cache number */\n\tint16\t\tlink;\t\t\t/* next callback index+1 for same cache */\n\tSyscacheCallbackFunction function;\n\tDatum\t\targ;\n}\t\t\tsyscache_callback_list[MAX_SYSCACHE_CALLBACKS];\nstatic int16 syscache_callback_links[SysCacheSize];\nstatic int\tsyscache_callback_count = 0;\n\nvoid\nCacheRegisterSyscacheCallback(int cacheid,\n\t\t\t\t\t\t\t  SyscacheCallbackFunction func,\n\t\t\t\t\t\t\t  Datum arg)\n{\n\tif (cacheid < 0 || cacheid >= SysCacheSize)\n\t\telog(FATAL, \"invalid cache ID: %d\", cacheid);\n\tif (syscache_callback_count >= MAX_SYSCACHE_CALLBACKS)\n\t\telog(FATAL, \"out of syscache_callback_list slots\");\n\n\tif (syscache_callback_links[cacheid] == 0)\n\t{\n\t\t/* first callback for this cache */\n\t\tsyscache_callback_links[cacheid] = syscache_callback_count + 1;\n\t}\n\telse\n\t{\n\t\t/* add to end of chain, so that older callbacks are called first */\n\t\tint\t\t\ti = syscache_callback_links[cacheid] - 1;\n\n\t\twhile (syscache_callback_list[i].link > 0)\n\t\t\ti = syscache_callback_list[i].link - 1;\n\t\tsyscache_callback_list[i].link = syscache_callback_count + 1;\n\t}\n\n\tsyscache_callback_list[syscache_callback_count].id = cacheid;\n\tsyscache_callback_list[syscache_callback_count].link = 0;\n\tsyscache_callback_list[syscache_callback_count].function = func;\n\tsyscache_callback_list[syscache_callback_count].arg = arg;\n\n\t++syscache_callback_count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsBootstrapProcessingMode",
          "args": [],
          "line": 4691
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nvoid\ninitialize_acl(void)\n{\n\tif (!IsBootstrapProcessingMode())\n\t{\n\t\t/*\n\t\t * In normal mode, set a callback on any syscache invalidation of\n\t\t * pg_auth_members rows\n\t\t */\n\t\tCacheRegisterSyscacheCallback(AUTHMEMROLEMEM,\n\t\t\t\t\t\t\t\t\t  RoleMembershipCacheCallback,\n\t\t\t\t\t\t\t\t\t  (Datum) 0);\n\t}\n}"
  },
  {
    "function_name": "pg_role_aclcheck",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4658-4682",
    "snippet": "static AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "roleid",
            "role_oid"
          ],
          "line": 4678
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_member_of_role",
          "args": [
            "roleid",
            "role_oid"
          ],
          "line": 4673
        },
        "resolved": true,
        "details": {
          "function_name": "is_member_of_role_nosuper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4969-4981",
          "snippet": "bool\nis_member_of_role_nosuper(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_is_member_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\nis_member_of_role_nosuper(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_is_member_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_admin_of_role",
          "args": [
            "roleid",
            "role_oid"
          ],
          "line": 4668
        },
        "resolved": true,
        "details": {
          "function_name": "is_admin_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4989-5071",
          "snippet": "bool\nis_admin_of_role(Oid member, Oid role)\n{\n\tbool\t\tresult = false;\n\tList\t   *roles_list;\n\tListCell   *l;\n\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\tif (member == role)\n\n\t\t/*\n\t\t * A role can admin itself when it matches the session user and we're\n\t\t * outside any security-restricted operation, SECURITY DEFINER or\n\t\t * similar context.  SQL-standard roles cannot self-admin.  However,\n\t\t * SQL-standard users are distinct from roles, and they are not\n\t\t * grantable like roles: PostgreSQL's role-user duality extends the\n\t\t * standard.  Checking for a session user match has the effect of\n\t\t * letting a role self-admin only when it's conspicuously behaving\n\t\t * like a user.  Note that allowing self-admin under a mere SET ROLE\n\t\t * would make WITH ADMIN OPTION largely irrelevant; any member could\n\t\t * SET ROLE to issue the otherwise-forbidden command.\n\t\t *\n\t\t * Withholding self-admin in a security-restricted operation prevents\n\t\t * object owners from harnessing the session user identity during\n\t\t * administrative maintenance.  Suppose Alice owns a database, has\n\t\t * issued \"GRANT alice TO bob\", and runs a daily ANALYZE.  Bob creates\n\t\t * an alice-owned SECURITY DEFINER function that issues \"REVOKE alice\n\t\t * FROM carol\".  If he creates an expression index calling that\n\t\t * function, Alice will attempt the REVOKE during each ANALYZE.\n\t\t * Checking InSecurityRestrictedOperation() thwarts that attack.\n\t\t *\n\t\t * Withholding self-admin in SECURITY DEFINER functions makes their\n\t\t * behavior independent of the calling user.  There's no security or\n\t\t * SQL-standard-conformance need for that restriction, though.\n\t\t *\n\t\t * A role cannot have actual WITH ADMIN OPTION on itself, because that\n\t\t * would imply a membership loop.  Therefore, we're done either way.\n\t\t */\n\t\treturn member == GetSessionUserId() &&\n\t\t\t!InLocalUserIdChange() && !InSecurityRestrictedOperation();\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion.  We build a list in the same way that is_member_of_role does\n\t * to track visited and unvisited roles.\n\t */\n\troles_list = list_make1_oid(member);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\tif (otherid == role &&\n\t\t\t\t((Form_pg_auth_members) GETSTRUCT(tup))->admin_option)\n\t\t\t{\n\t\t\t\t/* Found what we came for, so can stop searching */\n\t\t\t\tresult = true;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t\tif (result)\n\t\t\tbreak;\n\t}\n\n\tlist_free(roles_list);\n\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);\n\nbool\nis_admin_of_role(Oid member, Oid role)\n{\n\tbool\t\tresult = false;\n\tList\t   *roles_list;\n\tListCell   *l;\n\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\tif (member == role)\n\n\t\t/*\n\t\t * A role can admin itself when it matches the session user and we're\n\t\t * outside any security-restricted operation, SECURITY DEFINER or\n\t\t * similar context.  SQL-standard roles cannot self-admin.  However,\n\t\t * SQL-standard users are distinct from roles, and they are not\n\t\t * grantable like roles: PostgreSQL's role-user duality extends the\n\t\t * standard.  Checking for a session user match has the effect of\n\t\t * letting a role self-admin only when it's conspicuously behaving\n\t\t * like a user.  Note that allowing self-admin under a mere SET ROLE\n\t\t * would make WITH ADMIN OPTION largely irrelevant; any member could\n\t\t * SET ROLE to issue the otherwise-forbidden command.\n\t\t *\n\t\t * Withholding self-admin in a security-restricted operation prevents\n\t\t * object owners from harnessing the session user identity during\n\t\t * administrative maintenance.  Suppose Alice owns a database, has\n\t\t * issued \"GRANT alice TO bob\", and runs a daily ANALYZE.  Bob creates\n\t\t * an alice-owned SECURITY DEFINER function that issues \"REVOKE alice\n\t\t * FROM carol\".  If he creates an expression index calling that\n\t\t * function, Alice will attempt the REVOKE during each ANALYZE.\n\t\t * Checking InSecurityRestrictedOperation() thwarts that attack.\n\t\t *\n\t\t * Withholding self-admin in SECURITY DEFINER functions makes their\n\t\t * behavior independent of the calling user.  There's no security or\n\t\t * SQL-standard-conformance need for that restriction, though.\n\t\t *\n\t\t * A role cannot have actual WITH ADMIN OPTION on itself, because that\n\t\t * would imply a membership loop.  Therefore, we're done either way.\n\t\t */\n\t\treturn member == GetSessionUserId() &&\n\t\t\t!InLocalUserIdChange() && !InSecurityRestrictedOperation();\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion.  We build a list in the same way that is_member_of_role does\n\t * to track visited and unvisited roles.\n\t */\n\troles_list = list_make1_oid(member);\n\n\tforeach(l, roles_list)\n\t{\n\t\tOid\t\t\tmemberid = lfirst_oid(l);\n\t\tCatCList   *memlist;\n\t\tint\t\t\ti;\n\n\t\t/* Find roles that memberid is directly a member of */\n\t\tmemlist = SearchSysCacheList1(AUTHMEMMEMROLE,\n\t\t\t\t\t\t\t\t\t  ObjectIdGetDatum(memberid));\n\t\tfor (i = 0; i < memlist->n_members; i++)\n\t\t{\n\t\t\tHeapTuple\ttup = &memlist->members[i]->tuple;\n\t\t\tOid\t\t\totherid = ((Form_pg_auth_members) GETSTRUCT(tup))->roleid;\n\n\t\t\tif (otherid == role &&\n\t\t\t\t((Form_pg_auth_members) GETSTRUCT(tup))->admin_option)\n\t\t\t{\n\t\t\t\t/* Found what we came for, so can stop searching */\n\t\t\t\tresult = true;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\troles_list = list_append_unique_oid(roles_list, otherid);\n\t\t}\n\t\tReleaseSysCacheList(memlist);\n\t\tif (result)\n\t\t\tbreak;\n\t}\n\n\tlist_free(roles_list);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CREATE"
          ],
          "line": 4661
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}"
  },
  {
    "function_name": "convert_role_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4638-4652",
    "snippet": "static AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "role_priv_map"
          ],
          "line": 4651
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CREATE"
          ],
          "line": 4647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CREATE"
          ],
          "line": 4646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CREATE"
          ],
          "line": 4645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CREATE"
          ],
          "line": 4644
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}"
  },
  {
    "function_name": "pg_has_role_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4608-4622",
    "snippet": "Datum\npg_has_role_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\troleoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_role_aclcheck",
          "args": [
            "roleoid",
            "roleid",
            "mode"
          ],
          "line": 4619
        },
        "resolved": true,
        "details": {
          "function_name": "pg_role_aclcheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4658-4682",
          "snippet": "static AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_role_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4617
        },
        "resolved": true,
        "details": {
          "function_name": "convert_role_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4638-4652",
          "snippet": "static AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 4612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4611
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\npg_has_role_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\troleoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "pg_has_role_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4585-4601",
    "snippet": "Datum\npg_has_role_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tName\t\trolename = PG_GETARG_NAME(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleoid = get_role_oid(NameStr(*rolename), false);\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_role_aclcheck",
          "args": [
            "roleoid",
            "roleid",
            "mode"
          ],
          "line": 4598
        },
        "resolved": true,
        "details": {
          "function_name": "pg_role_aclcheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4658-4682",
          "snippet": "static AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_role_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4596
        },
        "resolved": true,
        "details": {
          "function_name": "convert_role_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4638-4652",
          "snippet": "static AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid",
          "args": [
            "NameStr(*rolename)",
            "false"
          ],
          "line": 4595
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5190-5201",
          "snippet": "Oid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nOid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*rolename"
          ],
          "line": 4595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "1"
          ],
          "line": 4589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\npg_has_role_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tName\t\trolename = PG_GETARG_NAME(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleoid = get_role_oid(NameStr(*rolename), false);\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "pg_has_role_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4563-4578",
    "snippet": "Datum\npg_has_role_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_role_aclcheck",
          "args": [
            "roleoid",
            "roleid",
            "mode"
          ],
          "line": 4575
        },
        "resolved": true,
        "details": {
          "function_name": "pg_role_aclcheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4658-4682",
          "snippet": "static AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_role_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4573
        },
        "resolved": true,
        "details": {
          "function_name": "convert_role_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4638-4652",
          "snippet": "static AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 4572
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4566
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\npg_has_role_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "pg_has_role_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4539-4555",
    "snippet": "Datum\npg_has_role_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\troleoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid(NameStr(*username), false);\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_role_aclcheck",
          "args": [
            "roleoid",
            "roleid",
            "mode"
          ],
          "line": 4552
        },
        "resolved": true,
        "details": {
          "function_name": "pg_role_aclcheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4658-4682",
          "snippet": "static AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_role_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4550
        },
        "resolved": true,
        "details": {
          "function_name": "convert_role_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4638-4652",
          "snippet": "static AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid",
          "args": [
            "NameStr(*username)",
            "false"
          ],
          "line": 4549
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5190-5201",
          "snippet": "Oid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nOid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 4549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 4543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 4542
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\npg_has_role_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\troleoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid(NameStr(*username), false);\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "pg_has_role_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4515-4532",
    "snippet": "Datum\npg_has_role_name(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\troleoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\troleoid = get_role_oid(NameStr(*rolename), false);\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_role_aclcheck",
          "args": [
            "roleoid",
            "roleid",
            "mode"
          ],
          "line": 4529
        },
        "resolved": true,
        "details": {
          "function_name": "pg_role_aclcheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4658-4682",
          "snippet": "static AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_role_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4527
        },
        "resolved": true,
        "details": {
          "function_name": "convert_role_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4638-4652",
          "snippet": "static AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid",
          "args": [
            "NameStr(*rolename)",
            "false"
          ],
          "line": 4526
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5190-5201",
          "snippet": "Oid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nOid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*rolename"
          ],
          "line": 4526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 4525
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 4518
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\npg_has_role_name(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\troleoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\troleoid = get_role_oid(NameStr(*rolename), false);\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "pg_has_role_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4489-4507",
    "snippet": "Datum\npg_has_role_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tName\t\trolename = PG_GETARG_NAME(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\troleoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid(NameStr(*username), false);\n\troleoid = get_role_oid(NameStr(*rolename), false);\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_role_aclcheck",
          "args": [
            "roleoid",
            "roleid",
            "mode"
          ],
          "line": 4504
        },
        "resolved": true,
        "details": {
          "function_name": "pg_role_aclcheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4658-4682",
          "snippet": "static AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic AclResult\npg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode)\n{\n\tif (mode & ACL_GRANT_OPTION_FOR(ACL_CREATE))\n\t{\n\t\t/*\n\t\t * XXX For roleid == role_oid, is_admin_of_role() also examines the\n\t\t * session and call stack.  That suits two-argument pg_has_role(), but\n\t\t * it gives the three-argument version a lamentable whimsy.\n\t\t */\n\t\tif (is_admin_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_CREATE)\n\t{\n\t\tif (is_member_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\tif (mode & ACL_USAGE)\n\t{\n\t\tif (has_privs_of_role(roleid, role_oid))\n\t\t\treturn ACLCHECK_OK;\n\t}\n\treturn ACLCHECK_NO_PRIV;\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_role_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4502
        },
        "resolved": true,
        "details": {
          "function_name": "convert_role_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4638-4652",
          "snippet": "static AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_role_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map role_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"MEMBER\", ACL_CREATE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"MEMBER WITH ADMIN OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, role_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid",
          "args": [
            "NameStr(*rolename)",
            "false"
          ],
          "line": 4501
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5190-5201",
          "snippet": "Oid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nOid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*rolename"
          ],
          "line": 4501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 4500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "1"
          ],
          "line": 4493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 4492
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\npg_has_role_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tName\t\trolename = PG_GETARG_NAME(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\troleoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid(NameStr(*username), false);\n\troleoid = get_role_oid(NameStr(*rolename), false);\n\tmode = convert_role_priv_string(priv_type_text);\n\n\taclresult = pg_role_aclcheck(roleoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_type_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4461-4471",
    "snippet": "static AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "type_priv_map"
          ],
          "line": 4470
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_USAGE"
          ],
          "line": 4466
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}"
  },
  {
    "function_name": "convert_type_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4440-4455",
    "snippet": "static Oid\nconvert_type_name(text *typename)\n{\n\tchar\t   *typname = text_to_cstring(typename);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regtypein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(typname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"type \\\"%s\\\" does not exist\", typname)));\n\n\treturn oid;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static Oid\tconvert_type_name(text *typename);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"type \\\"%s\\\" does not exist\", typname))"
          ],
          "line": 4450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"type \\\"%s\\\" does not exist\"",
            "typname"
          ],
          "line": 4452
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_UNDEFINED_OBJECT"
          ],
          "line": 4451
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "OidIsValid",
          "args": [
            "oid"
          ],
          "line": 4449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetObjectId",
          "args": [
            "DirectFunctionCall1(regtypein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(typname))"
          ],
          "line": 4446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectFunctionCall1",
          "args": [
            "regtypein",
            "CStringGetDatum(typname)"
          ],
          "line": 4446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "typname"
          ],
          "line": 4447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "typename"
          ],
          "line": 4443
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_type_name(text *typename);\n\nstatic Oid\nconvert_type_name(text *typename)\n{\n\tchar\t   *typname = text_to_cstring(typename);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regtypein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(typname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"type \\\"%s\\\" does not exist\", typname)));\n\n\treturn oid;\n}"
  },
  {
    "function_name": "has_type_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4414-4431",
    "snippet": "Datum\nhas_type_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttypeoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_type_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TYPEOID, ObjectIdGetDatum(typeoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_type_aclcheck",
          "args": [
            "typeoid",
            "roleid",
            "mode"
          ],
          "line": 4428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 4426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "TYPEOID",
            "ObjectIdGetDatum(typeoid)"
          ],
          "line": 4425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "typeoid"
          ],
          "line": 4425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_type_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4423
        },
        "resolved": true,
        "details": {
          "function_name": "convert_type_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4461-4471",
          "snippet": "static AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 4418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4417
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_type_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttypeoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_type_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TYPEOID, ObjectIdGetDatum(typeoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_type_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4391-4407",
    "snippet": "Datum\nhas_type_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *typename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\ttypeoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\ttypeoid = convert_type_name(typename);\n\tmode = convert_type_priv_string(priv_type_text);\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static Oid\tconvert_type_name(text *typename);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_type_aclcheck",
          "args": [
            "typeoid",
            "roleid",
            "mode"
          ],
          "line": 4404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_type_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4402
        },
        "resolved": true,
        "details": {
          "function_name": "convert_type_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4461-4471",
          "snippet": "static AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_type_name",
          "args": [
            "typename"
          ],
          "line": 4401
        },
        "resolved": true,
        "details": {
          "function_name": "convert_type_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4440-4455",
          "snippet": "static Oid\nconvert_type_name(text *typename)\n{\n\tchar\t   *typname = text_to_cstring(typename);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regtypein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(typname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"type \\\"%s\\\" does not exist\", typname)));\n\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_type_name(text *typename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_type_name(text *typename);\n\nstatic Oid\nconvert_type_name(text *typename)\n{\n\tchar\t   *typname = text_to_cstring(typename);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regtypein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(typname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"type \\\"%s\\\" does not exist\", typname)));\n\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4394
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic Oid\tconvert_type_name(text *typename);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_type_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *typename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\ttypeoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\ttypeoid = convert_type_name(typename);\n\tmode = convert_type_priv_string(priv_type_text);\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_type_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4366-4384",
    "snippet": "Datum\nhas_type_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttypeoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_type_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TYPEOID, ObjectIdGetDatum(typeoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_type_aclcheck",
          "args": [
            "typeoid",
            "roleid",
            "mode"
          ],
          "line": 4381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 4379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "TYPEOID",
            "ObjectIdGetDatum(typeoid)"
          ],
          "line": 4378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "typeoid"
          ],
          "line": 4378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_type_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4376
        },
        "resolved": true,
        "details": {
          "function_name": "convert_type_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4461-4471",
          "snippet": "static AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 4375
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4369
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_type_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttypeoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_type_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TYPEOID, ObjectIdGetDatum(typeoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_type_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4339-4358",
    "snippet": "Datum\nhas_type_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttypeoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_type_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TYPEOID, ObjectIdGetDatum(typeoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_type_aclcheck",
          "args": [
            "typeoid",
            "roleid",
            "mode"
          ],
          "line": 4355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 4353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "TYPEOID",
            "ObjectIdGetDatum(typeoid)"
          ],
          "line": 4352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "typeoid"
          ],
          "line": 4352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_type_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4350
        },
        "resolved": true,
        "details": {
          "function_name": "convert_type_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4461-4471",
          "snippet": "static AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 4349
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 4349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 4343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 4342
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_type_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttypeoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_type_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TYPEOID, ObjectIdGetDatum(typeoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_type_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4315-4332",
    "snippet": "Datum\nhas_type_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *typename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\ttypeoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\ttypeoid = convert_type_name(typename);\n\tmode = convert_type_priv_string(priv_type_text);\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static Oid\tconvert_type_name(text *typename);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_type_aclcheck",
          "args": [
            "typeoid",
            "roleid",
            "mode"
          ],
          "line": 4329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_type_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4327
        },
        "resolved": true,
        "details": {
          "function_name": "convert_type_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4461-4471",
          "snippet": "static AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_type_name",
          "args": [
            "typename"
          ],
          "line": 4326
        },
        "resolved": true,
        "details": {
          "function_name": "convert_type_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4440-4455",
          "snippet": "static Oid\nconvert_type_name(text *typename)\n{\n\tchar\t   *typname = text_to_cstring(typename);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regtypein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(typname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"type \\\"%s\\\" does not exist\", typname)));\n\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_type_name(text *typename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_type_name(text *typename);\n\nstatic Oid\nconvert_type_name(text *typename)\n{\n\tchar\t   *typname = text_to_cstring(typename);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regtypein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(typname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"type \\\"%s\\\" does not exist\", typname)));\n\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 4325
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 4318
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic Oid\tconvert_type_name(text *typename);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_type_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *typename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\ttypeoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\ttypeoid = convert_type_name(typename);\n\tmode = convert_type_priv_string(priv_type_text);\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_type_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4289-4307",
    "snippet": "Datum\nhas_type_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *typename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttypeoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\ttypeoid = convert_type_name(typename);\n\tmode = convert_type_priv_string(priv_type_text);\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static Oid\tconvert_type_name(text *typename);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_type_aclcheck",
          "args": [
            "typeoid",
            "roleid",
            "mode"
          ],
          "line": 4304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_type_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4302
        },
        "resolved": true,
        "details": {
          "function_name": "convert_type_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4461-4471",
          "snippet": "static AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_type_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map type_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, type_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_type_name",
          "args": [
            "typename"
          ],
          "line": 4301
        },
        "resolved": true,
        "details": {
          "function_name": "convert_type_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4440-4455",
          "snippet": "static Oid\nconvert_type_name(text *typename)\n{\n\tchar\t   *typname = text_to_cstring(typename);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regtypein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(typname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"type \\\"%s\\\" does not exist\", typname)));\n\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_type_name(text *typename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_type_name(text *typename);\n\nstatic Oid\nconvert_type_name(text *typename)\n{\n\tchar\t   *typname = text_to_cstring(typename);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regtypein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(typname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"type \\\"%s\\\" does not exist\", typname)));\n\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 4300
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 4300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 4292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic Oid\tconvert_type_name(text *typename);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_type_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *typename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttypeoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\ttypeoid = convert_type_name(typename);\n\tmode = convert_type_priv_string(priv_type_text);\n\n\taclresult = pg_type_aclcheck(typeoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_tablespace_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4262-4272",
    "snippet": "static AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "tablespace_priv_map"
          ],
          "line": 4271
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CREATE"
          ],
          "line": 4267
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}"
  },
  {
    "function_name": "convert_tablespace_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4250-4256",
    "snippet": "static Oid\nconvert_tablespace_name(text *tablespacename)\n{\n\tchar\t   *spcname = text_to_cstring(tablespacename);\n\n\treturn get_tablespace_oid(spcname, false);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tconvert_tablespace_name(text *tablespacename);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_tablespace_oid",
          "args": [
            "spcname",
            "false"
          ],
          "line": 4255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "tablespacename"
          ],
          "line": 4253
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_tablespace_name(text *tablespacename);\n\nstatic Oid\nconvert_tablespace_name(text *tablespacename)\n{\n\tchar\t   *spcname = text_to_cstring(tablespacename);\n\n\treturn get_tablespace_oid(spcname, false);\n}"
  },
  {
    "function_name": "has_tablespace_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4224-4241",
    "snippet": "Datum\nhas_tablespace_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttablespaceoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TABLESPACEOID, ObjectIdGetDatum(tablespaceoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_tablespace_aclcheck",
          "args": [
            "tablespaceoid",
            "roleid",
            "mode"
          ],
          "line": 4238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 4236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "TABLESPACEOID",
            "ObjectIdGetDatum(tablespaceoid)"
          ],
          "line": 4235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tablespaceoid"
          ],
          "line": 4235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_tablespace_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4233
        },
        "resolved": true,
        "details": {
          "function_name": "convert_tablespace_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4262-4272",
          "snippet": "static AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 4228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_tablespace_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttablespaceoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TABLESPACEOID, ObjectIdGetDatum(tablespaceoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_tablespace_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4201-4217",
    "snippet": "Datum\nhas_tablespace_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *tablespacename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\ttablespaceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\ttablespaceoid = convert_tablespace_name(tablespacename);\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static Oid\tconvert_tablespace_name(text *tablespacename);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_tablespace_aclcheck",
          "args": [
            "tablespaceoid",
            "roleid",
            "mode"
          ],
          "line": 4214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_tablespace_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4212
        },
        "resolved": true,
        "details": {
          "function_name": "convert_tablespace_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4262-4272",
          "snippet": "static AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_tablespace_name",
          "args": [
            "tablespacename"
          ],
          "line": 4211
        },
        "resolved": true,
        "details": {
          "function_name": "convert_tablespace_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4250-4256",
          "snippet": "static Oid\nconvert_tablespace_name(text *tablespacename)\n{\n\tchar\t   *spcname = text_to_cstring(tablespacename);\n\n\treturn get_tablespace_oid(spcname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_tablespace_name(text *tablespacename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_tablespace_name(text *tablespacename);\n\nstatic Oid\nconvert_tablespace_name(text *tablespacename)\n{\n\tchar\t   *spcname = text_to_cstring(tablespacename);\n\n\treturn get_tablespace_oid(spcname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic Oid\tconvert_tablespace_name(text *tablespacename);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_tablespace_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *tablespacename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\ttablespaceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\ttablespaceoid = convert_tablespace_name(tablespacename);\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_tablespace_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4176-4194",
    "snippet": "Datum\nhas_tablespace_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttablespaceoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TABLESPACEOID, ObjectIdGetDatum(tablespaceoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_tablespace_aclcheck",
          "args": [
            "tablespaceoid",
            "roleid",
            "mode"
          ],
          "line": 4191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 4189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "TABLESPACEOID",
            "ObjectIdGetDatum(tablespaceoid)"
          ],
          "line": 4188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tablespaceoid"
          ],
          "line": 4188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_tablespace_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4186
        },
        "resolved": true,
        "details": {
          "function_name": "convert_tablespace_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4262-4272",
          "snippet": "static AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 4185
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_tablespace_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttablespaceoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TABLESPACEOID, ObjectIdGetDatum(tablespaceoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_tablespace_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4149-4168",
    "snippet": "Datum\nhas_tablespace_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttablespaceoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TABLESPACEOID, ObjectIdGetDatum(tablespaceoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_tablespace_aclcheck",
          "args": [
            "tablespaceoid",
            "roleid",
            "mode"
          ],
          "line": 4165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 4163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "TABLESPACEOID",
            "ObjectIdGetDatum(tablespaceoid)"
          ],
          "line": 4162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tablespaceoid"
          ],
          "line": 4162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_tablespace_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4160
        },
        "resolved": true,
        "details": {
          "function_name": "convert_tablespace_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4262-4272",
          "snippet": "static AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 4159
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 4159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 4153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 4152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_tablespace_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttablespaceoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(TABLESPACEOID, ObjectIdGetDatum(tablespaceoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_tablespace_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4125-4142",
    "snippet": "Datum\nhas_tablespace_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *tablespacename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\ttablespaceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\ttablespaceoid = convert_tablespace_name(tablespacename);\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static Oid\tconvert_tablespace_name(text *tablespacename);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_tablespace_aclcheck",
          "args": [
            "tablespaceoid",
            "roleid",
            "mode"
          ],
          "line": 4139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_tablespace_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4137
        },
        "resolved": true,
        "details": {
          "function_name": "convert_tablespace_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4262-4272",
          "snippet": "static AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_tablespace_name",
          "args": [
            "tablespacename"
          ],
          "line": 4136
        },
        "resolved": true,
        "details": {
          "function_name": "convert_tablespace_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4250-4256",
          "snippet": "static Oid\nconvert_tablespace_name(text *tablespacename)\n{\n\tchar\t   *spcname = text_to_cstring(tablespacename);\n\n\treturn get_tablespace_oid(spcname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_tablespace_name(text *tablespacename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_tablespace_name(text *tablespacename);\n\nstatic Oid\nconvert_tablespace_name(text *tablespacename)\n{\n\tchar\t   *spcname = text_to_cstring(tablespacename);\n\n\treturn get_tablespace_oid(spcname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 4135
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 4128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic Oid\tconvert_tablespace_name(text *tablespacename);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_tablespace_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *tablespacename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\ttablespaceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\ttablespaceoid = convert_tablespace_name(tablespacename);\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_tablespace_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4099-4117",
    "snippet": "Datum\nhas_tablespace_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *tablespacename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttablespaceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\ttablespaceoid = convert_tablespace_name(tablespacename);\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static Oid\tconvert_tablespace_name(text *tablespacename);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_tablespace_aclcheck",
          "args": [
            "tablespaceoid",
            "roleid",
            "mode"
          ],
          "line": 4114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_tablespace_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4112
        },
        "resolved": true,
        "details": {
          "function_name": "convert_tablespace_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4262-4272",
          "snippet": "static AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_tablespace_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map tablespace_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, tablespace_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_tablespace_name",
          "args": [
            "tablespacename"
          ],
          "line": 4111
        },
        "resolved": true,
        "details": {
          "function_name": "convert_tablespace_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4250-4256",
          "snippet": "static Oid\nconvert_tablespace_name(text *tablespacename)\n{\n\tchar\t   *spcname = text_to_cstring(tablespacename);\n\n\treturn get_tablespace_oid(spcname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_tablespace_name(text *tablespacename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_tablespace_name(text *tablespacename);\n\nstatic Oid\nconvert_tablespace_name(text *tablespacename)\n{\n\tchar\t   *spcname = text_to_cstring(tablespacename);\n\n\treturn get_tablespace_oid(spcname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 4110
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 4110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 4102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic Oid\tconvert_tablespace_name(text *tablespacename);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_tablespace_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *tablespacename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttablespaceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\ttablespaceoid = convert_tablespace_name(tablespacename);\n\tmode = convert_tablespace_priv_string(priv_type_text);\n\n\taclresult = pg_tablespace_aclcheck(tablespaceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_server_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4071-4081",
    "snippet": "static AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "server_priv_map"
          ],
          "line": 4080
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_USAGE"
          ],
          "line": 4076
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}"
  },
  {
    "function_name": "convert_server_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4059-4065",
    "snippet": "static Oid\nconvert_server_name(text *servername)\n{\n\tchar\t   *serverstr = text_to_cstring(servername);\n\n\treturn get_foreign_server_oid(serverstr, false);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tconvert_server_name(text *servername);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_foreign_server_oid",
          "args": [
            "serverstr",
            "false"
          ],
          "line": 4064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "servername"
          ],
          "line": 4062
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_server_name(text *servername);\n\nstatic Oid\nconvert_server_name(text *servername)\n{\n\tchar\t   *serverstr = text_to_cstring(servername);\n\n\treturn get_foreign_server_oid(serverstr, false);\n}"
  },
  {
    "function_name": "has_server_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4033-4050",
    "snippet": "Datum\nhas_server_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tserverid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_server_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNSERVEROID, ObjectIdGetDatum(serverid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_server_aclcheck",
          "args": [
            "serverid",
            "roleid",
            "mode"
          ],
          "line": 4047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 4045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "FOREIGNSERVEROID",
            "ObjectIdGetDatum(serverid)"
          ],
          "line": 4044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "serverid"
          ],
          "line": 4044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_server_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4042
        },
        "resolved": true,
        "details": {
          "function_name": "convert_server_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4071-4081",
          "snippet": "static AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 4037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4036
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_server_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tserverid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_server_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNSERVEROID, ObjectIdGetDatum(serverid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_server_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "4010-4026",
    "snippet": "Datum\nhas_server_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *servername = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tserverid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tserverid = convert_server_name(servername);\n\tmode = convert_server_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static Oid\tconvert_server_name(text *servername);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_server_aclcheck",
          "args": [
            "serverid",
            "roleid",
            "mode"
          ],
          "line": 4023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_server_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 4021
        },
        "resolved": true,
        "details": {
          "function_name": "convert_server_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4071-4081",
          "snippet": "static AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_server_name",
          "args": [
            "servername"
          ],
          "line": 4020
        },
        "resolved": true,
        "details": {
          "function_name": "convert_server_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4059-4065",
          "snippet": "static Oid\nconvert_server_name(text *servername)\n{\n\tchar\t   *serverstr = text_to_cstring(servername);\n\n\treturn get_foreign_server_oid(serverstr, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_server_name(text *servername);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_server_name(text *servername);\n\nstatic Oid\nconvert_server_name(text *servername)\n{\n\tchar\t   *serverstr = text_to_cstring(servername);\n\n\treturn get_foreign_server_oid(serverstr, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 4015
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 4014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 4013
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic Oid\tconvert_server_name(text *servername);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_server_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *servername = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tserverid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tserverid = convert_server_name(servername);\n\tmode = convert_server_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_server_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3985-4003",
    "snippet": "Datum\nhas_server_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tserverid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_server_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNSERVEROID, ObjectIdGetDatum(serverid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 4002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_server_aclcheck",
          "args": [
            "serverid",
            "roleid",
            "mode"
          ],
          "line": 4000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "FOREIGNSERVEROID",
            "ObjectIdGetDatum(serverid)"
          ],
          "line": 3997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "serverid"
          ],
          "line": 3997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_server_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3995
        },
        "resolved": true,
        "details": {
          "function_name": "convert_server_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4071-4081",
          "snippet": "static AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3994
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3988
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_server_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tserverid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_server_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNSERVEROID, ObjectIdGetDatum(serverid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_server_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3958-3977",
    "snippet": "Datum\nhas_server_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tserverid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_server_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNSERVEROID, ObjectIdGetDatum(serverid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_server_aclcheck",
          "args": [
            "serverid",
            "roleid",
            "mode"
          ],
          "line": 3974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "FOREIGNSERVEROID",
            "ObjectIdGetDatum(serverid)"
          ],
          "line": 3971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "serverid"
          ],
          "line": 3971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_server_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3969
        },
        "resolved": true,
        "details": {
          "function_name": "convert_server_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4071-4081",
          "snippet": "static AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 3968
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 3968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 3962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 3961
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_server_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tserverid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_server_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNSERVEROID, ObjectIdGetDatum(serverid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_server_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3934-3951",
    "snippet": "Datum\nhas_server_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *servername = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tserverid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tserverid = convert_server_name(servername);\n\tmode = convert_server_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static Oid\tconvert_server_name(text *servername);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_server_aclcheck",
          "args": [
            "serverid",
            "roleid",
            "mode"
          ],
          "line": 3948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_server_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3946
        },
        "resolved": true,
        "details": {
          "function_name": "convert_server_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4071-4081",
          "snippet": "static AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_server_name",
          "args": [
            "servername"
          ],
          "line": 3945
        },
        "resolved": true,
        "details": {
          "function_name": "convert_server_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4059-4065",
          "snippet": "static Oid\nconvert_server_name(text *servername)\n{\n\tchar\t   *serverstr = text_to_cstring(servername);\n\n\treturn get_foreign_server_oid(serverstr, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_server_name(text *servername);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_server_name(text *servername);\n\nstatic Oid\nconvert_server_name(text *servername)\n{\n\tchar\t   *serverstr = text_to_cstring(servername);\n\n\treturn get_foreign_server_oid(serverstr, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3944
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 3937
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic Oid\tconvert_server_name(text *servername);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_server_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *servername = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tserverid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tserverid = convert_server_name(servername);\n\tmode = convert_server_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_server_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3908-3926",
    "snippet": "Datum\nhas_server_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *servername = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tserverid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tserverid = convert_server_name(servername);\n\tmode = convert_server_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static Oid\tconvert_server_name(text *servername);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_server_aclcheck",
          "args": [
            "serverid",
            "roleid",
            "mode"
          ],
          "line": 3923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_server_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3921
        },
        "resolved": true,
        "details": {
          "function_name": "convert_server_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4071-4081",
          "snippet": "static AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_server_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map server_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, server_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_server_name",
          "args": [
            "servername"
          ],
          "line": 3920
        },
        "resolved": true,
        "details": {
          "function_name": "convert_server_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4059-4065",
          "snippet": "static Oid\nconvert_server_name(text *servername)\n{\n\tchar\t   *serverstr = text_to_cstring(servername);\n\n\treturn get_foreign_server_oid(serverstr, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_server_name(text *servername);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_server_name(text *servername);\n\nstatic Oid\nconvert_server_name(text *servername)\n{\n\tchar\t   *serverstr = text_to_cstring(servername);\n\n\treturn get_foreign_server_oid(serverstr, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 3919
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 3919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 3911
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic Oid\tconvert_server_name(text *servername);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_server_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *servername = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tserverid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tserverid = convert_server_name(servername);\n\tmode = convert_server_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_server_aclcheck(serverid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_schema_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3878-3890",
    "snippet": "static AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "schema_priv_map"
          ],
          "line": 3889
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_USAGE"
          ],
          "line": 3885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CREATE"
          ],
          "line": 3883
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}"
  },
  {
    "function_name": "convert_schema_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3866-3872",
    "snippet": "static Oid\nconvert_schema_name(text *schemaname)\n{\n\tchar\t   *nspname = text_to_cstring(schemaname);\n\n\treturn get_namespace_oid(nspname, false);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tconvert_schema_name(text *schemaname);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_namespace_oid",
          "args": [
            "nspname",
            "false"
          ],
          "line": 3871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "schemaname"
          ],
          "line": 3869
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_schema_name(text *schemaname);\n\nstatic Oid\nconvert_schema_name(text *schemaname)\n{\n\tchar\t   *nspname = text_to_cstring(schemaname);\n\n\treturn get_namespace_oid(nspname, false);\n}"
  },
  {
    "function_name": "has_schema_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3840-3857",
    "snippet": "Datum\nhas_schema_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tschemaoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(NAMESPACEOID, ObjectIdGetDatum(schemaoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_namespace_aclcheck",
          "args": [
            "schemaoid",
            "roleid",
            "mode"
          ],
          "line": 3854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "NAMESPACEOID",
            "ObjectIdGetDatum(schemaoid)"
          ],
          "line": 3851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "schemaoid"
          ],
          "line": 3851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_schema_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3849
        },
        "resolved": true,
        "details": {
          "function_name": "convert_schema_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3878-3890",
          "snippet": "static AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 3844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3843
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_schema_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tschemaoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(NAMESPACEOID, ObjectIdGetDatum(schemaoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_schema_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3817-3833",
    "snippet": "Datum\nhas_schema_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *schemaname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tschemaoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tschemaoid = convert_schema_name(schemaname);\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static Oid\tconvert_schema_name(text *schemaname);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_namespace_aclcheck",
          "args": [
            "schemaoid",
            "roleid",
            "mode"
          ],
          "line": 3830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_schema_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3828
        },
        "resolved": true,
        "details": {
          "function_name": "convert_schema_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3878-3890",
          "snippet": "static AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_schema_name",
          "args": [
            "schemaname"
          ],
          "line": 3827
        },
        "resolved": true,
        "details": {
          "function_name": "convert_schema_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3866-3872",
          "snippet": "static Oid\nconvert_schema_name(text *schemaname)\n{\n\tchar\t   *nspname = text_to_cstring(schemaname);\n\n\treturn get_namespace_oid(nspname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_schema_name(text *schemaname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_schema_name(text *schemaname);\n\nstatic Oid\nconvert_schema_name(text *schemaname)\n{\n\tchar\t   *nspname = text_to_cstring(schemaname);\n\n\treturn get_namespace_oid(nspname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3820
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic Oid\tconvert_schema_name(text *schemaname);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_schema_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *schemaname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tschemaoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tschemaoid = convert_schema_name(schemaname);\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_schema_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3792-3810",
    "snippet": "Datum\nhas_schema_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tschemaoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(NAMESPACEOID, ObjectIdGetDatum(schemaoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_namespace_aclcheck",
          "args": [
            "schemaoid",
            "roleid",
            "mode"
          ],
          "line": 3807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "NAMESPACEOID",
            "ObjectIdGetDatum(schemaoid)"
          ],
          "line": 3804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "schemaoid"
          ],
          "line": 3804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_schema_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3802
        },
        "resolved": true,
        "details": {
          "function_name": "convert_schema_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3878-3890",
          "snippet": "static AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3801
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3795
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_schema_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tschemaoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(NAMESPACEOID, ObjectIdGetDatum(schemaoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_schema_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3765-3784",
    "snippet": "Datum\nhas_schema_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tschemaoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(NAMESPACEOID, ObjectIdGetDatum(schemaoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_namespace_aclcheck",
          "args": [
            "schemaoid",
            "roleid",
            "mode"
          ],
          "line": 3781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "NAMESPACEOID",
            "ObjectIdGetDatum(schemaoid)"
          ],
          "line": 3778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "schemaoid"
          ],
          "line": 3778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_schema_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3776
        },
        "resolved": true,
        "details": {
          "function_name": "convert_schema_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3878-3890",
          "snippet": "static AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 3775
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 3775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 3769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 3768
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_schema_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tschemaoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(NAMESPACEOID, ObjectIdGetDatum(schemaoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_schema_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3741-3758",
    "snippet": "Datum\nhas_schema_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *schemaname = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tschemaoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tschemaoid = convert_schema_name(schemaname);\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static Oid\tconvert_schema_name(text *schemaname);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_namespace_aclcheck",
          "args": [
            "schemaoid",
            "roleid",
            "mode"
          ],
          "line": 3755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_schema_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3753
        },
        "resolved": true,
        "details": {
          "function_name": "convert_schema_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3878-3890",
          "snippet": "static AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_schema_name",
          "args": [
            "schemaname"
          ],
          "line": 3752
        },
        "resolved": true,
        "details": {
          "function_name": "convert_schema_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3866-3872",
          "snippet": "static Oid\nconvert_schema_name(text *schemaname)\n{\n\tchar\t   *nspname = text_to_cstring(schemaname);\n\n\treturn get_namespace_oid(nspname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_schema_name(text *schemaname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_schema_name(text *schemaname);\n\nstatic Oid\nconvert_schema_name(text *schemaname)\n{\n\tchar\t   *nspname = text_to_cstring(schemaname);\n\n\treturn get_namespace_oid(nspname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3751
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 3744
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic Oid\tconvert_schema_name(text *schemaname);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_schema_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *schemaname = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tschemaoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tschemaoid = convert_schema_name(schemaname);\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_schema_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3715-3733",
    "snippet": "Datum\nhas_schema_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *schemaname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tschemaoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tschemaoid = convert_schema_name(schemaname);\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static Oid\tconvert_schema_name(text *schemaname);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_namespace_aclcheck",
          "args": [
            "schemaoid",
            "roleid",
            "mode"
          ],
          "line": 3730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_schema_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3728
        },
        "resolved": true,
        "details": {
          "function_name": "convert_schema_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3878-3890",
          "snippet": "static AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_schema_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map schema_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, schema_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_schema_name",
          "args": [
            "schemaname"
          ],
          "line": 3727
        },
        "resolved": true,
        "details": {
          "function_name": "convert_schema_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3866-3872",
          "snippet": "static Oid\nconvert_schema_name(text *schemaname)\n{\n\tchar\t   *nspname = text_to_cstring(schemaname);\n\n\treturn get_namespace_oid(nspname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_schema_name(text *schemaname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_schema_name(text *schemaname);\n\nstatic Oid\nconvert_schema_name(text *schemaname)\n{\n\tchar\t   *nspname = text_to_cstring(schemaname);\n\n\treturn get_namespace_oid(nspname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 3726
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 3726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 3718
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic Oid\tconvert_schema_name(text *schemaname);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_schema_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *schemaname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tschemaoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tschemaoid = convert_schema_name(schemaname);\n\tmode = convert_schema_priv_string(priv_type_text);\n\n\taclresult = pg_namespace_aclcheck(schemaoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_language_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3687-3697",
    "snippet": "static AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "language_priv_map"
          ],
          "line": 3696
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_USAGE"
          ],
          "line": 3692
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}"
  },
  {
    "function_name": "convert_language_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3675-3681",
    "snippet": "static Oid\nconvert_language_name(text *languagename)\n{\n\tchar\t   *langname = text_to_cstring(languagename);\n\n\treturn get_language_oid(langname, false);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tconvert_language_name(text *languagename);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_language_oid",
          "args": [
            "langname",
            "false"
          ],
          "line": 3680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "languagename"
          ],
          "line": 3678
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_language_name(text *languagename);\n\nstatic Oid\nconvert_language_name(text *languagename)\n{\n\tchar\t   *langname = text_to_cstring(languagename);\n\n\treturn get_language_oid(langname, false);\n}"
  },
  {
    "function_name": "has_language_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3649-3666",
    "snippet": "Datum\nhas_language_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tlanguageoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_language_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(LANGOID, ObjectIdGetDatum(languageoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_language_aclcheck",
          "args": [
            "languageoid",
            "roleid",
            "mode"
          ],
          "line": 3663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "LANGOID",
            "ObjectIdGetDatum(languageoid)"
          ],
          "line": 3660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "languageoid"
          ],
          "line": 3660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_language_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3658
        },
        "resolved": true,
        "details": {
          "function_name": "convert_language_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3687-3697",
          "snippet": "static AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 3653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3652
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_language_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tlanguageoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_language_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(LANGOID, ObjectIdGetDatum(languageoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_language_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3626-3642",
    "snippet": "Datum\nhas_language_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *languagename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tlanguageoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tlanguageoid = convert_language_name(languagename);\n\tmode = convert_language_priv_string(priv_type_text);\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static Oid\tconvert_language_name(text *languagename);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_language_aclcheck",
          "args": [
            "languageoid",
            "roleid",
            "mode"
          ],
          "line": 3639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_language_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3637
        },
        "resolved": true,
        "details": {
          "function_name": "convert_language_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3687-3697",
          "snippet": "static AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_language_name",
          "args": [
            "languagename"
          ],
          "line": 3636
        },
        "resolved": true,
        "details": {
          "function_name": "convert_language_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3675-3681",
          "snippet": "static Oid\nconvert_language_name(text *languagename)\n{\n\tchar\t   *langname = text_to_cstring(languagename);\n\n\treturn get_language_oid(langname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_language_name(text *languagename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_language_name(text *languagename);\n\nstatic Oid\nconvert_language_name(text *languagename)\n{\n\tchar\t   *langname = text_to_cstring(languagename);\n\n\treturn get_language_oid(langname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3629
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic Oid\tconvert_language_name(text *languagename);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_language_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *languagename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tlanguageoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tlanguageoid = convert_language_name(languagename);\n\tmode = convert_language_priv_string(priv_type_text);\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_language_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3601-3619",
    "snippet": "Datum\nhas_language_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tlanguageoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_language_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(LANGOID, ObjectIdGetDatum(languageoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_language_aclcheck",
          "args": [
            "languageoid",
            "roleid",
            "mode"
          ],
          "line": 3616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "LANGOID",
            "ObjectIdGetDatum(languageoid)"
          ],
          "line": 3613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "languageoid"
          ],
          "line": 3613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_language_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3611
        },
        "resolved": true,
        "details": {
          "function_name": "convert_language_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3687-3697",
          "snippet": "static AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3610
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3604
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_language_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tlanguageoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_language_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(LANGOID, ObjectIdGetDatum(languageoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_language_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3574-3593",
    "snippet": "Datum\nhas_language_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tlanguageoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_language_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(LANGOID, ObjectIdGetDatum(languageoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_language_aclcheck",
          "args": [
            "languageoid",
            "roleid",
            "mode"
          ],
          "line": 3590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "LANGOID",
            "ObjectIdGetDatum(languageoid)"
          ],
          "line": 3587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "languageoid"
          ],
          "line": 3587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_language_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3585
        },
        "resolved": true,
        "details": {
          "function_name": "convert_language_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3687-3697",
          "snippet": "static AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 3584
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 3584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 3578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 3577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_language_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tlanguageoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_language_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(LANGOID, ObjectIdGetDatum(languageoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_language_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3550-3567",
    "snippet": "Datum\nhas_language_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *languagename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tlanguageoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tlanguageoid = convert_language_name(languagename);\n\tmode = convert_language_priv_string(priv_type_text);\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static Oid\tconvert_language_name(text *languagename);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_language_aclcheck",
          "args": [
            "languageoid",
            "roleid",
            "mode"
          ],
          "line": 3564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_language_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3562
        },
        "resolved": true,
        "details": {
          "function_name": "convert_language_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3687-3697",
          "snippet": "static AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_language_name",
          "args": [
            "languagename"
          ],
          "line": 3561
        },
        "resolved": true,
        "details": {
          "function_name": "convert_language_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3675-3681",
          "snippet": "static Oid\nconvert_language_name(text *languagename)\n{\n\tchar\t   *langname = text_to_cstring(languagename);\n\n\treturn get_language_oid(langname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_language_name(text *languagename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_language_name(text *languagename);\n\nstatic Oid\nconvert_language_name(text *languagename)\n{\n\tchar\t   *langname = text_to_cstring(languagename);\n\n\treturn get_language_oid(langname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3560
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 3553
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic Oid\tconvert_language_name(text *languagename);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_language_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *languagename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tlanguageoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tlanguageoid = convert_language_name(languagename);\n\tmode = convert_language_priv_string(priv_type_text);\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_language_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3524-3542",
    "snippet": "Datum\nhas_language_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *languagename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tlanguageoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tlanguageoid = convert_language_name(languagename);\n\tmode = convert_language_priv_string(priv_type_text);\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static Oid\tconvert_language_name(text *languagename);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_language_aclcheck",
          "args": [
            "languageoid",
            "roleid",
            "mode"
          ],
          "line": 3539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_language_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3537
        },
        "resolved": true,
        "details": {
          "function_name": "convert_language_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3687-3697",
          "snippet": "static AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_language_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map language_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, language_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_language_name",
          "args": [
            "languagename"
          ],
          "line": 3536
        },
        "resolved": true,
        "details": {
          "function_name": "convert_language_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3675-3681",
          "snippet": "static Oid\nconvert_language_name(text *languagename)\n{\n\tchar\t   *langname = text_to_cstring(languagename);\n\n\treturn get_language_oid(langname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_language_name(text *languagename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_language_name(text *languagename);\n\nstatic Oid\nconvert_language_name(text *languagename)\n{\n\tchar\t   *langname = text_to_cstring(languagename);\n\n\treturn get_language_oid(langname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 3535
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 3535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 3527
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic Oid\tconvert_language_name(text *languagename);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_language_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *languagename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tlanguageoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tlanguageoid = convert_language_name(languagename);\n\tmode = convert_language_priv_string(priv_type_text);\n\n\taclresult = pg_language_aclcheck(languageoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_function_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3496-3506",
    "snippet": "static AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "function_priv_map"
          ],
          "line": 3505
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_EXECUTE"
          ],
          "line": 3501
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}"
  },
  {
    "function_name": "convert_function_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3475-3490",
    "snippet": "static Oid\nconvert_function_name(text *functionname)\n{\n\tchar\t   *funcname = text_to_cstring(functionname);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regprocedurein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(funcname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_FUNCTION),\n\t\t\t\t errmsg(\"function \\\"%s\\\" does not exist\", funcname)));\n\n\treturn oid;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static Oid\tconvert_function_name(text *functionname);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_UNDEFINED_FUNCTION),\n\t\t\t\t errmsg(\"function \\\"%s\\\" does not exist\", funcname))"
          ],
          "line": 3485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"function \\\"%s\\\" does not exist\"",
            "funcname"
          ],
          "line": 3487
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_UNDEFINED_FUNCTION"
          ],
          "line": 3486
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "OidIsValid",
          "args": [
            "oid"
          ],
          "line": 3484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetObjectId",
          "args": [
            "DirectFunctionCall1(regprocedurein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(funcname))"
          ],
          "line": 3481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectFunctionCall1",
          "args": [
            "regprocedurein",
            "CStringGetDatum(funcname)"
          ],
          "line": 3481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "funcname"
          ],
          "line": 3482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "functionname"
          ],
          "line": 3478
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_function_name(text *functionname);\n\nstatic Oid\nconvert_function_name(text *functionname)\n{\n\tchar\t   *funcname = text_to_cstring(functionname);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regprocedurein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(funcname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_FUNCTION),\n\t\t\t\t errmsg(\"function \\\"%s\\\" does not exist\", funcname)));\n\n\treturn oid;\n}"
  },
  {
    "function_name": "has_function_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3449-3466",
    "snippet": "Datum\nhas_function_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tfunctionoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_function_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(PROCOID, ObjectIdGetDatum(functionoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_proc_aclcheck",
          "args": [
            "functionoid",
            "roleid",
            "mode"
          ],
          "line": 3463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "PROCOID",
            "ObjectIdGetDatum(functionoid)"
          ],
          "line": 3460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "functionoid"
          ],
          "line": 3460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_function_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3458
        },
        "resolved": true,
        "details": {
          "function_name": "convert_function_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3496-3506",
          "snippet": "static AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 3453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_function_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tfunctionoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_function_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(PROCOID, ObjectIdGetDatum(functionoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_function_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3426-3442",
    "snippet": "Datum\nhas_function_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *functionname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tfunctionoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tfunctionoid = convert_function_name(functionname);\n\tmode = convert_function_priv_string(priv_type_text);\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static Oid\tconvert_function_name(text *functionname);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_proc_aclcheck",
          "args": [
            "functionoid",
            "roleid",
            "mode"
          ],
          "line": 3439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_function_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3437
        },
        "resolved": true,
        "details": {
          "function_name": "convert_function_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3496-3506",
          "snippet": "static AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_function_name",
          "args": [
            "functionname"
          ],
          "line": 3436
        },
        "resolved": true,
        "details": {
          "function_name": "convert_function_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3475-3490",
          "snippet": "static Oid\nconvert_function_name(text *functionname)\n{\n\tchar\t   *funcname = text_to_cstring(functionname);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regprocedurein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(funcname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_FUNCTION),\n\t\t\t\t errmsg(\"function \\\"%s\\\" does not exist\", funcname)));\n\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_function_name(text *functionname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_function_name(text *functionname);\n\nstatic Oid\nconvert_function_name(text *functionname)\n{\n\tchar\t   *funcname = text_to_cstring(functionname);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regprocedurein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(funcname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_FUNCTION),\n\t\t\t\t errmsg(\"function \\\"%s\\\" does not exist\", funcname)));\n\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3429
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic Oid\tconvert_function_name(text *functionname);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_function_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *functionname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tfunctionoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tfunctionoid = convert_function_name(functionname);\n\tmode = convert_function_priv_string(priv_type_text);\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_function_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3401-3419",
    "snippet": "Datum\nhas_function_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfunctionoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_function_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(PROCOID, ObjectIdGetDatum(functionoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_proc_aclcheck",
          "args": [
            "functionoid",
            "roleid",
            "mode"
          ],
          "line": 3416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "PROCOID",
            "ObjectIdGetDatum(functionoid)"
          ],
          "line": 3413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "functionoid"
          ],
          "line": 3413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_function_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3411
        },
        "resolved": true,
        "details": {
          "function_name": "convert_function_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3496-3506",
          "snippet": "static AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3410
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3404
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_function_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfunctionoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_function_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(PROCOID, ObjectIdGetDatum(functionoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_function_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3374-3393",
    "snippet": "Datum\nhas_function_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tfunctionoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_function_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(PROCOID, ObjectIdGetDatum(functionoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_proc_aclcheck",
          "args": [
            "functionoid",
            "roleid",
            "mode"
          ],
          "line": 3390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "PROCOID",
            "ObjectIdGetDatum(functionoid)"
          ],
          "line": 3387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "functionoid"
          ],
          "line": 3387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_function_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3385
        },
        "resolved": true,
        "details": {
          "function_name": "convert_function_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3496-3506",
          "snippet": "static AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 3384
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 3384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 3378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 3377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_function_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tfunctionoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_function_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(PROCOID, ObjectIdGetDatum(functionoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_function_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3350-3367",
    "snippet": "Datum\nhas_function_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *functionname = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tfunctionoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tfunctionoid = convert_function_name(functionname);\n\tmode = convert_function_priv_string(priv_type_text);\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static Oid\tconvert_function_name(text *functionname);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_proc_aclcheck",
          "args": [
            "functionoid",
            "roleid",
            "mode"
          ],
          "line": 3364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_function_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3362
        },
        "resolved": true,
        "details": {
          "function_name": "convert_function_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3496-3506",
          "snippet": "static AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_function_name",
          "args": [
            "functionname"
          ],
          "line": 3361
        },
        "resolved": true,
        "details": {
          "function_name": "convert_function_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3475-3490",
          "snippet": "static Oid\nconvert_function_name(text *functionname)\n{\n\tchar\t   *funcname = text_to_cstring(functionname);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regprocedurein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(funcname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_FUNCTION),\n\t\t\t\t errmsg(\"function \\\"%s\\\" does not exist\", funcname)));\n\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_function_name(text *functionname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_function_name(text *functionname);\n\nstatic Oid\nconvert_function_name(text *functionname)\n{\n\tchar\t   *funcname = text_to_cstring(functionname);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regprocedurein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(funcname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_FUNCTION),\n\t\t\t\t errmsg(\"function \\\"%s\\\" does not exist\", funcname)));\n\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3360
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 3353
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic Oid\tconvert_function_name(text *functionname);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_function_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *functionname = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tfunctionoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tfunctionoid = convert_function_name(functionname);\n\tmode = convert_function_priv_string(priv_type_text);\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_function_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3324-3342",
    "snippet": "Datum\nhas_function_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *functionname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tfunctionoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tfunctionoid = convert_function_name(functionname);\n\tmode = convert_function_priv_string(priv_type_text);\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static Oid\tconvert_function_name(text *functionname);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_proc_aclcheck",
          "args": [
            "functionoid",
            "roleid",
            "mode"
          ],
          "line": 3339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_function_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3337
        },
        "resolved": true,
        "details": {
          "function_name": "convert_function_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3496-3506",
          "snippet": "static AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_function_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map function_priv_map[] = {\n\t\t{\"EXECUTE\", ACL_EXECUTE},\n\t\t{\"EXECUTE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_EXECUTE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, function_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_function_name",
          "args": [
            "functionname"
          ],
          "line": 3336
        },
        "resolved": true,
        "details": {
          "function_name": "convert_function_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3475-3490",
          "snippet": "static Oid\nconvert_function_name(text *functionname)\n{\n\tchar\t   *funcname = text_to_cstring(functionname);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regprocedurein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(funcname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_FUNCTION),\n\t\t\t\t errmsg(\"function \\\"%s\\\" does not exist\", funcname)));\n\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_function_name(text *functionname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_function_name(text *functionname);\n\nstatic Oid\nconvert_function_name(text *functionname)\n{\n\tchar\t   *funcname = text_to_cstring(functionname);\n\tOid\t\t\toid;\n\n\toid = DatumGetObjectId(DirectFunctionCall1(regprocedurein,\n\t\t\t\t\t\t\t\t\t\t\t   CStringGetDatum(funcname)));\n\n\tif (!OidIsValid(oid))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_FUNCTION),\n\t\t\t\t errmsg(\"function \\\"%s\\\" does not exist\", funcname)));\n\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 3335
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 3335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 3327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic Oid\tconvert_function_name(text *functionname);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_function_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *functionname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tfunctionoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tfunctionoid = convert_function_name(functionname);\n\tmode = convert_function_priv_string(priv_type_text);\n\n\taclresult = pg_proc_aclcheck(functionoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_foreign_data_wrapper_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3296-3306",
    "snippet": "static AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "foreign_data_wrapper_priv_map"
          ],
          "line": 3305
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_USAGE"
          ],
          "line": 3301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}"
  },
  {
    "function_name": "convert_foreign_data_wrapper_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3284-3290",
    "snippet": "static Oid\nconvert_foreign_data_wrapper_name(text *fdwname)\n{\n\tchar\t   *fdwstr = text_to_cstring(fdwname);\n\n\treturn get_foreign_data_wrapper_oid(fdwstr, false);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tconvert_foreign_data_wrapper_name(text *fdwname);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_foreign_data_wrapper_oid",
          "args": [
            "fdwstr",
            "false"
          ],
          "line": 3289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "fdwname"
          ],
          "line": 3287
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_foreign_data_wrapper_name(text *fdwname);\n\nstatic Oid\nconvert_foreign_data_wrapper_name(text *fdwname)\n{\n\tchar\t   *fdwstr = text_to_cstring(fdwname);\n\n\treturn get_foreign_data_wrapper_oid(fdwstr, false);\n}"
  },
  {
    "function_name": "has_foreign_data_wrapper_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3258-3275",
    "snippet": "Datum\nhas_foreign_data_wrapper_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tfdwid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNDATAWRAPPEROID, ObjectIdGetDatum(fdwid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_data_wrapper_aclcheck",
          "args": [
            "fdwid",
            "roleid",
            "mode"
          ],
          "line": 3272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "FOREIGNDATAWRAPPEROID",
            "ObjectIdGetDatum(fdwid)"
          ],
          "line": 3269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "fdwid"
          ],
          "line": 3269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_foreign_data_wrapper_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3267
        },
        "resolved": true,
        "details": {
          "function_name": "convert_foreign_data_wrapper_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3296-3306",
          "snippet": "static AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 3262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3261
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_foreign_data_wrapper_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tfdwid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNDATAWRAPPEROID, ObjectIdGetDatum(fdwid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_foreign_data_wrapper_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3235-3251",
    "snippet": "Datum\nhas_foreign_data_wrapper_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *fdwname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tfdwid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tfdwid = convert_foreign_data_wrapper_name(fdwname);\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static Oid\tconvert_foreign_data_wrapper_name(text *fdwname);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_data_wrapper_aclcheck",
          "args": [
            "fdwid",
            "roleid",
            "mode"
          ],
          "line": 3248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_foreign_data_wrapper_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3246
        },
        "resolved": true,
        "details": {
          "function_name": "convert_foreign_data_wrapper_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3296-3306",
          "snippet": "static AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_foreign_data_wrapper_name",
          "args": [
            "fdwname"
          ],
          "line": 3245
        },
        "resolved": true,
        "details": {
          "function_name": "convert_foreign_data_wrapper_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3284-3290",
          "snippet": "static Oid\nconvert_foreign_data_wrapper_name(text *fdwname)\n{\n\tchar\t   *fdwstr = text_to_cstring(fdwname);\n\n\treturn get_foreign_data_wrapper_oid(fdwstr, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_foreign_data_wrapper_name(text *fdwname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_foreign_data_wrapper_name(text *fdwname);\n\nstatic Oid\nconvert_foreign_data_wrapper_name(text *fdwname)\n{\n\tchar\t   *fdwstr = text_to_cstring(fdwname);\n\n\treturn get_foreign_data_wrapper_oid(fdwstr, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3238
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic Oid\tconvert_foreign_data_wrapper_name(text *fdwname);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_foreign_data_wrapper_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *fdwname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tfdwid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tfdwid = convert_foreign_data_wrapper_name(fdwname);\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_foreign_data_wrapper_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3210-3228",
    "snippet": "Datum\nhas_foreign_data_wrapper_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfdwid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNDATAWRAPPEROID, ObjectIdGetDatum(fdwid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_data_wrapper_aclcheck",
          "args": [
            "fdwid",
            "roleid",
            "mode"
          ],
          "line": 3225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "FOREIGNDATAWRAPPEROID",
            "ObjectIdGetDatum(fdwid)"
          ],
          "line": 3222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "fdwid"
          ],
          "line": 3222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_foreign_data_wrapper_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3220
        },
        "resolved": true,
        "details": {
          "function_name": "convert_foreign_data_wrapper_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3296-3306",
          "snippet": "static AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3219
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_foreign_data_wrapper_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfdwid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNDATAWRAPPEROID, ObjectIdGetDatum(fdwid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_foreign_data_wrapper_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3183-3202",
    "snippet": "Datum\nhas_foreign_data_wrapper_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tfdwid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNDATAWRAPPEROID, ObjectIdGetDatum(fdwid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_data_wrapper_aclcheck",
          "args": [
            "fdwid",
            "roleid",
            "mode"
          ],
          "line": 3199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "FOREIGNDATAWRAPPEROID",
            "ObjectIdGetDatum(fdwid)"
          ],
          "line": 3196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "fdwid"
          ],
          "line": 3196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_foreign_data_wrapper_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3194
        },
        "resolved": true,
        "details": {
          "function_name": "convert_foreign_data_wrapper_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3296-3306",
          "snippet": "static AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 3193
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 3193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 3187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 3186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_foreign_data_wrapper_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tfdwid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(FOREIGNDATAWRAPPEROID, ObjectIdGetDatum(fdwid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_foreign_data_wrapper_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3159-3176",
    "snippet": "Datum\nhas_foreign_data_wrapper_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *fdwname = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tfdwid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tfdwid = convert_foreign_data_wrapper_name(fdwname);\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static Oid\tconvert_foreign_data_wrapper_name(text *fdwname);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_data_wrapper_aclcheck",
          "args": [
            "fdwid",
            "roleid",
            "mode"
          ],
          "line": 3173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_foreign_data_wrapper_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3171
        },
        "resolved": true,
        "details": {
          "function_name": "convert_foreign_data_wrapper_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3296-3306",
          "snippet": "static AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_foreign_data_wrapper_name",
          "args": [
            "fdwname"
          ],
          "line": 3170
        },
        "resolved": true,
        "details": {
          "function_name": "convert_foreign_data_wrapper_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3284-3290",
          "snippet": "static Oid\nconvert_foreign_data_wrapper_name(text *fdwname)\n{\n\tchar\t   *fdwstr = text_to_cstring(fdwname);\n\n\treturn get_foreign_data_wrapper_oid(fdwstr, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_foreign_data_wrapper_name(text *fdwname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_foreign_data_wrapper_name(text *fdwname);\n\nstatic Oid\nconvert_foreign_data_wrapper_name(text *fdwname)\n{\n\tchar\t   *fdwstr = text_to_cstring(fdwname);\n\n\treturn get_foreign_data_wrapper_oid(fdwstr, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3169
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 3162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic Oid\tconvert_foreign_data_wrapper_name(text *fdwname);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_foreign_data_wrapper_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *fdwname = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tfdwid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tfdwid = convert_foreign_data_wrapper_name(fdwname);\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_foreign_data_wrapper_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3133-3151",
    "snippet": "Datum\nhas_foreign_data_wrapper_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *fdwname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tfdwid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tfdwid = convert_foreign_data_wrapper_name(fdwname);\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static Oid\tconvert_foreign_data_wrapper_name(text *fdwname);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_foreign_data_wrapper_aclcheck",
          "args": [
            "fdwid",
            "roleid",
            "mode"
          ],
          "line": 3148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_foreign_data_wrapper_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3146
        },
        "resolved": true,
        "details": {
          "function_name": "convert_foreign_data_wrapper_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3296-3306",
          "snippet": "static AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_foreign_data_wrapper_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map foreign_data_wrapper_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, foreign_data_wrapper_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_foreign_data_wrapper_name",
          "args": [
            "fdwname"
          ],
          "line": 3145
        },
        "resolved": true,
        "details": {
          "function_name": "convert_foreign_data_wrapper_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3284-3290",
          "snippet": "static Oid\nconvert_foreign_data_wrapper_name(text *fdwname)\n{\n\tchar\t   *fdwstr = text_to_cstring(fdwname);\n\n\treturn get_foreign_data_wrapper_oid(fdwstr, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_foreign_data_wrapper_name(text *fdwname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_foreign_data_wrapper_name(text *fdwname);\n\nstatic Oid\nconvert_foreign_data_wrapper_name(text *fdwname)\n{\n\tchar\t   *fdwstr = text_to_cstring(fdwname);\n\n\treturn get_foreign_data_wrapper_oid(fdwstr, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 3144
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 3144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 3136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic Oid\tconvert_foreign_data_wrapper_name(text *fdwname);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_foreign_data_wrapper_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *fdwname = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tfdwid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tfdwid = convert_foreign_data_wrapper_name(fdwname);\n\tmode = convert_foreign_data_wrapper_priv_string(priv_type_text);\n\n\taclresult = pg_foreign_data_wrapper_aclcheck(fdwid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_database_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3098-3115",
    "snippet": "static AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "database_priv_map"
          ],
          "line": 3113
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CONNECT"
          ],
          "line": 3109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CREATE_TEMP"
          ],
          "line": 3107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CREATE_TEMP"
          ],
          "line": 3105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_CREATE"
          ],
          "line": 3103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}"
  },
  {
    "function_name": "convert_database_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3086-3092",
    "snippet": "static Oid\nconvert_database_name(text *databasename)\n{\n\tchar\t   *dbname = text_to_cstring(databasename);\n\n\treturn get_database_oid(dbname, false);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tconvert_database_name(text *databasename);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_database_oid",
          "args": [
            "dbname",
            "false"
          ],
          "line": 3091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "databasename"
          ],
          "line": 3089
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_database_name(text *databasename);\n\nstatic Oid\nconvert_database_name(text *databasename)\n{\n\tchar\t   *dbname = text_to_cstring(databasename);\n\n\treturn get_database_oid(dbname, false);\n}"
  },
  {
    "function_name": "has_database_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3060-3077",
    "snippet": "Datum\nhas_database_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tdatabaseoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_database_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(DATABASEOID, ObjectIdGetDatum(databaseoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_database_aclcheck",
          "args": [
            "databaseoid",
            "roleid",
            "mode"
          ],
          "line": 3074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "DATABASEOID",
            "ObjectIdGetDatum(databaseoid)"
          ],
          "line": 3071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "databaseoid"
          ],
          "line": 3071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_database_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3069
        },
        "resolved": true,
        "details": {
          "function_name": "convert_database_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3098-3115",
          "snippet": "static AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 3064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3063
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_database_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tdatabaseoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_database_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(DATABASEOID, ObjectIdGetDatum(databaseoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_database_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3037-3053",
    "snippet": "Datum\nhas_database_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *databasename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tdatabaseoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tdatabaseoid = convert_database_name(databasename);\n\tmode = convert_database_priv_string(priv_type_text);\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static Oid\tconvert_database_name(text *databasename);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_database_aclcheck",
          "args": [
            "databaseoid",
            "roleid",
            "mode"
          ],
          "line": 3050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_database_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3048
        },
        "resolved": true,
        "details": {
          "function_name": "convert_database_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3098-3115",
          "snippet": "static AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_database_name",
          "args": [
            "databasename"
          ],
          "line": 3047
        },
        "resolved": true,
        "details": {
          "function_name": "convert_database_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3086-3092",
          "snippet": "static Oid\nconvert_database_name(text *databasename)\n{\n\tchar\t   *dbname = text_to_cstring(databasename);\n\n\treturn get_database_oid(dbname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_database_name(text *databasename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_database_name(text *databasename);\n\nstatic Oid\nconvert_database_name(text *databasename)\n{\n\tchar\t   *dbname = text_to_cstring(databasename);\n\n\treturn get_database_oid(dbname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 3042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3040
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic Oid\tconvert_database_name(text *databasename);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_database_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *databasename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tdatabaseoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tdatabaseoid = convert_database_name(databasename);\n\tmode = convert_database_priv_string(priv_type_text);\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_database_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "3012-3030",
    "snippet": "Datum\nhas_database_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdatabaseoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_database_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(DATABASEOID, ObjectIdGetDatum(databaseoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_database_aclcheck",
          "args": [
            "databaseoid",
            "roleid",
            "mode"
          ],
          "line": 3027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 3025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "DATABASEOID",
            "ObjectIdGetDatum(databaseoid)"
          ],
          "line": 3024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "databaseoid"
          ],
          "line": 3024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_database_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 3022
        },
        "resolved": true,
        "details": {
          "function_name": "convert_database_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3098-3115",
          "snippet": "static AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 3021
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 3016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 3015
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_database_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdatabaseoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_database_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(DATABASEOID, ObjectIdGetDatum(databaseoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_database_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2985-3004",
    "snippet": "Datum\nhas_database_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tdatabaseoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_database_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(DATABASEOID, ObjectIdGetDatum(databaseoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 3003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_database_aclcheck",
          "args": [
            "databaseoid",
            "roleid",
            "mode"
          ],
          "line": 3001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "DATABASEOID",
            "ObjectIdGetDatum(databaseoid)"
          ],
          "line": 2998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "databaseoid"
          ],
          "line": 2998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_database_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2996
        },
        "resolved": true,
        "details": {
          "function_name": "convert_database_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3098-3115",
          "snippet": "static AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 2995
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 2995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 2989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 2988
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_database_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tdatabaseoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_database_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(DATABASEOID, ObjectIdGetDatum(databaseoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_database_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2961-2978",
    "snippet": "Datum\nhas_database_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *databasename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tdatabaseoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tdatabaseoid = convert_database_name(databasename);\n\tmode = convert_database_priv_string(priv_type_text);\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static Oid\tconvert_database_name(text *databasename);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_database_aclcheck",
          "args": [
            "databaseoid",
            "roleid",
            "mode"
          ],
          "line": 2975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_database_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2973
        },
        "resolved": true,
        "details": {
          "function_name": "convert_database_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3098-3115",
          "snippet": "static AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_database_name",
          "args": [
            "databasename"
          ],
          "line": 2972
        },
        "resolved": true,
        "details": {
          "function_name": "convert_database_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3086-3092",
          "snippet": "static Oid\nconvert_database_name(text *databasename)\n{\n\tchar\t   *dbname = text_to_cstring(databasename);\n\n\treturn get_database_oid(dbname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_database_name(text *databasename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_database_name(text *databasename);\n\nstatic Oid\nconvert_database_name(text *databasename)\n{\n\tchar\t   *dbname = text_to_cstring(databasename);\n\n\treturn get_database_oid(dbname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 2971
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 2964
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic Oid\tconvert_database_name(text *databasename);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_database_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *databasename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tdatabaseoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tdatabaseoid = convert_database_name(databasename);\n\tmode = convert_database_priv_string(priv_type_text);\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_database_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2935-2953",
    "snippet": "Datum\nhas_database_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *databasename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tdatabaseoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tdatabaseoid = convert_database_name(databasename);\n\tmode = convert_database_priv_string(priv_type_text);\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static Oid\tconvert_database_name(text *databasename);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_database_aclcheck",
          "args": [
            "databaseoid",
            "roleid",
            "mode"
          ],
          "line": 2950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_database_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2948
        },
        "resolved": true,
        "details": {
          "function_name": "convert_database_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3098-3115",
          "snippet": "static AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_database_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map database_priv_map[] = {\n\t\t{\"CREATE\", ACL_CREATE},\n\t\t{\"CREATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE)},\n\t\t{\"TEMPORARY\", ACL_CREATE_TEMP},\n\t\t{\"TEMPORARY WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"TEMP\", ACL_CREATE_TEMP},\n\t\t{\"TEMP WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CREATE_TEMP)},\n\t\t{\"CONNECT\", ACL_CONNECT},\n\t\t{\"CONNECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_CONNECT)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, database_priv_map);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_database_name",
          "args": [
            "databasename"
          ],
          "line": 2947
        },
        "resolved": true,
        "details": {
          "function_name": "convert_database_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "3086-3092",
          "snippet": "static Oid\nconvert_database_name(text *databasename)\n{\n\tchar\t   *dbname = text_to_cstring(databasename);\n\n\treturn get_database_oid(dbname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_database_name(text *databasename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_database_name(text *databasename);\n\nstatic Oid\nconvert_database_name(text *databasename)\n{\n\tchar\t   *dbname = text_to_cstring(databasename);\n\n\treturn get_database_oid(dbname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 2946
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 2946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 2938
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic Oid\tconvert_database_name(text *databasename);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_database_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\ttext\t   *databasename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tdatabaseoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tdatabaseoid = convert_database_name(databasename);\n\tmode = convert_database_priv_string(priv_type_text);\n\n\taclresult = pg_database_aclcheck(databaseoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_column_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2901-2917",
    "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "column_priv_map"
          ],
          "line": 2916
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_REFERENCES"
          ],
          "line": 2912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_UPDATE"
          ],
          "line": 2910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_INSERT"
          ],
          "line": 2908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_SELECT"
          ],
          "line": 2906
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
  },
  {
    "function_name": "convert_column_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2843-2895",
    "snippet": "static AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pfree",
          "args": [
            "colname"
          ],
          "line": 2893
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1649-1655",
          "snippet": "static void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename))"
          ],
          "line": 2884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\"",
            "colname",
            "tablename"
          ],
          "line": 2886
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_UNDEFINED_COLUMN"
          ],
          "line": 2885
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_rel_name",
          "args": [
            "tableoid"
          ],
          "line": 2874
        },
        "resolved": true,
        "details": {
          "function_name": "get_rel_namespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/lsyscache.c",
          "lines": "1753-1770",
          "snippet": "Oid\nget_rel_namespace(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tOid\t\t\tresult;\n\n\t\tresult = reltup->relnamespace;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn InvalidOid;\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"bootstrap/bootstrap.h\"",
            "#include \"access/nbtree.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/namespace.h\"\n#include \"bootstrap/bootstrap.h\"\n#include \"access/nbtree.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nOid\nget_rel_namespace(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tOid\t\t\tresult;\n\n\t\tresult = reltup->relnamespace;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn InvalidOid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "attTuple"
          ],
          "line": 2870
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "attTuple"
          ],
          "line": 2864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "attTuple"
          ],
          "line": 2860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCache2",
          "args": [
            "ATTNAME",
            "ObjectIdGetDatum(tableoid)",
            "CStringGetDatum(colname)"
          ],
          "line": 2857
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCache2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1122-1131",
          "snippet": "HeapTuple\nSearchSysCache2(int cacheId,\n\t\t\t\tDatum key1, Datum key2)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 2);\n\n\treturn SearchCatCache2(SysCache[cacheId], key1, key2);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static CatCache *SysCache[SysCacheSize];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache2(int cacheId,\n\t\t\t\tDatum key1, Datum key2)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 2);\n\n\treturn SearchCatCache2(SysCache[cacheId], key1, key2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "colname"
          ],
          "line": 2859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tableoid"
          ],
          "line": 2858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "column"
          ],
          "line": 2850
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\n\nstatic AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}"
  },
  {
    "function_name": "has_column_privilege_id_attnum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2815-2832",
    "snippet": "Datum\nhas_column_privilege_id_attnum(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttableoid = PG_GETARG_OID(0);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = GetUserId();\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2828
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2826
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 2825
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT16",
          "args": [
            "1"
          ],
          "line": 2819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2818
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_id_attnum(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttableoid = PG_GETARG_OID(0);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = GetUserId();\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2788-2807",
    "snippet": "Datum\nhas_column_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttableoid = PG_GETARG_OID(0);\n\ttext\t   *column = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = GetUserId();\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2803
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2801
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_name",
          "args": [
            "tableoid",
            "column"
          ],
          "line": 2800
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2843-2895",
          "snippet": "static AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_table_name(text *tablename);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\n\nstatic AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 2799
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2791
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttableoid = PG_GETARG_OID(0);\n\ttext\t   *column = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = GetUserId();\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_name_attnum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2761-2780",
    "snippet": "Datum\nhas_column_privilege_name_attnum(PG_FUNCTION_ARGS)\n{\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(0);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = GetUserId();\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2776
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2774
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 2773
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 2772
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT16",
          "args": [
            "1"
          ],
          "line": 2765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 2764
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_name_attnum(PG_FUNCTION_ARGS)\n{\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(0);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = GetUserId();\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2732-2753",
    "snippet": "Datum\nhas_column_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *column = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = GetUserId();\n\ttableoid = convert_table_name(tablename);\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2749
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2747
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_name",
          "args": [
            "tableoid",
            "column"
          ],
          "line": 2746
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2843-2895",
          "snippet": "static AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_table_name(text *tablename);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\n\nstatic AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 2745
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 2744
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 2735
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *column = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = GetUserId();\n\ttableoid = convert_table_name(tablename);\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_id_id_attnum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2708-2724",
    "snippet": "Datum\nhas_column_privilege_id_id_attnum(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2720
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2718
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "3"
          ],
          "line": 2714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT16",
          "args": [
            "2"
          ],
          "line": 2713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 2712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2711
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_id_id_attnum(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_id_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2683-2701",
    "snippet": "Datum\nhas_column_privilege_id_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *column = PG_GETARG_TEXT_PP(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2697
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2695
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_name",
          "args": [
            "tableoid",
            "column"
          ],
          "line": 2694
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2843-2895",
          "snippet": "static AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_table_name(text *tablename);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\n\nstatic AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "3"
          ],
          "line": 2689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 2687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2686
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_id_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *column = PG_GETARG_TEXT_PP(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_id_name_attnum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2658-2676",
    "snippet": "Datum\nhas_column_privilege_id_name_attnum(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2672
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2670
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 2669
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "3"
          ],
          "line": 2664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT16",
          "args": [
            "2"
          ],
          "line": 2663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2661
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_id_name_attnum(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_id_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2631-2651",
    "snippet": "Datum\nhas_column_privilege_id_name_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *column = PG_GETARG_TEXT_PP(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\ttableoid;\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\ttableoid = convert_table_name(tablename);\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2647
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2645
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_name",
          "args": [
            "tableoid",
            "column"
          ],
          "line": 2644
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2843-2895",
          "snippet": "static AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_table_name(text *tablename);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\n\nstatic AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 2643
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "3"
          ],
          "line": 2637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2634
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_id_name_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *column = PG_GETARG_TEXT_PP(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\ttableoid;\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\ttableoid = convert_table_name(tablename);\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_name_id_attnum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2606-2624",
    "snippet": "Datum\nhas_column_privilege_name_id_attnum(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2620
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2618
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 2617
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 2617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "3"
          ],
          "line": 2612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT16",
          "args": [
            "2"
          ],
          "line": 2611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 2610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 2609
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_name_id_attnum(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_name_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2579-2599",
    "snippet": "Datum\nhas_column_privilege_name_id_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *column = PG_GETARG_TEXT_PP(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\troleid;\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2595
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2593
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_name",
          "args": [
            "tableoid",
            "column"
          ],
          "line": 2592
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2843-2895",
          "snippet": "static AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_table_name(text *tablename);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\n\nstatic AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 2591
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 2591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "3"
          ],
          "line": 2585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 2583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 2582
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_name_id_name(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *column = PG_GETARG_TEXT_PP(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\troleid;\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_name_name_attnum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2552-2572",
    "snippet": "Datum\nhas_column_privilege_name_name_attnum(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = get_role_oid_or_public(NameStr(*rolename));\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2568
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2566
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 2565
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*rolename)"
          ],
          "line": 2564
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*rolename"
          ],
          "line": 2564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "3"
          ],
          "line": 2558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT16",
          "args": [
            "2"
          ],
          "line": 2557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 2555
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_name_name_attnum(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\tAttrNumber\tcolattnum = PG_GETARG_INT16(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = get_role_oid_or_public(NameStr(*rolename));\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "has_column_privilege_name_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2523-2545",
    "snippet": "Datum\nhas_column_privilege_name_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *column = PG_GETARG_TEXT_PP(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = get_role_oid_or_public(NameStr(*rolename));\n\ttableoid = convert_table_name(tablename);\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "privresult"
          ],
          "line": 2544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "column_privilege_check",
          "args": [
            "tableoid",
            "colattnum",
            "roleid",
            "mode"
          ],
          "line": 2541
        },
        "resolved": true,
        "details": {
          "function_name": "column_privilege_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2465-2516",
          "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2539
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_column_name",
          "args": [
            "tableoid",
            "column"
          ],
          "line": 2538
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2843-2895",
          "snippet": "static AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static Oid\tconvert_table_name(text *tablename);",
            "static AttrNumber convert_column_name(Oid tableoid, text *column);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\n\nstatic AttrNumber\nconvert_column_name(Oid tableoid, text *column)\n{\n\tchar\t   *colname;\n\tHeapTuple\tattTuple;\n\tAttrNumber\tattnum;\n\n\tcolname = text_to_cstring(column);\n\n\t/*\n\t * We don't use get_attnum() here because it will report that dropped\n\t * columns don't exist.  We need to treat dropped columns differently from\n\t * nonexistent columns.\n\t */\n\tattTuple = SearchSysCache2(ATTNAME,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   CStringGetDatum(colname));\n\tif (HeapTupleIsValid(attTuple))\n\t{\n\t\tForm_pg_attribute attributeForm;\n\n\t\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\t\t/* We want to return NULL for dropped columns */\n\t\tif (attributeForm->attisdropped)\n\t\t\tattnum = InvalidAttrNumber;\n\t\telse\n\t\t\tattnum = attributeForm->attnum;\n\t\tReleaseSysCache(attTuple);\n\t}\n\telse\n\t{\n\t\tchar\t   *tablename = get_rel_name(tableoid);\n\n\t\t/*\n\t\t * If the table OID is bogus, or it's just been dropped, we'll get\n\t\t * NULL back.  In such cases we want has_column_privilege to return\n\t\t * NULL too, so just return InvalidAttrNumber.\n\t\t */\n\t\tif (tablename != NULL)\n\t\t{\n\t\t\t/* tableoid exists, colname does not, so throw error */\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_UNDEFINED_COLUMN),\n\t\t\t\t\t errmsg(\"column \\\"%s\\\" of relation \\\"%s\\\" does not exist\",\n\t\t\t\t\t\t\tcolname, tablename)));\n\t\t}\n\t\t/* tableoid doesn't exist, so act like attisdropped case */\n\t\tattnum = InvalidAttrNumber;\n\t}\n\n\tpfree(colname);\n\treturn attnum;\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 2537
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*rolename)"
          ],
          "line": 2536
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*rolename"
          ],
          "line": 2536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "3"
          ],
          "line": 2529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 2526
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_column_privilege_name_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *column = PG_GETARG_TEXT_PP(2);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(3);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAttrNumber\tcolattnum;\n\tAclMode\t\tmode;\n\tint\t\t\tprivresult;\n\n\troleid = get_role_oid_or_public(NameStr(*rolename));\n\ttableoid = convert_table_name(tablename);\n\tcolattnum = convert_column_name(tableoid, column);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tprivresult = column_privilege_check(tableoid, colattnum, roleid, mode);\n\tif (privresult < 0)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_BOOL(privresult);\n}"
  },
  {
    "function_name": "column_privilege_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2465-2516",
    "snippet": "static int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pg_attribute_aclcheck",
          "args": [
            "tableoid",
            "attnum",
            "roleid",
            "mode"
          ],
          "line": 2513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "attTuple"
          ],
          "line": 2511
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "attTuple"
          ],
          "line": 2505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "attTuple"
          ],
          "line": 2503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCache2",
          "args": [
            "ATTNUM",
            "ObjectIdGetDatum(tableoid)",
            "Int16GetDatum(attnum)"
          ],
          "line": 2500
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCache2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1122-1131",
          "snippet": "HeapTuple\nSearchSysCache2(int cacheId,\n\t\t\t\tDatum key1, Datum key2)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 2);\n\n\treturn SearchCatCache2(SysCache[cacheId], key1, key2);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static CatCache *SysCache[SysCacheSize];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache2(int cacheId,\n\t\t\t\tDatum key1, Datum key2)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 2);\n\n\treturn SearchCatCache2(SysCache[cacheId], key1, key2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Int16GetDatum",
          "args": [
            "attnum"
          ],
          "line": 2502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tableoid"
          ],
          "line": 2501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 2490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "RELOID",
            "ObjectIdGetDatum(tableoid)"
          ],
          "line": 2487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tableoid"
          ],
          "line": 2487
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic int\ncolumn_privilege_check(Oid tableoid, AttrNumber attnum,\n\t\t\t\t\t   Oid roleid, AclMode mode)\n{\n\tAclResult\taclresult;\n\tHeapTuple\tattTuple;\n\tForm_pg_attribute attributeForm;\n\n\t/*\n\t * If convert_column_name failed, we can just return -1 immediately.\n\t */\n\tif (attnum == InvalidAttrNumber)\n\t\treturn -1;\n\n\t/*\n\t * First check if we have the privilege at the table level.  We check\n\t * existence of the pg_class row before risking calling pg_class_aclcheck.\n\t * Note: it might seem there's a race condition against concurrent DROP,\n\t * but really it's safe because there will be no syscache flush between\n\t * here and there.  So if we see the row in the syscache, so will\n\t * pg_class_aclcheck.\n\t */\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\treturn -1;\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tif (aclresult == ACLCHECK_OK)\n\t\treturn true;\n\n\t/*\n\t * No table privilege, so try per-column privileges.  Again, we have to\n\t * check for dropped attribute first, and we rely on the syscache not to\n\t * notice a concurrent drop before pg_attribute_aclcheck fetches the row.\n\t */\n\tattTuple = SearchSysCache2(ATTNUM,\n\t\t\t\t\t\t\t   ObjectIdGetDatum(tableoid),\n\t\t\t\t\t\t\t   Int16GetDatum(attnum));\n\tif (!HeapTupleIsValid(attTuple))\n\t\treturn -1;\n\tattributeForm = (Form_pg_attribute) GETSTRUCT(attTuple);\n\tif (attributeForm->attisdropped)\n\t{\n\t\tReleaseSysCache(attTuple);\n\t\treturn -1;\n\t}\n\tReleaseSysCache(attTuple);\n\n\taclresult = pg_attribute_aclcheck(tableoid, attnum, roleid, mode);\n\n\treturn (aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_any_column_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2418-2439",
    "snippet": "Datum\nhas_any_column_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_attribute_aclcheck_all",
          "args": [
            "tableoid",
            "roleid",
            "mode",
            "ACLMASK_ANY"
          ],
          "line": 2435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 2433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "RELOID",
            "ObjectIdGetDatum(tableoid)"
          ],
          "line": 2429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tableoid"
          ],
          "line": 2429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2427
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 2422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2421
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_any_column_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_any_column_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2391-2411",
    "snippet": "Datum\nhas_any_column_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_attribute_aclcheck_all",
          "args": [
            "tableoid",
            "roleid",
            "mode",
            "ACLMASK_ANY"
          ],
          "line": 2407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 2405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2402
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 2401
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2394
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_any_column_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_any_column_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2362-2384",
    "snippet": "Datum\nhas_any_column_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttableoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_attribute_aclcheck_all",
          "args": [
            "tableoid",
            "roleid",
            "mode",
            "ACLMASK_ANY"
          ],
          "line": 2380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 2378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "RELOID",
            "ObjectIdGetDatum(tableoid)"
          ],
          "line": 2374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tableoid"
          ],
          "line": 2374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2372
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 2371
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2365
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_any_column_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttableoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_any_column_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2331-2354",
    "snippet": "Datum\nhas_any_column_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_attribute_aclcheck_all",
          "args": [
            "tableoid",
            "roleid",
            "mode",
            "ACLMASK_ANY"
          ],
          "line": 2350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 2348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "RELOID",
            "ObjectIdGetDatum(tableoid)"
          ],
          "line": 2344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tableoid"
          ],
          "line": 2344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2342
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 2341
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 2341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 2335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 2334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_any_column_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_column_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_any_column_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2303-2324",
    "snippet": "Datum\nhas_any_column_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_attribute_aclcheck_all",
          "args": [
            "tableoid",
            "roleid",
            "mode",
            "ACLMASK_ANY"
          ],
          "line": 2320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 2318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2315
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 2314
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 2313
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 2306
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_any_column_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_any_column_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2273-2295",
    "snippet": "Datum\nhas_any_column_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*rolename));\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AttrNumber convert_column_name(Oid tableoid, text *column);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_attribute_aclcheck_all",
          "args": [
            "tableoid",
            "roleid",
            "mode",
            "ACLMASK_ANY"
          ],
          "line": 2291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 2289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_column_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2286
        },
        "resolved": true,
        "details": {
          "function_name": "convert_column_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2901-2917",
          "snippet": "static AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_column_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map column_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, column_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 2285
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*rolename)"
          ],
          "line": 2284
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*rolename"
          ],
          "line": 2284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 2276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AttrNumber convert_column_name(Oid tableoid, text *column);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_any_column_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*rolename));\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_column_priv_string(priv_type_text);\n\n\t/* First check at table level, then examine each column if needed */\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\tif (aclresult != ACLCHECK_OK)\n\t\taclresult = pg_attribute_aclcheck_all(tableoid, roleid, mode,\n\t\t\t\t\t\t\t\t\t\t\t  ACLMASK_ANY);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_sequence_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2240-2254",
    "snippet": "static AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "sequence_priv_map"
          ],
          "line": 2253
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_UPDATE"
          ],
          "line": 2249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_SELECT"
          ],
          "line": 2247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_USAGE"
          ],
          "line": 2245
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}"
  },
  {
    "function_name": "has_sequence_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2211-2234",
    "snippet": "Datum\nhas_sequence_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tsequenceoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\tchar\t\trelkind;\n\n\tmode = convert_sequence_priv_string(priv_type_text);\n\trelkind = get_rel_relkind(sequenceoid);\n\tif (relkind == '\\0')\n\t\tPG_RETURN_NULL();\n\telse if (relkind != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\tget_rel_name(sequenceoid))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "sequenceoid",
            "roleid",
            "mode"
          ],
          "line": 2231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\tget_rel_name(sequenceoid)))"
          ],
          "line": 2226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"\\\"%s\\\" is not a sequence\"",
            "get_rel_name(sequenceoid)"
          ],
          "line": 2228
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_rel_name",
          "args": [
            "sequenceoid"
          ],
          "line": 2229
        },
        "resolved": true,
        "details": {
          "function_name": "get_rel_namespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/lsyscache.c",
          "lines": "1753-1770",
          "snippet": "Oid\nget_rel_namespace(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tOid\t\t\tresult;\n\n\t\tresult = reltup->relnamespace;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn InvalidOid;\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"bootstrap/bootstrap.h\"",
            "#include \"access/nbtree.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/namespace.h\"\n#include \"bootstrap/bootstrap.h\"\n#include \"access/nbtree.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nOid\nget_rel_namespace(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tOid\t\t\tresult;\n\n\t\tresult = reltup->relnamespace;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn InvalidOid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_WRONG_OBJECT_TYPE"
          ],
          "line": 2227
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rel_relkind",
          "args": [
            "sequenceoid"
          ],
          "line": 2222
        },
        "resolved": true,
        "details": {
          "function_name": "get_rel_relkind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/lsyscache.c",
          "lines": "1804-1821",
          "snippet": "char\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"bootstrap/bootstrap.h\"",
            "#include \"access/nbtree.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/namespace.h\"\n#include \"bootstrap/bootstrap.h\"\n#include \"access/nbtree.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nchar\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_sequence_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2221
        },
        "resolved": true,
        "details": {
          "function_name": "convert_sequence_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2240-2254",
          "snippet": "static AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 2215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_sequence_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\tsequenceoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\tchar\t\trelkind;\n\n\tmode = convert_sequence_priv_string(priv_type_text);\n\trelkind = get_rel_relkind(sequenceoid);\n\tif (relkind == '\\0')\n\t\tPG_RETURN_NULL();\n\telse if (relkind != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\tget_rel_name(sequenceoid))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_sequence_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2183-2204",
    "snippet": "Datum\nhas_sequence_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *sequencename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tsequenceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_sequence_priv_string(priv_type_text);\n\tsequenceoid = convert_table_name(sequencename);\n\tif (get_rel_relkind(sequenceoid) != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\ttext_to_cstring(sequencename))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "sequenceoid",
            "roleid",
            "mode"
          ],
          "line": 2201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\ttext_to_cstring(sequencename)))"
          ],
          "line": 2196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"\\\"%s\\\" is not a sequence\"",
            "text_to_cstring(sequencename)"
          ],
          "line": 2198
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "sequencename"
          ],
          "line": 2199
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_WRONG_OBJECT_TYPE"
          ],
          "line": 2197
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_rel_relkind",
          "args": [
            "sequenceoid"
          ],
          "line": 2195
        },
        "resolved": true,
        "details": {
          "function_name": "get_rel_relkind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/lsyscache.c",
          "lines": "1804-1821",
          "snippet": "char\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"bootstrap/bootstrap.h\"",
            "#include \"access/nbtree.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/namespace.h\"\n#include \"bootstrap/bootstrap.h\"\n#include \"access/nbtree.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nchar\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "sequencename"
          ],
          "line": 2194
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_sequence_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2193
        },
        "resolved": true,
        "details": {
          "function_name": "convert_sequence_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2240-2254",
          "snippet": "static AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_sequence_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *sequencename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\tsequenceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_sequence_priv_string(priv_type_text);\n\tsequenceoid = convert_table_name(sequencename);\n\tif (get_rel_relkind(sequenceoid) != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\ttext_to_cstring(sequencename))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_sequence_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2152-2176",
    "snippet": "Datum\nhas_sequence_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tsequenceoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\tchar\t\trelkind;\n\n\troleid = GetUserId();\n\tmode = convert_sequence_priv_string(priv_type_text);\n\trelkind = get_rel_relkind(sequenceoid);\n\tif (relkind == '\\0')\n\t\tPG_RETURN_NULL();\n\telse if (relkind != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\tget_rel_name(sequenceoid))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "sequenceoid",
            "roleid",
            "mode"
          ],
          "line": 2173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\tget_rel_name(sequenceoid)))"
          ],
          "line": 2168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"\\\"%s\\\" is not a sequence\"",
            "get_rel_name(sequenceoid)"
          ],
          "line": 2170
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_rel_name",
          "args": [
            "sequenceoid"
          ],
          "line": 2171
        },
        "resolved": true,
        "details": {
          "function_name": "get_rel_namespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/lsyscache.c",
          "lines": "1753-1770",
          "snippet": "Oid\nget_rel_namespace(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tOid\t\t\tresult;\n\n\t\tresult = reltup->relnamespace;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn InvalidOid;\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"bootstrap/bootstrap.h\"",
            "#include \"access/nbtree.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/namespace.h\"\n#include \"bootstrap/bootstrap.h\"\n#include \"access/nbtree.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nOid\nget_rel_namespace(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tOid\t\t\tresult;\n\n\t\tresult = reltup->relnamespace;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn InvalidOid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_WRONG_OBJECT_TYPE"
          ],
          "line": 2169
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rel_relkind",
          "args": [
            "sequenceoid"
          ],
          "line": 2164
        },
        "resolved": true,
        "details": {
          "function_name": "get_rel_relkind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/lsyscache.c",
          "lines": "1804-1821",
          "snippet": "char\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"bootstrap/bootstrap.h\"",
            "#include \"access/nbtree.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/namespace.h\"\n#include \"bootstrap/bootstrap.h\"\n#include \"access/nbtree.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nchar\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_sequence_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2163
        },
        "resolved": true,
        "details": {
          "function_name": "convert_sequence_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2240-2254",
          "snippet": "static AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 2162
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 2155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_sequence_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tsequenceoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\tchar\t\trelkind;\n\n\troleid = GetUserId();\n\tmode = convert_sequence_priv_string(priv_type_text);\n\trelkind = get_rel_relkind(sequenceoid);\n\tif (relkind == '\\0')\n\t\tPG_RETURN_NULL();\n\telse if (relkind != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\tget_rel_name(sequenceoid))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_sequence_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2119-2144",
    "snippet": "Datum\nhas_sequence_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tsequenceoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\tchar\t\trelkind;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_sequence_priv_string(priv_type_text);\n\trelkind = get_rel_relkind(sequenceoid);\n\tif (relkind == '\\0')\n\t\tPG_RETURN_NULL();\n\telse if (relkind != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\tget_rel_name(sequenceoid))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "sequenceoid",
            "roleid",
            "mode"
          ],
          "line": 2141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\tget_rel_name(sequenceoid)))"
          ],
          "line": 2136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"\\\"%s\\\" is not a sequence\"",
            "get_rel_name(sequenceoid)"
          ],
          "line": 2138
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_rel_name",
          "args": [
            "sequenceoid"
          ],
          "line": 2139
        },
        "resolved": true,
        "details": {
          "function_name": "get_rel_namespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/lsyscache.c",
          "lines": "1753-1770",
          "snippet": "Oid\nget_rel_namespace(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tOid\t\t\tresult;\n\n\t\tresult = reltup->relnamespace;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn InvalidOid;\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"bootstrap/bootstrap.h\"",
            "#include \"access/nbtree.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/namespace.h\"\n#include \"bootstrap/bootstrap.h\"\n#include \"access/nbtree.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nOid\nget_rel_namespace(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tOid\t\t\tresult;\n\n\t\tresult = reltup->relnamespace;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn InvalidOid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_WRONG_OBJECT_TYPE"
          ],
          "line": 2137
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 2134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rel_relkind",
          "args": [
            "sequenceoid"
          ],
          "line": 2132
        },
        "resolved": true,
        "details": {
          "function_name": "get_rel_relkind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/lsyscache.c",
          "lines": "1804-1821",
          "snippet": "char\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"bootstrap/bootstrap.h\"",
            "#include \"access/nbtree.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/namespace.h\"\n#include \"bootstrap/bootstrap.h\"\n#include \"access/nbtree.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nchar\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_sequence_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2131
        },
        "resolved": true,
        "details": {
          "function_name": "convert_sequence_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2240-2254",
          "snippet": "static AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 2130
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 2130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 2123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 2122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_sequence_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\tsequenceoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\tchar\t\trelkind;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_sequence_priv_string(priv_type_text);\n\trelkind = get_rel_relkind(sequenceoid);\n\tif (relkind == '\\0')\n\t\tPG_RETURN_NULL();\n\telse if (relkind != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\tget_rel_name(sequenceoid))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_sequence_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2090-2112",
    "snippet": "Datum\nhas_sequence_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *sequencename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tsequenceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_sequence_priv_string(priv_type_text);\n\tsequenceoid = convert_table_name(sequencename);\n\tif (get_rel_relkind(sequenceoid) != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\ttext_to_cstring(sequencename))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "sequenceoid",
            "roleid",
            "mode"
          ],
          "line": 2109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\ttext_to_cstring(sequencename)))"
          ],
          "line": 2104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"\\\"%s\\\" is not a sequence\"",
            "text_to_cstring(sequencename)"
          ],
          "line": 2106
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "sequencename"
          ],
          "line": 2107
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_WRONG_OBJECT_TYPE"
          ],
          "line": 2105
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_rel_relkind",
          "args": [
            "sequenceoid"
          ],
          "line": 2103
        },
        "resolved": true,
        "details": {
          "function_name": "get_rel_relkind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/lsyscache.c",
          "lines": "1804-1821",
          "snippet": "char\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"bootstrap/bootstrap.h\"",
            "#include \"access/nbtree.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/namespace.h\"\n#include \"bootstrap/bootstrap.h\"\n#include \"access/nbtree.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nchar\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "sequencename"
          ],
          "line": 2102
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_sequence_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2101
        },
        "resolved": true,
        "details": {
          "function_name": "convert_sequence_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2240-2254",
          "snippet": "static AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 2100
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2094
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 2093
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_sequence_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *sequencename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\tsequenceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_sequence_priv_string(priv_type_text);\n\tsequenceoid = convert_table_name(sequencename);\n\tif (get_rel_relkind(sequenceoid) != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\ttext_to_cstring(sequencename))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_sequence_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2059-2082",
    "snippet": "Datum\nhas_sequence_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *sequencename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tsequenceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*rolename));\n\tmode = convert_sequence_priv_string(priv_type_text);\n\tsequenceoid = convert_table_name(sequencename);\n\tif (get_rel_relkind(sequenceoid) != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\ttext_to_cstring(sequencename))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 2081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "sequenceoid",
            "roleid",
            "mode"
          ],
          "line": 2079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\ttext_to_cstring(sequencename)))"
          ],
          "line": 2074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"\\\"%s\\\" is not a sequence\"",
            "text_to_cstring(sequencename)"
          ],
          "line": 2076
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "sequencename"
          ],
          "line": 2077
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_WRONG_OBJECT_TYPE"
          ],
          "line": 2075
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_rel_relkind",
          "args": [
            "sequenceoid"
          ],
          "line": 2073
        },
        "resolved": true,
        "details": {
          "function_name": "get_rel_relkind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/lsyscache.c",
          "lines": "1804-1821",
          "snippet": "char\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/fmgroids.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/makefuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"bootstrap/bootstrap.h\"",
            "#include \"access/nbtree.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/fmgroids.h\"\n#include \"utils/datum.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/makefuncs.h\"\n#include \"miscadmin.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/namespace.h\"\n#include \"bootstrap/bootstrap.h\"\n#include \"access/nbtree.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include \"postgres.h\"\n\nchar\nget_rel_relkind(Oid relid)\n{\n\tHeapTuple\ttp;\n\n\ttp = SearchSysCache1(RELOID, ObjectIdGetDatum(relid));\n\tif (HeapTupleIsValid(tp))\n\t{\n\t\tForm_pg_class reltup = (Form_pg_class) GETSTRUCT(tp);\n\t\tchar\t\tresult;\n\n\t\tresult = reltup->relkind;\n\t\tReleaseSysCache(tp);\n\t\treturn result;\n\t}\n\telse\n\t\treturn '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "sequencename"
          ],
          "line": 2072
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_sequence_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 2071
        },
        "resolved": true,
        "details": {
          "function_name": "convert_sequence_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2240-2254",
          "snippet": "static AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_sequence_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map sequence_priv_map[] = {\n\t\t{\"USAGE\", ACL_USAGE},\n\t\t{\"USAGE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_USAGE)},\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, sequence_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*rolename)"
          ],
          "line": 2070
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*rolename"
          ],
          "line": 2070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 2064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 2063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 2062
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_sequence_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *sequencename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\tsequenceoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*rolename));\n\tmode = convert_sequence_priv_string(priv_type_text);\n\tsequenceoid = convert_table_name(sequencename);\n\tif (get_rel_relkind(sequenceoid) != RELKIND_SEQUENCE)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_WRONG_OBJECT_TYPE),\n\t\t\t\t errmsg(\"\\\"%s\\\" is not a sequence\",\n\t\t\t\t\t\ttext_to_cstring(sequencename))));\n\n\taclresult = pg_class_aclcheck(sequenceoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "convert_table_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2017-2041",
    "snippet": "static AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_any_priv_string",
          "args": [
            "priv_type_text",
            "table_priv_map"
          ],
          "line": 2040
        },
        "resolved": true,
        "details": {
          "function_name": "convert_any_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1647-1692",
          "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_TRIGGER"
          ],
          "line": 2034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_REFERENCES"
          ],
          "line": 2032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_TRUNCATE"
          ],
          "line": 2030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_DELETE"
          ],
          "line": 2028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_UPDATE"
          ],
          "line": 2026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_INSERT"
          ],
          "line": 2024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACL_SELECT"
          ],
          "line": 2022
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}"
  },
  {
    "function_name": "convert_table_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "2002-2011",
    "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static Oid\tconvert_table_name(text *tablename);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RangeVarGetRelid",
          "args": [
            "relrv",
            "NoLock",
            "false"
          ],
          "line": 2010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeRangeVarFromNameList",
          "args": [
            "textToQualifiedNameList(tablename)"
          ],
          "line": 2007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "textToQualifiedNameList",
          "args": [
            "tablename"
          ],
          "line": 2007
        },
        "resolved": true,
        "details": {
          "function_name": "textToQualifiedNameList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "3231-3264",
          "snippet": "List *\ntextToQualifiedNameList(text *textval)\n{\n\tchar\t   *rawname;\n\tList\t   *result = NIL;\n\tList\t   *namelist;\n\tListCell   *l;\n\n\t/* Convert to C string (handles possible detoasting). */\n\t/* Note we rely on being able to modify rawname below. */\n\trawname = text_to_cstring(textval);\n\n\tif (!SplitIdentifierString(rawname, '.', &namelist))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_NAME),\n\t\t\t\t errmsg(\"invalid name syntax\")));\n\n\tif (namelist == NIL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_NAME),\n\t\t\t\t errmsg(\"invalid name syntax\")));\n\n\tforeach(l, namelist)\n\t{\n\t\tchar\t   *curname = (char *) lfirst(l);\n\n\t\tresult = lappend(result, makeString(pstrdup(curname)));\n\t}\n\n\tpfree(rawname);\n\tlist_free(namelist);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nList *\ntextToQualifiedNameList(text *textval)\n{\n\tchar\t   *rawname;\n\tList\t   *result = NIL;\n\tList\t   *namelist;\n\tListCell   *l;\n\n\t/* Convert to C string (handles possible detoasting). */\n\t/* Note we rely on being able to modify rawname below. */\n\trawname = text_to_cstring(textval);\n\n\tif (!SplitIdentifierString(rawname, '.', &namelist))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_NAME),\n\t\t\t\t errmsg(\"invalid name syntax\")));\n\n\tif (namelist == NIL)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_NAME),\n\t\t\t\t errmsg(\"invalid name syntax\")));\n\n\tforeach(l, namelist)\n\t{\n\t\tchar\t   *curname = (char *) lfirst(l);\n\n\t\tresult = lappend(result, makeString(pstrdup(curname)));\n\t}\n\n\tpfree(rawname);\n\tlist_free(namelist);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
  },
  {
    "function_name": "has_table_privilege_id_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1976-1993",
    "snippet": "Datum\nhas_table_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_table_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 1992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 1990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "RELOID",
            "ObjectIdGetDatum(tableoid)"
          ],
          "line": 1987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tableoid"
          ],
          "line": 1987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_table_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 1985
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2017-2041",
          "snippet": "static AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 1981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 1980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1979
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_table_privilege_id_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\tmode = convert_table_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_table_privilege_id_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1953-1969",
    "snippet": "Datum\nhas_table_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_table_priv_string(priv_type_text);\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 1966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_table_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 1964
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2017-2041",
          "snippet": "static AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 1963
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 1958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 1957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1956
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_table_privilege_id_name(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\troleid = PG_GETARG_OID(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_table_priv_string(priv_type_text);\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_table_privilege_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1928-1946",
    "snippet": "Datum\nhas_table_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttableoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_table_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 1945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 1943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "RELOID",
            "ObjectIdGetDatum(tableoid)"
          ],
          "line": 1940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tableoid"
          ],
          "line": 1940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_table_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 1938
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2017-2041",
          "snippet": "static AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 1937
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 1932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1931
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_table_privilege_id(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttableoid = PG_GETARG_OID(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\tmode = convert_table_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_table_privilege_name_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1901-1920",
    "snippet": "Datum\nhas_table_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_table_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 1919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 1917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCacheExists1",
          "args": [
            "RELOID",
            "ObjectIdGetDatum(tableoid)"
          ],
          "line": 1914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "tableoid"
          ],
          "line": 1914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_table_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 1912
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2017-2041",
          "snippet": "static AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*username)"
          ],
          "line": 1911
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*username"
          ],
          "line": 1911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 1906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 1905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 1904
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_table_privilege_name_id(PG_FUNCTION_ARGS)\n{\n\tName\t\tusername = PG_GETARG_NAME(0);\n\tOid\t\t\ttableoid = PG_GETARG_OID(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*username));\n\tmode = convert_table_priv_string(priv_type_text);\n\n\tif (!SearchSysCacheExists1(RELOID, ObjectIdGetDatum(tableoid)))\n\t\tPG_RETURN_NULL();\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_table_privilege_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1877-1894",
    "snippet": "Datum\nhas_table_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_table_priv_string(priv_type_text);\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 1893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 1891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_table_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 1889
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2017-2041",
          "snippet": "static AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 1888
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 1887
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 1881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 1880
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_table_privilege_name(PG_FUNCTION_ARGS)\n{\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(0);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(1);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = GetUserId();\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_table_priv_string(priv_type_text);\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "has_table_privilege_name_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1851-1869",
    "snippet": "Datum\nhas_table_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*rolename));\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_table_priv_string(priv_type_text);\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static Oid\tconvert_table_name(text *tablename);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "aclresult == ACLCHECK_OK"
          ],
          "line": 1868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_class_aclcheck",
          "args": [
            "tableoid",
            "roleid",
            "mode"
          ],
          "line": 1866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_table_priv_string",
          "args": [
            "priv_type_text"
          ],
          "line": 1864
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2017-2041",
          "snippet": "static AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_table_priv_string(text *priv_type_text)\n{\n\tstatic const priv_map table_priv_map[] = {\n\t\t{\"SELECT\", ACL_SELECT},\n\t\t{\"SELECT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_SELECT)},\n\t\t{\"INSERT\", ACL_INSERT},\n\t\t{\"INSERT WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_INSERT)},\n\t\t{\"UPDATE\", ACL_UPDATE},\n\t\t{\"UPDATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_UPDATE)},\n\t\t{\"DELETE\", ACL_DELETE},\n\t\t{\"DELETE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_DELETE)},\n\t\t{\"TRUNCATE\", ACL_TRUNCATE},\n\t\t{\"TRUNCATE WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRUNCATE)},\n\t\t{\"REFERENCES\", ACL_REFERENCES},\n\t\t{\"REFERENCES WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_REFERENCES)},\n\t\t{\"TRIGGER\", ACL_TRIGGER},\n\t\t{\"TRIGGER WITH GRANT OPTION\", ACL_GRANT_OPTION_FOR(ACL_TRIGGER)},\n\t\t{\"RULE\", 0},\t\t\t/* ignore old RULE privileges */\n\t\t{\"RULE WITH GRANT OPTION\", 0},\n\t\t{NULL, 0}\n\t};\n\n\treturn convert_any_priv_string(priv_type_text, table_priv_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_table_name",
          "args": [
            "tablename"
          ],
          "line": 1863
        },
        "resolved": true,
        "details": {
          "function_name": "convert_table_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "2002-2011",
          "snippet": "static Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tconvert_table_name(text *tablename);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic Oid\tconvert_table_name(text *tablename);\n\nstatic Oid\nconvert_table_name(text *tablename)\n{\n\tRangeVar   *relrv;\n\n\trelrv = makeRangeVarFromNameList(textToQualifiedNameList(tablename));\n\n\t/* We might not even have permissions on this relation; don't lock it. */\n\treturn RangeVarGetRelid(relrv, NoLock, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid_or_public",
          "args": [
            "NameStr(*rolename)"
          ],
          "line": 1862
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid_or_public",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5207-5214",
          "snippet": "Oid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nOid\nget_role_oid_or_public(const char *rolname)\n{\n\tif (strcmp(rolname, \"public\") == 0)\n\t\treturn ACL_ID_PUBLIC;\n\n\treturn get_role_oid(rolname, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "*rolename"
          ],
          "line": 1862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 1856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "1"
          ],
          "line": 1855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_NAME",
          "args": [
            "0"
          ],
          "line": 1854
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic Oid\tconvert_table_name(text *tablename);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nDatum\nhas_table_privilege_name_name(PG_FUNCTION_ARGS)\n{\n\tName\t\trolename = PG_GETARG_NAME(0);\n\ttext\t   *tablename = PG_GETARG_TEXT_PP(1);\n\ttext\t   *priv_type_text = PG_GETARG_TEXT_PP(2);\n\tOid\t\t\troleid;\n\tOid\t\t\ttableoid;\n\tAclMode\t\tmode;\n\tAclResult\taclresult;\n\n\troleid = get_role_oid_or_public(NameStr(*rolename));\n\ttableoid = convert_table_name(tablename);\n\tmode = convert_table_priv_string(priv_type_text);\n\n\taclresult = pg_class_aclcheck(tableoid, roleid, mode);\n\n\tPG_RETURN_BOOL(aclresult == ACLCHECK_OK);\n}"
  },
  {
    "function_name": "aclexplode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1745-1831",
    "snippet": "Datum\naclexplode(PG_FUNCTION_ARGS)\n{\n\tAcl\t\t   *acl = PG_GETARG_ACL_P(0);\n\tFuncCallContext *funcctx;\n\tint\t\t   *idx;\n\tAclItem    *aidat;\n\n\tif (SRF_IS_FIRSTCALL())\n\t{\n\t\tTupleDesc\ttupdesc;\n\t\tMemoryContext oldcontext;\n\n\t\tcheck_acl(acl);\n\n\t\tfuncctx = SRF_FIRSTCALL_INIT();\n\t\toldcontext = MemoryContextSwitchTo(funcctx->multi_call_memory_ctx);\n\n\t\t/*\n\t\t * build tupdesc for result tuples (matches out parameters in pg_proc\n\t\t * entry)\n\t\t */\n\t\ttupdesc = CreateTemplateTupleDesc(4, false);\n\t\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"grantor\",\n\t\t\t\t\t\t   OIDOID, -1, 0);\n\t\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"grantee\",\n\t\t\t\t\t\t   OIDOID, -1, 0);\n\t\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"privilege_type\",\n\t\t\t\t\t\t   TEXTOID, -1, 0);\n\t\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"is_grantable\",\n\t\t\t\t\t\t   BOOLOID, -1, 0);\n\n\t\tfuncctx->tuple_desc = BlessTupleDesc(tupdesc);\n\n\t\t/* allocate memory for user context */\n\t\tidx = (int *) palloc(sizeof(int[2]));\n\t\tidx[0] = 0;\t\t\t\t/* ACL array item index */\n\t\tidx[1] = -1;\t\t\t/* privilege type counter */\n\t\tfuncctx->user_fctx = (void *) idx;\n\n\t\tMemoryContextSwitchTo(oldcontext);\n\t}\n\n\tfuncctx = SRF_PERCALL_SETUP();\n\tidx = (int *) funcctx->user_fctx;\n\taidat = ACL_DAT(acl);\n\n\t/* need test here in case acl has no items */\n\twhile (idx[0] < ACL_NUM(acl))\n\t{\n\t\tAclItem    *aidata;\n\t\tAclMode\t\tpriv_bit;\n\n\t\tidx[1]++;\n\t\tif (idx[1] == N_ACL_RIGHTS)\n\t\t{\n\t\t\tidx[1] = 0;\n\t\t\tidx[0]++;\n\t\t\tif (idx[0] >= ACL_NUM(acl)) /* done */\n\t\t\t\tbreak;\n\t\t}\n\t\taidata = &aidat[idx[0]];\n\t\tpriv_bit = 1 << idx[1];\n\n\t\tif (ACLITEM_GET_PRIVS(*aidata) & priv_bit)\n\t\t{\n\t\t\tDatum\t\tresult;\n\t\t\tDatum\t\tvalues[4];\n\t\t\tbool\t\tnulls[4];\n\t\t\tHeapTuple\ttuple;\n\n\t\t\tvalues[0] = ObjectIdGetDatum(aidata->ai_grantor);\n\t\t\tvalues[1] = ObjectIdGetDatum(aidata->ai_grantee);\n\t\t\tvalues[2] = CStringGetTextDatum(convert_aclright_to_string(priv_bit));\n\t\t\tvalues[3] = BoolGetDatum((ACLITEM_GET_GOPTIONS(*aidata) & priv_bit) != 0);\n\n\t\t\tMemSet(nulls, 0, sizeof(nulls));\n\n\t\t\ttuple = heap_form_tuple(funcctx->tuple_desc, values, nulls);\n\t\t\tresult = HeapTupleGetDatum(tuple);\n\n\t\t\tSRF_RETURN_NEXT(funcctx, result);\n\t\t}\n\t}\n\n\tSRF_RETURN_DONE(funcctx);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void check_acl(const Acl *acl);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SRF_RETURN_DONE",
          "args": [
            "funcctx"
          ],
          "line": 1830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SRF_RETURN_NEXT",
          "args": [
            "funcctx",
            "result"
          ],
          "line": 1826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleGetDatum",
          "args": [
            "tuple"
          ],
          "line": 1824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_form_tuple",
          "args": [
            "funcctx->tuple_desc",
            "values",
            "nulls"
          ],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "nulls",
            "0",
            "sizeof(nulls)"
          ],
          "line": 1821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BoolGetDatum",
          "args": [
            "(ACLITEM_GET_GOPTIONS(*aidata) & priv_bit) != 0"
          ],
          "line": 1819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_GOPTIONS",
          "args": [
            "*aidata"
          ],
          "line": 1819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "convert_aclright_to_string(priv_bit)"
          ],
          "line": 1818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_aclright_to_string",
          "args": [
            "priv_bit"
          ],
          "line": 1818
        },
        "resolved": true,
        "details": {
          "function_name": "convert_aclright_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1695-1728",
          "snippet": "static const char *\nconvert_aclright_to_string(int aclright)\n{\n\tswitch (aclright)\n\t{\n\t\tcase ACL_INSERT:\n\t\t\treturn \"INSERT\";\n\t\tcase ACL_SELECT:\n\t\t\treturn \"SELECT\";\n\t\tcase ACL_UPDATE:\n\t\t\treturn \"UPDATE\";\n\t\tcase ACL_DELETE:\n\t\t\treturn \"DELETE\";\n\t\tcase ACL_TRUNCATE:\n\t\t\treturn \"TRUNCATE\";\n\t\tcase ACL_REFERENCES:\n\t\t\treturn \"REFERENCES\";\n\t\tcase ACL_TRIGGER:\n\t\t\treturn \"TRIGGER\";\n\t\tcase ACL_EXECUTE:\n\t\t\treturn \"EXECUTE\";\n\t\tcase ACL_USAGE:\n\t\t\treturn \"USAGE\";\n\t\tcase ACL_CREATE:\n\t\t\treturn \"CREATE\";\n\t\tcase ACL_CREATE_TEMP:\n\t\t\treturn \"TEMPORARY\";\n\t\tcase ACL_CONNECT:\n\t\t\treturn \"CONNECT\";\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized aclright: %d\", aclright);\n\t\t\treturn NULL;\n\t}\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *\nconvert_aclright_to_string(int aclright)\n{\n\tswitch (aclright)\n\t{\n\t\tcase ACL_INSERT:\n\t\t\treturn \"INSERT\";\n\t\tcase ACL_SELECT:\n\t\t\treturn \"SELECT\";\n\t\tcase ACL_UPDATE:\n\t\t\treturn \"UPDATE\";\n\t\tcase ACL_DELETE:\n\t\t\treturn \"DELETE\";\n\t\tcase ACL_TRUNCATE:\n\t\t\treturn \"TRUNCATE\";\n\t\tcase ACL_REFERENCES:\n\t\t\treturn \"REFERENCES\";\n\t\tcase ACL_TRIGGER:\n\t\t\treturn \"TRIGGER\";\n\t\tcase ACL_EXECUTE:\n\t\t\treturn \"EXECUTE\";\n\t\tcase ACL_USAGE:\n\t\t\treturn \"USAGE\";\n\t\tcase ACL_CREATE:\n\t\t\treturn \"CREATE\";\n\t\tcase ACL_CREATE_TEMP:\n\t\t\treturn \"TEMPORARY\";\n\t\tcase ACL_CONNECT:\n\t\t\treturn \"CONNECT\";\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized aclright: %d\", aclright);\n\t\t\treturn NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "aidata->ai_grantee"
          ],
          "line": 1817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "aidata->ai_grantor"
          ],
          "line": 1816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_PRIVS",
          "args": [
            "*aidata"
          ],
          "line": 1809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 1803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 1793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "acl"
          ],
          "line": 1790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SRF_PERCALL_SETUP",
          "args": [],
          "line": 1788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "oldcontext"
          ],
          "line": 1785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(int[2])"
          ],
          "line": 1780
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BlessTupleDesc",
          "args": [
            "tupdesc"
          ],
          "line": 1777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 4",
            "\"is_grantable\"",
            "BOOLOID",
            "-1",
            "0"
          ],
          "line": 1774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 3",
            "\"privilege_type\"",
            "TEXTOID",
            "-1",
            "0"
          ],
          "line": 1772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 2",
            "\"grantee\"",
            "OIDOID",
            "-1",
            "0"
          ],
          "line": 1770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 1",
            "\"grantor\"",
            "OIDOID",
            "-1",
            "0"
          ],
          "line": 1768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CreateTemplateTupleDesc",
          "args": [
            "4",
            "false"
          ],
          "line": 1767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "funcctx->multi_call_memory_ctx"
          ],
          "line": 1761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SRF_FIRSTCALL_INIT",
          "args": [],
          "line": 1760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_acl",
          "args": [
            "acl"
          ],
          "line": 1758
        },
        "resolved": true,
        "details": {
          "function_name": "check_acl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "539-554",
          "snippet": "static void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nstatic void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}"
        }
      },
      {
        "call_info": {
          "callee": "SRF_IS_FIRSTCALL",
          "args": [],
          "line": 1753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ACL_P",
          "args": [
            "0"
          ],
          "line": 1748
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nDatum\naclexplode(PG_FUNCTION_ARGS)\n{\n\tAcl\t\t   *acl = PG_GETARG_ACL_P(0);\n\tFuncCallContext *funcctx;\n\tint\t\t   *idx;\n\tAclItem    *aidat;\n\n\tif (SRF_IS_FIRSTCALL())\n\t{\n\t\tTupleDesc\ttupdesc;\n\t\tMemoryContext oldcontext;\n\n\t\tcheck_acl(acl);\n\n\t\tfuncctx = SRF_FIRSTCALL_INIT();\n\t\toldcontext = MemoryContextSwitchTo(funcctx->multi_call_memory_ctx);\n\n\t\t/*\n\t\t * build tupdesc for result tuples (matches out parameters in pg_proc\n\t\t * entry)\n\t\t */\n\t\ttupdesc = CreateTemplateTupleDesc(4, false);\n\t\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"grantor\",\n\t\t\t\t\t\t   OIDOID, -1, 0);\n\t\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"grantee\",\n\t\t\t\t\t\t   OIDOID, -1, 0);\n\t\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"privilege_type\",\n\t\t\t\t\t\t   TEXTOID, -1, 0);\n\t\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"is_grantable\",\n\t\t\t\t\t\t   BOOLOID, -1, 0);\n\n\t\tfuncctx->tuple_desc = BlessTupleDesc(tupdesc);\n\n\t\t/* allocate memory for user context */\n\t\tidx = (int *) palloc(sizeof(int[2]));\n\t\tidx[0] = 0;\t\t\t\t/* ACL array item index */\n\t\tidx[1] = -1;\t\t\t/* privilege type counter */\n\t\tfuncctx->user_fctx = (void *) idx;\n\n\t\tMemoryContextSwitchTo(oldcontext);\n\t}\n\n\tfuncctx = SRF_PERCALL_SETUP();\n\tidx = (int *) funcctx->user_fctx;\n\taidat = ACL_DAT(acl);\n\n\t/* need test here in case acl has no items */\n\twhile (idx[0] < ACL_NUM(acl))\n\t{\n\t\tAclItem    *aidata;\n\t\tAclMode\t\tpriv_bit;\n\n\t\tidx[1]++;\n\t\tif (idx[1] == N_ACL_RIGHTS)\n\t\t{\n\t\t\tidx[1] = 0;\n\t\t\tidx[0]++;\n\t\t\tif (idx[0] >= ACL_NUM(acl)) /* done */\n\t\t\t\tbreak;\n\t\t}\n\t\taidata = &aidat[idx[0]];\n\t\tpriv_bit = 1 << idx[1];\n\n\t\tif (ACLITEM_GET_PRIVS(*aidata) & priv_bit)\n\t\t{\n\t\t\tDatum\t\tresult;\n\t\t\tDatum\t\tvalues[4];\n\t\t\tbool\t\tnulls[4];\n\t\t\tHeapTuple\ttuple;\n\n\t\t\tvalues[0] = ObjectIdGetDatum(aidata->ai_grantor);\n\t\t\tvalues[1] = ObjectIdGetDatum(aidata->ai_grantee);\n\t\t\tvalues[2] = CStringGetTextDatum(convert_aclright_to_string(priv_bit));\n\t\t\tvalues[3] = BoolGetDatum((ACLITEM_GET_GOPTIONS(*aidata) & priv_bit) != 0);\n\n\t\t\tMemSet(nulls, 0, sizeof(nulls));\n\n\t\t\ttuple = heap_form_tuple(funcctx->tuple_desc, values, nulls);\n\t\t\tresult = HeapTupleGetDatum(tuple);\n\n\t\t\tSRF_RETURN_NEXT(funcctx, result);\n\t\t}\n\t}\n\n\tSRF_RETURN_DONE(funcctx);\n}"
  },
  {
    "function_name": "convert_aclright_to_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1695-1728",
    "snippet": "static const char *\nconvert_aclright_to_string(int aclright)\n{\n\tswitch (aclright)\n\t{\n\t\tcase ACL_INSERT:\n\t\t\treturn \"INSERT\";\n\t\tcase ACL_SELECT:\n\t\t\treturn \"SELECT\";\n\t\tcase ACL_UPDATE:\n\t\t\treturn \"UPDATE\";\n\t\tcase ACL_DELETE:\n\t\t\treturn \"DELETE\";\n\t\tcase ACL_TRUNCATE:\n\t\t\treturn \"TRUNCATE\";\n\t\tcase ACL_REFERENCES:\n\t\t\treturn \"REFERENCES\";\n\t\tcase ACL_TRIGGER:\n\t\t\treturn \"TRIGGER\";\n\t\tcase ACL_EXECUTE:\n\t\t\treturn \"EXECUTE\";\n\t\tcase ACL_USAGE:\n\t\t\treturn \"USAGE\";\n\t\tcase ACL_CREATE:\n\t\t\treturn \"CREATE\";\n\t\tcase ACL_CREATE_TEMP:\n\t\t\treturn \"TEMPORARY\";\n\t\tcase ACL_CONNECT:\n\t\t\treturn \"CONNECT\";\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized aclright: %d\", aclright);\n\t\t\treturn NULL;\n\t}\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"unrecognized aclright: %d\"",
            "aclright"
          ],
          "line": 1725
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *\nconvert_aclright_to_string(int aclright)\n{\n\tswitch (aclright)\n\t{\n\t\tcase ACL_INSERT:\n\t\t\treturn \"INSERT\";\n\t\tcase ACL_SELECT:\n\t\t\treturn \"SELECT\";\n\t\tcase ACL_UPDATE:\n\t\t\treturn \"UPDATE\";\n\t\tcase ACL_DELETE:\n\t\t\treturn \"DELETE\";\n\t\tcase ACL_TRUNCATE:\n\t\t\treturn \"TRUNCATE\";\n\t\tcase ACL_REFERENCES:\n\t\t\treturn \"REFERENCES\";\n\t\tcase ACL_TRIGGER:\n\t\t\treturn \"TRIGGER\";\n\t\tcase ACL_EXECUTE:\n\t\t\treturn \"EXECUTE\";\n\t\tcase ACL_USAGE:\n\t\t\treturn \"USAGE\";\n\t\tcase ACL_CREATE:\n\t\t\treturn \"CREATE\";\n\t\tcase ACL_CREATE_TEMP:\n\t\t\treturn \"TEMPORARY\";\n\t\tcase ACL_CONNECT:\n\t\t\treturn \"CONNECT\";\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized aclright: %d\", aclright);\n\t\t\treturn NULL;\n\t}\n}"
  },
  {
    "function_name": "convert_any_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1647-1692",
    "snippet": "static AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pfree",
          "args": [
            "priv_type"
          ],
          "line": 1690
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1649-1655",
          "snippet": "static void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk))"
          ],
          "line": 1685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"unrecognized privilege type: \\\"%s\\\"\"",
            "chunk"
          ],
          "line": 1687
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_PARAMETER_VALUE"
          ],
          "line": 1686
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "this_priv->name",
            "chunk"
          ],
          "line": 1678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "(unsigned char) chunk[chunk_len - 1]"
          ],
          "line": 1671
        },
        "resolved": true,
        "details": {
          "function_name": "array_isspace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/arrayfuncs.c",
          "lines": "431-442",
          "snippet": "static bool\narray_isspace(char ch)\n{\n\tif (ch == ' ' ||\n\t\tch == '\\t' ||\n\t\tch == '\\n' ||\n\t\tch == '\\r' ||\n\t\tch == '\\v' ||\n\t\tch == '\\f')\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/arrayaccess.h\"",
            "#include \"utils/array.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"funcapi.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <math.h>",
            "#include <float.h>\t\t\t\t/* for _isnan */",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool array_isspace(char ch);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"utils/arrayaccess.h\"\n#include \"utils/array.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <math.h>\n#include <float.h>\t\t\t\t/* for _isnan */\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool array_isspace(char ch);\n\nstatic bool\narray_isspace(char ch)\n{\n\tif (ch == ' ' ||\n\t\tch == '\\t' ||\n\t\tch == '\\n' ||\n\t\tch == '\\r' ||\n\t\tch == '\\v' ||\n\t\tch == '\\f')\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "chunk"
          ],
          "line": 1670
        },
        "resolved": true,
        "details": {
          "function_name": "calcstrlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_cleanup.c",
          "lines": "361-380",
          "snippet": "static int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nstatic int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "chunk",
            "','"
          ],
          "line": 1663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "priv_type_text"
          ],
          "line": 1652
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges)\n{\n\tAclMode\t\tresult = 0;\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\tchar\t   *chunk;\n\tchar\t   *next_chunk;\n\n\t/* We rely on priv_type being a private, modifiable string */\n\tfor (chunk = priv_type; chunk; chunk = next_chunk)\n\t{\n\t\tint\t\t\tchunk_len;\n\t\tconst priv_map *this_priv;\n\n\t\t/* Split string at commas */\n\t\tnext_chunk = strchr(chunk, ',');\n\t\tif (next_chunk)\n\t\t\t*next_chunk++ = '\\0';\n\n\t\t/* Drop leading/trailing whitespace in this chunk */\n\t\twhile (*chunk && isspace((unsigned char) *chunk))\n\t\t\tchunk++;\n\t\tchunk_len = strlen(chunk);\n\t\twhile (chunk_len > 0 && isspace((unsigned char) chunk[chunk_len - 1]))\n\t\t\tchunk_len--;\n\t\tchunk[chunk_len] = '\\0';\n\n\t\t/* Match to the privileges list */\n\t\tfor (this_priv = privileges; this_priv->name; this_priv++)\n\t\t{\n\t\t\tif (pg_strcasecmp(this_priv->name, chunk) == 0)\n\t\t\t{\n\t\t\t\tresult |= this_priv->value;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this_priv->name)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", chunk)));\n\t}\n\n\tpfree(priv_type);\n\treturn result;\n}"
  },
  {
    "function_name": "convert_priv_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1597-1635",
    "snippet": "static AclMode\nconvert_priv_string(text *priv_type_text)\n{\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\n\tif (pg_strcasecmp(priv_type, \"SELECT\") == 0)\n\t\treturn ACL_SELECT;\n\tif (pg_strcasecmp(priv_type, \"INSERT\") == 0)\n\t\treturn ACL_INSERT;\n\tif (pg_strcasecmp(priv_type, \"UPDATE\") == 0)\n\t\treturn ACL_UPDATE;\n\tif (pg_strcasecmp(priv_type, \"DELETE\") == 0)\n\t\treturn ACL_DELETE;\n\tif (pg_strcasecmp(priv_type, \"TRUNCATE\") == 0)\n\t\treturn ACL_TRUNCATE;\n\tif (pg_strcasecmp(priv_type, \"REFERENCES\") == 0)\n\t\treturn ACL_REFERENCES;\n\tif (pg_strcasecmp(priv_type, \"TRIGGER\") == 0)\n\t\treturn ACL_TRIGGER;\n\tif (pg_strcasecmp(priv_type, \"EXECUTE\") == 0)\n\t\treturn ACL_EXECUTE;\n\tif (pg_strcasecmp(priv_type, \"USAGE\") == 0)\n\t\treturn ACL_USAGE;\n\tif (pg_strcasecmp(priv_type, \"CREATE\") == 0)\n\t\treturn ACL_CREATE;\n\tif (pg_strcasecmp(priv_type, \"TEMP\") == 0)\n\t\treturn ACL_CREATE_TEMP;\n\tif (pg_strcasecmp(priv_type, \"TEMPORARY\") == 0)\n\t\treturn ACL_CREATE_TEMP;\n\tif (pg_strcasecmp(priv_type, \"CONNECT\") == 0)\n\t\treturn ACL_CONNECT;\n\tif (pg_strcasecmp(priv_type, \"RULE\") == 0)\n\t\treturn 0;\t\t\t\t/* ignore old RULE privileges */\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", priv_type)));\n\treturn ACL_NO_RIGHTS;\t\t/* keep compiler quiet */\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static AclMode convert_priv_string(text *priv_type_text);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
      "static AclMode convert_table_priv_string(text *priv_type_text);",
      "static AclMode convert_sequence_priv_string(text *priv_type_text);",
      "static AclMode convert_column_priv_string(text *priv_type_text);",
      "static AclMode convert_database_priv_string(text *priv_type_text);",
      "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
      "static AclMode convert_function_priv_string(text *priv_type_text);",
      "static AclMode convert_language_priv_string(text *priv_type_text);",
      "static AclMode convert_schema_priv_string(text *priv_type_text);",
      "static AclMode convert_server_priv_string(text *priv_type_text);",
      "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
      "static AclMode convert_type_priv_string(text *priv_type_text);",
      "static AclMode convert_role_priv_string(text *priv_type_text);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", priv_type))"
          ],
          "line": 1631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"unrecognized privilege type: \\\"%s\\\"\"",
            "priv_type"
          ],
          "line": 1633
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_PARAMETER_VALUE"
          ],
          "line": 1632
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"RULE\""
          ],
          "line": 1628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"CONNECT\""
          ],
          "line": 1626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"TEMPORARY\""
          ],
          "line": 1624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"TEMP\""
          ],
          "line": 1622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"CREATE\""
          ],
          "line": 1620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"USAGE\""
          ],
          "line": 1618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"EXECUTE\""
          ],
          "line": 1616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"TRIGGER\""
          ],
          "line": 1614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"REFERENCES\""
          ],
          "line": 1612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"TRUNCATE\""
          ],
          "line": 1610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"DELETE\""
          ],
          "line": 1608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"UPDATE\""
          ],
          "line": 1606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"INSERT\""
          ],
          "line": 1604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "priv_type",
            "\"SELECT\""
          ],
          "line": 1602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "priv_type_text"
          ],
          "line": 1600
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_priv_string(text *priv_type_text)\n{\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\n\tif (pg_strcasecmp(priv_type, \"SELECT\") == 0)\n\t\treturn ACL_SELECT;\n\tif (pg_strcasecmp(priv_type, \"INSERT\") == 0)\n\t\treturn ACL_INSERT;\n\tif (pg_strcasecmp(priv_type, \"UPDATE\") == 0)\n\t\treturn ACL_UPDATE;\n\tif (pg_strcasecmp(priv_type, \"DELETE\") == 0)\n\t\treturn ACL_DELETE;\n\tif (pg_strcasecmp(priv_type, \"TRUNCATE\") == 0)\n\t\treturn ACL_TRUNCATE;\n\tif (pg_strcasecmp(priv_type, \"REFERENCES\") == 0)\n\t\treturn ACL_REFERENCES;\n\tif (pg_strcasecmp(priv_type, \"TRIGGER\") == 0)\n\t\treturn ACL_TRIGGER;\n\tif (pg_strcasecmp(priv_type, \"EXECUTE\") == 0)\n\t\treturn ACL_EXECUTE;\n\tif (pg_strcasecmp(priv_type, \"USAGE\") == 0)\n\t\treturn ACL_USAGE;\n\tif (pg_strcasecmp(priv_type, \"CREATE\") == 0)\n\t\treturn ACL_CREATE;\n\tif (pg_strcasecmp(priv_type, \"TEMP\") == 0)\n\t\treturn ACL_CREATE_TEMP;\n\tif (pg_strcasecmp(priv_type, \"TEMPORARY\") == 0)\n\t\treturn ACL_CREATE_TEMP;\n\tif (pg_strcasecmp(priv_type, \"CONNECT\") == 0)\n\t\treturn ACL_CONNECT;\n\tif (pg_strcasecmp(priv_type, \"RULE\") == 0)\n\t\treturn 0;\t\t\t\t/* ignore old RULE privileges */\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", priv_type)));\n\treturn ACL_NO_RIGHTS;\t\t/* keep compiler quiet */\n}"
  },
  {
    "function_name": "makeaclitem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1574-1595",
    "snippet": "Datum\nmakeaclitem(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tgrantee = PG_GETARG_OID(0);\n\tOid\t\t\tgrantor = PG_GETARG_OID(1);\n\ttext\t   *privtext = PG_GETARG_TEXT_PP(2);\n\tbool\t\tgoption = PG_GETARG_BOOL(3);\n\tAclItem    *result;\n\tAclMode\t\tpriv;\n\n\tpriv = convert_priv_string(privtext);\n\n\tresult = (AclItem *) palloc(sizeof(AclItem));\n\n\tresult->ai_grantee = grantee;\n\tresult->ai_grantor = grantor;\n\n\tACLITEM_SET_PRIVS_GOPTIONS(*result, priv,\n\t\t\t\t\t\t\t   (goption ? priv : ACL_NO_RIGHTS));\n\n\tPG_RETURN_ACLITEM_P(result);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_ACLITEM_P",
          "args": [
            "result"
          ],
          "line": 1594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_SET_PRIVS_GOPTIONS",
          "args": [
            "*result",
            "priv",
            "(goption ? priv : ACL_NO_RIGHTS)"
          ],
          "line": 1591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(AclItem)"
          ],
          "line": 1586
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_priv_string",
          "args": [
            "privtext"
          ],
          "line": 1584
        },
        "resolved": true,
        "details": {
          "function_name": "convert_priv_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1597-1635",
          "snippet": "static AclMode\nconvert_priv_string(text *priv_type_text)\n{\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\n\tif (pg_strcasecmp(priv_type, \"SELECT\") == 0)\n\t\treturn ACL_SELECT;\n\tif (pg_strcasecmp(priv_type, \"INSERT\") == 0)\n\t\treturn ACL_INSERT;\n\tif (pg_strcasecmp(priv_type, \"UPDATE\") == 0)\n\t\treturn ACL_UPDATE;\n\tif (pg_strcasecmp(priv_type, \"DELETE\") == 0)\n\t\treturn ACL_DELETE;\n\tif (pg_strcasecmp(priv_type, \"TRUNCATE\") == 0)\n\t\treturn ACL_TRUNCATE;\n\tif (pg_strcasecmp(priv_type, \"REFERENCES\") == 0)\n\t\treturn ACL_REFERENCES;\n\tif (pg_strcasecmp(priv_type, \"TRIGGER\") == 0)\n\t\treturn ACL_TRIGGER;\n\tif (pg_strcasecmp(priv_type, \"EXECUTE\") == 0)\n\t\treturn ACL_EXECUTE;\n\tif (pg_strcasecmp(priv_type, \"USAGE\") == 0)\n\t\treturn ACL_USAGE;\n\tif (pg_strcasecmp(priv_type, \"CREATE\") == 0)\n\t\treturn ACL_CREATE;\n\tif (pg_strcasecmp(priv_type, \"TEMP\") == 0)\n\t\treturn ACL_CREATE_TEMP;\n\tif (pg_strcasecmp(priv_type, \"TEMPORARY\") == 0)\n\t\treturn ACL_CREATE_TEMP;\n\tif (pg_strcasecmp(priv_type, \"CONNECT\") == 0)\n\t\treturn ACL_CONNECT;\n\tif (pg_strcasecmp(priv_type, \"RULE\") == 0)\n\t\treturn 0;\t\t\t\t/* ignore old RULE privileges */\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", priv_type)));\n\treturn ACL_NO_RIGHTS;\t\t/* keep compiler quiet */\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static AclMode convert_priv_string(text *priv_type_text);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclMode convert_table_priv_string(text *priv_type_text);",
            "static AclMode convert_sequence_priv_string(text *priv_type_text);",
            "static AclMode convert_column_priv_string(text *priv_type_text);",
            "static AclMode convert_database_priv_string(text *priv_type_text);",
            "static AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);",
            "static AclMode convert_function_priv_string(text *priv_type_text);",
            "static AclMode convert_language_priv_string(text *priv_type_text);",
            "static AclMode convert_schema_priv_string(text *priv_type_text);",
            "static AclMode convert_server_priv_string(text *priv_type_text);",
            "static AclMode convert_tablespace_priv_string(text *priv_type_text);",
            "static AclMode convert_type_priv_string(text *priv_type_text);",
            "static AclMode convert_role_priv_string(text *priv_type_text);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic AclMode convert_priv_string(text *priv_type_text);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclMode convert_table_priv_string(text *priv_type_text);\nstatic AclMode convert_sequence_priv_string(text *priv_type_text);\nstatic AclMode convert_column_priv_string(text *priv_type_text);\nstatic AclMode convert_database_priv_string(text *priv_type_text);\nstatic AclMode convert_foreign_data_wrapper_priv_string(text *priv_type_text);\nstatic AclMode convert_function_priv_string(text *priv_type_text);\nstatic AclMode convert_language_priv_string(text *priv_type_text);\nstatic AclMode convert_schema_priv_string(text *priv_type_text);\nstatic AclMode convert_server_priv_string(text *priv_type_text);\nstatic AclMode convert_tablespace_priv_string(text *priv_type_text);\nstatic AclMode convert_type_priv_string(text *priv_type_text);\nstatic AclMode convert_role_priv_string(text *priv_type_text);\n\nstatic AclMode\nconvert_priv_string(text *priv_type_text)\n{\n\tchar\t   *priv_type = text_to_cstring(priv_type_text);\n\n\tif (pg_strcasecmp(priv_type, \"SELECT\") == 0)\n\t\treturn ACL_SELECT;\n\tif (pg_strcasecmp(priv_type, \"INSERT\") == 0)\n\t\treturn ACL_INSERT;\n\tif (pg_strcasecmp(priv_type, \"UPDATE\") == 0)\n\t\treturn ACL_UPDATE;\n\tif (pg_strcasecmp(priv_type, \"DELETE\") == 0)\n\t\treturn ACL_DELETE;\n\tif (pg_strcasecmp(priv_type, \"TRUNCATE\") == 0)\n\t\treturn ACL_TRUNCATE;\n\tif (pg_strcasecmp(priv_type, \"REFERENCES\") == 0)\n\t\treturn ACL_REFERENCES;\n\tif (pg_strcasecmp(priv_type, \"TRIGGER\") == 0)\n\t\treturn ACL_TRIGGER;\n\tif (pg_strcasecmp(priv_type, \"EXECUTE\") == 0)\n\t\treturn ACL_EXECUTE;\n\tif (pg_strcasecmp(priv_type, \"USAGE\") == 0)\n\t\treturn ACL_USAGE;\n\tif (pg_strcasecmp(priv_type, \"CREATE\") == 0)\n\t\treturn ACL_CREATE;\n\tif (pg_strcasecmp(priv_type, \"TEMP\") == 0)\n\t\treturn ACL_CREATE_TEMP;\n\tif (pg_strcasecmp(priv_type, \"TEMPORARY\") == 0)\n\t\treturn ACL_CREATE_TEMP;\n\tif (pg_strcasecmp(priv_type, \"CONNECT\") == 0)\n\t\treturn ACL_CONNECT;\n\tif (pg_strcasecmp(priv_type, \"RULE\") == 0)\n\t\treturn 0;\t\t\t\t/* ignore old RULE privileges */\n\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t errmsg(\"unrecognized privilege type: \\\"%s\\\"\", priv_type)));\n\treturn ACL_NO_RIGHTS;\t\t/* keep compiler quiet */\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_BOOL",
          "args": [
            "3"
          ],
          "line": 1580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "2"
          ],
          "line": 1579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 1578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nmakeaclitem(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tgrantee = PG_GETARG_OID(0);\n\tOid\t\t\tgrantor = PG_GETARG_OID(1);\n\ttext\t   *privtext = PG_GETARG_TEXT_PP(2);\n\tbool\t\tgoption = PG_GETARG_BOOL(3);\n\tAclItem    *result;\n\tAclMode\t\tpriv;\n\n\tpriv = convert_priv_string(privtext);\n\n\tresult = (AclItem *) palloc(sizeof(AclItem));\n\n\tresult->ai_grantee = grantee;\n\tresult->ai_grantor = grantor;\n\n\tACLITEM_SET_PRIVS_GOPTIONS(*result, priv,\n\t\t\t\t\t\t\t   (goption ? priv : ACL_NO_RIGHTS));\n\n\tPG_RETURN_ACLITEM_P(result);\n}"
  },
  {
    "function_name": "aclcontains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1552-1572",
    "snippet": "Datum\naclcontains(PG_FUNCTION_ARGS)\n{\n\tAcl\t\t   *acl = PG_GETARG_ACL_P(0);\n\tAclItem    *aip = PG_GETARG_ACLITEM_P(1);\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\tcheck_acl(acl);\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\tfor (i = 0; i < num; ++i)\n\t{\n\t\tif (aip->ai_grantee == aidat[i].ai_grantee &&\n\t\t\taip->ai_grantor == aidat[i].ai_grantor &&\n\t\t\t(ACLITEM_GET_RIGHTS(*aip) & ACLITEM_GET_RIGHTS(aidat[i])) == ACLITEM_GET_RIGHTS(*aip))\n\t\t\tPG_RETURN_BOOL(true);\n\t}\n\tPG_RETURN_BOOL(false);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void check_acl(const Acl *acl);",
      "static const char *aclparse(const char *s, AclItem *aip);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "false"
          ],
          "line": 1571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "true"
          ],
          "line": 1569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "*aip"
          ],
          "line": 1568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "aidat[i]"
          ],
          "line": 1568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "*aip"
          ],
          "line": 1568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "acl"
          ],
          "line": 1563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 1562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_acl",
          "args": [
            "acl"
          ],
          "line": 1561
        },
        "resolved": true,
        "details": {
          "function_name": "check_acl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "539-554",
          "snippet": "static void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nstatic void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ACLITEM_P",
          "args": [
            "1"
          ],
          "line": 1556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ACL_P",
          "args": [
            "0"
          ],
          "line": 1555
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\nstatic const char *aclparse(const char *s, AclItem *aip);\n\nDatum\naclcontains(PG_FUNCTION_ARGS)\n{\n\tAcl\t\t   *acl = PG_GETARG_ACL_P(0);\n\tAclItem    *aip = PG_GETARG_ACLITEM_P(1);\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\tcheck_acl(acl);\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\tfor (i = 0; i < num; ++i)\n\t{\n\t\tif (aip->ai_grantee == aidat[i].ai_grantee &&\n\t\t\taip->ai_grantor == aidat[i].ai_grantor &&\n\t\t\t(ACLITEM_GET_RIGHTS(*aip) & ACLITEM_GET_RIGHTS(aidat[i])) == ACLITEM_GET_RIGHTS(*aip))\n\t\t\tPG_RETURN_BOOL(true);\n\t}\n\tPG_RETURN_BOOL(false);\n}"
  },
  {
    "function_name": "aclremove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1542-1550",
    "snippet": "Datum\naclremove(PG_FUNCTION_ARGS)\n{\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t errmsg(\"aclremove is no longer supported\")));\n\n\tPG_RETURN_NULL();\t\t\t/* keep compiler quiet */\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t errmsg(\"aclremove is no longer supported\"))"
          ],
          "line": 1545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"aclremove is no longer supported\""
          ],
          "line": 1547
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_FEATURE_NOT_SUPPORTED"
          ],
          "line": 1546
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\naclremove(PG_FUNCTION_ARGS)\n{\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t errmsg(\"aclremove is no longer supported\")));\n\n\tPG_RETURN_NULL();\t\t\t/* keep compiler quiet */\n}"
  },
  {
    "function_name": "aclinsert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1532-1540",
    "snippet": "Datum\naclinsert(PG_FUNCTION_ARGS)\n{\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t errmsg(\"aclinsert is no longer supported\")));\n\n\tPG_RETURN_NULL();\t\t\t/* keep compiler quiet */\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t errmsg(\"aclinsert is no longer supported\"))"
          ],
          "line": 1535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"aclinsert is no longer supported\""
          ],
          "line": 1537
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_FEATURE_NOT_SUPPORTED"
          ],
          "line": 1536
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\naclinsert(PG_FUNCTION_ARGS)\n{\n\tereport(ERROR,\n\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t errmsg(\"aclinsert is no longer supported\")));\n\n\tPG_RETURN_NULL();\t\t\t/* keep compiler quiet */\n}"
  },
  {
    "function_name": "aclmembers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1472-1526",
    "snippet": "int\naclmembers(const Acl *acl, Oid **roleids)\n{\n\tOid\t\t   *list;\n\tconst AclItem *acldat;\n\tint\t\t\ti,\n\t\t\t\tj,\n\t\t\t\tk;\n\n\tif (acl == NULL || ACL_NUM(acl) == 0)\n\t{\n\t\t*roleids = NULL;\n\t\treturn 0;\n\t}\n\n\tcheck_acl(acl);\n\n\t/* Allocate the worst-case space requirement */\n\tlist = palloc(ACL_NUM(acl) * 2 * sizeof(Oid));\n\tacldat = ACL_DAT(acl);\n\n\t/*\n\t * Walk the ACL collecting mentioned RoleIds.\n\t */\n\tj = 0;\n\tfor (i = 0; i < ACL_NUM(acl); i++)\n\t{\n\t\tconst AclItem *ai = &acldat[i];\n\n\t\tif (ai->ai_grantee != ACL_ID_PUBLIC)\n\t\t\tlist[j++] = ai->ai_grantee;\n\t\t/* grantor is currently never PUBLIC, but let's check anyway */\n\t\tif (ai->ai_grantor != ACL_ID_PUBLIC)\n\t\t\tlist[j++] = ai->ai_grantor;\n\t}\n\n\t/* Sort the array */\n\tqsort(list, j, sizeof(Oid), oid_cmp);\n\n\t/* Remove duplicates from the array */\n\tk = 0;\n\tfor (i = 1; i < j; i++)\n\t{\n\t\tif (list[k] != list[i])\n\t\t\tlist[++k] = list[i];\n\t}\n\n\t/*\n\t * We could repalloc the array down to minimum size, but it's hardly worth\n\t * it since it's only transient memory.\n\t */\n\t*roleids = list;\n\n\treturn k + 1;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static void check_acl(const Acl *acl);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qsort",
          "args": [
            "list",
            "j",
            "sizeof(Oid)",
            "oid_cmp"
          ],
          "line": 1509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "acl"
          ],
          "line": 1491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "ACL_NUM(acl) * 2 * sizeof(Oid)"
          ],
          "line": 1490
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_acl",
          "args": [
            "acl"
          ],
          "line": 1487
        },
        "resolved": true,
        "details": {
          "function_name": "check_acl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "539-554",
          "snippet": "static void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nstatic void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 1481
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic void check_acl(const Acl *acl);\n\nint\naclmembers(const Acl *acl, Oid **roleids)\n{\n\tOid\t\t   *list;\n\tconst AclItem *acldat;\n\tint\t\t\ti,\n\t\t\t\tj,\n\t\t\t\tk;\n\n\tif (acl == NULL || ACL_NUM(acl) == 0)\n\t{\n\t\t*roleids = NULL;\n\t\treturn 0;\n\t}\n\n\tcheck_acl(acl);\n\n\t/* Allocate the worst-case space requirement */\n\tlist = palloc(ACL_NUM(acl) * 2 * sizeof(Oid));\n\tacldat = ACL_DAT(acl);\n\n\t/*\n\t * Walk the ACL collecting mentioned RoleIds.\n\t */\n\tj = 0;\n\tfor (i = 0; i < ACL_NUM(acl); i++)\n\t{\n\t\tconst AclItem *ai = &acldat[i];\n\n\t\tif (ai->ai_grantee != ACL_ID_PUBLIC)\n\t\t\tlist[j++] = ai->ai_grantee;\n\t\t/* grantor is currently never PUBLIC, but let's check anyway */\n\t\tif (ai->ai_grantor != ACL_ID_PUBLIC)\n\t\t\tlist[j++] = ai->ai_grantor;\n\t}\n\n\t/* Sort the array */\n\tqsort(list, j, sizeof(Oid), oid_cmp);\n\n\t/* Remove duplicates from the array */\n\tk = 0;\n\tfor (i = 1; i < j; i++)\n\t{\n\t\tif (list[k] != list[i])\n\t\t\tlist[++k] = list[i];\n\t}\n\n\t/*\n\t * We could repalloc the array down to minimum size, but it's hardly worth\n\t * it since it's only transient memory.\n\t */\n\t*roleids = list;\n\n\treturn k + 1;\n}"
  },
  {
    "function_name": "aclmask_direct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1409-1461",
    "snippet": "static AclMode\naclmask_direct(const Acl *acl, Oid roleid, Oid ownerId,\n\t\t\t   AclMode mask, AclMaskHow how)\n{\n\tAclMode\t\tresult;\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/*\n\t * Null ACL should not happen, since caller should have inserted\n\t * appropriate default\n\t */\n\tif (acl == NULL)\n\t\telog(ERROR, \"null ACL\");\n\n\tcheck_acl(acl);\n\n\t/* Quick exit for mask == 0 */\n\tif (mask == 0)\n\t\treturn 0;\n\n\tresult = 0;\n\n\t/* Owner always implicitly has all grant options */\n\tif ((mask & ACLITEM_ALL_GOPTION_BITS) &&\n\t\troleid == ownerId)\n\t{\n\t\tresult = mask & ACLITEM_ALL_GOPTION_BITS;\n\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\treturn result;\n\t}\n\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\n\t/*\n\t * Check privileges granted directly to roleid (and not to public)\n\t */\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == roleid)\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn result;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void check_acl(const Acl *acl);",
      "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "acl"
          ],
          "line": 1443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 1442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_acl",
          "args": [
            "acl"
          ],
          "line": 1425
        },
        "resolved": true,
        "details": {
          "function_name": "check_acl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "539-554",
          "snippet": "static void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nstatic void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}"
        }
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"null ACL\""
          ],
          "line": 1423
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nstatic AclMode\naclmask_direct(const Acl *acl, Oid roleid, Oid ownerId,\n\t\t\t   AclMode mask, AclMaskHow how)\n{\n\tAclMode\t\tresult;\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/*\n\t * Null ACL should not happen, since caller should have inserted\n\t * appropriate default\n\t */\n\tif (acl == NULL)\n\t\telog(ERROR, \"null ACL\");\n\n\tcheck_acl(acl);\n\n\t/* Quick exit for mask == 0 */\n\tif (mask == 0)\n\t\treturn 0;\n\n\tresult = 0;\n\n\t/* Owner always implicitly has all grant options */\n\tif ((mask & ACLITEM_ALL_GOPTION_BITS) &&\n\t\troleid == ownerId)\n\t{\n\t\tresult = mask & ACLITEM_ALL_GOPTION_BITS;\n\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\treturn result;\n\t}\n\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\n\t/*\n\t * Check privileges granted directly to roleid (and not to public)\n\t */\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == roleid)\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn result;\n}"
  },
  {
    "function_name": "aclmask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1320-1400",
    "snippet": "AclMode\naclmask(const Acl *acl, Oid roleid, Oid ownerId,\n\t\tAclMode mask, AclMaskHow how)\n{\n\tAclMode\t\tresult;\n\tAclMode\t\tremaining;\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/*\n\t * Null ACL should not happen, since caller should have inserted\n\t * appropriate default\n\t */\n\tif (acl == NULL)\n\t\telog(ERROR, \"null ACL\");\n\n\tcheck_acl(acl);\n\n\t/* Quick exit for mask == 0 */\n\tif (mask == 0)\n\t\treturn 0;\n\n\tresult = 0;\n\n\t/* Owner always implicitly has all grant options */\n\tif ((mask & ACLITEM_ALL_GOPTION_BITS) &&\n\t\thas_privs_of_role(roleid, ownerId))\n\t{\n\t\tresult = mask & ACLITEM_ALL_GOPTION_BITS;\n\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\treturn result;\n\t}\n\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\n\t/*\n\t * Check privileges granted directly to roleid or to public\n\t */\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == ACL_ID_PUBLIC ||\n\t\t\taidata->ai_grantee == roleid)\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t}\n\t}\n\n\t/*\n\t * Check privileges granted indirectly via role memberships. We do this in\n\t * a separate pass to minimize expensive indirect membership tests.  In\n\t * particular, it's worth testing whether a given ACL entry grants any\n\t * privileges still of interest before we perform the has_privs_of_role\n\t * test.\n\t */\n\tremaining = mask & ~result;\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == ACL_ID_PUBLIC ||\n\t\t\taidata->ai_grantee == roleid)\n\t\t\tcontinue;\t\t\t/* already checked it */\n\n\t\tif ((aidata->ai_privs & remaining) &&\n\t\t\thas_privs_of_role(roleid, aidata->ai_grantee))\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t\tremaining = mask & ~result;\n\t\t}\n\t}\n\n\treturn result;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static void check_acl(const Acl *acl);",
      "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "roleid",
            "aidata->ai_grantee"
          ],
          "line": 1390
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "acl"
          ],
          "line": 1355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_acl",
          "args": [
            "acl"
          ],
          "line": 1337
        },
        "resolved": true,
        "details": {
          "function_name": "check_acl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "539-554",
          "snippet": "static void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nstatic void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}"
        }
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"null ACL\""
          ],
          "line": 1335
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic void check_acl(const Acl *acl);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nAclMode\naclmask(const Acl *acl, Oid roleid, Oid ownerId,\n\t\tAclMode mask, AclMaskHow how)\n{\n\tAclMode\t\tresult;\n\tAclMode\t\tremaining;\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/*\n\t * Null ACL should not happen, since caller should have inserted\n\t * appropriate default\n\t */\n\tif (acl == NULL)\n\t\telog(ERROR, \"null ACL\");\n\n\tcheck_acl(acl);\n\n\t/* Quick exit for mask == 0 */\n\tif (mask == 0)\n\t\treturn 0;\n\n\tresult = 0;\n\n\t/* Owner always implicitly has all grant options */\n\tif ((mask & ACLITEM_ALL_GOPTION_BITS) &&\n\t\thas_privs_of_role(roleid, ownerId))\n\t{\n\t\tresult = mask & ACLITEM_ALL_GOPTION_BITS;\n\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\treturn result;\n\t}\n\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\n\t/*\n\t * Check privileges granted directly to roleid or to public\n\t */\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == ACL_ID_PUBLIC ||\n\t\t\taidata->ai_grantee == roleid)\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t}\n\t}\n\n\t/*\n\t * Check privileges granted indirectly via role memberships. We do this in\n\t * a separate pass to minimize expensive indirect membership tests.  In\n\t * particular, it's worth testing whether a given ACL entry grants any\n\t * privileges still of interest before we perform the has_privs_of_role\n\t * test.\n\t */\n\tremaining = mask & ~result;\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == ACL_ID_PUBLIC ||\n\t\t\taidata->ai_grantee == roleid)\n\t\t\tcontinue;\t\t\t/* already checked it */\n\n\t\tif ((aidata->ai_privs & remaining) &&\n\t\t\thas_privs_of_role(roleid, aidata->ai_grantee))\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t\tremaining = mask & ~result;\n\t\t}\n\t}\n\n\treturn result;\n}"
  },
  {
    "function_name": "recursive_revoke",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1234-1294",
    "snippet": "static Acl *\nrecursive_revoke(Acl *acl,\n\t\t\t\t Oid grantee,\n\t\t\t\t AclMode revoke_privs,\n\t\t\t\t Oid ownerId,\n\t\t\t\t DropBehavior behavior)\n{\n\tAclMode\t\tstill_has;\n\tAclItem    *aip;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\tcheck_acl(acl);\n\n\t/* The owner can never truly lose grant options, so short-circuit */\n\tif (grantee == ownerId)\n\t\treturn acl;\n\n\t/* The grantee might still have some grant options via another grantor */\n\tstill_has = aclmask(acl, grantee, ownerId,\n\t\t\t\t\t\tACL_GRANT_OPTION_FOR(revoke_privs),\n\t\t\t\t\t\tACLMASK_ALL);\n\trevoke_privs &= ~ACL_OPTION_TO_PRIVS(still_has);\n\tif (revoke_privs == ACL_NO_RIGHTS)\n\t\treturn acl;\n\nrestart:\n\tnum = ACL_NUM(acl);\n\taip = ACL_DAT(acl);\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tif (aip[i].ai_grantor == grantee\n\t\t\t&& (ACLITEM_GET_PRIVS(aip[i]) & revoke_privs) != 0)\n\t\t{\n\t\t\tAclItem\t\tmod_acl;\n\t\t\tAcl\t\t   *new_acl;\n\n\t\t\tif (behavior == DROP_RESTRICT)\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_DEPENDENT_OBJECTS_STILL_EXIST),\n\t\t\t\t\t\t errmsg(\"dependent privileges exist\"),\n\t\t\t\t\t\t errhint(\"Use CASCADE to revoke them too.\")));\n\n\t\t\tmod_acl.ai_grantor = grantee;\n\t\t\tmod_acl.ai_grantee = aip[i].ai_grantee;\n\t\t\tACLITEM_SET_PRIVS_GOPTIONS(mod_acl,\n\t\t\t\t\t\t\t\t\t   revoke_privs,\n\t\t\t\t\t\t\t\t\t   revoke_privs);\n\n\t\t\tnew_acl = aclupdate(acl, &mod_acl, ACL_MODECHG_DEL,\n\t\t\t\t\t\t\t\townerId, behavior);\n\n\t\t\tpfree(acl);\n\t\t\tacl = new_acl;\n\n\t\t\tgoto restart;\n\t\t}\n\t}\n\n\treturn acl;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void check_acl(const Acl *acl);",
      "static const char *aclparse(const char *s, AclItem *aip);",
      "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
      "static Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pfree",
          "args": [
            "acl"
          ],
          "line": 1286
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1649-1655",
          "snippet": "static void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "aclupdate",
          "args": [
            "acl",
            "&mod_acl",
            "ACL_MODECHG_DEL",
            "ownerId",
            "behavior"
          ],
          "line": 1283
        },
        "resolved": true,
        "details": {
          "function_name": "aclupdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "930-1038",
          "snippet": "Acl *\naclupdate(const Acl *old_acl, const AclItem *mod_aip,\n\t\t  int modechg, Oid ownerId, DropBehavior behavior)\n{\n\tAcl\t\t   *new_acl = NULL;\n\tAclItem    *old_aip,\n\t\t\t   *new_aip = NULL;\n\tAclMode\t\told_rights,\n\t\t\t\told_goptions,\n\t\t\t\tnew_rights,\n\t\t\t\tnew_goptions;\n\tint\t\t\tdst,\n\t\t\t\tnum;\n\n\t/* Caller probably already checked old_acl, but be safe */\n\tcheck_acl(old_acl);\n\n\t/* If granting grant options, check for circularity */\n\tif (modechg != ACL_MODECHG_DEL &&\n\t\tACLITEM_GET_GOPTIONS(*mod_aip) != ACL_NO_RIGHTS)\n\t\tcheck_circularity(old_acl, mod_aip, ownerId);\n\n\tnum = ACL_NUM(old_acl);\n\told_aip = ACL_DAT(old_acl);\n\n\t/*\n\t * Search the ACL for an existing entry for this grantee and grantor. If\n\t * one exists, just modify the entry in-place (well, in the same position,\n\t * since we actually return a copy); otherwise, insert the new entry at\n\t * the end.\n\t */\n\n\tfor (dst = 0; dst < num; ++dst)\n\t{\n\t\tif (aclitem_match(mod_aip, old_aip + dst))\n\t\t{\n\t\t\t/* found a match, so modify existing item */\n\t\t\tnew_acl = allocacl(num);\n\t\t\tnew_aip = ACL_DAT(new_acl);\n\t\t\tmemcpy(new_acl, old_acl, ACL_SIZE(old_acl));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (dst == num)\n\t{\n\t\t/* need to append a new item */\n\t\tnew_acl = allocacl(num + 1);\n\t\tnew_aip = ACL_DAT(new_acl);\n\t\tmemcpy(new_aip, old_aip, num * sizeof(AclItem));\n\n\t\t/* initialize the new entry with no permissions */\n\t\tnew_aip[dst].ai_grantee = mod_aip->ai_grantee;\n\t\tnew_aip[dst].ai_grantor = mod_aip->ai_grantor;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(new_aip[dst],\n\t\t\t\t\t\t\t\t   ACL_NO_RIGHTS, ACL_NO_RIGHTS);\n\t\tnum++;\t\t\t\t\t/* set num to the size of new_acl */\n\t}\n\n\told_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\told_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/* apply the specified permissions change */\n\tswitch (modechg)\n\t{\n\t\tcase ACL_MODECHG_ADD:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights | ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_DEL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights & ~ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_EQL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t}\n\n\tnew_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\tnew_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/*\n\t * If the adjusted entry has no permissions, delete it from the list.\n\t */\n\tif (new_rights == ACL_NO_RIGHTS)\n\t{\n\t\tmemmove(new_aip + dst,\n\t\t\t\tnew_aip + dst + 1,\n\t\t\t\t(num - dst - 1) * sizeof(AclItem));\n\t\t/* Adjust array size to be 'num - 1' items */\n\t\tARR_DIMS(new_acl)[0] = num - 1;\n\t\tSET_VARSIZE(new_acl, ACL_N_SIZE(num - 1));\n\t}\n\n\t/*\n\t * Remove abandoned privileges (cascading revoke).  Currently we can only\n\t * handle this when the grantee is not PUBLIC.\n\t */\n\tif ((old_goptions & ~new_goptions) != 0)\n\t{\n\t\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\t\tnew_acl = recursive_revoke(new_acl, mod_aip->ai_grantee,\n\t\t\t\t\t\t\t\t   (old_goptions & ~new_goptions),\n\t\t\t\t\t\t\t\t   ownerId, behavior);\n\t}\n\n\treturn new_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
            "static Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nAcl *\naclupdate(const Acl *old_acl, const AclItem *mod_aip,\n\t\t  int modechg, Oid ownerId, DropBehavior behavior)\n{\n\tAcl\t\t   *new_acl = NULL;\n\tAclItem    *old_aip,\n\t\t\t   *new_aip = NULL;\n\tAclMode\t\told_rights,\n\t\t\t\told_goptions,\n\t\t\t\tnew_rights,\n\t\t\t\tnew_goptions;\n\tint\t\t\tdst,\n\t\t\t\tnum;\n\n\t/* Caller probably already checked old_acl, but be safe */\n\tcheck_acl(old_acl);\n\n\t/* If granting grant options, check for circularity */\n\tif (modechg != ACL_MODECHG_DEL &&\n\t\tACLITEM_GET_GOPTIONS(*mod_aip) != ACL_NO_RIGHTS)\n\t\tcheck_circularity(old_acl, mod_aip, ownerId);\n\n\tnum = ACL_NUM(old_acl);\n\told_aip = ACL_DAT(old_acl);\n\n\t/*\n\t * Search the ACL for an existing entry for this grantee and grantor. If\n\t * one exists, just modify the entry in-place (well, in the same position,\n\t * since we actually return a copy); otherwise, insert the new entry at\n\t * the end.\n\t */\n\n\tfor (dst = 0; dst < num; ++dst)\n\t{\n\t\tif (aclitem_match(mod_aip, old_aip + dst))\n\t\t{\n\t\t\t/* found a match, so modify existing item */\n\t\t\tnew_acl = allocacl(num);\n\t\t\tnew_aip = ACL_DAT(new_acl);\n\t\t\tmemcpy(new_acl, old_acl, ACL_SIZE(old_acl));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (dst == num)\n\t{\n\t\t/* need to append a new item */\n\t\tnew_acl = allocacl(num + 1);\n\t\tnew_aip = ACL_DAT(new_acl);\n\t\tmemcpy(new_aip, old_aip, num * sizeof(AclItem));\n\n\t\t/* initialize the new entry with no permissions */\n\t\tnew_aip[dst].ai_grantee = mod_aip->ai_grantee;\n\t\tnew_aip[dst].ai_grantor = mod_aip->ai_grantor;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(new_aip[dst],\n\t\t\t\t\t\t\t\t   ACL_NO_RIGHTS, ACL_NO_RIGHTS);\n\t\tnum++;\t\t\t\t\t/* set num to the size of new_acl */\n\t}\n\n\told_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\told_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/* apply the specified permissions change */\n\tswitch (modechg)\n\t{\n\t\tcase ACL_MODECHG_ADD:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights | ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_DEL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights & ~ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_EQL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t}\n\n\tnew_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\tnew_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/*\n\t * If the adjusted entry has no permissions, delete it from the list.\n\t */\n\tif (new_rights == ACL_NO_RIGHTS)\n\t{\n\t\tmemmove(new_aip + dst,\n\t\t\t\tnew_aip + dst + 1,\n\t\t\t\t(num - dst - 1) * sizeof(AclItem));\n\t\t/* Adjust array size to be 'num - 1' items */\n\t\tARR_DIMS(new_acl)[0] = num - 1;\n\t\tSET_VARSIZE(new_acl, ACL_N_SIZE(num - 1));\n\t}\n\n\t/*\n\t * Remove abandoned privileges (cascading revoke).  Currently we can only\n\t * handle this when the grantee is not PUBLIC.\n\t */\n\tif ((old_goptions & ~new_goptions) != 0)\n\t{\n\t\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\t\tnew_acl = recursive_revoke(new_acl, mod_aip->ai_grantee,\n\t\t\t\t\t\t\t\t   (old_goptions & ~new_goptions),\n\t\t\t\t\t\t\t\t   ownerId, behavior);\n\t}\n\n\treturn new_acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACLITEM_SET_PRIVS_GOPTIONS",
          "args": [
            "mod_acl",
            "revoke_privs",
            "revoke_privs"
          ],
          "line": 1279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_DEPENDENT_OBJECTS_STILL_EXIST),\n\t\t\t\t\t\t errmsg(\"dependent privileges exist\"),\n\t\t\t\t\t\t errhint(\"Use CASCADE to revoke them too.\"))"
          ],
          "line": 1272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errhint",
          "args": [
            "\"Use CASCADE to revoke them too.\""
          ],
          "line": 1275
        },
        "resolved": true,
        "details": {
          "function_name": "errhint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "984-999",
          "snippet": "int\nerrhint(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, hint, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrhint(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, hint, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"dependent privileges exist\""
          ],
          "line": 1274
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_DEPENDENT_OBJECTS_STILL_EXIST"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_PRIVS",
          "args": [
            "aip[i]"
          ],
          "line": 1266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "acl"
          ],
          "line": 1262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_OPTION_TO_PRIVS",
          "args": [
            "still_has"
          ],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aclmask",
          "args": [
            "acl",
            "grantee",
            "ownerId",
            "ACL_GRANT_OPTION_FOR(revoke_privs)",
            "ACLMASK_ALL"
          ],
          "line": 1253
        },
        "resolved": true,
        "details": {
          "function_name": "aclmask_direct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1409-1461",
          "snippet": "static AclMode\naclmask_direct(const Acl *acl, Oid roleid, Oid ownerId,\n\t\t\t   AclMode mask, AclMaskHow how)\n{\n\tAclMode\t\tresult;\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/*\n\t * Null ACL should not happen, since caller should have inserted\n\t * appropriate default\n\t */\n\tif (acl == NULL)\n\t\telog(ERROR, \"null ACL\");\n\n\tcheck_acl(acl);\n\n\t/* Quick exit for mask == 0 */\n\tif (mask == 0)\n\t\treturn 0;\n\n\tresult = 0;\n\n\t/* Owner always implicitly has all grant options */\n\tif ((mask & ACLITEM_ALL_GOPTION_BITS) &&\n\t\troleid == ownerId)\n\t{\n\t\tresult = mask & ACLITEM_ALL_GOPTION_BITS;\n\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\treturn result;\n\t}\n\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\n\t/*\n\t * Check privileges granted directly to roleid (and not to public)\n\t */\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == roleid)\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);",
            "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nstatic AclMode\naclmask_direct(const Acl *acl, Oid roleid, Oid ownerId,\n\t\t\t   AclMode mask, AclMaskHow how)\n{\n\tAclMode\t\tresult;\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/*\n\t * Null ACL should not happen, since caller should have inserted\n\t * appropriate default\n\t */\n\tif (acl == NULL)\n\t\telog(ERROR, \"null ACL\");\n\n\tcheck_acl(acl);\n\n\t/* Quick exit for mask == 0 */\n\tif (mask == 0)\n\t\treturn 0;\n\n\tresult = 0;\n\n\t/* Owner always implicitly has all grant options */\n\tif ((mask & ACLITEM_ALL_GOPTION_BITS) &&\n\t\troleid == ownerId)\n\t{\n\t\tresult = mask & ACLITEM_ALL_GOPTION_BITS;\n\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\treturn result;\n\t}\n\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\n\t/*\n\t * Check privileges granted directly to roleid (and not to public)\n\t */\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == roleid)\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "revoke_privs"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_acl",
          "args": [
            "acl"
          ],
          "line": 1246
        },
        "resolved": true,
        "details": {
          "function_name": "check_acl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "539-554",
          "snippet": "static void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nstatic void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\nstatic const char *aclparse(const char *s, AclItem *aip);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nstatic Acl *\nrecursive_revoke(Acl *acl,\n\t\t\t\t Oid grantee,\n\t\t\t\t AclMode revoke_privs,\n\t\t\t\t Oid ownerId,\n\t\t\t\t DropBehavior behavior)\n{\n\tAclMode\t\tstill_has;\n\tAclItem    *aip;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\tcheck_acl(acl);\n\n\t/* The owner can never truly lose grant options, so short-circuit */\n\tif (grantee == ownerId)\n\t\treturn acl;\n\n\t/* The grantee might still have some grant options via another grantor */\n\tstill_has = aclmask(acl, grantee, ownerId,\n\t\t\t\t\t\tACL_GRANT_OPTION_FOR(revoke_privs),\n\t\t\t\t\t\tACLMASK_ALL);\n\trevoke_privs &= ~ACL_OPTION_TO_PRIVS(still_has);\n\tif (revoke_privs == ACL_NO_RIGHTS)\n\t\treturn acl;\n\nrestart:\n\tnum = ACL_NUM(acl);\n\taip = ACL_DAT(acl);\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tif (aip[i].ai_grantor == grantee\n\t\t\t&& (ACLITEM_GET_PRIVS(aip[i]) & revoke_privs) != 0)\n\t\t{\n\t\t\tAclItem\t\tmod_acl;\n\t\t\tAcl\t\t   *new_acl;\n\n\t\t\tif (behavior == DROP_RESTRICT)\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_DEPENDENT_OBJECTS_STILL_EXIST),\n\t\t\t\t\t\t errmsg(\"dependent privileges exist\"),\n\t\t\t\t\t\t errhint(\"Use CASCADE to revoke them too.\")));\n\n\t\t\tmod_acl.ai_grantor = grantee;\n\t\t\tmod_acl.ai_grantee = aip[i].ai_grantee;\n\t\t\tACLITEM_SET_PRIVS_GOPTIONS(mod_acl,\n\t\t\t\t\t\t\t\t\t   revoke_privs,\n\t\t\t\t\t\t\t\t\t   revoke_privs);\n\n\t\t\tnew_acl = aclupdate(acl, &mod_acl, ACL_MODECHG_DEL,\n\t\t\t\t\t\t\t\townerId, behavior);\n\n\t\t\tpfree(acl);\n\t\t\tacl = new_acl;\n\n\t\t\tgoto restart;\n\t\t}\n\t}\n\n\treturn acl;\n}"
  },
  {
    "function_name": "check_circularity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1154-1216",
    "snippet": "static void\ncheck_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId)\n{\n\tAcl\t\t   *acl;\n\tAclItem    *aip;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\tAclMode\t\town_privs;\n\n\tcheck_acl(old_acl);\n\n\t/*\n\t * For now, grant options can only be granted to roles, not PUBLIC.\n\t * Otherwise we'd have to work a bit harder here.\n\t */\n\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\n\t/* The owner always has grant options, no need to check */\n\tif (mod_aip->ai_grantor == ownerId)\n\t\treturn;\n\n\t/* Make a working copy */\n\tacl = allocacl(ACL_NUM(old_acl));\n\tmemcpy(acl, old_acl, ACL_SIZE(old_acl));\n\n\t/* Zap all grant options of target grantee, plus what depends on 'em */\ncc_restart:\n\tnum = ACL_NUM(acl);\n\taip = ACL_DAT(acl);\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tif (aip[i].ai_grantee == mod_aip->ai_grantee &&\n\t\t\tACLITEM_GET_GOPTIONS(aip[i]) != ACL_NO_RIGHTS)\n\t\t{\n\t\t\tAcl\t\t   *new_acl;\n\n\t\t\t/* We'll actually zap ordinary privs too, but no matter */\n\t\t\tnew_acl = aclupdate(acl, &aip[i], ACL_MODECHG_DEL,\n\t\t\t\t\t\t\t\townerId, DROP_CASCADE);\n\n\t\t\tpfree(acl);\n\t\t\tacl = new_acl;\n\n\t\t\tgoto cc_restart;\n\t\t}\n\t}\n\n\t/* Now we can compute grantor's independently-derived privileges */\n\town_privs = aclmask(acl,\n\t\t\t\t\t\tmod_aip->ai_grantor,\n\t\t\t\t\t\townerId,\n\t\t\t\t\t\tACL_GRANT_OPTION_FOR(ACLITEM_GET_GOPTIONS(*mod_aip)),\n\t\t\t\t\t\tACLMASK_ALL);\n\town_privs = ACL_OPTION_TO_PRIVS(own_privs);\n\n\tif ((ACLITEM_GET_GOPTIONS(*mod_aip) & ~own_privs) != 0)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_GRANT_OPERATION),\n\t\t\t\t errmsg(\"grant options cannot be granted back to your own grantor\")));\n\n\tpfree(acl);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static void check_acl(const Acl *acl);",
      "static const char *aclparse(const char *s, AclItem *aip);",
      "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pfree",
          "args": [
            "acl"
          ],
          "line": 1215
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1649-1655",
          "snippet": "static void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_GRANT_OPERATION),\n\t\t\t\t errmsg(\"grant options cannot be granted back to your own grantor\"))"
          ],
          "line": 1211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"grant options cannot be granted back to your own grantor\""
          ],
          "line": 1213
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_GRANT_OPERATION"
          ],
          "line": 1212
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_GOPTIONS",
          "args": [
            "*mod_aip"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_OPTION_TO_PRIVS",
          "args": [
            "own_privs"
          ],
          "line": 1208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aclmask",
          "args": [
            "acl",
            "mod_aip->ai_grantor",
            "ownerId",
            "ACL_GRANT_OPTION_FOR(ACLITEM_GET_GOPTIONS(*mod_aip))",
            "ACLMASK_ALL"
          ],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "aclmask_direct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1409-1461",
          "snippet": "static AclMode\naclmask_direct(const Acl *acl, Oid roleid, Oid ownerId,\n\t\t\t   AclMode mask, AclMaskHow how)\n{\n\tAclMode\t\tresult;\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/*\n\t * Null ACL should not happen, since caller should have inserted\n\t * appropriate default\n\t */\n\tif (acl == NULL)\n\t\telog(ERROR, \"null ACL\");\n\n\tcheck_acl(acl);\n\n\t/* Quick exit for mask == 0 */\n\tif (mask == 0)\n\t\treturn 0;\n\n\tresult = 0;\n\n\t/* Owner always implicitly has all grant options */\n\tif ((mask & ACLITEM_ALL_GOPTION_BITS) &&\n\t\troleid == ownerId)\n\t{\n\t\tresult = mask & ACLITEM_ALL_GOPTION_BITS;\n\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\treturn result;\n\t}\n\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\n\t/*\n\t * Check privileges granted directly to roleid (and not to public)\n\t */\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == roleid)\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn result;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);",
            "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nstatic AclMode\naclmask_direct(const Acl *acl, Oid roleid, Oid ownerId,\n\t\t\t   AclMode mask, AclMaskHow how)\n{\n\tAclMode\t\tresult;\n\tAclItem    *aidat;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/*\n\t * Null ACL should not happen, since caller should have inserted\n\t * appropriate default\n\t */\n\tif (acl == NULL)\n\t\telog(ERROR, \"null ACL\");\n\n\tcheck_acl(acl);\n\n\t/* Quick exit for mask == 0 */\n\tif (mask == 0)\n\t\treturn 0;\n\n\tresult = 0;\n\n\t/* Owner always implicitly has all grant options */\n\tif ((mask & ACLITEM_ALL_GOPTION_BITS) &&\n\t\troleid == ownerId)\n\t{\n\t\tresult = mask & ACLITEM_ALL_GOPTION_BITS;\n\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\treturn result;\n\t}\n\n\tnum = ACL_NUM(acl);\n\taidat = ACL_DAT(acl);\n\n\t/*\n\t * Check privileges granted directly to roleid (and not to public)\n\t */\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tAclItem    *aidata = &aidat[i];\n\n\t\tif (aidata->ai_grantee == roleid)\n\t\t{\n\t\t\tresult |= aidata->ai_privs & mask;\n\t\t\tif ((how == ACLMASK_ALL) ? (result == mask) : (result != 0))\n\t\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_GRANT_OPTION_FOR",
          "args": [
            "ACLITEM_GET_GOPTIONS(*mod_aip)"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_GOPTIONS",
          "args": [
            "*mod_aip"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aclupdate",
          "args": [
            "acl",
            "&aip[i]",
            "ACL_MODECHG_DEL",
            "ownerId",
            "DROP_CASCADE"
          ],
          "line": 1192
        },
        "resolved": true,
        "details": {
          "function_name": "aclupdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "930-1038",
          "snippet": "Acl *\naclupdate(const Acl *old_acl, const AclItem *mod_aip,\n\t\t  int modechg, Oid ownerId, DropBehavior behavior)\n{\n\tAcl\t\t   *new_acl = NULL;\n\tAclItem    *old_aip,\n\t\t\t   *new_aip = NULL;\n\tAclMode\t\told_rights,\n\t\t\t\told_goptions,\n\t\t\t\tnew_rights,\n\t\t\t\tnew_goptions;\n\tint\t\t\tdst,\n\t\t\t\tnum;\n\n\t/* Caller probably already checked old_acl, but be safe */\n\tcheck_acl(old_acl);\n\n\t/* If granting grant options, check for circularity */\n\tif (modechg != ACL_MODECHG_DEL &&\n\t\tACLITEM_GET_GOPTIONS(*mod_aip) != ACL_NO_RIGHTS)\n\t\tcheck_circularity(old_acl, mod_aip, ownerId);\n\n\tnum = ACL_NUM(old_acl);\n\told_aip = ACL_DAT(old_acl);\n\n\t/*\n\t * Search the ACL for an existing entry for this grantee and grantor. If\n\t * one exists, just modify the entry in-place (well, in the same position,\n\t * since we actually return a copy); otherwise, insert the new entry at\n\t * the end.\n\t */\n\n\tfor (dst = 0; dst < num; ++dst)\n\t{\n\t\tif (aclitem_match(mod_aip, old_aip + dst))\n\t\t{\n\t\t\t/* found a match, so modify existing item */\n\t\t\tnew_acl = allocacl(num);\n\t\t\tnew_aip = ACL_DAT(new_acl);\n\t\t\tmemcpy(new_acl, old_acl, ACL_SIZE(old_acl));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (dst == num)\n\t{\n\t\t/* need to append a new item */\n\t\tnew_acl = allocacl(num + 1);\n\t\tnew_aip = ACL_DAT(new_acl);\n\t\tmemcpy(new_aip, old_aip, num * sizeof(AclItem));\n\n\t\t/* initialize the new entry with no permissions */\n\t\tnew_aip[dst].ai_grantee = mod_aip->ai_grantee;\n\t\tnew_aip[dst].ai_grantor = mod_aip->ai_grantor;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(new_aip[dst],\n\t\t\t\t\t\t\t\t   ACL_NO_RIGHTS, ACL_NO_RIGHTS);\n\t\tnum++;\t\t\t\t\t/* set num to the size of new_acl */\n\t}\n\n\told_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\told_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/* apply the specified permissions change */\n\tswitch (modechg)\n\t{\n\t\tcase ACL_MODECHG_ADD:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights | ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_DEL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights & ~ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_EQL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t}\n\n\tnew_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\tnew_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/*\n\t * If the adjusted entry has no permissions, delete it from the list.\n\t */\n\tif (new_rights == ACL_NO_RIGHTS)\n\t{\n\t\tmemmove(new_aip + dst,\n\t\t\t\tnew_aip + dst + 1,\n\t\t\t\t(num - dst - 1) * sizeof(AclItem));\n\t\t/* Adjust array size to be 'num - 1' items */\n\t\tARR_DIMS(new_acl)[0] = num - 1;\n\t\tSET_VARSIZE(new_acl, ACL_N_SIZE(num - 1));\n\t}\n\n\t/*\n\t * Remove abandoned privileges (cascading revoke).  Currently we can only\n\t * handle this when the grantee is not PUBLIC.\n\t */\n\tif ((old_goptions & ~new_goptions) != 0)\n\t{\n\t\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\t\tnew_acl = recursive_revoke(new_acl, mod_aip->ai_grantee,\n\t\t\t\t\t\t\t\t   (old_goptions & ~new_goptions),\n\t\t\t\t\t\t\t\t   ownerId, behavior);\n\t}\n\n\treturn new_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
            "static Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nAcl *\naclupdate(const Acl *old_acl, const AclItem *mod_aip,\n\t\t  int modechg, Oid ownerId, DropBehavior behavior)\n{\n\tAcl\t\t   *new_acl = NULL;\n\tAclItem    *old_aip,\n\t\t\t   *new_aip = NULL;\n\tAclMode\t\told_rights,\n\t\t\t\told_goptions,\n\t\t\t\tnew_rights,\n\t\t\t\tnew_goptions;\n\tint\t\t\tdst,\n\t\t\t\tnum;\n\n\t/* Caller probably already checked old_acl, but be safe */\n\tcheck_acl(old_acl);\n\n\t/* If granting grant options, check for circularity */\n\tif (modechg != ACL_MODECHG_DEL &&\n\t\tACLITEM_GET_GOPTIONS(*mod_aip) != ACL_NO_RIGHTS)\n\t\tcheck_circularity(old_acl, mod_aip, ownerId);\n\n\tnum = ACL_NUM(old_acl);\n\told_aip = ACL_DAT(old_acl);\n\n\t/*\n\t * Search the ACL for an existing entry for this grantee and grantor. If\n\t * one exists, just modify the entry in-place (well, in the same position,\n\t * since we actually return a copy); otherwise, insert the new entry at\n\t * the end.\n\t */\n\n\tfor (dst = 0; dst < num; ++dst)\n\t{\n\t\tif (aclitem_match(mod_aip, old_aip + dst))\n\t\t{\n\t\t\t/* found a match, so modify existing item */\n\t\t\tnew_acl = allocacl(num);\n\t\t\tnew_aip = ACL_DAT(new_acl);\n\t\t\tmemcpy(new_acl, old_acl, ACL_SIZE(old_acl));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (dst == num)\n\t{\n\t\t/* need to append a new item */\n\t\tnew_acl = allocacl(num + 1);\n\t\tnew_aip = ACL_DAT(new_acl);\n\t\tmemcpy(new_aip, old_aip, num * sizeof(AclItem));\n\n\t\t/* initialize the new entry with no permissions */\n\t\tnew_aip[dst].ai_grantee = mod_aip->ai_grantee;\n\t\tnew_aip[dst].ai_grantor = mod_aip->ai_grantor;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(new_aip[dst],\n\t\t\t\t\t\t\t\t   ACL_NO_RIGHTS, ACL_NO_RIGHTS);\n\t\tnum++;\t\t\t\t\t/* set num to the size of new_acl */\n\t}\n\n\told_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\told_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/* apply the specified permissions change */\n\tswitch (modechg)\n\t{\n\t\tcase ACL_MODECHG_ADD:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights | ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_DEL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights & ~ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_EQL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t}\n\n\tnew_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\tnew_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/*\n\t * If the adjusted entry has no permissions, delete it from the list.\n\t */\n\tif (new_rights == ACL_NO_RIGHTS)\n\t{\n\t\tmemmove(new_aip + dst,\n\t\t\t\tnew_aip + dst + 1,\n\t\t\t\t(num - dst - 1) * sizeof(AclItem));\n\t\t/* Adjust array size to be 'num - 1' items */\n\t\tARR_DIMS(new_acl)[0] = num - 1;\n\t\tSET_VARSIZE(new_acl, ACL_N_SIZE(num - 1));\n\t}\n\n\t/*\n\t * Remove abandoned privileges (cascading revoke).  Currently we can only\n\t * handle this when the grantee is not PUBLIC.\n\t */\n\tif ((old_goptions & ~new_goptions) != 0)\n\t{\n\t\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\t\tnew_acl = recursive_revoke(new_acl, mod_aip->ai_grantee,\n\t\t\t\t\t\t\t\t   (old_goptions & ~new_goptions),\n\t\t\t\t\t\t\t\t   ownerId, behavior);\n\t}\n\n\treturn new_acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_GOPTIONS",
          "args": [
            "aip[i]"
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "acl"
          ],
          "line": 1183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "acl",
            "old_acl",
            "ACL_SIZE(old_acl)"
          ],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_SIZE",
          "args": [
            "old_acl"
          ],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allocacl",
          "args": [
            "ACL_NUM(old_acl)"
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "allocacl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "375-392",
          "snippet": "static Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *getid(const char *s, char *n);",
            "static Acl *allocacl(int n);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic Acl *allocacl(int n);\n\nstatic Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "old_acl"
          ],
          "line": 1177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "mod_aip->ai_grantee != ACL_ID_PUBLIC"
          ],
          "line": 1170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_acl",
          "args": [
            "old_acl"
          ],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "check_acl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "539-554",
          "snippet": "static void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nstatic void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic void check_acl(const Acl *acl);\nstatic const char *aclparse(const char *s, AclItem *aip);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nstatic void\ncheck_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId)\n{\n\tAcl\t\t   *acl;\n\tAclItem    *aip;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\tAclMode\t\town_privs;\n\n\tcheck_acl(old_acl);\n\n\t/*\n\t * For now, grant options can only be granted to roles, not PUBLIC.\n\t * Otherwise we'd have to work a bit harder here.\n\t */\n\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\n\t/* The owner always has grant options, no need to check */\n\tif (mod_aip->ai_grantor == ownerId)\n\t\treturn;\n\n\t/* Make a working copy */\n\tacl = allocacl(ACL_NUM(old_acl));\n\tmemcpy(acl, old_acl, ACL_SIZE(old_acl));\n\n\t/* Zap all grant options of target grantee, plus what depends on 'em */\ncc_restart:\n\tnum = ACL_NUM(acl);\n\taip = ACL_DAT(acl);\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tif (aip[i].ai_grantee == mod_aip->ai_grantee &&\n\t\t\tACLITEM_GET_GOPTIONS(aip[i]) != ACL_NO_RIGHTS)\n\t\t{\n\t\t\tAcl\t\t   *new_acl;\n\n\t\t\t/* We'll actually zap ordinary privs too, but no matter */\n\t\t\tnew_acl = aclupdate(acl, &aip[i], ACL_MODECHG_DEL,\n\t\t\t\t\t\t\t\townerId, DROP_CASCADE);\n\n\t\t\tpfree(acl);\n\t\t\tacl = new_acl;\n\n\t\t\tgoto cc_restart;\n\t\t}\n\t}\n\n\t/* Now we can compute grantor's independently-derived privileges */\n\town_privs = aclmask(acl,\n\t\t\t\t\t\tmod_aip->ai_grantor,\n\t\t\t\t\t\townerId,\n\t\t\t\t\t\tACL_GRANT_OPTION_FOR(ACLITEM_GET_GOPTIONS(*mod_aip)),\n\t\t\t\t\t\tACLMASK_ALL);\n\town_privs = ACL_OPTION_TO_PRIVS(own_privs);\n\n\tif ((ACLITEM_GET_GOPTIONS(*mod_aip) & ~own_privs) != 0)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_GRANT_OPERATION),\n\t\t\t\t errmsg(\"grant options cannot be granted back to your own grantor\")));\n\n\tpfree(acl);\n}"
  },
  {
    "function_name": "aclnewowner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "1051-1139",
    "snippet": "Acl *\naclnewowner(const Acl *old_acl, Oid oldOwnerId, Oid newOwnerId)\n{\n\tAcl\t\t   *new_acl;\n\tAclItem    *new_aip;\n\tAclItem    *old_aip;\n\tAclItem    *dst_aip;\n\tAclItem    *src_aip;\n\tAclItem    *targ_aip;\n\tbool\t\tnewpresent = false;\n\tint\t\t\tdst,\n\t\t\t\tsrc,\n\t\t\t\ttarg,\n\t\t\t\tnum;\n\n\tcheck_acl(old_acl);\n\n\t/*\n\t * Make a copy of the given ACL, substituting new owner ID for old\n\t * wherever it appears as either grantor or grantee.  Also note if the new\n\t * owner ID is already present.\n\t */\n\tnum = ACL_NUM(old_acl);\n\told_aip = ACL_DAT(old_acl);\n\tnew_acl = allocacl(num);\n\tnew_aip = ACL_DAT(new_acl);\n\tmemcpy(new_aip, old_aip, num * sizeof(AclItem));\n\tfor (dst = 0, dst_aip = new_aip; dst < num; dst++, dst_aip++)\n\t{\n\t\tif (dst_aip->ai_grantor == oldOwnerId)\n\t\t\tdst_aip->ai_grantor = newOwnerId;\n\t\telse if (dst_aip->ai_grantor == newOwnerId)\n\t\t\tnewpresent = true;\n\t\tif (dst_aip->ai_grantee == oldOwnerId)\n\t\t\tdst_aip->ai_grantee = newOwnerId;\n\t\telse if (dst_aip->ai_grantee == newOwnerId)\n\t\t\tnewpresent = true;\n\t}\n\n\t/*\n\t * If the old ACL contained any references to the new owner, then we may\n\t * now have generated an ACL containing duplicate entries.  Find them and\n\t * merge them so that there are not duplicates.  (This is relatively\n\t * expensive since we use a stupid O(N^2) algorithm, but it's unlikely to\n\t * be the normal case.)\n\t *\n\t * To simplify deletion of duplicate entries, we temporarily leave them in\n\t * the array but set their privilege masks to zero; when we reach such an\n\t * entry it's just skipped.  (Thus, a side effect of this code will be to\n\t * remove privilege-free entries, should there be any in the input.)  dst\n\t * is the next output slot, targ is the currently considered input slot\n\t * (always >= dst), and src scans entries to the right of targ looking for\n\t * duplicates.  Once an entry has been emitted to dst it is known\n\t * duplicate-free and need not be considered anymore.\n\t */\n\tif (newpresent)\n\t{\n\t\tdst = 0;\n\t\tfor (targ = 0, targ_aip = new_aip; targ < num; targ++, targ_aip++)\n\t\t{\n\t\t\t/* ignore if deleted in an earlier pass */\n\t\t\tif (ACLITEM_GET_RIGHTS(*targ_aip) == ACL_NO_RIGHTS)\n\t\t\t\tcontinue;\n\t\t\t/* find and merge any duplicates */\n\t\t\tfor (src = targ + 1, src_aip = targ_aip + 1; src < num;\n\t\t\t\t src++, src_aip++)\n\t\t\t{\n\t\t\t\tif (ACLITEM_GET_RIGHTS(*src_aip) == ACL_NO_RIGHTS)\n\t\t\t\t\tcontinue;\n\t\t\t\tif (aclitem_match(targ_aip, src_aip))\n\t\t\t\t{\n\t\t\t\t\tACLITEM_SET_RIGHTS(*targ_aip,\n\t\t\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*targ_aip) |\n\t\t\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*src_aip));\n\t\t\t\t\t/* mark the duplicate deleted */\n\t\t\t\t\tACLITEM_SET_RIGHTS(*src_aip, ACL_NO_RIGHTS);\n\t\t\t\t}\n\t\t\t}\n\t\t\t/* and emit to output */\n\t\t\tnew_aip[dst] = *targ_aip;\n\t\t\tdst++;\n\t\t}\n\t\t/* Adjust array size to be 'dst' items */\n\t\tARR_DIMS(new_acl)[0] = dst;\n\t\tSET_VARSIZE(new_acl, ACL_N_SIZE(dst));\n\t}\n\n\treturn new_acl;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "new_acl",
            "ACL_N_SIZE(dst)"
          ],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_N_SIZE",
          "args": [
            "dst"
          ],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARR_DIMS",
          "args": [
            "new_acl"
          ],
          "line": 1134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_SET_RIGHTS",
          "args": [
            "*src_aip",
            "ACL_NO_RIGHTS"
          ],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_SET_RIGHTS",
          "args": [
            "*targ_aip",
            "ACLITEM_GET_RIGHTS(*targ_aip) |\n\t\t\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*src_aip)"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "*src_aip"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "*targ_aip"
          ],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aclitem_match",
          "args": [
            "targ_aip",
            "src_aip"
          ],
          "line": 1120
        },
        "resolved": true,
        "details": {
          "function_name": "aclitem_match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "657-662",
          "snippet": "static bool\naclitem_match(const AclItem *a1, const AclItem *a2)\n{\n\treturn a1->ai_grantee == a2->ai_grantee &&\n\t\ta1->ai_grantor == a2->ai_grantor;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool aclitem_match(const AclItem *a1, const AclItem *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool aclitem_match(const AclItem *a1, const AclItem *a2);\n\nstatic bool\naclitem_match(const AclItem *a1, const AclItem *a2)\n{\n\treturn a1->ai_grantee == a2->ai_grantee &&\n\t\ta1->ai_grantor == a2->ai_grantor;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "*src_aip"
          ],
          "line": 1118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "*targ_aip"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "new_aip",
            "old_aip",
            "num * sizeof(AclItem)"
          ],
          "line": 1077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "new_acl"
          ],
          "line": 1076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allocacl",
          "args": [
            "num"
          ],
          "line": 1075
        },
        "resolved": true,
        "details": {
          "function_name": "allocacl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "375-392",
          "snippet": "static Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *getid(const char *s, char *n);",
            "static Acl *allocacl(int n);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic Acl *allocacl(int n);\n\nstatic Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "old_acl"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "old_acl"
          ],
          "line": 1073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_acl",
          "args": [
            "old_acl"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "check_acl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "539-554",
          "snippet": "static void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nstatic void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nAcl *\naclnewowner(const Acl *old_acl, Oid oldOwnerId, Oid newOwnerId)\n{\n\tAcl\t\t   *new_acl;\n\tAclItem    *new_aip;\n\tAclItem    *old_aip;\n\tAclItem    *dst_aip;\n\tAclItem    *src_aip;\n\tAclItem    *targ_aip;\n\tbool\t\tnewpresent = false;\n\tint\t\t\tdst,\n\t\t\t\tsrc,\n\t\t\t\ttarg,\n\t\t\t\tnum;\n\n\tcheck_acl(old_acl);\n\n\t/*\n\t * Make a copy of the given ACL, substituting new owner ID for old\n\t * wherever it appears as either grantor or grantee.  Also note if the new\n\t * owner ID is already present.\n\t */\n\tnum = ACL_NUM(old_acl);\n\told_aip = ACL_DAT(old_acl);\n\tnew_acl = allocacl(num);\n\tnew_aip = ACL_DAT(new_acl);\n\tmemcpy(new_aip, old_aip, num * sizeof(AclItem));\n\tfor (dst = 0, dst_aip = new_aip; dst < num; dst++, dst_aip++)\n\t{\n\t\tif (dst_aip->ai_grantor == oldOwnerId)\n\t\t\tdst_aip->ai_grantor = newOwnerId;\n\t\telse if (dst_aip->ai_grantor == newOwnerId)\n\t\t\tnewpresent = true;\n\t\tif (dst_aip->ai_grantee == oldOwnerId)\n\t\t\tdst_aip->ai_grantee = newOwnerId;\n\t\telse if (dst_aip->ai_grantee == newOwnerId)\n\t\t\tnewpresent = true;\n\t}\n\n\t/*\n\t * If the old ACL contained any references to the new owner, then we may\n\t * now have generated an ACL containing duplicate entries.  Find them and\n\t * merge them so that there are not duplicates.  (This is relatively\n\t * expensive since we use a stupid O(N^2) algorithm, but it's unlikely to\n\t * be the normal case.)\n\t *\n\t * To simplify deletion of duplicate entries, we temporarily leave them in\n\t * the array but set their privilege masks to zero; when we reach such an\n\t * entry it's just skipped.  (Thus, a side effect of this code will be to\n\t * remove privilege-free entries, should there be any in the input.)  dst\n\t * is the next output slot, targ is the currently considered input slot\n\t * (always >= dst), and src scans entries to the right of targ looking for\n\t * duplicates.  Once an entry has been emitted to dst it is known\n\t * duplicate-free and need not be considered anymore.\n\t */\n\tif (newpresent)\n\t{\n\t\tdst = 0;\n\t\tfor (targ = 0, targ_aip = new_aip; targ < num; targ++, targ_aip++)\n\t\t{\n\t\t\t/* ignore if deleted in an earlier pass */\n\t\t\tif (ACLITEM_GET_RIGHTS(*targ_aip) == ACL_NO_RIGHTS)\n\t\t\t\tcontinue;\n\t\t\t/* find and merge any duplicates */\n\t\t\tfor (src = targ + 1, src_aip = targ_aip + 1; src < num;\n\t\t\t\t src++, src_aip++)\n\t\t\t{\n\t\t\t\tif (ACLITEM_GET_RIGHTS(*src_aip) == ACL_NO_RIGHTS)\n\t\t\t\t\tcontinue;\n\t\t\t\tif (aclitem_match(targ_aip, src_aip))\n\t\t\t\t{\n\t\t\t\t\tACLITEM_SET_RIGHTS(*targ_aip,\n\t\t\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*targ_aip) |\n\t\t\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*src_aip));\n\t\t\t\t\t/* mark the duplicate deleted */\n\t\t\t\t\tACLITEM_SET_RIGHTS(*src_aip, ACL_NO_RIGHTS);\n\t\t\t\t}\n\t\t\t}\n\t\t\t/* and emit to output */\n\t\t\tnew_aip[dst] = *targ_aip;\n\t\t\tdst++;\n\t\t}\n\t\t/* Adjust array size to be 'dst' items */\n\t\tARR_DIMS(new_acl)[0] = dst;\n\t\tSET_VARSIZE(new_acl, ACL_N_SIZE(dst));\n\t}\n\n\treturn new_acl;\n}"
  },
  {
    "function_name": "aclupdate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "930-1038",
    "snippet": "Acl *\naclupdate(const Acl *old_acl, const AclItem *mod_aip,\n\t\t  int modechg, Oid ownerId, DropBehavior behavior)\n{\n\tAcl\t\t   *new_acl = NULL;\n\tAclItem    *old_aip,\n\t\t\t   *new_aip = NULL;\n\tAclMode\t\told_rights,\n\t\t\t\told_goptions,\n\t\t\t\tnew_rights,\n\t\t\t\tnew_goptions;\n\tint\t\t\tdst,\n\t\t\t\tnum;\n\n\t/* Caller probably already checked old_acl, but be safe */\n\tcheck_acl(old_acl);\n\n\t/* If granting grant options, check for circularity */\n\tif (modechg != ACL_MODECHG_DEL &&\n\t\tACLITEM_GET_GOPTIONS(*mod_aip) != ACL_NO_RIGHTS)\n\t\tcheck_circularity(old_acl, mod_aip, ownerId);\n\n\tnum = ACL_NUM(old_acl);\n\told_aip = ACL_DAT(old_acl);\n\n\t/*\n\t * Search the ACL for an existing entry for this grantee and grantor. If\n\t * one exists, just modify the entry in-place (well, in the same position,\n\t * since we actually return a copy); otherwise, insert the new entry at\n\t * the end.\n\t */\n\n\tfor (dst = 0; dst < num; ++dst)\n\t{\n\t\tif (aclitem_match(mod_aip, old_aip + dst))\n\t\t{\n\t\t\t/* found a match, so modify existing item */\n\t\t\tnew_acl = allocacl(num);\n\t\t\tnew_aip = ACL_DAT(new_acl);\n\t\t\tmemcpy(new_acl, old_acl, ACL_SIZE(old_acl));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (dst == num)\n\t{\n\t\t/* need to append a new item */\n\t\tnew_acl = allocacl(num + 1);\n\t\tnew_aip = ACL_DAT(new_acl);\n\t\tmemcpy(new_aip, old_aip, num * sizeof(AclItem));\n\n\t\t/* initialize the new entry with no permissions */\n\t\tnew_aip[dst].ai_grantee = mod_aip->ai_grantee;\n\t\tnew_aip[dst].ai_grantor = mod_aip->ai_grantor;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(new_aip[dst],\n\t\t\t\t\t\t\t\t   ACL_NO_RIGHTS, ACL_NO_RIGHTS);\n\t\tnum++;\t\t\t\t\t/* set num to the size of new_acl */\n\t}\n\n\told_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\told_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/* apply the specified permissions change */\n\tswitch (modechg)\n\t{\n\t\tcase ACL_MODECHG_ADD:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights | ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_DEL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights & ~ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_EQL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t}\n\n\tnew_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\tnew_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/*\n\t * If the adjusted entry has no permissions, delete it from the list.\n\t */\n\tif (new_rights == ACL_NO_RIGHTS)\n\t{\n\t\tmemmove(new_aip + dst,\n\t\t\t\tnew_aip + dst + 1,\n\t\t\t\t(num - dst - 1) * sizeof(AclItem));\n\t\t/* Adjust array size to be 'num - 1' items */\n\t\tARR_DIMS(new_acl)[0] = num - 1;\n\t\tSET_VARSIZE(new_acl, ACL_N_SIZE(num - 1));\n\t}\n\n\t/*\n\t * Remove abandoned privileges (cascading revoke).  Currently we can only\n\t * handle this when the grantee is not PUBLIC.\n\t */\n\tif ((old_goptions & ~new_goptions) != 0)\n\t{\n\t\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\t\tnew_acl = recursive_revoke(new_acl, mod_aip->ai_grantee,\n\t\t\t\t\t\t\t\t   (old_goptions & ~new_goptions),\n\t\t\t\t\t\t\t\t   ownerId, behavior);\n\t}\n\n\treturn new_acl;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
      "static Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "recursive_revoke",
          "args": [
            "new_acl",
            "mod_aip->ai_grantee",
            "(old_goptions & ~new_goptions)",
            "ownerId",
            "behavior"
          ],
          "line": 1032
        },
        "resolved": true,
        "details": {
          "function_name": "recursive_revoke",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1234-1294",
          "snippet": "static Acl *\nrecursive_revoke(Acl *acl,\n\t\t\t\t Oid grantee,\n\t\t\t\t AclMode revoke_privs,\n\t\t\t\t Oid ownerId,\n\t\t\t\t DropBehavior behavior)\n{\n\tAclMode\t\tstill_has;\n\tAclItem    *aip;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\tcheck_acl(acl);\n\n\t/* The owner can never truly lose grant options, so short-circuit */\n\tif (grantee == ownerId)\n\t\treturn acl;\n\n\t/* The grantee might still have some grant options via another grantor */\n\tstill_has = aclmask(acl, grantee, ownerId,\n\t\t\t\t\t\tACL_GRANT_OPTION_FOR(revoke_privs),\n\t\t\t\t\t\tACLMASK_ALL);\n\trevoke_privs &= ~ACL_OPTION_TO_PRIVS(still_has);\n\tif (revoke_privs == ACL_NO_RIGHTS)\n\t\treturn acl;\n\nrestart:\n\tnum = ACL_NUM(acl);\n\taip = ACL_DAT(acl);\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tif (aip[i].ai_grantor == grantee\n\t\t\t&& (ACLITEM_GET_PRIVS(aip[i]) & revoke_privs) != 0)\n\t\t{\n\t\t\tAclItem\t\tmod_acl;\n\t\t\tAcl\t\t   *new_acl;\n\n\t\t\tif (behavior == DROP_RESTRICT)\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_DEPENDENT_OBJECTS_STILL_EXIST),\n\t\t\t\t\t\t errmsg(\"dependent privileges exist\"),\n\t\t\t\t\t\t errhint(\"Use CASCADE to revoke them too.\")));\n\n\t\t\tmod_acl.ai_grantor = grantee;\n\t\t\tmod_acl.ai_grantee = aip[i].ai_grantee;\n\t\t\tACLITEM_SET_PRIVS_GOPTIONS(mod_acl,\n\t\t\t\t\t\t\t\t\t   revoke_privs,\n\t\t\t\t\t\t\t\t\t   revoke_privs);\n\n\t\t\tnew_acl = aclupdate(acl, &mod_acl, ACL_MODECHG_DEL,\n\t\t\t\t\t\t\t\townerId, behavior);\n\n\t\t\tpfree(acl);\n\t\t\tacl = new_acl;\n\n\t\t\tgoto restart;\n\t\t}\n\t}\n\n\treturn acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);",
            "static const char *aclparse(const char *s, AclItem *aip);",
            "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
            "static Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\nstatic const char *aclparse(const char *s, AclItem *aip);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nstatic Acl *\nrecursive_revoke(Acl *acl,\n\t\t\t\t Oid grantee,\n\t\t\t\t AclMode revoke_privs,\n\t\t\t\t Oid ownerId,\n\t\t\t\t DropBehavior behavior)\n{\n\tAclMode\t\tstill_has;\n\tAclItem    *aip;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\tcheck_acl(acl);\n\n\t/* The owner can never truly lose grant options, so short-circuit */\n\tif (grantee == ownerId)\n\t\treturn acl;\n\n\t/* The grantee might still have some grant options via another grantor */\n\tstill_has = aclmask(acl, grantee, ownerId,\n\t\t\t\t\t\tACL_GRANT_OPTION_FOR(revoke_privs),\n\t\t\t\t\t\tACLMASK_ALL);\n\trevoke_privs &= ~ACL_OPTION_TO_PRIVS(still_has);\n\tif (revoke_privs == ACL_NO_RIGHTS)\n\t\treturn acl;\n\nrestart:\n\tnum = ACL_NUM(acl);\n\taip = ACL_DAT(acl);\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tif (aip[i].ai_grantor == grantee\n\t\t\t&& (ACLITEM_GET_PRIVS(aip[i]) & revoke_privs) != 0)\n\t\t{\n\t\t\tAclItem\t\tmod_acl;\n\t\t\tAcl\t\t   *new_acl;\n\n\t\t\tif (behavior == DROP_RESTRICT)\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_DEPENDENT_OBJECTS_STILL_EXIST),\n\t\t\t\t\t\t errmsg(\"dependent privileges exist\"),\n\t\t\t\t\t\t errhint(\"Use CASCADE to revoke them too.\")));\n\n\t\t\tmod_acl.ai_grantor = grantee;\n\t\t\tmod_acl.ai_grantee = aip[i].ai_grantee;\n\t\t\tACLITEM_SET_PRIVS_GOPTIONS(mod_acl,\n\t\t\t\t\t\t\t\t\t   revoke_privs,\n\t\t\t\t\t\t\t\t\t   revoke_privs);\n\n\t\t\tnew_acl = aclupdate(acl, &mod_acl, ACL_MODECHG_DEL,\n\t\t\t\t\t\t\t\townerId, behavior);\n\n\t\t\tpfree(acl);\n\t\t\tacl = new_acl;\n\n\t\t\tgoto restart;\n\t\t}\n\t}\n\n\treturn acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "mod_aip->ai_grantee != ACL_ID_PUBLIC"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "new_acl",
            "ACL_N_SIZE(num - 1)"
          ],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_N_SIZE",
          "args": [
            "num - 1"
          ],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARR_DIMS",
          "args": [
            "new_acl"
          ],
          "line": 1021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "new_aip + dst",
            "new_aip + dst + 1",
            "(num - dst - 1) * sizeof(AclItem)"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_GOPTIONS",
          "args": [
            "new_aip[dst]"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "new_aip[dst]"
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_SET_RIGHTS",
          "args": [
            "new_aip[dst]",
            "ACLITEM_GET_RIGHTS(*mod_aip)"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "*mod_aip"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_SET_RIGHTS",
          "args": [
            "new_aip[dst]",
            "old_rights & ~ACLITEM_GET_RIGHTS(*mod_aip)"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "*mod_aip"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_SET_RIGHTS",
          "args": [
            "new_aip[dst]",
            "old_rights | ACLITEM_GET_RIGHTS(*mod_aip)"
          ],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "*mod_aip"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_GOPTIONS",
          "args": [
            "new_aip[dst]"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_RIGHTS",
          "args": [
            "new_aip[dst]"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_SET_PRIVS_GOPTIONS",
          "args": [
            "new_aip[dst]",
            "ACL_NO_RIGHTS",
            "ACL_NO_RIGHTS"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "new_aip",
            "old_aip",
            "num * sizeof(AclItem)"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "new_acl"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allocacl",
          "args": [
            "num + 1"
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "allocacl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "375-392",
          "snippet": "static Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *getid(const char *s, char *n);",
            "static Acl *allocacl(int n);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic Acl *allocacl(int n);\n\nstatic Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "new_acl",
            "old_acl",
            "ACL_SIZE(old_acl)"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_SIZE",
          "args": [
            "old_acl"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "new_acl"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aclitem_match",
          "args": [
            "mod_aip",
            "old_aip + dst"
          ],
          "line": 964
        },
        "resolved": true,
        "details": {
          "function_name": "aclitem_match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "657-662",
          "snippet": "static bool\naclitem_match(const AclItem *a1, const AclItem *a2)\n{\n\treturn a1->ai_grantee == a2->ai_grantee &&\n\t\ta1->ai_grantor == a2->ai_grantor;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool aclitem_match(const AclItem *a1, const AclItem *a2);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool aclitem_match(const AclItem *a1, const AclItem *a2);\n\nstatic bool\naclitem_match(const AclItem *a1, const AclItem *a2)\n{\n\treturn a1->ai_grantee == a2->ai_grantee &&\n\t\ta1->ai_grantor == a2->ai_grantor;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "old_acl"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "old_acl"
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_circularity",
          "args": [
            "old_acl",
            "mod_aip",
            "ownerId"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "check_circularity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "1154-1216",
          "snippet": "static void\ncheck_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId)\n{\n\tAcl\t\t   *acl;\n\tAclItem    *aip;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\tAclMode\t\town_privs;\n\n\tcheck_acl(old_acl);\n\n\t/*\n\t * For now, grant options can only be granted to roles, not PUBLIC.\n\t * Otherwise we'd have to work a bit harder here.\n\t */\n\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\n\t/* The owner always has grant options, no need to check */\n\tif (mod_aip->ai_grantor == ownerId)\n\t\treturn;\n\n\t/* Make a working copy */\n\tacl = allocacl(ACL_NUM(old_acl));\n\tmemcpy(acl, old_acl, ACL_SIZE(old_acl));\n\n\t/* Zap all grant options of target grantee, plus what depends on 'em */\ncc_restart:\n\tnum = ACL_NUM(acl);\n\taip = ACL_DAT(acl);\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tif (aip[i].ai_grantee == mod_aip->ai_grantee &&\n\t\t\tACLITEM_GET_GOPTIONS(aip[i]) != ACL_NO_RIGHTS)\n\t\t{\n\t\t\tAcl\t\t   *new_acl;\n\n\t\t\t/* We'll actually zap ordinary privs too, but no matter */\n\t\t\tnew_acl = aclupdate(acl, &aip[i], ACL_MODECHG_DEL,\n\t\t\t\t\t\t\t\townerId, DROP_CASCADE);\n\n\t\t\tpfree(acl);\n\t\t\tacl = new_acl;\n\n\t\t\tgoto cc_restart;\n\t\t}\n\t}\n\n\t/* Now we can compute grantor's independently-derived privileges */\n\town_privs = aclmask(acl,\n\t\t\t\t\t\tmod_aip->ai_grantor,\n\t\t\t\t\t\townerId,\n\t\t\t\t\t\tACL_GRANT_OPTION_FOR(ACLITEM_GET_GOPTIONS(*mod_aip)),\n\t\t\t\t\t\tACLMASK_ALL);\n\town_privs = ACL_OPTION_TO_PRIVS(own_privs);\n\n\tif ((ACLITEM_GET_GOPTIONS(*mod_aip) & ~own_privs) != 0)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_GRANT_OPERATION),\n\t\t\t\t errmsg(\"grant options cannot be granted back to your own grantor\")));\n\n\tpfree(acl);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static void check_acl(const Acl *acl);",
            "static const char *aclparse(const char *s, AclItem *aip);",
            "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic void check_acl(const Acl *acl);\nstatic const char *aclparse(const char *s, AclItem *aip);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nstatic void\ncheck_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId)\n{\n\tAcl\t\t   *acl;\n\tAclItem    *aip;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\tAclMode\t\town_privs;\n\n\tcheck_acl(old_acl);\n\n\t/*\n\t * For now, grant options can only be granted to roles, not PUBLIC.\n\t * Otherwise we'd have to work a bit harder here.\n\t */\n\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\n\t/* The owner always has grant options, no need to check */\n\tif (mod_aip->ai_grantor == ownerId)\n\t\treturn;\n\n\t/* Make a working copy */\n\tacl = allocacl(ACL_NUM(old_acl));\n\tmemcpy(acl, old_acl, ACL_SIZE(old_acl));\n\n\t/* Zap all grant options of target grantee, plus what depends on 'em */\ncc_restart:\n\tnum = ACL_NUM(acl);\n\taip = ACL_DAT(acl);\n\tfor (i = 0; i < num; i++)\n\t{\n\t\tif (aip[i].ai_grantee == mod_aip->ai_grantee &&\n\t\t\tACLITEM_GET_GOPTIONS(aip[i]) != ACL_NO_RIGHTS)\n\t\t{\n\t\t\tAcl\t\t   *new_acl;\n\n\t\t\t/* We'll actually zap ordinary privs too, but no matter */\n\t\t\tnew_acl = aclupdate(acl, &aip[i], ACL_MODECHG_DEL,\n\t\t\t\t\t\t\t\townerId, DROP_CASCADE);\n\n\t\t\tpfree(acl);\n\t\t\tacl = new_acl;\n\n\t\t\tgoto cc_restart;\n\t\t}\n\t}\n\n\t/* Now we can compute grantor's independently-derived privileges */\n\town_privs = aclmask(acl,\n\t\t\t\t\t\tmod_aip->ai_grantor,\n\t\t\t\t\t\townerId,\n\t\t\t\t\t\tACL_GRANT_OPTION_FOR(ACLITEM_GET_GOPTIONS(*mod_aip)),\n\t\t\t\t\t\tACLMASK_ALL);\n\town_privs = ACL_OPTION_TO_PRIVS(own_privs);\n\n\tif ((ACLITEM_GET_GOPTIONS(*mod_aip) & ~own_privs) != 0)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_GRANT_OPERATION),\n\t\t\t\t errmsg(\"grant options cannot be granted back to your own grantor\")));\n\n\tpfree(acl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_GOPTIONS",
          "args": [
            "*mod_aip"
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_acl",
          "args": [
            "old_acl"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "check_acl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "539-554",
          "snippet": "static void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_acl(const Acl *acl);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nstatic void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nAcl *\naclupdate(const Acl *old_acl, const AclItem *mod_aip,\n\t\t  int modechg, Oid ownerId, DropBehavior behavior)\n{\n\tAcl\t\t   *new_acl = NULL;\n\tAclItem    *old_aip,\n\t\t\t   *new_aip = NULL;\n\tAclMode\t\told_rights,\n\t\t\t\told_goptions,\n\t\t\t\tnew_rights,\n\t\t\t\tnew_goptions;\n\tint\t\t\tdst,\n\t\t\t\tnum;\n\n\t/* Caller probably already checked old_acl, but be safe */\n\tcheck_acl(old_acl);\n\n\t/* If granting grant options, check for circularity */\n\tif (modechg != ACL_MODECHG_DEL &&\n\t\tACLITEM_GET_GOPTIONS(*mod_aip) != ACL_NO_RIGHTS)\n\t\tcheck_circularity(old_acl, mod_aip, ownerId);\n\n\tnum = ACL_NUM(old_acl);\n\told_aip = ACL_DAT(old_acl);\n\n\t/*\n\t * Search the ACL for an existing entry for this grantee and grantor. If\n\t * one exists, just modify the entry in-place (well, in the same position,\n\t * since we actually return a copy); otherwise, insert the new entry at\n\t * the end.\n\t */\n\n\tfor (dst = 0; dst < num; ++dst)\n\t{\n\t\tif (aclitem_match(mod_aip, old_aip + dst))\n\t\t{\n\t\t\t/* found a match, so modify existing item */\n\t\t\tnew_acl = allocacl(num);\n\t\t\tnew_aip = ACL_DAT(new_acl);\n\t\t\tmemcpy(new_acl, old_acl, ACL_SIZE(old_acl));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (dst == num)\n\t{\n\t\t/* need to append a new item */\n\t\tnew_acl = allocacl(num + 1);\n\t\tnew_aip = ACL_DAT(new_acl);\n\t\tmemcpy(new_aip, old_aip, num * sizeof(AclItem));\n\n\t\t/* initialize the new entry with no permissions */\n\t\tnew_aip[dst].ai_grantee = mod_aip->ai_grantee;\n\t\tnew_aip[dst].ai_grantor = mod_aip->ai_grantor;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(new_aip[dst],\n\t\t\t\t\t\t\t\t   ACL_NO_RIGHTS, ACL_NO_RIGHTS);\n\t\tnum++;\t\t\t\t\t/* set num to the size of new_acl */\n\t}\n\n\told_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\told_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/* apply the specified permissions change */\n\tswitch (modechg)\n\t{\n\t\tcase ACL_MODECHG_ADD:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights | ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_DEL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights & ~ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_EQL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t}\n\n\tnew_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\tnew_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/*\n\t * If the adjusted entry has no permissions, delete it from the list.\n\t */\n\tif (new_rights == ACL_NO_RIGHTS)\n\t{\n\t\tmemmove(new_aip + dst,\n\t\t\t\tnew_aip + dst + 1,\n\t\t\t\t(num - dst - 1) * sizeof(AclItem));\n\t\t/* Adjust array size to be 'num - 1' items */\n\t\tARR_DIMS(new_acl)[0] = num - 1;\n\t\tSET_VARSIZE(new_acl, ACL_N_SIZE(num - 1));\n\t}\n\n\t/*\n\t * Remove abandoned privileges (cascading revoke).  Currently we can only\n\t * handle this when the grantee is not PUBLIC.\n\t */\n\tif ((old_goptions & ~new_goptions) != 0)\n\t{\n\t\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\t\tnew_acl = recursive_revoke(new_acl, mod_aip->ai_grantee,\n\t\t\t\t\t\t\t\t   (old_goptions & ~new_goptions),\n\t\t\t\t\t\t\t\t   ownerId, behavior);\n\t}\n\n\treturn new_acl;\n}"
  },
  {
    "function_name": "acldefault_sql",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "861-911",
    "snippet": "Datum\nacldefault_sql(PG_FUNCTION_ARGS)\n{\n\tchar\t\tobjtypec = PG_GETARG_CHAR(0);\n\tOid\t\t\towner = PG_GETARG_OID(1);\n\tObjectType\tobjtype = 0;\n\n\tswitch (objtypec)\n\t{\n\t\tcase 'c':\n\t\t\tobjtype = OBJECT_COLUMN;\n\t\t\tbreak;\n\t\tcase 'r':\n\t\t\tobjtype = OBJECT_TABLE;\n\t\t\tbreak;\n\t\tcase 's':\n\t\t\tobjtype = OBJECT_SEQUENCE;\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\tobjtype = OBJECT_DATABASE;\n\t\t\tbreak;\n\t\tcase 'f':\n\t\t\tobjtype = OBJECT_FUNCTION;\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\tobjtype = OBJECT_LANGUAGE;\n\t\t\tbreak;\n\t\tcase 'L':\n\t\t\tobjtype = OBJECT_LARGEOBJECT;\n\t\t\tbreak;\n\t\tcase 'n':\n\t\t\tobjtype = OBJECT_SCHEMA;\n\t\t\tbreak;\n\t\tcase 't':\n\t\t\tobjtype = OBJECT_TABLESPACE;\n\t\t\tbreak;\n\t\tcase 'F':\n\t\t\tobjtype = OBJECT_FDW;\n\t\t\tbreak;\n\t\tcase 'S':\n\t\t\tobjtype = OBJECT_FOREIGN_SERVER;\n\t\t\tbreak;\n\t\tcase 'T':\n\t\t\tobjtype = OBJECT_TYPE;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized objtype abbreviation: %c\", objtypec);\n\t}\n\n\tPG_RETURN_ACL_P(acldefault(objtype, owner));\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *getid(const char *s, char *n);",
      "static void putid(char *p, const char *s);",
      "static Acl *allocacl(int n);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_ACL_P",
          "args": [
            "acldefault(objtype, owner)"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acldefault",
          "args": [
            "objtype",
            "owner"
          ],
          "line": 910
        },
        "resolved": true,
        "details": {
          "function_name": "acldefault",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "747-853",
          "snippet": "Acl *\nacldefault(ObjectType objtype, Oid ownerId)\n{\n\tAclMode\t\tworld_default;\n\tAclMode\t\towner_default;\n\tint\t\t\tnacl;\n\tAcl\t\t   *acl;\n\tAclItem    *aip;\n\n\tswitch (objtype)\n\t{\n\t\tcase OBJECT_COLUMN:\n\t\t\t/* by default, columns have no extra privileges */\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_NO_RIGHTS;\n\t\t\tbreak;\n\t\tcase OBJECT_TABLE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_RELATION;\n\t\t\tbreak;\n\t\tcase OBJECT_SEQUENCE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_SEQUENCE;\n\t\t\tbreak;\n\t\tcase OBJECT_DATABASE:\n\t\t\t/* for backwards compatibility, grant some rights by default */\n\t\t\tworld_default = ACL_CREATE_TEMP | ACL_CONNECT;\n\t\t\towner_default = ACL_ALL_RIGHTS_DATABASE;\n\t\t\tbreak;\n\t\tcase OBJECT_FUNCTION:\n\t\t\t/* Grant EXECUTE by default, for now */\n\t\t\tworld_default = ACL_EXECUTE;\n\t\t\towner_default = ACL_ALL_RIGHTS_FUNCTION;\n\t\t\tbreak;\n\t\tcase OBJECT_LANGUAGE:\n\t\t\t/* Grant USAGE by default, for now */\n\t\t\tworld_default = ACL_USAGE;\n\t\t\towner_default = ACL_ALL_RIGHTS_LANGUAGE;\n\t\t\tbreak;\n\t\tcase OBJECT_LARGEOBJECT:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_LARGEOBJECT;\n\t\t\tbreak;\n\t\tcase OBJECT_SCHEMA:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_SCHEMA;\n\t\t\tbreak;\n\t\tcase OBJECT_TABLESPACE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_TABLESPACE;\n\t\t\tbreak;\n\t\tcase OBJECT_FDW:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_FDW;\n\t\t\tbreak;\n\t\tcase OBJECT_FOREIGN_SERVER:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_FOREIGN_SERVER;\n\t\t\tbreak;\n\t\tcase OBJECT_DOMAIN:\n\t\tcase OBJECT_TYPE:\n\t\t\tworld_default = ACL_USAGE;\n\t\t\towner_default = ACL_ALL_RIGHTS_TYPE;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized objtype: %d\", (int) objtype);\n\t\t\tworld_default = ACL_NO_RIGHTS;\t/* keep compiler quiet */\n\t\t\towner_default = ACL_NO_RIGHTS;\n\t\t\tbreak;\n\t}\n\n\tnacl = 0;\n\tif (world_default != ACL_NO_RIGHTS)\n\t\tnacl++;\n\tif (owner_default != ACL_NO_RIGHTS)\n\t\tnacl++;\n\n\tacl = allocacl(nacl);\n\taip = ACL_DAT(acl);\n\n\tif (world_default != ACL_NO_RIGHTS)\n\t{\n\t\taip->ai_grantee = ACL_ID_PUBLIC;\n\t\taip->ai_grantor = ownerId;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(*aip, world_default, ACL_NO_RIGHTS);\n\t\taip++;\n\t}\n\n\t/*\n\t * Note that the owner's entry shows all ordinary privileges but no grant\n\t * options.  This is because his grant options come \"from the system\" and\n\t * not from his own efforts.  (The SQL spec says that the owner's rights\n\t * come from a \"_SYSTEM\" authid.)  However, we do consider that the\n\t * owner's ordinary privileges are self-granted; this lets him revoke\n\t * them.  We implement the owner's grant options without any explicit\n\t * \"_SYSTEM\"-like ACL entry, by internally special-casing the owner\n\t * wherever we are testing grant options.\n\t */\n\tif (owner_default != ACL_NO_RIGHTS)\n\t{\n\t\taip->ai_grantee = ownerId;\n\t\taip->ai_grantor = ownerId;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(*aip, owner_default, ACL_NO_RIGHTS);\n\t}\n\n\treturn acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static void check_acl(const Acl *acl);",
            "static const char *aclparse(const char *s, AclItem *aip);",
            "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic void check_acl(const Acl *acl);\nstatic const char *aclparse(const char *s, AclItem *aip);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nAcl *\nacldefault(ObjectType objtype, Oid ownerId)\n{\n\tAclMode\t\tworld_default;\n\tAclMode\t\towner_default;\n\tint\t\t\tnacl;\n\tAcl\t\t   *acl;\n\tAclItem    *aip;\n\n\tswitch (objtype)\n\t{\n\t\tcase OBJECT_COLUMN:\n\t\t\t/* by default, columns have no extra privileges */\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_NO_RIGHTS;\n\t\t\tbreak;\n\t\tcase OBJECT_TABLE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_RELATION;\n\t\t\tbreak;\n\t\tcase OBJECT_SEQUENCE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_SEQUENCE;\n\t\t\tbreak;\n\t\tcase OBJECT_DATABASE:\n\t\t\t/* for backwards compatibility, grant some rights by default */\n\t\t\tworld_default = ACL_CREATE_TEMP | ACL_CONNECT;\n\t\t\towner_default = ACL_ALL_RIGHTS_DATABASE;\n\t\t\tbreak;\n\t\tcase OBJECT_FUNCTION:\n\t\t\t/* Grant EXECUTE by default, for now */\n\t\t\tworld_default = ACL_EXECUTE;\n\t\t\towner_default = ACL_ALL_RIGHTS_FUNCTION;\n\t\t\tbreak;\n\t\tcase OBJECT_LANGUAGE:\n\t\t\t/* Grant USAGE by default, for now */\n\t\t\tworld_default = ACL_USAGE;\n\t\t\towner_default = ACL_ALL_RIGHTS_LANGUAGE;\n\t\t\tbreak;\n\t\tcase OBJECT_LARGEOBJECT:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_LARGEOBJECT;\n\t\t\tbreak;\n\t\tcase OBJECT_SCHEMA:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_SCHEMA;\n\t\t\tbreak;\n\t\tcase OBJECT_TABLESPACE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_TABLESPACE;\n\t\t\tbreak;\n\t\tcase OBJECT_FDW:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_FDW;\n\t\t\tbreak;\n\t\tcase OBJECT_FOREIGN_SERVER:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_FOREIGN_SERVER;\n\t\t\tbreak;\n\t\tcase OBJECT_DOMAIN:\n\t\tcase OBJECT_TYPE:\n\t\t\tworld_default = ACL_USAGE;\n\t\t\towner_default = ACL_ALL_RIGHTS_TYPE;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized objtype: %d\", (int) objtype);\n\t\t\tworld_default = ACL_NO_RIGHTS;\t/* keep compiler quiet */\n\t\t\towner_default = ACL_NO_RIGHTS;\n\t\t\tbreak;\n\t}\n\n\tnacl = 0;\n\tif (world_default != ACL_NO_RIGHTS)\n\t\tnacl++;\n\tif (owner_default != ACL_NO_RIGHTS)\n\t\tnacl++;\n\n\tacl = allocacl(nacl);\n\taip = ACL_DAT(acl);\n\n\tif (world_default != ACL_NO_RIGHTS)\n\t{\n\t\taip->ai_grantee = ACL_ID_PUBLIC;\n\t\taip->ai_grantor = ownerId;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(*aip, world_default, ACL_NO_RIGHTS);\n\t\taip++;\n\t}\n\n\t/*\n\t * Note that the owner's entry shows all ordinary privileges but no grant\n\t * options.  This is because his grant options come \"from the system\" and\n\t * not from his own efforts.  (The SQL spec says that the owner's rights\n\t * come from a \"_SYSTEM\" authid.)  However, we do consider that the\n\t * owner's ordinary privileges are self-granted; this lets him revoke\n\t * them.  We implement the owner's grant options without any explicit\n\t * \"_SYSTEM\"-like ACL entry, by internally special-casing the owner\n\t * wherever we are testing grant options.\n\t */\n\tif (owner_default != ACL_NO_RIGHTS)\n\t{\n\t\taip->ai_grantee = ownerId;\n\t\taip->ai_grantor = ownerId;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(*aip, owner_default, ACL_NO_RIGHTS);\n\t}\n\n\treturn acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"unrecognized objtype abbreviation: %c\"",
            "objtypec"
          ],
          "line": 907
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "1"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CHAR",
          "args": [
            "0"
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic void putid(char *p, const char *s);\nstatic Acl *allocacl(int n);\n\nDatum\nacldefault_sql(PG_FUNCTION_ARGS)\n{\n\tchar\t\tobjtypec = PG_GETARG_CHAR(0);\n\tOid\t\t\towner = PG_GETARG_OID(1);\n\tObjectType\tobjtype = 0;\n\n\tswitch (objtypec)\n\t{\n\t\tcase 'c':\n\t\t\tobjtype = OBJECT_COLUMN;\n\t\t\tbreak;\n\t\tcase 'r':\n\t\t\tobjtype = OBJECT_TABLE;\n\t\t\tbreak;\n\t\tcase 's':\n\t\t\tobjtype = OBJECT_SEQUENCE;\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\tobjtype = OBJECT_DATABASE;\n\t\t\tbreak;\n\t\tcase 'f':\n\t\t\tobjtype = OBJECT_FUNCTION;\n\t\t\tbreak;\n\t\tcase 'l':\n\t\t\tobjtype = OBJECT_LANGUAGE;\n\t\t\tbreak;\n\t\tcase 'L':\n\t\t\tobjtype = OBJECT_LARGEOBJECT;\n\t\t\tbreak;\n\t\tcase 'n':\n\t\t\tobjtype = OBJECT_SCHEMA;\n\t\t\tbreak;\n\t\tcase 't':\n\t\t\tobjtype = OBJECT_TABLESPACE;\n\t\t\tbreak;\n\t\tcase 'F':\n\t\t\tobjtype = OBJECT_FDW;\n\t\t\tbreak;\n\t\tcase 'S':\n\t\t\tobjtype = OBJECT_FOREIGN_SERVER;\n\t\t\tbreak;\n\t\tcase 'T':\n\t\t\tobjtype = OBJECT_TYPE;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized objtype abbreviation: %c\", objtypec);\n\t}\n\n\tPG_RETURN_ACL_P(acldefault(objtype, owner));\n}"
  },
  {
    "function_name": "acldefault",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "747-853",
    "snippet": "Acl *\nacldefault(ObjectType objtype, Oid ownerId)\n{\n\tAclMode\t\tworld_default;\n\tAclMode\t\towner_default;\n\tint\t\t\tnacl;\n\tAcl\t\t   *acl;\n\tAclItem    *aip;\n\n\tswitch (objtype)\n\t{\n\t\tcase OBJECT_COLUMN:\n\t\t\t/* by default, columns have no extra privileges */\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_NO_RIGHTS;\n\t\t\tbreak;\n\t\tcase OBJECT_TABLE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_RELATION;\n\t\t\tbreak;\n\t\tcase OBJECT_SEQUENCE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_SEQUENCE;\n\t\t\tbreak;\n\t\tcase OBJECT_DATABASE:\n\t\t\t/* for backwards compatibility, grant some rights by default */\n\t\t\tworld_default = ACL_CREATE_TEMP | ACL_CONNECT;\n\t\t\towner_default = ACL_ALL_RIGHTS_DATABASE;\n\t\t\tbreak;\n\t\tcase OBJECT_FUNCTION:\n\t\t\t/* Grant EXECUTE by default, for now */\n\t\t\tworld_default = ACL_EXECUTE;\n\t\t\towner_default = ACL_ALL_RIGHTS_FUNCTION;\n\t\t\tbreak;\n\t\tcase OBJECT_LANGUAGE:\n\t\t\t/* Grant USAGE by default, for now */\n\t\t\tworld_default = ACL_USAGE;\n\t\t\towner_default = ACL_ALL_RIGHTS_LANGUAGE;\n\t\t\tbreak;\n\t\tcase OBJECT_LARGEOBJECT:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_LARGEOBJECT;\n\t\t\tbreak;\n\t\tcase OBJECT_SCHEMA:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_SCHEMA;\n\t\t\tbreak;\n\t\tcase OBJECT_TABLESPACE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_TABLESPACE;\n\t\t\tbreak;\n\t\tcase OBJECT_FDW:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_FDW;\n\t\t\tbreak;\n\t\tcase OBJECT_FOREIGN_SERVER:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_FOREIGN_SERVER;\n\t\t\tbreak;\n\t\tcase OBJECT_DOMAIN:\n\t\tcase OBJECT_TYPE:\n\t\t\tworld_default = ACL_USAGE;\n\t\t\towner_default = ACL_ALL_RIGHTS_TYPE;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized objtype: %d\", (int) objtype);\n\t\t\tworld_default = ACL_NO_RIGHTS;\t/* keep compiler quiet */\n\t\t\towner_default = ACL_NO_RIGHTS;\n\t\t\tbreak;\n\t}\n\n\tnacl = 0;\n\tif (world_default != ACL_NO_RIGHTS)\n\t\tnacl++;\n\tif (owner_default != ACL_NO_RIGHTS)\n\t\tnacl++;\n\n\tacl = allocacl(nacl);\n\taip = ACL_DAT(acl);\n\n\tif (world_default != ACL_NO_RIGHTS)\n\t{\n\t\taip->ai_grantee = ACL_ID_PUBLIC;\n\t\taip->ai_grantor = ownerId;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(*aip, world_default, ACL_NO_RIGHTS);\n\t\taip++;\n\t}\n\n\t/*\n\t * Note that the owner's entry shows all ordinary privileges but no grant\n\t * options.  This is because his grant options come \"from the system\" and\n\t * not from his own efforts.  (The SQL spec says that the owner's rights\n\t * come from a \"_SYSTEM\" authid.)  However, we do consider that the\n\t * owner's ordinary privileges are self-granted; this lets him revoke\n\t * them.  We implement the owner's grant options without any explicit\n\t * \"_SYSTEM\"-like ACL entry, by internally special-casing the owner\n\t * wherever we are testing grant options.\n\t */\n\tif (owner_default != ACL_NO_RIGHTS)\n\t{\n\t\taip->ai_grantee = ownerId;\n\t\taip->ai_grantor = ownerId;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(*aip, owner_default, ACL_NO_RIGHTS);\n\t}\n\n\treturn acl;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static void check_acl(const Acl *acl);",
      "static const char *aclparse(const char *s, AclItem *aip);",
      "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ACLITEM_SET_PRIVS_GOPTIONS",
          "args": [
            "*aip",
            "owner_default",
            "ACL_NO_RIGHTS"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_SET_PRIVS_GOPTIONS",
          "args": [
            "*aip",
            "world_default",
            "ACL_NO_RIGHTS"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "acl"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allocacl",
          "args": [
            "nacl"
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "allocacl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "375-392",
          "snippet": "static Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *getid(const char *s, char *n);",
            "static Acl *allocacl(int n);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic Acl *allocacl(int n);\n\nstatic Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"unrecognized objtype: %d\"",
            "(int) objtype"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic void check_acl(const Acl *acl);\nstatic const char *aclparse(const char *s, AclItem *aip);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nAcl *\nacldefault(ObjectType objtype, Oid ownerId)\n{\n\tAclMode\t\tworld_default;\n\tAclMode\t\towner_default;\n\tint\t\t\tnacl;\n\tAcl\t\t   *acl;\n\tAclItem    *aip;\n\n\tswitch (objtype)\n\t{\n\t\tcase OBJECT_COLUMN:\n\t\t\t/* by default, columns have no extra privileges */\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_NO_RIGHTS;\n\t\t\tbreak;\n\t\tcase OBJECT_TABLE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_RELATION;\n\t\t\tbreak;\n\t\tcase OBJECT_SEQUENCE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_SEQUENCE;\n\t\t\tbreak;\n\t\tcase OBJECT_DATABASE:\n\t\t\t/* for backwards compatibility, grant some rights by default */\n\t\t\tworld_default = ACL_CREATE_TEMP | ACL_CONNECT;\n\t\t\towner_default = ACL_ALL_RIGHTS_DATABASE;\n\t\t\tbreak;\n\t\tcase OBJECT_FUNCTION:\n\t\t\t/* Grant EXECUTE by default, for now */\n\t\t\tworld_default = ACL_EXECUTE;\n\t\t\towner_default = ACL_ALL_RIGHTS_FUNCTION;\n\t\t\tbreak;\n\t\tcase OBJECT_LANGUAGE:\n\t\t\t/* Grant USAGE by default, for now */\n\t\t\tworld_default = ACL_USAGE;\n\t\t\towner_default = ACL_ALL_RIGHTS_LANGUAGE;\n\t\t\tbreak;\n\t\tcase OBJECT_LARGEOBJECT:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_LARGEOBJECT;\n\t\t\tbreak;\n\t\tcase OBJECT_SCHEMA:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_SCHEMA;\n\t\t\tbreak;\n\t\tcase OBJECT_TABLESPACE:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_TABLESPACE;\n\t\t\tbreak;\n\t\tcase OBJECT_FDW:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_FDW;\n\t\t\tbreak;\n\t\tcase OBJECT_FOREIGN_SERVER:\n\t\t\tworld_default = ACL_NO_RIGHTS;\n\t\t\towner_default = ACL_ALL_RIGHTS_FOREIGN_SERVER;\n\t\t\tbreak;\n\t\tcase OBJECT_DOMAIN:\n\t\tcase OBJECT_TYPE:\n\t\t\tworld_default = ACL_USAGE;\n\t\t\towner_default = ACL_ALL_RIGHTS_TYPE;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\telog(ERROR, \"unrecognized objtype: %d\", (int) objtype);\n\t\t\tworld_default = ACL_NO_RIGHTS;\t/* keep compiler quiet */\n\t\t\towner_default = ACL_NO_RIGHTS;\n\t\t\tbreak;\n\t}\n\n\tnacl = 0;\n\tif (world_default != ACL_NO_RIGHTS)\n\t\tnacl++;\n\tif (owner_default != ACL_NO_RIGHTS)\n\t\tnacl++;\n\n\tacl = allocacl(nacl);\n\taip = ACL_DAT(acl);\n\n\tif (world_default != ACL_NO_RIGHTS)\n\t{\n\t\taip->ai_grantee = ACL_ID_PUBLIC;\n\t\taip->ai_grantor = ownerId;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(*aip, world_default, ACL_NO_RIGHTS);\n\t\taip++;\n\t}\n\n\t/*\n\t * Note that the owner's entry shows all ordinary privileges but no grant\n\t * options.  This is because his grant options come \"from the system\" and\n\t * not from his own efforts.  (The SQL spec says that the owner's rights\n\t * come from a \"_SYSTEM\" authid.)  However, we do consider that the\n\t * owner's ordinary privileges are self-granted; this lets him revoke\n\t * them.  We implement the owner's grant options without any explicit\n\t * \"_SYSTEM\"-like ACL entry, by internally special-casing the owner\n\t * wherever we are testing grant options.\n\t */\n\tif (owner_default != ACL_NO_RIGHTS)\n\t{\n\t\taip->ai_grantee = ownerId;\n\t\taip->ai_grantor = ownerId;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(*aip, owner_default, ACL_NO_RIGHTS);\n\t}\n\n\treturn acl;\n}"
  },
  {
    "function_name": "hash_aclitem_extended",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "726-734",
    "snippet": "Datum\nhash_aclitem_extended(PG_FUNCTION_ARGS)\n{\n\tAclItem    *a = PG_GETARG_ACLITEM_P(0);\n\tuint64\t\tseed = PG_GETARG_INT64(1);\n\tuint32\t\tsum = (uint32) (a->ai_privs + a->ai_grantee + a->ai_grantor);\n\n\treturn (seed == 0) ? UInt64GetDatum(sum) : hash_uint32_extended(sum, seed);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_uint32_extended",
          "args": [
            "sum",
            "seed"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UInt64GetDatum",
          "args": [
            "sum"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "a->ai_privs + a->ai_grantee + a->ai_grantor"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT64",
          "args": [
            "1"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ACLITEM_P",
          "args": [
            "0"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nhash_aclitem_extended(PG_FUNCTION_ARGS)\n{\n\tAclItem    *a = PG_GETARG_ACLITEM_P(0);\n\tuint64\t\tseed = PG_GETARG_INT64(1);\n\tuint32\t\tsum = (uint32) (a->ai_privs + a->ai_grantee + a->ai_grantor);\n\n\treturn (seed == 0) ? UInt64GetDatum(sum) : hash_uint32_extended(sum, seed);\n}"
  },
  {
    "function_name": "hash_aclitem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "712-719",
    "snippet": "Datum\nhash_aclitem(PG_FUNCTION_ARGS)\n{\n\tAclItem    *a = PG_GETARG_ACLITEM_P(0);\n\n\t/* not very bright, but avoids any issue of padding in struct */\n\tPG_RETURN_UINT32((uint32) (a->ai_privs + a->ai_grantee + a->ai_grantor));\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_UINT32",
          "args": [
            "(uint32) (a->ai_privs + a->ai_grantee + a->ai_grantor)"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "a->ai_privs + a->ai_grantee + a->ai_grantor"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ACLITEM_P",
          "args": [
            "0"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nDatum\nhash_aclitem(PG_FUNCTION_ARGS)\n{\n\tAclItem    *a = PG_GETARG_ACLITEM_P(0);\n\n\t/* not very bright, but avoids any issue of padding in struct */\n\tPG_RETURN_UINT32((uint32) (a->ai_privs + a->ai_grantee + a->ai_grantor));\n}"
  },
  {
    "function_name": "aclitem_eq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "692-703",
    "snippet": "Datum\naclitem_eq(PG_FUNCTION_ARGS)\n{\n\tAclItem    *a1 = PG_GETARG_ACLITEM_P(0);\n\tAclItem    *a2 = PG_GETARG_ACLITEM_P(1);\n\tbool\t\tresult;\n\n\tresult = a1->ai_privs == a2->ai_privs &&\n\t\ta1->ai_grantee == a2->ai_grantee &&\n\t\ta1->ai_grantor == a2->ai_grantor;\n\tPG_RETURN_BOOL(result);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static bool aclitem_match(const AclItem *a1, const AclItem *a2);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_BOOL",
          "args": [
            "result"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ACLITEM_P",
          "args": [
            "1"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ACLITEM_P",
          "args": [
            "0"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool aclitem_match(const AclItem *a1, const AclItem *a2);\n\nDatum\naclitem_eq(PG_FUNCTION_ARGS)\n{\n\tAclItem    *a1 = PG_GETARG_ACLITEM_P(0);\n\tAclItem    *a2 = PG_GETARG_ACLITEM_P(1);\n\tbool\t\tresult;\n\n\tresult = a1->ai_privs == a2->ai_privs &&\n\t\ta1->ai_grantee == a2->ai_grantee &&\n\t\ta1->ai_grantor == a2->ai_grantor;\n\tPG_RETURN_BOOL(result);\n}"
  },
  {
    "function_name": "aclitemComparator",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "668-687",
    "snippet": "static int\naclitemComparator(const void *arg1, const void *arg2)\n{\n\tconst AclItem *a1 = (const AclItem *) arg1;\n\tconst AclItem *a2 = (const AclItem *) arg2;\n\n\tif (a1->ai_grantee > a2->ai_grantee)\n\t\treturn 1;\n\tif (a1->ai_grantee < a2->ai_grantee)\n\t\treturn -1;\n\tif (a1->ai_grantor > a2->ai_grantor)\n\t\treturn 1;\n\tif (a1->ai_grantor < a2->ai_grantor)\n\t\treturn -1;\n\tif (a1->ai_privs > a2->ai_privs)\n\t\treturn 1;\n\tif (a1->ai_privs < a2->ai_privs)\n\t\treturn -1;\n\treturn 0;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static bool aclitem_match(const AclItem *a1, const AclItem *a2);",
      "static int\taclitemComparator(const void *arg1, const void *arg2);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool aclitem_match(const AclItem *a1, const AclItem *a2);\nstatic int\taclitemComparator(const void *arg1, const void *arg2);\n\nstatic int\naclitemComparator(const void *arg1, const void *arg2)\n{\n\tconst AclItem *a1 = (const AclItem *) arg1;\n\tconst AclItem *a2 = (const AclItem *) arg2;\n\n\tif (a1->ai_grantee > a2->ai_grantee)\n\t\treturn 1;\n\tif (a1->ai_grantee < a2->ai_grantee)\n\t\treturn -1;\n\tif (a1->ai_grantor > a2->ai_grantor)\n\t\treturn 1;\n\tif (a1->ai_grantor < a2->ai_grantor)\n\t\treturn -1;\n\tif (a1->ai_privs > a2->ai_privs)\n\t\treturn 1;\n\tif (a1->ai_privs < a2->ai_privs)\n\t\treturn -1;\n\treturn 0;\n}"
  },
  {
    "function_name": "aclitem_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "657-662",
    "snippet": "static bool\naclitem_match(const AclItem *a1, const AclItem *a2)\n{\n\treturn a1->ai_grantee == a2->ai_grantee &&\n\t\ta1->ai_grantor == a2->ai_grantor;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static bool aclitem_match(const AclItem *a1, const AclItem *a2);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool aclitem_match(const AclItem *a1, const AclItem *a2);\n\nstatic bool\naclitem_match(const AclItem *a1, const AclItem *a2)\n{\n\treturn a1->ai_grantee == a2->ai_grantee &&\n\t\ta1->ai_grantor == a2->ai_grantor;\n}"
  },
  {
    "function_name": "aclitemout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "590-650",
    "snippet": "Datum\naclitemout(PG_FUNCTION_ARGS)\n{\n\tAclItem    *aip = PG_GETARG_ACLITEM_P(0);\n\tchar\t   *p;\n\tchar\t   *out;\n\tHeapTuple\thtup;\n\tunsigned\ti;\n\n\tout = palloc(strlen(\"=/\") +\n\t\t\t\t 2 * N_ACL_RIGHTS +\n\t\t\t\t 2 * (2 * NAMEDATALEN + 2) +\n\t\t\t\t 1);\n\n\tp = out;\n\t*p = '\\0';\n\n\tif (aip->ai_grantee != ACL_ID_PUBLIC)\n\t{\n\t\thtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(aip->ai_grantee));\n\t\tif (HeapTupleIsValid(htup))\n\t\t{\n\t\t\tputid(p, NameStr(((Form_pg_authid) GETSTRUCT(htup))->rolname));\n\t\t\tReleaseSysCache(htup);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t/* Generate numeric OID if we don't find an entry */\n\t\t\tsprintf(p, \"%u\", aip->ai_grantee);\n\t\t}\n\t}\n\twhile (*p)\n\t\t++p;\n\n\t*p++ = '=';\n\n\tfor (i = 0; i < N_ACL_RIGHTS; ++i)\n\t{\n\t\tif (ACLITEM_GET_PRIVS(*aip) & (1 << i))\n\t\t\t*p++ = ACL_ALL_RIGHTS_STR[i];\n\t\tif (ACLITEM_GET_GOPTIONS(*aip) & (1 << i))\n\t\t\t*p++ = '*';\n\t}\n\n\t*p++ = '/';\n\t*p = '\\0';\n\n\thtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(aip->ai_grantor));\n\tif (HeapTupleIsValid(htup))\n\t{\n\t\tputid(p, NameStr(((Form_pg_authid) GETSTRUCT(htup))->rolname));\n\t\tReleaseSysCache(htup);\n\t}\n\telse\n\t{\n\t\t/* Generate numeric OID if we don't find an entry */\n\t\tsprintf(p, \"%u\", aip->ai_grantor);\n\t}\n\n\tPG_RETURN_CSTRING(out);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *aclparse(const char *s, AclItem *aip);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_CSTRING",
          "args": [
            "out"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "p",
            "\"%u\"",
            "aip->ai_grantor"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReleaseSysCache",
          "args": [
            "htup"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "ReleaseSysCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1159-1163",
          "snippet": "void\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nvoid\nReleaseSysCache(HeapTuple tuple)\n{\n\tReleaseCatCache(tuple);\n}"
        }
      },
      {
        "call_info": {
          "callee": "putid",
          "args": [
            "p",
            "NameStr(((Form_pg_authid) GETSTRUCT(htup))->rolname)"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "putid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "188-215",
          "snippet": "static void\nputid(char *p, const char *s)\n{\n\tconst char *src;\n\tbool\t\tsafe = true;\n\n\tfor (src = s; *src; src++)\n\t{\n\t\t/* This test had better match what getid() does, above */\n\t\tif (!isalnum((unsigned char) *src) && *src != '_')\n\t\t{\n\t\t\tsafe = false;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (!safe)\n\t\t*p++ = '\"';\n\tfor (src = s; *src; src++)\n\t{\n\t\t/* A double quote character in a username is encoded as \"\" */\n\t\tif (*src == '\"')\n\t\t\t*p++ = '\"';\n\t\t*p++ = *src;\n\t}\n\tif (!safe)\n\t\t*p++ = '\"';\n\t*p = '\\0';\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nstatic void\nputid(char *p, const char *s)\n{\n\tconst char *src;\n\tbool\t\tsafe = true;\n\n\tfor (src = s; *src; src++)\n\t{\n\t\t/* This test had better match what getid() does, above */\n\t\tif (!isalnum((unsigned char) *src) && *src != '_')\n\t\t{\n\t\t\tsafe = false;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (!safe)\n\t\t*p++ = '\"';\n\tfor (src = s; *src; src++)\n\t{\n\t\t/* A double quote character in a username is encoded as \"\" */\n\t\tif (*src == '\"')\n\t\t\t*p++ = '\"';\n\t\t*p++ = *src;\n\t}\n\tif (!safe)\n\t\t*p++ = '\"';\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "((Form_pg_authid) GETSTRUCT(htup))->rolname"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "htup"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "htup"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SearchSysCache1",
          "args": [
            "AUTHOID",
            "ObjectIdGetDatum(aip->ai_grantor)"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "SearchSysCache1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/cache/syscache.c",
          "lines": "1111-1120",
          "snippet": "HeapTuple\nSearchSysCache1(int cacheId,\n\t\t\t\tDatum key1)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 1);\n\n\treturn SearchCatCache1(SysCache[cacheId], key1);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"catalog/pg_user_mapping.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_ts_template.h\"",
            "#include \"catalog/pg_ts_parser.h\"",
            "#include \"catalog/pg_ts_dict.h\"",
            "#include \"catalog/pg_ts_config_map.h\"",
            "#include \"catalog/pg_ts_config.h\"",
            "#include \"catalog/pg_transform.h\"",
            "#include \"catalog/pg_tablespace.h\"",
            "#include \"catalog/pg_subscription_rel.h\"",
            "#include \"catalog/pg_subscription.h\"",
            "#include \"catalog/pg_statistic_ext.h\"",
            "#include \"catalog/pg_statistic.h\"",
            "#include \"catalog/pg_replication_origin.h\"",
            "#include \"catalog/pg_shseclabel.h\"",
            "#include \"catalog/pg_shdescription.h\"",
            "#include \"catalog/pg_shdepend.h\"",
            "#include \"catalog/pg_sequence.h\"",
            "#include \"catalog/pg_seclabel.h\"",
            "#include \"catalog/pg_rewrite.h\"",
            "#include \"catalog/pg_range.h\"",
            "#include \"catalog/pg_publication_rel.h\"",
            "#include \"catalog/pg_publication.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_partitioned_table.h\"",
            "#include \"catalog/pg_opfamily.h\"",
            "#include \"catalog/pg_operator.h\"",
            "#include \"catalog/pg_opclass.h\"",
            "#include \"catalog/pg_namespace.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"catalog/pg_foreign_table.h\"",
            "#include \"catalog/pg_foreign_server.h\"",
            "#include \"catalog/pg_foreign_data_wrapper.h\"",
            "#include \"catalog/pg_event_trigger.h\"",
            "#include \"catalog/pg_enum.h\"",
            "#include \"catalog/pg_description.h\"",
            "#include \"catalog/pg_depend.h\"",
            "#include \"catalog/pg_default_acl.h\"",
            "#include \"catalog/pg_db_role_setting.h\"",
            "#include \"catalog/pg_database.h\"",
            "#include \"catalog/pg_conversion.h\"",
            "#include \"catalog/pg_constraint.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"catalog/pg_cast.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_amproc.h\"",
            "#include \"catalog/pg_amop.h\"",
            "#include \"catalog/pg_am.h\"",
            "#include \"catalog/pg_aggregate.h\"",
            "#include \"catalog/indexing.h\"",
            "#include \"access/sysattr.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static CatCache *SysCache[SysCacheSize];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/catcache.h\"\n#include \"utils/rel.h\"\n#include \"catalog/pg_user_mapping.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_ts_template.h\"\n#include \"catalog/pg_ts_parser.h\"\n#include \"catalog/pg_ts_dict.h\"\n#include \"catalog/pg_ts_config_map.h\"\n#include \"catalog/pg_ts_config.h\"\n#include \"catalog/pg_transform.h\"\n#include \"catalog/pg_tablespace.h\"\n#include \"catalog/pg_subscription_rel.h\"\n#include \"catalog/pg_subscription.h\"\n#include \"catalog/pg_statistic_ext.h\"\n#include \"catalog/pg_statistic.h\"\n#include \"catalog/pg_replication_origin.h\"\n#include \"catalog/pg_shseclabel.h\"\n#include \"catalog/pg_shdescription.h\"\n#include \"catalog/pg_shdepend.h\"\n#include \"catalog/pg_sequence.h\"\n#include \"catalog/pg_seclabel.h\"\n#include \"catalog/pg_rewrite.h\"\n#include \"catalog/pg_range.h\"\n#include \"catalog/pg_publication_rel.h\"\n#include \"catalog/pg_publication.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_partitioned_table.h\"\n#include \"catalog/pg_opfamily.h\"\n#include \"catalog/pg_operator.h\"\n#include \"catalog/pg_opclass.h\"\n#include \"catalog/pg_namespace.h\"\n#include \"catalog/pg_language.h\"\n#include \"catalog/pg_foreign_table.h\"\n#include \"catalog/pg_foreign_server.h\"\n#include \"catalog/pg_foreign_data_wrapper.h\"\n#include \"catalog/pg_event_trigger.h\"\n#include \"catalog/pg_enum.h\"\n#include \"catalog/pg_description.h\"\n#include \"catalog/pg_depend.h\"\n#include \"catalog/pg_default_acl.h\"\n#include \"catalog/pg_db_role_setting.h\"\n#include \"catalog/pg_database.h\"\n#include \"catalog/pg_conversion.h\"\n#include \"catalog/pg_constraint.h\"\n#include \"catalog/pg_collation.h\"\n#include \"catalog/pg_cast.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_amproc.h\"\n#include \"catalog/pg_amop.h\"\n#include \"catalog/pg_am.h\"\n#include \"catalog/pg_aggregate.h\"\n#include \"catalog/indexing.h\"\n#include \"access/sysattr.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic CatCache *SysCache[SysCacheSize];\n\nHeapTuple\nSearchSysCache1(int cacheId,\n\t\t\t\tDatum key1)\n{\n\tAssert(cacheId >= 0 && cacheId < SysCacheSize &&\n\t\t   PointerIsValid(SysCache[cacheId]));\n\tAssert(SysCache[cacheId]->cc_nkeys == 1);\n\n\treturn SearchCatCache1(SysCache[cacheId], key1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "aip->ai_grantor"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_GOPTIONS",
          "args": [
            "*aip"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACLITEM_GET_PRIVS",
          "args": [
            "*aip"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "p",
            "\"%u\"",
            "aip->ai_grantee"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NameStr",
          "args": [
            "((Form_pg_authid) GETSTRUCT(htup))->rolname"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETSTRUCT",
          "args": [
            "htup"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleIsValid",
          "args": [
            "htup"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "aip->ai_grantee"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "strlen(\"=/\") +\n\t\t\t\t 2 * N_ACL_RIGHTS +\n\t\t\t\t 2 * (2 * NAMEDATALEN + 2) +\n\t\t\t\t 1"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"=/\""
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "calcstrlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/tsquery_cleanup.c",
          "lines": "361-380",
          "snippet": "static int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"miscadmin.h\"",
            "#include \"tsearch/ts_utils.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"miscadmin.h\"\n#include \"tsearch/ts_utils.h\"\n#include \"postgres.h\"\n\nstatic int32\ncalcstrlen(NODE *node)\n{\n\tint32\t\tsize = 0;\n\n\tif (node->valnode->type == QI_VAL)\n\t{\n\t\tsize = node->valnode->qoperand.length + 1;\n\t}\n\telse\n\t{\n\t\tAssert(node->valnode->type == QI_OPR);\n\n\t\tsize = calcstrlen(node->right);\n\t\tif (node->valnode->qoperator.oper != OP_NOT)\n\t\t\tsize += calcstrlen(node->left);\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_ACLITEM_P",
          "args": [
            "0"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *aclparse(const char *s, AclItem *aip);\n\nDatum\naclitemout(PG_FUNCTION_ARGS)\n{\n\tAclItem    *aip = PG_GETARG_ACLITEM_P(0);\n\tchar\t   *p;\n\tchar\t   *out;\n\tHeapTuple\thtup;\n\tunsigned\ti;\n\n\tout = palloc(strlen(\"=/\") +\n\t\t\t\t 2 * N_ACL_RIGHTS +\n\t\t\t\t 2 * (2 * NAMEDATALEN + 2) +\n\t\t\t\t 1);\n\n\tp = out;\n\t*p = '\\0';\n\n\tif (aip->ai_grantee != ACL_ID_PUBLIC)\n\t{\n\t\thtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(aip->ai_grantee));\n\t\tif (HeapTupleIsValid(htup))\n\t\t{\n\t\t\tputid(p, NameStr(((Form_pg_authid) GETSTRUCT(htup))->rolname));\n\t\t\tReleaseSysCache(htup);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t/* Generate numeric OID if we don't find an entry */\n\t\t\tsprintf(p, \"%u\", aip->ai_grantee);\n\t\t}\n\t}\n\twhile (*p)\n\t\t++p;\n\n\t*p++ = '=';\n\n\tfor (i = 0; i < N_ACL_RIGHTS; ++i)\n\t{\n\t\tif (ACLITEM_GET_PRIVS(*aip) & (1 << i))\n\t\t\t*p++ = ACL_ALL_RIGHTS_STR[i];\n\t\tif (ACLITEM_GET_GOPTIONS(*aip) & (1 << i))\n\t\t\t*p++ = '*';\n\t}\n\n\t*p++ = '/';\n\t*p = '\\0';\n\n\thtup = SearchSysCache1(AUTHOID, ObjectIdGetDatum(aip->ai_grantor));\n\tif (HeapTupleIsValid(htup))\n\t{\n\t\tputid(p, NameStr(((Form_pg_authid) GETSTRUCT(htup))->rolname));\n\t\tReleaseSysCache(htup);\n\t}\n\telse\n\t{\n\t\t/* Generate numeric OID if we don't find an entry */\n\t\tsprintf(p, \"%u\", aip->ai_grantor);\n\t}\n\n\tPG_RETURN_CSTRING(out);\n}"
  },
  {
    "function_name": "aclitemin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "564-580",
    "snippet": "Datum\naclitemin(PG_FUNCTION_ARGS)\n{\n\tconst char *s = PG_GETARG_CSTRING(0);\n\tAclItem    *aip;\n\n\taip = (AclItem *) palloc(sizeof(AclItem));\n\ts = aclparse(s, aip);\n\twhile (isspace((unsigned char) *s))\n\t\t++s;\n\tif (*s)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"extra garbage at the end of the ACL specification\")));\n\n\tPG_RETURN_ACLITEM_P(aip);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static const char *aclparse(const char *s, AclItem *aip);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_ACLITEM_P",
          "args": [
            "aip"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"extra garbage at the end of the ACL specification\"))"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"extra garbage at the end of the ACL specification\""
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_TEXT_REPRESENTATION"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "(unsigned char) *s"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "array_isspace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/arrayfuncs.c",
          "lines": "431-442",
          "snippet": "static bool\narray_isspace(char ch)\n{\n\tif (ch == ' ' ||\n\t\tch == '\\t' ||\n\t\tch == '\\n' ||\n\t\tch == '\\r' ||\n\t\tch == '\\v' ||\n\t\tch == '\\f')\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/arrayaccess.h\"",
            "#include \"utils/array.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"funcapi.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <math.h>",
            "#include <float.h>\t\t\t\t/* for _isnan */",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool array_isspace(char ch);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"utils/arrayaccess.h\"\n#include \"utils/array.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <math.h>\n#include <float.h>\t\t\t\t/* for _isnan */\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool array_isspace(char ch);\n\nstatic bool\narray_isspace(char ch)\n{\n\tif (ch == ' ' ||\n\t\tch == '\\t' ||\n\t\tch == '\\n' ||\n\t\tch == '\\r' ||\n\t\tch == '\\v' ||\n\t\tch == '\\f')\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "aclparse",
          "args": [
            "s",
            "aip"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "aclparse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "237-366",
          "snippet": "static const char *\naclparse(const char *s, AclItem *aip)\n{\n\tAclMode\t\tprivs,\n\t\t\t\tgoption,\n\t\t\t\tread;\n\tchar\t\tname[NAMEDATALEN];\n\tchar\t\tname2[NAMEDATALEN];\n\n\tAssert(s && aip);\n\n#ifdef ACLDEBUG\n\telog(LOG, \"aclparse: input = \\\"%s\\\"\", s);\n#endif\n\ts = getid(s, name);\n\tif (*s != '=')\n\t{\n\t\t/* we just read a keyword, not a name */\n\t\tif (strcmp(name, \"group\") != 0 && strcmp(name, \"user\") != 0)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"unrecognized key word: \\\"%s\\\"\", name),\n\t\t\t\t\t errhint(\"ACL key word must be \\\"group\\\" or \\\"user\\\".\")));\n\t\ts = getid(s, name);\t\t/* move s to the name beyond the keyword */\n\t\tif (name[0] == '\\0')\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"missing name\"),\n\t\t\t\t\t errhint(\"A name must follow the \\\"group\\\" or \\\"user\\\" key word.\")));\n\t}\n\n\tif (*s != '=')\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"missing \\\"=\\\" sign\")));\n\n\tprivs = goption = ACL_NO_RIGHTS;\n\n\tfor (++s, read = 0; isalpha((unsigned char) *s) || *s == '*'; s++)\n\t{\n\t\tswitch (*s)\n\t\t{\n\t\t\tcase '*':\n\t\t\t\tgoption |= read;\n\t\t\t\tbreak;\n\t\t\tcase ACL_INSERT_CHR:\n\t\t\t\tread = ACL_INSERT;\n\t\t\t\tbreak;\n\t\t\tcase ACL_SELECT_CHR:\n\t\t\t\tread = ACL_SELECT;\n\t\t\t\tbreak;\n\t\t\tcase ACL_UPDATE_CHR:\n\t\t\t\tread = ACL_UPDATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_DELETE_CHR:\n\t\t\t\tread = ACL_DELETE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_TRUNCATE_CHR:\n\t\t\t\tread = ACL_TRUNCATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_REFERENCES_CHR:\n\t\t\t\tread = ACL_REFERENCES;\n\t\t\t\tbreak;\n\t\t\tcase ACL_TRIGGER_CHR:\n\t\t\t\tread = ACL_TRIGGER;\n\t\t\t\tbreak;\n\t\t\tcase ACL_EXECUTE_CHR:\n\t\t\t\tread = ACL_EXECUTE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_USAGE_CHR:\n\t\t\t\tread = ACL_USAGE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CREATE_CHR:\n\t\t\t\tread = ACL_CREATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CREATE_TEMP_CHR:\n\t\t\t\tread = ACL_CREATE_TEMP;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CONNECT_CHR:\n\t\t\t\tread = ACL_CONNECT;\n\t\t\t\tbreak;\n\t\t\tcase 'R':\t\t\t/* ignore old RULE privileges */\n\t\t\t\tread = 0;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t\t errmsg(\"invalid mode character: must be one of \\\"%s\\\"\",\n\t\t\t\t\t\t\t\tACL_ALL_RIGHTS_STR)));\n\t\t}\n\n\t\tprivs |= read;\n\t}\n\n\tif (name[0] == '\\0')\n\t\taip->ai_grantee = ACL_ID_PUBLIC;\n\telse\n\t\taip->ai_grantee = get_role_oid(name, false);\n\n\t/*\n\t * XXX Allow a degree of backward compatibility by defaulting the grantor\n\t * to the superuser.\n\t */\n\tif (*s == '/')\n\t{\n\t\ts = getid(s + 1, name2);\n\t\tif (name2[0] == '\\0')\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"a name must follow the \\\"/\\\" sign\")));\n\t\taip->ai_grantor = get_role_oid(name2, false);\n\t}\n\telse\n\t{\n\t\taip->ai_grantor = BOOTSTRAP_SUPERUSERID;\n\t\tereport(WARNING,\n\t\t\t\t(errcode(ERRCODE_INVALID_GRANTOR),\n\t\t\t\t errmsg(\"defaulting grantor to user ID %u\",\n\t\t\t\t\t\tBOOTSTRAP_SUPERUSERID)));\n\t}\n\n\tACLITEM_SET_PRIVS_GOPTIONS(*aip, privs, goption);\n\n#ifdef ACLDEBUG\n\telog(LOG, \"aclparse: correctly read [%u %x %x]\",\n\t\t aip->ai_grantee, privs, goption);\n#endif\n\n\treturn s;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);",
            "static const char *aclparse(const char *s, AclItem *aip);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
            "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic const char *aclparse(const char *s, AclItem *aip);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic const char *\naclparse(const char *s, AclItem *aip)\n{\n\tAclMode\t\tprivs,\n\t\t\t\tgoption,\n\t\t\t\tread;\n\tchar\t\tname[NAMEDATALEN];\n\tchar\t\tname2[NAMEDATALEN];\n\n\tAssert(s && aip);\n\n#ifdef ACLDEBUG\n\telog(LOG, \"aclparse: input = \\\"%s\\\"\", s);\n#endif\n\ts = getid(s, name);\n\tif (*s != '=')\n\t{\n\t\t/* we just read a keyword, not a name */\n\t\tif (strcmp(name, \"group\") != 0 && strcmp(name, \"user\") != 0)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"unrecognized key word: \\\"%s\\\"\", name),\n\t\t\t\t\t errhint(\"ACL key word must be \\\"group\\\" or \\\"user\\\".\")));\n\t\ts = getid(s, name);\t\t/* move s to the name beyond the keyword */\n\t\tif (name[0] == '\\0')\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"missing name\"),\n\t\t\t\t\t errhint(\"A name must follow the \\\"group\\\" or \\\"user\\\" key word.\")));\n\t}\n\n\tif (*s != '=')\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"missing \\\"=\\\" sign\")));\n\n\tprivs = goption = ACL_NO_RIGHTS;\n\n\tfor (++s, read = 0; isalpha((unsigned char) *s) || *s == '*'; s++)\n\t{\n\t\tswitch (*s)\n\t\t{\n\t\t\tcase '*':\n\t\t\t\tgoption |= read;\n\t\t\t\tbreak;\n\t\t\tcase ACL_INSERT_CHR:\n\t\t\t\tread = ACL_INSERT;\n\t\t\t\tbreak;\n\t\t\tcase ACL_SELECT_CHR:\n\t\t\t\tread = ACL_SELECT;\n\t\t\t\tbreak;\n\t\t\tcase ACL_UPDATE_CHR:\n\t\t\t\tread = ACL_UPDATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_DELETE_CHR:\n\t\t\t\tread = ACL_DELETE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_TRUNCATE_CHR:\n\t\t\t\tread = ACL_TRUNCATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_REFERENCES_CHR:\n\t\t\t\tread = ACL_REFERENCES;\n\t\t\t\tbreak;\n\t\t\tcase ACL_TRIGGER_CHR:\n\t\t\t\tread = ACL_TRIGGER;\n\t\t\t\tbreak;\n\t\t\tcase ACL_EXECUTE_CHR:\n\t\t\t\tread = ACL_EXECUTE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_USAGE_CHR:\n\t\t\t\tread = ACL_USAGE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CREATE_CHR:\n\t\t\t\tread = ACL_CREATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CREATE_TEMP_CHR:\n\t\t\t\tread = ACL_CREATE_TEMP;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CONNECT_CHR:\n\t\t\t\tread = ACL_CONNECT;\n\t\t\t\tbreak;\n\t\t\tcase 'R':\t\t\t/* ignore old RULE privileges */\n\t\t\t\tread = 0;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t\t errmsg(\"invalid mode character: must be one of \\\"%s\\\"\",\n\t\t\t\t\t\t\t\tACL_ALL_RIGHTS_STR)));\n\t\t}\n\n\t\tprivs |= read;\n\t}\n\n\tif (name[0] == '\\0')\n\t\taip->ai_grantee = ACL_ID_PUBLIC;\n\telse\n\t\taip->ai_grantee = get_role_oid(name, false);\n\n\t/*\n\t * XXX Allow a degree of backward compatibility by defaulting the grantor\n\t * to the superuser.\n\t */\n\tif (*s == '/')\n\t{\n\t\ts = getid(s + 1, name2);\n\t\tif (name2[0] == '\\0')\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"a name must follow the \\\"/\\\" sign\")));\n\t\taip->ai_grantor = get_role_oid(name2, false);\n\t}\n\telse\n\t{\n\t\taip->ai_grantor = BOOTSTRAP_SUPERUSERID;\n\t\tereport(WARNING,\n\t\t\t\t(errcode(ERRCODE_INVALID_GRANTOR),\n\t\t\t\t errmsg(\"defaulting grantor to user ID %u\",\n\t\t\t\t\t\tBOOTSTRAP_SUPERUSERID)));\n\t}\n\n\tACLITEM_SET_PRIVS_GOPTIONS(*aip, privs, goption);\n\n#ifdef ACLDEBUG\n\telog(LOG, \"aclparse: correctly read [%u %x %x]\",\n\t\t aip->ai_grantee, privs, goption);\n#endif\n\n\treturn s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "palloc",
          "args": [
            "sizeof(AclItem)"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "xml_palloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1635-1639",
          "snippet": "static void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void *\nxml_palloc(size_t size)\n{\n\treturn MemoryContextAlloc(LibxmlContext, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_CSTRING",
          "args": [
            "0"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic const char *aclparse(const char *s, AclItem *aip);\n\nDatum\naclitemin(PG_FUNCTION_ARGS)\n{\n\tconst char *s = PG_GETARG_CSTRING(0);\n\tAclItem    *aip;\n\n\taip = (AclItem *) palloc(sizeof(AclItem));\n\ts = aclparse(s, aip);\n\twhile (isspace((unsigned char) *s))\n\t\t++s;\n\tif (*s)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"extra garbage at the end of the ACL specification\")));\n\n\tPG_RETURN_ACLITEM_P(aip);\n}"
  },
  {
    "function_name": "check_acl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "539-554",
    "snippet": "static void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void check_acl(const Acl *acl);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\"))"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"ACL arrays must not contain null values\""
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_NULL_VALUE_NOT_ALLOWED"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARR_HASNULL",
          "args": [
            "acl"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\"))"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARR_NDIM",
          "args": [
            "acl"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\"))"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARR_ELEMTYPE",
          "args": [
            "acl"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nstatic void\ncheck_acl(const Acl *acl)\n{\n\tif (ARR_ELEMTYPE(acl) != ACLITEMOID)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL array contains wrong data type\")));\n\tif (ARR_NDIM(acl) != 1)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"ACL arrays must be one-dimensional\")));\n\tif (ARR_HASNULL(acl))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_NULL_VALUE_NOT_ALLOWED),\n\t\t\t\t errmsg(\"ACL arrays must not contain null values\")));\n}"
  },
  {
    "function_name": "aclequal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "508-534",
    "snippet": "bool\naclequal(const Acl *left_acl, const Acl *right_acl)\n{\n\t/* Check for cases where one or both are empty/null */\n\tif (left_acl == NULL || ACL_NUM(left_acl) == 0)\n\t{\n\t\tif (right_acl == NULL || ACL_NUM(right_acl) == 0)\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t}\n\telse\n\t{\n\t\tif (right_acl == NULL || ACL_NUM(right_acl) == 0)\n\t\t\treturn false;\n\t}\n\n\tif (ACL_NUM(left_acl) != ACL_NUM(right_acl))\n\t\treturn false;\n\n\tif (memcmp(ACL_DAT(left_acl),\n\t\t\t   ACL_DAT(right_acl),\n\t\t\t   ACL_NUM(left_acl) * sizeof(AclItem)) == 0)\n\t\treturn true;\n\n\treturn false;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "ACL_DAT(left_acl)",
            "ACL_DAT(right_acl)",
            "ACL_NUM(left_acl) * sizeof(AclItem)"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "left_acl"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "right_acl"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "left_acl"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "right_acl"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "left_acl"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "right_acl"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "right_acl"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "left_acl"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\naclequal(const Acl *left_acl, const Acl *right_acl)\n{\n\t/* Check for cases where one or both are empty/null */\n\tif (left_acl == NULL || ACL_NUM(left_acl) == 0)\n\t{\n\t\tif (right_acl == NULL || ACL_NUM(right_acl) == 0)\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t}\n\telse\n\t{\n\t\tif (right_acl == NULL || ACL_NUM(right_acl) == 0)\n\t\t\treturn false;\n\t}\n\n\tif (ACL_NUM(left_acl) != ACL_NUM(right_acl))\n\t\treturn false;\n\n\tif (memcmp(ACL_DAT(left_acl),\n\t\t\t   ACL_DAT(right_acl),\n\t\t\t   ACL_NUM(left_acl) * sizeof(AclItem)) == 0)\n\t\treturn true;\n\n\treturn false;\n}"
  },
  {
    "function_name": "aclitemsort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "494-499",
    "snippet": "void\naclitemsort(Acl *acl)\n{\n\tif (acl != NULL && ACL_NUM(acl) > 1)\n\t\tqsort(ACL_DAT(acl), ACL_NUM(acl), sizeof(AclItem), aclitemComparator);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void check_acl(const Acl *acl);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qsort",
          "args": [
            "ACL_DAT(acl)",
            "ACL_NUM(acl)",
            "sizeof(AclItem)",
            "aclitemComparator"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "acl"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "acl"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_acl(const Acl *acl);\n\nvoid\naclitemsort(Acl *acl)\n{\n\tif (acl != NULL && ACL_NUM(acl) > 1)\n\t\tqsort(ACL_DAT(acl), ACL_NUM(acl), sizeof(AclItem), aclitemComparator);\n}"
  },
  {
    "function_name": "aclmerge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "450-489",
    "snippet": "Acl *\naclmerge(const Acl *left_acl, const Acl *right_acl, Oid ownerId)\n{\n\tAcl\t\t   *result_acl;\n\tAclItem    *aip;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/* Check for cases where one or both are empty/null */\n\tif (left_acl == NULL || ACL_NUM(left_acl) == 0)\n\t{\n\t\tif (right_acl == NULL || ACL_NUM(right_acl) == 0)\n\t\t\treturn NULL;\n\t\telse\n\t\t\treturn aclcopy(right_acl);\n\t}\n\telse\n\t{\n\t\tif (right_acl == NULL || ACL_NUM(right_acl) == 0)\n\t\t\treturn aclcopy(left_acl);\n\t}\n\n\t/* Merge them the hard way, one item at a time */\n\tresult_acl = aclcopy(left_acl);\n\n\taip = ACL_DAT(right_acl);\n\tnum = ACL_NUM(right_acl);\n\n\tfor (i = 0; i < num; i++, aip++)\n\t{\n\t\tAcl\t\t   *tmp_acl;\n\n\t\ttmp_acl = aclupdate(result_acl, aip, ACL_MODECHG_ADD,\n\t\t\t\t\t\t\townerId, DROP_RESTRICT);\n\t\tpfree(result_acl);\n\t\tresult_acl = tmp_acl;\n\t}\n\n\treturn result_acl;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *aclparse(const char *s, AclItem *aip);",
      "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pfree",
          "args": [
            "result_acl"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1649-1655",
          "snippet": "static void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "aclupdate",
          "args": [
            "result_acl",
            "aip",
            "ACL_MODECHG_ADD",
            "ownerId",
            "DROP_RESTRICT"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "aclupdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "930-1038",
          "snippet": "Acl *\naclupdate(const Acl *old_acl, const AclItem *mod_aip,\n\t\t  int modechg, Oid ownerId, DropBehavior behavior)\n{\n\tAcl\t\t   *new_acl = NULL;\n\tAclItem    *old_aip,\n\t\t\t   *new_aip = NULL;\n\tAclMode\t\told_rights,\n\t\t\t\told_goptions,\n\t\t\t\tnew_rights,\n\t\t\t\tnew_goptions;\n\tint\t\t\tdst,\n\t\t\t\tnum;\n\n\t/* Caller probably already checked old_acl, but be safe */\n\tcheck_acl(old_acl);\n\n\t/* If granting grant options, check for circularity */\n\tif (modechg != ACL_MODECHG_DEL &&\n\t\tACLITEM_GET_GOPTIONS(*mod_aip) != ACL_NO_RIGHTS)\n\t\tcheck_circularity(old_acl, mod_aip, ownerId);\n\n\tnum = ACL_NUM(old_acl);\n\told_aip = ACL_DAT(old_acl);\n\n\t/*\n\t * Search the ACL for an existing entry for this grantee and grantor. If\n\t * one exists, just modify the entry in-place (well, in the same position,\n\t * since we actually return a copy); otherwise, insert the new entry at\n\t * the end.\n\t */\n\n\tfor (dst = 0; dst < num; ++dst)\n\t{\n\t\tif (aclitem_match(mod_aip, old_aip + dst))\n\t\t{\n\t\t\t/* found a match, so modify existing item */\n\t\t\tnew_acl = allocacl(num);\n\t\t\tnew_aip = ACL_DAT(new_acl);\n\t\t\tmemcpy(new_acl, old_acl, ACL_SIZE(old_acl));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (dst == num)\n\t{\n\t\t/* need to append a new item */\n\t\tnew_acl = allocacl(num + 1);\n\t\tnew_aip = ACL_DAT(new_acl);\n\t\tmemcpy(new_aip, old_aip, num * sizeof(AclItem));\n\n\t\t/* initialize the new entry with no permissions */\n\t\tnew_aip[dst].ai_grantee = mod_aip->ai_grantee;\n\t\tnew_aip[dst].ai_grantor = mod_aip->ai_grantor;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(new_aip[dst],\n\t\t\t\t\t\t\t\t   ACL_NO_RIGHTS, ACL_NO_RIGHTS);\n\t\tnum++;\t\t\t\t\t/* set num to the size of new_acl */\n\t}\n\n\told_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\told_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/* apply the specified permissions change */\n\tswitch (modechg)\n\t{\n\t\tcase ACL_MODECHG_ADD:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights | ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_DEL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights & ~ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_EQL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t}\n\n\tnew_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\tnew_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/*\n\t * If the adjusted entry has no permissions, delete it from the list.\n\t */\n\tif (new_rights == ACL_NO_RIGHTS)\n\t{\n\t\tmemmove(new_aip + dst,\n\t\t\t\tnew_aip + dst + 1,\n\t\t\t\t(num - dst - 1) * sizeof(AclItem));\n\t\t/* Adjust array size to be 'num - 1' items */\n\t\tARR_DIMS(new_acl)[0] = num - 1;\n\t\tSET_VARSIZE(new_acl, ACL_N_SIZE(num - 1));\n\t}\n\n\t/*\n\t * Remove abandoned privileges (cascading revoke).  Currently we can only\n\t * handle this when the grantee is not PUBLIC.\n\t */\n\tif ((old_goptions & ~new_goptions) != 0)\n\t{\n\t\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\t\tnew_acl = recursive_revoke(new_acl, mod_aip->ai_grantee,\n\t\t\t\t\t\t\t\t   (old_goptions & ~new_goptions),\n\t\t\t\t\t\t\t\t   ownerId, behavior);\n\t}\n\n\treturn new_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);",
            "static Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);",
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\nstatic Acl *recursive_revoke(Acl *acl, Oid grantee, AclMode revoke_privs,\n\t\t\t\t Oid ownerId, DropBehavior behavior);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nAcl *\naclupdate(const Acl *old_acl, const AclItem *mod_aip,\n\t\t  int modechg, Oid ownerId, DropBehavior behavior)\n{\n\tAcl\t\t   *new_acl = NULL;\n\tAclItem    *old_aip,\n\t\t\t   *new_aip = NULL;\n\tAclMode\t\told_rights,\n\t\t\t\told_goptions,\n\t\t\t\tnew_rights,\n\t\t\t\tnew_goptions;\n\tint\t\t\tdst,\n\t\t\t\tnum;\n\n\t/* Caller probably already checked old_acl, but be safe */\n\tcheck_acl(old_acl);\n\n\t/* If granting grant options, check for circularity */\n\tif (modechg != ACL_MODECHG_DEL &&\n\t\tACLITEM_GET_GOPTIONS(*mod_aip) != ACL_NO_RIGHTS)\n\t\tcheck_circularity(old_acl, mod_aip, ownerId);\n\n\tnum = ACL_NUM(old_acl);\n\told_aip = ACL_DAT(old_acl);\n\n\t/*\n\t * Search the ACL for an existing entry for this grantee and grantor. If\n\t * one exists, just modify the entry in-place (well, in the same position,\n\t * since we actually return a copy); otherwise, insert the new entry at\n\t * the end.\n\t */\n\n\tfor (dst = 0; dst < num; ++dst)\n\t{\n\t\tif (aclitem_match(mod_aip, old_aip + dst))\n\t\t{\n\t\t\t/* found a match, so modify existing item */\n\t\t\tnew_acl = allocacl(num);\n\t\t\tnew_aip = ACL_DAT(new_acl);\n\t\t\tmemcpy(new_acl, old_acl, ACL_SIZE(old_acl));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (dst == num)\n\t{\n\t\t/* need to append a new item */\n\t\tnew_acl = allocacl(num + 1);\n\t\tnew_aip = ACL_DAT(new_acl);\n\t\tmemcpy(new_aip, old_aip, num * sizeof(AclItem));\n\n\t\t/* initialize the new entry with no permissions */\n\t\tnew_aip[dst].ai_grantee = mod_aip->ai_grantee;\n\t\tnew_aip[dst].ai_grantor = mod_aip->ai_grantor;\n\t\tACLITEM_SET_PRIVS_GOPTIONS(new_aip[dst],\n\t\t\t\t\t\t\t\t   ACL_NO_RIGHTS, ACL_NO_RIGHTS);\n\t\tnum++;\t\t\t\t\t/* set num to the size of new_acl */\n\t}\n\n\told_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\told_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/* apply the specified permissions change */\n\tswitch (modechg)\n\t{\n\t\tcase ACL_MODECHG_ADD:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights | ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_DEL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   old_rights & ~ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t\tcase ACL_MODECHG_EQL:\n\t\t\tACLITEM_SET_RIGHTS(new_aip[dst],\n\t\t\t\t\t\t\t   ACLITEM_GET_RIGHTS(*mod_aip));\n\t\t\tbreak;\n\t}\n\n\tnew_rights = ACLITEM_GET_RIGHTS(new_aip[dst]);\n\tnew_goptions = ACLITEM_GET_GOPTIONS(new_aip[dst]);\n\n\t/*\n\t * If the adjusted entry has no permissions, delete it from the list.\n\t */\n\tif (new_rights == ACL_NO_RIGHTS)\n\t{\n\t\tmemmove(new_aip + dst,\n\t\t\t\tnew_aip + dst + 1,\n\t\t\t\t(num - dst - 1) * sizeof(AclItem));\n\t\t/* Adjust array size to be 'num - 1' items */\n\t\tARR_DIMS(new_acl)[0] = num - 1;\n\t\tSET_VARSIZE(new_acl, ACL_N_SIZE(num - 1));\n\t}\n\n\t/*\n\t * Remove abandoned privileges (cascading revoke).  Currently we can only\n\t * handle this when the grantee is not PUBLIC.\n\t */\n\tif ((old_goptions & ~new_goptions) != 0)\n\t{\n\t\tAssert(mod_aip->ai_grantee != ACL_ID_PUBLIC);\n\t\tnew_acl = recursive_revoke(new_acl, mod_aip->ai_grantee,\n\t\t\t\t\t\t\t\t   (old_goptions & ~new_goptions),\n\t\t\t\t\t\t\t\t   ownerId, behavior);\n\t}\n\n\treturn new_acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "right_acl"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "right_acl"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aclcopy",
          "args": [
            "left_acl"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "aclcopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "406-418",
          "snippet": "Acl *\naclcopy(const Acl *orig_acl)\n{\n\tAcl\t\t   *result_acl;\n\n\tresult_acl = allocacl(ACL_NUM(orig_acl));\n\n\tmemcpy(ACL_DAT(result_acl),\n\t\t   ACL_DAT(orig_acl),\n\t\t   ACL_NUM(orig_acl) * sizeof(AclItem));\n\n\treturn result_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nAcl *\naclcopy(const Acl *orig_acl)\n{\n\tAcl\t\t   *result_acl;\n\n\tresult_acl = allocacl(ACL_NUM(orig_acl));\n\n\tmemcpy(ACL_DAT(result_acl),\n\t\t   ACL_DAT(orig_acl),\n\t\t   ACL_NUM(orig_acl) * sizeof(AclItem));\n\n\treturn result_acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "right_acl"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "right_acl"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "left_acl"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *aclparse(const char *s, AclItem *aip);\nstatic void check_circularity(const Acl *old_acl, const AclItem *mod_aip,\n\t\t\t\t  Oid ownerId);\n\nAcl *\naclmerge(const Acl *left_acl, const Acl *right_acl, Oid ownerId)\n{\n\tAcl\t\t   *result_acl;\n\tAclItem    *aip;\n\tint\t\t\ti,\n\t\t\t\tnum;\n\n\t/* Check for cases where one or both are empty/null */\n\tif (left_acl == NULL || ACL_NUM(left_acl) == 0)\n\t{\n\t\tif (right_acl == NULL || ACL_NUM(right_acl) == 0)\n\t\t\treturn NULL;\n\t\telse\n\t\t\treturn aclcopy(right_acl);\n\t}\n\telse\n\t{\n\t\tif (right_acl == NULL || ACL_NUM(right_acl) == 0)\n\t\t\treturn aclcopy(left_acl);\n\t}\n\n\t/* Merge them the hard way, one item at a time */\n\tresult_acl = aclcopy(left_acl);\n\n\taip = ACL_DAT(right_acl);\n\tnum = ACL_NUM(right_acl);\n\n\tfor (i = 0; i < num; i++, aip++)\n\t{\n\t\tAcl\t\t   *tmp_acl;\n\n\t\ttmp_acl = aclupdate(result_acl, aip, ACL_MODECHG_ADD,\n\t\t\t\t\t\t\townerId, DROP_RESTRICT);\n\t\tpfree(result_acl);\n\t\tresult_acl = tmp_acl;\n\t}\n\n\treturn result_acl;\n}"
  },
  {
    "function_name": "aclconcat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "426-442",
    "snippet": "Acl *\naclconcat(const Acl *left_acl, const Acl *right_acl)\n{\n\tAcl\t\t   *result_acl;\n\n\tresult_acl = allocacl(ACL_NUM(left_acl) + ACL_NUM(right_acl));\n\n\tmemcpy(ACL_DAT(result_acl),\n\t\t   ACL_DAT(left_acl),\n\t\t   ACL_NUM(left_acl) * sizeof(AclItem));\n\n\tmemcpy(ACL_DAT(result_acl) + ACL_NUM(left_acl),\n\t\t   ACL_DAT(right_acl),\n\t\t   ACL_NUM(right_acl) * sizeof(AclItem));\n\n\treturn result_acl;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ACL_DAT(result_acl) + ACL_NUM(left_acl)",
            "ACL_DAT(right_acl)",
            "ACL_NUM(right_acl) * sizeof(AclItem)"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "right_acl"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "right_acl"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "left_acl"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "result_acl"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ACL_DAT(result_acl)",
            "ACL_DAT(left_acl)",
            "ACL_NUM(left_acl) * sizeof(AclItem)"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "left_acl"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "left_acl"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "result_acl"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allocacl",
          "args": [
            "ACL_NUM(left_acl) + ACL_NUM(right_acl)"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "allocacl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "375-392",
          "snippet": "static Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *getid(const char *s, char *n);",
            "static Acl *allocacl(int n);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic Acl *allocacl(int n);\n\nstatic Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "right_acl"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "left_acl"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nAcl *\naclconcat(const Acl *left_acl, const Acl *right_acl)\n{\n\tAcl\t\t   *result_acl;\n\n\tresult_acl = allocacl(ACL_NUM(left_acl) + ACL_NUM(right_acl));\n\n\tmemcpy(ACL_DAT(result_acl),\n\t\t   ACL_DAT(left_acl),\n\t\t   ACL_NUM(left_acl) * sizeof(AclItem));\n\n\tmemcpy(ACL_DAT(result_acl) + ACL_NUM(left_acl),\n\t\t   ACL_DAT(right_acl),\n\t\t   ACL_NUM(right_acl) * sizeof(AclItem));\n\n\treturn result_acl;\n}"
  },
  {
    "function_name": "aclcopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "406-418",
    "snippet": "Acl *\naclcopy(const Acl *orig_acl)\n{\n\tAcl\t\t   *result_acl;\n\n\tresult_acl = allocacl(ACL_NUM(orig_acl));\n\n\tmemcpy(ACL_DAT(result_acl),\n\t\t   ACL_DAT(orig_acl),\n\t\t   ACL_NUM(orig_acl) * sizeof(AclItem));\n\n\treturn result_acl;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ACL_DAT(result_acl)",
            "ACL_DAT(orig_acl)",
            "ACL_NUM(orig_acl) * sizeof(AclItem)"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "orig_acl"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "orig_acl"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACL_DAT",
          "args": [
            "result_acl"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allocacl",
          "args": [
            "ACL_NUM(orig_acl)"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "allocacl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "375-392",
          "snippet": "static Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *getid(const char *s, char *n);",
            "static Acl *allocacl(int n);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic Acl *allocacl(int n);\n\nstatic Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_NUM",
          "args": [
            "orig_acl"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nAcl *\naclcopy(const Acl *orig_acl)\n{\n\tAcl\t\t   *result_acl;\n\n\tresult_acl = allocacl(ACL_NUM(orig_acl));\n\n\tmemcpy(ACL_DAT(result_acl),\n\t\t   ACL_DAT(orig_acl),\n\t\t   ACL_NUM(orig_acl) * sizeof(AclItem));\n\n\treturn result_acl;\n}"
  },
  {
    "function_name": "make_empty_acl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "397-401",
    "snippet": "Acl *\nmake_empty_acl(void)\n{\n\treturn allocacl(0);\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "allocacl",
          "args": [
            "0"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "allocacl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "375-392",
          "snippet": "static Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *getid(const char *s, char *n);",
            "static Acl *allocacl(int n);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic Acl *allocacl(int n);\n\nstatic Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nAcl *\nmake_empty_acl(void)\n{\n\treturn allocacl(0);\n}"
  },
  {
    "function_name": "allocacl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "375-392",
    "snippet": "static Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *getid(const char *s, char *n);",
      "static Acl *allocacl(int n);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ARR_DIMS",
          "args": [
            "new_acl"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARR_LBOUND",
          "args": [
            "new_acl"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARSIZE",
          "args": [
            "new_acl",
            "size"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "palloc0",
          "args": [
            "size"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "palloc0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "954-985",
          "snippet": "void *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext CurrentMemoryContext = NULL;",
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext CurrentMemoryContext = NULL;\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\npalloc0(Size size)\n{\n\t/* duplicates MemoryContextAllocZero to avoid increased overhead */\n\tvoid\t   *ret;\n\tMemoryContext context = CurrentMemoryContext;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\tMemSetAligned(ret, 0, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACL_N_SIZE",
          "args": [
            "n"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"invalid size: %d\"",
            "n"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic Acl *allocacl(int n);\n\nstatic Acl *\nallocacl(int n)\n{\n\tAcl\t\t   *new_acl;\n\tSize\t\tsize;\n\n\tif (n < 0)\n\t\telog(ERROR, \"invalid size: %d\", n);\n\tsize = ACL_N_SIZE(n);\n\tnew_acl = (Acl *) palloc0(size);\n\tSET_VARSIZE(new_acl, size);\n\tnew_acl->ndim = 1;\n\tnew_acl->dataoffset = 0;\t/* we never put in any nulls */\n\tnew_acl->elemtype = ACLITEMOID;\n\tARR_LBOUND(new_acl)[0] = 1;\n\tARR_DIMS(new_acl)[0] = n;\n\treturn new_acl;\n}"
  },
  {
    "function_name": "aclparse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "237-366",
    "snippet": "static const char *\naclparse(const char *s, AclItem *aip)\n{\n\tAclMode\t\tprivs,\n\t\t\t\tgoption,\n\t\t\t\tread;\n\tchar\t\tname[NAMEDATALEN];\n\tchar\t\tname2[NAMEDATALEN];\n\n\tAssert(s && aip);\n\n#ifdef ACLDEBUG\n\telog(LOG, \"aclparse: input = \\\"%s\\\"\", s);\n#endif\n\ts = getid(s, name);\n\tif (*s != '=')\n\t{\n\t\t/* we just read a keyword, not a name */\n\t\tif (strcmp(name, \"group\") != 0 && strcmp(name, \"user\") != 0)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"unrecognized key word: \\\"%s\\\"\", name),\n\t\t\t\t\t errhint(\"ACL key word must be \\\"group\\\" or \\\"user\\\".\")));\n\t\ts = getid(s, name);\t\t/* move s to the name beyond the keyword */\n\t\tif (name[0] == '\\0')\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"missing name\"),\n\t\t\t\t\t errhint(\"A name must follow the \\\"group\\\" or \\\"user\\\" key word.\")));\n\t}\n\n\tif (*s != '=')\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"missing \\\"=\\\" sign\")));\n\n\tprivs = goption = ACL_NO_RIGHTS;\n\n\tfor (++s, read = 0; isalpha((unsigned char) *s) || *s == '*'; s++)\n\t{\n\t\tswitch (*s)\n\t\t{\n\t\t\tcase '*':\n\t\t\t\tgoption |= read;\n\t\t\t\tbreak;\n\t\t\tcase ACL_INSERT_CHR:\n\t\t\t\tread = ACL_INSERT;\n\t\t\t\tbreak;\n\t\t\tcase ACL_SELECT_CHR:\n\t\t\t\tread = ACL_SELECT;\n\t\t\t\tbreak;\n\t\t\tcase ACL_UPDATE_CHR:\n\t\t\t\tread = ACL_UPDATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_DELETE_CHR:\n\t\t\t\tread = ACL_DELETE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_TRUNCATE_CHR:\n\t\t\t\tread = ACL_TRUNCATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_REFERENCES_CHR:\n\t\t\t\tread = ACL_REFERENCES;\n\t\t\t\tbreak;\n\t\t\tcase ACL_TRIGGER_CHR:\n\t\t\t\tread = ACL_TRIGGER;\n\t\t\t\tbreak;\n\t\t\tcase ACL_EXECUTE_CHR:\n\t\t\t\tread = ACL_EXECUTE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_USAGE_CHR:\n\t\t\t\tread = ACL_USAGE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CREATE_CHR:\n\t\t\t\tread = ACL_CREATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CREATE_TEMP_CHR:\n\t\t\t\tread = ACL_CREATE_TEMP;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CONNECT_CHR:\n\t\t\t\tread = ACL_CONNECT;\n\t\t\t\tbreak;\n\t\t\tcase 'R':\t\t\t/* ignore old RULE privileges */\n\t\t\t\tread = 0;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t\t errmsg(\"invalid mode character: must be one of \\\"%s\\\"\",\n\t\t\t\t\t\t\t\tACL_ALL_RIGHTS_STR)));\n\t\t}\n\n\t\tprivs |= read;\n\t}\n\n\tif (name[0] == '\\0')\n\t\taip->ai_grantee = ACL_ID_PUBLIC;\n\telse\n\t\taip->ai_grantee = get_role_oid(name, false);\n\n\t/*\n\t * XXX Allow a degree of backward compatibility by defaulting the grantor\n\t * to the superuser.\n\t */\n\tif (*s == '/')\n\t{\n\t\ts = getid(s + 1, name2);\n\t\tif (name2[0] == '\\0')\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"a name must follow the \\\"/\\\" sign\")));\n\t\taip->ai_grantor = get_role_oid(name2, false);\n\t}\n\telse\n\t{\n\t\taip->ai_grantor = BOOTSTRAP_SUPERUSERID;\n\t\tereport(WARNING,\n\t\t\t\t(errcode(ERRCODE_INVALID_GRANTOR),\n\t\t\t\t errmsg(\"defaulting grantor to user ID %u\",\n\t\t\t\t\t\tBOOTSTRAP_SUPERUSERID)));\n\t}\n\n\tACLITEM_SET_PRIVS_GOPTIONS(*aip, privs, goption);\n\n#ifdef ACLDEBUG\n\telog(LOG, \"aclparse: correctly read [%u %x %x]\",\n\t\t aip->ai_grantee, privs, goption);\n#endif\n\n\treturn s;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);",
      "static const char *aclparse(const char *s, AclItem *aip);",
      "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);",
      "static AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "LOG",
            "\"aclparse: correctly read [%u %x %x]\"",
            "aip->ai_grantee",
            "privs",
            "goption"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ACLITEM_SET_PRIVS_GOPTIONS",
          "args": [
            "*aip",
            "privs",
            "goption"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "WARNING",
            "(errcode(ERRCODE_INVALID_GRANTOR),\n\t\t\t\t errmsg(\"defaulting grantor to user ID %u\",\n\t\t\t\t\t\tBOOTSTRAP_SUPERUSERID))"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"defaulting grantor to user ID %u\"",
            "BOOTSTRAP_SUPERUSERID"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_GRANTOR"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_role_oid",
          "args": [
            "name2",
            "false"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "get_role_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "5190-5201",
          "snippet": "Oid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void putid(char *p, const char *s);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nOid\nget_role_oid(const char *rolname, bool missing_ok)\n{\n\tOid\t\t\toid;\n\n\toid = GetSysCacheOid1(AUTHNAME, CStringGetDatum(rolname));\n\tif (!OidIsValid(oid) && !missing_ok)\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_UNDEFINED_OBJECT),\n\t\t\t\t errmsg(\"role \\\"%s\\\" does not exist\", rolname)));\n\treturn oid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"a name must follow the \\\"/\\\" sign\"))"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getid",
          "args": [
            "s + 1",
            "name2"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "getid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "136-181",
          "snippet": "static const char *\ngetid(const char *s, char *n)\n{\n\tint\t\t\tlen = 0;\n\tbool\t\tin_quotes = false;\n\n\tAssert(s && n);\n\n\twhile (isspace((unsigned char) *s))\n\t\ts++;\n\t/* This code had better match what putid() does, below */\n\tfor (;\n\t\t *s != '\\0' &&\n\t\t (isalnum((unsigned char) *s) ||\n\t\t  *s == '_' ||\n\t\t  *s == '\"' ||\n\t\t  in_quotes);\n\t\t s++)\n\t{\n\t\tif (*s == '\"')\n\t\t{\n\t\t\t/* safe to look at next char (could be '\\0' though) */\n\t\t\tif (*(s + 1) != '\"')\n\t\t\t{\n\t\t\t\tin_quotes = !in_quotes;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/* it's an escaped double quote; skip the escaping char */\n\t\t\ts++;\n\t\t}\n\n\t\t/* Add the character to the string */\n\t\tif (len >= NAMEDATALEN - 1)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_NAME_TOO_LONG),\n\t\t\t\t\t errmsg(\"identifier too long\"),\n\t\t\t\t\t errdetail(\"Identifier must be less than %d characters.\",\n\t\t\t\t\t\t\t   NAMEDATALEN)));\n\n\t\tn[len++] = *s;\n\t}\n\tn[len] = '\\0';\n\twhile (isspace((unsigned char) *s))\n\t\ts++;\n\treturn s;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *getid(const char *s, char *n);",
            "static void putid(char *p, const char *s);",
            "static Acl *allocacl(int n);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic void putid(char *p, const char *s);\nstatic Acl *allocacl(int n);\n\nstatic const char *\ngetid(const char *s, char *n)\n{\n\tint\t\t\tlen = 0;\n\tbool\t\tin_quotes = false;\n\n\tAssert(s && n);\n\n\twhile (isspace((unsigned char) *s))\n\t\ts++;\n\t/* This code had better match what putid() does, below */\n\tfor (;\n\t\t *s != '\\0' &&\n\t\t (isalnum((unsigned char) *s) ||\n\t\t  *s == '_' ||\n\t\t  *s == '\"' ||\n\t\t  in_quotes);\n\t\t s++)\n\t{\n\t\tif (*s == '\"')\n\t\t{\n\t\t\t/* safe to look at next char (could be '\\0' though) */\n\t\t\tif (*(s + 1) != '\"')\n\t\t\t{\n\t\t\t\tin_quotes = !in_quotes;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/* it's an escaped double quote; skip the escaping char */\n\t\t\ts++;\n\t\t}\n\n\t\t/* Add the character to the string */\n\t\tif (len >= NAMEDATALEN - 1)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_NAME_TOO_LONG),\n\t\t\t\t\t errmsg(\"identifier too long\"),\n\t\t\t\t\t errdetail(\"Identifier must be less than %d characters.\",\n\t\t\t\t\t\t\t   NAMEDATALEN)));\n\n\t\tn[len++] = *s;\n\t}\n\tn[len] = '\\0';\n\twhile (isspace((unsigned char) *s))\n\t\ts++;\n\treturn s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t\t errmsg(\"invalid mode character: must be one of \\\"%s\\\"\",\n\t\t\t\t\t\t\t\tACL_ALL_RIGHTS_STR))"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "(unsigned char) *s"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"missing \\\"=\\\" sign\"))"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"missing name\"),\n\t\t\t\t\t errhint(\"A name must follow the \\\"group\\\" or \\\"user\\\" key word.\"))"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errhint",
          "args": [
            "\"A name must follow the \\\"group\\\" or \\\"user\\\" key word.\""
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "errhint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "984-999",
          "snippet": "int\nerrhint(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, hint, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrhint(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, hint, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"unrecognized key word: \\\"%s\\\"\", name),\n\t\t\t\t\t errhint(\"ACL key word must be \\\"group\\\" or \\\"user\\\".\"))"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "\"user\""
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "namestrcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/name.c",
          "lines": "246-256",
          "snippet": "int\nnamestrcmp(Name name, const char *str)\n{\n\tif (!name && !str)\n\t\treturn 0;\n\tif (!name)\n\t\treturn -1;\t\t\t\t/* NULL < anything */\n\tif (!str)\n\t\treturn 1;\t\t\t\t/* NULL < anything */\n\treturn strncmp(NameStr(*name), str, NAMEDATALEN);\n}",
          "includes": [
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/lsyscache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/namespace.h\"\n#include \"postgres.h\"\n\nint\nnamestrcmp(Name name, const char *str)\n{\n\tif (!name && !str)\n\t\treturn 0;\n\tif (!name)\n\t\treturn -1;\t\t\t\t/* NULL < anything */\n\tif (!str)\n\t\treturn 1;\t\t\t\t/* NULL < anything */\n\treturn strncmp(NameStr(*name), str, NAMEDATALEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "s && aip"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\nstatic const char *aclparse(const char *s, AclItem *aip);\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\nstatic AclResult pg_role_aclcheck(Oid role_oid, Oid roleid, AclMode mode);\n\nstatic const char *\naclparse(const char *s, AclItem *aip)\n{\n\tAclMode\t\tprivs,\n\t\t\t\tgoption,\n\t\t\t\tread;\n\tchar\t\tname[NAMEDATALEN];\n\tchar\t\tname2[NAMEDATALEN];\n\n\tAssert(s && aip);\n\n#ifdef ACLDEBUG\n\telog(LOG, \"aclparse: input = \\\"%s\\\"\", s);\n#endif\n\ts = getid(s, name);\n\tif (*s != '=')\n\t{\n\t\t/* we just read a keyword, not a name */\n\t\tif (strcmp(name, \"group\") != 0 && strcmp(name, \"user\") != 0)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"unrecognized key word: \\\"%s\\\"\", name),\n\t\t\t\t\t errhint(\"ACL key word must be \\\"group\\\" or \\\"user\\\".\")));\n\t\ts = getid(s, name);\t\t/* move s to the name beyond the keyword */\n\t\tif (name[0] == '\\0')\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"missing name\"),\n\t\t\t\t\t errhint(\"A name must follow the \\\"group\\\" or \\\"user\\\" key word.\")));\n\t}\n\n\tif (*s != '=')\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t errmsg(\"missing \\\"=\\\" sign\")));\n\n\tprivs = goption = ACL_NO_RIGHTS;\n\n\tfor (++s, read = 0; isalpha((unsigned char) *s) || *s == '*'; s++)\n\t{\n\t\tswitch (*s)\n\t\t{\n\t\t\tcase '*':\n\t\t\t\tgoption |= read;\n\t\t\t\tbreak;\n\t\t\tcase ACL_INSERT_CHR:\n\t\t\t\tread = ACL_INSERT;\n\t\t\t\tbreak;\n\t\t\tcase ACL_SELECT_CHR:\n\t\t\t\tread = ACL_SELECT;\n\t\t\t\tbreak;\n\t\t\tcase ACL_UPDATE_CHR:\n\t\t\t\tread = ACL_UPDATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_DELETE_CHR:\n\t\t\t\tread = ACL_DELETE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_TRUNCATE_CHR:\n\t\t\t\tread = ACL_TRUNCATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_REFERENCES_CHR:\n\t\t\t\tread = ACL_REFERENCES;\n\t\t\t\tbreak;\n\t\t\tcase ACL_TRIGGER_CHR:\n\t\t\t\tread = ACL_TRIGGER;\n\t\t\t\tbreak;\n\t\t\tcase ACL_EXECUTE_CHR:\n\t\t\t\tread = ACL_EXECUTE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_USAGE_CHR:\n\t\t\t\tread = ACL_USAGE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CREATE_CHR:\n\t\t\t\tread = ACL_CREATE;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CREATE_TEMP_CHR:\n\t\t\t\tread = ACL_CREATE_TEMP;\n\t\t\t\tbreak;\n\t\t\tcase ACL_CONNECT_CHR:\n\t\t\t\tread = ACL_CONNECT;\n\t\t\t\tbreak;\n\t\t\tcase 'R':\t\t\t/* ignore old RULE privileges */\n\t\t\t\tread = 0;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t\t errmsg(\"invalid mode character: must be one of \\\"%s\\\"\",\n\t\t\t\t\t\t\t\tACL_ALL_RIGHTS_STR)));\n\t\t}\n\n\t\tprivs |= read;\n\t}\n\n\tif (name[0] == '\\0')\n\t\taip->ai_grantee = ACL_ID_PUBLIC;\n\telse\n\t\taip->ai_grantee = get_role_oid(name, false);\n\n\t/*\n\t * XXX Allow a degree of backward compatibility by defaulting the grantor\n\t * to the superuser.\n\t */\n\tif (*s == '/')\n\t{\n\t\ts = getid(s + 1, name2);\n\t\tif (name2[0] == '\\0')\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_INVALID_TEXT_REPRESENTATION),\n\t\t\t\t\t errmsg(\"a name must follow the \\\"/\\\" sign\")));\n\t\taip->ai_grantor = get_role_oid(name2, false);\n\t}\n\telse\n\t{\n\t\taip->ai_grantor = BOOTSTRAP_SUPERUSERID;\n\t\tereport(WARNING,\n\t\t\t\t(errcode(ERRCODE_INVALID_GRANTOR),\n\t\t\t\t errmsg(\"defaulting grantor to user ID %u\",\n\t\t\t\t\t\tBOOTSTRAP_SUPERUSERID)));\n\t}\n\n\tACLITEM_SET_PRIVS_GOPTIONS(*aip, privs, goption);\n\n#ifdef ACLDEBUG\n\telog(LOG, \"aclparse: correctly read [%u %x %x]\",\n\t\t aip->ai_grantee, privs, goption);\n#endif\n\n\treturn s;\n}"
  },
  {
    "function_name": "putid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "188-215",
    "snippet": "static void\nputid(char *p, const char *s)\n{\n\tconst char *src;\n\tbool\t\tsafe = true;\n\n\tfor (src = s; *src; src++)\n\t{\n\t\t/* This test had better match what getid() does, above */\n\t\tif (!isalnum((unsigned char) *src) && *src != '_')\n\t\t{\n\t\t\tsafe = false;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (!safe)\n\t\t*p++ = '\"';\n\tfor (src = s; *src; src++)\n\t{\n\t\t/* A double quote character in a username is encoded as \"\" */\n\t\tif (*src == '\"')\n\t\t\t*p++ = '\"';\n\t\t*p++ = *src;\n\t}\n\tif (!safe)\n\t\t*p++ = '\"';\n\t*p = '\\0';\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void putid(char *p, const char *s);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isalnum",
          "args": [
            "(unsigned char) *src"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void putid(char *p, const char *s);\n\nstatic void\nputid(char *p, const char *s)\n{\n\tconst char *src;\n\tbool\t\tsafe = true;\n\n\tfor (src = s; *src; src++)\n\t{\n\t\t/* This test had better match what getid() does, above */\n\t\tif (!isalnum((unsigned char) *src) && *src != '_')\n\t\t{\n\t\t\tsafe = false;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (!safe)\n\t\t*p++ = '\"';\n\tfor (src = s; *src; src++)\n\t{\n\t\t/* A double quote character in a username is encoded as \"\" */\n\t\tif (*src == '\"')\n\t\t\t*p++ = '\"';\n\t\t*p++ = *src;\n\t}\n\tif (!safe)\n\t\t*p++ = '\"';\n\t*p = '\\0';\n}"
  },
  {
    "function_name": "getid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
    "lines": "136-181",
    "snippet": "static const char *\ngetid(const char *s, char *n)\n{\n\tint\t\t\tlen = 0;\n\tbool\t\tin_quotes = false;\n\n\tAssert(s && n);\n\n\twhile (isspace((unsigned char) *s))\n\t\ts++;\n\t/* This code had better match what putid() does, below */\n\tfor (;\n\t\t *s != '\\0' &&\n\t\t (isalnum((unsigned char) *s) ||\n\t\t  *s == '_' ||\n\t\t  *s == '\"' ||\n\t\t  in_quotes);\n\t\t s++)\n\t{\n\t\tif (*s == '\"')\n\t\t{\n\t\t\t/* safe to look at next char (could be '\\0' though) */\n\t\t\tif (*(s + 1) != '\"')\n\t\t\t{\n\t\t\t\tin_quotes = !in_quotes;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/* it's an escaped double quote; skip the escaping char */\n\t\t\ts++;\n\t\t}\n\n\t\t/* Add the character to the string */\n\t\tif (len >= NAMEDATALEN - 1)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_NAME_TOO_LONG),\n\t\t\t\t\t errmsg(\"identifier too long\"),\n\t\t\t\t\t errdetail(\"Identifier must be less than %d characters.\",\n\t\t\t\t\t\t\t   NAMEDATALEN)));\n\n\t\tn[len++] = *s;\n\t}\n\tn[len] = '\\0';\n\twhile (isspace((unsigned char) *s))\n\t\ts++;\n\treturn s;\n}",
    "includes": [
      "#include \"utils/varlena.h\"",
      "#include \"utils/syscache.h\"",
      "#include \"utils/memutils.h\"",
      "#include \"utils/lsyscache.h\"",
      "#include \"utils/inval.h\"",
      "#include \"utils/catcache.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"foreign/foreign.h\"",
      "#include \"commands/tablespace.h\"",
      "#include \"commands/proclang.h\"",
      "#include \"commands/dbcommands.h\"",
      "#include \"catalog/pg_class.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_auth_members.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"catalog/namespace.h\"",
      "#include \"catalog/catalog.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"access/hash.h\"",
      "#include <ctype.h>",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *getid(const char *s, char *n);",
      "static void putid(char *p, const char *s);",
      "static Acl *allocacl(int n);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "(unsigned char) *s"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "array_isspace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/arrayfuncs.c",
          "lines": "431-442",
          "snippet": "static bool\narray_isspace(char ch)\n{\n\tif (ch == ' ' ||\n\t\tch == '\\t' ||\n\t\tch == '\\n' ||\n\t\tch == '\\r' ||\n\t\tch == '\\v' ||\n\t\tch == '\\f')\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datum.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/arrayaccess.h\"",
            "#include \"utils/array.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"funcapi.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <math.h>",
            "#include <float.h>\t\t\t\t/* for _isnan */",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool array_isspace(char ch);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datum.h\"\n#include \"utils/builtins.h\"\n#include \"utils/arrayaccess.h\"\n#include \"utils/array.h\"\n#include \"libpq/pqformat.h\"\n#include \"funcapi.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <math.h>\n#include <float.h>\t\t\t\t/* for _isnan */\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic bool array_isspace(char ch);\n\nstatic bool\narray_isspace(char ch)\n{\n\tif (ch == ' ' ||\n\t\tch == '\\t' ||\n\t\tch == '\\n' ||\n\t\tch == '\\r' ||\n\t\tch == '\\v' ||\n\t\tch == '\\f')\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_NAME_TOO_LONG),\n\t\t\t\t\t errmsg(\"identifier too long\"),\n\t\t\t\t\t errdetail(\"Identifier must be less than %d characters.\",\n\t\t\t\t\t\t\t   NAMEDATALEN))"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errdetail",
          "args": [
            "\"Identifier must be less than %d characters.\"",
            "NAMEDATALEN"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "errdetail_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "918-933",
          "snippet": "int\nerrdetail_log(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, detail_log, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrdetail_log(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tEVALUATE_MESSAGE(edata->domain, detail_log, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"identifier too long\""
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_NAME_TOO_LONG"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "isalnum",
          "args": [
            "(unsigned char) *s"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "s && n"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic const char *getid(const char *s, char *n);\nstatic void putid(char *p, const char *s);\nstatic Acl *allocacl(int n);\n\nstatic const char *\ngetid(const char *s, char *n)\n{\n\tint\t\t\tlen = 0;\n\tbool\t\tin_quotes = false;\n\n\tAssert(s && n);\n\n\twhile (isspace((unsigned char) *s))\n\t\ts++;\n\t/* This code had better match what putid() does, below */\n\tfor (;\n\t\t *s != '\\0' &&\n\t\t (isalnum((unsigned char) *s) ||\n\t\t  *s == '_' ||\n\t\t  *s == '\"' ||\n\t\t  in_quotes);\n\t\t s++)\n\t{\n\t\tif (*s == '\"')\n\t\t{\n\t\t\t/* safe to look at next char (could be '\\0' though) */\n\t\t\tif (*(s + 1) != '\"')\n\t\t\t{\n\t\t\t\tin_quotes = !in_quotes;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/* it's an escaped double quote; skip the escaping char */\n\t\t\ts++;\n\t\t}\n\n\t\t/* Add the character to the string */\n\t\tif (len >= NAMEDATALEN - 1)\n\t\t\tereport(ERROR,\n\t\t\t\t\t(errcode(ERRCODE_NAME_TOO_LONG),\n\t\t\t\t\t errmsg(\"identifier too long\"),\n\t\t\t\t\t errdetail(\"Identifier must be less than %d characters.\",\n\t\t\t\t\t\t\t   NAMEDATALEN)));\n\n\t\tn[len++] = *s;\n\t}\n\tn[len] = '\\0';\n\twhile (isspace((unsigned char) *s))\n\t\ts++;\n\treturn s;\n}"
  }
]