[
  {
    "function_name": "DeleteExpandedObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/expandeddatum.c",
    "lines": "135-145",
    "snippet": "void\nDeleteExpandedObject(Datum d)\n{\n\tExpandedObjectHeader *eohptr = DatumGetEOHP(d);\n\n\t/* Assert caller gave a R/W pointer */\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED_RW(DatumGetPointer(d)));\n\n\t/* Kill it */\n\tMemoryContextDelete(eohptr->eoh_context);\n}",
    "includes": [
      "#include \"utils/memutils.h\"",
      "#include \"utils/expandeddatum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MemoryContextDelete",
          "args": [
            "eohptr->eoh_context"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "MemoryContextDeleteChildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "255-266",
          "snippet": "void\nMemoryContextDeleteChildren(MemoryContext context)\n{\n\tAssertArg(MemoryContextIsValid(context));\n\n\t/*\n\t * MemoryContextDelete will delink the child from me, so just iterate as\n\t * long as there is a child.\n\t */\n\twhile (context->firstchild != NULL)\n\t\tMemoryContextDelete(context->firstchild);\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid\nMemoryContextDeleteChildren(MemoryContext context)\n{\n\tAssertArg(MemoryContextIsValid(context));\n\n\t/*\n\t * MemoryContextDelete will delink the child from me, so just iterate as\n\t * long as there is a child.\n\t */\n\twhile (context->firstchild != NULL)\n\t\tMemoryContextDelete(context->firstchild);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "VARATT_IS_EXTERNAL_EXPANDED_RW(DatumGetPointer(d))"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARATT_IS_EXTERNAL_EXPANDED_RW",
          "args": [
            "DatumGetPointer(d)"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "d"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetEOHP",
          "args": [
            "d"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "DatumGetEOHP",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/expandeddatum.c",
          "lines": "28-38",
          "snippet": "ExpandedObjectHeader *\nDatumGetEOHP(Datum d)\n{\n\tvarattrib_1b_e *datum = (varattrib_1b_e *) DatumGetPointer(d);\n\tvaratt_expanded ptr;\n\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED(datum));\n\tmemcpy(&ptr, VARDATA_EXTERNAL(datum), sizeof(ptr));\n\tAssert(VARATT_IS_EXPANDED_HEADER(ptr.eohptr));\n\treturn ptr.eohptr;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/expandeddatum.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/expandeddatum.h\"\n#include \"postgres.h\"\n\nExpandedObjectHeader *\nDatumGetEOHP(Datum d)\n{\n\tvarattrib_1b_e *datum = (varattrib_1b_e *) DatumGetPointer(d);\n\tvaratt_expanded ptr;\n\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED(datum));\n\tmemcpy(&ptr, VARDATA_EXTERNAL(datum), sizeof(ptr));\n\tAssert(VARATT_IS_EXPANDED_HEADER(ptr.eohptr));\n\treturn ptr.eohptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/expandeddatum.h\"\n#include \"postgres.h\"\n\nvoid\nDeleteExpandedObject(Datum d)\n{\n\tExpandedObjectHeader *eohptr = DatumGetEOHP(d);\n\n\t/* Assert caller gave a R/W pointer */\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED_RW(DatumGetPointer(d)));\n\n\t/* Kill it */\n\tMemoryContextDelete(eohptr->eoh_context);\n}"
  },
  {
    "function_name": "TransferExpandedObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/expandeddatum.c",
    "lines": "117-130",
    "snippet": "Datum\nTransferExpandedObject(Datum d, MemoryContext new_parent)\n{\n\tExpandedObjectHeader *eohptr = DatumGetEOHP(d);\n\n\t/* Assert caller gave a R/W pointer */\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED_RW(DatumGetPointer(d)));\n\n\t/* Transfer ownership */\n\tMemoryContextSetParent(eohptr->eoh_context, new_parent);\n\n\t/* Return the object's standard read-write pointer */\n\treturn EOHPGetRWDatum(eohptr);\n}",
    "includes": [
      "#include \"utils/memutils.h\"",
      "#include \"utils/expandeddatum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EOHPGetRWDatum",
          "args": [
            "eohptr"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSetParent",
          "args": [
            "eohptr->eoh_context",
            "new_parent"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "MemoryContextSetParent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "353-397",
          "snippet": "void\nMemoryContextSetParent(MemoryContext context, MemoryContext new_parent)\n{\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertArg(context != new_parent);\n\n\t/* Fast path if it's got correct parent already */\n\tif (new_parent == context->parent)\n\t\treturn;\n\n\t/* Delink from existing parent, if any */\n\tif (context->parent)\n\t{\n\t\tMemoryContext parent = context->parent;\n\n\t\tif (context->prevchild != NULL)\n\t\t\tcontext->prevchild->nextchild = context->nextchild;\n\t\telse\n\t\t{\n\t\t\tAssert(parent->firstchild == context);\n\t\t\tparent->firstchild = context->nextchild;\n\t\t}\n\n\t\tif (context->nextchild != NULL)\n\t\t\tcontext->nextchild->prevchild = context->prevchild;\n\t}\n\n\t/* And relink */\n\tif (new_parent)\n\t{\n\t\tAssertArg(MemoryContextIsValid(new_parent));\n\t\tcontext->parent = new_parent;\n\t\tcontext->prevchild = NULL;\n\t\tcontext->nextchild = new_parent->firstchild;\n\t\tif (new_parent->firstchild != NULL)\n\t\t\tnew_parent->firstchild->prevchild = context;\n\t\tnew_parent->firstchild = context;\n\t}\n\telse\n\t{\n\t\tcontext->parent = NULL;\n\t\tcontext->prevchild = NULL;\n\t\tcontext->nextchild = NULL;\n\t}\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid\nMemoryContextSetParent(MemoryContext context, MemoryContext new_parent)\n{\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertArg(context != new_parent);\n\n\t/* Fast path if it's got correct parent already */\n\tif (new_parent == context->parent)\n\t\treturn;\n\n\t/* Delink from existing parent, if any */\n\tif (context->parent)\n\t{\n\t\tMemoryContext parent = context->parent;\n\n\t\tif (context->prevchild != NULL)\n\t\t\tcontext->prevchild->nextchild = context->nextchild;\n\t\telse\n\t\t{\n\t\t\tAssert(parent->firstchild == context);\n\t\t\tparent->firstchild = context->nextchild;\n\t\t}\n\n\t\tif (context->nextchild != NULL)\n\t\t\tcontext->nextchild->prevchild = context->prevchild;\n\t}\n\n\t/* And relink */\n\tif (new_parent)\n\t{\n\t\tAssertArg(MemoryContextIsValid(new_parent));\n\t\tcontext->parent = new_parent;\n\t\tcontext->prevchild = NULL;\n\t\tcontext->nextchild = new_parent->firstchild;\n\t\tif (new_parent->firstchild != NULL)\n\t\t\tnew_parent->firstchild->prevchild = context;\n\t\tnew_parent->firstchild = context;\n\t}\n\telse\n\t{\n\t\tcontext->parent = NULL;\n\t\tcontext->prevchild = NULL;\n\t\tcontext->nextchild = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "VARATT_IS_EXTERNAL_EXPANDED_RW(DatumGetPointer(d))"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARATT_IS_EXTERNAL_EXPANDED_RW",
          "args": [
            "DatumGetPointer(d)"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "d"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetEOHP",
          "args": [
            "d"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "DatumGetEOHP",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/expandeddatum.c",
          "lines": "28-38",
          "snippet": "ExpandedObjectHeader *\nDatumGetEOHP(Datum d)\n{\n\tvarattrib_1b_e *datum = (varattrib_1b_e *) DatumGetPointer(d);\n\tvaratt_expanded ptr;\n\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED(datum));\n\tmemcpy(&ptr, VARDATA_EXTERNAL(datum), sizeof(ptr));\n\tAssert(VARATT_IS_EXPANDED_HEADER(ptr.eohptr));\n\treturn ptr.eohptr;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/expandeddatum.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/expandeddatum.h\"\n#include \"postgres.h\"\n\nExpandedObjectHeader *\nDatumGetEOHP(Datum d)\n{\n\tvarattrib_1b_e *datum = (varattrib_1b_e *) DatumGetPointer(d);\n\tvaratt_expanded ptr;\n\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED(datum));\n\tmemcpy(&ptr, VARDATA_EXTERNAL(datum), sizeof(ptr));\n\tAssert(VARATT_IS_EXPANDED_HEADER(ptr.eohptr));\n\treturn ptr.eohptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/expandeddatum.h\"\n#include \"postgres.h\"\n\nDatum\nTransferExpandedObject(Datum d, MemoryContext new_parent)\n{\n\tExpandedObjectHeader *eohptr = DatumGetEOHP(d);\n\n\t/* Assert caller gave a R/W pointer */\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED_RW(DatumGetPointer(d)));\n\n\t/* Transfer ownership */\n\tMemoryContextSetParent(eohptr->eoh_context, new_parent);\n\n\t/* Return the object's standard read-write pointer */\n\treturn EOHPGetRWDatum(eohptr);\n}"
  },
  {
    "function_name": "MakeExpandedObjectReadOnlyInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/expandeddatum.c",
    "lines": "94-108",
    "snippet": "Datum\nMakeExpandedObjectReadOnlyInternal(Datum d)\n{\n\tExpandedObjectHeader *eohptr;\n\n\t/* Nothing to do if not a read-write expanded-object pointer */\n\tif (!VARATT_IS_EXTERNAL_EXPANDED_RW(DatumGetPointer(d)))\n\t\treturn d;\n\n\t/* Now safe to extract the object pointer */\n\teohptr = DatumGetEOHP(d);\n\n\t/* Return the built-in read-only pointer instead of given pointer */\n\treturn EOHPGetRODatum(eohptr);\n}",
    "includes": [
      "#include \"utils/memutils.h\"",
      "#include \"utils/expandeddatum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EOHPGetRODatum",
          "args": [
            "eohptr"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetEOHP",
          "args": [
            "d"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "DatumGetEOHP",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/expandeddatum.c",
          "lines": "28-38",
          "snippet": "ExpandedObjectHeader *\nDatumGetEOHP(Datum d)\n{\n\tvarattrib_1b_e *datum = (varattrib_1b_e *) DatumGetPointer(d);\n\tvaratt_expanded ptr;\n\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED(datum));\n\tmemcpy(&ptr, VARDATA_EXTERNAL(datum), sizeof(ptr));\n\tAssert(VARATT_IS_EXPANDED_HEADER(ptr.eohptr));\n\treturn ptr.eohptr;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/expandeddatum.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/expandeddatum.h\"\n#include \"postgres.h\"\n\nExpandedObjectHeader *\nDatumGetEOHP(Datum d)\n{\n\tvarattrib_1b_e *datum = (varattrib_1b_e *) DatumGetPointer(d);\n\tvaratt_expanded ptr;\n\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED(datum));\n\tmemcpy(&ptr, VARDATA_EXTERNAL(datum), sizeof(ptr));\n\tAssert(VARATT_IS_EXPANDED_HEADER(ptr.eohptr));\n\treturn ptr.eohptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VARATT_IS_EXTERNAL_EXPANDED_RW",
          "args": [
            "DatumGetPointer(d)"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "d"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/expandeddatum.h\"\n#include \"postgres.h\"\n\nDatum\nMakeExpandedObjectReadOnlyInternal(Datum d)\n{\n\tExpandedObjectHeader *eohptr;\n\n\t/* Nothing to do if not a read-write expanded-object pointer */\n\tif (!VARATT_IS_EXTERNAL_EXPANDED_RW(DatumGetPointer(d)))\n\t\treturn d;\n\n\t/* Now safe to extract the object pointer */\n\teohptr = DatumGetEOHP(d);\n\n\t/* Return the built-in read-only pointer instead of given pointer */\n\treturn EOHPGetRODatum(eohptr);\n}"
  },
  {
    "function_name": "EOH_flatten_into",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/expandeddatum.c",
    "lines": "80-85",
    "snippet": "void\nEOH_flatten_into(ExpandedObjectHeader *eohptr,\n\t\t\t\t void *result, Size allocated_size)\n{\n\teohptr->eoh_methods->flatten_into(eohptr, result, allocated_size);\n}",
    "includes": [
      "#include \"utils/memutils.h\"",
      "#include \"utils/expandeddatum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eohptr->eoh_methods->flatten_into",
          "args": [
            "eohptr",
            "result",
            "allocated_size"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/expandeddatum.h\"\n#include \"postgres.h\"\n\nvoid\nEOH_flatten_into(ExpandedObjectHeader *eohptr,\n\t\t\t\t void *result, Size allocated_size)\n{\n\teohptr->eoh_methods->flatten_into(eohptr, result, allocated_size);\n}"
  },
  {
    "function_name": "EOH_get_flat_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/expandeddatum.c",
    "lines": "74-78",
    "snippet": "Size\nEOH_get_flat_size(ExpandedObjectHeader *eohptr)\n{\n\treturn eohptr->eoh_methods->get_flat_size(eohptr);\n}",
    "includes": [
      "#include \"utils/memutils.h\"",
      "#include \"utils/expandeddatum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eohptr->eoh_methods->get_flat_size",
          "args": [
            "eohptr"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/expandeddatum.h\"\n#include \"postgres.h\"\n\nSize\nEOH_get_flat_size(ExpandedObjectHeader *eohptr)\n{\n\treturn eohptr->eoh_methods->get_flat_size(eohptr);\n}"
  },
  {
    "function_name": "EOH_init_header",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/expandeddatum.c",
    "lines": "47-65",
    "snippet": "void\nEOH_init_header(ExpandedObjectHeader *eohptr,\n\t\t\t\tconst ExpandedObjectMethods *methods,\n\t\t\t\tMemoryContext obj_context)\n{\n\tvaratt_expanded ptr;\n\n\teohptr->vl_len_ = EOH_HEADER_MAGIC;\n\teohptr->eoh_methods = methods;\n\teohptr->eoh_context = obj_context;\n\n\tptr.eohptr = eohptr;\n\n\tSET_VARTAG_EXTERNAL(eohptr->eoh_rw_ptr, VARTAG_EXPANDED_RW);\n\tmemcpy(VARDATA_EXTERNAL(eohptr->eoh_rw_ptr), &ptr, sizeof(ptr));\n\n\tSET_VARTAG_EXTERNAL(eohptr->eoh_ro_ptr, VARTAG_EXPANDED_RO);\n\tmemcpy(VARDATA_EXTERNAL(eohptr->eoh_ro_ptr), &ptr, sizeof(ptr));\n}",
    "includes": [
      "#include \"utils/memutils.h\"",
      "#include \"utils/expandeddatum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "VARDATA_EXTERNAL(eohptr->eoh_ro_ptr)",
            "&ptr",
            "sizeof(ptr)"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARDATA_EXTERNAL",
          "args": [
            "eohptr->eoh_ro_ptr"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARTAG_EXTERNAL",
          "args": [
            "eohptr->eoh_ro_ptr",
            "VARTAG_EXPANDED_RO"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "VARDATA_EXTERNAL(eohptr->eoh_rw_ptr)",
            "&ptr",
            "sizeof(ptr)"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARDATA_EXTERNAL",
          "args": [
            "eohptr->eoh_rw_ptr"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_VARTAG_EXTERNAL",
          "args": [
            "eohptr->eoh_rw_ptr",
            "VARTAG_EXPANDED_RW"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/expandeddatum.h\"\n#include \"postgres.h\"\n\nvoid\nEOH_init_header(ExpandedObjectHeader *eohptr,\n\t\t\t\tconst ExpandedObjectMethods *methods,\n\t\t\t\tMemoryContext obj_context)\n{\n\tvaratt_expanded ptr;\n\n\teohptr->vl_len_ = EOH_HEADER_MAGIC;\n\teohptr->eoh_methods = methods;\n\teohptr->eoh_context = obj_context;\n\n\tptr.eohptr = eohptr;\n\n\tSET_VARTAG_EXTERNAL(eohptr->eoh_rw_ptr, VARTAG_EXPANDED_RW);\n\tmemcpy(VARDATA_EXTERNAL(eohptr->eoh_rw_ptr), &ptr, sizeof(ptr));\n\n\tSET_VARTAG_EXTERNAL(eohptr->eoh_ro_ptr, VARTAG_EXPANDED_RO);\n\tmemcpy(VARDATA_EXTERNAL(eohptr->eoh_ro_ptr), &ptr, sizeof(ptr));\n}"
  },
  {
    "function_name": "DatumGetEOHP",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/expandeddatum.c",
    "lines": "28-38",
    "snippet": "ExpandedObjectHeader *\nDatumGetEOHP(Datum d)\n{\n\tvarattrib_1b_e *datum = (varattrib_1b_e *) DatumGetPointer(d);\n\tvaratt_expanded ptr;\n\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED(datum));\n\tmemcpy(&ptr, VARDATA_EXTERNAL(datum), sizeof(ptr));\n\tAssert(VARATT_IS_EXPANDED_HEADER(ptr.eohptr));\n\treturn ptr.eohptr;\n}",
    "includes": [
      "#include \"utils/memutils.h\"",
      "#include \"utils/expandeddatum.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "VARATT_IS_EXPANDED_HEADER(ptr.eohptr)"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARATT_IS_EXPANDED_HEADER",
          "args": [
            "ptr.eohptr"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ptr",
            "VARDATA_EXTERNAL(datum)",
            "sizeof(ptr)"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARDATA_EXTERNAL",
          "args": [
            "datum"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Assert",
          "args": [
            "VARATT_IS_EXTERNAL_EXPANDED(datum)"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VARATT_IS_EXTERNAL_EXPANDED",
          "args": [
            "datum"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DatumGetPointer",
          "args": [
            "d"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/expandeddatum.h\"\n#include \"postgres.h\"\n\nExpandedObjectHeader *\nDatumGetEOHP(Datum d)\n{\n\tvarattrib_1b_e *datum = (varattrib_1b_e *) DatumGetPointer(d);\n\tvaratt_expanded ptr;\n\n\tAssert(VARATT_IS_EXTERNAL_EXPANDED(datum));\n\tmemcpy(&ptr, VARDATA_EXTERNAL(datum), sizeof(ptr));\n\tAssert(VARATT_IS_EXPANDED_HEADER(ptr.eohptr));\n\treturn ptr.eohptr;\n}"
  }
]