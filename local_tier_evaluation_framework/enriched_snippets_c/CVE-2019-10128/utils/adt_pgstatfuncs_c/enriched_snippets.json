[
  {
    "function_name": "pg_stat_get_archiver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1819-1884",
    "snippet": "Datum\npg_stat_get_archiver(PG_FUNCTION_ARGS)\n{\n\tTupleDesc\ttupdesc;\n\tDatum\t\tvalues[7];\n\tbool\t\tnulls[7];\n\tPgStat_ArchiverStats *archiver_stats;\n\n\t/* Initialise values and NULL flags arrays */\n\tMemSet(values, 0, sizeof(values));\n\tMemSet(nulls, 0, sizeof(nulls));\n\n\t/* Initialise attributes information in the tuple descriptor */\n\ttupdesc = CreateTemplateTupleDesc(7, false);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"archived_count\",\n\t\t\t\t\t   INT8OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"last_archived_wal\",\n\t\t\t\t\t   TEXTOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"last_archived_time\",\n\t\t\t\t\t   TIMESTAMPTZOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"failed_count\",\n\t\t\t\t\t   INT8OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 5, \"last_failed_wal\",\n\t\t\t\t\t   TEXTOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 6, \"last_failed_time\",\n\t\t\t\t\t   TIMESTAMPTZOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 7, \"stats_reset\",\n\t\t\t\t\t   TIMESTAMPTZOID, -1, 0);\n\n\tBlessTupleDesc(tupdesc);\n\n\t/* Get statistics about the archiver process */\n\tarchiver_stats = pgstat_fetch_stat_archiver();\n\n\t/* Fill values and NULLs */\n\tvalues[0] = Int64GetDatum(archiver_stats->archived_count);\n\tif (*(archiver_stats->last_archived_wal) == '\\0')\n\t\tnulls[1] = true;\n\telse\n\t\tvalues[1] = CStringGetTextDatum(archiver_stats->last_archived_wal);\n\n\tif (archiver_stats->last_archived_timestamp == 0)\n\t\tnulls[2] = true;\n\telse\n\t\tvalues[2] = TimestampTzGetDatum(archiver_stats->last_archived_timestamp);\n\n\tvalues[3] = Int64GetDatum(archiver_stats->failed_count);\n\tif (*(archiver_stats->last_failed_wal) == '\\0')\n\t\tnulls[4] = true;\n\telse\n\t\tvalues[4] = CStringGetTextDatum(archiver_stats->last_failed_wal);\n\n\tif (archiver_stats->last_failed_timestamp == 0)\n\t\tnulls[5] = true;\n\telse\n\t\tvalues[5] = TimestampTzGetDatum(archiver_stats->last_failed_timestamp);\n\n\tif (archiver_stats->stat_reset_timestamp == 0)\n\t\tnulls[6] = true;\n\telse\n\t\tvalues[6] = TimestampTzGetDatum(archiver_stats->stat_reset_timestamp);\n\n\t/* Returns the record as Datum */\n\tPG_RETURN_DATUM(HeapTupleGetDatum(\n\t\t\t\t\t\t\t\t\t  heap_form_tuple(tupdesc, values, nulls)));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_DATUM",
          "args": [
            "HeapTupleGetDatum(\n\t\t\t\t\t\t\t\t\t  heap_form_tuple(tupdesc, values, nulls))"
          ],
          "line": 1882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeapTupleGetDatum",
          "args": [
            "heap_form_tuple(tupdesc, values, nulls)"
          ],
          "line": 1882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap_form_tuple",
          "args": [
            "tupdesc",
            "values",
            "nulls"
          ],
          "line": 1883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TimestampTzGetDatum",
          "args": [
            "archiver_stats->stat_reset_timestamp"
          ],
          "line": 1879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TimestampTzGetDatum",
          "args": [
            "archiver_stats->last_failed_timestamp"
          ],
          "line": 1874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "archiver_stats->last_failed_wal"
          ],
          "line": 1869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int64GetDatum",
          "args": [
            "archiver_stats->failed_count"
          ],
          "line": 1865
        },
        "resolved": true,
        "details": {
          "function_name": "Int64GetDatum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/fmgr/fmgr.c",
          "lines": "1876-1883",
          "snippet": "Datum\nInt64GetDatum(int64 X)\n{\n\tint64\t   *retval = (int64 *) palloc(sizeof(int64));\n\n\t*retval = X;\n\treturn PointerGetDatum(retval);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/fmgrtab.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"pgstat.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"executor/functions.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/guc.h\"\n#include \"utils/fmgrtab.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"pgstat.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"miscadmin.h\"\n#include \"lib/stringinfo.h\"\n#include \"executor/functions.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_language.h\"\n#include \"access/tuptoaster.h\"\n#include \"postgres.h\"\n\nDatum\nInt64GetDatum(int64 X)\n{\n\tint64\t   *retval = (int64 *) palloc(sizeof(int64));\n\n\t*retval = X;\n\treturn PointerGetDatum(retval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TimestampTzGetDatum",
          "args": [
            "archiver_stats->last_archived_timestamp"
          ],
          "line": 1863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "archiver_stats->last_archived_wal"
          ],
          "line": 1858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_archiver",
          "args": [],
          "line": 1851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BlessTupleDesc",
          "args": [
            "tupdesc"
          ],
          "line": 1848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 7",
            "\"stats_reset\"",
            "TIMESTAMPTZOID",
            "-1",
            "0"
          ],
          "line": 1845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 6",
            "\"last_failed_time\"",
            "TIMESTAMPTZOID",
            "-1",
            "0"
          ],
          "line": 1843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 5",
            "\"last_failed_wal\"",
            "TEXTOID",
            "-1",
            "0"
          ],
          "line": 1841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 4",
            "\"failed_count\"",
            "INT8OID",
            "-1",
            "0"
          ],
          "line": 1839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 3",
            "\"last_archived_time\"",
            "TIMESTAMPTZOID",
            "-1",
            "0"
          ],
          "line": 1837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 2",
            "\"last_archived_wal\"",
            "TEXTOID",
            "-1",
            "0"
          ],
          "line": 1835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TupleDescInitEntry",
          "args": [
            "tupdesc",
            "(AttrNumber) 1",
            "\"archived_count\"",
            "INT8OID",
            "-1",
            "0"
          ],
          "line": 1833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CreateTemplateTupleDesc",
          "args": [
            "7",
            "false"
          ],
          "line": 1832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "nulls",
            "0",
            "sizeof(nulls)"
          ],
          "line": 1829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "values",
            "0",
            "sizeof(values)"
          ],
          "line": 1828
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_archiver(PG_FUNCTION_ARGS)\n{\n\tTupleDesc\ttupdesc;\n\tDatum\t\tvalues[7];\n\tbool\t\tnulls[7];\n\tPgStat_ArchiverStats *archiver_stats;\n\n\t/* Initialise values and NULL flags arrays */\n\tMemSet(values, 0, sizeof(values));\n\tMemSet(nulls, 0, sizeof(nulls));\n\n\t/* Initialise attributes information in the tuple descriptor */\n\ttupdesc = CreateTemplateTupleDesc(7, false);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 1, \"archived_count\",\n\t\t\t\t\t   INT8OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 2, \"last_archived_wal\",\n\t\t\t\t\t   TEXTOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 3, \"last_archived_time\",\n\t\t\t\t\t   TIMESTAMPTZOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 4, \"failed_count\",\n\t\t\t\t\t   INT8OID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 5, \"last_failed_wal\",\n\t\t\t\t\t   TEXTOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 6, \"last_failed_time\",\n\t\t\t\t\t   TIMESTAMPTZOID, -1, 0);\n\tTupleDescInitEntry(tupdesc, (AttrNumber) 7, \"stats_reset\",\n\t\t\t\t\t   TIMESTAMPTZOID, -1, 0);\n\n\tBlessTupleDesc(tupdesc);\n\n\t/* Get statistics about the archiver process */\n\tarchiver_stats = pgstat_fetch_stat_archiver();\n\n\t/* Fill values and NULLs */\n\tvalues[0] = Int64GetDatum(archiver_stats->archived_count);\n\tif (*(archiver_stats->last_archived_wal) == '\\0')\n\t\tnulls[1] = true;\n\telse\n\t\tvalues[1] = CStringGetTextDatum(archiver_stats->last_archived_wal);\n\n\tif (archiver_stats->last_archived_timestamp == 0)\n\t\tnulls[2] = true;\n\telse\n\t\tvalues[2] = TimestampTzGetDatum(archiver_stats->last_archived_timestamp);\n\n\tvalues[3] = Int64GetDatum(archiver_stats->failed_count);\n\tif (*(archiver_stats->last_failed_wal) == '\\0')\n\t\tnulls[4] = true;\n\telse\n\t\tvalues[4] = CStringGetTextDatum(archiver_stats->last_failed_wal);\n\n\tif (archiver_stats->last_failed_timestamp == 0)\n\t\tnulls[5] = true;\n\telse\n\t\tvalues[5] = TimestampTzGetDatum(archiver_stats->last_failed_timestamp);\n\n\tif (archiver_stats->stat_reset_timestamp == 0)\n\t\tnulls[6] = true;\n\telse\n\t\tvalues[6] = TimestampTzGetDatum(archiver_stats->stat_reset_timestamp);\n\n\t/* Returns the record as Datum */\n\tPG_RETURN_DATUM(HeapTupleGetDatum(\n\t\t\t\t\t\t\t\t\t  heap_form_tuple(tupdesc, values, nulls)));\n}"
  },
  {
    "function_name": "pg_stat_reset_single_function_counters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1809-1817",
    "snippet": "Datum\npg_stat_reset_single_function_counters(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncoid = PG_GETARG_OID(0);\n\n\tpgstat_reset_single_counter(funcoid, RESET_FUNCTION);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 1816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_reset_single_counter",
          "args": [
            "funcoid",
            "RESET_FUNCTION"
          ],
          "line": 1814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1812
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_reset_single_function_counters(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncoid = PG_GETARG_OID(0);\n\n\tpgstat_reset_single_counter(funcoid, RESET_FUNCTION);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "pg_stat_reset_single_table_counters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1799-1807",
    "snippet": "Datum\npg_stat_reset_single_table_counters(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttaboid = PG_GETARG_OID(0);\n\n\tpgstat_reset_single_counter(taboid, RESET_TABLE);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 1806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_reset_single_counter",
          "args": [
            "taboid",
            "RESET_TABLE"
          ],
          "line": 1804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1802
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_reset_single_table_counters(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\ttaboid = PG_GETARG_OID(0);\n\n\tpgstat_reset_single_counter(taboid, RESET_TABLE);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "pg_stat_reset_shared",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1788-1796",
    "snippet": "Datum\npg_stat_reset_shared(PG_FUNCTION_ARGS)\n{\n\tchar\t   *target = text_to_cstring(PG_GETARG_TEXT_PP(0));\n\n\tpgstat_reset_shared_counters(target);\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 1795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_reset_shared_counters",
          "args": [
            "target"
          ],
          "line": 1793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "PG_GETARG_TEXT_PP(0)"
          ],
          "line": 1791
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 1791
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_reset_shared(PG_FUNCTION_ARGS)\n{\n\tchar\t   *target = text_to_cstring(PG_GETARG_TEXT_PP(0));\n\n\tpgstat_reset_shared_counters(target);\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "pg_stat_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1779-1785",
    "snippet": "Datum\npg_stat_reset(PG_FUNCTION_ARGS)\n{\n\tpgstat_reset_counters();\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 1784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_reset_counters",
          "args": [],
          "line": 1782
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_reset(PG_FUNCTION_ARGS)\n{\n\tpgstat_reset_counters();\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "pg_stat_clear_snapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1769-1775",
    "snippet": "Datum\npg_stat_clear_snapshot(PG_FUNCTION_ARGS)\n{\n\tpgstat_clear_snapshot();\n\n\tPG_RETURN_VOID();\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_VOID",
          "args": [],
          "line": 1774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_clear_snapshot",
          "args": [],
          "line": 1772
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_clear_snapshot(PG_FUNCTION_ARGS)\n{\n\tpgstat_clear_snapshot();\n\n\tPG_RETURN_VOID();\n}"
  },
  {
    "function_name": "pg_stat_get_snapshot_timestamp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1762-1766",
    "snippet": "Datum\npg_stat_get_snapshot_timestamp(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_TIMESTAMPTZ(pgstat_fetch_global()->stats_timestamp);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TIMESTAMPTZ",
          "args": [
            "pgstat_fetch_global()->stats_timestamp"
          ],
          "line": 1765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1765
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_snapshot_timestamp(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_TIMESTAMPTZ(pgstat_fetch_global()->stats_timestamp);\n}"
  },
  {
    "function_name": "pg_stat_get_xact_function_self_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1749-1758",
    "snippet": "Datum\npg_stat_get_xact_function_self_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_BackendFunctionEntry *funcentry;\n\n\tif ((funcentry = find_funcstat_entry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_FLOAT8(INSTR_TIME_GET_MILLISEC(funcentry->f_counts.f_self_time));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_FLOAT8",
          "args": [
            "INSTR_TIME_GET_MILLISEC(funcentry->f_counts.f_self_time)"
          ],
          "line": 1757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INSTR_TIME_GET_MILLISEC",
          "args": [
            "funcentry->f_counts.f_self_time"
          ],
          "line": 1757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_funcstat_entry",
          "args": [
            "funcid"
          ],
          "line": 1755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1752
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_function_self_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_BackendFunctionEntry *funcentry;\n\n\tif ((funcentry = find_funcstat_entry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_FLOAT8(INSTR_TIME_GET_MILLISEC(funcentry->f_counts.f_self_time));\n}"
  },
  {
    "function_name": "pg_stat_get_xact_function_total_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1738-1747",
    "snippet": "Datum\npg_stat_get_xact_function_total_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_BackendFunctionEntry *funcentry;\n\n\tif ((funcentry = find_funcstat_entry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_FLOAT8(INSTR_TIME_GET_MILLISEC(funcentry->f_counts.f_total_time));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_FLOAT8",
          "args": [
            "INSTR_TIME_GET_MILLISEC(funcentry->f_counts.f_total_time)"
          ],
          "line": 1746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INSTR_TIME_GET_MILLISEC",
          "args": [
            "funcentry->f_counts.f_total_time"
          ],
          "line": 1746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_funcstat_entry",
          "args": [
            "funcid"
          ],
          "line": 1744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1741
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_function_total_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_BackendFunctionEntry *funcentry;\n\n\tif ((funcentry = find_funcstat_entry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_FLOAT8(INSTR_TIME_GET_MILLISEC(funcentry->f_counts.f_total_time));\n}"
  },
  {
    "function_name": "pg_stat_get_xact_function_calls",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1727-1736",
    "snippet": "Datum\npg_stat_get_xact_function_calls(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_BackendFunctionEntry *funcentry;\n\n\tif ((funcentry = find_funcstat_entry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_INT64(funcentry->f_counts.f_numcalls);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "funcentry->f_counts.f_numcalls"
          ],
          "line": 1735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_funcstat_entry",
          "args": [
            "funcid"
          ],
          "line": 1733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1730
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_function_calls(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_BackendFunctionEntry *funcentry;\n\n\tif ((funcentry = find_funcstat_entry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_INT64(funcentry->f_counts.f_numcalls);\n}"
  },
  {
    "function_name": "pg_stat_get_xact_blocks_hit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1712-1725",
    "snippet": "Datum\npg_stat_get_xact_blocks_hit(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_blocks_hit);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->t_counts.t_blocks_hit"
          ],
          "line": 1722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_tabstat_entry",
          "args": [
            "relid"
          ],
          "line": 1719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1715
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_blocks_hit(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_blocks_hit);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_xact_blocks_fetched",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1697-1710",
    "snippet": "Datum\npg_stat_get_xact_blocks_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_blocks_fetched);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->t_counts.t_blocks_fetched"
          ],
          "line": 1707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_tabstat_entry",
          "args": [
            "relid"
          ],
          "line": 1704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_blocks_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_blocks_fetched);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_xact_tuples_hot_updated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1682-1695",
    "snippet": "Datum\npg_stat_get_xact_tuples_hot_updated(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_tuples_hot_updated);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->t_counts.t_tuples_hot_updated"
          ],
          "line": 1692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_tabstat_entry",
          "args": [
            "relid"
          ],
          "line": 1689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1685
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_tuples_hot_updated(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_tuples_hot_updated);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_xact_tuples_deleted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1661-1680",
    "snippet": "Datum\npg_stat_get_xact_tuples_deleted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\tPgStat_TableXactStatus *trans;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t{\n\t\tresult = tabentry->t_counts.t_tuples_deleted;\n\t\t/* live subtransactions' counts aren't in t_tuples_deleted yet */\n\t\tfor (trans = tabentry->trans; trans != NULL; trans = trans->upper)\n\t\t\tresult += trans->tuples_deleted;\n\t}\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_tabstat_entry",
          "args": [
            "relid"
          ],
          "line": 1669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1664
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_tuples_deleted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\tPgStat_TableXactStatus *trans;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t{\n\t\tresult = tabentry->t_counts.t_tuples_deleted;\n\t\t/* live subtransactions' counts aren't in t_tuples_deleted yet */\n\t\tfor (trans = tabentry->trans; trans != NULL; trans = trans->upper)\n\t\t\tresult += trans->tuples_deleted;\n\t}\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_xact_tuples_updated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1640-1659",
    "snippet": "Datum\npg_stat_get_xact_tuples_updated(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\tPgStat_TableXactStatus *trans;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t{\n\t\tresult = tabentry->t_counts.t_tuples_updated;\n\t\t/* live subtransactions' counts aren't in t_tuples_updated yet */\n\t\tfor (trans = tabentry->trans; trans != NULL; trans = trans->upper)\n\t\t\tresult += trans->tuples_updated;\n\t}\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_tabstat_entry",
          "args": [
            "relid"
          ],
          "line": 1648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1643
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_tuples_updated(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\tPgStat_TableXactStatus *trans;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t{\n\t\tresult = tabentry->t_counts.t_tuples_updated;\n\t\t/* live subtransactions' counts aren't in t_tuples_updated yet */\n\t\tfor (trans = tabentry->trans; trans != NULL; trans = trans->upper)\n\t\t\tresult += trans->tuples_updated;\n\t}\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_xact_tuples_inserted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1619-1638",
    "snippet": "Datum\npg_stat_get_xact_tuples_inserted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\tPgStat_TableXactStatus *trans;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t{\n\t\tresult = tabentry->t_counts.t_tuples_inserted;\n\t\t/* live subtransactions' counts aren't in t_tuples_inserted yet */\n\t\tfor (trans = tabentry->trans; trans != NULL; trans = trans->upper)\n\t\t\tresult += trans->tuples_inserted;\n\t}\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_tabstat_entry",
          "args": [
            "relid"
          ],
          "line": 1627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1622
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_tuples_inserted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\tPgStat_TableXactStatus *trans;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t{\n\t\tresult = tabentry->t_counts.t_tuples_inserted;\n\t\t/* live subtransactions' counts aren't in t_tuples_inserted yet */\n\t\tfor (trans = tabentry->trans; trans != NULL; trans = trans->upper)\n\t\t\tresult += trans->tuples_inserted;\n\t}\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_xact_tuples_fetched",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1604-1617",
    "snippet": "Datum\npg_stat_get_xact_tuples_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_tuples_fetched);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->t_counts.t_tuples_fetched"
          ],
          "line": 1614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_tabstat_entry",
          "args": [
            "relid"
          ],
          "line": 1611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1607
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_tuples_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_tuples_fetched);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_xact_tuples_returned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1589-1602",
    "snippet": "Datum\npg_stat_get_xact_tuples_returned(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_tuples_returned);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->t_counts.t_tuples_returned"
          ],
          "line": 1599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_tabstat_entry",
          "args": [
            "relid"
          ],
          "line": 1596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1592
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_tuples_returned(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_tuples_returned);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_xact_numscans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1574-1587",
    "snippet": "Datum\npg_stat_get_xact_numscans(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_numscans);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->t_counts.t_numscans"
          ],
          "line": 1584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_tabstat_entry",
          "args": [
            "relid"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_xact_numscans(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_TableStatus *tabentry;\n\n\tif ((tabentry = find_tabstat_entry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->t_counts.t_numscans);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_buf_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1568-1572",
    "snippet": "Datum\npg_stat_get_buf_alloc(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->buf_alloc);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "pgstat_fetch_global()->buf_alloc"
          ],
          "line": 1571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1571
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_buf_alloc(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->buf_alloc);\n}"
  },
  {
    "function_name": "pg_stat_get_buf_fsync_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1562-1566",
    "snippet": "Datum\npg_stat_get_buf_fsync_backend(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->buf_fsync_backend);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "pgstat_fetch_global()->buf_fsync_backend"
          ],
          "line": 1565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1565
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_buf_fsync_backend(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->buf_fsync_backend);\n}"
  },
  {
    "function_name": "pg_stat_get_buf_written_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1556-1560",
    "snippet": "Datum\npg_stat_get_buf_written_backend(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->buf_written_backend);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "pgstat_fetch_global()->buf_written_backend"
          ],
          "line": 1559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1559
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_buf_written_backend(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->buf_written_backend);\n}"
  },
  {
    "function_name": "pg_stat_get_bgwriter_stat_reset_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1550-1554",
    "snippet": "Datum\npg_stat_get_bgwriter_stat_reset_time(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_TIMESTAMPTZ(pgstat_fetch_global()->stat_reset_timestamp);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TIMESTAMPTZ",
          "args": [
            "pgstat_fetch_global()->stat_reset_timestamp"
          ],
          "line": 1553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1553
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_bgwriter_stat_reset_time(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_TIMESTAMPTZ(pgstat_fetch_global()->stat_reset_timestamp);\n}"
  },
  {
    "function_name": "pg_stat_get_checkpoint_sync_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1543-1548",
    "snippet": "Datum\npg_stat_get_checkpoint_sync_time(PG_FUNCTION_ARGS)\n{\n\t/* time is already in msec, just convert to double for presentation */\n\tPG_RETURN_FLOAT8((double) pgstat_fetch_global()->checkpoint_sync_time);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_FLOAT8",
          "args": [
            "(double) pgstat_fetch_global()->checkpoint_sync_time"
          ],
          "line": 1547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1547
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_checkpoint_sync_time(PG_FUNCTION_ARGS)\n{\n\t/* time is already in msec, just convert to double for presentation */\n\tPG_RETURN_FLOAT8((double) pgstat_fetch_global()->checkpoint_sync_time);\n}"
  },
  {
    "function_name": "pg_stat_get_checkpoint_write_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1536-1541",
    "snippet": "Datum\npg_stat_get_checkpoint_write_time(PG_FUNCTION_ARGS)\n{\n\t/* time is already in msec, just convert to double for presentation */\n\tPG_RETURN_FLOAT8((double) pgstat_fetch_global()->checkpoint_write_time);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_FLOAT8",
          "args": [
            "(double) pgstat_fetch_global()->checkpoint_write_time"
          ],
          "line": 1540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1540
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_checkpoint_write_time(PG_FUNCTION_ARGS)\n{\n\t/* time is already in msec, just convert to double for presentation */\n\tPG_RETURN_FLOAT8((double) pgstat_fetch_global()->checkpoint_write_time);\n}"
  },
  {
    "function_name": "pg_stat_get_bgwriter_maxwritten_clean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1530-1534",
    "snippet": "Datum\npg_stat_get_bgwriter_maxwritten_clean(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->maxwritten_clean);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "pgstat_fetch_global()->maxwritten_clean"
          ],
          "line": 1533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1533
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_bgwriter_maxwritten_clean(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->maxwritten_clean);\n}"
  },
  {
    "function_name": "pg_stat_get_bgwriter_buf_written_clean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1524-1528",
    "snippet": "Datum\npg_stat_get_bgwriter_buf_written_clean(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->buf_written_clean);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "pgstat_fetch_global()->buf_written_clean"
          ],
          "line": 1527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1527
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_bgwriter_buf_written_clean(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->buf_written_clean);\n}"
  },
  {
    "function_name": "pg_stat_get_bgwriter_buf_written_checkpoints",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1518-1522",
    "snippet": "Datum\npg_stat_get_bgwriter_buf_written_checkpoints(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->buf_written_checkpoints);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "pgstat_fetch_global()->buf_written_checkpoints"
          ],
          "line": 1521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1521
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_bgwriter_buf_written_checkpoints(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->buf_written_checkpoints);\n}"
  },
  {
    "function_name": "pg_stat_get_bgwriter_requested_checkpoints",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1512-1516",
    "snippet": "Datum\npg_stat_get_bgwriter_requested_checkpoints(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->requested_checkpoints);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "pgstat_fetch_global()->requested_checkpoints"
          ],
          "line": 1515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1515
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_bgwriter_requested_checkpoints(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->requested_checkpoints);\n}"
  },
  {
    "function_name": "pg_stat_get_bgwriter_timed_checkpoints",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1506-1510",
    "snippet": "Datum\npg_stat_get_bgwriter_timed_checkpoints(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->timed_checkpoints);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "pgstat_fetch_global()->timed_checkpoints"
          ],
          "line": 1509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_global",
          "args": [],
          "line": 1509
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_bgwriter_timed_checkpoints(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT64(pgstat_fetch_global()->timed_checkpoints);\n}"
  },
  {
    "function_name": "pg_stat_get_db_blk_write_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1490-1504",
    "snippet": "Datum\npg_stat_get_db_blk_write_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tdouble\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\t/* convert counter from microsec to millisec for display */\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = ((double) dbentry->n_block_write_time) / 1000.0;\n\n\tPG_RETURN_FLOAT8(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_FLOAT8",
          "args": [
            "result"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1493
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_blk_write_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tdouble\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\t/* convert counter from microsec to millisec for display */\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = ((double) dbentry->n_block_write_time) / 1000.0;\n\n\tPG_RETURN_FLOAT8(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_blk_read_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1474-1488",
    "snippet": "Datum\npg_stat_get_db_blk_read_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tdouble\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\t/* convert counter from microsec to millisec for display */\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = ((double) dbentry->n_block_read_time) / 1000.0;\n\n\tPG_RETURN_FLOAT8(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_FLOAT8",
          "args": [
            "result"
          ],
          "line": 1487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1477
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_blk_read_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tdouble\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\t/* convert counter from microsec to millisec for display */\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = ((double) dbentry->n_block_read_time) / 1000.0;\n\n\tPG_RETURN_FLOAT8(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_deadlocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1459-1472",
    "snippet": "Datum\npg_stat_get_db_deadlocks(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_deadlocks);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_deadlocks"
          ],
          "line": 1469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1462
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_deadlocks(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_deadlocks);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_conflict_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1439-1457",
    "snippet": "Datum\npg_stat_get_db_conflict_all(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (\n\t\t\t\t\t\t  dbentry->n_conflict_tablespace +\n\t\t\t\t\t\t  dbentry->n_conflict_lock +\n\t\t\t\t\t\t  dbentry->n_conflict_snapshot +\n\t\t\t\t\t\t  dbentry->n_conflict_bufferpin +\n\t\t\t\t\t\t  dbentry->n_conflict_startup_deadlock);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_conflict_tablespace +\n\t\t\t\t\t\t  dbentry->n_conflict_lock +\n\t\t\t\t\t\t  dbentry->n_conflict_snapshot +\n\t\t\t\t\t\t  dbentry->n_conflict_bufferpin +\n\t\t\t\t\t\t  dbentry->n_conflict_startup_deadlock"
          ],
          "line": 1449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1442
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_conflict_all(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (\n\t\t\t\t\t\t  dbentry->n_conflict_tablespace +\n\t\t\t\t\t\t  dbentry->n_conflict_lock +\n\t\t\t\t\t\t  dbentry->n_conflict_snapshot +\n\t\t\t\t\t\t  dbentry->n_conflict_bufferpin +\n\t\t\t\t\t\t  dbentry->n_conflict_startup_deadlock);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_conflict_startup_deadlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1424-1437",
    "snippet": "Datum\npg_stat_get_db_conflict_startup_deadlock(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_conflict_startup_deadlock);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_conflict_startup_deadlock"
          ],
          "line": 1434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1427
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_conflict_startup_deadlock(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_conflict_startup_deadlock);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_conflict_bufferpin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1409-1422",
    "snippet": "Datum\npg_stat_get_db_conflict_bufferpin(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_conflict_bufferpin);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_conflict_bufferpin"
          ],
          "line": 1419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1412
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_conflict_bufferpin(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_conflict_bufferpin);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_conflict_snapshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1394-1407",
    "snippet": "Datum\npg_stat_get_db_conflict_snapshot(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_conflict_snapshot);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_conflict_snapshot"
          ],
          "line": 1404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1397
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_conflict_snapshot(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_conflict_snapshot);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_conflict_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1379-1392",
    "snippet": "Datum\npg_stat_get_db_conflict_lock(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_conflict_lock);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_conflict_lock"
          ],
          "line": 1389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1382
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_conflict_lock(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_conflict_lock);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_conflict_tablespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1364-1377",
    "snippet": "Datum\npg_stat_get_db_conflict_tablespace(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_conflict_tablespace);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_conflict_tablespace"
          ],
          "line": 1374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1367
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_conflict_tablespace(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_conflict_tablespace);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_temp_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1349-1362",
    "snippet": "Datum\npg_stat_get_db_temp_bytes(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = dbentry->n_temp_bytes;\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_temp_bytes(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = dbentry->n_temp_bytes;\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_temp_files",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1333-1346",
    "snippet": "Datum\npg_stat_get_db_temp_files(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = dbentry->n_temp_files;\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1336
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_temp_files(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = dbentry->n_temp_files;\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_stat_reset_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1315-1331",
    "snippet": "Datum\npg_stat_get_db_stat_reset_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tTimestampTz result;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = dbentry->stat_reset_timestamp;\n\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\telse\n\t\tPG_RETURN_TIMESTAMPTZ(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TIMESTAMPTZ",
          "args": [
            "result"
          ],
          "line": 1330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_stat_reset_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tTimestampTz result;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = dbentry->stat_reset_timestamp;\n\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\telse\n\t\tPG_RETURN_TIMESTAMPTZ(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_tuples_deleted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1300-1313",
    "snippet": "Datum\npg_stat_get_db_tuples_deleted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_tuples_deleted);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_tuples_deleted"
          ],
          "line": 1310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_tuples_deleted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_tuples_deleted);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_tuples_updated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1284-1297",
    "snippet": "Datum\npg_stat_get_db_tuples_updated(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_tuples_updated);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_tuples_updated"
          ],
          "line": 1294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1287
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_tuples_updated(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_tuples_updated);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_tuples_inserted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1268-1281",
    "snippet": "Datum\npg_stat_get_db_tuples_inserted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_tuples_inserted);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_tuples_inserted"
          ],
          "line": 1278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_tuples_inserted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_tuples_inserted);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_tuples_fetched",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1252-1265",
    "snippet": "Datum\npg_stat_get_db_tuples_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_tuples_fetched);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_tuples_fetched"
          ],
          "line": 1262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_tuples_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_tuples_fetched);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_tuples_returned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1236-1249",
    "snippet": "Datum\npg_stat_get_db_tuples_returned(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_tuples_returned);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_tuples_returned"
          ],
          "line": 1246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_tuples_returned(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_tuples_returned);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_blocks_hit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1220-1233",
    "snippet": "Datum\npg_stat_get_db_blocks_hit(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_blocks_hit);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_blocks_hit"
          ],
          "line": 1230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_blocks_hit(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_blocks_hit);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_blocks_fetched",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1204-1217",
    "snippet": "Datum\npg_stat_get_db_blocks_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_blocks_fetched);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_blocks_fetched"
          ],
          "line": 1214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_blocks_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_blocks_fetched);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_xact_rollback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1188-1201",
    "snippet": "Datum\npg_stat_get_db_xact_rollback(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_xact_rollback);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_xact_rollback"
          ],
          "line": 1198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_xact_rollback(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_xact_rollback);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_xact_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1172-1185",
    "snippet": "Datum\npg_stat_get_db_xact_commit(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_xact_commit);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "dbentry->n_xact_commit"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_dbentry",
          "args": [
            "dbid"
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_xact_commit(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatDBEntry *dbentry;\n\n\tif ((dbentry = pgstat_fetch_stat_dbentry(dbid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (dbentry->n_xact_commit);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_db_numbackends",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1151-1169",
    "snippet": "Datum\npg_stat_get_db_numbackends(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint32\t\tresult;\n\tint\t\t\ttot_backends = pgstat_fetch_stat_numbackends();\n\tint\t\t\tbeid;\n\n\tresult = 0;\n\tfor (beid = 1; beid <= tot_backends; beid++)\n\t{\n\t\tPgBackendStatus *beentry = pgstat_fetch_stat_beentry(beid);\n\n\t\tif (beentry && beentry->st_databaseid == dbid)\n\t\t\tresult++;\n\t}\n\n\tPG_RETURN_INT32(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "result"
          ],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 1162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_numbackends",
          "args": [],
          "line": 1156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_db_numbackends(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tdbid = PG_GETARG_OID(0);\n\tint32\t\tresult;\n\tint\t\t\ttot_backends = pgstat_fetch_stat_numbackends();\n\tint\t\t\tbeid;\n\n\tresult = 0;\n\tfor (beid = 1; beid <= tot_backends; beid++)\n\t{\n\t\tPgBackendStatus *beentry = pgstat_fetch_stat_beentry(beid);\n\n\t\tif (beentry && beentry->st_databaseid == dbid)\n\t\t\tresult++;\n\t}\n\n\tPG_RETURN_INT32(result);\n}"
  },
  {
    "function_name": "pg_stat_get_backend_client_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1103-1148",
    "snippet": "Datum\npg_stat_get_backend_client_port(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\tSockAddr\tzero_clientaddr;\n\tchar\t\tremote_port[NI_MAXSERV];\n\tint\t\t\tret;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tif (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tPG_RETURN_NULL();\n\n\t/* A zeroed client addr means we don't know */\n\tmemset(&zero_clientaddr, 0, sizeof(zero_clientaddr));\n\tif (memcmp(&(beentry->st_clientaddr), &zero_clientaddr,\n\t\t\t   sizeof(zero_clientaddr)) == 0)\n\t\tPG_RETURN_NULL();\n\n\tswitch (beentry->st_clientaddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tcase AF_UNIX:\n\t\t\tPG_RETURN_INT32(-1);\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tremote_port[0] = '\\0';\n\tret = pg_getnameinfo_all(&beentry->st_clientaddr.addr,\n\t\t\t\t\t\t\t beentry->st_clientaddr.salen,\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t remote_port, sizeof(remote_port),\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_DATUM(DirectFunctionCall1(int4in,\n\t\t\t\t\t\t\t\t\t\tCStringGetDatum(remote_port)));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_DATUM",
          "args": [
            "DirectFunctionCall1(int4in,\n\t\t\t\t\t\t\t\t\t\tCStringGetDatum(remote_port))"
          ],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectFunctionCall1",
          "args": [
            "int4in",
            "CStringGetDatum(remote_port)"
          ],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "remote_port"
          ],
          "line": 1147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_getnameinfo_all",
          "args": [
            "&beentry->st_clientaddr.addr",
            "beentry->st_clientaddr.salen",
            "NULL",
            "0",
            "remote_port",
            "sizeof(remote_port)",
            "NI_NUMERICHOST | NI_NUMERICSERV"
          ],
          "line": 1138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "-1"
          ],
          "line": 1132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&(beentry->st_clientaddr)",
            "&zero_clientaddr",
            "sizeof(zero_clientaddr)"
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&zero_clientaddr",
            "0",
            "sizeof(zero_clientaddr)"
          ],
          "line": 1119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "GetUserId()",
            "beentry->st_userid"
          ],
          "line": 1115
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 1115
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_client_port(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\tSockAddr\tzero_clientaddr;\n\tchar\t\tremote_port[NI_MAXSERV];\n\tint\t\t\tret;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tif (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tPG_RETURN_NULL();\n\n\t/* A zeroed client addr means we don't know */\n\tmemset(&zero_clientaddr, 0, sizeof(zero_clientaddr));\n\tif (memcmp(&(beentry->st_clientaddr), &zero_clientaddr,\n\t\t\t   sizeof(zero_clientaddr)) == 0)\n\t\tPG_RETURN_NULL();\n\n\tswitch (beentry->st_clientaddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tcase AF_UNIX:\n\t\t\tPG_RETURN_INT32(-1);\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tremote_port[0] = '\\0';\n\tret = pg_getnameinfo_all(&beentry->st_clientaddr.addr,\n\t\t\t\t\t\t\t beentry->st_clientaddr.salen,\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t remote_port, sizeof(remote_port),\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_DATUM(DirectFunctionCall1(int4in,\n\t\t\t\t\t\t\t\t\t\tCStringGetDatum(remote_port)));\n}"
  },
  {
    "function_name": "pg_stat_get_backend_client_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1056-1101",
    "snippet": "Datum\npg_stat_get_backend_client_addr(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\tSockAddr\tzero_clientaddr;\n\tchar\t\tremote_host[NI_MAXHOST];\n\tint\t\t\tret;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tif (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tPG_RETURN_NULL();\n\n\t/* A zeroed client addr means we don't know */\n\tmemset(&zero_clientaddr, 0, sizeof(zero_clientaddr));\n\tif (memcmp(&(beentry->st_clientaddr), &zero_clientaddr,\n\t\t\t   sizeof(zero_clientaddr)) == 0)\n\t\tPG_RETURN_NULL();\n\n\tswitch (beentry->st_clientaddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tremote_host[0] = '\\0';\n\tret = pg_getnameinfo_all(&beentry->st_clientaddr.addr,\n\t\t\t\t\t\t\t beentry->st_clientaddr.salen,\n\t\t\t\t\t\t\t remote_host, sizeof(remote_host),\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tclean_ipv6_addr(beentry->st_clientaddr.addr.ss_family, remote_host);\n\n\tPG_RETURN_INET_P(DirectFunctionCall1(inet_in,\n\t\t\t\t\t\t\t\t\t\t CStringGetDatum(remote_host)));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INET_P",
          "args": [
            "DirectFunctionCall1(inet_in,\n\t\t\t\t\t\t\t\t\t\t CStringGetDatum(remote_host))"
          ],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectFunctionCall1",
          "args": [
            "inet_in",
            "CStringGetDatum(remote_host)"
          ],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "remote_host"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clean_ipv6_addr",
          "args": [
            "beentry->st_clientaddr.addr.ss_family",
            "remote_host"
          ],
          "line": 1097
        },
        "resolved": true,
        "details": {
          "function_name": "clean_ipv6_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "1510-1522",
          "snippet": "void\nclean_ipv6_addr(int addr_family, char *addr)\n{\n#ifdef HAVE_IPV6\n\tif (addr_family == AF_INET6)\n\t{\n\t\tchar\t   *pct = strchr(addr, '%');\n\n\t\tif (pct)\n\t\t\t*pct = '\\0';\n\t}\n#endif\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nvoid\nclean_ipv6_addr(int addr_family, char *addr)\n{\n#ifdef HAVE_IPV6\n\tif (addr_family == AF_INET6)\n\t{\n\t\tchar\t   *pct = strchr(addr, '%');\n\n\t\tif (pct)\n\t\t\t*pct = '\\0';\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg_getnameinfo_all",
          "args": [
            "&beentry->st_clientaddr.addr",
            "beentry->st_clientaddr.salen",
            "remote_host",
            "sizeof(remote_host)",
            "NULL",
            "0",
            "NI_NUMERICHOST | NI_NUMERICSERV"
          ],
          "line": 1089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1075
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&(beentry->st_clientaddr)",
            "&zero_clientaddr",
            "sizeof(zero_clientaddr)"
          ],
          "line": 1073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&zero_clientaddr",
            "0",
            "sizeof(zero_clientaddr)"
          ],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "GetUserId()",
            "beentry->st_userid"
          ],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_client_addr(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\tSockAddr\tzero_clientaddr;\n\tchar\t\tremote_host[NI_MAXHOST];\n\tint\t\t\tret;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tif (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tPG_RETURN_NULL();\n\n\t/* A zeroed client addr means we don't know */\n\tmemset(&zero_clientaddr, 0, sizeof(zero_clientaddr));\n\tif (memcmp(&(beentry->st_clientaddr), &zero_clientaddr,\n\t\t\t   sizeof(zero_clientaddr)) == 0)\n\t\tPG_RETURN_NULL();\n\n\tswitch (beentry->st_clientaddr.addr.ss_family)\n\t{\n\t\tcase AF_INET:\n#ifdef HAVE_IPV6\n\t\tcase AF_INET6:\n#endif\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tPG_RETURN_NULL();\n\t}\n\n\tremote_host[0] = '\\0';\n\tret = pg_getnameinfo_all(&beentry->st_clientaddr.addr,\n\t\t\t\t\t\t\t beentry->st_clientaddr.salen,\n\t\t\t\t\t\t\t remote_host, sizeof(remote_host),\n\t\t\t\t\t\t\t NULL, 0,\n\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\tif (ret != 0)\n\t\tPG_RETURN_NULL();\n\n\tclean_ipv6_addr(beentry->st_clientaddr.addr.ss_family, remote_host);\n\n\tPG_RETURN_INET_P(DirectFunctionCall1(inet_in,\n\t\t\t\t\t\t\t\t\t\t CStringGetDatum(remote_host)));\n}"
  },
  {
    "function_name": "pg_stat_get_backend_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1034-1053",
    "snippet": "Datum\npg_stat_get_backend_start(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tTimestampTz result;\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tif (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tPG_RETURN_NULL();\n\n\tresult = beentry->st_proc_start_timestamp;\n\n\tif (result == 0)\t\t\t/* probably can't happen? */\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_TIMESTAMPTZ(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TIMESTAMPTZ",
          "args": [
            "result"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "GetUserId()",
            "beentry->st_userid"
          ],
          "line": 1044
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 1044
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_start(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tTimestampTz result;\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tif (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tPG_RETURN_NULL();\n\n\tresult = beentry->st_proc_start_timestamp;\n\n\tif (result == 0)\t\t\t/* probably can't happen? */\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_TIMESTAMPTZ(result);\n}"
  },
  {
    "function_name": "pg_stat_get_backend_xact_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "1012-1031",
    "snippet": "Datum\npg_stat_get_backend_xact_start(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tTimestampTz result;\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tif (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tPG_RETURN_NULL();\n\n\tresult = beentry->st_xact_start_timestamp;\n\n\tif (result == 0)\t\t\t/* not in a transaction */\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_TIMESTAMPTZ(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TIMESTAMPTZ",
          "args": [
            "result"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "GetUserId()",
            "beentry->st_userid"
          ],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 1015
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_xact_start(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tTimestampTz result;\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tif (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tPG_RETURN_NULL();\n\n\tresult = beentry->st_xact_start_timestamp;\n\n\tif (result == 0)\t\t\t/* not in a transaction */\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_TIMESTAMPTZ(result);\n}"
  },
  {
    "function_name": "pg_stat_get_backend_activity_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "986-1009",
    "snippet": "Datum\npg_stat_get_backend_activity_start(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tTimestampTz result;\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tif (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tPG_RETURN_NULL();\n\n\tresult = beentry->st_activity_start_timestamp;\n\n\t/*\n\t * No time recorded for start of current query -- this is the case if the\n\t * user hasn't enabled query-level stats collection.\n\t */\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_TIMESTAMPTZ(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TIMESTAMPTZ",
          "args": [
            "result"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "GetUserId()",
            "beentry->st_userid"
          ],
          "line": 996
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 996
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_activity_start(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tTimestampTz result;\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tif (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tPG_RETURN_NULL();\n\n\tresult = beentry->st_activity_start_timestamp;\n\n\t/*\n\t * No time recorded for start of current query -- this is the case if the\n\t * user hasn't enabled query-level stats collection.\n\t */\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_TIMESTAMPTZ(result);\n}"
  },
  {
    "function_name": "pg_stat_get_backend_wait_event",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "964-983",
    "snippet": "Datum\npg_stat_get_backend_wait_event(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\tPGPROC\t   *proc;\n\tconst char *wait_event = NULL;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\twait_event = \"<backend information not available>\";\n\telse if (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\twait_event = \"<insufficient privilege>\";\n\telse if ((proc = BackendPidGetProc(beentry->st_procpid)) != NULL)\n\t\twait_event = pgstat_get_wait_event(proc->wait_event_info);\n\n\tif (!wait_event)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_TEXT_P(cstring_to_text(wait_event));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "cstring_to_text(wait_event)"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cstring_to_text",
          "args": [
            "wait_event"
          ],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "cstring_to_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "148-152",
          "snippet": "text *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\ntext *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_get_wait_event",
          "args": [
            "proc->wait_event_info"
          ],
          "line": 977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BackendPidGetProc",
          "args": [
            "beentry->st_procpid"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "GetUserId()",
            "beentry->st_userid"
          ],
          "line": 974
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 974
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_wait_event(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\tPGPROC\t   *proc;\n\tconst char *wait_event = NULL;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\twait_event = \"<backend information not available>\";\n\telse if (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\twait_event = \"<insufficient privilege>\";\n\telse if ((proc = BackendPidGetProc(beentry->st_procpid)) != NULL)\n\t\twait_event = pgstat_get_wait_event(proc->wait_event_info);\n\n\tif (!wait_event)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_TEXT_P(cstring_to_text(wait_event));\n}"
  },
  {
    "function_name": "pg_stat_get_backend_wait_event_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "943-962",
    "snippet": "Datum\npg_stat_get_backend_wait_event_type(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\tPGPROC\t   *proc;\n\tconst char *wait_event_type = NULL;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\twait_event_type = \"<backend information not available>\";\n\telse if (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\twait_event_type = \"<insufficient privilege>\";\n\telse if ((proc = BackendPidGetProc(beentry->st_procpid)) != NULL)\n\t\twait_event_type = pgstat_get_wait_event_type(proc->wait_event_info);\n\n\tif (!wait_event_type)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_TEXT_P(cstring_to_text(wait_event_type));\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "cstring_to_text(wait_event_type)"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cstring_to_text",
          "args": [
            "wait_event_type"
          ],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "cstring_to_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "148-152",
          "snippet": "text *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\ntext *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_get_wait_event_type",
          "args": [
            "proc->wait_event_info"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BackendPidGetProc",
          "args": [
            "beentry->st_procpid"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "GetUserId()",
            "beentry->st_userid"
          ],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_wait_event_type(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\tPGPROC\t   *proc;\n\tconst char *wait_event_type = NULL;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\twait_event_type = \"<backend information not available>\";\n\telse if (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\twait_event_type = \"<insufficient privilege>\";\n\telse if ((proc = BackendPidGetProc(beentry->st_procpid)) != NULL)\n\t\twait_event_type = pgstat_get_wait_event_type(proc->wait_event_info);\n\n\tif (!wait_event_type)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_TEXT_P(cstring_to_text(wait_event_type));\n}"
  },
  {
    "function_name": "pg_stat_get_backend_activity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "918-941",
    "snippet": "Datum\npg_stat_get_backend_activity(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\tconst char *activity;\n\tchar\t   *clipped_activity;\n\ttext\t   *ret;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tactivity = \"<backend information not available>\";\n\telse if (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tactivity = \"<insufficient privilege>\";\n\telse if (*(beentry->st_activity_raw) == '\\0')\n\t\tactivity = \"<command string not enabled>\";\n\telse\n\t\tactivity = beentry->st_activity_raw;\n\n\tclipped_activity = pgstat_clip_activity(activity);\n\tret = cstring_to_text(activity);\n\tpfree(clipped_activity);\n\n\tPG_RETURN_TEXT_P(ret);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TEXT_P",
          "args": [
            "ret"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfree",
          "args": [
            "clipped_activity"
          ],
          "line": 938
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1649-1655",
          "snippet": "static void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cstring_to_text",
          "args": [
            "activity"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "cstring_to_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "148-152",
          "snippet": "text *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\ntext *\ncstring_to_text(const char *s)\n{\n\treturn cstring_to_text_with_len(s, strlen(s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pgstat_clip_activity",
          "args": [
            "activity"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "GetUserId()",
            "beentry->st_userid"
          ],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_activity(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\tconst char *activity;\n\tchar\t   *clipped_activity;\n\ttext\t   *ret;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tactivity = \"<backend information not available>\";\n\telse if (!has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\tactivity = \"<insufficient privilege>\";\n\telse if (*(beentry->st_activity_raw) == '\\0')\n\t\tactivity = \"<command string not enabled>\";\n\telse\n\t\tactivity = beentry->st_activity_raw;\n\n\tclipped_activity = pgstat_clip_activity(activity);\n\tret = cstring_to_text(activity);\n\tpfree(clipped_activity);\n\n\tPG_RETURN_TEXT_P(ret);\n}"
  },
  {
    "function_name": "pg_stat_get_backend_userid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "905-915",
    "snippet": "Datum\npg_stat_get_backend_userid(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_OID(beentry->st_userid);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_OID",
          "args": [
            "beentry->st_userid"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_userid(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_OID(beentry->st_userid);\n}"
  },
  {
    "function_name": "pg_stat_get_backend_dbid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "892-902",
    "snippet": "Datum\npg_stat_get_backend_dbid(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_OID(beentry->st_databaseid);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_OID",
          "args": [
            "beentry->st_databaseid"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_dbid(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_OID(beentry->st_databaseid);\n}"
  },
  {
    "function_name": "pg_stat_get_backend_pid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "879-889",
    "snippet": "Datum\npg_stat_get_backend_pid(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_INT32(beentry->st_procpid);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "beentry->st_procpid"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_beentry",
          "args": [
            "beid"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_pid(PG_FUNCTION_ARGS)\n{\n\tint32\t\tbeid = PG_GETARG_INT32(0);\n\tPgBackendStatus *beentry;\n\n\tif ((beentry = pgstat_fetch_stat_beentry(beid)) == NULL)\n\t\tPG_RETURN_NULL();\n\n\tPG_RETURN_INT32(beentry->st_procpid);\n}"
  },
  {
    "function_name": "pg_backend_pid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "872-876",
    "snippet": "Datum\npg_backend_pid(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT32(MyProcPid);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT32",
          "args": [
            "MyProcPid"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_backend_pid(PG_FUNCTION_ARGS)\n{\n\tPG_RETURN_INT32(MyProcPid);\n}"
  },
  {
    "function_name": "pg_stat_get_activity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "541-869",
    "snippet": "Datum\npg_stat_get_activity(PG_FUNCTION_ARGS)\n{\n#define PG_STAT_GET_ACTIVITY_COLS\t24\n\tint\t\t\tnum_backends = pgstat_fetch_stat_numbackends();\n\tint\t\t\tcurr_backend;\n\tint\t\t\tpid = PG_ARGISNULL(0) ? -1 : PG_GETARG_INT32(0);\n\tReturnSetInfo *rsinfo = (ReturnSetInfo *) fcinfo->resultinfo;\n\tTupleDesc\ttupdesc;\n\tTuplestorestate *tupstore;\n\tMemoryContext per_query_ctx;\n\tMemoryContext oldcontext;\n\n\t/* check to see if caller supports us returning a tuplestore */\n\tif (rsinfo == NULL || !IsA(rsinfo, ReturnSetInfo))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"set-valued function called in context that cannot accept a set\")));\n\tif (!(rsinfo->allowedModes & SFRM_Materialize))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"materialize mode required, but it is not \" \\\n\t\t\t\t\t\t\"allowed in this context\")));\n\n\t/* Build a tuple descriptor for our result type */\n\tif (get_call_result_type(fcinfo, NULL, &tupdesc) != TYPEFUNC_COMPOSITE)\n\t\telog(ERROR, \"return type must be a row type\");\n\n\tper_query_ctx = rsinfo->econtext->ecxt_per_query_memory;\n\toldcontext = MemoryContextSwitchTo(per_query_ctx);\n\n\ttupstore = tuplestore_begin_heap(true, false, work_mem);\n\trsinfo->returnMode = SFRM_Materialize;\n\trsinfo->setResult = tupstore;\n\trsinfo->setDesc = tupdesc;\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\t/* 1-based index */\n\tfor (curr_backend = 1; curr_backend <= num_backends; curr_backend++)\n\t{\n\t\t/* for each row */\n\t\tDatum\t\tvalues[PG_STAT_GET_ACTIVITY_COLS];\n\t\tbool\t\tnulls[PG_STAT_GET_ACTIVITY_COLS];\n\t\tLocalPgBackendStatus *local_beentry;\n\t\tPgBackendStatus *beentry;\n\t\tPGPROC\t   *proc;\n\t\tconst char *wait_event_type = NULL;\n\t\tconst char *wait_event = NULL;\n\n\t\tMemSet(values, 0, sizeof(values));\n\t\tMemSet(nulls, 0, sizeof(nulls));\n\n\t\t/* Get the next one in the list */\n\t\tlocal_beentry = pgstat_fetch_stat_local_beentry(curr_backend);\n\t\tif (!local_beentry)\n\t\t{\n\t\t\tint\t\t\ti;\n\n\t\t\t/* Ignore missing entries if looking for specific PID */\n\t\t\tif (pid != -1)\n\t\t\t\tcontinue;\n\n\t\t\tfor (i = 0; i < lengthof(nulls); i++)\n\t\t\t\tnulls[i] = true;\n\n\t\t\tnulls[5] = false;\n\t\t\tvalues[5] = CStringGetTextDatum(\"<backend information not available>\");\n\n\t\t\ttuplestore_putvalues(tupstore, tupdesc, values, nulls);\n\t\t\tcontinue;\n\t\t}\n\n\t\tbeentry = &local_beentry->backendStatus;\n\n\t\t/* If looking for specific PID, ignore all the others */\n\t\tif (pid != -1 && beentry->st_procpid != pid)\n\t\t\tcontinue;\n\n\t\t/* Values available to all callers */\n\t\tif (beentry->st_databaseid != InvalidOid)\n\t\t\tvalues[0] = ObjectIdGetDatum(beentry->st_databaseid);\n\t\telse\n\t\t\tnulls[0] = true;\n\n\t\tvalues[1] = Int32GetDatum(beentry->st_procpid);\n\n\t\tif (beentry->st_userid != InvalidOid)\n\t\t\tvalues[2] = ObjectIdGetDatum(beentry->st_userid);\n\t\telse\n\t\t\tnulls[2] = true;\n\n\t\tif (beentry->st_appname)\n\t\t\tvalues[3] = CStringGetTextDatum(beentry->st_appname);\n\t\telse\n\t\t\tnulls[3] = true;\n\n\t\tif (TransactionIdIsValid(local_beentry->backend_xid))\n\t\t\tvalues[15] = TransactionIdGetDatum(local_beentry->backend_xid);\n\t\telse\n\t\t\tnulls[15] = true;\n\n\t\tif (TransactionIdIsValid(local_beentry->backend_xmin))\n\t\t\tvalues[16] = TransactionIdGetDatum(local_beentry->backend_xmin);\n\t\telse\n\t\t\tnulls[16] = true;\n\n\t\tif (beentry->st_ssl)\n\t\t{\n\t\t\tvalues[18] = BoolGetDatum(true);\t/* ssl */\n\t\t\tvalues[19] = CStringGetTextDatum(beentry->st_sslstatus->ssl_version);\n\t\t\tvalues[20] = CStringGetTextDatum(beentry->st_sslstatus->ssl_cipher);\n\t\t\tvalues[21] = Int32GetDatum(beentry->st_sslstatus->ssl_bits);\n\t\t\tvalues[22] = BoolGetDatum(beentry->st_sslstatus->ssl_compression);\n\t\t\tvalues[23] = CStringGetTextDatum(beentry->st_sslstatus->ssl_clientdn);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvalues[18] = BoolGetDatum(false);\t/* ssl */\n\t\t\tnulls[19] = nulls[20] = nulls[21] = nulls[22] = nulls[23] = true;\n\t\t}\n\n\t\t/* Values only available to role member or pg_read_all_stats */\n\t\tif (has_privs_of_role(GetUserId(), beentry->st_userid) ||\n\t\t\tis_member_of_role(GetUserId(), DEFAULT_ROLE_READ_ALL_STATS))\n\t\t{\n\t\t\tSockAddr\tzero_clientaddr;\n\t\t\tchar\t   *clipped_activity;\n\n\t\t\tswitch (beentry->st_state)\n\t\t\t{\n\t\t\t\tcase STATE_IDLE:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"idle\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_RUNNING:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"active\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_IDLEINTRANSACTION:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"idle in transaction\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_FASTPATH:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"fastpath function call\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_IDLEINTRANSACTION_ABORTED:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"idle in transaction (aborted)\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_DISABLED:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"disabled\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_UNDEFINED:\n\t\t\t\t\tnulls[4] = true;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tclipped_activity = pgstat_clip_activity(beentry->st_activity_raw);\n\t\t\tvalues[5] = CStringGetTextDatum(clipped_activity);\n\t\t\tpfree(clipped_activity);\n\n\t\t\tproc = BackendPidGetProc(beentry->st_procpid);\n\t\t\tif (proc != NULL)\n\t\t\t{\n\t\t\t\tuint32\t\traw_wait_event;\n\n\t\t\t\traw_wait_event = UINT32_ACCESS_ONCE(proc->wait_event_info);\n\t\t\t\twait_event_type = pgstat_get_wait_event_type(raw_wait_event);\n\t\t\t\twait_event = pgstat_get_wait_event(raw_wait_event);\n\n\t\t\t}\n\t\t\telse if (beentry->st_backendType != B_BACKEND)\n\t\t\t{\n\t\t\t\t/*\n\t\t\t\t * For an auxiliary process, retrieve process info from\n\t\t\t\t * AuxiliaryProcs stored in shared-memory.\n\t\t\t\t */\n\t\t\t\tproc = AuxiliaryPidGetProc(beentry->st_procpid);\n\n\t\t\t\tif (proc != NULL)\n\t\t\t\t{\n\t\t\t\t\tuint32\t\traw_wait_event;\n\n\t\t\t\t\traw_wait_event =\n\t\t\t\t\t\tUINT32_ACCESS_ONCE(proc->wait_event_info);\n\t\t\t\t\twait_event_type =\n\t\t\t\t\t\tpgstat_get_wait_event_type(raw_wait_event);\n\t\t\t\t\twait_event = pgstat_get_wait_event(raw_wait_event);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (wait_event_type)\n\t\t\t\tvalues[6] = CStringGetTextDatum(wait_event_type);\n\t\t\telse\n\t\t\t\tnulls[6] = true;\n\n\t\t\tif (wait_event)\n\t\t\t\tvalues[7] = CStringGetTextDatum(wait_event);\n\t\t\telse\n\t\t\t\tnulls[7] = true;\n\n\t\t\tif (beentry->st_xact_start_timestamp != 0)\n\t\t\t\tvalues[8] = TimestampTzGetDatum(beentry->st_xact_start_timestamp);\n\t\t\telse\n\t\t\t\tnulls[8] = true;\n\n\t\t\tif (beentry->st_activity_start_timestamp != 0)\n\t\t\t\tvalues[9] = TimestampTzGetDatum(beentry->st_activity_start_timestamp);\n\t\t\telse\n\t\t\t\tnulls[9] = true;\n\n\t\t\tif (beentry->st_proc_start_timestamp != 0)\n\t\t\t\tvalues[10] = TimestampTzGetDatum(beentry->st_proc_start_timestamp);\n\t\t\telse\n\t\t\t\tnulls[10] = true;\n\n\t\t\tif (beentry->st_state_start_timestamp != 0)\n\t\t\t\tvalues[11] = TimestampTzGetDatum(beentry->st_state_start_timestamp);\n\t\t\telse\n\t\t\t\tnulls[11] = true;\n\n\t\t\t/* A zeroed client addr means we don't know */\n\t\t\tmemset(&zero_clientaddr, 0, sizeof(zero_clientaddr));\n\t\t\tif (memcmp(&(beentry->st_clientaddr), &zero_clientaddr,\n\t\t\t\t\t   sizeof(zero_clientaddr)) == 0)\n\t\t\t{\n\t\t\t\tnulls[12] = true;\n\t\t\t\tnulls[13] = true;\n\t\t\t\tnulls[14] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (beentry->st_clientaddr.addr.ss_family == AF_INET\n#ifdef HAVE_IPV6\n\t\t\t\t\t|| beentry->st_clientaddr.addr.ss_family == AF_INET6\n#endif\n\t\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tchar\t\tremote_host[NI_MAXHOST];\n\t\t\t\t\tchar\t\tremote_port[NI_MAXSERV];\n\t\t\t\t\tint\t\t\tret;\n\n\t\t\t\t\tremote_host[0] = '\\0';\n\t\t\t\t\tremote_port[0] = '\\0';\n\t\t\t\t\tret = pg_getnameinfo_all(&beentry->st_clientaddr.addr,\n\t\t\t\t\t\t\t\t\t\t\t beentry->st_clientaddr.salen,\n\t\t\t\t\t\t\t\t\t\t\t remote_host, sizeof(remote_host),\n\t\t\t\t\t\t\t\t\t\t\t remote_port, sizeof(remote_port),\n\t\t\t\t\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\t\t\t\t\tif (ret == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tclean_ipv6_addr(beentry->st_clientaddr.addr.ss_family, remote_host);\n\t\t\t\t\t\tvalues[12] = DirectFunctionCall1(inet_in,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t CStringGetDatum(remote_host));\n\t\t\t\t\t\tif (beentry->st_clienthostname &&\n\t\t\t\t\t\t\tbeentry->st_clienthostname[0])\n\t\t\t\t\t\t\tvalues[13] = CStringGetTextDatum(beentry->st_clienthostname);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tnulls[13] = true;\n\t\t\t\t\t\tvalues[14] = Int32GetDatum(atoi(remote_port));\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnulls[12] = true;\n\t\t\t\t\t\tnulls[13] = true;\n\t\t\t\t\t\tnulls[14] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (beentry->st_clientaddr.addr.ss_family == AF_UNIX)\n\t\t\t\t{\n\t\t\t\t\t/*\n\t\t\t\t\t * Unix sockets always reports NULL for host and -1 for\n\t\t\t\t\t * port, so it's possible to tell the difference to\n\t\t\t\t\t * connections we have no permissions to view, or with\n\t\t\t\t\t * errors.\n\t\t\t\t\t */\n\t\t\t\t\tnulls[12] = true;\n\t\t\t\t\tnulls[13] = true;\n\t\t\t\t\tvalues[14] = Int32GetDatum(-1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t/* Unknown address type, should never happen */\n\t\t\t\t\tnulls[12] = true;\n\t\t\t\t\tnulls[13] = true;\n\t\t\t\t\tnulls[14] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t/* Add backend type */\n\t\t\tif (beentry->st_backendType == B_BG_WORKER)\n\t\t\t{\n\t\t\t\tconst char *bgw_type;\n\n\t\t\t\tbgw_type = GetBackgroundWorkerTypeByPid(beentry->st_procpid);\n\t\t\t\tif (bgw_type)\n\t\t\t\t\tvalues[17] = CStringGetTextDatum(bgw_type);\n\t\t\t\telse\n\t\t\t\t\tnulls[17] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalues[17] =\n\t\t\t\t\tCStringGetTextDatum(pgstat_get_backend_desc(beentry->st_backendType));\n\t\t}\n\t\telse\n\t\t{\n\t\t\t/* No permissions to view data about this session */\n\t\t\tvalues[5] = CStringGetTextDatum(\"<insufficient privilege>\");\n\t\t\tnulls[4] = true;\n\t\t\tnulls[6] = true;\n\t\t\tnulls[7] = true;\n\t\t\tnulls[8] = true;\n\t\t\tnulls[9] = true;\n\t\t\tnulls[10] = true;\n\t\t\tnulls[11] = true;\n\t\t\tnulls[12] = true;\n\t\t\tnulls[13] = true;\n\t\t\tnulls[14] = true;\n\t\t\tnulls[17] = true;\n\t\t}\n\n\t\ttuplestore_putvalues(tupstore, tupdesc, values, nulls);\n\n\t\t/* If only a single backend was requested, and we found it, break. */\n\t\tif (pid != -1)\n\t\t\tbreak;\n\t}\n\n\t/* clean up and return the tuplestore */\n\ttuplestore_donestoring(tupstore);\n\n\treturn (Datum) 0;\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define PG_STAT_GET_ACTIVITY_COLS\t24"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tuplestore_donestoring",
          "args": [
            "tupstore"
          ],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tuplestore_putvalues",
          "args": [
            "tupstore",
            "tupdesc",
            "values",
            "nulls"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "tuplestore_putvalues",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/sort/tuplestore.c",
          "lines": "749-762",
          "snippet": "void\ntuplestore_putvalues(Tuplestorestate *state, TupleDesc tdesc,\n\t\t\t\t\t Datum *values, bool *isnull)\n{\n\tMinimalTuple tuple;\n\tMemoryContext oldcxt = MemoryContextSwitchTo(state->context);\n\n\ttuple = heap_form_minimal_tuple(tdesc, values, isnull);\n\tUSEMEM(state, GetMemoryChunkSpace(tuple));\n\n\ttuplestore_puttuple_common(state, (void *) tuple);\n\n\tMemoryContextSwitchTo(oldcxt);\n}",
          "includes": [
            "#include \"utils/resowner.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"storage/buffile.h\"",
            "#include \"miscadmin.h\"",
            "#include \"executor/executor.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <limits.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void tuplestore_puttuple_common(Tuplestorestate *state, void *tuple);",
            "static void dumptuples(Tuplestorestate *state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/resowner.h\"\n#include \"utils/memutils.h\"\n#include \"storage/buffile.h\"\n#include \"miscadmin.h\"\n#include \"executor/executor.h\"\n#include \"commands/tablespace.h\"\n#include \"access/htup_details.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nstatic void tuplestore_puttuple_common(Tuplestorestate *state, void *tuple);\nstatic void dumptuples(Tuplestorestate *state);\n\nvoid\ntuplestore_putvalues(Tuplestorestate *state, TupleDesc tdesc,\n\t\t\t\t\t Datum *values, bool *isnull)\n{\n\tMinimalTuple tuple;\n\tMemoryContext oldcxt = MemoryContextSwitchTo(state->context);\n\n\ttuple = heap_form_minimal_tuple(tdesc, values, isnull);\n\tUSEMEM(state, GetMemoryChunkSpace(tuple));\n\n\ttuplestore_puttuple_common(state, (void *) tuple);\n\n\tMemoryContextSwitchTo(oldcxt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "\"<insufficient privilege>\""
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "pgstat_get_backend_desc(beentry->st_backendType)"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_get_backend_desc",
          "args": [
            "beentry->st_backendType"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "bgw_type"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetBackgroundWorkerTypeByPid",
          "args": [
            "beentry->st_procpid"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "-1"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "atoi(remote_port)"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "remote_port"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "beentry->st_clienthostname"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectFunctionCall1",
          "args": [
            "inet_in",
            "CStringGetDatum(remote_host)"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetDatum",
          "args": [
            "remote_host"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clean_ipv6_addr",
          "args": [
            "beentry->st_clientaddr.addr.ss_family",
            "remote_host"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "clean_ipv6_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/network.c",
          "lines": "1510-1522",
          "snippet": "void\nclean_ipv6_addr(int addr_family, char *addr)\n{\n#ifdef HAVE_IPV6\n\tif (addr_family == AF_INET6)\n\t{\n\t\tchar\t   *pct = strchr(addr, '%');\n\n\t\tif (pct)\n\t\t\t*pct = '\\0';\n\t}\n#endif\n}",
          "includes": [
            "#include \"utils/inet.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq-be.h\"",
            "#include \"common/ip.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"access/hash.h\"",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq-be.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"access/hash.h\"\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include \"postgres.h\"\n\nvoid\nclean_ipv6_addr(int addr_family, char *addr)\n{\n#ifdef HAVE_IPV6\n\tif (addr_family == AF_INET6)\n\t{\n\t\tchar\t   *pct = strchr(addr, '%');\n\n\t\tif (pct)\n\t\t\t*pct = '\\0';\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_getnameinfo_all",
          "args": [
            "&beentry->st_clientaddr.addr",
            "beentry->st_clientaddr.salen",
            "remote_host",
            "sizeof(remote_host)",
            "remote_port",
            "sizeof(remote_port)",
            "NI_NUMERICHOST | NI_NUMERICSERV"
          ],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&(beentry->st_clientaddr)",
            "&zero_clientaddr",
            "sizeof(zero_clientaddr)"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&zero_clientaddr",
            "0",
            "sizeof(zero_clientaddr)"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TimestampTzGetDatum",
          "args": [
            "beentry->st_state_start_timestamp"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TimestampTzGetDatum",
          "args": [
            "beentry->st_proc_start_timestamp"
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TimestampTzGetDatum",
          "args": [
            "beentry->st_activity_start_timestamp"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TimestampTzGetDatum",
          "args": [
            "beentry->st_xact_start_timestamp"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "wait_event"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "wait_event_type"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_get_wait_event",
          "args": [
            "raw_wait_event"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_get_wait_event_type",
          "args": [
            "raw_wait_event"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UINT32_ACCESS_ONCE",
          "args": [
            "proc->wait_event_info"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AuxiliaryPidGetProc",
          "args": [
            "beentry->st_procpid"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_get_wait_event",
          "args": [
            "raw_wait_event"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_get_wait_event_type",
          "args": [
            "raw_wait_event"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UINT32_ACCESS_ONCE",
          "args": [
            "proc->wait_event_info"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BackendPidGetProc",
          "args": [
            "beentry->st_procpid"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfree",
          "args": [
            "clipped_activity"
          ],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "xml_pfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/xml.c",
          "lines": "1649-1655",
          "snippet": "static void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}",
          "includes": [
            "#include \"utils/xml.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/datetime.h\"",
            "#include \"utils/date.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"nodes/execnodes.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"fmgr.h\"",
            "#include \"executor/tablefunc.h\"",
            "#include \"executor/spi.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/xmlwriter.h>",
            "#include <libxml/xmlversion.h>",
            "#include <libxml/xmlerror.h>",
            "#include <libxml/uri.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parserInternals.h>",
            "#include <libxml/parser.h>",
            "#include <libxml/chvalid.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/xml.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/datetime.h\"\n#include \"utils/date.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"nodes/execnodes.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/stringinfo.h\"\n#include \"fmgr.h\"\n#include \"executor/tablefunc.h\"\n#include \"executor/spi.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include <libxml/xpathInternals.h>\n#include <libxml/xpath.h>\n#include <libxml/xmlwriter.h>\n#include <libxml/xmlversion.h>\n#include <libxml/xmlerror.h>\n#include <libxml/uri.h>\n#include <libxml/tree.h>\n#include <libxml/parserInternals.h>\n#include <libxml/parser.h>\n#include <libxml/chvalid.h>\n#include \"postgres.h\"\n\nstatic void\nxml_pfree(void *ptr)\n{\n\t/* At least some parts of libxml assume xmlFree(NULL) is allowed */\n\tif (ptr)\n\t\tpfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "clipped_activity"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_clip_activity",
          "args": [
            "beentry->st_activity_raw"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "\"disabled\""
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "\"idle in transaction (aborted)\""
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "\"fastpath function call\""
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "\"idle in transaction\""
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "\"active\""
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "\"idle\""
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_member_of_role",
          "args": [
            "GetUserId()",
            "DEFAULT_ROLE_READ_ALL_STATS"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "is_member_of_role_nosuper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4969-4981",
          "snippet": "bool\nis_member_of_role_nosuper(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_is_member_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nbool\nis_member_of_role_nosuper(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member is a member of, including multi-level\n\t * recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_is_member_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "GetUserId()",
            "beentry->st_userid"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BoolGetDatum",
          "args": [
            "false"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "beentry->st_sslstatus->ssl_clientdn"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BoolGetDatum",
          "args": [
            "beentry->st_sslstatus->ssl_compression"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "beentry->st_sslstatus->ssl_bits"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "beentry->st_sslstatus->ssl_cipher"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "beentry->st_sslstatus->ssl_version"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BoolGetDatum",
          "args": [
            "true"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdGetDatum",
          "args": [
            "local_beentry->backend_xmin"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdIsValid",
          "args": [
            "local_beentry->backend_xmin"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdGetDatum",
          "args": [
            "local_beentry->backend_xid"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionIdIsValid",
          "args": [
            "local_beentry->backend_xid"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "beentry->st_appname"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "beentry->st_userid"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "beentry->st_procpid"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "beentry->st_databaseid"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CStringGetTextDatum",
          "args": [
            "\"<backend information not available>\""
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lengthof",
          "args": [
            "nulls"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_local_beentry",
          "args": [
            "curr_backend"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "nulls",
            "0",
            "sizeof(nulls)"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "values",
            "0",
            "sizeof(values)"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "oldcontext"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tuplestore_begin_heap",
          "args": [
            "true",
            "false",
            "work_mem"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "tuplestore_begin_heap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/sort/tuplestore.c",
          "lines": "317-338",
          "snippet": "Tuplestorestate *\ntuplestore_begin_heap(bool randomAccess, bool interXact, int maxKBytes)\n{\n\tTuplestorestate *state;\n\tint\t\t\teflags;\n\n\t/*\n\t * This interpretation of the meaning of randomAccess is compatible with\n\t * the pre-8.3 behavior of tuplestores.\n\t */\n\teflags = randomAccess ?\n\t\t(EXEC_FLAG_BACKWARD | EXEC_FLAG_REWIND) :\n\t\t(EXEC_FLAG_REWIND);\n\n\tstate = tuplestore_begin_common(eflags, interXact, maxKBytes);\n\n\tstate->copytup = copytup_heap;\n\tstate->writetup = writetup_heap;\n\tstate->readtup = readtup_heap;\n\n\treturn state;\n}",
          "includes": [
            "#include \"utils/resowner.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"storage/buffile.h\"",
            "#include \"miscadmin.h\"",
            "#include \"executor/executor.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <limits.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Tuplestorestate *tuplestore_begin_common(int eflags,\n\t\t\t\t\t\tbool interXact,\n\t\t\t\t\t\tint maxKBytes);",
            "static void dumptuples(Tuplestorestate *state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/resowner.h\"\n#include \"utils/memutils.h\"\n#include \"storage/buffile.h\"\n#include \"miscadmin.h\"\n#include \"executor/executor.h\"\n#include \"commands/tablespace.h\"\n#include \"access/htup_details.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nstatic Tuplestorestate *tuplestore_begin_common(int eflags,\n\t\t\t\t\t\tbool interXact,\n\t\t\t\t\t\tint maxKBytes);\nstatic void dumptuples(Tuplestorestate *state);\n\nTuplestorestate *\ntuplestore_begin_heap(bool randomAccess, bool interXact, int maxKBytes)\n{\n\tTuplestorestate *state;\n\tint\t\t\teflags;\n\n\t/*\n\t * This interpretation of the meaning of randomAccess is compatible with\n\t * the pre-8.3 behavior of tuplestores.\n\t */\n\teflags = randomAccess ?\n\t\t(EXEC_FLAG_BACKWARD | EXEC_FLAG_REWIND) :\n\t\t(EXEC_FLAG_REWIND);\n\n\tstate = tuplestore_begin_common(eflags, interXact, maxKBytes);\n\n\tstate->copytup = copytup_heap;\n\tstate->writetup = writetup_heap;\n\tstate->readtup = readtup_heap;\n\n\treturn state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "per_query_ctx"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"return type must be a row type\""
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_call_result_type",
          "args": [
            "fcinfo",
            "NULL",
            "&tupdesc"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "get_call_result_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/fmgr/funcapi.c",
          "lines": "210-220",
          "snippet": "TypeFuncClass\nget_call_result_type(FunctionCallInfo fcinfo,\n\t\t\t\t\t Oid *resultTypeId,\n\t\t\t\t\t TupleDesc *resultTupleDesc)\n{\n\treturn internal_get_result_type(fcinfo->flinfo->fn_oid,\n\t\t\t\t\t\t\t\t\tfcinfo->flinfo->fn_expr,\n\t\t\t\t\t\t\t\t\t(ReturnSetInfo *) fcinfo->resultinfo,\n\t\t\t\t\t\t\t\t\tresultTypeId,\n\t\t\t\t\t\t\t\t\tresultTupleDesc);\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/regproc.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"parser/parse_coerce.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"funcapi.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static TypeFuncClass internal_get_result_type(Oid funcid,\n\t\t\t\t\t\t Node *call_expr,\n\t\t\t\t\t\t ReturnSetInfo *rsinfo,\n\t\t\t\t\t\t Oid *resultTypeId,\n\t\t\t\t\t\t TupleDesc *resultTupleDesc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/regproc.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"parser/parse_coerce.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"funcapi.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic TypeFuncClass internal_get_result_type(Oid funcid,\n\t\t\t\t\t\t Node *call_expr,\n\t\t\t\t\t\t ReturnSetInfo *rsinfo,\n\t\t\t\t\t\t Oid *resultTypeId,\n\t\t\t\t\t\t TupleDesc *resultTupleDesc);\n\nTypeFuncClass\nget_call_result_type(FunctionCallInfo fcinfo,\n\t\t\t\t\t Oid *resultTypeId,\n\t\t\t\t\t TupleDesc *resultTupleDesc)\n{\n\treturn internal_get_result_type(fcinfo->flinfo->fn_oid,\n\t\t\t\t\t\t\t\t\tfcinfo->flinfo->fn_expr,\n\t\t\t\t\t\t\t\t\t(ReturnSetInfo *) fcinfo->resultinfo,\n\t\t\t\t\t\t\t\t\tresultTypeId,\n\t\t\t\t\t\t\t\t\tresultTupleDesc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"materialize mode required, but it is not \" \\\n\t\t\t\t\t\t\"allowed in this context\"))"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"materialize mode required, but it is not \" \\\n\t\t\t\t\t\t\"allowed in this context\""
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_FEATURE_NOT_SUPPORTED"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"set-valued function called in context that cannot accept a set\"))"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsA",
          "args": [
            "rsinfo",
            "ReturnSetInfo"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_INT32",
          "args": [
            "0"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_ARGISNULL",
          "args": [
            "0"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_numbackends",
          "args": [],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\n#define PG_STAT_GET_ACTIVITY_COLS\t24\n\nDatum\npg_stat_get_activity(PG_FUNCTION_ARGS)\n{\n#define PG_STAT_GET_ACTIVITY_COLS\t24\n\tint\t\t\tnum_backends = pgstat_fetch_stat_numbackends();\n\tint\t\t\tcurr_backend;\n\tint\t\t\tpid = PG_ARGISNULL(0) ? -1 : PG_GETARG_INT32(0);\n\tReturnSetInfo *rsinfo = (ReturnSetInfo *) fcinfo->resultinfo;\n\tTupleDesc\ttupdesc;\n\tTuplestorestate *tupstore;\n\tMemoryContext per_query_ctx;\n\tMemoryContext oldcontext;\n\n\t/* check to see if caller supports us returning a tuplestore */\n\tif (rsinfo == NULL || !IsA(rsinfo, ReturnSetInfo))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"set-valued function called in context that cannot accept a set\")));\n\tif (!(rsinfo->allowedModes & SFRM_Materialize))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"materialize mode required, but it is not \" \\\n\t\t\t\t\t\t\"allowed in this context\")));\n\n\t/* Build a tuple descriptor for our result type */\n\tif (get_call_result_type(fcinfo, NULL, &tupdesc) != TYPEFUNC_COMPOSITE)\n\t\telog(ERROR, \"return type must be a row type\");\n\n\tper_query_ctx = rsinfo->econtext->ecxt_per_query_memory;\n\toldcontext = MemoryContextSwitchTo(per_query_ctx);\n\n\ttupstore = tuplestore_begin_heap(true, false, work_mem);\n\trsinfo->returnMode = SFRM_Materialize;\n\trsinfo->setResult = tupstore;\n\trsinfo->setDesc = tupdesc;\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\t/* 1-based index */\n\tfor (curr_backend = 1; curr_backend <= num_backends; curr_backend++)\n\t{\n\t\t/* for each row */\n\t\tDatum\t\tvalues[PG_STAT_GET_ACTIVITY_COLS];\n\t\tbool\t\tnulls[PG_STAT_GET_ACTIVITY_COLS];\n\t\tLocalPgBackendStatus *local_beentry;\n\t\tPgBackendStatus *beentry;\n\t\tPGPROC\t   *proc;\n\t\tconst char *wait_event_type = NULL;\n\t\tconst char *wait_event = NULL;\n\n\t\tMemSet(values, 0, sizeof(values));\n\t\tMemSet(nulls, 0, sizeof(nulls));\n\n\t\t/* Get the next one in the list */\n\t\tlocal_beentry = pgstat_fetch_stat_local_beentry(curr_backend);\n\t\tif (!local_beentry)\n\t\t{\n\t\t\tint\t\t\ti;\n\n\t\t\t/* Ignore missing entries if looking for specific PID */\n\t\t\tif (pid != -1)\n\t\t\t\tcontinue;\n\n\t\t\tfor (i = 0; i < lengthof(nulls); i++)\n\t\t\t\tnulls[i] = true;\n\n\t\t\tnulls[5] = false;\n\t\t\tvalues[5] = CStringGetTextDatum(\"<backend information not available>\");\n\n\t\t\ttuplestore_putvalues(tupstore, tupdesc, values, nulls);\n\t\t\tcontinue;\n\t\t}\n\n\t\tbeentry = &local_beentry->backendStatus;\n\n\t\t/* If looking for specific PID, ignore all the others */\n\t\tif (pid != -1 && beentry->st_procpid != pid)\n\t\t\tcontinue;\n\n\t\t/* Values available to all callers */\n\t\tif (beentry->st_databaseid != InvalidOid)\n\t\t\tvalues[0] = ObjectIdGetDatum(beentry->st_databaseid);\n\t\telse\n\t\t\tnulls[0] = true;\n\n\t\tvalues[1] = Int32GetDatum(beentry->st_procpid);\n\n\t\tif (beentry->st_userid != InvalidOid)\n\t\t\tvalues[2] = ObjectIdGetDatum(beentry->st_userid);\n\t\telse\n\t\t\tnulls[2] = true;\n\n\t\tif (beentry->st_appname)\n\t\t\tvalues[3] = CStringGetTextDatum(beentry->st_appname);\n\t\telse\n\t\t\tnulls[3] = true;\n\n\t\tif (TransactionIdIsValid(local_beentry->backend_xid))\n\t\t\tvalues[15] = TransactionIdGetDatum(local_beentry->backend_xid);\n\t\telse\n\t\t\tnulls[15] = true;\n\n\t\tif (TransactionIdIsValid(local_beentry->backend_xmin))\n\t\t\tvalues[16] = TransactionIdGetDatum(local_beentry->backend_xmin);\n\t\telse\n\t\t\tnulls[16] = true;\n\n\t\tif (beentry->st_ssl)\n\t\t{\n\t\t\tvalues[18] = BoolGetDatum(true);\t/* ssl */\n\t\t\tvalues[19] = CStringGetTextDatum(beentry->st_sslstatus->ssl_version);\n\t\t\tvalues[20] = CStringGetTextDatum(beentry->st_sslstatus->ssl_cipher);\n\t\t\tvalues[21] = Int32GetDatum(beentry->st_sslstatus->ssl_bits);\n\t\t\tvalues[22] = BoolGetDatum(beentry->st_sslstatus->ssl_compression);\n\t\t\tvalues[23] = CStringGetTextDatum(beentry->st_sslstatus->ssl_clientdn);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvalues[18] = BoolGetDatum(false);\t/* ssl */\n\t\t\tnulls[19] = nulls[20] = nulls[21] = nulls[22] = nulls[23] = true;\n\t\t}\n\n\t\t/* Values only available to role member or pg_read_all_stats */\n\t\tif (has_privs_of_role(GetUserId(), beentry->st_userid) ||\n\t\t\tis_member_of_role(GetUserId(), DEFAULT_ROLE_READ_ALL_STATS))\n\t\t{\n\t\t\tSockAddr\tzero_clientaddr;\n\t\t\tchar\t   *clipped_activity;\n\n\t\t\tswitch (beentry->st_state)\n\t\t\t{\n\t\t\t\tcase STATE_IDLE:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"idle\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_RUNNING:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"active\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_IDLEINTRANSACTION:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"idle in transaction\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_FASTPATH:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"fastpath function call\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_IDLEINTRANSACTION_ABORTED:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"idle in transaction (aborted)\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_DISABLED:\n\t\t\t\t\tvalues[4] = CStringGetTextDatum(\"disabled\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase STATE_UNDEFINED:\n\t\t\t\t\tnulls[4] = true;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tclipped_activity = pgstat_clip_activity(beentry->st_activity_raw);\n\t\t\tvalues[5] = CStringGetTextDatum(clipped_activity);\n\t\t\tpfree(clipped_activity);\n\n\t\t\tproc = BackendPidGetProc(beentry->st_procpid);\n\t\t\tif (proc != NULL)\n\t\t\t{\n\t\t\t\tuint32\t\traw_wait_event;\n\n\t\t\t\traw_wait_event = UINT32_ACCESS_ONCE(proc->wait_event_info);\n\t\t\t\twait_event_type = pgstat_get_wait_event_type(raw_wait_event);\n\t\t\t\twait_event = pgstat_get_wait_event(raw_wait_event);\n\n\t\t\t}\n\t\t\telse if (beentry->st_backendType != B_BACKEND)\n\t\t\t{\n\t\t\t\t/*\n\t\t\t\t * For an auxiliary process, retrieve process info from\n\t\t\t\t * AuxiliaryProcs stored in shared-memory.\n\t\t\t\t */\n\t\t\t\tproc = AuxiliaryPidGetProc(beentry->st_procpid);\n\n\t\t\t\tif (proc != NULL)\n\t\t\t\t{\n\t\t\t\t\tuint32\t\traw_wait_event;\n\n\t\t\t\t\traw_wait_event =\n\t\t\t\t\t\tUINT32_ACCESS_ONCE(proc->wait_event_info);\n\t\t\t\t\twait_event_type =\n\t\t\t\t\t\tpgstat_get_wait_event_type(raw_wait_event);\n\t\t\t\t\twait_event = pgstat_get_wait_event(raw_wait_event);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (wait_event_type)\n\t\t\t\tvalues[6] = CStringGetTextDatum(wait_event_type);\n\t\t\telse\n\t\t\t\tnulls[6] = true;\n\n\t\t\tif (wait_event)\n\t\t\t\tvalues[7] = CStringGetTextDatum(wait_event);\n\t\t\telse\n\t\t\t\tnulls[7] = true;\n\n\t\t\tif (beentry->st_xact_start_timestamp != 0)\n\t\t\t\tvalues[8] = TimestampTzGetDatum(beentry->st_xact_start_timestamp);\n\t\t\telse\n\t\t\t\tnulls[8] = true;\n\n\t\t\tif (beentry->st_activity_start_timestamp != 0)\n\t\t\t\tvalues[9] = TimestampTzGetDatum(beentry->st_activity_start_timestamp);\n\t\t\telse\n\t\t\t\tnulls[9] = true;\n\n\t\t\tif (beentry->st_proc_start_timestamp != 0)\n\t\t\t\tvalues[10] = TimestampTzGetDatum(beentry->st_proc_start_timestamp);\n\t\t\telse\n\t\t\t\tnulls[10] = true;\n\n\t\t\tif (beentry->st_state_start_timestamp != 0)\n\t\t\t\tvalues[11] = TimestampTzGetDatum(beentry->st_state_start_timestamp);\n\t\t\telse\n\t\t\t\tnulls[11] = true;\n\n\t\t\t/* A zeroed client addr means we don't know */\n\t\t\tmemset(&zero_clientaddr, 0, sizeof(zero_clientaddr));\n\t\t\tif (memcmp(&(beentry->st_clientaddr), &zero_clientaddr,\n\t\t\t\t\t   sizeof(zero_clientaddr)) == 0)\n\t\t\t{\n\t\t\t\tnulls[12] = true;\n\t\t\t\tnulls[13] = true;\n\t\t\t\tnulls[14] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (beentry->st_clientaddr.addr.ss_family == AF_INET\n#ifdef HAVE_IPV6\n\t\t\t\t\t|| beentry->st_clientaddr.addr.ss_family == AF_INET6\n#endif\n\t\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tchar\t\tremote_host[NI_MAXHOST];\n\t\t\t\t\tchar\t\tremote_port[NI_MAXSERV];\n\t\t\t\t\tint\t\t\tret;\n\n\t\t\t\t\tremote_host[0] = '\\0';\n\t\t\t\t\tremote_port[0] = '\\0';\n\t\t\t\t\tret = pg_getnameinfo_all(&beentry->st_clientaddr.addr,\n\t\t\t\t\t\t\t\t\t\t\t beentry->st_clientaddr.salen,\n\t\t\t\t\t\t\t\t\t\t\t remote_host, sizeof(remote_host),\n\t\t\t\t\t\t\t\t\t\t\t remote_port, sizeof(remote_port),\n\t\t\t\t\t\t\t\t\t\t\t NI_NUMERICHOST | NI_NUMERICSERV);\n\t\t\t\t\tif (ret == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tclean_ipv6_addr(beentry->st_clientaddr.addr.ss_family, remote_host);\n\t\t\t\t\t\tvalues[12] = DirectFunctionCall1(inet_in,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t CStringGetDatum(remote_host));\n\t\t\t\t\t\tif (beentry->st_clienthostname &&\n\t\t\t\t\t\t\tbeentry->st_clienthostname[0])\n\t\t\t\t\t\t\tvalues[13] = CStringGetTextDatum(beentry->st_clienthostname);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tnulls[13] = true;\n\t\t\t\t\t\tvalues[14] = Int32GetDatum(atoi(remote_port));\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnulls[12] = true;\n\t\t\t\t\t\tnulls[13] = true;\n\t\t\t\t\t\tnulls[14] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (beentry->st_clientaddr.addr.ss_family == AF_UNIX)\n\t\t\t\t{\n\t\t\t\t\t/*\n\t\t\t\t\t * Unix sockets always reports NULL for host and -1 for\n\t\t\t\t\t * port, so it's possible to tell the difference to\n\t\t\t\t\t * connections we have no permissions to view, or with\n\t\t\t\t\t * errors.\n\t\t\t\t\t */\n\t\t\t\t\tnulls[12] = true;\n\t\t\t\t\tnulls[13] = true;\n\t\t\t\t\tvalues[14] = Int32GetDatum(-1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t/* Unknown address type, should never happen */\n\t\t\t\t\tnulls[12] = true;\n\t\t\t\t\tnulls[13] = true;\n\t\t\t\t\tnulls[14] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t/* Add backend type */\n\t\t\tif (beentry->st_backendType == B_BG_WORKER)\n\t\t\t{\n\t\t\t\tconst char *bgw_type;\n\n\t\t\t\tbgw_type = GetBackgroundWorkerTypeByPid(beentry->st_procpid);\n\t\t\t\tif (bgw_type)\n\t\t\t\t\tvalues[17] = CStringGetTextDatum(bgw_type);\n\t\t\t\telse\n\t\t\t\t\tnulls[17] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalues[17] =\n\t\t\t\t\tCStringGetTextDatum(pgstat_get_backend_desc(beentry->st_backendType));\n\t\t}\n\t\telse\n\t\t{\n\t\t\t/* No permissions to view data about this session */\n\t\t\tvalues[5] = CStringGetTextDatum(\"<insufficient privilege>\");\n\t\t\tnulls[4] = true;\n\t\t\tnulls[6] = true;\n\t\t\tnulls[7] = true;\n\t\t\tnulls[8] = true;\n\t\t\tnulls[9] = true;\n\t\t\tnulls[10] = true;\n\t\t\tnulls[11] = true;\n\t\t\tnulls[12] = true;\n\t\t\tnulls[13] = true;\n\t\t\tnulls[14] = true;\n\t\t\tnulls[17] = true;\n\t\t}\n\n\t\ttuplestore_putvalues(tupstore, tupdesc, values, nulls);\n\n\t\t/* If only a single backend was requested, and we found it, break. */\n\t\tif (pid != -1)\n\t\t\tbreak;\n\t}\n\n\t/* clean up and return the tuplestore */\n\ttuplestore_donestoring(tupstore);\n\n\treturn (Datum) 0;\n}"
  },
  {
    "function_name": "pg_stat_get_progress_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "439-536",
    "snippet": "Datum\npg_stat_get_progress_info(PG_FUNCTION_ARGS)\n{\n#define PG_STAT_GET_PROGRESS_COLS\tPGSTAT_NUM_PROGRESS_PARAM + 3\n\tint\t\t\tnum_backends = pgstat_fetch_stat_numbackends();\n\tint\t\t\tcurr_backend;\n\tchar\t   *cmd = text_to_cstring(PG_GETARG_TEXT_PP(0));\n\tProgressCommandType cmdtype;\n\tTupleDesc\ttupdesc;\n\tTuplestorestate *tupstore;\n\tReturnSetInfo *rsinfo = (ReturnSetInfo *) fcinfo->resultinfo;\n\tMemoryContext per_query_ctx;\n\tMemoryContext oldcontext;\n\n\t/* check to see if caller supports us returning a tuplestore */\n\tif (rsinfo == NULL || !IsA(rsinfo, ReturnSetInfo))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"set-valued function called in context that cannot accept a set\")));\n\tif (!(rsinfo->allowedModes & SFRM_Materialize))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"materialize mode required, but it is not \" \\\n\t\t\t\t\t\t\"allowed in this context\")));\n\n\t/* Build a tuple descriptor for our result type */\n\tif (get_call_result_type(fcinfo, NULL, &tupdesc) != TYPEFUNC_COMPOSITE)\n\t\telog(ERROR, \"return type must be a row type\");\n\n\t/* Translate command name into command type code. */\n\tif (pg_strcasecmp(cmd, \"VACUUM\") == 0)\n\t\tcmdtype = PROGRESS_COMMAND_VACUUM;\n\telse\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"invalid command name: \\\"%s\\\"\", cmd)));\n\n\tper_query_ctx = rsinfo->econtext->ecxt_per_query_memory;\n\toldcontext = MemoryContextSwitchTo(per_query_ctx);\n\n\ttupstore = tuplestore_begin_heap(true, false, work_mem);\n\trsinfo->returnMode = SFRM_Materialize;\n\trsinfo->setResult = tupstore;\n\trsinfo->setDesc = tupdesc;\n\tMemoryContextSwitchTo(oldcontext);\n\n\t/* 1-based index */\n\tfor (curr_backend = 1; curr_backend <= num_backends; curr_backend++)\n\t{\n\t\tLocalPgBackendStatus *local_beentry;\n\t\tPgBackendStatus *beentry;\n\t\tDatum\t\tvalues[PG_STAT_GET_PROGRESS_COLS];\n\t\tbool\t\tnulls[PG_STAT_GET_PROGRESS_COLS];\n\t\tint\t\t\ti;\n\n\t\tMemSet(values, 0, sizeof(values));\n\t\tMemSet(nulls, 0, sizeof(nulls));\n\n\t\tlocal_beentry = pgstat_fetch_stat_local_beentry(curr_backend);\n\n\t\tif (!local_beentry)\n\t\t\tcontinue;\n\n\t\tbeentry = &local_beentry->backendStatus;\n\n\t\t/*\n\t\t * Report values for only those backends which are running the given\n\t\t * command.\n\t\t */\n\t\tif (!beentry || beentry->st_progress_command != cmdtype)\n\t\t\tcontinue;\n\n\t\t/* Value available to all callers */\n\t\tvalues[0] = Int32GetDatum(beentry->st_procpid);\n\t\tvalues[1] = ObjectIdGetDatum(beentry->st_databaseid);\n\n\t\t/* show rest of the values including relid only to role members */\n\t\tif (has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\t{\n\t\t\tvalues[2] = ObjectIdGetDatum(beentry->st_progress_command_target);\n\t\t\tfor (i = 0; i < PGSTAT_NUM_PROGRESS_PARAM; i++)\n\t\t\t\tvalues[i + 3] = Int64GetDatum(beentry->st_progress_param[i]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnulls[2] = true;\n\t\t\tfor (i = 0; i < PGSTAT_NUM_PROGRESS_PARAM; i++)\n\t\t\t\tnulls[i + 3] = true;\n\t\t}\n\n\t\ttuplestore_putvalues(tupstore, tupdesc, values, nulls);\n\t}\n\n\t/* clean up and return the tuplestore */\n\ttuplestore_donestoring(tupstore);\n\n\treturn (Datum) 0;\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [
      "#define PG_STAT_GET_PROGRESS_COLS\tPGSTAT_NUM_PROGRESS_PARAM + 3"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tuplestore_donestoring",
          "args": [
            "tupstore"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tuplestore_putvalues",
          "args": [
            "tupstore",
            "tupdesc",
            "values",
            "nulls"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "tuplestore_putvalues",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/sort/tuplestore.c",
          "lines": "749-762",
          "snippet": "void\ntuplestore_putvalues(Tuplestorestate *state, TupleDesc tdesc,\n\t\t\t\t\t Datum *values, bool *isnull)\n{\n\tMinimalTuple tuple;\n\tMemoryContext oldcxt = MemoryContextSwitchTo(state->context);\n\n\ttuple = heap_form_minimal_tuple(tdesc, values, isnull);\n\tUSEMEM(state, GetMemoryChunkSpace(tuple));\n\n\ttuplestore_puttuple_common(state, (void *) tuple);\n\n\tMemoryContextSwitchTo(oldcxt);\n}",
          "includes": [
            "#include \"utils/resowner.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"storage/buffile.h\"",
            "#include \"miscadmin.h\"",
            "#include \"executor/executor.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <limits.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void tuplestore_puttuple_common(Tuplestorestate *state, void *tuple);",
            "static void dumptuples(Tuplestorestate *state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/resowner.h\"\n#include \"utils/memutils.h\"\n#include \"storage/buffile.h\"\n#include \"miscadmin.h\"\n#include \"executor/executor.h\"\n#include \"commands/tablespace.h\"\n#include \"access/htup_details.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nstatic void tuplestore_puttuple_common(Tuplestorestate *state, void *tuple);\nstatic void dumptuples(Tuplestorestate *state);\n\nvoid\ntuplestore_putvalues(Tuplestorestate *state, TupleDesc tdesc,\n\t\t\t\t\t Datum *values, bool *isnull)\n{\n\tMinimalTuple tuple;\n\tMemoryContext oldcxt = MemoryContextSwitchTo(state->context);\n\n\ttuple = heap_form_minimal_tuple(tdesc, values, isnull);\n\tUSEMEM(state, GetMemoryChunkSpace(tuple));\n\n\ttuplestore_puttuple_common(state, (void *) tuple);\n\n\tMemoryContextSwitchTo(oldcxt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Int64GetDatum",
          "args": [
            "beentry->st_progress_param[i]"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "Int64GetDatum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/fmgr/fmgr.c",
          "lines": "1876-1883",
          "snippet": "Datum\nInt64GetDatum(int64 X)\n{\n\tint64\t   *retval = (int64 *) palloc(sizeof(int64));\n\n\t*retval = X;\n\treturn PointerGetDatum(retval);\n}",
          "includes": [
            "#include \"utils/syscache.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/fmgrtab.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"pgstat.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"miscadmin.h\"",
            "#include \"lib/stringinfo.h\"",
            "#include \"executor/functions.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/pg_language.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/syscache.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/guc.h\"\n#include \"utils/fmgrtab.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"pgstat.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"miscadmin.h\"\n#include \"lib/stringinfo.h\"\n#include \"executor/functions.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/pg_language.h\"\n#include \"access/tuptoaster.h\"\n#include \"postgres.h\"\n\nDatum\nInt64GetDatum(int64 X)\n{\n\tint64\t   *retval = (int64 *) palloc(sizeof(int64));\n\n\t*retval = X;\n\treturn PointerGetDatum(retval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "beentry->st_progress_command_target"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_privs_of_role",
          "args": [
            "GetUserId()",
            "beentry->st_userid"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "has_privs_of_role",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/acl.c",
          "lines": "4907-4923",
          "snippet": "bool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/inval.h\"",
            "#include \"utils/catcache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/acl.h\"",
            "#include \"miscadmin.h\"",
            "#include \"funcapi.h\"",
            "#include \"foreign/foreign.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"commands/proclang.h\"",
            "#include \"commands/dbcommands.h\"",
            "#include \"catalog/pg_class.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_auth_members.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"catalog/catalog.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"access/hash.h\"",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/inval.h\"\n#include \"utils/catcache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"foreign/foreign.h\"\n#include \"commands/tablespace.h\"\n#include \"commands/proclang.h\"\n#include \"commands/dbcommands.h\"\n#include \"catalog/pg_class.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_auth_members.h\"\n#include \"catalog/pg_authid.h\"\n#include \"catalog/namespace.h\"\n#include \"catalog/catalog.h\"\n#include \"access/htup_details.h\"\n#include \"access/hash.h\"\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic AclMode convert_any_priv_string(text *priv_type_text,\n\t\t\t\t\t\tconst priv_map *privileges);\n\nbool\nhas_privs_of_role(Oid member, Oid role)\n{\n\t/* Fast path for simple case */\n\tif (member == role)\n\t\treturn true;\n\n\t/* Superusers have every privilege, so are part of every role */\n\tif (superuser_arg(member))\n\t\treturn true;\n\n\t/*\n\t * Find all the roles that member has the privileges of, including\n\t * multi-level recursion, then see if target role is any one of them.\n\t */\n\treturn list_member_oid(roles_has_privs_of(member), role);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserId",
          "args": [],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/init/miscinit.c",
          "lines": "386-391",
          "snippet": "Oid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}",
          "includes": [
            "#include \"utils/varlena.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/pidfile.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"storage/procarray.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/pg_shmem.h\"",
            "#include \"storage/latch.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"storage/fd.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"postmaster/autovacuum.h\"",
            "#include \"pgstat.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"common/file_perm.h\"",
            "#include \"catalog/pg_authid.h\"",
            "#include \"access/htup_details.h\"",
            "#include <utime.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <sys/param.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Oid\tCurrentUserId = InvalidOid;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/varlena.h\"\n#include \"utils/syscache.h\"\n#include \"utils/pidfile.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"utils/builtins.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"storage/pg_shmem.h\"\n#include \"storage/latch.h\"\n#include \"storage/ipc.h\"\n#include \"storage/fd.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/autovacuum.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/libpq.h\"\n#include \"common/file_perm.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include <utime.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <pwd.h>\n#include <grp.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <time.h>\n#include <signal.h>\n#include <sys/param.h>\n#include \"postgres.h\"\n\nstatic Oid\tCurrentUserId = InvalidOid;\n\nOid\nGetUserId(void)\n{\n\tAssertState(OidIsValid(CurrentUserId));\n\treturn CurrentUserId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ObjectIdGetDatum",
          "args": [
            "beentry->st_databaseid"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "beentry->st_procpid"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_local_beentry",
          "args": [
            "curr_backend"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "nulls",
            "0",
            "sizeof(nulls)"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemSet",
          "args": [
            "values",
            "0",
            "sizeof(values)"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "oldcontext"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tuplestore_begin_heap",
          "args": [
            "true",
            "false",
            "work_mem"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "tuplestore_begin_heap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/sort/tuplestore.c",
          "lines": "317-338",
          "snippet": "Tuplestorestate *\ntuplestore_begin_heap(bool randomAccess, bool interXact, int maxKBytes)\n{\n\tTuplestorestate *state;\n\tint\t\t\teflags;\n\n\t/*\n\t * This interpretation of the meaning of randomAccess is compatible with\n\t * the pre-8.3 behavior of tuplestores.\n\t */\n\teflags = randomAccess ?\n\t\t(EXEC_FLAG_BACKWARD | EXEC_FLAG_REWIND) :\n\t\t(EXEC_FLAG_REWIND);\n\n\tstate = tuplestore_begin_common(eflags, interXact, maxKBytes);\n\n\tstate->copytup = copytup_heap;\n\tstate->writetup = writetup_heap;\n\tstate->readtup = readtup_heap;\n\n\treturn state;\n}",
          "includes": [
            "#include \"utils/resowner.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"storage/buffile.h\"",
            "#include \"miscadmin.h\"",
            "#include \"executor/executor.h\"",
            "#include \"commands/tablespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include <limits.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static Tuplestorestate *tuplestore_begin_common(int eflags,\n\t\t\t\t\t\tbool interXact,\n\t\t\t\t\t\tint maxKBytes);",
            "static void dumptuples(Tuplestorestate *state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/resowner.h\"\n#include \"utils/memutils.h\"\n#include \"storage/buffile.h\"\n#include \"miscadmin.h\"\n#include \"executor/executor.h\"\n#include \"commands/tablespace.h\"\n#include \"access/htup_details.h\"\n#include <limits.h>\n#include \"postgres.h\"\n\nstatic Tuplestorestate *tuplestore_begin_common(int eflags,\n\t\t\t\t\t\tbool interXact,\n\t\t\t\t\t\tint maxKBytes);\nstatic void dumptuples(Tuplestorestate *state);\n\nTuplestorestate *\ntuplestore_begin_heap(bool randomAccess, bool interXact, int maxKBytes)\n{\n\tTuplestorestate *state;\n\tint\t\t\teflags;\n\n\t/*\n\t * This interpretation of the meaning of randomAccess is compatible with\n\t * the pre-8.3 behavior of tuplestores.\n\t */\n\teflags = randomAccess ?\n\t\t(EXEC_FLAG_BACKWARD | EXEC_FLAG_REWIND) :\n\t\t(EXEC_FLAG_REWIND);\n\n\tstate = tuplestore_begin_common(eflags, interXact, maxKBytes);\n\n\tstate->copytup = copytup_heap;\n\tstate->writetup = writetup_heap;\n\tstate->readtup = readtup_heap;\n\n\treturn state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MemoryContextSwitchTo",
          "args": [
            "per_query_ctx"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"invalid command name: \\\"%s\\\"\", cmd))"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errmsg",
          "args": [
            "\"invalid command name: \\\"%s\\\"\"",
            "cmd"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "errmsg_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "824-840",
          "snippet": "int\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrmsg_internal(const char *fmt,...)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\tMemoryContext oldcontext;\n\n\trecursion_depth++;\n\tCHECK_STACK_DEPTH();\n\toldcontext = MemoryContextSwitchTo(edata->assoc_context);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, false);\n\n\tMemoryContextSwitchTo(oldcontext);\n\trecursion_depth--;\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "errcode",
          "args": [
            "ERRCODE_INVALID_PARAMETER_VALUE"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "errcode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "572-583",
          "snippet": "int\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static ErrorData errordata[ERRORDATA_STACK_SIZE];",
            "static int\terrordata_stack_depth = -1;",
            "static int\trecursion_depth = 0;",
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic ErrorData errordata[ERRORDATA_STACK_SIZE];\nstatic int\terrordata_stack_depth = -1;\nstatic int\trecursion_depth = 0;\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\n\nint\nerrcode(int sqlerrcode)\n{\n\tErrorData  *edata = &errordata[errordata_stack_depth];\n\n\t/* we don't bother incrementing recursion_depth */\n\tCHECK_STACK_DEPTH();\n\n\tedata->sqlerrcode = sqlerrcode;\n\n\treturn 0;\t\t\t\t\t/* return value does not matter */\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg_strcasecmp",
          "args": [
            "cmd",
            "\"VACUUM\""
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elog",
          "args": [
            "ERROR",
            "\"return type must be a row type\""
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "format_elog_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/error/elog.c",
          "lines": "1410-1433",
          "snippet": "char *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}",
          "includes": [
            "#include \"utils/ps_status.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/guc.h\"",
            "#include \"tcop/tcopprot.h\"",
            "#include \"storage/proc.h\"",
            "#include \"storage/ipc.h\"",
            "#include \"postmaster/syslogger.h\"",
            "#include \"postmaster/postmaster.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"libpq/libpq.h\"",
            "#include \"access/xact.h\"",
            "#include \"access/transam.h\"",
            "#include <syslog.h>",
            "#include <ctype.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void log_line_prefix(StringInfo buf, ErrorData *edata);",
            "static void write_csvlog(ErrorData *edata);",
            "static void send_message_to_server_log(ErrorData *edata);",
            "static void send_message_to_frontend(ErrorData *edata);",
            "static char *expand_fmt_string(const char *fmt, ErrorData *edata);",
            "static int\tsave_format_errnumber;",
            "static const char *save_format_domain;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/ps_status.h\"\n#include \"utils/memutils.h\"\n#include \"utils/guc.h\"\n#include \"tcop/tcopprot.h\"\n#include \"storage/proc.h\"\n#include \"storage/ipc.h\"\n#include \"postmaster/syslogger.h\"\n#include \"postmaster/postmaster.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"libpq/pqformat.h\"\n#include \"libpq/libpq.h\"\n#include \"access/xact.h\"\n#include \"access/transam.h\"\n#include <syslog.h>\n#include <ctype.h>\n#include <signal.h>\n#include <unistd.h>\n#include <time.h>\n#include <fcntl.h>\n#include \"postgres.h\"\n\nstatic void log_line_prefix(StringInfo buf, ErrorData *edata);\nstatic void write_csvlog(ErrorData *edata);\nstatic void send_message_to_server_log(ErrorData *edata);\nstatic void send_message_to_frontend(ErrorData *edata);\nstatic char *expand_fmt_string(const char *fmt, ErrorData *edata);\nstatic int\tsave_format_errnumber;\nstatic const char *save_format_domain;\n\nchar *\nformat_elog_string(const char *fmt,...)\n{\n\tErrorData\terrdata;\n\tErrorData  *edata;\n\tMemoryContext oldcontext;\n\n\t/* Initialize a mostly-dummy error frame */\n\tedata = &errdata;\n\tMemSet(edata, 0, sizeof(ErrorData));\n\t/* the default text domain is the backend's */\n\tedata->domain = save_format_domain ? save_format_domain : PG_TEXTDOMAIN(\"postgres\");\n\t/* set the errno to be used to interpret %m */\n\tedata->saved_errno = save_format_errnumber;\n\n\toldcontext = MemoryContextSwitchTo(ErrorContext);\n\n\tedata->message_id = fmt;\n\tEVALUATE_MESSAGE(edata->domain, message, false, true);\n\n\tMemoryContextSwitchTo(oldcontext);\n\n\treturn edata->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_call_result_type",
          "args": [
            "fcinfo",
            "NULL",
            "&tupdesc"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "get_call_result_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/fmgr/funcapi.c",
          "lines": "210-220",
          "snippet": "TypeFuncClass\nget_call_result_type(FunctionCallInfo fcinfo,\n\t\t\t\t\t Oid *resultTypeId,\n\t\t\t\t\t TupleDesc *resultTupleDesc)\n{\n\treturn internal_get_result_type(fcinfo->flinfo->fn_oid,\n\t\t\t\t\t\t\t\t\tfcinfo->flinfo->fn_expr,\n\t\t\t\t\t\t\t\t\t(ReturnSetInfo *) fcinfo->resultinfo,\n\t\t\t\t\t\t\t\t\tresultTypeId,\n\t\t\t\t\t\t\t\t\tresultTupleDesc);\n}",
          "includes": [
            "#include \"utils/typcache.h\"",
            "#include \"utils/syscache.h\"",
            "#include \"utils/rel.h\"",
            "#include \"utils/regproc.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"utils/array.h\"",
            "#include \"parser/parse_coerce.h\"",
            "#include \"nodes/nodeFuncs.h\"",
            "#include \"funcapi.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_proc.h\"",
            "#include \"catalog/namespace.h\"",
            "#include \"access/htup_details.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static TypeFuncClass internal_get_result_type(Oid funcid,\n\t\t\t\t\t\t Node *call_expr,\n\t\t\t\t\t\t ReturnSetInfo *rsinfo,\n\t\t\t\t\t\t Oid *resultTypeId,\n\t\t\t\t\t\t TupleDesc *resultTupleDesc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/typcache.h\"\n#include \"utils/syscache.h\"\n#include \"utils/rel.h\"\n#include \"utils/regproc.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/builtins.h\"\n#include \"utils/array.h\"\n#include \"parser/parse_coerce.h\"\n#include \"nodes/nodeFuncs.h\"\n#include \"funcapi.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_proc.h\"\n#include \"catalog/namespace.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nstatic TypeFuncClass internal_get_result_type(Oid funcid,\n\t\t\t\t\t\t Node *call_expr,\n\t\t\t\t\t\t ReturnSetInfo *rsinfo,\n\t\t\t\t\t\t Oid *resultTypeId,\n\t\t\t\t\t\t TupleDesc *resultTupleDesc);\n\nTypeFuncClass\nget_call_result_type(FunctionCallInfo fcinfo,\n\t\t\t\t\t Oid *resultTypeId,\n\t\t\t\t\t TupleDesc *resultTupleDesc)\n{\n\treturn internal_get_result_type(fcinfo->flinfo->fn_oid,\n\t\t\t\t\t\t\t\t\tfcinfo->flinfo->fn_expr,\n\t\t\t\t\t\t\t\t\t(ReturnSetInfo *) fcinfo->resultinfo,\n\t\t\t\t\t\t\t\t\tresultTypeId,\n\t\t\t\t\t\t\t\t\tresultTupleDesc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"materialize mode required, but it is not \" \\\n\t\t\t\t\t\t\"allowed in this context\"))"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ereport",
          "args": [
            "ERROR",
            "(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"set-valued function called in context that cannot accept a set\"))"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsA",
          "args": [
            "rsinfo",
            "ReturnSetInfo"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text_to_cstring",
          "args": [
            "PG_GETARG_TEXT_PP(0)"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "text_to_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/varlena.c",
          "lines": "181-197",
          "snippet": "char *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}",
          "includes": [
            "#include \"levenshtein.c\"",
            "#include \"levenshtein.c\"",
            "#include \"utils/varlena.h\"",
            "#include \"utils/sortsupport.h\"",
            "#include \"utils/pg_locale.h\"",
            "#include \"utils/memutils.h\"",
            "#include \"utils/lsyscache.h\"",
            "#include \"utils/bytea.h\"",
            "#include \"utils/builtins.h\"",
            "#include \"regex/regex.h\"",
            "#include \"port/pg_bswap.h\"",
            "#include \"parser/scansup.h\"",
            "#include \"miscadmin.h\"",
            "#include \"libpq/pqformat.h\"",
            "#include \"lib/hyperloglog.h\"",
            "#include \"common/int.h\"",
            "#include \"catalog/pg_type.h\"",
            "#include \"catalog/pg_collation.h\"",
            "#include \"access/tuptoaster.h\"",
            "#include \"access/hash.h\"",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void appendStringInfoText(StringInfo str, const text *t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"levenshtein.c\"\n#include \"levenshtein.c\"\n#include \"utils/varlena.h\"\n#include \"utils/sortsupport.h\"\n#include \"utils/pg_locale.h\"\n#include \"utils/memutils.h\"\n#include \"utils/lsyscache.h\"\n#include \"utils/bytea.h\"\n#include \"utils/builtins.h\"\n#include \"regex/regex.h\"\n#include \"port/pg_bswap.h\"\n#include \"parser/scansup.h\"\n#include \"miscadmin.h\"\n#include \"libpq/pqformat.h\"\n#include \"lib/hyperloglog.h\"\n#include \"common/int.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_collation.h\"\n#include \"access/tuptoaster.h\"\n#include \"access/hash.h\"\n#include <limits.h>\n#include <ctype.h>\n#include \"postgres.h\"\n\nstatic void appendStringInfoText(StringInfo str, const text *t);\n\nchar *\ntext_to_cstring(const text *t)\n{\n\t/* must cast away the const, unfortunately */\n\ttext\t   *tunpacked = pg_detoast_datum_packed((struct varlena *) t);\n\tint\t\t\tlen = VARSIZE_ANY_EXHDR(tunpacked);\n\tchar\t   *result;\n\n\tresult = (char *) palloc(len + 1);\n\tmemcpy(result, VARDATA_ANY(tunpacked), len);\n\tresult[len] = '\\0';\n\n\tif (tunpacked != t)\n\t\tpfree(tunpacked);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PG_GETARG_TEXT_PP",
          "args": [
            "0"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_numbackends",
          "args": [],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\n#define PG_STAT_GET_PROGRESS_COLS\tPGSTAT_NUM_PROGRESS_PARAM + 3\n\nDatum\npg_stat_get_progress_info(PG_FUNCTION_ARGS)\n{\n#define PG_STAT_GET_PROGRESS_COLS\tPGSTAT_NUM_PROGRESS_PARAM + 3\n\tint\t\t\tnum_backends = pgstat_fetch_stat_numbackends();\n\tint\t\t\tcurr_backend;\n\tchar\t   *cmd = text_to_cstring(PG_GETARG_TEXT_PP(0));\n\tProgressCommandType cmdtype;\n\tTupleDesc\ttupdesc;\n\tTuplestorestate *tupstore;\n\tReturnSetInfo *rsinfo = (ReturnSetInfo *) fcinfo->resultinfo;\n\tMemoryContext per_query_ctx;\n\tMemoryContext oldcontext;\n\n\t/* check to see if caller supports us returning a tuplestore */\n\tif (rsinfo == NULL || !IsA(rsinfo, ReturnSetInfo))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"set-valued function called in context that cannot accept a set\")));\n\tif (!(rsinfo->allowedModes & SFRM_Materialize))\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"materialize mode required, but it is not \" \\\n\t\t\t\t\t\t\"allowed in this context\")));\n\n\t/* Build a tuple descriptor for our result type */\n\tif (get_call_result_type(fcinfo, NULL, &tupdesc) != TYPEFUNC_COMPOSITE)\n\t\telog(ERROR, \"return type must be a row type\");\n\n\t/* Translate command name into command type code. */\n\tif (pg_strcasecmp(cmd, \"VACUUM\") == 0)\n\t\tcmdtype = PROGRESS_COMMAND_VACUUM;\n\telse\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_INVALID_PARAMETER_VALUE),\n\t\t\t\t errmsg(\"invalid command name: \\\"%s\\\"\", cmd)));\n\n\tper_query_ctx = rsinfo->econtext->ecxt_per_query_memory;\n\toldcontext = MemoryContextSwitchTo(per_query_ctx);\n\n\ttupstore = tuplestore_begin_heap(true, false, work_mem);\n\trsinfo->returnMode = SFRM_Materialize;\n\trsinfo->setResult = tupstore;\n\trsinfo->setDesc = tupdesc;\n\tMemoryContextSwitchTo(oldcontext);\n\n\t/* 1-based index */\n\tfor (curr_backend = 1; curr_backend <= num_backends; curr_backend++)\n\t{\n\t\tLocalPgBackendStatus *local_beentry;\n\t\tPgBackendStatus *beentry;\n\t\tDatum\t\tvalues[PG_STAT_GET_PROGRESS_COLS];\n\t\tbool\t\tnulls[PG_STAT_GET_PROGRESS_COLS];\n\t\tint\t\t\ti;\n\n\t\tMemSet(values, 0, sizeof(values));\n\t\tMemSet(nulls, 0, sizeof(nulls));\n\n\t\tlocal_beentry = pgstat_fetch_stat_local_beentry(curr_backend);\n\n\t\tif (!local_beentry)\n\t\t\tcontinue;\n\n\t\tbeentry = &local_beentry->backendStatus;\n\n\t\t/*\n\t\t * Report values for only those backends which are running the given\n\t\t * command.\n\t\t */\n\t\tif (!beentry || beentry->st_progress_command != cmdtype)\n\t\t\tcontinue;\n\n\t\t/* Value available to all callers */\n\t\tvalues[0] = Int32GetDatum(beentry->st_procpid);\n\t\tvalues[1] = ObjectIdGetDatum(beentry->st_databaseid);\n\n\t\t/* show rest of the values including relid only to role members */\n\t\tif (has_privs_of_role(GetUserId(), beentry->st_userid))\n\t\t{\n\t\t\tvalues[2] = ObjectIdGetDatum(beentry->st_progress_command_target);\n\t\t\tfor (i = 0; i < PGSTAT_NUM_PROGRESS_PARAM; i++)\n\t\t\t\tvalues[i + 3] = Int64GetDatum(beentry->st_progress_param[i]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnulls[2] = true;\n\t\t\tfor (i = 0; i < PGSTAT_NUM_PROGRESS_PARAM; i++)\n\t\t\t\tnulls[i + 3] = true;\n\t\t}\n\n\t\ttuplestore_putvalues(tupstore, tupdesc, values, nulls);\n\t}\n\n\t/* clean up and return the tuplestore */\n\ttuplestore_donestoring(tupstore);\n\n\treturn (Datum) 0;\n}"
  },
  {
    "function_name": "pg_stat_get_backend_idset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "396-434",
    "snippet": "Datum\npg_stat_get_backend_idset(PG_FUNCTION_ARGS)\n{\n\tFuncCallContext *funcctx;\n\tint\t\t   *fctx;\n\tint32\t\tresult;\n\n\t/* stuff done only on the first call of the function */\n\tif (SRF_IS_FIRSTCALL())\n\t{\n\t\t/* create a function context for cross-call persistence */\n\t\tfuncctx = SRF_FIRSTCALL_INIT();\n\n\t\tfctx = MemoryContextAlloc(funcctx->multi_call_memory_ctx,\n\t\t\t\t\t\t\t\t  2 * sizeof(int));\n\t\tfuncctx->user_fctx = fctx;\n\n\t\tfctx[0] = 0;\n\t\tfctx[1] = pgstat_fetch_stat_numbackends();\n\t}\n\n\t/* stuff done on every call of the function */\n\tfuncctx = SRF_PERCALL_SETUP();\n\tfctx = funcctx->user_fctx;\n\n\tfctx[0] += 1;\n\tresult = fctx[0];\n\n\tif (result <= fctx[1])\n\t{\n\t\t/* do when there is more left to send */\n\t\tSRF_RETURN_NEXT(funcctx, Int32GetDatum(result));\n\t}\n\telse\n\t{\n\t\t/* do when there is no more left */\n\t\tSRF_RETURN_DONE(funcctx);\n\t}\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SRF_RETURN_DONE",
          "args": [
            "funcctx"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SRF_RETURN_NEXT",
          "args": [
            "funcctx",
            "Int32GetDatum(result)"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Int32GetDatum",
          "args": [
            "result"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SRF_PERCALL_SETUP",
          "args": [],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_numbackends",
          "args": [],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MemoryContextAlloc",
          "args": [
            "funcctx->multi_call_memory_ctx",
            "2 * sizeof(int)"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "MemoryContextAllocHuge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/mmgr/mcxt.c",
          "lines": "1079-1106",
          "snippet": "void *\nMemoryContextAllocHuge(MemoryContext context, Size size)\n{\n\tvoid\t   *ret;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocHugeSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils/memutils.h\"",
            "#include \"utils/memdebug.h\"",
            "#include \"miscadmin.h\"",
            "#include \"mb/pg_wchar.h\"",
            "#include \"postgres.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "MemoryContext TopMemoryContext = NULL;",
            "static void MemoryContextCallResetCallbacks(MemoryContext context);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils/memutils.h\"\n#include \"utils/memdebug.h\"\n#include \"miscadmin.h\"\n#include \"mb/pg_wchar.h\"\n#include \"postgres.h\"\n\nMemoryContext TopMemoryContext = NULL;\nstatic void MemoryContextCallResetCallbacks(MemoryContext context);\n\nvoid *\nMemoryContextAllocHuge(MemoryContext context, Size size)\n{\n\tvoid\t   *ret;\n\n\tAssertArg(MemoryContextIsValid(context));\n\tAssertNotInCriticalSection(context);\n\n\tif (!AllocHugeSizeIsValid(size))\n\t\telog(ERROR, \"invalid memory alloc request size %zu\", size);\n\n\tcontext->isReset = false;\n\n\tret = context->methods->alloc(context, size);\n\tif (unlikely(ret == NULL))\n\t{\n\t\tMemoryContextStats(TopMemoryContext);\n\t\tereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_OUT_OF_MEMORY),\n\t\t\t\t errmsg(\"out of memory\"),\n\t\t\t\t errdetail(\"Failed on request of size %zu in memory context \\\"%s\\\".\",\n\t\t\t\t\t\t   size, context->name)));\n\t}\n\n\tVALGRIND_MEMPOOL_ALLOC(context, ret, size);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SRF_FIRSTCALL_INIT",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SRF_IS_FIRSTCALL",
          "args": [],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_backend_idset(PG_FUNCTION_ARGS)\n{\n\tFuncCallContext *funcctx;\n\tint\t\t   *fctx;\n\tint32\t\tresult;\n\n\t/* stuff done only on the first call of the function */\n\tif (SRF_IS_FIRSTCALL())\n\t{\n\t\t/* create a function context for cross-call persistence */\n\t\tfuncctx = SRF_FIRSTCALL_INIT();\n\n\t\tfctx = MemoryContextAlloc(funcctx->multi_call_memory_ctx,\n\t\t\t\t\t\t\t\t  2 * sizeof(int));\n\t\tfuncctx->user_fctx = fctx;\n\n\t\tfctx[0] = 0;\n\t\tfctx[1] = pgstat_fetch_stat_numbackends();\n\t}\n\n\t/* stuff done on every call of the function */\n\tfuncctx = SRF_PERCALL_SETUP();\n\tfctx = funcctx->user_fctx;\n\n\tfctx[0] += 1;\n\tresult = fctx[0];\n\n\tif (result <= fctx[1])\n\t{\n\t\t/* do when there is more left to send */\n\t\tSRF_RETURN_NEXT(funcctx, Int32GetDatum(result));\n\t}\n\telse\n\t{\n\t\t/* do when there is no more left */\n\t\tSRF_RETURN_DONE(funcctx);\n\t}\n}"
  },
  {
    "function_name": "pg_stat_get_function_self_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "384-394",
    "snippet": "Datum\npg_stat_get_function_self_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_StatFuncEntry *funcentry;\n\n\tif ((funcentry = pgstat_fetch_stat_funcentry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\t/* convert counter from microsec to millisec for display */\n\tPG_RETURN_FLOAT8(((double) funcentry->f_self_time) / 1000.0);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_FLOAT8",
          "args": [
            "((double) funcentry->f_self_time) / 1000.0"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_funcentry",
          "args": [
            "funcid"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_function_self_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_StatFuncEntry *funcentry;\n\n\tif ((funcentry = pgstat_fetch_stat_funcentry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\t/* convert counter from microsec to millisec for display */\n\tPG_RETURN_FLOAT8(((double) funcentry->f_self_time) / 1000.0);\n}"
  },
  {
    "function_name": "pg_stat_get_function_total_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "372-382",
    "snippet": "Datum\npg_stat_get_function_total_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_StatFuncEntry *funcentry;\n\n\tif ((funcentry = pgstat_fetch_stat_funcentry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\t/* convert counter from microsec to millisec for display */\n\tPG_RETURN_FLOAT8(((double) funcentry->f_total_time) / 1000.0);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_FLOAT8",
          "args": [
            "((double) funcentry->f_total_time) / 1000.0"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_funcentry",
          "args": [
            "funcid"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_function_total_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_StatFuncEntry *funcentry;\n\n\tif ((funcentry = pgstat_fetch_stat_funcentry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\t/* convert counter from microsec to millisec for display */\n\tPG_RETURN_FLOAT8(((double) funcentry->f_total_time) / 1000.0);\n}"
  },
  {
    "function_name": "pg_stat_get_function_calls",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "361-370",
    "snippet": "Datum\npg_stat_get_function_calls(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_StatFuncEntry *funcentry;\n\n\tif ((funcentry = pgstat_fetch_stat_funcentry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_INT64(funcentry->f_numcalls);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "funcentry->f_numcalls"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_funcentry",
          "args": [
            "funcid"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_function_calls(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\tfuncid = PG_GETARG_OID(0);\n\tPgStat_StatFuncEntry *funcentry;\n\n\tif ((funcentry = pgstat_fetch_stat_funcentry(funcid)) == NULL)\n\t\tPG_RETURN_NULL();\n\tPG_RETURN_INT64(funcentry->f_numcalls);\n}"
  },
  {
    "function_name": "pg_stat_get_autoanalyze_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "346-359",
    "snippet": "Datum\npg_stat_get_autoanalyze_count(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->autovac_analyze_count);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->autovac_analyze_count"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_autoanalyze_count(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->autovac_analyze_count);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_analyze_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "331-344",
    "snippet": "Datum\npg_stat_get_analyze_count(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->analyze_count);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->analyze_count"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_analyze_count(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->analyze_count);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_autovacuum_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "316-329",
    "snippet": "Datum\npg_stat_get_autovacuum_count(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->autovac_vacuum_count);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->autovac_vacuum_count"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_autovacuum_count(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->autovac_vacuum_count);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_vacuum_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "301-314",
    "snippet": "Datum\npg_stat_get_vacuum_count(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->vacuum_count);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->vacuum_count"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_vacuum_count(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->vacuum_count);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_last_autoanalyze_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "283-299",
    "snippet": "Datum\npg_stat_get_last_autoanalyze_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tTimestampTz result;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = tabentry->autovac_analyze_timestamp;\n\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\telse\n\t\tPG_RETURN_TIMESTAMPTZ(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TIMESTAMPTZ",
          "args": [
            "result"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_last_autoanalyze_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tTimestampTz result;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = tabentry->autovac_analyze_timestamp;\n\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\telse\n\t\tPG_RETURN_TIMESTAMPTZ(result);\n}"
  },
  {
    "function_name": "pg_stat_get_last_analyze_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "265-281",
    "snippet": "Datum\npg_stat_get_last_analyze_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tTimestampTz result;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = tabentry->analyze_timestamp;\n\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\telse\n\t\tPG_RETURN_TIMESTAMPTZ(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TIMESTAMPTZ",
          "args": [
            "result"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_last_analyze_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tTimestampTz result;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = tabentry->analyze_timestamp;\n\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\telse\n\t\tPG_RETURN_TIMESTAMPTZ(result);\n}"
  },
  {
    "function_name": "pg_stat_get_last_autovacuum_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "247-263",
    "snippet": "Datum\npg_stat_get_last_autovacuum_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tTimestampTz result;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = tabentry->autovac_vacuum_timestamp;\n\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\telse\n\t\tPG_RETURN_TIMESTAMPTZ(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TIMESTAMPTZ",
          "args": [
            "result"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_last_autovacuum_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tTimestampTz result;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = tabentry->autovac_vacuum_timestamp;\n\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\telse\n\t\tPG_RETURN_TIMESTAMPTZ(result);\n}"
  },
  {
    "function_name": "pg_stat_get_last_vacuum_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "229-245",
    "snippet": "Datum\npg_stat_get_last_vacuum_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tTimestampTz result;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = tabentry->vacuum_timestamp;\n\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\telse\n\t\tPG_RETURN_TIMESTAMPTZ(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_TIMESTAMPTZ",
          "args": [
            "result"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_RETURN_NULL",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_last_vacuum_time(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tTimestampTz result;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = tabentry->vacuum_timestamp;\n\n\tif (result == 0)\n\t\tPG_RETURN_NULL();\n\telse\n\t\tPG_RETURN_TIMESTAMPTZ(result);\n}"
  },
  {
    "function_name": "pg_stat_get_blocks_hit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "214-227",
    "snippet": "Datum\npg_stat_get_blocks_hit(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->blocks_hit);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->blocks_hit"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_blocks_hit(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->blocks_hit);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_blocks_fetched",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "198-211",
    "snippet": "Datum\npg_stat_get_blocks_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->blocks_fetched);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->blocks_fetched"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_blocks_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->blocks_fetched);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_mod_since_analyze",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "182-195",
    "snippet": "Datum\npg_stat_get_mod_since_analyze(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->changes_since_analyze);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->changes_since_analyze"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_mod_since_analyze(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->changes_since_analyze);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_dead_tuples",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "166-179",
    "snippet": "Datum\npg_stat_get_dead_tuples(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->n_dead_tuples);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->n_dead_tuples"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_dead_tuples(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->n_dead_tuples);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_live_tuples",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "150-163",
    "snippet": "Datum\npg_stat_get_live_tuples(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->n_live_tuples);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->n_live_tuples"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_live_tuples(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->n_live_tuples);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_tuples_hot_updated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "134-147",
    "snippet": "Datum\npg_stat_get_tuples_hot_updated(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_hot_updated);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->tuples_hot_updated"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_tuples_hot_updated(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_hot_updated);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_tuples_deleted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "118-131",
    "snippet": "Datum\npg_stat_get_tuples_deleted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_deleted);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->tuples_deleted"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_tuples_deleted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_deleted);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_tuples_updated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "102-115",
    "snippet": "Datum\npg_stat_get_tuples_updated(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_updated);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->tuples_updated"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_tuples_updated(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_updated);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_tuples_inserted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "86-99",
    "snippet": "Datum\npg_stat_get_tuples_inserted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_inserted);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->tuples_inserted"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_tuples_inserted(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_inserted);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_tuples_fetched",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "70-83",
    "snippet": "Datum\npg_stat_get_tuples_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_fetched);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->tuples_fetched"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_tuples_fetched(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_fetched);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_tuples_returned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "54-67",
    "snippet": "Datum\npg_stat_get_tuples_returned(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_returned);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->tuples_returned"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_tuples_returned(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->tuples_returned);\n\n\tPG_RETURN_INT64(result);\n}"
  },
  {
    "function_name": "pg_stat_get_numscans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2019-10128/repo/src/backend/utils/adt/pgstatfuncs.c",
    "lines": "38-51",
    "snippet": "Datum\npg_stat_get_numscans(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->numscans);\n\n\tPG_RETURN_INT64(result);\n}",
    "includes": [
      "#include \"utils/timestamp.h\"",
      "#include \"utils/inet.h\"",
      "#include \"utils/builtins.h\"",
      "#include \"utils/acl.h\"",
      "#include \"storage/procarray.h\"",
      "#include \"storage/proc.h\"",
      "#include \"postmaster/postmaster.h\"",
      "#include \"postmaster/bgworker_internals.h\"",
      "#include \"pgstat.h\"",
      "#include \"miscadmin.h\"",
      "#include \"funcapi.h\"",
      "#include \"common/ip.h\"",
      "#include \"catalog/pg_type.h\"",
      "#include \"catalog/pg_authid.h\"",
      "#include \"access/htup_details.h\"",
      "#include \"postgres.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PG_RETURN_INT64",
          "args": [
            "result"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "tabentry->numscans"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgstat_fetch_stat_tabentry",
          "args": [
            "relid"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PG_GETARG_OID",
          "args": [
            "0"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils/timestamp.h\"\n#include \"utils/inet.h\"\n#include \"utils/builtins.h\"\n#include \"utils/acl.h\"\n#include \"storage/procarray.h\"\n#include \"storage/proc.h\"\n#include \"postmaster/postmaster.h\"\n#include \"postmaster/bgworker_internals.h\"\n#include \"pgstat.h\"\n#include \"miscadmin.h\"\n#include \"funcapi.h\"\n#include \"common/ip.h\"\n#include \"catalog/pg_type.h\"\n#include \"catalog/pg_authid.h\"\n#include \"access/htup_details.h\"\n#include \"postgres.h\"\n\nDatum\npg_stat_get_numscans(PG_FUNCTION_ARGS)\n{\n\tOid\t\t\trelid = PG_GETARG_OID(0);\n\tint64\t\tresult;\n\tPgStat_StatTabEntry *tabentry;\n\n\tif ((tabentry = pgstat_fetch_stat_tabentry(relid)) == NULL)\n\t\tresult = 0;\n\telse\n\t\tresult = (int64) (tabentry->numscans);\n\n\tPG_RETURN_INT64(result);\n}"
  }
]