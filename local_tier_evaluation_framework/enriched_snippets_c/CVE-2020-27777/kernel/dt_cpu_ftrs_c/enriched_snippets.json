[
  {
    "function_name": "dt_cpu_ftrs_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "1131-1137",
    "snippet": "void __init dt_cpu_ftrs_scan(void)\n{\n\tif (!using_dt_cpu_ftrs)\n\t\treturn;\n\n\tof_scan_flat_dt(dt_cpu_ftrs_scan_callback, NULL);\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_scan_flat_dt",
          "args": [
            "dt_cpu_ftrs_scan_callback",
            "NULL"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nvoid __init dt_cpu_ftrs_scan(void)\n{\n\tif (!using_dt_cpu_ftrs)\n\t\treturn;\n\n\tof_scan_flat_dt(dt_cpu_ftrs_scan_callback, NULL);\n}"
  },
  {
    "function_name": "dt_cpu_ftrs_scan_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "1076-1129",
    "snippet": "static int __init dt_cpu_ftrs_scan_callback(unsigned long node, const char\n\t\t\t\t\t    *uname, int depth, void *data)\n{\n\tconst __be32 *prop;\n\tint count, i;\n\tu32 isa;\n\n\t/* We are scanning \"ibm,powerpc-cpu-features\" nodes only */\n\tif (!of_flat_dt_is_compatible(node, \"ibm,powerpc-cpu-features\"))\n\t\treturn 0;\n\n\tprop = of_get_flat_dt_prop(node, \"isa\", NULL);\n\tif (!prop)\n\t\t/* We checked before, \"can't happen\" */\n\t\treturn 0;\n\n\tisa = be32_to_cpup(prop);\n\n\t/* Count and allocate space for cpu features */\n\tof_scan_flat_dt_subnodes(node, count_cpufeatures_subnodes,\n\t\t\t\t\t\t&nr_dt_cpu_features);\n\tdt_cpu_features = memblock_alloc(sizeof(struct dt_cpu_feature) * nr_dt_cpu_features, PAGE_SIZE);\n\tif (!dt_cpu_features)\n\t\tpanic(\"%s: Failed to allocate %zu bytes align=0x%lx\\n\",\n\t\t      __func__,\n\t\t      sizeof(struct dt_cpu_feature) * nr_dt_cpu_features,\n\t\t      PAGE_SIZE);\n\n\tcpufeatures_setup_start(isa);\n\n\t/* Scan nodes into dt_cpu_features and enable those without deps  */\n\tcount = 0;\n\tof_scan_flat_dt_subnodes(node, scan_cpufeatures_subnodes, &count);\n\n\t/* Recursive enable remaining features with dependencies */\n\tfor (i = 0; i < nr_dt_cpu_features; i++) {\n\t\tstruct dt_cpu_feature *f = &dt_cpu_features[i];\n\n\t\tcpufeatures_deps_enable(f);\n\t}\n\n\tprop = of_get_flat_dt_prop(node, \"display-name\", NULL);\n\tif (prop && strlen((char *)prop) != 0) {\n\t\tstrlcpy(dt_cpu_name, (char *)prop, sizeof(dt_cpu_name));\n\t\tcur_cpu_spec->cpu_name = dt_cpu_name;\n\t}\n\n\tcpufeatures_setup_finished();\n\n\tmemblock_free(__pa(dt_cpu_features),\n\t\t\tsizeof(struct dt_cpu_feature)*nr_dt_cpu_features);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char dt_cpu_name[64];",
      "static int nr_dt_cpu_features;",
      "static struct dt_cpu_feature *dt_cpu_features;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memblock_free",
          "args": [
            "__pa(dt_cpu_features)",
            "sizeof(struct dt_cpu_feature)*nr_dt_cpu_features"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "dt_cpu_features"
          ],
          "line": 1125
        },
        "resolved": true,
        "details": {
          "function_name": "__parse_fpscr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/traps.c",
          "lines": "1164-1189",
          "snippet": "static inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/nmi.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/kprobes.h>",
            "#include <sysdev/fsl_pci.h>",
            "#include <asm/hmi.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rio.h>",
            "#include <asm/ppc-opcode.h>",
            "#include <asm/kexec.h>",
            "#include <asm/tm.h>",
            "#include <asm/processor.h>",
            "#include <asm/firmware.h>",
            "#include <asm/backlight.h>",
            "#include <asm/reg.h>",
            "#include <asm/pmc.h>",
            "#include <asm/rtas.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/emulated_ops.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/console.h>",
            "#include <linux/smp.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/bug.h>",
            "#include <linux/backlight.h>",
            "#include <linux/kexec.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/delay.h>",
            "#include <linux/prctl.h>",
            "#include <linux/module.h>\t/* print_modules */",
            "#include <linux/extable.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/user.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/nmi.h>\n#include <asm/stacktrace.h>\n#include <asm/kprobes.h>\n#include <sysdev/fsl_pci.h>\n#include <asm/hmi.h>\n#include <asm/asm-prototypes.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/fadump.h>\n#include <asm/rio.h>\n#include <asm/ppc-opcode.h>\n#include <asm/kexec.h>\n#include <asm/tm.h>\n#include <asm/processor.h>\n#include <asm/firmware.h>\n#include <asm/backlight.h>\n#include <asm/reg.h>\n#include <asm/pmc.h>\n#include <asm/rtas.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/uaccess.h>\n#include <asm/emulated_ops.h>\n#include <linux/kmsg_dump.h>\n#include <linux/console.h>\n#include <linux/smp.h>\n#include <linux/context_tracking.h>\n#include <linux/ratelimit.h>\n#include <linux/kdebug.h>\n#include <linux/bug.h>\n#include <linux/backlight.h>\n#include <linux/kexec.h>\n#include <linux/kprobes.h>\n#include <linux/delay.h>\n#include <linux/prctl.h>\n#include <linux/module.h>\t/* print_modules */\n#include <linux/extable.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/user.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/pkeys.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpufeatures_setup_finished",
          "args": [],
          "line": 1123
        },
        "resolved": true,
        "details": {
          "function_name": "cpufeatures_setup_finished",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "816-835",
          "snippet": "static void __init cpufeatures_setup_finished(void)\n{\n\tcpufeatures_cpu_quirks();\n\n\tif (hv_mode && !(cur_cpu_spec->cpu_features & CPU_FTR_HVMODE)) {\n\t\tpr_err(\"hypervisor not present in device tree but HV mode is enabled in the CPU. Enabling.\\n\");\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_HVMODE;\n\t}\n\n\t/* Make sure powerpc_base_platform is non-NULL */\n\tpowerpc_base_platform = cur_cpu_spec->platform;\n\n\tsystem_registers.lpcr = mfspr(SPRN_LPCR);\n\tsystem_registers.hfscr = mfspr(SPRN_HFSCR);\n\tsystem_registers.fscr = mfspr(SPRN_FSCR);\n\tsystem_registers.pcr = mfspr(SPRN_PCR);\n\n\tpr_info(\"final cpu/mmu features = 0x%016lx 0x%08x\\n\",\n\t\tcur_cpu_spec->cpu_features, cur_cpu_spec->mmu_features);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int hv_mode;",
            "static struct {\n\tu64\tlpcr;\n\tu64\tlpcr_clear;\n\tu64\thfscr;\n\tu64\tfscr;\n\tu64\tpcr;\n} system_registers;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\nstatic struct {\n\tu64\tlpcr;\n\tu64\tlpcr_clear;\n\tu64\thfscr;\n\tu64\tfscr;\n\tu64\tpcr;\n} system_registers;\n\nstatic void __init cpufeatures_setup_finished(void)\n{\n\tcpufeatures_cpu_quirks();\n\n\tif (hv_mode && !(cur_cpu_spec->cpu_features & CPU_FTR_HVMODE)) {\n\t\tpr_err(\"hypervisor not present in device tree but HV mode is enabled in the CPU. Enabling.\\n\");\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_HVMODE;\n\t}\n\n\t/* Make sure powerpc_base_platform is non-NULL */\n\tpowerpc_base_platform = cur_cpu_spec->platform;\n\n\tsystem_registers.lpcr = mfspr(SPRN_LPCR);\n\tsystem_registers.hfscr = mfspr(SPRN_HFSCR);\n\tsystem_registers.fscr = mfspr(SPRN_FSCR);\n\tsystem_registers.pcr = mfspr(SPRN_PCR);\n\n\tpr_info(\"final cpu/mmu features = 0x%016lx 0x%08x\\n\",\n\t\tcur_cpu_spec->cpu_features, cur_cpu_spec->mmu_features);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "dt_cpu_name",
            "(char *)prop",
            "sizeof(dt_cpu_name)"
          ],
          "line": 1119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "(char *)prop"
          ],
          "line": 1118
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"display-name\"",
            "NULL"
          ],
          "line": 1117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpufeatures_deps_enable",
          "args": [
            "f"
          ],
          "line": 1114
        },
        "resolved": true,
        "details": {
          "function_name": "cpufeatures_deps_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "1011-1050",
          "snippet": "static void __init cpufeatures_deps_enable(struct dt_cpu_feature *f)\n{\n\tconst __be32 *prop;\n\tint len;\n\tint nr_deps;\n\tint i;\n\n\tif (f->enabled || f->disabled)\n\t\treturn;\n\n\tprop = of_get_flat_dt_prop(f->node, \"dependencies\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing dependencies property\", f->name);\n\t\treturn;\n\t}\n\n\tnr_deps = len / sizeof(int);\n\n\tfor (i = 0; i < nr_deps; i++) {\n\t\tunsigned long phandle = be32_to_cpu(prop[i]);\n\t\tint j;\n\n\t\tfor (j = 0; j < nr_dt_cpu_features; j++) {\n\t\t\tstruct dt_cpu_feature *d = &dt_cpu_features[j];\n\n\t\t\tif (of_get_flat_dt_phandle(d->node) == phandle) {\n\t\t\t\tcpufeatures_deps_enable(d);\n\t\t\t\tif (d->disabled) {\n\t\t\t\t\tf->disabled = 1;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (cpufeatures_process_feature(f))\n\t\tf->enabled = 1;\n\telse\n\t\tf->disabled = 1;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nr_dt_cpu_features;",
            "static struct dt_cpu_feature *dt_cpu_features;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int nr_dt_cpu_features;\nstatic struct dt_cpu_feature *dt_cpu_features;\n\nstatic void __init cpufeatures_deps_enable(struct dt_cpu_feature *f)\n{\n\tconst __be32 *prop;\n\tint len;\n\tint nr_deps;\n\tint i;\n\n\tif (f->enabled || f->disabled)\n\t\treturn;\n\n\tprop = of_get_flat_dt_prop(f->node, \"dependencies\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing dependencies property\", f->name);\n\t\treturn;\n\t}\n\n\tnr_deps = len / sizeof(int);\n\n\tfor (i = 0; i < nr_deps; i++) {\n\t\tunsigned long phandle = be32_to_cpu(prop[i]);\n\t\tint j;\n\n\t\tfor (j = 0; j < nr_dt_cpu_features; j++) {\n\t\t\tstruct dt_cpu_feature *d = &dt_cpu_features[j];\n\n\t\t\tif (of_get_flat_dt_phandle(d->node) == phandle) {\n\t\t\t\tcpufeatures_deps_enable(d);\n\t\t\t\tif (d->disabled) {\n\t\t\t\t\tf->disabled = 1;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (cpufeatures_process_feature(f))\n\t\tf->enabled = 1;\n\telse\n\t\tf->disabled = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_scan_flat_dt_subnodes",
          "args": [
            "node",
            "scan_cpufeatures_subnodes",
            "&count"
          ],
          "line": 1108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpufeatures_setup_start",
          "args": [
            "isa"
          ],
          "line": 1104
        },
        "resolved": true,
        "details": {
          "function_name": "cpufeatures_setup_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "708-721",
          "snippet": "static void __init cpufeatures_setup_start(u32 isa)\n{\n\tpr_info(\"setup for ISA %d\\n\", isa);\n\n\tif (isa >= ISA_V3_0B) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_ARCH_300;\n\t\tcur_cpu_spec->cpu_user_features2 |= PPC_FEATURE2_ARCH_3_00;\n\t}\n\n\tif (isa >= ISA_V3_1) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_ARCH_31;\n\t\tcur_cpu_spec->cpu_user_features2 |= PPC_FEATURE2_ARCH_3_1;\n\t}\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define ISA_V3_1        3100",
            "#define ISA_V3_0B       3000"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\n#define ISA_V3_1        3100\n#define ISA_V3_0B       3000\n\nstatic void __init cpufeatures_setup_start(u32 isa)\n{\n\tpr_info(\"setup for ISA %d\\n\", isa);\n\n\tif (isa >= ISA_V3_0B) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_ARCH_300;\n\t\tcur_cpu_spec->cpu_user_features2 |= PPC_FEATURE2_ARCH_3_00;\n\t}\n\n\tif (isa >= ISA_V3_1) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_ARCH_31;\n\t\tcur_cpu_spec->cpu_user_features2 |= PPC_FEATURE2_ARCH_3_1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"%s: Failed to allocate %zu bytes align=0x%lx\\n\"",
            "__func__",
            "sizeof(struct dt_cpu_feature) * nr_dt_cpu_features",
            "PAGE_SIZE"
          ],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "sizeof(struct dt_cpu_feature) * nr_dt_cpu_features",
            "PAGE_SIZE"
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_scan_flat_dt_subnodes",
          "args": [
            "node",
            "count_cpufeatures_subnodes",
            "&nr_dt_cpu_features"
          ],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "prop"
          ],
          "line": 1092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"isa\"",
            "NULL"
          ],
          "line": 1087
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_flat_dt_is_compatible",
          "args": [
            "node",
            "\"ibm,powerpc-cpu-features\""
          ],
          "line": 1084
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic char dt_cpu_name[64];\nstatic int nr_dt_cpu_features;\nstatic struct dt_cpu_feature *dt_cpu_features;\n\nstatic int __init dt_cpu_ftrs_scan_callback(unsigned long node, const char\n\t\t\t\t\t    *uname, int depth, void *data)\n{\n\tconst __be32 *prop;\n\tint count, i;\n\tu32 isa;\n\n\t/* We are scanning \"ibm,powerpc-cpu-features\" nodes only */\n\tif (!of_flat_dt_is_compatible(node, \"ibm,powerpc-cpu-features\"))\n\t\treturn 0;\n\n\tprop = of_get_flat_dt_prop(node, \"isa\", NULL);\n\tif (!prop)\n\t\t/* We checked before, \"can't happen\" */\n\t\treturn 0;\n\n\tisa = be32_to_cpup(prop);\n\n\t/* Count and allocate space for cpu features */\n\tof_scan_flat_dt_subnodes(node, count_cpufeatures_subnodes,\n\t\t\t\t\t\t&nr_dt_cpu_features);\n\tdt_cpu_features = memblock_alloc(sizeof(struct dt_cpu_feature) * nr_dt_cpu_features, PAGE_SIZE);\n\tif (!dt_cpu_features)\n\t\tpanic(\"%s: Failed to allocate %zu bytes align=0x%lx\\n\",\n\t\t      __func__,\n\t\t      sizeof(struct dt_cpu_feature) * nr_dt_cpu_features,\n\t\t      PAGE_SIZE);\n\n\tcpufeatures_setup_start(isa);\n\n\t/* Scan nodes into dt_cpu_features and enable those without deps  */\n\tcount = 0;\n\tof_scan_flat_dt_subnodes(node, scan_cpufeatures_subnodes, &count);\n\n\t/* Recursive enable remaining features with dependencies */\n\tfor (i = 0; i < nr_dt_cpu_features; i++) {\n\t\tstruct dt_cpu_feature *f = &dt_cpu_features[i];\n\n\t\tcpufeatures_deps_enable(f);\n\t}\n\n\tprop = of_get_flat_dt_prop(node, \"display-name\", NULL);\n\tif (prop && strlen((char *)prop) != 0) {\n\t\tstrlcpy(dt_cpu_name, (char *)prop, sizeof(dt_cpu_name));\n\t\tcur_cpu_spec->cpu_name = dt_cpu_name;\n\t}\n\n\tcpufeatures_setup_finished();\n\n\tmemblock_free(__pa(dt_cpu_features),\n\t\t\tsizeof(struct dt_cpu_feature)*nr_dt_cpu_features);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "count_cpufeatures_subnodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "1065-1074",
    "snippet": "static int __init count_cpufeatures_subnodes(unsigned long node,\n\t\t\t\t\t  const char *uname,\n\t\t\t\t\t  void *data)\n{\n\tint *count = data;\n\n\t(*count)++;\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init count_cpufeatures_subnodes(unsigned long node,\n\t\t\t\t\t  const char *uname,\n\t\t\t\t\t  void *data)\n{\n\tint *count = data;\n\n\t(*count)++;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "scan_cpufeatures_subnodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "1052-1063",
    "snippet": "static int __init scan_cpufeatures_subnodes(unsigned long node,\n\t\t\t\t\t  const char *uname,\n\t\t\t\t\t  void *data)\n{\n\tint *count = data;\n\n\tprocess_cpufeatures_node(node, uname, *count);\n\n\t(*count)++;\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "process_cpufeatures_node",
          "args": [
            "node",
            "uname",
            "*count"
          ],
          "line": 1058
        },
        "resolved": true,
        "details": {
          "function_name": "process_cpufeatures_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "895-1009",
          "snippet": "static int __init process_cpufeatures_node(unsigned long node,\n\t\t\t\t\t  const char *uname, int i)\n{\n\tconst __be32 *prop;\n\tstruct dt_cpu_feature *f;\n\tint len;\n\n\tf = &dt_cpu_features[i];\n\n\tf->node = node;\n\n\tf->name = uname;\n\n\tprop = of_get_flat_dt_prop(node, \"isa\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing isa property\\n\", uname);\n\t\treturn 0;\n\t}\n\tf->isa = be32_to_cpup(prop);\n\n\tprop = of_get_flat_dt_prop(node, \"usable-privilege\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing usable-privilege property\", uname);\n\t\treturn 0;\n\t}\n\tf->usable_privilege = be32_to_cpup(prop);\n\n\tprop = of_get_flat_dt_prop(node, \"hv-support\", &len);\n\tif (prop)\n\t\tf->hv_support = be32_to_cpup(prop);\n\telse\n\t\tf->hv_support = HV_SUPPORT_NONE;\n\n\tprop = of_get_flat_dt_prop(node, \"os-support\", &len);\n\tif (prop)\n\t\tf->os_support = be32_to_cpup(prop);\n\telse\n\t\tf->os_support = OS_SUPPORT_NONE;\n\n\tprop = of_get_flat_dt_prop(node, \"hfscr-bit-nr\", &len);\n\tif (prop)\n\t\tf->hfscr_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->hfscr_bit_nr = -1;\n\tprop = of_get_flat_dt_prop(node, \"fscr-bit-nr\", &len);\n\tif (prop)\n\t\tf->fscr_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->fscr_bit_nr = -1;\n\tprop = of_get_flat_dt_prop(node, \"hwcap-bit-nr\", &len);\n\tif (prop)\n\t\tf->hwcap_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->hwcap_bit_nr = -1;\n\n\tif (f->usable_privilege & USABLE_HV) {\n\t\tif (!(mfmsr() & MSR_HV)) {\n\t\t\tpr_warn(\"%s: HV feature passed to guest\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->hv_support == HV_SUPPORT_NONE && f->hfscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hfscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->hv_support == HV_SUPPORT_HFSCR) {\n\t\t\tif (f->hfscr_bit_nr == -1) {\n\t\t\t\tpr_warn(\"%s: missing hfscr_bit_nr\\n\", uname);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (f->hv_support != HV_SUPPORT_NONE || f->hfscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hv_support/hfscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tif (f->usable_privilege & USABLE_OS) {\n\t\tif (f->os_support == OS_SUPPORT_NONE && f->fscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted fscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->os_support == OS_SUPPORT_FSCR) {\n\t\t\tif (f->fscr_bit_nr == -1) {\n\t\t\t\tpr_warn(\"%s: missing fscr_bit_nr\\n\", uname);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (f->os_support != OS_SUPPORT_NONE || f->fscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted os_support/fscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tif (!(f->usable_privilege & USABLE_PR)) {\n\t\tif (f->hwcap_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hwcap_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\t/* Do all the independent features in the first pass */\n\tif (!of_get_flat_dt_prop(node, \"dependencies\", &len)) {\n\t\tif (cpufeatures_process_feature(f))\n\t\t\tf->enabled = 1;\n\t\telse\n\t\t\tf->disabled = 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define OS_SUPPORT_NONE\t\t0xffffffffU",
            "#define HV_SUPPORT_NONE\t\t0xffffffffU",
            "#define OS_SUPPORT_FSCR         (1U << 0)",
            "#define HV_SUPPORT_HFSCR        (1U << 0)",
            "#define USABLE_HV               (1U << 2)",
            "#define USABLE_OS               (1U << 1)",
            "#define USABLE_PR               (1U << 0)"
          ],
          "globals_used": [
            "static struct dt_cpu_feature *dt_cpu_features;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\n#define OS_SUPPORT_NONE\t\t0xffffffffU\n#define HV_SUPPORT_NONE\t\t0xffffffffU\n#define OS_SUPPORT_FSCR         (1U << 0)\n#define HV_SUPPORT_HFSCR        (1U << 0)\n#define USABLE_HV               (1U << 2)\n#define USABLE_OS               (1U << 1)\n#define USABLE_PR               (1U << 0)\n\nstatic struct dt_cpu_feature *dt_cpu_features;\n\nstatic int __init process_cpufeatures_node(unsigned long node,\n\t\t\t\t\t  const char *uname, int i)\n{\n\tconst __be32 *prop;\n\tstruct dt_cpu_feature *f;\n\tint len;\n\n\tf = &dt_cpu_features[i];\n\n\tf->node = node;\n\n\tf->name = uname;\n\n\tprop = of_get_flat_dt_prop(node, \"isa\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing isa property\\n\", uname);\n\t\treturn 0;\n\t}\n\tf->isa = be32_to_cpup(prop);\n\n\tprop = of_get_flat_dt_prop(node, \"usable-privilege\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing usable-privilege property\", uname);\n\t\treturn 0;\n\t}\n\tf->usable_privilege = be32_to_cpup(prop);\n\n\tprop = of_get_flat_dt_prop(node, \"hv-support\", &len);\n\tif (prop)\n\t\tf->hv_support = be32_to_cpup(prop);\n\telse\n\t\tf->hv_support = HV_SUPPORT_NONE;\n\n\tprop = of_get_flat_dt_prop(node, \"os-support\", &len);\n\tif (prop)\n\t\tf->os_support = be32_to_cpup(prop);\n\telse\n\t\tf->os_support = OS_SUPPORT_NONE;\n\n\tprop = of_get_flat_dt_prop(node, \"hfscr-bit-nr\", &len);\n\tif (prop)\n\t\tf->hfscr_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->hfscr_bit_nr = -1;\n\tprop = of_get_flat_dt_prop(node, \"fscr-bit-nr\", &len);\n\tif (prop)\n\t\tf->fscr_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->fscr_bit_nr = -1;\n\tprop = of_get_flat_dt_prop(node, \"hwcap-bit-nr\", &len);\n\tif (prop)\n\t\tf->hwcap_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->hwcap_bit_nr = -1;\n\n\tif (f->usable_privilege & USABLE_HV) {\n\t\tif (!(mfmsr() & MSR_HV)) {\n\t\t\tpr_warn(\"%s: HV feature passed to guest\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->hv_support == HV_SUPPORT_NONE && f->hfscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hfscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->hv_support == HV_SUPPORT_HFSCR) {\n\t\t\tif (f->hfscr_bit_nr == -1) {\n\t\t\t\tpr_warn(\"%s: missing hfscr_bit_nr\\n\", uname);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (f->hv_support != HV_SUPPORT_NONE || f->hfscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hv_support/hfscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tif (f->usable_privilege & USABLE_OS) {\n\t\tif (f->os_support == OS_SUPPORT_NONE && f->fscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted fscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->os_support == OS_SUPPORT_FSCR) {\n\t\t\tif (f->fscr_bit_nr == -1) {\n\t\t\t\tpr_warn(\"%s: missing fscr_bit_nr\\n\", uname);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (f->os_support != OS_SUPPORT_NONE || f->fscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted os_support/fscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tif (!(f->usable_privilege & USABLE_PR)) {\n\t\tif (f->hwcap_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hwcap_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\t/* Do all the independent features in the first pass */\n\tif (!of_get_flat_dt_prop(node, \"dependencies\", &len)) {\n\t\tif (cpufeatures_process_feature(f))\n\t\t\tf->enabled = 1;\n\t\telse\n\t\t\tf->disabled = 1;\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init scan_cpufeatures_subnodes(unsigned long node,\n\t\t\t\t\t  const char *uname,\n\t\t\t\t\t  void *data)\n{\n\tint *count = data;\n\n\tprocess_cpufeatures_node(node, uname, *count);\n\n\t(*count)++;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cpufeatures_deps_enable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "1011-1050",
    "snippet": "static void __init cpufeatures_deps_enable(struct dt_cpu_feature *f)\n{\n\tconst __be32 *prop;\n\tint len;\n\tint nr_deps;\n\tint i;\n\n\tif (f->enabled || f->disabled)\n\t\treturn;\n\n\tprop = of_get_flat_dt_prop(f->node, \"dependencies\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing dependencies property\", f->name);\n\t\treturn;\n\t}\n\n\tnr_deps = len / sizeof(int);\n\n\tfor (i = 0; i < nr_deps; i++) {\n\t\tunsigned long phandle = be32_to_cpu(prop[i]);\n\t\tint j;\n\n\t\tfor (j = 0; j < nr_dt_cpu_features; j++) {\n\t\t\tstruct dt_cpu_feature *d = &dt_cpu_features[j];\n\n\t\t\tif (of_get_flat_dt_phandle(d->node) == phandle) {\n\t\t\t\tcpufeatures_deps_enable(d);\n\t\t\t\tif (d->disabled) {\n\t\t\t\t\tf->disabled = 1;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (cpufeatures_process_feature(f))\n\t\tf->enabled = 1;\n\telse\n\t\tf->disabled = 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nr_dt_cpu_features;",
      "static struct dt_cpu_feature *dt_cpu_features;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpufeatures_process_feature",
          "args": [
            "f"
          ],
          "line": 1046
        },
        "resolved": true,
        "details": {
          "function_name": "cpufeatures_process_feature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "723-756",
          "snippet": "static bool __init cpufeatures_process_feature(struct dt_cpu_feature *f)\n{\n\tconst struct dt_cpu_feature_match *m;\n\tbool known = false;\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(dt_cpu_feature_match_table); i++) {\n\t\tm = &dt_cpu_feature_match_table[i];\n\t\tif (!strcmp(f->name, m->name)) {\n\t\t\tknown = true;\n\t\t\tif (m->enable(f)) {\n\t\t\t\tcur_cpu_spec->cpu_features |= m->cpu_ftr_bit_mask;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpr_info(\"not enabling: %s (disabled or unsupported by kernel)\\n\",\n\t\t\t\tf->name);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tif (!known && (!enable_unknown || !feat_try_enable_unknown(f))) {\n\t\tpr_info(\"not enabling: %s (unknown and unsupported by kernel)\\n\",\n\t\t\tf->name);\n\t\treturn false;\n\t}\n\n\tif (known)\n\t\tpr_debug(\"enabling: %s\\n\", f->name);\n\telse\n\t\tpr_debug(\"enabling: %s (unknown)\\n\", f->name);\n\n\treturn true;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dt_cpu_feature_match __initdata\n\t\tdt_cpu_feature_match_table[] = {\n\t{\"hypervisor\", feat_enable_hv, 0},\n\t{\"big-endian\", feat_enable, 0},\n\t{\"little-endian\", feat_enable_le, CPU_FTR_REAL_LE},\n\t{\"smt\", feat_enable_smt, 0},\n\t{\"interrupt-facilities\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_enable, 0},\n\t{\"timer-facilities\", feat_enable, 0},\n\t{\"timer-facilities-v3\", feat_enable, 0},\n\t{\"debug-facilities\", feat_enable, 0},\n\t{\"come-from-address-register\", feat_enable, CPU_FTR_CFAR},\n\t{\"branch-tracing\", feat_enable, 0},\n\t{\"floating-point\", feat_enable_fp, 0},\n\t{\"vector\", feat_enable_vector, 0},\n\t{\"vector-scalar\", feat_enable_vsx, 0},\n\t{\"vector-scalar-v3\", feat_enable, 0},\n\t{\"decimal-floating-point\", feat_enable, 0},\n\t{\"decimal-integer\", feat_enable, 0},\n\t{\"quadword-load-store\", feat_enable, 0},\n\t{\"vector-crypto\", feat_enable, 0},\n\t{\"mmu-hash\", feat_enable_mmu_hash, 0},\n\t{\"mmu-radix\", feat_enable_mmu_radix, 0},\n\t{\"mmu-hash-v3\", feat_enable_mmu_hash_v3, 0},\n\t{\"virtual-page-class-key-protection\", feat_enable, 0},\n\t{\"transactional-memory\", feat_enable_tm, CPU_FTR_TM},\n\t{\"transactional-memory-v3\", feat_enable_tm, 0},\n\t{\"tm-suspend-hypervisor-assist\", feat_enable, CPU_FTR_P9_TM_HV_ASSIST},\n\t{\"tm-suspend-xer-so-bug\", feat_enable, CPU_FTR_P9_TM_XER_SO_BUG},\n\t{\"idle-nap\", feat_enable_idle_nap, 0},\n\t{\"alignment-interrupt-dsisr\", feat_enable_align_dsisr, 0},\n\t{\"idle-stop\", feat_enable_idle_stop, 0},\n\t{\"machine-check-power8\", feat_enable_mce_power8, 0},\n\t{\"performance-monitor-power8\", feat_enable_pmu_power8, 0},\n\t{\"data-stream-control-register\", feat_enable_dscr, CPU_FTR_DSCR},\n\t{\"event-based-branch\", feat_enable_ebb, 0},\n\t{\"target-address-register\", feat_enable, 0},\n\t{\"branch-history-rolling-buffer\", feat_enable, 0},\n\t{\"control-register\", feat_enable, CPU_FTR_CTRL},\n\t{\"processor-control-facility\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-control-facility-v3\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-utilization-of-resources-register\", feat_enable_purr, 0},\n\t{\"no-execute\", feat_enable, 0},\n\t{\"strong-access-ordering\", feat_enable, CPU_FTR_SAO},\n\t{\"cache-inhibited-large-page\", feat_enable_large_ci, 0},\n\t{\"coprocessor-icswx\", feat_enable, 0},\n\t{\"hypervisor-virtualization-interrupt\", feat_enable_hvi, 0},\n\t{\"program-priority-register\", feat_enable, CPU_FTR_HAS_PPR},\n\t{\"wait\", feat_enable, 0},\n\t{\"atomic-memory-operations\", feat_enable, 0},\n\t{\"branch-v3\", feat_enable, 0},\n\t{\"copy-paste\", feat_enable, 0},\n\t{\"decimal-floating-point-v3\", feat_enable, 0},\n\t{\"decimal-integer-v3\", feat_enable, 0},\n\t{\"fixed-point-v3\", feat_enable, 0},\n\t{\"floating-point-v3\", feat_enable, 0},\n\t{\"group-start-register\", feat_enable, 0},\n\t{\"pc-relative-addressing\", feat_enable, 0},\n\t{\"machine-check-power9\", feat_enable_mce_power9, 0},\n\t{\"machine-check-power10\", feat_enable_mce_power10, 0},\n\t{\"performance-monitor-power9\", feat_enable_pmu_power9, 0},\n\t{\"performance-monitor-power10\", feat_enable_pmu_power10, 0},\n\t{\"event-based-branch-v3\", feat_enable, 0},\n\t{\"random-number-generator\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_disable, 0},\n\t{\"trace-interrupt-v3\", feat_enable, 0},\n\t{\"vector-v3\", feat_enable, 0},\n\t{\"vector-binary128\", feat_enable, 0},\n\t{\"vector-binary16\", feat_enable, 0},\n\t{\"wait-v3\", feat_enable, 0},\n\t{\"prefix-instructions\", feat_enable, 0},\n\t{\"matrix-multiply-assist\", feat_enable_mma, 0},\n\t{\"debug-facilities-v31\", feat_enable, CPU_FTR_DAWR1},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic struct dt_cpu_feature_match __initdata\n\t\tdt_cpu_feature_match_table[] = {\n\t{\"hypervisor\", feat_enable_hv, 0},\n\t{\"big-endian\", feat_enable, 0},\n\t{\"little-endian\", feat_enable_le, CPU_FTR_REAL_LE},\n\t{\"smt\", feat_enable_smt, 0},\n\t{\"interrupt-facilities\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_enable, 0},\n\t{\"timer-facilities\", feat_enable, 0},\n\t{\"timer-facilities-v3\", feat_enable, 0},\n\t{\"debug-facilities\", feat_enable, 0},\n\t{\"come-from-address-register\", feat_enable, CPU_FTR_CFAR},\n\t{\"branch-tracing\", feat_enable, 0},\n\t{\"floating-point\", feat_enable_fp, 0},\n\t{\"vector\", feat_enable_vector, 0},\n\t{\"vector-scalar\", feat_enable_vsx, 0},\n\t{\"vector-scalar-v3\", feat_enable, 0},\n\t{\"decimal-floating-point\", feat_enable, 0},\n\t{\"decimal-integer\", feat_enable, 0},\n\t{\"quadword-load-store\", feat_enable, 0},\n\t{\"vector-crypto\", feat_enable, 0},\n\t{\"mmu-hash\", feat_enable_mmu_hash, 0},\n\t{\"mmu-radix\", feat_enable_mmu_radix, 0},\n\t{\"mmu-hash-v3\", feat_enable_mmu_hash_v3, 0},\n\t{\"virtual-page-class-key-protection\", feat_enable, 0},\n\t{\"transactional-memory\", feat_enable_tm, CPU_FTR_TM},\n\t{\"transactional-memory-v3\", feat_enable_tm, 0},\n\t{\"tm-suspend-hypervisor-assist\", feat_enable, CPU_FTR_P9_TM_HV_ASSIST},\n\t{\"tm-suspend-xer-so-bug\", feat_enable, CPU_FTR_P9_TM_XER_SO_BUG},\n\t{\"idle-nap\", feat_enable_idle_nap, 0},\n\t{\"alignment-interrupt-dsisr\", feat_enable_align_dsisr, 0},\n\t{\"idle-stop\", feat_enable_idle_stop, 0},\n\t{\"machine-check-power8\", feat_enable_mce_power8, 0},\n\t{\"performance-monitor-power8\", feat_enable_pmu_power8, 0},\n\t{\"data-stream-control-register\", feat_enable_dscr, CPU_FTR_DSCR},\n\t{\"event-based-branch\", feat_enable_ebb, 0},\n\t{\"target-address-register\", feat_enable, 0},\n\t{\"branch-history-rolling-buffer\", feat_enable, 0},\n\t{\"control-register\", feat_enable, CPU_FTR_CTRL},\n\t{\"processor-control-facility\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-control-facility-v3\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-utilization-of-resources-register\", feat_enable_purr, 0},\n\t{\"no-execute\", feat_enable, 0},\n\t{\"strong-access-ordering\", feat_enable, CPU_FTR_SAO},\n\t{\"cache-inhibited-large-page\", feat_enable_large_ci, 0},\n\t{\"coprocessor-icswx\", feat_enable, 0},\n\t{\"hypervisor-virtualization-interrupt\", feat_enable_hvi, 0},\n\t{\"program-priority-register\", feat_enable, CPU_FTR_HAS_PPR},\n\t{\"wait\", feat_enable, 0},\n\t{\"atomic-memory-operations\", feat_enable, 0},\n\t{\"branch-v3\", feat_enable, 0},\n\t{\"copy-paste\", feat_enable, 0},\n\t{\"decimal-floating-point-v3\", feat_enable, 0},\n\t{\"decimal-integer-v3\", feat_enable, 0},\n\t{\"fixed-point-v3\", feat_enable, 0},\n\t{\"floating-point-v3\", feat_enable, 0},\n\t{\"group-start-register\", feat_enable, 0},\n\t{\"pc-relative-addressing\", feat_enable, 0},\n\t{\"machine-check-power9\", feat_enable_mce_power9, 0},\n\t{\"machine-check-power10\", feat_enable_mce_power10, 0},\n\t{\"performance-monitor-power9\", feat_enable_pmu_power9, 0},\n\t{\"performance-monitor-power10\", feat_enable_pmu_power10, 0},\n\t{\"event-based-branch-v3\", feat_enable, 0},\n\t{\"random-number-generator\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_disable, 0},\n\t{\"trace-interrupt-v3\", feat_enable, 0},\n\t{\"vector-v3\", feat_enable, 0},\n\t{\"vector-binary128\", feat_enable, 0},\n\t{\"vector-binary16\", feat_enable, 0},\n\t{\"wait-v3\", feat_enable, 0},\n\t{\"prefix-instructions\", feat_enable, 0},\n\t{\"matrix-multiply-assist\", feat_enable_mma, 0},\n\t{\"debug-facilities-v31\", feat_enable, CPU_FTR_DAWR1},\n};\n\nstatic bool __init cpufeatures_process_feature(struct dt_cpu_feature *f)\n{\n\tconst struct dt_cpu_feature_match *m;\n\tbool known = false;\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(dt_cpu_feature_match_table); i++) {\n\t\tm = &dt_cpu_feature_match_table[i];\n\t\tif (!strcmp(f->name, m->name)) {\n\t\t\tknown = true;\n\t\t\tif (m->enable(f)) {\n\t\t\t\tcur_cpu_spec->cpu_features |= m->cpu_ftr_bit_mask;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpr_info(\"not enabling: %s (disabled or unsupported by kernel)\\n\",\n\t\t\t\tf->name);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tif (!known && (!enable_unknown || !feat_try_enable_unknown(f))) {\n\t\tpr_info(\"not enabling: %s (unknown and unsupported by kernel)\\n\",\n\t\t\tf->name);\n\t\treturn false;\n\t}\n\n\tif (known)\n\t\tpr_debug(\"enabling: %s\\n\", f->name);\n\telse\n\t\tpr_debug(\"enabling: %s (unknown)\\n\", f->name);\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpufeatures_deps_enable",
          "args": [
            "d"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "cpufeatures_deps_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "1011-1050",
          "snippet": "static void __init cpufeatures_deps_enable(struct dt_cpu_feature *f)\n{\n\tconst __be32 *prop;\n\tint len;\n\tint nr_deps;\n\tint i;\n\n\tif (f->enabled || f->disabled)\n\t\treturn;\n\n\tprop = of_get_flat_dt_prop(f->node, \"dependencies\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing dependencies property\", f->name);\n\t\treturn;\n\t}\n\n\tnr_deps = len / sizeof(int);\n\n\tfor (i = 0; i < nr_deps; i++) {\n\t\tunsigned long phandle = be32_to_cpu(prop[i]);\n\t\tint j;\n\n\t\tfor (j = 0; j < nr_dt_cpu_features; j++) {\n\t\t\tstruct dt_cpu_feature *d = &dt_cpu_features[j];\n\n\t\t\tif (of_get_flat_dt_phandle(d->node) == phandle) {\n\t\t\t\tcpufeatures_deps_enable(d);\n\t\t\t\tif (d->disabled) {\n\t\t\t\t\tf->disabled = 1;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (cpufeatures_process_feature(f))\n\t\tf->enabled = 1;\n\telse\n\t\tf->disabled = 1;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_phandle",
          "args": [
            "d->node"
          ],
          "line": 1036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "prop[i]"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: missing dependencies property\"",
            "f->name"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "f->node",
            "\"dependencies\"",
            "&len"
          ],
          "line": 1021
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int nr_dt_cpu_features;\nstatic struct dt_cpu_feature *dt_cpu_features;\n\nstatic void __init cpufeatures_deps_enable(struct dt_cpu_feature *f)\n{\n\tconst __be32 *prop;\n\tint len;\n\tint nr_deps;\n\tint i;\n\n\tif (f->enabled || f->disabled)\n\t\treturn;\n\n\tprop = of_get_flat_dt_prop(f->node, \"dependencies\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing dependencies property\", f->name);\n\t\treturn;\n\t}\n\n\tnr_deps = len / sizeof(int);\n\n\tfor (i = 0; i < nr_deps; i++) {\n\t\tunsigned long phandle = be32_to_cpu(prop[i]);\n\t\tint j;\n\n\t\tfor (j = 0; j < nr_dt_cpu_features; j++) {\n\t\t\tstruct dt_cpu_feature *d = &dt_cpu_features[j];\n\n\t\t\tif (of_get_flat_dt_phandle(d->node) == phandle) {\n\t\t\t\tcpufeatures_deps_enable(d);\n\t\t\t\tif (d->disabled) {\n\t\t\t\t\tf->disabled = 1;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (cpufeatures_process_feature(f))\n\t\tf->enabled = 1;\n\telse\n\t\tf->disabled = 1;\n}"
  },
  {
    "function_name": "process_cpufeatures_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "895-1009",
    "snippet": "static int __init process_cpufeatures_node(unsigned long node,\n\t\t\t\t\t  const char *uname, int i)\n{\n\tconst __be32 *prop;\n\tstruct dt_cpu_feature *f;\n\tint len;\n\n\tf = &dt_cpu_features[i];\n\n\tf->node = node;\n\n\tf->name = uname;\n\n\tprop = of_get_flat_dt_prop(node, \"isa\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing isa property\\n\", uname);\n\t\treturn 0;\n\t}\n\tf->isa = be32_to_cpup(prop);\n\n\tprop = of_get_flat_dt_prop(node, \"usable-privilege\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing usable-privilege property\", uname);\n\t\treturn 0;\n\t}\n\tf->usable_privilege = be32_to_cpup(prop);\n\n\tprop = of_get_flat_dt_prop(node, \"hv-support\", &len);\n\tif (prop)\n\t\tf->hv_support = be32_to_cpup(prop);\n\telse\n\t\tf->hv_support = HV_SUPPORT_NONE;\n\n\tprop = of_get_flat_dt_prop(node, \"os-support\", &len);\n\tif (prop)\n\t\tf->os_support = be32_to_cpup(prop);\n\telse\n\t\tf->os_support = OS_SUPPORT_NONE;\n\n\tprop = of_get_flat_dt_prop(node, \"hfscr-bit-nr\", &len);\n\tif (prop)\n\t\tf->hfscr_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->hfscr_bit_nr = -1;\n\tprop = of_get_flat_dt_prop(node, \"fscr-bit-nr\", &len);\n\tif (prop)\n\t\tf->fscr_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->fscr_bit_nr = -1;\n\tprop = of_get_flat_dt_prop(node, \"hwcap-bit-nr\", &len);\n\tif (prop)\n\t\tf->hwcap_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->hwcap_bit_nr = -1;\n\n\tif (f->usable_privilege & USABLE_HV) {\n\t\tif (!(mfmsr() & MSR_HV)) {\n\t\t\tpr_warn(\"%s: HV feature passed to guest\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->hv_support == HV_SUPPORT_NONE && f->hfscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hfscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->hv_support == HV_SUPPORT_HFSCR) {\n\t\t\tif (f->hfscr_bit_nr == -1) {\n\t\t\t\tpr_warn(\"%s: missing hfscr_bit_nr\\n\", uname);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (f->hv_support != HV_SUPPORT_NONE || f->hfscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hv_support/hfscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tif (f->usable_privilege & USABLE_OS) {\n\t\tif (f->os_support == OS_SUPPORT_NONE && f->fscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted fscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->os_support == OS_SUPPORT_FSCR) {\n\t\t\tif (f->fscr_bit_nr == -1) {\n\t\t\t\tpr_warn(\"%s: missing fscr_bit_nr\\n\", uname);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (f->os_support != OS_SUPPORT_NONE || f->fscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted os_support/fscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tif (!(f->usable_privilege & USABLE_PR)) {\n\t\tif (f->hwcap_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hwcap_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\t/* Do all the independent features in the first pass */\n\tif (!of_get_flat_dt_prop(node, \"dependencies\", &len)) {\n\t\tif (cpufeatures_process_feature(f))\n\t\t\tf->enabled = 1;\n\t\telse\n\t\t\tf->disabled = 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define OS_SUPPORT_NONE\t\t0xffffffffU",
      "#define HV_SUPPORT_NONE\t\t0xffffffffU",
      "#define OS_SUPPORT_FSCR         (1U << 0)",
      "#define HV_SUPPORT_HFSCR        (1U << 0)",
      "#define USABLE_HV               (1U << 2)",
      "#define USABLE_OS               (1U << 1)",
      "#define USABLE_PR               (1U << 0)"
    ],
    "globals_used": [
      "static struct dt_cpu_feature *dt_cpu_features;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpufeatures_process_feature",
          "args": [
            "f"
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "cpufeatures_process_feature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "723-756",
          "snippet": "static bool __init cpufeatures_process_feature(struct dt_cpu_feature *f)\n{\n\tconst struct dt_cpu_feature_match *m;\n\tbool known = false;\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(dt_cpu_feature_match_table); i++) {\n\t\tm = &dt_cpu_feature_match_table[i];\n\t\tif (!strcmp(f->name, m->name)) {\n\t\t\tknown = true;\n\t\t\tif (m->enable(f)) {\n\t\t\t\tcur_cpu_spec->cpu_features |= m->cpu_ftr_bit_mask;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpr_info(\"not enabling: %s (disabled or unsupported by kernel)\\n\",\n\t\t\t\tf->name);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tif (!known && (!enable_unknown || !feat_try_enable_unknown(f))) {\n\t\tpr_info(\"not enabling: %s (unknown and unsupported by kernel)\\n\",\n\t\t\tf->name);\n\t\treturn false;\n\t}\n\n\tif (known)\n\t\tpr_debug(\"enabling: %s\\n\", f->name);\n\telse\n\t\tpr_debug(\"enabling: %s (unknown)\\n\", f->name);\n\n\treturn true;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dt_cpu_feature_match __initdata\n\t\tdt_cpu_feature_match_table[] = {\n\t{\"hypervisor\", feat_enable_hv, 0},\n\t{\"big-endian\", feat_enable, 0},\n\t{\"little-endian\", feat_enable_le, CPU_FTR_REAL_LE},\n\t{\"smt\", feat_enable_smt, 0},\n\t{\"interrupt-facilities\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_enable, 0},\n\t{\"timer-facilities\", feat_enable, 0},\n\t{\"timer-facilities-v3\", feat_enable, 0},\n\t{\"debug-facilities\", feat_enable, 0},\n\t{\"come-from-address-register\", feat_enable, CPU_FTR_CFAR},\n\t{\"branch-tracing\", feat_enable, 0},\n\t{\"floating-point\", feat_enable_fp, 0},\n\t{\"vector\", feat_enable_vector, 0},\n\t{\"vector-scalar\", feat_enable_vsx, 0},\n\t{\"vector-scalar-v3\", feat_enable, 0},\n\t{\"decimal-floating-point\", feat_enable, 0},\n\t{\"decimal-integer\", feat_enable, 0},\n\t{\"quadword-load-store\", feat_enable, 0},\n\t{\"vector-crypto\", feat_enable, 0},\n\t{\"mmu-hash\", feat_enable_mmu_hash, 0},\n\t{\"mmu-radix\", feat_enable_mmu_radix, 0},\n\t{\"mmu-hash-v3\", feat_enable_mmu_hash_v3, 0},\n\t{\"virtual-page-class-key-protection\", feat_enable, 0},\n\t{\"transactional-memory\", feat_enable_tm, CPU_FTR_TM},\n\t{\"transactional-memory-v3\", feat_enable_tm, 0},\n\t{\"tm-suspend-hypervisor-assist\", feat_enable, CPU_FTR_P9_TM_HV_ASSIST},\n\t{\"tm-suspend-xer-so-bug\", feat_enable, CPU_FTR_P9_TM_XER_SO_BUG},\n\t{\"idle-nap\", feat_enable_idle_nap, 0},\n\t{\"alignment-interrupt-dsisr\", feat_enable_align_dsisr, 0},\n\t{\"idle-stop\", feat_enable_idle_stop, 0},\n\t{\"machine-check-power8\", feat_enable_mce_power8, 0},\n\t{\"performance-monitor-power8\", feat_enable_pmu_power8, 0},\n\t{\"data-stream-control-register\", feat_enable_dscr, CPU_FTR_DSCR},\n\t{\"event-based-branch\", feat_enable_ebb, 0},\n\t{\"target-address-register\", feat_enable, 0},\n\t{\"branch-history-rolling-buffer\", feat_enable, 0},\n\t{\"control-register\", feat_enable, CPU_FTR_CTRL},\n\t{\"processor-control-facility\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-control-facility-v3\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-utilization-of-resources-register\", feat_enable_purr, 0},\n\t{\"no-execute\", feat_enable, 0},\n\t{\"strong-access-ordering\", feat_enable, CPU_FTR_SAO},\n\t{\"cache-inhibited-large-page\", feat_enable_large_ci, 0},\n\t{\"coprocessor-icswx\", feat_enable, 0},\n\t{\"hypervisor-virtualization-interrupt\", feat_enable_hvi, 0},\n\t{\"program-priority-register\", feat_enable, CPU_FTR_HAS_PPR},\n\t{\"wait\", feat_enable, 0},\n\t{\"atomic-memory-operations\", feat_enable, 0},\n\t{\"branch-v3\", feat_enable, 0},\n\t{\"copy-paste\", feat_enable, 0},\n\t{\"decimal-floating-point-v3\", feat_enable, 0},\n\t{\"decimal-integer-v3\", feat_enable, 0},\n\t{\"fixed-point-v3\", feat_enable, 0},\n\t{\"floating-point-v3\", feat_enable, 0},\n\t{\"group-start-register\", feat_enable, 0},\n\t{\"pc-relative-addressing\", feat_enable, 0},\n\t{\"machine-check-power9\", feat_enable_mce_power9, 0},\n\t{\"machine-check-power10\", feat_enable_mce_power10, 0},\n\t{\"performance-monitor-power9\", feat_enable_pmu_power9, 0},\n\t{\"performance-monitor-power10\", feat_enable_pmu_power10, 0},\n\t{\"event-based-branch-v3\", feat_enable, 0},\n\t{\"random-number-generator\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_disable, 0},\n\t{\"trace-interrupt-v3\", feat_enable, 0},\n\t{\"vector-v3\", feat_enable, 0},\n\t{\"vector-binary128\", feat_enable, 0},\n\t{\"vector-binary16\", feat_enable, 0},\n\t{\"wait-v3\", feat_enable, 0},\n\t{\"prefix-instructions\", feat_enable, 0},\n\t{\"matrix-multiply-assist\", feat_enable_mma, 0},\n\t{\"debug-facilities-v31\", feat_enable, CPU_FTR_DAWR1},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic struct dt_cpu_feature_match __initdata\n\t\tdt_cpu_feature_match_table[] = {\n\t{\"hypervisor\", feat_enable_hv, 0},\n\t{\"big-endian\", feat_enable, 0},\n\t{\"little-endian\", feat_enable_le, CPU_FTR_REAL_LE},\n\t{\"smt\", feat_enable_smt, 0},\n\t{\"interrupt-facilities\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_enable, 0},\n\t{\"timer-facilities\", feat_enable, 0},\n\t{\"timer-facilities-v3\", feat_enable, 0},\n\t{\"debug-facilities\", feat_enable, 0},\n\t{\"come-from-address-register\", feat_enable, CPU_FTR_CFAR},\n\t{\"branch-tracing\", feat_enable, 0},\n\t{\"floating-point\", feat_enable_fp, 0},\n\t{\"vector\", feat_enable_vector, 0},\n\t{\"vector-scalar\", feat_enable_vsx, 0},\n\t{\"vector-scalar-v3\", feat_enable, 0},\n\t{\"decimal-floating-point\", feat_enable, 0},\n\t{\"decimal-integer\", feat_enable, 0},\n\t{\"quadword-load-store\", feat_enable, 0},\n\t{\"vector-crypto\", feat_enable, 0},\n\t{\"mmu-hash\", feat_enable_mmu_hash, 0},\n\t{\"mmu-radix\", feat_enable_mmu_radix, 0},\n\t{\"mmu-hash-v3\", feat_enable_mmu_hash_v3, 0},\n\t{\"virtual-page-class-key-protection\", feat_enable, 0},\n\t{\"transactional-memory\", feat_enable_tm, CPU_FTR_TM},\n\t{\"transactional-memory-v3\", feat_enable_tm, 0},\n\t{\"tm-suspend-hypervisor-assist\", feat_enable, CPU_FTR_P9_TM_HV_ASSIST},\n\t{\"tm-suspend-xer-so-bug\", feat_enable, CPU_FTR_P9_TM_XER_SO_BUG},\n\t{\"idle-nap\", feat_enable_idle_nap, 0},\n\t{\"alignment-interrupt-dsisr\", feat_enable_align_dsisr, 0},\n\t{\"idle-stop\", feat_enable_idle_stop, 0},\n\t{\"machine-check-power8\", feat_enable_mce_power8, 0},\n\t{\"performance-monitor-power8\", feat_enable_pmu_power8, 0},\n\t{\"data-stream-control-register\", feat_enable_dscr, CPU_FTR_DSCR},\n\t{\"event-based-branch\", feat_enable_ebb, 0},\n\t{\"target-address-register\", feat_enable, 0},\n\t{\"branch-history-rolling-buffer\", feat_enable, 0},\n\t{\"control-register\", feat_enable, CPU_FTR_CTRL},\n\t{\"processor-control-facility\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-control-facility-v3\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-utilization-of-resources-register\", feat_enable_purr, 0},\n\t{\"no-execute\", feat_enable, 0},\n\t{\"strong-access-ordering\", feat_enable, CPU_FTR_SAO},\n\t{\"cache-inhibited-large-page\", feat_enable_large_ci, 0},\n\t{\"coprocessor-icswx\", feat_enable, 0},\n\t{\"hypervisor-virtualization-interrupt\", feat_enable_hvi, 0},\n\t{\"program-priority-register\", feat_enable, CPU_FTR_HAS_PPR},\n\t{\"wait\", feat_enable, 0},\n\t{\"atomic-memory-operations\", feat_enable, 0},\n\t{\"branch-v3\", feat_enable, 0},\n\t{\"copy-paste\", feat_enable, 0},\n\t{\"decimal-floating-point-v3\", feat_enable, 0},\n\t{\"decimal-integer-v3\", feat_enable, 0},\n\t{\"fixed-point-v3\", feat_enable, 0},\n\t{\"floating-point-v3\", feat_enable, 0},\n\t{\"group-start-register\", feat_enable, 0},\n\t{\"pc-relative-addressing\", feat_enable, 0},\n\t{\"machine-check-power9\", feat_enable_mce_power9, 0},\n\t{\"machine-check-power10\", feat_enable_mce_power10, 0},\n\t{\"performance-monitor-power9\", feat_enable_pmu_power9, 0},\n\t{\"performance-monitor-power10\", feat_enable_pmu_power10, 0},\n\t{\"event-based-branch-v3\", feat_enable, 0},\n\t{\"random-number-generator\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_disable, 0},\n\t{\"trace-interrupt-v3\", feat_enable, 0},\n\t{\"vector-v3\", feat_enable, 0},\n\t{\"vector-binary128\", feat_enable, 0},\n\t{\"vector-binary16\", feat_enable, 0},\n\t{\"wait-v3\", feat_enable, 0},\n\t{\"prefix-instructions\", feat_enable, 0},\n\t{\"matrix-multiply-assist\", feat_enable_mma, 0},\n\t{\"debug-facilities-v31\", feat_enable, CPU_FTR_DAWR1},\n};\n\nstatic bool __init cpufeatures_process_feature(struct dt_cpu_feature *f)\n{\n\tconst struct dt_cpu_feature_match *m;\n\tbool known = false;\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(dt_cpu_feature_match_table); i++) {\n\t\tm = &dt_cpu_feature_match_table[i];\n\t\tif (!strcmp(f->name, m->name)) {\n\t\t\tknown = true;\n\t\t\tif (m->enable(f)) {\n\t\t\t\tcur_cpu_spec->cpu_features |= m->cpu_ftr_bit_mask;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpr_info(\"not enabling: %s (disabled or unsupported by kernel)\\n\",\n\t\t\t\tf->name);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tif (!known && (!enable_unknown || !feat_try_enable_unknown(f))) {\n\t\tpr_info(\"not enabling: %s (unknown and unsupported by kernel)\\n\",\n\t\t\tf->name);\n\t\treturn false;\n\t}\n\n\tif (known)\n\t\tpr_debug(\"enabling: %s\\n\", f->name);\n\telse\n\t\tpr_debug(\"enabling: %s (unknown)\\n\", f->name);\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"dependencies\"",
            "&len"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: unwanted hwcap_bit_nr\\n\"",
            "uname"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: unwanted os_support/fscr_bit_nr\\n\"",
            "uname"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: missing fscr_bit_nr\\n\"",
            "uname"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: unwanted fscr_bit_nr\\n\"",
            "uname"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: unwanted hv_support/hfscr_bit_nr\\n\"",
            "uname"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: missing hfscr_bit_nr\\n\"",
            "uname"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: unwanted hfscr_bit_nr\\n\"",
            "uname"
          ],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: HV feature passed to guest\\n\"",
            "uname"
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfmsr",
          "args": [],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "prop"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"hwcap-bit-nr\"",
            "&len"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "prop"
          ],
          "line": 941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"fscr-bit-nr\"",
            "&len"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "prop"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"hfscr-bit-nr\"",
            "&len"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "prop"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"os-support\"",
            "&len"
          ],
          "line": 928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "prop"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"hv-support\"",
            "&len"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "prop"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: missing usable-privilege property\"",
            "uname"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"usable-privilege\"",
            "&len"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "prop"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: missing isa property\\n\"",
            "uname"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"isa\"",
            "&len"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\n#define OS_SUPPORT_NONE\t\t0xffffffffU\n#define HV_SUPPORT_NONE\t\t0xffffffffU\n#define OS_SUPPORT_FSCR         (1U << 0)\n#define HV_SUPPORT_HFSCR        (1U << 0)\n#define USABLE_HV               (1U << 2)\n#define USABLE_OS               (1U << 1)\n#define USABLE_PR               (1U << 0)\n\nstatic struct dt_cpu_feature *dt_cpu_features;\n\nstatic int __init process_cpufeatures_node(unsigned long node,\n\t\t\t\t\t  const char *uname, int i)\n{\n\tconst __be32 *prop;\n\tstruct dt_cpu_feature *f;\n\tint len;\n\n\tf = &dt_cpu_features[i];\n\n\tf->node = node;\n\n\tf->name = uname;\n\n\tprop = of_get_flat_dt_prop(node, \"isa\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing isa property\\n\", uname);\n\t\treturn 0;\n\t}\n\tf->isa = be32_to_cpup(prop);\n\n\tprop = of_get_flat_dt_prop(node, \"usable-privilege\", &len);\n\tif (!prop) {\n\t\tpr_warn(\"%s: missing usable-privilege property\", uname);\n\t\treturn 0;\n\t}\n\tf->usable_privilege = be32_to_cpup(prop);\n\n\tprop = of_get_flat_dt_prop(node, \"hv-support\", &len);\n\tif (prop)\n\t\tf->hv_support = be32_to_cpup(prop);\n\telse\n\t\tf->hv_support = HV_SUPPORT_NONE;\n\n\tprop = of_get_flat_dt_prop(node, \"os-support\", &len);\n\tif (prop)\n\t\tf->os_support = be32_to_cpup(prop);\n\telse\n\t\tf->os_support = OS_SUPPORT_NONE;\n\n\tprop = of_get_flat_dt_prop(node, \"hfscr-bit-nr\", &len);\n\tif (prop)\n\t\tf->hfscr_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->hfscr_bit_nr = -1;\n\tprop = of_get_flat_dt_prop(node, \"fscr-bit-nr\", &len);\n\tif (prop)\n\t\tf->fscr_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->fscr_bit_nr = -1;\n\tprop = of_get_flat_dt_prop(node, \"hwcap-bit-nr\", &len);\n\tif (prop)\n\t\tf->hwcap_bit_nr = be32_to_cpup(prop);\n\telse\n\t\tf->hwcap_bit_nr = -1;\n\n\tif (f->usable_privilege & USABLE_HV) {\n\t\tif (!(mfmsr() & MSR_HV)) {\n\t\t\tpr_warn(\"%s: HV feature passed to guest\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->hv_support == HV_SUPPORT_NONE && f->hfscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hfscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->hv_support == HV_SUPPORT_HFSCR) {\n\t\t\tif (f->hfscr_bit_nr == -1) {\n\t\t\t\tpr_warn(\"%s: missing hfscr_bit_nr\\n\", uname);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (f->hv_support != HV_SUPPORT_NONE || f->hfscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hv_support/hfscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tif (f->usable_privilege & USABLE_OS) {\n\t\tif (f->os_support == OS_SUPPORT_NONE && f->fscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted fscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (f->os_support == OS_SUPPORT_FSCR) {\n\t\t\tif (f->fscr_bit_nr == -1) {\n\t\t\t\tpr_warn(\"%s: missing fscr_bit_nr\\n\", uname);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (f->os_support != OS_SUPPORT_NONE || f->fscr_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted os_support/fscr_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tif (!(f->usable_privilege & USABLE_PR)) {\n\t\tif (f->hwcap_bit_nr != -1) {\n\t\t\tpr_warn(\"%s: unwanted hwcap_bit_nr\\n\", uname);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\t/* Do all the independent features in the first pass */\n\tif (!of_get_flat_dt_prop(node, \"dependencies\", &len)) {\n\t\tif (cpufeatures_process_feature(f))\n\t\t\tf->enabled = 1;\n\t\telse\n\t\t\tf->disabled = 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "dt_cpu_ftrs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "872-890",
    "snippet": "bool __init dt_cpu_ftrs_init(void *fdt)\n{\n\tusing_dt_cpu_ftrs = false;\n\n\t/* Setup and verify the FDT, if it fails we just bail */\n\tif (!early_init_dt_verify(fdt))\n\t\treturn false;\n\n\tif (!of_scan_flat_dt(fdt_find_cpu_features, NULL))\n\t\treturn false;\n\n\tif (disabled_on_cmdline())\n\t\treturn false;\n\n\tcpufeatures_setup_cpu();\n\n\tusing_dt_cpu_ftrs = true;\n\treturn true;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpufeatures_setup_cpu",
          "args": [],
          "line": 886
        },
        "resolved": true,
        "details": {
          "function_name": "cpufeatures_setup_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "131-152",
          "snippet": "static void __init cpufeatures_setup_cpu(void)\n{\n\tset_cur_cpu_spec(&base_cpu_spec);\n\n\tcur_cpu_spec->pvr_mask = -1;\n\tcur_cpu_spec->pvr_value = mfspr(SPRN_PVR);\n\n\t/* Initialize the base environment -- clear FSCR/HFSCR.  */\n\thv_mode = !!(mfmsr() & MSR_HV);\n\tif (hv_mode) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_HVMODE;\n\t\tmtspr(SPRN_HFSCR, 0);\n\t}\n\tmtspr(SPRN_FSCR, 0);\n\tmtspr(SPRN_PCR, PCR_MASK);\n\n\t/*\n\t * LPCR does not get cleared, to match behaviour with secondaries\n\t * in __restore_cpu_cpufeatures. Once the idle code is fixed, this\n\t * could clear LPCR too.\n\t */\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int hv_mode;",
            "static struct cpu_spec __initdata base_cpu_spec = {\n\t.cpu_name\t\t= NULL,\n\t.cpu_features\t\t= CPU_FTRS_DT_CPU_BASE,\n\t.cpu_user_features\t= COMMON_USER_BASE,\n\t.cpu_user_features2\t= COMMON_USER2_BASE,\n\t.mmu_features\t\t= 0,\n\t.icache_bsize\t\t= 32, /* minimum block size, fixed by */\n\t.dcache_bsize\t\t= 32, /* cache info init.             */\n\t.num_pmcs\t\t= 0,\n\t.pmc_type\t\t= PPC_PMC_DEFAULT,\n\t.oprofile_cpu_type\t= NULL,\n\t.oprofile_type\t\t= PPC_OPROFILE_INVALID,\n\t.cpu_setup\t\t= NULL,\n\t.cpu_restore\t\t= __restore_cpu_cpufeatures,\n\t.machine_check_early\t= NULL,\n\t.platform\t\t= NULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\nstatic struct cpu_spec __initdata base_cpu_spec = {\n\t.cpu_name\t\t= NULL,\n\t.cpu_features\t\t= CPU_FTRS_DT_CPU_BASE,\n\t.cpu_user_features\t= COMMON_USER_BASE,\n\t.cpu_user_features2\t= COMMON_USER2_BASE,\n\t.mmu_features\t\t= 0,\n\t.icache_bsize\t\t= 32, /* minimum block size, fixed by */\n\t.dcache_bsize\t\t= 32, /* cache info init.             */\n\t.num_pmcs\t\t= 0,\n\t.pmc_type\t\t= PPC_PMC_DEFAULT,\n\t.oprofile_cpu_type\t= NULL,\n\t.oprofile_type\t\t= PPC_OPROFILE_INVALID,\n\t.cpu_setup\t\t= NULL,\n\t.cpu_restore\t\t= __restore_cpu_cpufeatures,\n\t.machine_check_early\t= NULL,\n\t.platform\t\t= NULL,\n};\n\nstatic void __init cpufeatures_setup_cpu(void)\n{\n\tset_cur_cpu_spec(&base_cpu_spec);\n\n\tcur_cpu_spec->pvr_mask = -1;\n\tcur_cpu_spec->pvr_value = mfspr(SPRN_PVR);\n\n\t/* Initialize the base environment -- clear FSCR/HFSCR.  */\n\thv_mode = !!(mfmsr() & MSR_HV);\n\tif (hv_mode) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_HVMODE;\n\t\tmtspr(SPRN_HFSCR, 0);\n\t}\n\tmtspr(SPRN_FSCR, 0);\n\tmtspr(SPRN_PCR, PCR_MASK);\n\n\t/*\n\t * LPCR does not get cleared, to match behaviour with secondaries\n\t * in __restore_cpu_cpufeatures. Once the idle code is fixed, this\n\t * could clear LPCR too.\n\t */\n}"
        }
      },
      {
        "call_info": {
          "callee": "disabled_on_cmdline",
          "args": [],
          "line": 883
        },
        "resolved": true,
        "details": {
          "function_name": "disabled_on_cmdline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "837-855",
          "snippet": "static int __init disabled_on_cmdline(void)\n{\n\tunsigned long root, chosen;\n\tconst char *p;\n\n\troot = of_get_flat_dt_root();\n\tchosen = of_get_flat_dt_subnode_by_name(root, \"chosen\");\n\tif (chosen == -FDT_ERR_NOTFOUND)\n\t\treturn false;\n\n\tp = of_get_flat_dt_prop(chosen, \"bootargs\", NULL);\n\tif (!p)\n\t\treturn false;\n\n\tif (strstr(p, \"dt_cpu_ftrs=off\"))\n\t\treturn true;\n\n\treturn false;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init disabled_on_cmdline(void)\n{\n\tunsigned long root, chosen;\n\tconst char *p;\n\n\troot = of_get_flat_dt_root();\n\tchosen = of_get_flat_dt_subnode_by_name(root, \"chosen\");\n\tif (chosen == -FDT_ERR_NOTFOUND)\n\t\treturn false;\n\n\tp = of_get_flat_dt_prop(chosen, \"bootargs\", NULL);\n\tif (!p)\n\t\treturn false;\n\n\tif (strstr(p, \"dt_cpu_ftrs=off\"))\n\t\treturn true;\n\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_scan_flat_dt",
          "args": [
            "fdt_find_cpu_features",
            "NULL"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_init_dt_verify",
          "args": [
            "fdt"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nbool __init dt_cpu_ftrs_init(void *fdt)\n{\n\tusing_dt_cpu_ftrs = false;\n\n\t/* Setup and verify the FDT, if it fails we just bail */\n\tif (!early_init_dt_verify(fdt))\n\t\treturn false;\n\n\tif (!of_scan_flat_dt(fdt_find_cpu_features, NULL))\n\t\treturn false;\n\n\tif (disabled_on_cmdline())\n\t\treturn false;\n\n\tcpufeatures_setup_cpu();\n\n\tusing_dt_cpu_ftrs = true;\n\treturn true;\n}"
  },
  {
    "function_name": "dt_cpu_ftrs_in_use",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "867-870",
    "snippet": "bool __init dt_cpu_ftrs_in_use(void)\n{\n\treturn using_dt_cpu_ftrs;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nbool __init dt_cpu_ftrs_in_use(void)\n{\n\treturn using_dt_cpu_ftrs;\n}"
  },
  {
    "function_name": "fdt_find_cpu_features",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "857-865",
    "snippet": "static int __init fdt_find_cpu_features(unsigned long node, const char *uname,\n\t\t\t\t\tint depth, void *data)\n{\n\tif (of_flat_dt_is_compatible(node, \"ibm,powerpc-cpu-features\")\n\t    && of_get_flat_dt_prop(node, \"isa\", NULL))\n\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"isa\"",
            "NULL"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_flat_dt_is_compatible",
          "args": [
            "node",
            "\"ibm,powerpc-cpu-features\""
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init fdt_find_cpu_features(unsigned long node, const char *uname,\n\t\t\t\t\tint depth, void *data)\n{\n\tif (of_flat_dt_is_compatible(node, \"ibm,powerpc-cpu-features\")\n\t    && of_get_flat_dt_prop(node, \"isa\", NULL))\n\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "disabled_on_cmdline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "837-855",
    "snippet": "static int __init disabled_on_cmdline(void)\n{\n\tunsigned long root, chosen;\n\tconst char *p;\n\n\troot = of_get_flat_dt_root();\n\tchosen = of_get_flat_dt_subnode_by_name(root, \"chosen\");\n\tif (chosen == -FDT_ERR_NOTFOUND)\n\t\treturn false;\n\n\tp = of_get_flat_dt_prop(chosen, \"bootargs\", NULL);\n\tif (!p)\n\t\treturn false;\n\n\tif (strstr(p, \"dt_cpu_ftrs=off\"))\n\t\treturn true;\n\n\treturn false;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p",
            "\"dt_cpu_ftrs=off\""
          ],
          "line": 851
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "290-305",
          "snippet": "static char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "chosen",
            "\"bootargs\"",
            "NULL"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_subnode_by_name",
          "args": [
            "root",
            "\"chosen\""
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_root",
          "args": [],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init disabled_on_cmdline(void)\n{\n\tunsigned long root, chosen;\n\tconst char *p;\n\n\troot = of_get_flat_dt_root();\n\tchosen = of_get_flat_dt_subnode_by_name(root, \"chosen\");\n\tif (chosen == -FDT_ERR_NOTFOUND)\n\t\treturn false;\n\n\tp = of_get_flat_dt_prop(chosen, \"bootargs\", NULL);\n\tif (!p)\n\t\treturn false;\n\n\tif (strstr(p, \"dt_cpu_ftrs=off\"))\n\t\treturn true;\n\n\treturn false;\n}"
  },
  {
    "function_name": "cpufeatures_setup_finished",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "816-835",
    "snippet": "static void __init cpufeatures_setup_finished(void)\n{\n\tcpufeatures_cpu_quirks();\n\n\tif (hv_mode && !(cur_cpu_spec->cpu_features & CPU_FTR_HVMODE)) {\n\t\tpr_err(\"hypervisor not present in device tree but HV mode is enabled in the CPU. Enabling.\\n\");\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_HVMODE;\n\t}\n\n\t/* Make sure powerpc_base_platform is non-NULL */\n\tpowerpc_base_platform = cur_cpu_spec->platform;\n\n\tsystem_registers.lpcr = mfspr(SPRN_LPCR);\n\tsystem_registers.hfscr = mfspr(SPRN_HFSCR);\n\tsystem_registers.fscr = mfspr(SPRN_FSCR);\n\tsystem_registers.pcr = mfspr(SPRN_PCR);\n\n\tpr_info(\"final cpu/mmu features = 0x%016lx 0x%08x\\n\",\n\t\tcur_cpu_spec->cpu_features, cur_cpu_spec->mmu_features);\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int hv_mode;",
      "static struct {\n\tu64\tlpcr;\n\tu64\tlpcr_clear;\n\tu64\thfscr;\n\tu64\tfscr;\n\tu64\tpcr;\n} system_registers;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"final cpu/mmu features = 0x%016lx 0x%08x\\n\"",
            "cur_cpu_spec->cpu_features",
            "cur_cpu_spec->mmu_features"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PCR"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_FSCR"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_HFSCR"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"hypervisor not present in device tree but HV mode is enabled in the CPU. Enabling.\\n\""
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpufeatures_cpu_quirks",
          "args": [],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "cpufeatures_cpu_quirks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "786-814",
          "snippet": "static __init void cpufeatures_cpu_quirks(void)\n{\n\tunsigned long version = mfspr(SPRN_PVR);\n\n\t/*\n\t * Not all quirks can be derived from the cpufeatures device tree.\n\t */\n\tif ((version & 0xffffefff) == 0x004e0200) {\n\t\t/* DD2.0 has no feature flag */\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_RADIX_PREFETCH_BUG;\n\t} else if ((version & 0xffffefff) == 0x004e0201) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_RADIX_PREFETCH_BUG;\n\t} else if ((version & 0xffffefff) == 0x004e0202) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TM_HV_ASSIST;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TM_XER_SO_BUG;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t} else if ((version & 0xffff0000) == 0x004e0000) {\n\t\t/* DD2.1 and up have DD2_1 */\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t}\n\n\tif ((version & 0xffff0000) == 0x004e0000) {\n\t\tcur_cpu_spec->cpu_features &= ~(CPU_FTR_DAWR);\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TIDR;\n\t}\n\n\tupdate_tlbie_feature_flag(version);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic __init void cpufeatures_cpu_quirks(void)\n{\n\tunsigned long version = mfspr(SPRN_PVR);\n\n\t/*\n\t * Not all quirks can be derived from the cpufeatures device tree.\n\t */\n\tif ((version & 0xffffefff) == 0x004e0200) {\n\t\t/* DD2.0 has no feature flag */\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_RADIX_PREFETCH_BUG;\n\t} else if ((version & 0xffffefff) == 0x004e0201) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_RADIX_PREFETCH_BUG;\n\t} else if ((version & 0xffffefff) == 0x004e0202) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TM_HV_ASSIST;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TM_XER_SO_BUG;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t} else if ((version & 0xffff0000) == 0x004e0000) {\n\t\t/* DD2.1 and up have DD2_1 */\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t}\n\n\tif ((version & 0xffff0000) == 0x004e0000) {\n\t\tcur_cpu_spec->cpu_features &= ~(CPU_FTR_DAWR);\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TIDR;\n\t}\n\n\tupdate_tlbie_feature_flag(version);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\nstatic struct {\n\tu64\tlpcr;\n\tu64\tlpcr_clear;\n\tu64\thfscr;\n\tu64\tfscr;\n\tu64\tpcr;\n} system_registers;\n\nstatic void __init cpufeatures_setup_finished(void)\n{\n\tcpufeatures_cpu_quirks();\n\n\tif (hv_mode && !(cur_cpu_spec->cpu_features & CPU_FTR_HVMODE)) {\n\t\tpr_err(\"hypervisor not present in device tree but HV mode is enabled in the CPU. Enabling.\\n\");\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_HVMODE;\n\t}\n\n\t/* Make sure powerpc_base_platform is non-NULL */\n\tpowerpc_base_platform = cur_cpu_spec->platform;\n\n\tsystem_registers.lpcr = mfspr(SPRN_LPCR);\n\tsystem_registers.hfscr = mfspr(SPRN_HFSCR);\n\tsystem_registers.fscr = mfspr(SPRN_FSCR);\n\tsystem_registers.pcr = mfspr(SPRN_PCR);\n\n\tpr_info(\"final cpu/mmu features = 0x%016lx 0x%08x\\n\",\n\t\tcur_cpu_spec->cpu_features, cur_cpu_spec->mmu_features);\n}"
  },
  {
    "function_name": "cpufeatures_cpu_quirks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "786-814",
    "snippet": "static __init void cpufeatures_cpu_quirks(void)\n{\n\tunsigned long version = mfspr(SPRN_PVR);\n\n\t/*\n\t * Not all quirks can be derived from the cpufeatures device tree.\n\t */\n\tif ((version & 0xffffefff) == 0x004e0200) {\n\t\t/* DD2.0 has no feature flag */\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_RADIX_PREFETCH_BUG;\n\t} else if ((version & 0xffffefff) == 0x004e0201) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_RADIX_PREFETCH_BUG;\n\t} else if ((version & 0xffffefff) == 0x004e0202) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TM_HV_ASSIST;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TM_XER_SO_BUG;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t} else if ((version & 0xffff0000) == 0x004e0000) {\n\t\t/* DD2.1 and up have DD2_1 */\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t}\n\n\tif ((version & 0xffff0000) == 0x004e0000) {\n\t\tcur_cpu_spec->cpu_features &= ~(CPU_FTR_DAWR);\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TIDR;\n\t}\n\n\tupdate_tlbie_feature_flag(version);\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "update_tlbie_feature_flag",
          "args": [
            "version"
          ],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "update_tlbie_feature_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "762-784",
          "snippet": "static __init void update_tlbie_feature_flag(unsigned long pvr)\n{\n\tif (PVR_VER(pvr) == PVR_POWER9) {\n\t\t/*\n\t\t * Set the tlbie feature flag for anything below\n\t\t * Nimbus DD 2.3 and Cumulus DD 1.3\n\t\t */\n\t\tif ((pvr & 0xe000) == 0) {\n\t\t\t/* Nimbus */\n\t\t\tif ((pvr & 0xfff) < 0x203)\n\t\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t} else if ((pvr & 0xc000) == 0) {\n\t\t\t/* Cumulus */\n\t\t\tif ((pvr & 0xfff) < 0x103)\n\t\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t} else {\n\t\t\tWARN_ONCE(1, \"Unknown PVR\");\n\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t}\n\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_ERAT_BUG;\n\t}\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic __init void update_tlbie_feature_flag(unsigned long pvr)\n{\n\tif (PVR_VER(pvr) == PVR_POWER9) {\n\t\t/*\n\t\t * Set the tlbie feature flag for anything below\n\t\t * Nimbus DD 2.3 and Cumulus DD 1.3\n\t\t */\n\t\tif ((pvr & 0xe000) == 0) {\n\t\t\t/* Nimbus */\n\t\t\tif ((pvr & 0xfff) < 0x203)\n\t\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t} else if ((pvr & 0xc000) == 0) {\n\t\t\t/* Cumulus */\n\t\t\tif ((pvr & 0xfff) < 0x103)\n\t\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t} else {\n\t\t\tWARN_ONCE(1, \"Unknown PVR\");\n\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t}\n\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_ERAT_BUG;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PVR"
          ],
          "line": 788
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic __init void cpufeatures_cpu_quirks(void)\n{\n\tunsigned long version = mfspr(SPRN_PVR);\n\n\t/*\n\t * Not all quirks can be derived from the cpufeatures device tree.\n\t */\n\tif ((version & 0xffffefff) == 0x004e0200) {\n\t\t/* DD2.0 has no feature flag */\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_RADIX_PREFETCH_BUG;\n\t} else if ((version & 0xffffefff) == 0x004e0201) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_RADIX_PREFETCH_BUG;\n\t} else if ((version & 0xffffefff) == 0x004e0202) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TM_HV_ASSIST;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TM_XER_SO_BUG;\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t} else if ((version & 0xffff0000) == 0x004e0000) {\n\t\t/* DD2.1 and up have DD2_1 */\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_POWER9_DD2_1;\n\t}\n\n\tif ((version & 0xffff0000) == 0x004e0000) {\n\t\tcur_cpu_spec->cpu_features &= ~(CPU_FTR_DAWR);\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TIDR;\n\t}\n\n\tupdate_tlbie_feature_flag(version);\n}"
  },
  {
    "function_name": "update_tlbie_feature_flag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "762-784",
    "snippet": "static __init void update_tlbie_feature_flag(unsigned long pvr)\n{\n\tif (PVR_VER(pvr) == PVR_POWER9) {\n\t\t/*\n\t\t * Set the tlbie feature flag for anything below\n\t\t * Nimbus DD 2.3 and Cumulus DD 1.3\n\t\t */\n\t\tif ((pvr & 0xe000) == 0) {\n\t\t\t/* Nimbus */\n\t\t\tif ((pvr & 0xfff) < 0x203)\n\t\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t} else if ((pvr & 0xc000) == 0) {\n\t\t\t/* Cumulus */\n\t\t\tif ((pvr & 0xfff) < 0x103)\n\t\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t} else {\n\t\t\tWARN_ONCE(1, \"Unknown PVR\");\n\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t}\n\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_ERAT_BUG;\n\t}\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "1",
            "\"Unknown PVR\""
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "pvr"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic __init void update_tlbie_feature_flag(unsigned long pvr)\n{\n\tif (PVR_VER(pvr) == PVR_POWER9) {\n\t\t/*\n\t\t * Set the tlbie feature flag for anything below\n\t\t * Nimbus DD 2.3 and Cumulus DD 1.3\n\t\t */\n\t\tif ((pvr & 0xe000) == 0) {\n\t\t\t/* Nimbus */\n\t\t\tif ((pvr & 0xfff) < 0x203)\n\t\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t} else if ((pvr & 0xc000) == 0) {\n\t\t\t/* Cumulus */\n\t\t\tif ((pvr & 0xfff) < 0x103)\n\t\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t} else {\n\t\t\tWARN_ONCE(1, \"Unknown PVR\");\n\t\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_STQ_BUG;\n\t\t}\n\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_P9_TLBIE_ERAT_BUG;\n\t}\n}"
  },
  {
    "function_name": "cpufeatures_process_feature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "723-756",
    "snippet": "static bool __init cpufeatures_process_feature(struct dt_cpu_feature *f)\n{\n\tconst struct dt_cpu_feature_match *m;\n\tbool known = false;\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(dt_cpu_feature_match_table); i++) {\n\t\tm = &dt_cpu_feature_match_table[i];\n\t\tif (!strcmp(f->name, m->name)) {\n\t\t\tknown = true;\n\t\t\tif (m->enable(f)) {\n\t\t\t\tcur_cpu_spec->cpu_features |= m->cpu_ftr_bit_mask;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpr_info(\"not enabling: %s (disabled or unsupported by kernel)\\n\",\n\t\t\t\tf->name);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tif (!known && (!enable_unknown || !feat_try_enable_unknown(f))) {\n\t\tpr_info(\"not enabling: %s (unknown and unsupported by kernel)\\n\",\n\t\t\tf->name);\n\t\treturn false;\n\t}\n\n\tif (known)\n\t\tpr_debug(\"enabling: %s\\n\", f->name);\n\telse\n\t\tpr_debug(\"enabling: %s (unknown)\\n\", f->name);\n\n\treturn true;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dt_cpu_feature_match __initdata\n\t\tdt_cpu_feature_match_table[] = {\n\t{\"hypervisor\", feat_enable_hv, 0},\n\t{\"big-endian\", feat_enable, 0},\n\t{\"little-endian\", feat_enable_le, CPU_FTR_REAL_LE},\n\t{\"smt\", feat_enable_smt, 0},\n\t{\"interrupt-facilities\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_enable, 0},\n\t{\"timer-facilities\", feat_enable, 0},\n\t{\"timer-facilities-v3\", feat_enable, 0},\n\t{\"debug-facilities\", feat_enable, 0},\n\t{\"come-from-address-register\", feat_enable, CPU_FTR_CFAR},\n\t{\"branch-tracing\", feat_enable, 0},\n\t{\"floating-point\", feat_enable_fp, 0},\n\t{\"vector\", feat_enable_vector, 0},\n\t{\"vector-scalar\", feat_enable_vsx, 0},\n\t{\"vector-scalar-v3\", feat_enable, 0},\n\t{\"decimal-floating-point\", feat_enable, 0},\n\t{\"decimal-integer\", feat_enable, 0},\n\t{\"quadword-load-store\", feat_enable, 0},\n\t{\"vector-crypto\", feat_enable, 0},\n\t{\"mmu-hash\", feat_enable_mmu_hash, 0},\n\t{\"mmu-radix\", feat_enable_mmu_radix, 0},\n\t{\"mmu-hash-v3\", feat_enable_mmu_hash_v3, 0},\n\t{\"virtual-page-class-key-protection\", feat_enable, 0},\n\t{\"transactional-memory\", feat_enable_tm, CPU_FTR_TM},\n\t{\"transactional-memory-v3\", feat_enable_tm, 0},\n\t{\"tm-suspend-hypervisor-assist\", feat_enable, CPU_FTR_P9_TM_HV_ASSIST},\n\t{\"tm-suspend-xer-so-bug\", feat_enable, CPU_FTR_P9_TM_XER_SO_BUG},\n\t{\"idle-nap\", feat_enable_idle_nap, 0},\n\t{\"alignment-interrupt-dsisr\", feat_enable_align_dsisr, 0},\n\t{\"idle-stop\", feat_enable_idle_stop, 0},\n\t{\"machine-check-power8\", feat_enable_mce_power8, 0},\n\t{\"performance-monitor-power8\", feat_enable_pmu_power8, 0},\n\t{\"data-stream-control-register\", feat_enable_dscr, CPU_FTR_DSCR},\n\t{\"event-based-branch\", feat_enable_ebb, 0},\n\t{\"target-address-register\", feat_enable, 0},\n\t{\"branch-history-rolling-buffer\", feat_enable, 0},\n\t{\"control-register\", feat_enable, CPU_FTR_CTRL},\n\t{\"processor-control-facility\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-control-facility-v3\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-utilization-of-resources-register\", feat_enable_purr, 0},\n\t{\"no-execute\", feat_enable, 0},\n\t{\"strong-access-ordering\", feat_enable, CPU_FTR_SAO},\n\t{\"cache-inhibited-large-page\", feat_enable_large_ci, 0},\n\t{\"coprocessor-icswx\", feat_enable, 0},\n\t{\"hypervisor-virtualization-interrupt\", feat_enable_hvi, 0},\n\t{\"program-priority-register\", feat_enable, CPU_FTR_HAS_PPR},\n\t{\"wait\", feat_enable, 0},\n\t{\"atomic-memory-operations\", feat_enable, 0},\n\t{\"branch-v3\", feat_enable, 0},\n\t{\"copy-paste\", feat_enable, 0},\n\t{\"decimal-floating-point-v3\", feat_enable, 0},\n\t{\"decimal-integer-v3\", feat_enable, 0},\n\t{\"fixed-point-v3\", feat_enable, 0},\n\t{\"floating-point-v3\", feat_enable, 0},\n\t{\"group-start-register\", feat_enable, 0},\n\t{\"pc-relative-addressing\", feat_enable, 0},\n\t{\"machine-check-power9\", feat_enable_mce_power9, 0},\n\t{\"machine-check-power10\", feat_enable_mce_power10, 0},\n\t{\"performance-monitor-power9\", feat_enable_pmu_power9, 0},\n\t{\"performance-monitor-power10\", feat_enable_pmu_power10, 0},\n\t{\"event-based-branch-v3\", feat_enable, 0},\n\t{\"random-number-generator\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_disable, 0},\n\t{\"trace-interrupt-v3\", feat_enable, 0},\n\t{\"vector-v3\", feat_enable, 0},\n\t{\"vector-binary128\", feat_enable, 0},\n\t{\"vector-binary16\", feat_enable, 0},\n\t{\"wait-v3\", feat_enable, 0},\n\t{\"prefix-instructions\", feat_enable, 0},\n\t{\"matrix-multiply-assist\", feat_enable_mma, 0},\n\t{\"debug-facilities-v31\", feat_enable, CPU_FTR_DAWR1},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"enabling: %s (unknown)\\n\"",
            "f->name"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"enabling: %s\\n\"",
            "f->name"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"not enabling: %s (unknown and unsupported by kernel)\\n\"",
            "f->name"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "feat_try_enable_unknown",
          "args": [
            "f"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "feat_try_enable_unknown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "154-189",
          "snippet": "static int __init feat_try_enable_unknown(struct dt_cpu_feature *f)\n{\n\tif (f->hv_support == HV_SUPPORT_NONE) {\n\t} else if (f->hv_support & HV_SUPPORT_HFSCR) {\n\t\tu64 hfscr = mfspr(SPRN_HFSCR);\n\t\thfscr |= 1UL << f->hfscr_bit_nr;\n\t\tmtspr(SPRN_HFSCR, hfscr);\n\t} else {\n\t\t/* Does not have a known recipe */\n\t\treturn 0;\n\t}\n\n\tif (f->os_support == OS_SUPPORT_NONE) {\n\t} else if (f->os_support & OS_SUPPORT_FSCR) {\n\t\tu64 fscr = mfspr(SPRN_FSCR);\n\t\tfscr |= 1UL << f->fscr_bit_nr;\n\t\tmtspr(SPRN_FSCR, fscr);\n\t} else {\n\t\t/* Does not have a known recipe */\n\t\treturn 0;\n\t}\n\n\tif ((f->usable_privilege & USABLE_PR) && (f->hwcap_bit_nr != -1)) {\n\t\tuint32_t word = f->hwcap_bit_nr / 32;\n\t\tuint32_t bit = f->hwcap_bit_nr % 32;\n\n\t\tif (word == 0)\n\t\t\tcur_cpu_spec->cpu_user_features |= 1U << bit;\n\t\telse if (word == 1)\n\t\t\tcur_cpu_spec->cpu_user_features2 |= 1U << bit;\n\t\telse\n\t\t\tpr_err(\"%s could not advertise to user (no hwcap bits)\\n\", f->name);\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define OS_SUPPORT_NONE\t\t0xffffffffU",
            "#define HV_SUPPORT_NONE\t\t0xffffffffU",
            "#define OS_SUPPORT_FSCR         (1U << 0)",
            "#define HV_SUPPORT_HFSCR        (1U << 0)",
            "#define USABLE_PR               (1U << 0)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\n#define OS_SUPPORT_NONE\t\t0xffffffffU\n#define HV_SUPPORT_NONE\t\t0xffffffffU\n#define OS_SUPPORT_FSCR         (1U << 0)\n#define HV_SUPPORT_HFSCR        (1U << 0)\n#define USABLE_PR               (1U << 0)\n\nstatic int __init feat_try_enable_unknown(struct dt_cpu_feature *f)\n{\n\tif (f->hv_support == HV_SUPPORT_NONE) {\n\t} else if (f->hv_support & HV_SUPPORT_HFSCR) {\n\t\tu64 hfscr = mfspr(SPRN_HFSCR);\n\t\thfscr |= 1UL << f->hfscr_bit_nr;\n\t\tmtspr(SPRN_HFSCR, hfscr);\n\t} else {\n\t\t/* Does not have a known recipe */\n\t\treturn 0;\n\t}\n\n\tif (f->os_support == OS_SUPPORT_NONE) {\n\t} else if (f->os_support & OS_SUPPORT_FSCR) {\n\t\tu64 fscr = mfspr(SPRN_FSCR);\n\t\tfscr |= 1UL << f->fscr_bit_nr;\n\t\tmtspr(SPRN_FSCR, fscr);\n\t} else {\n\t\t/* Does not have a known recipe */\n\t\treturn 0;\n\t}\n\n\tif ((f->usable_privilege & USABLE_PR) && (f->hwcap_bit_nr != -1)) {\n\t\tuint32_t word = f->hwcap_bit_nr / 32;\n\t\tuint32_t bit = f->hwcap_bit_nr % 32;\n\n\t\tif (word == 0)\n\t\t\tcur_cpu_spec->cpu_user_features |= 1U << bit;\n\t\telse if (word == 1)\n\t\t\tcur_cpu_spec->cpu_user_features2 |= 1U << bit;\n\t\telse\n\t\t\tpr_err(\"%s could not advertise to user (no hwcap bits)\\n\", f->name);\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"not enabling: %s (disabled or unsupported by kernel)\\n\"",
            "f->name"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m->enable",
          "args": [
            "f"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "f->name",
            "m->name"
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "dt_cpu_feature_match_table"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic struct dt_cpu_feature_match __initdata\n\t\tdt_cpu_feature_match_table[] = {\n\t{\"hypervisor\", feat_enable_hv, 0},\n\t{\"big-endian\", feat_enable, 0},\n\t{\"little-endian\", feat_enable_le, CPU_FTR_REAL_LE},\n\t{\"smt\", feat_enable_smt, 0},\n\t{\"interrupt-facilities\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_enable, 0},\n\t{\"timer-facilities\", feat_enable, 0},\n\t{\"timer-facilities-v3\", feat_enable, 0},\n\t{\"debug-facilities\", feat_enable, 0},\n\t{\"come-from-address-register\", feat_enable, CPU_FTR_CFAR},\n\t{\"branch-tracing\", feat_enable, 0},\n\t{\"floating-point\", feat_enable_fp, 0},\n\t{\"vector\", feat_enable_vector, 0},\n\t{\"vector-scalar\", feat_enable_vsx, 0},\n\t{\"vector-scalar-v3\", feat_enable, 0},\n\t{\"decimal-floating-point\", feat_enable, 0},\n\t{\"decimal-integer\", feat_enable, 0},\n\t{\"quadword-load-store\", feat_enable, 0},\n\t{\"vector-crypto\", feat_enable, 0},\n\t{\"mmu-hash\", feat_enable_mmu_hash, 0},\n\t{\"mmu-radix\", feat_enable_mmu_radix, 0},\n\t{\"mmu-hash-v3\", feat_enable_mmu_hash_v3, 0},\n\t{\"virtual-page-class-key-protection\", feat_enable, 0},\n\t{\"transactional-memory\", feat_enable_tm, CPU_FTR_TM},\n\t{\"transactional-memory-v3\", feat_enable_tm, 0},\n\t{\"tm-suspend-hypervisor-assist\", feat_enable, CPU_FTR_P9_TM_HV_ASSIST},\n\t{\"tm-suspend-xer-so-bug\", feat_enable, CPU_FTR_P9_TM_XER_SO_BUG},\n\t{\"idle-nap\", feat_enable_idle_nap, 0},\n\t{\"alignment-interrupt-dsisr\", feat_enable_align_dsisr, 0},\n\t{\"idle-stop\", feat_enable_idle_stop, 0},\n\t{\"machine-check-power8\", feat_enable_mce_power8, 0},\n\t{\"performance-monitor-power8\", feat_enable_pmu_power8, 0},\n\t{\"data-stream-control-register\", feat_enable_dscr, CPU_FTR_DSCR},\n\t{\"event-based-branch\", feat_enable_ebb, 0},\n\t{\"target-address-register\", feat_enable, 0},\n\t{\"branch-history-rolling-buffer\", feat_enable, 0},\n\t{\"control-register\", feat_enable, CPU_FTR_CTRL},\n\t{\"processor-control-facility\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-control-facility-v3\", feat_enable_dbell, CPU_FTR_DBELL},\n\t{\"processor-utilization-of-resources-register\", feat_enable_purr, 0},\n\t{\"no-execute\", feat_enable, 0},\n\t{\"strong-access-ordering\", feat_enable, CPU_FTR_SAO},\n\t{\"cache-inhibited-large-page\", feat_enable_large_ci, 0},\n\t{\"coprocessor-icswx\", feat_enable, 0},\n\t{\"hypervisor-virtualization-interrupt\", feat_enable_hvi, 0},\n\t{\"program-priority-register\", feat_enable, CPU_FTR_HAS_PPR},\n\t{\"wait\", feat_enable, 0},\n\t{\"atomic-memory-operations\", feat_enable, 0},\n\t{\"branch-v3\", feat_enable, 0},\n\t{\"copy-paste\", feat_enable, 0},\n\t{\"decimal-floating-point-v3\", feat_enable, 0},\n\t{\"decimal-integer-v3\", feat_enable, 0},\n\t{\"fixed-point-v3\", feat_enable, 0},\n\t{\"floating-point-v3\", feat_enable, 0},\n\t{\"group-start-register\", feat_enable, 0},\n\t{\"pc-relative-addressing\", feat_enable, 0},\n\t{\"machine-check-power9\", feat_enable_mce_power9, 0},\n\t{\"machine-check-power10\", feat_enable_mce_power10, 0},\n\t{\"performance-monitor-power9\", feat_enable_pmu_power9, 0},\n\t{\"performance-monitor-power10\", feat_enable_pmu_power10, 0},\n\t{\"event-based-branch-v3\", feat_enable, 0},\n\t{\"random-number-generator\", feat_enable, 0},\n\t{\"system-call-vectored\", feat_disable, 0},\n\t{\"trace-interrupt-v3\", feat_enable, 0},\n\t{\"vector-v3\", feat_enable, 0},\n\t{\"vector-binary128\", feat_enable, 0},\n\t{\"vector-binary16\", feat_enable, 0},\n\t{\"wait-v3\", feat_enable, 0},\n\t{\"prefix-instructions\", feat_enable, 0},\n\t{\"matrix-multiply-assist\", feat_enable_mma, 0},\n\t{\"debug-facilities-v31\", feat_enable, CPU_FTR_DAWR1},\n};\n\nstatic bool __init cpufeatures_process_feature(struct dt_cpu_feature *f)\n{\n\tconst struct dt_cpu_feature_match *m;\n\tbool known = false;\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(dt_cpu_feature_match_table); i++) {\n\t\tm = &dt_cpu_feature_match_table[i];\n\t\tif (!strcmp(f->name, m->name)) {\n\t\t\tknown = true;\n\t\t\tif (m->enable(f)) {\n\t\t\t\tcur_cpu_spec->cpu_features |= m->cpu_ftr_bit_mask;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpr_info(\"not enabling: %s (disabled or unsupported by kernel)\\n\",\n\t\t\t\tf->name);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tif (!known && (!enable_unknown || !feat_try_enable_unknown(f))) {\n\t\tpr_info(\"not enabling: %s (unknown and unsupported by kernel)\\n\",\n\t\t\tf->name);\n\t\treturn false;\n\t}\n\n\tif (known)\n\t\tpr_debug(\"enabling: %s\\n\", f->name);\n\telse\n\t\tpr_debug(\"enabling: %s (unknown)\\n\", f->name);\n\n\treturn true;\n}"
  },
  {
    "function_name": "cpufeatures_setup_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "708-721",
    "snippet": "static void __init cpufeatures_setup_start(u32 isa)\n{\n\tpr_info(\"setup for ISA %d\\n\", isa);\n\n\tif (isa >= ISA_V3_0B) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_ARCH_300;\n\t\tcur_cpu_spec->cpu_user_features2 |= PPC_FEATURE2_ARCH_3_00;\n\t}\n\n\tif (isa >= ISA_V3_1) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_ARCH_31;\n\t\tcur_cpu_spec->cpu_user_features2 |= PPC_FEATURE2_ARCH_3_1;\n\t}\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define ISA_V3_1        3100",
      "#define ISA_V3_0B       3000"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"setup for ISA %d\\n\"",
            "isa"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\n#define ISA_V3_1        3100\n#define ISA_V3_0B       3000\n\nstatic void __init cpufeatures_setup_start(u32 isa)\n{\n\tpr_info(\"setup for ISA %d\\n\", isa);\n\n\tif (isa >= ISA_V3_0B) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_ARCH_300;\n\t\tcur_cpu_spec->cpu_user_features2 |= PPC_FEATURE2_ARCH_3_00;\n\t}\n\n\tif (isa >= ISA_V3_1) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_ARCH_31;\n\t\tcur_cpu_spec->cpu_user_features2 |= PPC_FEATURE2_ARCH_3_1;\n\t}\n}"
  },
  {
    "function_name": "dt_cpu_ftrs_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "692-705",
    "snippet": "static int __init dt_cpu_ftrs_parse(char *str)\n{\n\tif (!str)\n\t\treturn 0;\n\n\tif (!strcmp(str, \"off\"))\n\t\tusing_dt_cpu_ftrs = false;\n\telse if (!strcmp(str, \"known\"))\n\t\tenable_unknown = false;\n\telse\n\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"known\""
          ],
          "line": 699
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init dt_cpu_ftrs_parse(char *str)\n{\n\tif (!str)\n\t\treturn 0;\n\n\tif (!strcmp(str, \"off\"))\n\t\tusing_dt_cpu_ftrs = false;\n\telse if (!strcmp(str, \"known\"))\n\t\tenable_unknown = false;\n\telse\n\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "feat_enable_mma",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "596-606",
    "snippet": "static int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PCR",
            "pcr"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PCR"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "feat_enable",
          "args": [
            "f"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "feat_enable_mma",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "596-606",
          "snippet": "static int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_large_ci",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "589-594",
    "snippet": "static int __init feat_enable_large_ci(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->mmu_features |= MMU_FTR_CI_LARGE_PAGE;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_large_ci(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->mmu_features |= MMU_FTR_CI_LARGE_PAGE;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_hvi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "564-587",
    "snippet": "static int __init feat_enable_hvi(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\t/*\n\t * POWER9 XIVE interrupts including in OPAL XICS compatibility\n\t * are always delivered as hypervisor virtualization interrupts (HVI)\n\t * rather than EE.\n\t *\n\t * However LPES0 is not set here, in the chance that an EE does get\n\t * delivered to the host somehow, the EE handler would not expect it\n\t * to be delivered in LPES0 mode (e.g., using SRR[01]). This could\n\t * happen if there is a bug in interrupt controller code, or IC is\n\t * misconfigured in systemsim.\n\t */\n\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr |= LPCR_HVICE;\t/* enable hvi interrupts */\n\tlpcr |= LPCR_HEIC;\t/* disable ee interrupts when MSR_HV */\n\tlpcr |= LPCR_PECE_HVEE; /* hvi can wake from stop */\n\tmtspr(SPRN_LPCR, lpcr);\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_hvi(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\t/*\n\t * POWER9 XIVE interrupts including in OPAL XICS compatibility\n\t * are always delivered as hypervisor virtualization interrupts (HVI)\n\t * rather than EE.\n\t *\n\t * However LPES0 is not set here, in the chance that an EE does get\n\t * delivered to the host somehow, the EE handler would not expect it\n\t * to be delivered in LPES0 mode (e.g., using SRR[01]). This could\n\t * happen if there is a bug in interrupt controller code, or IC is\n\t * misconfigured in systemsim.\n\t */\n\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr |= LPCR_HVICE;\t/* enable hvi interrupts */\n\tlpcr |= LPCR_HEIC;\t/* disable ee interrupts when MSR_HV */\n\tlpcr |= LPCR_PECE_HVEE; /* hvi can wake from stop */\n\tmtspr(SPRN_LPCR, lpcr);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_dbell",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "548-562",
    "snippet": "static int __init feat_enable_dbell(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\t/* P9 has an HFSCR for privileged state */\n\tfeat_enable(f);\n\n\tcur_cpu_spec->cpu_features |= CPU_FTR_DBELL;\n\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr |=  LPCR_PECEDH; /* hyp doorbell wakeup */\n\tmtspr(SPRN_LPCR, lpcr);\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "feat_enable",
          "args": [
            "f"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "feat_enable_mma",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "596-606",
          "snippet": "static int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_dbell(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\t/* P9 has an HFSCR for privileged state */\n\tfeat_enable(f);\n\n\tcur_cpu_spec->cpu_features |= CPU_FTR_DBELL;\n\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr |=  LPCR_PECEDH; /* hyp doorbell wakeup */\n\tmtspr(SPRN_LPCR, lpcr);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_ebb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "534-546",
    "snippet": "static int __init feat_enable_ebb(struct dt_cpu_feature *f)\n{\n\t/*\n\t * PPC_FEATURE2_EBB is enabled in PMU init code because it has\n\t * historically been related to the PMU facility. This may have\n\t * to be decoupled if EBB becomes more generic. For now, follow\n\t * existing convention.\n\t */\n\tf->hwcap_bit_nr = -1;\n\tfeat_enable(f);\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "feat_enable",
          "args": [
            "f"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "feat_enable_mma",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "596-606",
          "snippet": "static int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_ebb(struct dt_cpu_feature *f)\n{\n\t/*\n\t * PPC_FEATURE2_EBB is enabled in PMU init code because it has\n\t * historically been related to the PMU facility. This may have\n\t * to be decoupled if EBB becomes more generic. For now, follow\n\t * existing convention.\n\t */\n\tf->hwcap_bit_nr = -1;\n\tfeat_enable(f);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_purr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "527-532",
    "snippet": "static int __init feat_enable_purr(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->cpu_features |= CPU_FTR_PURR | CPU_FTR_SPURR;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_purr(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->cpu_features |= CPU_FTR_PURR | CPU_FTR_SPURR;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_vsx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "515-525",
    "snippet": "static int __init feat_enable_vsx(struct dt_cpu_feature *f)\n{\n#ifdef CONFIG_VSX\n\tfeat_enable(f);\n\tcur_cpu_spec->cpu_features |= CPU_FTR_VSX;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_HAS_VSX;\n\n\treturn 1;\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "feat_enable",
          "args": [
            "f"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "feat_enable_mma",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "596-606",
          "snippet": "static int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_vsx(struct dt_cpu_feature *f)\n{\n#ifdef CONFIG_VSX\n\tfeat_enable(f);\n\tcur_cpu_spec->cpu_features |= CPU_FTR_VSX;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_HAS_VSX;\n\n\treturn 1;\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "feat_enable_vector",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "502-513",
    "snippet": "static int __init feat_enable_vector(struct dt_cpu_feature *f)\n{\n#ifdef CONFIG_ALTIVEC\n\tfeat_enable(f);\n\tcur_cpu_spec->cpu_features |= CPU_FTR_ALTIVEC;\n\tcur_cpu_spec->cpu_features |= CPU_FTR_VMX_COPY;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_HAS_ALTIVEC;\n\n\treturn 1;\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "feat_enable",
          "args": [
            "f"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "feat_enable_mma",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "596-606",
          "snippet": "static int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_vector(struct dt_cpu_feature *f)\n{\n#ifdef CONFIG_ALTIVEC\n\tfeat_enable(f);\n\tcur_cpu_spec->cpu_features |= CPU_FTR_ALTIVEC;\n\tcur_cpu_spec->cpu_features |= CPU_FTR_VMX_COPY;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_HAS_ALTIVEC;\n\n\treturn 1;\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "feat_enable_fp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "494-500",
    "snippet": "static int __init feat_enable_fp(struct dt_cpu_feature *f)\n{\n\tfeat_enable(f);\n\tcur_cpu_spec->cpu_features &= ~CPU_FTR_FPU_UNAVAILABLE;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "feat_enable",
          "args": [
            "f"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "feat_enable_mma",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "596-606",
          "snippet": "static int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_fp(struct dt_cpu_feature *f)\n{\n\tfeat_enable(f);\n\tcur_cpu_spec->cpu_features &= ~CPU_FTR_FPU_UNAVAILABLE;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_tm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "484-492",
    "snippet": "static int __init feat_enable_tm(struct dt_cpu_feature *f)\n{\n#ifdef CONFIG_PPC_TRANSACTIONAL_MEM\n\tfeat_enable(f);\n\tcur_cpu_spec->cpu_user_features2 |= PPC_FEATURE2_HTM_NOSC;\n\treturn 1;\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "feat_enable",
          "args": [
            "f"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "feat_enable_mma",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "596-606",
          "snippet": "static int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_tm(struct dt_cpu_feature *f)\n{\n#ifdef CONFIG_PPC_TRANSACTIONAL_MEM\n\tfeat_enable(f);\n\tcur_cpu_spec->cpu_user_features2 |= PPC_FEATURE2_HTM_NOSC;\n\treturn 1;\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "feat_enable_mce_power10",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "476-482",
    "snippet": "static int __init feat_enable_mce_power10(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->platform = \"power10\";\n\tcur_cpu_spec->machine_check_early = __machine_check_early_realmode_p10;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mce_power10(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->platform = \"power10\";\n\tcur_cpu_spec->machine_check_early = __machine_check_early_realmode_p10;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_pmu_power10",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "459-474",
    "snippet": "static int __init feat_enable_pmu_power10(struct dt_cpu_feature *f)\n{\n\thfscr_pmu_enable();\n\n\tinit_pmu_power10();\n\tinit_pmu_registers = init_pmu_power10;\n\n\tcur_cpu_spec->cpu_features |= CPU_FTR_MMCRA;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_PSERIES_PERFMON_COMPAT;\n\n\tcur_cpu_spec->num_pmcs          = 6;\n\tcur_cpu_spec->pmc_type          = PPC_PMC_IBM;\n\tcur_cpu_spec->oprofile_cpu_type = \"ppc64/power10\";\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void (*init_pmu_registers)(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_pmu_power10",
          "args": [],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "init_pmu_power10",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "451-457",
          "snippet": "static void init_pmu_power10(void)\n{\n\tinit_pmu_power9();\n\n\tmtspr(SPRN_MMCR3, 0);\n\tmtspr(SPRN_MMCRA, MMCRA_BHRB_DISABLE);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic void init_pmu_power10(void)\n{\n\tinit_pmu_power9();\n\n\tmtspr(SPRN_MMCR3, 0);\n\tmtspr(SPRN_MMCRA, MMCRA_BHRB_DISABLE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hfscr_pmu_enable",
          "args": [],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "hfscr_pmu_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "367-372",
          "snippet": "static void hfscr_pmu_enable(void)\n{\n\tu64 hfscr = mfspr(SPRN_HFSCR);\n\thfscr |= PPC_BIT(60);\n\tmtspr(SPRN_HFSCR, hfscr);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic void hfscr_pmu_enable(void)\n{\n\tu64 hfscr = mfspr(SPRN_HFSCR);\n\thfscr |= PPC_BIT(60);\n\tmtspr(SPRN_HFSCR, hfscr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic void (*init_pmu_registers)(void);\n\nstatic int __init feat_enable_pmu_power10(struct dt_cpu_feature *f)\n{\n\thfscr_pmu_enable();\n\n\tinit_pmu_power10();\n\tinit_pmu_registers = init_pmu_power10;\n\n\tcur_cpu_spec->cpu_features |= CPU_FTR_MMCRA;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_PSERIES_PERFMON_COMPAT;\n\n\tcur_cpu_spec->num_pmcs          = 6;\n\tcur_cpu_spec->pmc_type          = PPC_PMC_IBM;\n\tcur_cpu_spec->oprofile_cpu_type = \"ppc64/power10\";\n\n\treturn 1;\n}"
  },
  {
    "function_name": "init_pmu_power10",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "451-457",
    "snippet": "static void init_pmu_power10(void)\n{\n\tinit_pmu_power9();\n\n\tmtspr(SPRN_MMCR3, 0);\n\tmtspr(SPRN_MMCRA, MMCRA_BHRB_DISABLE);\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCRA",
            "MMCRA_BHRB_DISABLE"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCR3",
            "0"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_pmu_power9",
          "args": [],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "init_pmu_power9",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "415-424",
          "snippet": "static void init_pmu_power9(void)\n{\n\tif (hv_mode)\n\t\tmtspr(SPRN_MMCRC, 0);\n\n\tmtspr(SPRN_MMCRA, 0);\n\tmtspr(SPRN_MMCR0, 0);\n\tmtspr(SPRN_MMCR1, 0);\n\tmtspr(SPRN_MMCR2, 0);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int hv_mode;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\n\nstatic void init_pmu_power9(void)\n{\n\tif (hv_mode)\n\t\tmtspr(SPRN_MMCRC, 0);\n\n\tmtspr(SPRN_MMCRA, 0);\n\tmtspr(SPRN_MMCR0, 0);\n\tmtspr(SPRN_MMCR1, 0);\n\tmtspr(SPRN_MMCR2, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic void init_pmu_power10(void)\n{\n\tinit_pmu_power9();\n\n\tmtspr(SPRN_MMCR3, 0);\n\tmtspr(SPRN_MMCRA, MMCRA_BHRB_DISABLE);\n}"
  },
  {
    "function_name": "feat_enable_pmu_power9",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "434-449",
    "snippet": "static int __init feat_enable_pmu_power9(struct dt_cpu_feature *f)\n{\n\thfscr_pmu_enable();\n\n\tinit_pmu_power9();\n\tinit_pmu_registers = init_pmu_power9;\n\n\tcur_cpu_spec->cpu_features |= CPU_FTR_MMCRA;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_PSERIES_PERFMON_COMPAT;\n\n\tcur_cpu_spec->num_pmcs\t\t= 6;\n\tcur_cpu_spec->pmc_type\t\t= PPC_PMC_IBM;\n\tcur_cpu_spec->oprofile_cpu_type\t= \"ppc64/power9\";\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void (*init_pmu_registers)(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_pmu_power9",
          "args": [],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "init_pmu_power9",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "415-424",
          "snippet": "static void init_pmu_power9(void)\n{\n\tif (hv_mode)\n\t\tmtspr(SPRN_MMCRC, 0);\n\n\tmtspr(SPRN_MMCRA, 0);\n\tmtspr(SPRN_MMCR0, 0);\n\tmtspr(SPRN_MMCR1, 0);\n\tmtspr(SPRN_MMCR2, 0);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int hv_mode;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\n\nstatic void init_pmu_power9(void)\n{\n\tif (hv_mode)\n\t\tmtspr(SPRN_MMCRC, 0);\n\n\tmtspr(SPRN_MMCRA, 0);\n\tmtspr(SPRN_MMCR0, 0);\n\tmtspr(SPRN_MMCR1, 0);\n\tmtspr(SPRN_MMCR2, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hfscr_pmu_enable",
          "args": [],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "hfscr_pmu_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "367-372",
          "snippet": "static void hfscr_pmu_enable(void)\n{\n\tu64 hfscr = mfspr(SPRN_HFSCR);\n\thfscr |= PPC_BIT(60);\n\tmtspr(SPRN_HFSCR, hfscr);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic void hfscr_pmu_enable(void)\n{\n\tu64 hfscr = mfspr(SPRN_HFSCR);\n\thfscr |= PPC_BIT(60);\n\tmtspr(SPRN_HFSCR, hfscr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic void (*init_pmu_registers)(void);\n\nstatic int __init feat_enable_pmu_power9(struct dt_cpu_feature *f)\n{\n\thfscr_pmu_enable();\n\n\tinit_pmu_power9();\n\tinit_pmu_registers = init_pmu_power9;\n\n\tcur_cpu_spec->cpu_features |= CPU_FTR_MMCRA;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_PSERIES_PERFMON_COMPAT;\n\n\tcur_cpu_spec->num_pmcs\t\t= 6;\n\tcur_cpu_spec->pmc_type\t\t= PPC_PMC_IBM;\n\tcur_cpu_spec->oprofile_cpu_type\t= \"ppc64/power9\";\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_mce_power9",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "426-432",
    "snippet": "static int __init feat_enable_mce_power9(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->platform = \"power9\";\n\tcur_cpu_spec->machine_check_early = __machine_check_early_realmode_p9;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mce_power9(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->platform = \"power9\";\n\tcur_cpu_spec->machine_check_early = __machine_check_early_realmode_p9;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "init_pmu_power9",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "415-424",
    "snippet": "static void init_pmu_power9(void)\n{\n\tif (hv_mode)\n\t\tmtspr(SPRN_MMCRC, 0);\n\n\tmtspr(SPRN_MMCRA, 0);\n\tmtspr(SPRN_MMCR0, 0);\n\tmtspr(SPRN_MMCR1, 0);\n\tmtspr(SPRN_MMCR2, 0);\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int hv_mode;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCR2",
            "0"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCR1",
            "0"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCR0",
            "0"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCRA",
            "0"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCRC",
            "0"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\n\nstatic void init_pmu_power9(void)\n{\n\tif (hv_mode)\n\t\tmtspr(SPRN_MMCRC, 0);\n\n\tmtspr(SPRN_MMCRA, 0);\n\tmtspr(SPRN_MMCR0, 0);\n\tmtspr(SPRN_MMCR1, 0);\n\tmtspr(SPRN_MMCR2, 0);\n}"
  },
  {
    "function_name": "feat_enable_pmu_power8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "396-413",
    "snippet": "static int __init feat_enable_pmu_power8(struct dt_cpu_feature *f)\n{\n\thfscr_pmu_enable();\n\n\tinit_pmu_power8();\n\tinit_pmu_registers = init_pmu_power8;\n\n\tcur_cpu_spec->cpu_features |= CPU_FTR_MMCRA;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_PSERIES_PERFMON_COMPAT;\n\tif (pvr_version_is(PVR_POWER8E))\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_PMAO_BUG;\n\n\tcur_cpu_spec->num_pmcs\t\t= 6;\n\tcur_cpu_spec->pmc_type\t\t= PPC_PMC_IBM;\n\tcur_cpu_spec->oprofile_cpu_type\t= \"ppc64/power8\";\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void (*init_pmu_registers)(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pvr_version_is",
          "args": [
            "PVR_POWER8E"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_pmu_power8",
          "args": [],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "init_pmu_power8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "374-386",
          "snippet": "static void init_pmu_power8(void)\n{\n\tif (hv_mode) {\n\t\tmtspr(SPRN_MMCRC, 0);\n\t\tmtspr(SPRN_MMCRH, 0);\n\t}\n\n\tmtspr(SPRN_MMCRA, 0);\n\tmtspr(SPRN_MMCR0, 0);\n\tmtspr(SPRN_MMCR1, 0);\n\tmtspr(SPRN_MMCR2, 0);\n\tmtspr(SPRN_MMCRS, 0);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int hv_mode;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\n\nstatic void init_pmu_power8(void)\n{\n\tif (hv_mode) {\n\t\tmtspr(SPRN_MMCRC, 0);\n\t\tmtspr(SPRN_MMCRH, 0);\n\t}\n\n\tmtspr(SPRN_MMCRA, 0);\n\tmtspr(SPRN_MMCR0, 0);\n\tmtspr(SPRN_MMCR1, 0);\n\tmtspr(SPRN_MMCR2, 0);\n\tmtspr(SPRN_MMCRS, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hfscr_pmu_enable",
          "args": [],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "hfscr_pmu_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "367-372",
          "snippet": "static void hfscr_pmu_enable(void)\n{\n\tu64 hfscr = mfspr(SPRN_HFSCR);\n\thfscr |= PPC_BIT(60);\n\tmtspr(SPRN_HFSCR, hfscr);\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic void hfscr_pmu_enable(void)\n{\n\tu64 hfscr = mfspr(SPRN_HFSCR);\n\thfscr |= PPC_BIT(60);\n\tmtspr(SPRN_HFSCR, hfscr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic void (*init_pmu_registers)(void);\n\nstatic int __init feat_enable_pmu_power8(struct dt_cpu_feature *f)\n{\n\thfscr_pmu_enable();\n\n\tinit_pmu_power8();\n\tinit_pmu_registers = init_pmu_power8;\n\n\tcur_cpu_spec->cpu_features |= CPU_FTR_MMCRA;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_PSERIES_PERFMON_COMPAT;\n\tif (pvr_version_is(PVR_POWER8E))\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_PMAO_BUG;\n\n\tcur_cpu_spec->num_pmcs\t\t= 6;\n\tcur_cpu_spec->pmc_type\t\t= PPC_PMC_IBM;\n\tcur_cpu_spec->oprofile_cpu_type\t= \"ppc64/power8\";\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_mce_power8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "388-394",
    "snippet": "static int __init feat_enable_mce_power8(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->platform = \"power8\";\n\tcur_cpu_spec->machine_check_early = __machine_check_early_realmode_p8;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mce_power8(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->platform = \"power8\";\n\tcur_cpu_spec->machine_check_early = __machine_check_early_realmode_p8;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "init_pmu_power8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "374-386",
    "snippet": "static void init_pmu_power8(void)\n{\n\tif (hv_mode) {\n\t\tmtspr(SPRN_MMCRC, 0);\n\t\tmtspr(SPRN_MMCRH, 0);\n\t}\n\n\tmtspr(SPRN_MMCRA, 0);\n\tmtspr(SPRN_MMCR0, 0);\n\tmtspr(SPRN_MMCR1, 0);\n\tmtspr(SPRN_MMCR2, 0);\n\tmtspr(SPRN_MMCRS, 0);\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int hv_mode;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCRS",
            "0"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCR2",
            "0"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCR1",
            "0"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCR0",
            "0"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCRA",
            "0"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCRH",
            "0"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_MMCRC",
            "0"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\n\nstatic void init_pmu_power8(void)\n{\n\tif (hv_mode) {\n\t\tmtspr(SPRN_MMCRC, 0);\n\t\tmtspr(SPRN_MMCRH, 0);\n\t}\n\n\tmtspr(SPRN_MMCRA, 0);\n\tmtspr(SPRN_MMCR0, 0);\n\tmtspr(SPRN_MMCR1, 0);\n\tmtspr(SPRN_MMCR2, 0);\n\tmtspr(SPRN_MMCRS, 0);\n}"
  },
  {
    "function_name": "hfscr_pmu_enable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "367-372",
    "snippet": "static void hfscr_pmu_enable(void)\n{\n\tu64 hfscr = mfspr(SPRN_HFSCR);\n\thfscr |= PPC_BIT(60);\n\tmtspr(SPRN_HFSCR, hfscr);\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_HFSCR",
            "hfscr"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PPC_BIT",
          "args": [
            "60"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_HFSCR"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic void hfscr_pmu_enable(void)\n{\n\tu64 hfscr = mfspr(SPRN_HFSCR);\n\thfscr |= PPC_BIT(60);\n\tmtspr(SPRN_HFSCR, hfscr);\n}"
  },
  {
    "function_name": "feat_enable_dscr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "345-365",
    "snippet": "static int __init feat_enable_dscr(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\t/*\n\t * Linux relies on FSCR[DSCR] being clear, so that we can take the\n\t * facility unavailable interrupt and track the task's usage of DSCR.\n\t * See facility_unavailable_exception().\n\t * Clear the bit here so that feat_enable() doesn't set it.\n\t */\n\tf->fscr_bit_nr = -1;\n\n\tfeat_enable(f);\n\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr &= ~LPCR_DPFD;\n\tlpcr |=  (4UL << LPCR_DPFD_SH);\n\tmtspr(SPRN_LPCR, lpcr);\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "feat_enable",
          "args": [
            "f"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "feat_enable_mma",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "596-606",
          "snippet": "static int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_mma(struct dt_cpu_feature *f)\n{\n\tu64 pcr;\n\n\tfeat_enable(f);\n\tpcr = mfspr(SPRN_PCR);\n\tpcr &= ~PCR_MMA_DIS;\n\tmtspr(SPRN_PCR, pcr);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_dscr(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\t/*\n\t * Linux relies on FSCR[DSCR] being clear, so that we can take the\n\t * facility unavailable interrupt and track the task's usage of DSCR.\n\t * See facility_unavailable_exception().\n\t * Clear the bit here so that feat_enable() doesn't set it.\n\t */\n\tf->fscr_bit_nr = -1;\n\n\tfeat_enable(f);\n\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr &= ~LPCR_DPFD;\n\tlpcr |=  (4UL << LPCR_DPFD_SH);\n\tmtspr(SPRN_LPCR, lpcr);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_mmu_radix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "332-343",
    "snippet": "static int __init feat_enable_mmu_radix(struct dt_cpu_feature *f)\n{\n#ifdef CONFIG_PPC_RADIX_MMU\n\tcur_cpu_spec->mmu_features |= MMU_FTR_TYPE_RADIX;\n\tcur_cpu_spec->mmu_features |= MMU_FTRS_HASH_BASE;\n\tcur_cpu_spec->mmu_features |= MMU_FTR_GTSE;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_HAS_MMU;\n\n\treturn 1;\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define MMU_FTRS_HASH_BASE (MMU_FTRS_POWER8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\n#define MMU_FTRS_HASH_BASE (MMU_FTRS_POWER8)\n\nstatic int __init feat_enable_mmu_radix(struct dt_cpu_feature *f)\n{\n#ifdef CONFIG_PPC_RADIX_MMU\n\tcur_cpu_spec->mmu_features |= MMU_FTR_TYPE_RADIX;\n\tcur_cpu_spec->mmu_features |= MMU_FTRS_HASH_BASE;\n\tcur_cpu_spec->mmu_features |= MMU_FTR_GTSE;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_HAS_MMU;\n\n\treturn 1;\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "feat_enable_mmu_hash_v3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "316-329",
    "snippet": "static int __init feat_enable_mmu_hash_v3(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\tsystem_registers.lpcr_clear |= (LPCR_ISL | LPCR_UPRT | LPCR_HR);\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr &= ~(LPCR_ISL | LPCR_UPRT | LPCR_HR);\n\tmtspr(SPRN_LPCR, lpcr);\n\n\tcur_cpu_spec->mmu_features |= MMU_FTRS_HASH_BASE;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_HAS_MMU;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define MMU_FTRS_HASH_BASE (MMU_FTRS_POWER8)"
    ],
    "globals_used": [
      "static struct {\n\tu64\tlpcr;\n\tu64\tlpcr_clear;\n\tu64\thfscr;\n\tu64\tfscr;\n\tu64\tpcr;\n} system_registers;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\n#define MMU_FTRS_HASH_BASE (MMU_FTRS_POWER8)\n\nstatic struct {\n\tu64\tlpcr;\n\tu64\tlpcr_clear;\n\tu64\thfscr;\n\tu64\tfscr;\n\tu64\tpcr;\n} system_registers;\n\nstatic int __init feat_enable_mmu_hash_v3(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\tsystem_registers.lpcr_clear |= (LPCR_ISL | LPCR_UPRT | LPCR_HR);\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr &= ~(LPCR_ISL | LPCR_UPRT | LPCR_HR);\n\tmtspr(SPRN_LPCR, lpcr);\n\n\tcur_cpu_spec->mmu_features |= MMU_FTRS_HASH_BASE;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_HAS_MMU;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_mmu_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "297-314",
    "snippet": "static int __init feat_enable_mmu_hash(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr &= ~LPCR_ISL;\n\n\t/* VRMASD */\n\tlpcr |= LPCR_VPM0;\n\tlpcr &= ~LPCR_VPM1;\n\tlpcr |= 0x10UL << LPCR_VRMASD_SH; /* L=1 LP=00 */\n\tmtspr(SPRN_LPCR, lpcr);\n\n\tcur_cpu_spec->mmu_features |= MMU_FTRS_HASH_BASE;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_HAS_MMU;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define MMU_FTRS_HASH_BASE (MMU_FTRS_POWER8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\n#define MMU_FTRS_HASH_BASE (MMU_FTRS_POWER8)\n\nstatic int __init feat_enable_mmu_hash(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr &= ~LPCR_ISL;\n\n\t/* VRMASD */\n\tlpcr |= LPCR_VPM0;\n\tlpcr &= ~LPCR_VPM1;\n\tlpcr |= 0x10UL << LPCR_VRMASD_SH; /* L=1 LP=00 */\n\tmtspr(SPRN_LPCR, lpcr);\n\n\tcur_cpu_spec->mmu_features |= MMU_FTRS_HASH_BASE;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_HAS_MMU;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_idle_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "283-295",
    "snippet": "static int __init feat_enable_idle_stop(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\t/* Set PECE wakeup modes for ISAv3.0B */\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr |=  LPCR_PECE0;\n\tlpcr |=  LPCR_PECE1;\n\tlpcr |=  LPCR_PECE2;\n\tmtspr(SPRN_LPCR, lpcr);\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_idle_stop(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\t/* Set PECE wakeup modes for ISAv3.0B */\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr |=  LPCR_PECE0;\n\tlpcr |=  LPCR_PECE1;\n\tlpcr |=  LPCR_PECE2;\n\tmtspr(SPRN_LPCR, lpcr);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_align_dsisr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "276-281",
    "snippet": "static int __init feat_enable_align_dsisr(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->cpu_features &= ~CPU_FTR_NODSISRALIGN;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_align_dsisr(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->cpu_features &= ~CPU_FTR_NODSISRALIGN;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_idle_nap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "262-274",
    "snippet": "static int __init feat_enable_idle_nap(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\t/* Set PECE wakeup modes for ISA 207 */\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr |=  LPCR_PECE0;\n\tlpcr |=  LPCR_PECE1;\n\tlpcr |=  LPCR_PECE2;\n\tmtspr(SPRN_LPCR, lpcr);\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_idle_nap(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\t/* Set PECE wakeup modes for ISA 207 */\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr |=  LPCR_PECE0;\n\tlpcr |=  LPCR_PECE1;\n\tlpcr |=  LPCR_PECE2;\n\tmtspr(SPRN_LPCR, lpcr);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_smt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "255-260",
    "snippet": "static int __init feat_enable_smt(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->cpu_features |= CPU_FTR_SMT;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_SMT;\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_smt(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->cpu_features |= CPU_FTR_SMT;\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_SMT;\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_le",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "249-253",
    "snippet": "static int __init feat_enable_le(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_TRUE_LE;\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_enable_le(struct dt_cpu_feature *f)\n{\n\tcur_cpu_spec->cpu_user_features |= PPC_FEATURE_TRUE_LE;\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_enable_hv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "229-247",
    "snippet": "static int __init feat_enable_hv(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\tif (!hv_mode) {\n\t\tpr_err(\"CPU feature hypervisor present in device tree but HV mode not enabled in the CPU. Ignoring.\\n\");\n\t\treturn 0;\n\t}\n\n\tmtspr(SPRN_LPID, 0);\n\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr &=  ~LPCR_LPES0; /* HV external interrupts */\n\tmtspr(SPRN_LPCR, lpcr);\n\n\tcur_cpu_spec->cpu_features |= CPU_FTR_HVMODE;\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int hv_mode;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPID",
            "0"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"CPU feature hypervisor present in device tree but HV mode not enabled in the CPU. Ignoring.\\n\""
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\n\nstatic int __init feat_enable_hv(struct dt_cpu_feature *f)\n{\n\tu64 lpcr;\n\n\tif (!hv_mode) {\n\t\tpr_err(\"CPU feature hypervisor present in device tree but HV mode not enabled in the CPU. Ignoring.\\n\");\n\t\treturn 0;\n\t}\n\n\tmtspr(SPRN_LPID, 0);\n\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr &=  ~LPCR_LPES0; /* HV external interrupts */\n\tmtspr(SPRN_LPCR, lpcr);\n\n\tcur_cpu_spec->cpu_features |= CPU_FTR_HVMODE;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "224-227",
    "snippet": "static int __init feat_disable(struct dt_cpu_feature *f)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int __init feat_disable(struct dt_cpu_feature *f)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "feat_enable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "191-222",
    "snippet": "static int __init feat_enable(struct dt_cpu_feature *f)\n{\n\tif (f->hv_support != HV_SUPPORT_NONE) {\n\t\tif (f->hfscr_bit_nr != -1) {\n\t\t\tu64 hfscr = mfspr(SPRN_HFSCR);\n\t\t\thfscr |= 1UL << f->hfscr_bit_nr;\n\t\t\tmtspr(SPRN_HFSCR, hfscr);\n\t\t}\n\t}\n\n\tif (f->os_support != OS_SUPPORT_NONE) {\n\t\tif (f->fscr_bit_nr != -1) {\n\t\t\tu64 fscr = mfspr(SPRN_FSCR);\n\t\t\tfscr |= 1UL << f->fscr_bit_nr;\n\t\t\tmtspr(SPRN_FSCR, fscr);\n\t\t}\n\t}\n\n\tif ((f->usable_privilege & USABLE_PR) && (f->hwcap_bit_nr != -1)) {\n\t\tuint32_t word = f->hwcap_bit_nr / 32;\n\t\tuint32_t bit = f->hwcap_bit_nr % 32;\n\n\t\tif (word == 0)\n\t\t\tcur_cpu_spec->cpu_user_features |= 1U << bit;\n\t\telse if (word == 1)\n\t\t\tcur_cpu_spec->cpu_user_features2 |= 1U << bit;\n\t\telse\n\t\t\tpr_err(\"CPU feature: %s could not advertise to user (no hwcap bits)\\n\", f->name);\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define OS_SUPPORT_NONE\t\t0xffffffffU",
      "#define HV_SUPPORT_NONE\t\t0xffffffffU",
      "#define USABLE_PR               (1U << 0)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"CPU feature: %s could not advertise to user (no hwcap bits)\\n\"",
            "f->name"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_FSCR",
            "fscr"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_FSCR"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_HFSCR",
            "hfscr"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_HFSCR"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\n#define OS_SUPPORT_NONE\t\t0xffffffffU\n#define HV_SUPPORT_NONE\t\t0xffffffffU\n#define USABLE_PR               (1U << 0)\n\nstatic int __init feat_enable(struct dt_cpu_feature *f)\n{\n\tif (f->hv_support != HV_SUPPORT_NONE) {\n\t\tif (f->hfscr_bit_nr != -1) {\n\t\t\tu64 hfscr = mfspr(SPRN_HFSCR);\n\t\t\thfscr |= 1UL << f->hfscr_bit_nr;\n\t\t\tmtspr(SPRN_HFSCR, hfscr);\n\t\t}\n\t}\n\n\tif (f->os_support != OS_SUPPORT_NONE) {\n\t\tif (f->fscr_bit_nr != -1) {\n\t\t\tu64 fscr = mfspr(SPRN_FSCR);\n\t\t\tfscr |= 1UL << f->fscr_bit_nr;\n\t\t\tmtspr(SPRN_FSCR, fscr);\n\t\t}\n\t}\n\n\tif ((f->usable_privilege & USABLE_PR) && (f->hwcap_bit_nr != -1)) {\n\t\tuint32_t word = f->hwcap_bit_nr / 32;\n\t\tuint32_t bit = f->hwcap_bit_nr % 32;\n\n\t\tif (word == 0)\n\t\t\tcur_cpu_spec->cpu_user_features |= 1U << bit;\n\t\telse if (word == 1)\n\t\t\tcur_cpu_spec->cpu_user_features2 |= 1U << bit;\n\t\telse\n\t\t\tpr_err(\"CPU feature: %s could not advertise to user (no hwcap bits)\\n\", f->name);\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "feat_try_enable_unknown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "154-189",
    "snippet": "static int __init feat_try_enable_unknown(struct dt_cpu_feature *f)\n{\n\tif (f->hv_support == HV_SUPPORT_NONE) {\n\t} else if (f->hv_support & HV_SUPPORT_HFSCR) {\n\t\tu64 hfscr = mfspr(SPRN_HFSCR);\n\t\thfscr |= 1UL << f->hfscr_bit_nr;\n\t\tmtspr(SPRN_HFSCR, hfscr);\n\t} else {\n\t\t/* Does not have a known recipe */\n\t\treturn 0;\n\t}\n\n\tif (f->os_support == OS_SUPPORT_NONE) {\n\t} else if (f->os_support & OS_SUPPORT_FSCR) {\n\t\tu64 fscr = mfspr(SPRN_FSCR);\n\t\tfscr |= 1UL << f->fscr_bit_nr;\n\t\tmtspr(SPRN_FSCR, fscr);\n\t} else {\n\t\t/* Does not have a known recipe */\n\t\treturn 0;\n\t}\n\n\tif ((f->usable_privilege & USABLE_PR) && (f->hwcap_bit_nr != -1)) {\n\t\tuint32_t word = f->hwcap_bit_nr / 32;\n\t\tuint32_t bit = f->hwcap_bit_nr % 32;\n\n\t\tif (word == 0)\n\t\t\tcur_cpu_spec->cpu_user_features |= 1U << bit;\n\t\telse if (word == 1)\n\t\t\tcur_cpu_spec->cpu_user_features2 |= 1U << bit;\n\t\telse\n\t\t\tpr_err(\"%s could not advertise to user (no hwcap bits)\\n\", f->name);\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define OS_SUPPORT_NONE\t\t0xffffffffU",
      "#define HV_SUPPORT_NONE\t\t0xffffffffU",
      "#define OS_SUPPORT_FSCR         (1U << 0)",
      "#define HV_SUPPORT_HFSCR        (1U << 0)",
      "#define USABLE_PR               (1U << 0)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s could not advertise to user (no hwcap bits)\\n\"",
            "f->name"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_FSCR",
            "fscr"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_FSCR"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_HFSCR",
            "hfscr"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_HFSCR"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\n#define OS_SUPPORT_NONE\t\t0xffffffffU\n#define HV_SUPPORT_NONE\t\t0xffffffffU\n#define OS_SUPPORT_FSCR         (1U << 0)\n#define HV_SUPPORT_HFSCR        (1U << 0)\n#define USABLE_PR               (1U << 0)\n\nstatic int __init feat_try_enable_unknown(struct dt_cpu_feature *f)\n{\n\tif (f->hv_support == HV_SUPPORT_NONE) {\n\t} else if (f->hv_support & HV_SUPPORT_HFSCR) {\n\t\tu64 hfscr = mfspr(SPRN_HFSCR);\n\t\thfscr |= 1UL << f->hfscr_bit_nr;\n\t\tmtspr(SPRN_HFSCR, hfscr);\n\t} else {\n\t\t/* Does not have a known recipe */\n\t\treturn 0;\n\t}\n\n\tif (f->os_support == OS_SUPPORT_NONE) {\n\t} else if (f->os_support & OS_SUPPORT_FSCR) {\n\t\tu64 fscr = mfspr(SPRN_FSCR);\n\t\tfscr |= 1UL << f->fscr_bit_nr;\n\t\tmtspr(SPRN_FSCR, fscr);\n\t} else {\n\t\t/* Does not have a known recipe */\n\t\treturn 0;\n\t}\n\n\tif ((f->usable_privilege & USABLE_PR) && (f->hwcap_bit_nr != -1)) {\n\t\tuint32_t word = f->hwcap_bit_nr / 32;\n\t\tuint32_t bit = f->hwcap_bit_nr % 32;\n\n\t\tif (word == 0)\n\t\t\tcur_cpu_spec->cpu_user_features |= 1U << bit;\n\t\telse if (word == 1)\n\t\t\tcur_cpu_spec->cpu_user_features2 |= 1U << bit;\n\t\telse\n\t\t\tpr_err(\"%s could not advertise to user (no hwcap bits)\\n\", f->name);\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "cpufeatures_setup_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "131-152",
    "snippet": "static void __init cpufeatures_setup_cpu(void)\n{\n\tset_cur_cpu_spec(&base_cpu_spec);\n\n\tcur_cpu_spec->pvr_mask = -1;\n\tcur_cpu_spec->pvr_value = mfspr(SPRN_PVR);\n\n\t/* Initialize the base environment -- clear FSCR/HFSCR.  */\n\thv_mode = !!(mfmsr() & MSR_HV);\n\tif (hv_mode) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_HVMODE;\n\t\tmtspr(SPRN_HFSCR, 0);\n\t}\n\tmtspr(SPRN_FSCR, 0);\n\tmtspr(SPRN_PCR, PCR_MASK);\n\n\t/*\n\t * LPCR does not get cleared, to match behaviour with secondaries\n\t * in __restore_cpu_cpufeatures. Once the idle code is fixed, this\n\t * could clear LPCR too.\n\t */\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int hv_mode;",
      "static struct cpu_spec __initdata base_cpu_spec = {\n\t.cpu_name\t\t= NULL,\n\t.cpu_features\t\t= CPU_FTRS_DT_CPU_BASE,\n\t.cpu_user_features\t= COMMON_USER_BASE,\n\t.cpu_user_features2\t= COMMON_USER2_BASE,\n\t.mmu_features\t\t= 0,\n\t.icache_bsize\t\t= 32, /* minimum block size, fixed by */\n\t.dcache_bsize\t\t= 32, /* cache info init.             */\n\t.num_pmcs\t\t= 0,\n\t.pmc_type\t\t= PPC_PMC_DEFAULT,\n\t.oprofile_cpu_type\t= NULL,\n\t.oprofile_type\t\t= PPC_OPROFILE_INVALID,\n\t.cpu_setup\t\t= NULL,\n\t.cpu_restore\t\t= __restore_cpu_cpufeatures,\n\t.machine_check_early\t= NULL,\n\t.platform\t\t= NULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PCR",
            "PCR_MASK"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_FSCR",
            "0"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_HFSCR",
            "0"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfmsr",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PVR"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cur_cpu_spec",
          "args": [
            "&base_cpu_spec"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "set_cur_cpu_spec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cputable.c",
          "lines": "2081-2093",
          "snippet": "void __init set_cur_cpu_spec(struct cpu_spec *s)\n{\n\tstruct cpu_spec *t = &the_cpu_spec;\n\n\tt = PTRRELOC(t);\n\t/*\n\t * use memcpy() instead of *t = *s so that GCC replaces it\n\t * by __memcpy() when KASAN is active\n\t */\n\tmemcpy(t, s, sizeof(*t));\n\n\t*PTRRELOC(&cur_cpu_spec) = &the_cpu_spec;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/prom.h>\t\t/* for PTRRELOC on ARCH=ppc */",
            "#include <asm/cputable.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/threads.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct cpu_spec the_cpu_spec",
            "struct cpu_spec* cur_cpu_spec"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/prom.h>\t\t/* for PTRRELOC on ARCH=ppc */\n#include <asm/cputable.h>\n#include <asm/oprofile_impl.h>\n#include <linux/jump_label.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/threads.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n\nstatic struct cpu_spec the_cpu_spec;\nstruct cpu_spec* cur_cpu_spec;\n\nvoid __init set_cur_cpu_spec(struct cpu_spec *s)\n{\n\tstruct cpu_spec *t = &the_cpu_spec;\n\n\tt = PTRRELOC(t);\n\t/*\n\t * use memcpy() instead of *t = *s so that GCC replaces it\n\t * by __memcpy() when KASAN is active\n\t */\n\tmemcpy(t, s, sizeof(*t));\n\n\t*PTRRELOC(&cur_cpu_spec) = &the_cpu_spec;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\nstatic struct cpu_spec __initdata base_cpu_spec = {\n\t.cpu_name\t\t= NULL,\n\t.cpu_features\t\t= CPU_FTRS_DT_CPU_BASE,\n\t.cpu_user_features\t= COMMON_USER_BASE,\n\t.cpu_user_features2\t= COMMON_USER2_BASE,\n\t.mmu_features\t\t= 0,\n\t.icache_bsize\t\t= 32, /* minimum block size, fixed by */\n\t.dcache_bsize\t\t= 32, /* cache info init.             */\n\t.num_pmcs\t\t= 0,\n\t.pmc_type\t\t= PPC_PMC_DEFAULT,\n\t.oprofile_cpu_type\t= NULL,\n\t.oprofile_type\t\t= PPC_OPROFILE_INVALID,\n\t.cpu_setup\t\t= NULL,\n\t.cpu_restore\t\t= __restore_cpu_cpufeatures,\n\t.machine_check_early\t= NULL,\n\t.platform\t\t= NULL,\n};\n\nstatic void __init cpufeatures_setup_cpu(void)\n{\n\tset_cur_cpu_spec(&base_cpu_spec);\n\n\tcur_cpu_spec->pvr_mask = -1;\n\tcur_cpu_spec->pvr_value = mfspr(SPRN_PVR);\n\n\t/* Initialize the base environment -- clear FSCR/HFSCR.  */\n\thv_mode = !!(mfmsr() & MSR_HV);\n\tif (hv_mode) {\n\t\tcur_cpu_spec->cpu_features |= CPU_FTR_HVMODE;\n\t\tmtspr(SPRN_HFSCR, 0);\n\t}\n\tmtspr(SPRN_FSCR, 0);\n\tmtspr(SPRN_PCR, PCR_MASK);\n\n\t/*\n\t * LPCR does not get cleared, to match behaviour with secondaries\n\t * in __restore_cpu_cpufeatures. Once the idle code is fixed, this\n\t * could clear LPCR too.\n\t */\n}"
  },
  {
    "function_name": "__restore_cpu_cpufeatures",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
    "lines": "80-109",
    "snippet": "static void __restore_cpu_cpufeatures(void)\n{\n\tu64 lpcr;\n\n\t/*\n\t * LPCR is restored by the power on engine already. It can be changed\n\t * after early init e.g., by radix enable, and we have no unified API\n\t * for saving and restoring such SPRs.\n\t *\n\t * This ->restore hook should really be removed from idle and register\n\t * restore moved directly into the idle restore code, because this code\n\t * doesn't know how idle is implemented or what it needs restored here.\n\t *\n\t * The best we can do to accommodate secondary boot and idle restore\n\t * for now is \"or\" LPCR with existing.\n\t */\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr |= system_registers.lpcr;\n\tlpcr &= ~system_registers.lpcr_clear;\n\tmtspr(SPRN_LPCR, lpcr);\n\tif (hv_mode) {\n\t\tmtspr(SPRN_LPID, 0);\n\t\tmtspr(SPRN_HFSCR, system_registers.hfscr);\n\t\tmtspr(SPRN_PCR, system_registers.pcr);\n\t}\n\tmtspr(SPRN_FSCR, system_registers.fscr);\n\n\tif (init_pmu_registers)\n\t\tinit_pmu_registers();\n}",
    "includes": [
      "#include <asm/setup.h>",
      "#include <asm/prom.h>",
      "#include <asm/oprofile_impl.h>",
      "#include <asm/mmu.h>",
      "#include <asm/mce.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <linux/threads.h>",
      "#include <linux/string.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/memblock.h>",
      "#include <linux/libfdt.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/init.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int hv_mode;",
      "static struct {\n\tu64\tlpcr;\n\tu64\tlpcr_clear;\n\tu64\thfscr;\n\tu64\tfscr;\n\tu64\tpcr;\n} system_registers;",
      "static void (*init_pmu_registers)(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_pmu_registers",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_FSCR",
            "system_registers.fscr"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_PCR",
            "system_registers.pcr"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_HFSCR",
            "system_registers.hfscr"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPID",
            "0"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nstatic int hv_mode;\nstatic struct {\n\tu64\tlpcr;\n\tu64\tlpcr_clear;\n\tu64\thfscr;\n\tu64\tfscr;\n\tu64\tpcr;\n} system_registers;\nstatic void (*init_pmu_registers)(void);\n\nstatic void __restore_cpu_cpufeatures(void)\n{\n\tu64 lpcr;\n\n\t/*\n\t * LPCR is restored by the power on engine already. It can be changed\n\t * after early init e.g., by radix enable, and we have no unified API\n\t * for saving and restoring such SPRs.\n\t *\n\t * This ->restore hook should really be removed from idle and register\n\t * restore moved directly into the idle restore code, because this code\n\t * doesn't know how idle is implemented or what it needs restored here.\n\t *\n\t * The best we can do to accommodate secondary boot and idle restore\n\t * for now is \"or\" LPCR with existing.\n\t */\n\tlpcr = mfspr(SPRN_LPCR);\n\tlpcr |= system_registers.lpcr;\n\tlpcr &= ~system_registers.lpcr_clear;\n\tmtspr(SPRN_LPCR, lpcr);\n\tif (hv_mode) {\n\t\tmtspr(SPRN_LPID, 0);\n\t\tmtspr(SPRN_HFSCR, system_registers.hfscr);\n\t\tmtspr(SPRN_PCR, system_registers.pcr);\n\t}\n\tmtspr(SPRN_FSCR, system_registers.fscr);\n\n\tif (init_pmu_registers)\n\t\tinit_pmu_registers();\n}"
  }
]