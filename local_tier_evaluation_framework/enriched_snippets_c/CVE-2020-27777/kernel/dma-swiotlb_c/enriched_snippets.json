[
  {
    "function_name": "check_swiotlb_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dma-swiotlb.c",
    "lines": "20-28",
    "snippet": "static int __init check_swiotlb_enabled(void)\n{\n\tif (ppc_swiotlb_enable)\n\t\tswiotlb_print_info();\n\telse\n\t\tswiotlb_exit();\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/swiotlb.h>",
      "#include <asm/machdep.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned int ppc_swiotlb_enable;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "swiotlb_exit",
          "args": [],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swiotlb_print_info",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/swiotlb.h>\n#include <asm/machdep.h>\n#include <linux/memblock.h>\n\nunsigned int ppc_swiotlb_enable;\n\nstatic int __init check_swiotlb_enabled(void)\n{\n\tif (ppc_swiotlb_enable)\n\t\tswiotlb_print_info();\n\telse\n\t\tswiotlb_exit();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "swiotlb_detect_4g",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dma-swiotlb.c",
    "lines": "14-18",
    "snippet": "void __init swiotlb_detect_4g(void)\n{\n\tif ((memblock_end_of_DRAM() - 1) > 0xffffffff)\n\t\tppc_swiotlb_enable = 1;\n}",
    "includes": [
      "#include <asm/swiotlb.h>",
      "#include <asm/machdep.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned int ppc_swiotlb_enable;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memblock_end_of_DRAM",
          "args": [],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/swiotlb.h>\n#include <asm/machdep.h>\n#include <linux/memblock.h>\n\nunsigned int ppc_swiotlb_enable;\n\nvoid __init swiotlb_detect_4g(void)\n{\n\tif ((memblock_end_of_DRAM() - 1) > 0xffffffff)\n\t\tppc_swiotlb_enable = 1;\n}"
  }
]