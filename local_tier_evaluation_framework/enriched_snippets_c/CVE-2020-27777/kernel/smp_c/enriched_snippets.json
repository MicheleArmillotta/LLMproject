[
  {
    "function_name": "arch_cpu_idle_dead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1544-1559",
    "snippet": "void arch_cpu_idle_dead(void)\n{\n\tsched_preempt_enable_no_resched();\n\n\t/*\n\t * Disable on the down path. This will be re-enabled by\n\t * start_secondary() via start_secondary_resume() below\n\t */\n\tthis_cpu_disable_ftrace();\n\n\tif (smp_ops->cpu_offline_self)\n\t\tsmp_ops->cpu_offline_self();\n\n\t/* If we return, we re-enter start_secondary */\n\tstart_secondary_resume();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "start_secondary_resume",
          "args": [],
          "line": 1558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->cpu_offline_self",
          "args": [],
          "line": 1555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_disable_ftrace",
          "args": [],
          "line": 1552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sched_preempt_enable_no_resched",
          "args": [],
          "line": 1546
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid arch_cpu_idle_dead(void)\n{\n\tsched_preempt_enable_no_resched();\n\n\t/*\n\t * Disable on the down path. This will be re-enabled by\n\t * start_secondary() via start_secondary_resume() below\n\t */\n\tthis_cpu_disable_ftrace();\n\n\tif (smp_ops->cpu_offline_self)\n\t\tsmp_ops->cpu_offline_self();\n\n\t/* If we return, we re-enter start_secondary */\n\tstart_secondary_resume();\n}"
  },
  {
    "function_name": "__cpu_die",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1538-1542",
    "snippet": "void __cpu_die(unsigned int cpu)\n{\n\tif (smp_ops->cpu_die)\n\t\tsmp_ops->cpu_die(cpu);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_ops->cpu_die",
          "args": [
            "cpu"
          ],
          "line": 1541
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid __cpu_die(unsigned int cpu)\n{\n\tif (smp_ops->cpu_die)\n\t\tsmp_ops->cpu_die(cpu);\n}"
  },
  {
    "function_name": "__cpu_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1518-1536",
    "snippet": "int __cpu_disable(void)\n{\n\tint cpu = smp_processor_id();\n\tint err;\n\n\tif (!smp_ops->cpu_disable)\n\t\treturn -ENOSYS;\n\n\tthis_cpu_disable_ftrace();\n\n\terr = smp_ops->cpu_disable();\n\tif (err)\n\t\treturn err;\n\n\t/* Update sibling maps */\n\tremove_cpu_from_masks(cpu);\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove_cpu_from_masks",
          "args": [
            "cpu"
          ],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "remove_cpu_from_masks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1303-1322",
          "snippet": "static void remove_cpu_from_masks(int cpu)\n{\n\tstruct cpumask *(*mask_fn)(int) = cpu_sibling_mask;\n\tint i;\n\n\tif (shared_caches)\n\t\tmask_fn = cpu_l2_cache_mask;\n\n\tfor_each_cpu(i, mask_fn(cpu)) {\n\t\tset_cpus_unrelated(cpu, i, cpu_l2_cache_mask);\n\t\tset_cpus_unrelated(cpu, i, cpu_sibling_mask);\n\t\tif (has_big_cores)\n\t\t\tset_cpus_unrelated(cpu, i, cpu_smallcore_mask);\n\t}\n\n\tif (has_coregroup_support()) {\n\t\tfor_each_cpu(i, cpu_coregroup_mask(cpu))\n\t\t\tset_cpus_unrelated(cpu, i, cpu_coregroup_mask);\n\t}\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool has_big_cores;",
            "static bool shared_caches;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\nstatic bool shared_caches;\n\nstatic void remove_cpu_from_masks(int cpu)\n{\n\tstruct cpumask *(*mask_fn)(int) = cpu_sibling_mask;\n\tint i;\n\n\tif (shared_caches)\n\t\tmask_fn = cpu_l2_cache_mask;\n\n\tfor_each_cpu(i, mask_fn(cpu)) {\n\t\tset_cpus_unrelated(cpu, i, cpu_l2_cache_mask);\n\t\tset_cpus_unrelated(cpu, i, cpu_sibling_mask);\n\t\tif (has_big_cores)\n\t\t\tset_cpus_unrelated(cpu, i, cpu_smallcore_mask);\n\t}\n\n\tif (has_coregroup_support()) {\n\t\tfor_each_cpu(i, cpu_coregroup_mask(cpu))\n\t\t\tset_cpus_unrelated(cpu, i, cpu_coregroup_mask);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_ops->cpu_disable",
          "args": [],
          "line": 1528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_disable_ftrace",
          "args": [],
          "line": 1526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nint __cpu_disable(void)\n{\n\tint cpu = smp_processor_id();\n\tint err;\n\n\tif (!smp_ops->cpu_disable)\n\t\treturn -ENOSYS;\n\n\tthis_cpu_disable_ftrace();\n\n\terr = smp_ops->cpu_disable();\n\tif (err)\n\t\treturn err;\n\n\t/* Update sibling maps */\n\tremove_cpu_from_masks(cpu);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "smp_cpus_done",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1500-1515",
    "snippet": "void __init smp_cpus_done(unsigned int max_cpus)\n{\n\t/*\n\t * We are running pinned to the boot CPU, see rest_init().\n\t */\n\tif (smp_ops && smp_ops->setup_cpu)\n\t\tsmp_ops->setup_cpu(boot_cpuid);\n\n\tif (smp_ops && smp_ops->bringup_done)\n\t\tsmp_ops->bringup_done();\n\n\tdump_numa_cpu_topology();\n\n\tfixup_topology();\n\tset_sched_topology(powerpc_topology);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;",
      "static struct sched_domain_topology_level powerpc_topology[] = {\n#ifdef CONFIG_SCHED_SMT\n\t{ cpu_smt_mask, powerpc_smt_flags, SD_INIT_NAME(SMT) },\n#endif\n\t{ shared_cache_mask, powerpc_shared_cache_flags, SD_INIT_NAME(CACHE) },\n\t{ cpu_mc_mask, SD_INIT_NAME(MC) },\n\t{ cpu_cpu_mask, SD_INIT_NAME(DIE) },\n\t{ NULL, },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_sched_topology",
          "args": [
            "powerpc_topology"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fixup_topology",
          "args": [],
          "line": 1513
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_topology",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1461-1498",
          "snippet": "static void fixup_topology(void)\n{\n\tint i;\n\n#ifdef CONFIG_SCHED_SMT\n\tif (has_big_cores) {\n\t\tpr_info(\"Big cores detected but using small core scheduling\\n\");\n\t\tpowerpc_topology[smt_idx].mask = smallcore_smt_mask;\n\t}\n#endif\n\n\tif (!has_coregroup_support())\n\t\tpowerpc_topology[mc_idx].mask = powerpc_topology[cache_idx].mask;\n\n\t/*\n\t * Try to consolidate topology levels here instead of\n\t * allowing scheduler to degenerate.\n\t * - Dont consolidate if masks are different.\n\t * - Dont consolidate if sd_flags exists and are different.\n\t */\n\tfor (i = 1; i <= die_idx; i++) {\n\t\tif (powerpc_topology[i].mask != powerpc_topology[i - 1].mask)\n\t\t\tcontinue;\n\n\t\tif (powerpc_topology[i].sd_flags && powerpc_topology[i - 1].sd_flags &&\n\t\t\t\tpowerpc_topology[i].sd_flags != powerpc_topology[i - 1].sd_flags)\n\t\t\tcontinue;\n\n\t\tif (!powerpc_topology[i - 1].sd_flags)\n\t\t\tpowerpc_topology[i - 1].sd_flags = powerpc_topology[i].sd_flags;\n\n\t\tpowerpc_topology[i].mask = powerpc_topology[i + 1].mask;\n\t\tpowerpc_topology[i].sd_flags = powerpc_topology[i + 1].sd_flags;\n#ifdef CONFIG_SCHED_DEBUG\n\t\tpowerpc_topology[i].name = powerpc_topology[i + 1].name;\n#endif\n\t}\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool has_big_cores;",
            "static struct sched_domain_topology_level powerpc_topology[] = {\n#ifdef CONFIG_SCHED_SMT\n\t{ cpu_smt_mask, powerpc_smt_flags, SD_INIT_NAME(SMT) },\n#endif\n\t{ shared_cache_mask, powerpc_shared_cache_flags, SD_INIT_NAME(CACHE) },\n\t{ cpu_mc_mask, SD_INIT_NAME(MC) },\n\t{ cpu_cpu_mask, SD_INIT_NAME(DIE) },\n\t{ NULL, },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\nstatic struct sched_domain_topology_level powerpc_topology[] = {\n#ifdef CONFIG_SCHED_SMT\n\t{ cpu_smt_mask, powerpc_smt_flags, SD_INIT_NAME(SMT) },\n#endif\n\t{ shared_cache_mask, powerpc_shared_cache_flags, SD_INIT_NAME(CACHE) },\n\t{ cpu_mc_mask, SD_INIT_NAME(MC) },\n\t{ cpu_cpu_mask, SD_INIT_NAME(DIE) },\n\t{ NULL, },\n};\n\nstatic void fixup_topology(void)\n{\n\tint i;\n\n#ifdef CONFIG_SCHED_SMT\n\tif (has_big_cores) {\n\t\tpr_info(\"Big cores detected but using small core scheduling\\n\");\n\t\tpowerpc_topology[smt_idx].mask = smallcore_smt_mask;\n\t}\n#endif\n\n\tif (!has_coregroup_support())\n\t\tpowerpc_topology[mc_idx].mask = powerpc_topology[cache_idx].mask;\n\n\t/*\n\t * Try to consolidate topology levels here instead of\n\t * allowing scheduler to degenerate.\n\t * - Dont consolidate if masks are different.\n\t * - Dont consolidate if sd_flags exists and are different.\n\t */\n\tfor (i = 1; i <= die_idx; i++) {\n\t\tif (powerpc_topology[i].mask != powerpc_topology[i - 1].mask)\n\t\t\tcontinue;\n\n\t\tif (powerpc_topology[i].sd_flags && powerpc_topology[i - 1].sd_flags &&\n\t\t\t\tpowerpc_topology[i].sd_flags != powerpc_topology[i - 1].sd_flags)\n\t\t\tcontinue;\n\n\t\tif (!powerpc_topology[i - 1].sd_flags)\n\t\t\tpowerpc_topology[i - 1].sd_flags = powerpc_topology[i].sd_flags;\n\n\t\tpowerpc_topology[i].mask = powerpc_topology[i + 1].mask;\n\t\tpowerpc_topology[i].sd_flags = powerpc_topology[i + 1].sd_flags;\n#ifdef CONFIG_SCHED_DEBUG\n\t\tpowerpc_topology[i].name = powerpc_topology[i + 1].name;\n#endif\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_numa_cpu_topology",
          "args": [],
          "line": 1511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->bringup_done",
          "args": [],
          "line": 1509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->setup_cpu",
          "args": [
            "boot_cpuid"
          ],
          "line": 1506
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\nstatic struct sched_domain_topology_level powerpc_topology[] = {\n#ifdef CONFIG_SCHED_SMT\n\t{ cpu_smt_mask, powerpc_smt_flags, SD_INIT_NAME(SMT) },\n#endif\n\t{ shared_cache_mask, powerpc_shared_cache_flags, SD_INIT_NAME(CACHE) },\n\t{ cpu_mc_mask, SD_INIT_NAME(MC) },\n\t{ cpu_cpu_mask, SD_INIT_NAME(DIE) },\n\t{ NULL, },\n};\n\nvoid __init smp_cpus_done(unsigned int max_cpus)\n{\n\t/*\n\t * We are running pinned to the boot CPU, see rest_init().\n\t */\n\tif (smp_ops && smp_ops->setup_cpu)\n\t\tsmp_ops->setup_cpu(boot_cpuid);\n\n\tif (smp_ops && smp_ops->bringup_done)\n\t\tsmp_ops->bringup_done();\n\n\tdump_numa_cpu_topology();\n\n\tfixup_topology();\n\tset_sched_topology(powerpc_topology);\n}"
  },
  {
    "function_name": "fixup_topology",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1461-1498",
    "snippet": "static void fixup_topology(void)\n{\n\tint i;\n\n#ifdef CONFIG_SCHED_SMT\n\tif (has_big_cores) {\n\t\tpr_info(\"Big cores detected but using small core scheduling\\n\");\n\t\tpowerpc_topology[smt_idx].mask = smallcore_smt_mask;\n\t}\n#endif\n\n\tif (!has_coregroup_support())\n\t\tpowerpc_topology[mc_idx].mask = powerpc_topology[cache_idx].mask;\n\n\t/*\n\t * Try to consolidate topology levels here instead of\n\t * allowing scheduler to degenerate.\n\t * - Dont consolidate if masks are different.\n\t * - Dont consolidate if sd_flags exists and are different.\n\t */\n\tfor (i = 1; i <= die_idx; i++) {\n\t\tif (powerpc_topology[i].mask != powerpc_topology[i - 1].mask)\n\t\t\tcontinue;\n\n\t\tif (powerpc_topology[i].sd_flags && powerpc_topology[i - 1].sd_flags &&\n\t\t\t\tpowerpc_topology[i].sd_flags != powerpc_topology[i - 1].sd_flags)\n\t\t\tcontinue;\n\n\t\tif (!powerpc_topology[i - 1].sd_flags)\n\t\t\tpowerpc_topology[i - 1].sd_flags = powerpc_topology[i].sd_flags;\n\n\t\tpowerpc_topology[i].mask = powerpc_topology[i + 1].mask;\n\t\tpowerpc_topology[i].sd_flags = powerpc_topology[i + 1].sd_flags;\n#ifdef CONFIG_SCHED_DEBUG\n\t\tpowerpc_topology[i].name = powerpc_topology[i + 1].name;\n#endif\n\t}\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool has_big_cores;",
      "static struct sched_domain_topology_level powerpc_topology[] = {\n#ifdef CONFIG_SCHED_SMT\n\t{ cpu_smt_mask, powerpc_smt_flags, SD_INIT_NAME(SMT) },\n#endif\n\t{ shared_cache_mask, powerpc_shared_cache_flags, SD_INIT_NAME(CACHE) },\n\t{ cpu_mc_mask, SD_INIT_NAME(MC) },\n\t{ cpu_cpu_mask, SD_INIT_NAME(DIE) },\n\t{ NULL, },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "has_coregroup_support",
          "args": [],
          "line": 1472
        },
        "resolved": true,
        "details": {
          "function_name": "has_coregroup_support",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "902-905",
          "snippet": "static bool has_coregroup_support(void)\n{\n\treturn coregroup_enabled;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool coregroup_enabled;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool coregroup_enabled;\n\nstatic bool has_coregroup_support(void)\n{\n\treturn coregroup_enabled;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Big cores detected but using small core scheduling\\n\""
          ],
          "line": 1467
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\nstatic struct sched_domain_topology_level powerpc_topology[] = {\n#ifdef CONFIG_SCHED_SMT\n\t{ cpu_smt_mask, powerpc_smt_flags, SD_INIT_NAME(SMT) },\n#endif\n\t{ shared_cache_mask, powerpc_shared_cache_flags, SD_INIT_NAME(CACHE) },\n\t{ cpu_mc_mask, SD_INIT_NAME(MC) },\n\t{ cpu_cpu_mask, SD_INIT_NAME(DIE) },\n\t{ NULL, },\n};\n\nstatic void fixup_topology(void)\n{\n\tint i;\n\n#ifdef CONFIG_SCHED_SMT\n\tif (has_big_cores) {\n\t\tpr_info(\"Big cores detected but using small core scheduling\\n\");\n\t\tpowerpc_topology[smt_idx].mask = smallcore_smt_mask;\n\t}\n#endif\n\n\tif (!has_coregroup_support())\n\t\tpowerpc_topology[mc_idx].mask = powerpc_topology[cache_idx].mask;\n\n\t/*\n\t * Try to consolidate topology levels here instead of\n\t * allowing scheduler to degenerate.\n\t * - Dont consolidate if masks are different.\n\t * - Dont consolidate if sd_flags exists and are different.\n\t */\n\tfor (i = 1; i <= die_idx; i++) {\n\t\tif (powerpc_topology[i].mask != powerpc_topology[i - 1].mask)\n\t\t\tcontinue;\n\n\t\tif (powerpc_topology[i].sd_flags && powerpc_topology[i - 1].sd_flags &&\n\t\t\t\tpowerpc_topology[i].sd_flags != powerpc_topology[i - 1].sd_flags)\n\t\t\tcontinue;\n\n\t\tif (!powerpc_topology[i - 1].sd_flags)\n\t\t\tpowerpc_topology[i - 1].sd_flags = powerpc_topology[i].sd_flags;\n\n\t\tpowerpc_topology[i].mask = powerpc_topology[i + 1].mask;\n\t\tpowerpc_topology[i].sd_flags = powerpc_topology[i + 1].sd_flags;\n#ifdef CONFIG_SCHED_DEBUG\n\t\tpowerpc_topology[i].name = powerpc_topology[i + 1].name;\n#endif\n\t}\n}"
  },
  {
    "function_name": "setup_profiling_timer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1456-1459",
    "snippet": "int setup_profiling_timer(unsigned int multiplier)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint setup_profiling_timer(unsigned int multiplier)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "start_secondary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1394-1454",
    "snippet": "void start_secondary(void *unused)\n{\n\tunsigned int cpu = smp_processor_id();\n\n\tmmgrab(&init_mm);\n\tcurrent->active_mm = &init_mm;\n\n\tsmp_store_cpu_info(cpu);\n\tset_dec(tb_ticks_per_jiffy);\n\tpreempt_disable();\n\tcpu_callin_map[cpu] = 1;\n\n\tif (smp_ops->setup_cpu)\n\t\tsmp_ops->setup_cpu(cpu);\n\tif (smp_ops->take_timebase)\n\t\tsmp_ops->take_timebase();\n\n\tsecondary_cpu_time_init();\n\n#ifdef CONFIG_PPC64\n\tif (system_state == SYSTEM_RUNNING)\n\t\tvdso_data->processorCount++;\n\n\tvdso_getcpu_init();\n#endif\n\t/* Update topology CPU masks */\n\tadd_cpu_to_masks(cpu);\n\n\t/*\n\t * Check for any shared caches. Note that this must be done on a\n\t * per-core basis because one core in the pair might be disabled.\n\t */\n\tif (!shared_caches) {\n\t\tstruct cpumask *(*sibling_mask)(int) = cpu_sibling_mask;\n\t\tstruct cpumask *mask = cpu_l2_cache_mask(cpu);\n\n\t\tif (has_big_cores)\n\t\t\tsibling_mask = cpu_smallcore_mask;\n\n\t\tif (cpumask_weight(mask) > cpumask_weight(sibling_mask(cpu)))\n\t\t\tshared_caches = true;\n\t}\n\n\tset_numa_node(numa_cpu_lookup_table[cpu]);\n\tset_numa_mem(local_memory_node(numa_cpu_lookup_table[cpu]));\n\n\tsmp_wmb();\n\tnotify_cpu_starting(cpu);\n\tset_cpu_online(cpu, true);\n\n\tboot_init_stack_canary();\n\n\tlocal_irq_enable();\n\n\t/* We can enable ftrace for secondary cpus now */\n\tthis_cpu_enable_ftrace();\n\n\tcpu_startup_entry(CPUHP_AP_ONLINE_IDLE);\n\n\tBUG();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool has_big_cores;",
      "struct smp_ops_t *smp_ops;",
      "volatile unsigned int cpu_callin_map[NR_CPUS];",
      "static bool shared_caches;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 1453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_startup_entry",
          "args": [
            "CPUHP_AP_ONLINE_IDLE"
          ],
          "line": 1451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_enable_ftrace",
          "args": [],
          "line": 1449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 1446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boot_init_stack_canary",
          "args": [],
          "line": 1444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_online",
          "args": [
            "cpu",
            "true"
          ],
          "line": 1442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notify_cpu_starting",
          "args": [
            "cpu"
          ],
          "line": 1441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_wmb",
          "args": [],
          "line": 1440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_numa_mem",
          "args": [
            "local_memory_node(numa_cpu_lookup_table[cpu])"
          ],
          "line": 1438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_memory_node",
          "args": [
            "numa_cpu_lookup_table[cpu]"
          ],
          "line": 1438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_numa_node",
          "args": [
            "numa_cpu_lookup_table[cpu]"
          ],
          "line": 1437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_weight",
          "args": [
            "sibling_mask(cpu)"
          ],
          "line": 1433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sibling_mask",
          "args": [
            "cpu"
          ],
          "line": 1433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_weight",
          "args": [
            "mask"
          ],
          "line": 1433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_l2_cache_mask",
          "args": [
            "cpu"
          ],
          "line": 1428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_cpu_to_masks",
          "args": [
            "cpu"
          ],
          "line": 1420
        },
        "resolved": true,
        "details": {
          "function_name": "add_cpu_to_masks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1371-1391",
          "snippet": "static void add_cpu_to_masks(int cpu)\n{\n\tint first_thread = cpu_first_thread_sibling(cpu);\n\tint i;\n\n\t/*\n\t * This CPU will not be in the online mask yet so we need to manually\n\t * add it to it's own thread sibling mask.\n\t */\n\tcpumask_set_cpu(cpu, cpu_sibling_mask(cpu));\n\n\tfor (i = first_thread; i < first_thread + threads_per_core; i++)\n\t\tif (cpu_online(i))\n\t\t\tset_cpus_related(i, cpu, cpu_sibling_mask);\n\n\tadd_cpu_to_smallcore_masks(cpu);\n\tupdate_mask_by_l2(cpu);\n\n\tif (has_coregroup_support())\n\t\tupdate_coregroup_mask(cpu);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void add_cpu_to_masks(int cpu)\n{\n\tint first_thread = cpu_first_thread_sibling(cpu);\n\tint i;\n\n\t/*\n\t * This CPU will not be in the online mask yet so we need to manually\n\t * add it to it's own thread sibling mask.\n\t */\n\tcpumask_set_cpu(cpu, cpu_sibling_mask(cpu));\n\n\tfor (i = first_thread; i < first_thread + threads_per_core; i++)\n\t\tif (cpu_online(i))\n\t\t\tset_cpus_related(i, cpu, cpu_sibling_mask);\n\n\tadd_cpu_to_smallcore_masks(cpu);\n\tupdate_mask_by_l2(cpu);\n\n\tif (has_coregroup_support())\n\t\tupdate_coregroup_mask(cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vdso_getcpu_init",
          "args": [],
          "line": 1417
        },
        "resolved": true,
        "details": {
          "function_name": "vdso_getcpu_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/vdso.c",
          "lines": "666-687",
          "snippet": "int vdso_getcpu_init(void)\n{\n\tunsigned long cpu, node, val;\n\n\t/*\n\t * SPRG_VDSO contains the CPU in the bottom 16 bits and the NUMA node\n\t * in the next 16 bits.  The VDSO uses this to implement getcpu().\n\t */\n\tcpu = get_cpu();\n\tWARN_ON_ONCE(cpu > 0xffff);\n\n\tnode = cpu_to_node(cpu);\n\tWARN_ON_ONCE(node > 0xffff);\n\n\tval = (cpu & 0xffff) | ((node & 0xffff) << 16);\n\tmtspr(SPRN_SPRG_VDSO_WRITE, val);\n\tget_paca()->sprg_vdso = val;\n\n\tput_cpu();\n\n\treturn 0;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/vdso.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/vdso_datapage.h>\n#include <asm/vdso.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu_context.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nint vdso_getcpu_init(void)\n{\n\tunsigned long cpu, node, val;\n\n\t/*\n\t * SPRG_VDSO contains the CPU in the bottom 16 bits and the NUMA node\n\t * in the next 16 bits.  The VDSO uses this to implement getcpu().\n\t */\n\tcpu = get_cpu();\n\tWARN_ON_ONCE(cpu > 0xffff);\n\n\tnode = cpu_to_node(cpu);\n\tWARN_ON_ONCE(node > 0xffff);\n\n\tval = (cpu & 0xffff) | ((node & 0xffff) << 16);\n\tmtspr(SPRN_SPRG_VDSO_WRITE, val);\n\tget_paca()->sprg_vdso = val;\n\n\tput_cpu();\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "secondary_cpu_time_init",
          "args": [],
          "line": 1411
        },
        "resolved": true,
        "details": {
          "function_name": "secondary_cpu_time_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "1052-1065",
          "snippet": "void secondary_cpu_time_init(void)\n{\n\t/* Enable and test the large decrementer for this cpu */\n\tenable_large_decrementer();\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* FIME: Should make unrelatred change to move snapshot_timebase\n\t * call here ! */\n\tregister_decrementer_clockevent(smp_processor_id());\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid secondary_cpu_time_init(void)\n{\n\t/* Enable and test the large decrementer for this cpu */\n\tenable_large_decrementer();\n\n\t/* Start the decrementer on CPUs that have manual control\n\t * such as BookE\n\t */\n\tstart_cpu_decrementer();\n\n\t/* FIME: Should make unrelatred change to move snapshot_timebase\n\t * call here ! */\n\tregister_decrementer_clockevent(smp_processor_id());\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_ops->take_timebase",
          "args": [],
          "line": 1409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->setup_cpu",
          "args": [
            "cpu"
          ],
          "line": 1407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 1403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dec",
          "args": [
            "tb_ticks_per_jiffy"
          ],
          "line": 1402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_store_cpu_info",
          "args": [
            "cpu"
          ],
          "line": 1401
        },
        "resolved": true,
        "details": {
          "function_name": "smp_store_cpu_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "644-651",
          "snippet": "static void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "mmgrab",
          "args": [
            "&init_mm"
          ],
          "line": 1398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 1396
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\nstruct smp_ops_t *smp_ops;\nvolatile unsigned int cpu_callin_map[NR_CPUS];\nstatic bool shared_caches;\n\nvoid start_secondary(void *unused)\n{\n\tunsigned int cpu = smp_processor_id();\n\n\tmmgrab(&init_mm);\n\tcurrent->active_mm = &init_mm;\n\n\tsmp_store_cpu_info(cpu);\n\tset_dec(tb_ticks_per_jiffy);\n\tpreempt_disable();\n\tcpu_callin_map[cpu] = 1;\n\n\tif (smp_ops->setup_cpu)\n\t\tsmp_ops->setup_cpu(cpu);\n\tif (smp_ops->take_timebase)\n\t\tsmp_ops->take_timebase();\n\n\tsecondary_cpu_time_init();\n\n#ifdef CONFIG_PPC64\n\tif (system_state == SYSTEM_RUNNING)\n\t\tvdso_data->processorCount++;\n\n\tvdso_getcpu_init();\n#endif\n\t/* Update topology CPU masks */\n\tadd_cpu_to_masks(cpu);\n\n\t/*\n\t * Check for any shared caches. Note that this must be done on a\n\t * per-core basis because one core in the pair might be disabled.\n\t */\n\tif (!shared_caches) {\n\t\tstruct cpumask *(*sibling_mask)(int) = cpu_sibling_mask;\n\t\tstruct cpumask *mask = cpu_l2_cache_mask(cpu);\n\n\t\tif (has_big_cores)\n\t\t\tsibling_mask = cpu_smallcore_mask;\n\n\t\tif (cpumask_weight(mask) > cpumask_weight(sibling_mask(cpu)))\n\t\t\tshared_caches = true;\n\t}\n\n\tset_numa_node(numa_cpu_lookup_table[cpu]);\n\tset_numa_mem(local_memory_node(numa_cpu_lookup_table[cpu]));\n\n\tsmp_wmb();\n\tnotify_cpu_starting(cpu);\n\tset_cpu_online(cpu, true);\n\n\tboot_init_stack_canary();\n\n\tlocal_irq_enable();\n\n\t/* We can enable ftrace for secondary cpus now */\n\tthis_cpu_enable_ftrace();\n\n\tcpu_startup_entry(CPUHP_AP_ONLINE_IDLE);\n\n\tBUG();\n}"
  },
  {
    "function_name": "add_cpu_to_masks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1371-1391",
    "snippet": "static void add_cpu_to_masks(int cpu)\n{\n\tint first_thread = cpu_first_thread_sibling(cpu);\n\tint i;\n\n\t/*\n\t * This CPU will not be in the online mask yet so we need to manually\n\t * add it to it's own thread sibling mask.\n\t */\n\tcpumask_set_cpu(cpu, cpu_sibling_mask(cpu));\n\n\tfor (i = first_thread; i < first_thread + threads_per_core; i++)\n\t\tif (cpu_online(i))\n\t\t\tset_cpus_related(i, cpu, cpu_sibling_mask);\n\n\tadd_cpu_to_smallcore_masks(cpu);\n\tupdate_mask_by_l2(cpu);\n\n\tif (has_coregroup_support())\n\t\tupdate_coregroup_mask(cpu);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "update_coregroup_mask",
          "args": [
            "cpu"
          ],
          "line": 1390
        },
        "resolved": true,
        "details": {
          "function_name": "update_coregroup_mask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1340-1369",
          "snippet": "static void update_coregroup_mask(int cpu)\n{\n\tstruct cpumask *(*submask_fn)(int) = cpu_sibling_mask;\n\tcpumask_var_t mask;\n\tint coregroup_id = cpu_to_coregroup_id(cpu);\n\tint i;\n\n\talloc_cpumask_var_node(&mask, GFP_KERNEL, cpu_to_node(cpu));\n\tcpumask_and(mask, cpu_online_mask, cpu_cpu_mask(cpu));\n\n\tif (shared_caches)\n\t\tsubmask_fn = cpu_l2_cache_mask;\n\n\t/* Update coregroup mask with all the CPUs that are part of submask */\n\tor_cpumasks_related(cpu, cpu, submask_fn, cpu_coregroup_mask);\n\n\t/* Skip all CPUs already part of coregroup mask */\n\tcpumask_andnot(mask, mask, cpu_coregroup_mask(cpu));\n\n\tfor_each_cpu(i, mask) {\n\t\t/* Skip all CPUs not part of this coregroup */\n\t\tif (coregroup_id == cpu_to_coregroup_id(i)) {\n\t\t\tor_cpumasks_related(cpu, i, submask_fn, cpu_coregroup_mask);\n\t\t\tcpumask_andnot(mask, mask, submask_fn(i));\n\t\t} else {\n\t\t\tcpumask_andnot(mask, mask, cpu_coregroup_mask(i));\n\t\t}\n\t}\n\tfree_cpumask_var(mask);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool shared_caches;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic bool shared_caches;\n\nstatic void update_coregroup_mask(int cpu)\n{\n\tstruct cpumask *(*submask_fn)(int) = cpu_sibling_mask;\n\tcpumask_var_t mask;\n\tint coregroup_id = cpu_to_coregroup_id(cpu);\n\tint i;\n\n\talloc_cpumask_var_node(&mask, GFP_KERNEL, cpu_to_node(cpu));\n\tcpumask_and(mask, cpu_online_mask, cpu_cpu_mask(cpu));\n\n\tif (shared_caches)\n\t\tsubmask_fn = cpu_l2_cache_mask;\n\n\t/* Update coregroup mask with all the CPUs that are part of submask */\n\tor_cpumasks_related(cpu, cpu, submask_fn, cpu_coregroup_mask);\n\n\t/* Skip all CPUs already part of coregroup mask */\n\tcpumask_andnot(mask, mask, cpu_coregroup_mask(cpu));\n\n\tfor_each_cpu(i, mask) {\n\t\t/* Skip all CPUs not part of this coregroup */\n\t\tif (coregroup_id == cpu_to_coregroup_id(i)) {\n\t\t\tor_cpumasks_related(cpu, i, submask_fn, cpu_coregroup_mask);\n\t\t\tcpumask_andnot(mask, mask, submask_fn(i));\n\t\t} else {\n\t\t\tcpumask_andnot(mask, mask, cpu_coregroup_mask(i));\n\t\t}\n\t}\n\tfree_cpumask_var(mask);\n}"
        }
      },
      {
        "call_info": {
          "callee": "has_coregroup_support",
          "args": [],
          "line": 1389
        },
        "resolved": true,
        "details": {
          "function_name": "has_coregroup_support",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "902-905",
          "snippet": "static bool has_coregroup_support(void)\n{\n\treturn coregroup_enabled;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool coregroup_enabled;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool coregroup_enabled;\n\nstatic bool has_coregroup_support(void)\n{\n\treturn coregroup_enabled;\n}"
        }
      },
      {
        "call_info": {
          "callee": "update_mask_by_l2",
          "args": [
            "cpu"
          ],
          "line": 1387
        },
        "resolved": true,
        "details": {
          "function_name": "update_mask_by_l2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1243-1300",
          "snippet": "static bool update_mask_by_l2(int cpu)\n{\n\tstruct cpumask *(*submask_fn)(int) = cpu_sibling_mask;\n\tstruct device_node *l2_cache, *np;\n\tcpumask_var_t mask;\n\tint i;\n\n\tl2_cache = cpu_to_l2cache(cpu);\n\tif (!l2_cache) {\n\t\tstruct cpumask *(*sibling_mask)(int) = cpu_sibling_mask;\n\n\t\t/*\n\t\t * If no l2cache for this CPU, assume all siblings to share\n\t\t * cache with this CPU.\n\t\t */\n\t\tif (has_big_cores)\n\t\t\tsibling_mask = cpu_smallcore_mask;\n\n\t\tfor_each_cpu(i, sibling_mask(cpu))\n\t\t\tset_cpus_related(cpu, i, cpu_l2_cache_mask);\n\n\t\treturn false;\n\t}\n\n\talloc_cpumask_var_node(&mask, GFP_KERNEL, cpu_to_node(cpu));\n\tcpumask_and(mask, cpu_online_mask, cpu_cpu_mask(cpu));\n\n\tif (has_big_cores)\n\t\tsubmask_fn = cpu_smallcore_mask;\n\n\t/* Update l2-cache mask with all the CPUs that are part of submask */\n\tor_cpumasks_related(cpu, cpu, submask_fn, cpu_l2_cache_mask);\n\n\t/* Skip all CPUs already part of current CPU l2-cache mask */\n\tcpumask_andnot(mask, mask, cpu_l2_cache_mask(cpu));\n\n\tfor_each_cpu(i, mask) {\n\t\t/*\n\t\t * when updating the marks the current CPU has not been marked\n\t\t * online, but we need to update the cache masks\n\t\t */\n\t\tnp = cpu_to_l2cache(i);\n\n\t\t/* Skip all CPUs already part of current CPU l2-cache */\n\t\tif (np == l2_cache) {\n\t\t\tor_cpumasks_related(cpu, i, submask_fn, cpu_l2_cache_mask);\n\t\t\tcpumask_andnot(mask, mask, submask_fn(i));\n\t\t} else {\n\t\t\tcpumask_andnot(mask, mask, cpu_l2_cache_mask(i));\n\t\t}\n\n\t\tof_node_put(np);\n\t}\n\tof_node_put(l2_cache);\n\tfree_cpumask_var(mask);\n\n\treturn true;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool has_big_cores;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\n\nstatic bool update_mask_by_l2(int cpu)\n{\n\tstruct cpumask *(*submask_fn)(int) = cpu_sibling_mask;\n\tstruct device_node *l2_cache, *np;\n\tcpumask_var_t mask;\n\tint i;\n\n\tl2_cache = cpu_to_l2cache(cpu);\n\tif (!l2_cache) {\n\t\tstruct cpumask *(*sibling_mask)(int) = cpu_sibling_mask;\n\n\t\t/*\n\t\t * If no l2cache for this CPU, assume all siblings to share\n\t\t * cache with this CPU.\n\t\t */\n\t\tif (has_big_cores)\n\t\t\tsibling_mask = cpu_smallcore_mask;\n\n\t\tfor_each_cpu(i, sibling_mask(cpu))\n\t\t\tset_cpus_related(cpu, i, cpu_l2_cache_mask);\n\n\t\treturn false;\n\t}\n\n\talloc_cpumask_var_node(&mask, GFP_KERNEL, cpu_to_node(cpu));\n\tcpumask_and(mask, cpu_online_mask, cpu_cpu_mask(cpu));\n\n\tif (has_big_cores)\n\t\tsubmask_fn = cpu_smallcore_mask;\n\n\t/* Update l2-cache mask with all the CPUs that are part of submask */\n\tor_cpumasks_related(cpu, cpu, submask_fn, cpu_l2_cache_mask);\n\n\t/* Skip all CPUs already part of current CPU l2-cache mask */\n\tcpumask_andnot(mask, mask, cpu_l2_cache_mask(cpu));\n\n\tfor_each_cpu(i, mask) {\n\t\t/*\n\t\t * when updating the marks the current CPU has not been marked\n\t\t * online, but we need to update the cache masks\n\t\t */\n\t\tnp = cpu_to_l2cache(i);\n\n\t\t/* Skip all CPUs already part of current CPU l2-cache */\n\t\tif (np == l2_cache) {\n\t\t\tor_cpumasks_related(cpu, i, submask_fn, cpu_l2_cache_mask);\n\t\t\tcpumask_andnot(mask, mask, submask_fn(i));\n\t\t} else {\n\t\t\tcpumask_andnot(mask, mask, cpu_l2_cache_mask(i));\n\t\t}\n\n\t\tof_node_put(np);\n\t}\n\tof_node_put(l2_cache);\n\tfree_cpumask_var(mask);\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_cpu_to_smallcore_masks",
          "args": [
            "cpu"
          ],
          "line": 1386
        },
        "resolved": true,
        "details": {
          "function_name": "add_cpu_to_smallcore_masks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1325-1338",
          "snippet": "static inline void add_cpu_to_smallcore_masks(int cpu)\n{\n\tint i;\n\n\tif (!has_big_cores)\n\t\treturn;\n\n\tcpumask_set_cpu(cpu, cpu_smallcore_mask(cpu));\n\n\tfor_each_cpu(i, per_cpu(cpu_l1_cache_map, cpu)) {\n\t\tif (cpu_online(i))\n\t\t\tset_cpus_related(i, cpu, cpu_smallcore_mask);\n\t}\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool has_big_cores;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\n\nstatic inline void add_cpu_to_smallcore_masks(int cpu)\n{\n\tint i;\n\n\tif (!has_big_cores)\n\t\treturn;\n\n\tcpumask_set_cpu(cpu, cpu_smallcore_mask(cpu));\n\n\tfor_each_cpu(i, per_cpu(cpu_l1_cache_map, cpu)) {\n\t\tif (cpu_online(i))\n\t\t\tset_cpus_related(i, cpu, cpu_smallcore_mask);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_cpus_related",
          "args": [
            "i",
            "cpu",
            "cpu_sibling_mask"
          ],
          "line": 1384
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpus_related",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "658-662",
          "snippet": "static void set_cpus_related(int i, int j, struct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_set_cpu(i, get_cpumask(j));\n\tcpumask_set_cpu(j, get_cpumask(i));\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void set_cpus_related(int i, int j, struct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_set_cpu(i, get_cpumask(j));\n\tcpumask_set_cpu(j, get_cpumask(i));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "i"
          ],
          "line": 1383
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "924-1018",
          "snippet": "static int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define unregister_cpu_online NULL",
            "#define HAS_PPC_PA6T",
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define unregister_cpu_online NULL\n#define HAS_PPC_PA6T\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\n\nstatic int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "cpu_sibling_mask(cpu)"
          ],
          "line": 1380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_sibling_mask",
          "args": [
            "cpu"
          ],
          "line": 1380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_first_thread_sibling",
          "args": [
            "cpu"
          ],
          "line": 1373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void add_cpu_to_masks(int cpu)\n{\n\tint first_thread = cpu_first_thread_sibling(cpu);\n\tint i;\n\n\t/*\n\t * This CPU will not be in the online mask yet so we need to manually\n\t * add it to it's own thread sibling mask.\n\t */\n\tcpumask_set_cpu(cpu, cpu_sibling_mask(cpu));\n\n\tfor (i = first_thread; i < first_thread + threads_per_core; i++)\n\t\tif (cpu_online(i))\n\t\t\tset_cpus_related(i, cpu, cpu_sibling_mask);\n\n\tadd_cpu_to_smallcore_masks(cpu);\n\tupdate_mask_by_l2(cpu);\n\n\tif (has_coregroup_support())\n\t\tupdate_coregroup_mask(cpu);\n}"
  },
  {
    "function_name": "update_coregroup_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1340-1369",
    "snippet": "static void update_coregroup_mask(int cpu)\n{\n\tstruct cpumask *(*submask_fn)(int) = cpu_sibling_mask;\n\tcpumask_var_t mask;\n\tint coregroup_id = cpu_to_coregroup_id(cpu);\n\tint i;\n\n\talloc_cpumask_var_node(&mask, GFP_KERNEL, cpu_to_node(cpu));\n\tcpumask_and(mask, cpu_online_mask, cpu_cpu_mask(cpu));\n\n\tif (shared_caches)\n\t\tsubmask_fn = cpu_l2_cache_mask;\n\n\t/* Update coregroup mask with all the CPUs that are part of submask */\n\tor_cpumasks_related(cpu, cpu, submask_fn, cpu_coregroup_mask);\n\n\t/* Skip all CPUs already part of coregroup mask */\n\tcpumask_andnot(mask, mask, cpu_coregroup_mask(cpu));\n\n\tfor_each_cpu(i, mask) {\n\t\t/* Skip all CPUs not part of this coregroup */\n\t\tif (coregroup_id == cpu_to_coregroup_id(i)) {\n\t\t\tor_cpumasks_related(cpu, i, submask_fn, cpu_coregroup_mask);\n\t\t\tcpumask_andnot(mask, mask, submask_fn(i));\n\t\t} else {\n\t\t\tcpumask_andnot(mask, mask, cpu_coregroup_mask(i));\n\t\t}\n\t}\n\tfree_cpumask_var(mask);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool shared_caches;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "mask"
          ],
          "line": 1368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "mask",
            "mask",
            "cpu_coregroup_mask(i)"
          ],
          "line": 1365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_coregroup_mask",
          "args": [
            "i"
          ],
          "line": 1365
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_coregroup_mask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "897-900",
          "snippet": "static struct cpumask *cpu_coregroup_mask(int cpu)\n{\n\treturn per_cpu(cpu_coregroup_map, cpu);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic struct cpumask *cpu_coregroup_mask(int cpu)\n{\n\treturn per_cpu(cpu_coregroup_map, cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "mask",
            "mask",
            "submask_fn(i)"
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "submask_fn",
          "args": [
            "i"
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "or_cpumasks_related",
          "args": [
            "cpu",
            "i",
            "submask_fn",
            "cpu_coregroup_mask"
          ],
          "line": 1362
        },
        "resolved": true,
        "details": {
          "function_name": "or_cpumasks_related",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "677-693",
          "snippet": "static void or_cpumasks_related(int i, int j, struct cpumask *(*srcmask)(int),\n\t\t\t\tstruct cpumask *(*dstmask)(int))\n{\n\tstruct cpumask *mask;\n\tint k;\n\n\tmask = srcmask(j);\n\tfor_each_cpu(k, srcmask(i))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n\n\tif (i == j)\n\t\treturn;\n\n\tmask = srcmask(i);\n\tfor_each_cpu(k, srcmask(j))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void or_cpumasks_related(int i, int j, struct cpumask *(*srcmask)(int),\n\t\t\t\tstruct cpumask *(*dstmask)(int))\n{\n\tstruct cpumask *mask;\n\tint k;\n\n\tmask = srcmask(j);\n\tfor_each_cpu(k, srcmask(i))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n\n\tif (i == j)\n\t\treturn;\n\n\tmask = srcmask(i);\n\tfor_each_cpu(k, srcmask(j))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_coregroup_id",
          "args": [
            "i"
          ],
          "line": 1361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "i",
            "mask"
          ],
          "line": 1359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "mask",
            "mask",
            "cpu_coregroup_mask(cpu)"
          ],
          "line": 1357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_and",
          "args": [
            "mask",
            "cpu_online_mask",
            "cpu_cpu_mask(cpu)"
          ],
          "line": 1348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_cpu_mask",
          "args": [
            "cpu"
          ],
          "line": 1348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_cpumask_var_node",
          "args": [
            "&mask",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_coregroup_id",
          "args": [
            "cpu"
          ],
          "line": 1344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic bool shared_caches;\n\nstatic void update_coregroup_mask(int cpu)\n{\n\tstruct cpumask *(*submask_fn)(int) = cpu_sibling_mask;\n\tcpumask_var_t mask;\n\tint coregroup_id = cpu_to_coregroup_id(cpu);\n\tint i;\n\n\talloc_cpumask_var_node(&mask, GFP_KERNEL, cpu_to_node(cpu));\n\tcpumask_and(mask, cpu_online_mask, cpu_cpu_mask(cpu));\n\n\tif (shared_caches)\n\t\tsubmask_fn = cpu_l2_cache_mask;\n\n\t/* Update coregroup mask with all the CPUs that are part of submask */\n\tor_cpumasks_related(cpu, cpu, submask_fn, cpu_coregroup_mask);\n\n\t/* Skip all CPUs already part of coregroup mask */\n\tcpumask_andnot(mask, mask, cpu_coregroup_mask(cpu));\n\n\tfor_each_cpu(i, mask) {\n\t\t/* Skip all CPUs not part of this coregroup */\n\t\tif (coregroup_id == cpu_to_coregroup_id(i)) {\n\t\t\tor_cpumasks_related(cpu, i, submask_fn, cpu_coregroup_mask);\n\t\t\tcpumask_andnot(mask, mask, submask_fn(i));\n\t\t} else {\n\t\t\tcpumask_andnot(mask, mask, cpu_coregroup_mask(i));\n\t\t}\n\t}\n\tfree_cpumask_var(mask);\n}"
  },
  {
    "function_name": "add_cpu_to_smallcore_masks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1325-1338",
    "snippet": "static inline void add_cpu_to_smallcore_masks(int cpu)\n{\n\tint i;\n\n\tif (!has_big_cores)\n\t\treturn;\n\n\tcpumask_set_cpu(cpu, cpu_smallcore_mask(cpu));\n\n\tfor_each_cpu(i, per_cpu(cpu_l1_cache_map, cpu)) {\n\t\tif (cpu_online(i))\n\t\t\tset_cpus_related(i, cpu, cpu_smallcore_mask);\n\t}\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool has_big_cores;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_cpus_related",
          "args": [
            "i",
            "cpu",
            "cpu_smallcore_mask"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpus_related",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "658-662",
          "snippet": "static void set_cpus_related(int i, int j, struct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_set_cpu(i, get_cpumask(j));\n\tcpumask_set_cpu(j, get_cpumask(i));\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void set_cpus_related(int i, int j, struct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_set_cpu(i, get_cpumask(j));\n\tcpumask_set_cpu(j, get_cpumask(i));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "i"
          ],
          "line": 1335
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "924-1018",
          "snippet": "static int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define unregister_cpu_online NULL",
            "#define HAS_PPC_PA6T",
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define unregister_cpu_online NULL\n#define HAS_PPC_PA6T\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\n\nstatic int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "i",
            "per_cpu(cpu_l1_cache_map, cpu)"
          ],
          "line": 1334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_l1_cache_map",
            "cpu"
          ],
          "line": 1334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "cpu_smallcore_mask(cpu)"
          ],
          "line": 1332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_smallcore_mask",
          "args": [
            "cpu"
          ],
          "line": 1332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\n\nstatic inline void add_cpu_to_smallcore_masks(int cpu)\n{\n\tint i;\n\n\tif (!has_big_cores)\n\t\treturn;\n\n\tcpumask_set_cpu(cpu, cpu_smallcore_mask(cpu));\n\n\tfor_each_cpu(i, per_cpu(cpu_l1_cache_map, cpu)) {\n\t\tif (cpu_online(i))\n\t\t\tset_cpus_related(i, cpu, cpu_smallcore_mask);\n\t}\n}"
  },
  {
    "function_name": "remove_cpu_from_masks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1303-1322",
    "snippet": "static void remove_cpu_from_masks(int cpu)\n{\n\tstruct cpumask *(*mask_fn)(int) = cpu_sibling_mask;\n\tint i;\n\n\tif (shared_caches)\n\t\tmask_fn = cpu_l2_cache_mask;\n\n\tfor_each_cpu(i, mask_fn(cpu)) {\n\t\tset_cpus_unrelated(cpu, i, cpu_l2_cache_mask);\n\t\tset_cpus_unrelated(cpu, i, cpu_sibling_mask);\n\t\tif (has_big_cores)\n\t\t\tset_cpus_unrelated(cpu, i, cpu_smallcore_mask);\n\t}\n\n\tif (has_coregroup_support()) {\n\t\tfor_each_cpu(i, cpu_coregroup_mask(cpu))\n\t\t\tset_cpus_unrelated(cpu, i, cpu_coregroup_mask);\n\t}\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool has_big_cores;",
      "static bool shared_caches;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_cpus_unrelated",
          "args": [
            "cpu",
            "i",
            "cpu_coregroup_mask"
          ],
          "line": 1320
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpus_unrelated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "665-670",
          "snippet": "static void set_cpus_unrelated(int i, int j,\n\t\tstruct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_clear_cpu(i, get_cpumask(j));\n\tcpumask_clear_cpu(j, get_cpumask(i));\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void set_cpus_unrelated(int i, int j,\n\t\tstruct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_clear_cpu(i, get_cpumask(j));\n\tcpumask_clear_cpu(j, get_cpumask(i));\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "i",
            "cpu_coregroup_mask(cpu)"
          ],
          "line": 1319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_coregroup_mask",
          "args": [
            "cpu"
          ],
          "line": 1319
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_coregroup_mask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "897-900",
          "snippet": "static struct cpumask *cpu_coregroup_mask(int cpu)\n{\n\treturn per_cpu(cpu_coregroup_map, cpu);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic struct cpumask *cpu_coregroup_mask(int cpu)\n{\n\treturn per_cpu(cpu_coregroup_map, cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "has_coregroup_support",
          "args": [],
          "line": 1318
        },
        "resolved": true,
        "details": {
          "function_name": "has_coregroup_support",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "902-905",
          "snippet": "static bool has_coregroup_support(void)\n{\n\treturn coregroup_enabled;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool coregroup_enabled;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool coregroup_enabled;\n\nstatic bool has_coregroup_support(void)\n{\n\treturn coregroup_enabled;\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "i",
            "mask_fn(cpu)"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mask_fn",
          "args": [
            "cpu"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\nstatic bool shared_caches;\n\nstatic void remove_cpu_from_masks(int cpu)\n{\n\tstruct cpumask *(*mask_fn)(int) = cpu_sibling_mask;\n\tint i;\n\n\tif (shared_caches)\n\t\tmask_fn = cpu_l2_cache_mask;\n\n\tfor_each_cpu(i, mask_fn(cpu)) {\n\t\tset_cpus_unrelated(cpu, i, cpu_l2_cache_mask);\n\t\tset_cpus_unrelated(cpu, i, cpu_sibling_mask);\n\t\tif (has_big_cores)\n\t\t\tset_cpus_unrelated(cpu, i, cpu_smallcore_mask);\n\t}\n\n\tif (has_coregroup_support()) {\n\t\tfor_each_cpu(i, cpu_coregroup_mask(cpu))\n\t\t\tset_cpus_unrelated(cpu, i, cpu_coregroup_mask);\n\t}\n}"
  },
  {
    "function_name": "update_mask_by_l2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1243-1300",
    "snippet": "static bool update_mask_by_l2(int cpu)\n{\n\tstruct cpumask *(*submask_fn)(int) = cpu_sibling_mask;\n\tstruct device_node *l2_cache, *np;\n\tcpumask_var_t mask;\n\tint i;\n\n\tl2_cache = cpu_to_l2cache(cpu);\n\tif (!l2_cache) {\n\t\tstruct cpumask *(*sibling_mask)(int) = cpu_sibling_mask;\n\n\t\t/*\n\t\t * If no l2cache for this CPU, assume all siblings to share\n\t\t * cache with this CPU.\n\t\t */\n\t\tif (has_big_cores)\n\t\t\tsibling_mask = cpu_smallcore_mask;\n\n\t\tfor_each_cpu(i, sibling_mask(cpu))\n\t\t\tset_cpus_related(cpu, i, cpu_l2_cache_mask);\n\n\t\treturn false;\n\t}\n\n\talloc_cpumask_var_node(&mask, GFP_KERNEL, cpu_to_node(cpu));\n\tcpumask_and(mask, cpu_online_mask, cpu_cpu_mask(cpu));\n\n\tif (has_big_cores)\n\t\tsubmask_fn = cpu_smallcore_mask;\n\n\t/* Update l2-cache mask with all the CPUs that are part of submask */\n\tor_cpumasks_related(cpu, cpu, submask_fn, cpu_l2_cache_mask);\n\n\t/* Skip all CPUs already part of current CPU l2-cache mask */\n\tcpumask_andnot(mask, mask, cpu_l2_cache_mask(cpu));\n\n\tfor_each_cpu(i, mask) {\n\t\t/*\n\t\t * when updating the marks the current CPU has not been marked\n\t\t * online, but we need to update the cache masks\n\t\t */\n\t\tnp = cpu_to_l2cache(i);\n\n\t\t/* Skip all CPUs already part of current CPU l2-cache */\n\t\tif (np == l2_cache) {\n\t\t\tor_cpumasks_related(cpu, i, submask_fn, cpu_l2_cache_mask);\n\t\t\tcpumask_andnot(mask, mask, submask_fn(i));\n\t\t} else {\n\t\t\tcpumask_andnot(mask, mask, cpu_l2_cache_mask(i));\n\t\t}\n\n\t\tof_node_put(np);\n\t}\n\tof_node_put(l2_cache);\n\tfree_cpumask_var(mask);\n\n\treturn true;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool has_big_cores;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "mask"
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "l2_cache"
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 1294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "mask",
            "mask",
            "cpu_l2_cache_mask(i)"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_l2_cache_mask",
          "args": [
            "i"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "mask",
            "mask",
            "submask_fn(i)"
          ],
          "line": 1289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "submask_fn",
          "args": [
            "i"
          ],
          "line": 1289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "or_cpumasks_related",
          "args": [
            "cpu",
            "i",
            "submask_fn",
            "cpu_l2_cache_mask"
          ],
          "line": 1288
        },
        "resolved": true,
        "details": {
          "function_name": "or_cpumasks_related",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "677-693",
          "snippet": "static void or_cpumasks_related(int i, int j, struct cpumask *(*srcmask)(int),\n\t\t\t\tstruct cpumask *(*dstmask)(int))\n{\n\tstruct cpumask *mask;\n\tint k;\n\n\tmask = srcmask(j);\n\tfor_each_cpu(k, srcmask(i))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n\n\tif (i == j)\n\t\treturn;\n\n\tmask = srcmask(i);\n\tfor_each_cpu(k, srcmask(j))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void or_cpumasks_related(int i, int j, struct cpumask *(*srcmask)(int),\n\t\t\t\tstruct cpumask *(*dstmask)(int))\n{\n\tstruct cpumask *mask;\n\tint k;\n\n\tmask = srcmask(j);\n\tfor_each_cpu(k, srcmask(i))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n\n\tif (i == j)\n\t\treturn;\n\n\tmask = srcmask(i);\n\tfor_each_cpu(k, srcmask(j))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_l2cache",
          "args": [
            "i"
          ],
          "line": 1284
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_l2cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1224-1241",
          "snippet": "static struct device_node *cpu_to_l2cache(int cpu)\n{\n\tstruct device_node *np;\n\tstruct device_node *cache;\n\n\tif (!cpu_present(cpu))\n\t\treturn NULL;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np == NULL)\n\t\treturn NULL;\n\n\tcache = of_find_next_cache_node(np);\n\n\tof_node_put(np);\n\n\treturn cache;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic struct device_node *cpu_to_l2cache(int cpu)\n{\n\tstruct device_node *np;\n\tstruct device_node *cache;\n\n\tif (!cpu_present(cpu))\n\t\treturn NULL;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np == NULL)\n\t\treturn NULL;\n\n\tcache = of_find_next_cache_node(np);\n\n\tof_node_put(np);\n\n\treturn cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "i",
            "mask"
          ],
          "line": 1279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "mask",
            "mask",
            "cpu_l2_cache_mask(cpu)"
          ],
          "line": 1277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_l2_cache_mask",
          "args": [
            "cpu"
          ],
          "line": 1277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_and",
          "args": [
            "mask",
            "cpu_online_mask",
            "cpu_cpu_mask(cpu)"
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_cpu_mask",
          "args": [
            "cpu"
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_cpumask_var_node",
          "args": [
            "&mask",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpus_related",
          "args": [
            "cpu",
            "i",
            "cpu_l2_cache_mask"
          ],
          "line": 1262
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpus_related",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "658-662",
          "snippet": "static void set_cpus_related(int i, int j, struct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_set_cpu(i, get_cpumask(j));\n\tcpumask_set_cpu(j, get_cpumask(i));\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void set_cpus_related(int i, int j, struct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_set_cpu(i, get_cpumask(j));\n\tcpumask_set_cpu(j, get_cpumask(i));\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "i",
            "sibling_mask(cpu)"
          ],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sibling_mask",
          "args": [
            "cpu"
          ],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\n\nstatic bool update_mask_by_l2(int cpu)\n{\n\tstruct cpumask *(*submask_fn)(int) = cpu_sibling_mask;\n\tstruct device_node *l2_cache, *np;\n\tcpumask_var_t mask;\n\tint i;\n\n\tl2_cache = cpu_to_l2cache(cpu);\n\tif (!l2_cache) {\n\t\tstruct cpumask *(*sibling_mask)(int) = cpu_sibling_mask;\n\n\t\t/*\n\t\t * If no l2cache for this CPU, assume all siblings to share\n\t\t * cache with this CPU.\n\t\t */\n\t\tif (has_big_cores)\n\t\t\tsibling_mask = cpu_smallcore_mask;\n\n\t\tfor_each_cpu(i, sibling_mask(cpu))\n\t\t\tset_cpus_related(cpu, i, cpu_l2_cache_mask);\n\n\t\treturn false;\n\t}\n\n\talloc_cpumask_var_node(&mask, GFP_KERNEL, cpu_to_node(cpu));\n\tcpumask_and(mask, cpu_online_mask, cpu_cpu_mask(cpu));\n\n\tif (has_big_cores)\n\t\tsubmask_fn = cpu_smallcore_mask;\n\n\t/* Update l2-cache mask with all the CPUs that are part of submask */\n\tor_cpumasks_related(cpu, cpu, submask_fn, cpu_l2_cache_mask);\n\n\t/* Skip all CPUs already part of current CPU l2-cache mask */\n\tcpumask_andnot(mask, mask, cpu_l2_cache_mask(cpu));\n\n\tfor_each_cpu(i, mask) {\n\t\t/*\n\t\t * when updating the marks the current CPU has not been marked\n\t\t * online, but we need to update the cache masks\n\t\t */\n\t\tnp = cpu_to_l2cache(i);\n\n\t\t/* Skip all CPUs already part of current CPU l2-cache */\n\t\tif (np == l2_cache) {\n\t\t\tor_cpumasks_related(cpu, i, submask_fn, cpu_l2_cache_mask);\n\t\t\tcpumask_andnot(mask, mask, submask_fn(i));\n\t\t} else {\n\t\t\tcpumask_andnot(mask, mask, cpu_l2_cache_mask(i));\n\t\t}\n\n\t\tof_node_put(np);\n\t}\n\tof_node_put(l2_cache);\n\tfree_cpumask_var(mask);\n\n\treturn true;\n}"
  },
  {
    "function_name": "cpu_to_l2cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1224-1241",
    "snippet": "static struct device_node *cpu_to_l2cache(int cpu)\n{\n\tstruct device_node *np;\n\tstruct device_node *cache;\n\n\tif (!cpu_present(cpu))\n\t\treturn NULL;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np == NULL)\n\t\treturn NULL;\n\n\tcache = of_find_next_cache_node(np);\n\n\tof_node_put(np);\n\n\treturn cache;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_next_cache_node",
          "args": [
            "np"
          ],
          "line": 1236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_cpu_node",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 1232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_present",
          "args": [
            "cpu"
          ],
          "line": 1229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic struct device_node *cpu_to_l2cache(int cpu)\n{\n\tstruct device_node *np;\n\tstruct device_node *cache;\n\n\tif (!cpu_present(cpu))\n\t\treturn NULL;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (np == NULL)\n\t\treturn NULL;\n\n\tcache = of_find_next_cache_node(np);\n\n\tof_node_put(np);\n\n\treturn cache;\n}"
  },
  {
    "function_name": "cpu_first_thread_of_core",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1215-1218",
    "snippet": "int cpu_first_thread_of_core(int core)\n{\n\treturn core << threads_shift;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint cpu_first_thread_of_core(int core)\n{\n\treturn core << threads_shift;\n}"
  },
  {
    "function_name": "cpu_core_index_of_thread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1209-1212",
    "snippet": "int cpu_core_index_of_thread(int cpu)\n{\n\treturn cpu >> threads_shift;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint cpu_core_index_of_thread(int cpu)\n{\n\treturn cpu >> threads_shift;\n}"
  },
  {
    "function_name": "cpu_to_core_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1187-1205",
    "snippet": "int cpu_to_core_id(int cpu)\n{\n\tstruct device_node *np;\n\tconst __be32 *reg;\n\tint id = -1;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (!np)\n\t\tgoto out;\n\n\treg = of_get_property(np, \"reg\", NULL);\n\tif (!reg)\n\t\tgoto out;\n\n\tid = be32_to_cpup(reg);\nout:\n\tof_node_put(np);\n\treturn id;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "np"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "reg"
          ],
          "line": 1201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"reg\"",
            "NULL"
          ],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_cpu_node",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 1193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint cpu_to_core_id(int cpu)\n{\n\tstruct device_node *np;\n\tconst __be32 *reg;\n\tint id = -1;\n\n\tnp = of_get_cpu_node(cpu, NULL);\n\tif (!np)\n\t\tgoto out;\n\n\treg = of_get_property(np, \"reg\", NULL);\n\tif (!reg)\n\t\tgoto out;\n\n\tid = be32_to_cpup(reg);\nout:\n\tof_node_put(np);\n\treturn id;\n}"
  },
  {
    "function_name": "__cpu_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1104-1182",
    "snippet": "int __cpu_up(unsigned int cpu, struct task_struct *tidle)\n{\n\tint rc, c;\n\n\t/*\n\t * Don't allow secondary threads to come online if inhibited\n\t */\n\tif (threads_per_core > 1 && secondaries_inhibited() &&\n\t    cpu_thread_in_subcore(cpu))\n\t\treturn -EBUSY;\n\n\tif (smp_ops == NULL ||\n\t    (smp_ops->cpu_bootable && !smp_ops->cpu_bootable(cpu)))\n\t\treturn -EINVAL;\n\n\tcpu_idle_thread_init(cpu, tidle);\n\n\t/*\n\t * The platform might need to allocate resources prior to bringing\n\t * up the CPU\n\t */\n\tif (smp_ops->prepare_cpu) {\n\t\trc = smp_ops->prepare_cpu(cpu);\n\t\tif (rc)\n\t\t\treturn rc;\n\t}\n\n\t/* Make sure callin-map entry is 0 (can be leftover a CPU\n\t * hotplug\n\t */\n\tcpu_callin_map[cpu] = 0;\n\n\t/* The information for processor bringup must\n\t * be written out to main store before we release\n\t * the processor.\n\t */\n\tsmp_mb();\n\n\t/* wake up cpus */\n\tDBG(\"smp: kicking cpu %d\\n\", cpu);\n\trc = smp_ops->kick_cpu(cpu);\n\tif (rc) {\n\t\tpr_err(\"smp: failed starting cpu %d (rc %d)\\n\", cpu, rc);\n\t\treturn rc;\n\t}\n\n\t/*\n\t * wait to see if the cpu made a callin (is actually up).\n\t * use this value that I found through experimentation.\n\t * -- Cort\n\t */\n\tif (system_state < SYSTEM_RUNNING)\n\t\tfor (c = 50000; c && !cpu_callin_map[cpu]; c--)\n\t\t\tudelay(100);\n#ifdef CONFIG_HOTPLUG_CPU\n\telse\n\t\t/*\n\t\t * CPUs can take much longer to come up in the\n\t\t * hotplug case.  Wait five seconds.\n\t\t */\n\t\tfor (c = 5000; c && !cpu_callin_map[cpu]; c--)\n\t\t\tmsleep(1);\n#endif\n\n\tif (!cpu_callin_map[cpu]) {\n\t\tprintk(KERN_ERR \"Processor %u is stuck.\\n\", cpu);\n\t\treturn -ENOENT;\n\t}\n\n\tDBG(\"Processor %u found.\\n\", cpu);\n\n\tif (smp_ops->give_timebase)\n\t\tsmp_ops->give_timebase();\n\n\t/* Wait until cpu puts itself in the online & active maps */\n\tspin_until_cond(cpu_online(cpu));\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;",
      "volatile unsigned int cpu_callin_map[NR_CPUS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_until_cond",
          "args": [
            "cpu_online(cpu)"
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "cpu"
          ],
          "line": 1179
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "924-1018",
          "snippet": "static int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define unregister_cpu_online NULL",
            "#define HAS_PPC_PA6T",
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define unregister_cpu_online NULL\n#define HAS_PPC_PA6T\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\n\nstatic int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_ops->give_timebase",
          "args": [],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Processor %u found.\\n\"",
            "cpu"
          ],
          "line": 1173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"Processor %u is stuck.\\n\"",
            "cpu"
          ],
          "line": 1169
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "110-157",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/topology.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool full_rtas_msgs;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <linux/topology.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic bool full_rtas_msgs;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "msleep",
          "args": [
            "1"
          ],
          "line": 1165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udelay",
          "args": [
            "100"
          ],
          "line": 1157
        },
        "resolved": true,
        "details": {
          "function_name": "udelay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "478-481",
          "snippet": "void udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned long tb_ticks_per_usec = 100;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_usec = 100;\n\nvoid udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"smp: failed starting cpu %d (rc %d)\\n\"",
            "cpu",
            "rc"
          ],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->kick_cpu",
          "args": [
            "cpu"
          ],
          "line": 1144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"smp: kicking cpu %d\\n\"",
            "cpu"
          ],
          "line": 1143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->prepare_cpu",
          "args": [
            "cpu"
          ],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_idle_thread_init",
          "args": [
            "cpu",
            "tidle"
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_idle_thread_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1093-1102",
          "snippet": "static void cpu_idle_thread_init(unsigned int cpu, struct task_struct *idle)\n{\n#ifdef CONFIG_PPC64\n\tpaca_ptrs[cpu]->__current = idle;\n\tpaca_ptrs[cpu]->kstack = (unsigned long)task_stack_page(idle) +\n\t\t\t\t THREAD_SIZE - STACK_FRAME_OVERHEAD;\n#endif\n\tidle->cpu = cpu;\n\tsecondary_current = current_set[cpu] = idle;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct task_struct *secondary_current;",
            "struct task_struct *current_set[NR_CPUS];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct task_struct *secondary_current;\nstruct task_struct *current_set[NR_CPUS];\n\nstatic void cpu_idle_thread_init(unsigned int cpu, struct task_struct *idle)\n{\n#ifdef CONFIG_PPC64\n\tpaca_ptrs[cpu]->__current = idle;\n\tpaca_ptrs[cpu]->kstack = (unsigned long)task_stack_page(idle) +\n\t\t\t\t THREAD_SIZE - STACK_FRAME_OVERHEAD;\n#endif\n\tidle->cpu = cpu;\n\tsecondary_current = current_set[cpu] = idle;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_ops->cpu_bootable",
          "args": [
            "cpu"
          ],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_thread_in_subcore",
          "args": [
            "cpu"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "secondaries_inhibited",
          "args": [],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "secondaries_inhibited",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1082-1085",
          "snippet": "static bool secondaries_inhibited(void)\n{\n\treturn kvm_hv_mode_active();\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic bool secondaries_inhibited(void)\n{\n\treturn kvm_hv_mode_active();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\nvolatile unsigned int cpu_callin_map[NR_CPUS];\n\nint __cpu_up(unsigned int cpu, struct task_struct *tidle)\n{\n\tint rc, c;\n\n\t/*\n\t * Don't allow secondary threads to come online if inhibited\n\t */\n\tif (threads_per_core > 1 && secondaries_inhibited() &&\n\t    cpu_thread_in_subcore(cpu))\n\t\treturn -EBUSY;\n\n\tif (smp_ops == NULL ||\n\t    (smp_ops->cpu_bootable && !smp_ops->cpu_bootable(cpu)))\n\t\treturn -EINVAL;\n\n\tcpu_idle_thread_init(cpu, tidle);\n\n\t/*\n\t * The platform might need to allocate resources prior to bringing\n\t * up the CPU\n\t */\n\tif (smp_ops->prepare_cpu) {\n\t\trc = smp_ops->prepare_cpu(cpu);\n\t\tif (rc)\n\t\t\treturn rc;\n\t}\n\n\t/* Make sure callin-map entry is 0 (can be leftover a CPU\n\t * hotplug\n\t */\n\tcpu_callin_map[cpu] = 0;\n\n\t/* The information for processor bringup must\n\t * be written out to main store before we release\n\t * the processor.\n\t */\n\tsmp_mb();\n\n\t/* wake up cpus */\n\tDBG(\"smp: kicking cpu %d\\n\", cpu);\n\trc = smp_ops->kick_cpu(cpu);\n\tif (rc) {\n\t\tpr_err(\"smp: failed starting cpu %d (rc %d)\\n\", cpu, rc);\n\t\treturn rc;\n\t}\n\n\t/*\n\t * wait to see if the cpu made a callin (is actually up).\n\t * use this value that I found through experimentation.\n\t * -- Cort\n\t */\n\tif (system_state < SYSTEM_RUNNING)\n\t\tfor (c = 50000; c && !cpu_callin_map[cpu]; c--)\n\t\t\tudelay(100);\n#ifdef CONFIG_HOTPLUG_CPU\n\telse\n\t\t/*\n\t\t * CPUs can take much longer to come up in the\n\t\t * hotplug case.  Wait five seconds.\n\t\t */\n\t\tfor (c = 5000; c && !cpu_callin_map[cpu]; c--)\n\t\t\tmsleep(1);\n#endif\n\n\tif (!cpu_callin_map[cpu]) {\n\t\tprintk(KERN_ERR \"Processor %u is stuck.\\n\", cpu);\n\t\treturn -ENOENT;\n\t}\n\n\tDBG(\"Processor %u found.\\n\", cpu);\n\n\tif (smp_ops->give_timebase)\n\t\tsmp_ops->give_timebase();\n\n\t/* Wait until cpu puts itself in the online & active maps */\n\tspin_until_cond(cpu_online(cpu));\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cpu_idle_thread_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1093-1102",
    "snippet": "static void cpu_idle_thread_init(unsigned int cpu, struct task_struct *idle)\n{\n#ifdef CONFIG_PPC64\n\tpaca_ptrs[cpu]->__current = idle;\n\tpaca_ptrs[cpu]->kstack = (unsigned long)task_stack_page(idle) +\n\t\t\t\t THREAD_SIZE - STACK_FRAME_OVERHEAD;\n#endif\n\tidle->cpu = cpu;\n\tsecondary_current = current_set[cpu] = idle;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct task_struct *secondary_current;",
      "struct task_struct *current_set[NR_CPUS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "task_stack_page",
          "args": [
            "idle"
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct task_struct *secondary_current;\nstruct task_struct *current_set[NR_CPUS];\n\nstatic void cpu_idle_thread_init(unsigned int cpu, struct task_struct *idle)\n{\n#ifdef CONFIG_PPC64\n\tpaca_ptrs[cpu]->__current = idle;\n\tpaca_ptrs[cpu]->kstack = (unsigned long)task_stack_page(idle) +\n\t\t\t\t THREAD_SIZE - STACK_FRAME_OVERHEAD;\n#endif\n\tidle->cpu = cpu;\n\tsecondary_current = current_set[cpu] = idle;\n}"
  },
  {
    "function_name": "secondaries_inhibited",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1082-1085",
    "snippet": "static bool secondaries_inhibited(void)\n{\n\treturn kvm_hv_mode_active();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_hv_mode_active",
          "args": [],
          "line": 1084
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic bool secondaries_inhibited(void)\n{\n\treturn kvm_hv_mode_active();\n}"
  },
  {
    "function_name": "is_cpu_dead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1077-1080",
    "snippet": "int is_cpu_dead(unsigned int cpu)\n{\n\treturn per_cpu(cpu_state, cpu) == CPU_DEAD;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_state",
            "cpu"
          ],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint is_cpu_dead(unsigned int cpu)\n{\n\treturn per_cpu(cpu_state, cpu) == CPU_DEAD;\n}"
  },
  {
    "function_name": "generic_check_cpu_restart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1072-1075",
    "snippet": "int generic_check_cpu_restart(unsigned int cpu)\n{\n\treturn per_cpu(cpu_state, cpu) == CPU_UP_PREPARE;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_state",
            "cpu"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint generic_check_cpu_restart(unsigned int cpu)\n{\n\treturn per_cpu(cpu_state, cpu) == CPU_UP_PREPARE;\n}"
  },
  {
    "function_name": "generic_set_cpu_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1067-1070",
    "snippet": "void generic_set_cpu_up(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_UP_PREPARE;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_state",
            "cpu"
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid generic_set_cpu_up(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_UP_PREPARE;\n}"
  },
  {
    "function_name": "generic_set_cpu_dead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1057-1060",
    "snippet": "void generic_set_cpu_dead(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_DEAD;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_state",
            "cpu"
          ],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid generic_set_cpu_dead(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_DEAD;\n}"
  },
  {
    "function_name": "generic_cpu_die",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1044-1055",
    "snippet": "void generic_cpu_die(unsigned int cpu)\n{\n\tint i;\n\n\tfor (i = 0; i < 100; i++) {\n\t\tsmp_rmb();\n\t\tif (is_cpu_dead(cpu))\n\t\t\treturn;\n\t\tmsleep(100);\n\t}\n\tprintk(KERN_ERR \"CPU%d didn't die...\\n\", cpu);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"CPU%d didn't die...\\n\"",
            "cpu"
          ],
          "line": 1054
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "110-157",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/topology.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool full_rtas_msgs;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <linux/topology.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic bool full_rtas_msgs;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "msleep",
          "args": [
            "100"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_cpu_dead",
          "args": [
            "cpu"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "is_cpu_dead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1077-1080",
          "snippet": "int is_cpu_dead(unsigned int cpu)\n{\n\treturn per_cpu(cpu_state, cpu) == CPU_DEAD;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint is_cpu_dead(unsigned int cpu)\n{\n\treturn per_cpu(cpu_state, cpu) == CPU_DEAD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_rmb",
          "args": [],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid generic_cpu_die(unsigned int cpu)\n{\n\tint i;\n\n\tfor (i = 0; i < 100; i++) {\n\t\tsmp_rmb();\n\t\tif (is_cpu_dead(cpu))\n\t\t\treturn;\n\t\tmsleep(100);\n\t}\n\tprintk(KERN_ERR \"CPU%d didn't die...\\n\", cpu);\n}"
  },
  {
    "function_name": "generic_cpu_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1015-1042",
    "snippet": "int generic_cpu_disable(void)\n{\n\tunsigned int cpu = smp_processor_id();\n\n\tif (cpu == boot_cpuid)\n\t\treturn -EBUSY;\n\n\tset_cpu_online(cpu, false);\n#ifdef CONFIG_PPC64\n\tvdso_data->processorCount--;\n#endif\n\t/* Update affinity of all IRQs previously aimed at this CPU */\n\tirq_migrate_all_off_this_cpu();\n\n\t/*\n\t * Depending on the details of the interrupt controller, it's possible\n\t * that one of the interrupts we just migrated away from this CPU is\n\t * actually already pending on this CPU. If we leave it in that state\n\t * the interrupt will never be EOI'ed, and will never fire again. So\n\t * temporarily enable interrupts here, to allow any pending interrupt to\n\t * be received (and EOI'ed), before we take this CPU offline.\n\t */\n\tlocal_irq_enable();\n\tmdelay(1);\n\tlocal_irq_disable();\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_disable",
          "args": [],
          "line": 1039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mdelay",
          "args": [
            "1"
          ],
          "line": 1038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_migrate_all_off_this_cpu",
          "args": [],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_online",
          "args": [
            "cpu",
            "false"
          ],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint generic_cpu_disable(void)\n{\n\tunsigned int cpu = smp_processor_id();\n\n\tif (cpu == boot_cpuid)\n\t\treturn -EBUSY;\n\n\tset_cpu_online(cpu, false);\n#ifdef CONFIG_PPC64\n\tvdso_data->processorCount--;\n#endif\n\t/* Update affinity of all IRQs previously aimed at this CPU */\n\tirq_migrate_all_off_this_cpu();\n\n\t/*\n\t * Depending on the details of the interrupt controller, it's possible\n\t * that one of the interrupts we just migrated away from this CPU is\n\t * actually already pending on this CPU. If we leave it in that state\n\t * the interrupt will never be EOI'ed, and will never fire again. So\n\t * temporarily enable interrupts here, to allow any pending interrupt to\n\t * be received (and EOI'ed), before we take this CPU offline.\n\t */\n\tlocal_irq_enable();\n\tmdelay(1);\n\tlocal_irq_disable();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "smp_prepare_boot_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "1003-1011",
    "snippet": "void smp_prepare_boot_cpu(void)\n{\n\tBUG_ON(smp_processor_id() != boot_cpuid);\n#ifdef CONFIG_PPC64\n\tpaca_ptrs[boot_cpuid]->__current = current;\n#endif\n\tset_numa_node(numa_cpu_lookup_table[boot_cpuid]);\n\tcurrent_set[boot_cpuid] = current;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct task_struct *current_set[NR_CPUS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_numa_node",
          "args": [
            "numa_cpu_lookup_table[boot_cpuid]"
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "smp_processor_id() != boot_cpuid"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct task_struct *current_set[NR_CPUS];\n\nvoid smp_prepare_boot_cpu(void)\n{\n\tBUG_ON(smp_processor_id() != boot_cpuid);\n#ifdef CONFIG_PPC64\n\tpaca_ptrs[boot_cpuid]->__current = current;\n#endif\n\tset_numa_node(numa_cpu_lookup_table[boot_cpuid]);\n\tcurrent_set[boot_cpuid] = current;\n}"
  },
  {
    "function_name": "smp_prepare_cpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "941-1001",
    "snippet": "void __init smp_prepare_cpus(unsigned int max_cpus)\n{\n\tunsigned int cpu;\n\n\tDBG(\"smp_prepare_cpus\\n\");\n\n\t/* \n\t * setup_cpu may need to be called on the boot cpu. We havent\n\t * spun any cpus up but lets be paranoid.\n\t */\n\tBUG_ON(boot_cpuid != smp_processor_id());\n\n\t/* Fixup boot cpu */\n\tsmp_store_cpu_info(boot_cpuid);\n\tcpu_callin_map[boot_cpuid] = 1;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_sibling_map, cpu),\n\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_l2_cache_map, cpu),\n\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_core_map, cpu),\n\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\t\tif (has_coregroup_support())\n\t\t\tzalloc_cpumask_var_node(&per_cpu(cpu_coregroup_map, cpu),\n\t\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\n#ifdef CONFIG_NEED_MULTIPLE_NODES\n\t\t/*\n\t\t * numa_node_id() works after this.\n\t\t */\n\t\tif (cpu_present(cpu)) {\n\t\t\tset_cpu_numa_node(cpu, numa_cpu_lookup_table[cpu]);\n\t\t\tset_cpu_numa_mem(cpu,\n\t\t\t\tlocal_memory_node(numa_cpu_lookup_table[cpu]));\n\t\t}\n#endif\n\t\t/*\n\t\t * cpu_core_map is now more updated and exists only since\n\t\t * its been exported for long. It only will have a snapshot\n\t\t * of cpu_cpu_mask.\n\t\t */\n\t\tcpumask_copy(per_cpu(cpu_core_map, cpu), cpu_cpu_mask(cpu));\n\t}\n\n\t/* Init the cpumasks so the boot CPU is related to itself */\n\tcpumask_set_cpu(boot_cpuid, cpu_sibling_mask(boot_cpuid));\n\tcpumask_set_cpu(boot_cpuid, cpu_l2_cache_mask(boot_cpuid));\n\n\tif (has_coregroup_support())\n\t\tcpumask_set_cpu(boot_cpuid, cpu_coregroup_mask(boot_cpuid));\n\n\tinit_big_cores();\n\tif (has_big_cores) {\n\t\tcpumask_set_cpu(boot_cpuid,\n\t\t\t\tcpu_smallcore_mask(boot_cpuid));\n\t}\n\n\tif (smp_ops && smp_ops->probe)\n\t\tsmp_ops->probe();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool has_big_cores;",
      "struct smp_ops_t *smp_ops;",
      "volatile unsigned int cpu_callin_map[NR_CPUS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_ops->probe",
          "args": [],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "boot_cpuid",
            "cpu_smallcore_mask(boot_cpuid)"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_smallcore_mask",
          "args": [
            "boot_cpuid"
          ],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_big_cores",
          "args": [],
          "line": 993
        },
        "resolved": true,
        "details": {
          "function_name": "init_big_cores",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "922-939",
          "snippet": "static int init_big_cores(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tint err = init_cpu_l1_cache_map(cpu);\n\n\t\tif (err)\n\t\t\treturn err;\n\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_smallcore_map, cpu),\n\t\t\t\t\tGFP_KERNEL,\n\t\t\t\t\tcpu_to_node(cpu));\n\t}\n\n\thas_big_cores = true;\n\treturn 0;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool has_big_cores;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\n\nstatic int init_big_cores(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tint err = init_cpu_l1_cache_map(cpu);\n\n\t\tif (err)\n\t\t\treturn err;\n\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_smallcore_map, cpu),\n\t\t\t\t\tGFP_KERNEL,\n\t\t\t\t\tcpu_to_node(cpu));\n\t}\n\n\thas_big_cores = true;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "boot_cpuid",
            "cpu_coregroup_mask(boot_cpuid)"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_coregroup_mask",
          "args": [
            "boot_cpuid"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_coregroup_mask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "897-900",
          "snippet": "static struct cpumask *cpu_coregroup_mask(int cpu)\n{\n\treturn per_cpu(cpu_coregroup_map, cpu);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic struct cpumask *cpu_coregroup_mask(int cpu)\n{\n\treturn per_cpu(cpu_coregroup_map, cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "has_coregroup_support",
          "args": [],
          "line": 990
        },
        "resolved": true,
        "details": {
          "function_name": "has_coregroup_support",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "902-905",
          "snippet": "static bool has_coregroup_support(void)\n{\n\treturn coregroup_enabled;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool coregroup_enabled;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool coregroup_enabled;\n\nstatic bool has_coregroup_support(void)\n{\n\treturn coregroup_enabled;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "boot_cpuid",
            "cpu_l2_cache_mask(boot_cpuid)"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_l2_cache_mask",
          "args": [
            "boot_cpuid"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "boot_cpuid",
            "cpu_sibling_mask(boot_cpuid)"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_sibling_mask",
          "args": [
            "boot_cpuid"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_copy",
          "args": [
            "per_cpu(cpu_core_map, cpu)",
            "cpu_cpu_mask(cpu)"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_cpu_mask",
          "args": [
            "cpu"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_core_map",
            "cpu"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_numa_mem",
          "args": [
            "cpu",
            "local_memory_node(numa_cpu_lookup_table[cpu])"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_memory_node",
          "args": [
            "numa_cpu_lookup_table[cpu]"
          ],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_numa_node",
          "args": [
            "cpu",
            "numa_cpu_lookup_table[cpu]"
          ],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_present",
          "args": [
            "cpu"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&per_cpu(cpu_coregroup_map, cpu)",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_coregroup_map",
            "cpu"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&per_cpu(cpu_core_map, cpu)",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_core_map",
            "cpu"
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&per_cpu(cpu_l2_cache_map, cpu)",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_l2_cache_map",
            "cpu"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&per_cpu(cpu_sibling_map, cpu)",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_sibling_map",
            "cpu"
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_store_cpu_info",
          "args": [
            "boot_cpuid"
          ],
          "line": 954
        },
        "resolved": true,
        "details": {
          "function_name": "smp_store_cpu_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "644-651",
          "snippet": "static void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "boot_cpuid != smp_processor_id()"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"smp_prepare_cpus\\n\""
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\nstruct smp_ops_t *smp_ops;\nvolatile unsigned int cpu_callin_map[NR_CPUS];\n\nvoid __init smp_prepare_cpus(unsigned int max_cpus)\n{\n\tunsigned int cpu;\n\n\tDBG(\"smp_prepare_cpus\\n\");\n\n\t/* \n\t * setup_cpu may need to be called on the boot cpu. We havent\n\t * spun any cpus up but lets be paranoid.\n\t */\n\tBUG_ON(boot_cpuid != smp_processor_id());\n\n\t/* Fixup boot cpu */\n\tsmp_store_cpu_info(boot_cpuid);\n\tcpu_callin_map[boot_cpuid] = 1;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_sibling_map, cpu),\n\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_l2_cache_map, cpu),\n\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_core_map, cpu),\n\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\t\tif (has_coregroup_support())\n\t\t\tzalloc_cpumask_var_node(&per_cpu(cpu_coregroup_map, cpu),\n\t\t\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\n#ifdef CONFIG_NEED_MULTIPLE_NODES\n\t\t/*\n\t\t * numa_node_id() works after this.\n\t\t */\n\t\tif (cpu_present(cpu)) {\n\t\t\tset_cpu_numa_node(cpu, numa_cpu_lookup_table[cpu]);\n\t\t\tset_cpu_numa_mem(cpu,\n\t\t\t\tlocal_memory_node(numa_cpu_lookup_table[cpu]));\n\t\t}\n#endif\n\t\t/*\n\t\t * cpu_core_map is now more updated and exists only since\n\t\t * its been exported for long. It only will have a snapshot\n\t\t * of cpu_cpu_mask.\n\t\t */\n\t\tcpumask_copy(per_cpu(cpu_core_map, cpu), cpu_cpu_mask(cpu));\n\t}\n\n\t/* Init the cpumasks so the boot CPU is related to itself */\n\tcpumask_set_cpu(boot_cpuid, cpu_sibling_mask(boot_cpuid));\n\tcpumask_set_cpu(boot_cpuid, cpu_l2_cache_mask(boot_cpuid));\n\n\tif (has_coregroup_support())\n\t\tcpumask_set_cpu(boot_cpuid, cpu_coregroup_mask(boot_cpuid));\n\n\tinit_big_cores();\n\tif (has_big_cores) {\n\t\tcpumask_set_cpu(boot_cpuid,\n\t\t\t\tcpu_smallcore_mask(boot_cpuid));\n\t}\n\n\tif (smp_ops && smp_ops->probe)\n\t\tsmp_ops->probe();\n}"
  },
  {
    "function_name": "init_big_cores",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "922-939",
    "snippet": "static int init_big_cores(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tint err = init_cpu_l1_cache_map(cpu);\n\n\t\tif (err)\n\t\t\treturn err;\n\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_smallcore_map, cpu),\n\t\t\t\t\tGFP_KERNEL,\n\t\t\t\t\tcpu_to_node(cpu));\n\t}\n\n\thas_big_cores = true;\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool has_big_cores;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&per_cpu(cpu_smallcore_map, cpu)",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_smallcore_map",
            "cpu"
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_cpu_l1_cache_map",
          "args": [
            "cpu"
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "init_cpu_l1_cache_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "808-852",
          "snippet": "static int init_cpu_l1_cache_map(int cpu)\n\n{\n\tstruct device_node *dn = of_get_cpu_node(cpu, NULL);\n\tstruct thread_groups tg = {.property = 0,\n\t\t\t\t   .nr_groups = 0,\n\t\t\t\t   .threads_per_group = 0};\n\tint first_thread = cpu_first_thread_sibling(cpu);\n\tint i, cpu_group_start = -1, err = 0;\n\n\tif (!dn)\n\t\treturn -ENODATA;\n\n\terr = parse_thread_groups(dn, &tg, THREAD_GROUP_SHARE_L1);\n\tif (err)\n\t\tgoto out;\n\n\tcpu_group_start = get_cpu_thread_group_start(cpu, &tg);\n\n\tif (unlikely(cpu_group_start == -1)) {\n\t\tWARN_ON_ONCE(1);\n\t\terr = -ENODATA;\n\t\tgoto out;\n\t}\n\n\tzalloc_cpumask_var_node(&per_cpu(cpu_l1_cache_map, cpu),\n\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\n\tfor (i = first_thread; i < first_thread + threads_per_core; i++) {\n\t\tint i_group_start = get_cpu_thread_group_start(i, &tg);\n\n\t\tif (unlikely(i_group_start == -1)) {\n\t\t\tWARN_ON_ONCE(1);\n\t\t\terr = -ENODATA;\n\t\t\tgoto out;\n\t\t}\n\n\t\tif (i_group_start == cpu_group_start)\n\t\t\tcpumask_set_cpu(i, per_cpu(cpu_l1_cache_map, cpu));\n\t}\n\nout:\n\tof_node_put(dn);\n\treturn err;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define THREAD_GROUP_SHARE_L1   1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\n#define THREAD_GROUP_SHARE_L1   1\n\nstatic int init_cpu_l1_cache_map(int cpu)\n\n{\n\tstruct device_node *dn = of_get_cpu_node(cpu, NULL);\n\tstruct thread_groups tg = {.property = 0,\n\t\t\t\t   .nr_groups = 0,\n\t\t\t\t   .threads_per_group = 0};\n\tint first_thread = cpu_first_thread_sibling(cpu);\n\tint i, cpu_group_start = -1, err = 0;\n\n\tif (!dn)\n\t\treturn -ENODATA;\n\n\terr = parse_thread_groups(dn, &tg, THREAD_GROUP_SHARE_L1);\n\tif (err)\n\t\tgoto out;\n\n\tcpu_group_start = get_cpu_thread_group_start(cpu, &tg);\n\n\tif (unlikely(cpu_group_start == -1)) {\n\t\tWARN_ON_ONCE(1);\n\t\terr = -ENODATA;\n\t\tgoto out;\n\t}\n\n\tzalloc_cpumask_var_node(&per_cpu(cpu_l1_cache_map, cpu),\n\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\n\tfor (i = first_thread; i < first_thread + threads_per_core; i++) {\n\t\tint i_group_start = get_cpu_thread_group_start(i, &tg);\n\n\t\tif (unlikely(i_group_start == -1)) {\n\t\t\tWARN_ON_ONCE(1);\n\t\t\terr = -ENODATA;\n\t\t\tgoto out;\n\t\t}\n\n\t\tif (i_group_start == cpu_group_start)\n\t\t\tcpumask_set_cpu(i, per_cpu(cpu_l1_cache_map, cpu));\n\t}\n\nout:\n\tof_node_put(dn);\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool has_big_cores;\n\nstatic int init_big_cores(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tint err = init_cpu_l1_cache_map(cpu);\n\n\t\tif (err)\n\t\t\treturn err;\n\n\t\tzalloc_cpumask_var_node(&per_cpu(cpu_smallcore_map, cpu),\n\t\t\t\t\tGFP_KERNEL,\n\t\t\t\t\tcpu_to_node(cpu));\n\t}\n\n\thas_big_cores = true;\n\treturn 0;\n}"
  },
  {
    "function_name": "cpu_mc_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "907-910",
    "snippet": "static const struct cpumask *cpu_mc_mask(int cpu)\n{\n\treturn cpu_coregroup_mask(cpu);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_coregroup_mask",
          "args": [
            "cpu"
          ],
          "line": 909
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_coregroup_mask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "897-900",
          "snippet": "static struct cpumask *cpu_coregroup_mask(int cpu)\n{\n\treturn per_cpu(cpu_coregroup_map, cpu);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic struct cpumask *cpu_coregroup_mask(int cpu)\n{\n\treturn per_cpu(cpu_coregroup_map, cpu);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic const struct cpumask *cpu_mc_mask(int cpu)\n{\n\treturn cpu_coregroup_mask(cpu);\n}"
  },
  {
    "function_name": "has_coregroup_support",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "902-905",
    "snippet": "static bool has_coregroup_support(void)\n{\n\treturn coregroup_enabled;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool coregroup_enabled;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nbool coregroup_enabled;\n\nstatic bool has_coregroup_support(void)\n{\n\treturn coregroup_enabled;\n}"
  },
  {
    "function_name": "cpu_coregroup_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "897-900",
    "snippet": "static struct cpumask *cpu_coregroup_mask(int cpu)\n{\n\treturn per_cpu(cpu_coregroup_map, cpu);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_coregroup_map",
            "cpu"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic struct cpumask *cpu_coregroup_mask(int cpu)\n{\n\treturn per_cpu(cpu_coregroup_map, cpu);\n}"
  },
  {
    "function_name": "smallcore_smt_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "891-894",
    "snippet": "static const struct cpumask *smallcore_smt_mask(int cpu)\n{\n\treturn cpu_smallcore_mask(cpu);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_smallcore_mask",
          "args": [
            "cpu"
          ],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic const struct cpumask *smallcore_smt_mask(int cpu)\n{\n\treturn cpu_smallcore_mask(cpu);\n}"
  },
  {
    "function_name": "shared_cache_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "885-888",
    "snippet": "static const struct cpumask *shared_cache_mask(int cpu)\n{\n\treturn per_cpu(cpu_l2_cache_map, cpu);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_l2_cache_map",
            "cpu"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic const struct cpumask *shared_cache_mask(int cpu)\n{\n\treturn per_cpu(cpu_l2_cache_map, cpu);\n}"
  },
  {
    "function_name": "powerpc_shared_cache_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "876-879",
    "snippet": "static int powerpc_shared_cache_flags(void)\n{\n\treturn SD_SHARE_PKG_RESOURCES;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic int powerpc_shared_cache_flags(void)\n{\n\treturn SD_SHARE_PKG_RESOURCES;\n}"
  },
  {
    "function_name": "powerpc_smt_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "858-867",
    "snippet": "static int powerpc_smt_flags(void)\n{\n\tint flags = SD_SHARE_CPUCAPACITY | SD_SHARE_PKG_RESOURCES;\n\n\tif (cpu_has_feature(CPU_FTR_ASYM_SMT)) {\n\t\tprintk_once(KERN_INFO \"Enabling Asymmetric SMT scheduling\\n\");\n\t\tflags |= SD_ASYM_PACKING;\n\t}\n\treturn flags;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk_once",
          "args": [
            "KERN_INFO \"Enabling Asymmetric SMT scheduling\\n\""
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ASYM_SMT"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic int powerpc_smt_flags(void)\n{\n\tint flags = SD_SHARE_CPUCAPACITY | SD_SHARE_PKG_RESOURCES;\n\n\tif (cpu_has_feature(CPU_FTR_ASYM_SMT)) {\n\t\tprintk_once(KERN_INFO \"Enabling Asymmetric SMT scheduling\\n\");\n\t\tflags |= SD_ASYM_PACKING;\n\t}\n\treturn flags;\n}"
  },
  {
    "function_name": "init_cpu_l1_cache_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "808-852",
    "snippet": "static int init_cpu_l1_cache_map(int cpu)\n\n{\n\tstruct device_node *dn = of_get_cpu_node(cpu, NULL);\n\tstruct thread_groups tg = {.property = 0,\n\t\t\t\t   .nr_groups = 0,\n\t\t\t\t   .threads_per_group = 0};\n\tint first_thread = cpu_first_thread_sibling(cpu);\n\tint i, cpu_group_start = -1, err = 0;\n\n\tif (!dn)\n\t\treturn -ENODATA;\n\n\terr = parse_thread_groups(dn, &tg, THREAD_GROUP_SHARE_L1);\n\tif (err)\n\t\tgoto out;\n\n\tcpu_group_start = get_cpu_thread_group_start(cpu, &tg);\n\n\tif (unlikely(cpu_group_start == -1)) {\n\t\tWARN_ON_ONCE(1);\n\t\terr = -ENODATA;\n\t\tgoto out;\n\t}\n\n\tzalloc_cpumask_var_node(&per_cpu(cpu_l1_cache_map, cpu),\n\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\n\tfor (i = first_thread; i < first_thread + threads_per_core; i++) {\n\t\tint i_group_start = get_cpu_thread_group_start(i, &tg);\n\n\t\tif (unlikely(i_group_start == -1)) {\n\t\t\tWARN_ON_ONCE(1);\n\t\t\terr = -ENODATA;\n\t\t\tgoto out;\n\t\t}\n\n\t\tif (i_group_start == cpu_group_start)\n\t\t\tcpumask_set_cpu(i, per_cpu(cpu_l1_cache_map, cpu));\n\t}\n\nout:\n\tof_node_put(dn);\n\treturn err;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define THREAD_GROUP_SHARE_L1   1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "dn"
          ],
          "line": 850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "i",
            "per_cpu(cpu_l1_cache_map, cpu)"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_l1_cache_map",
            "cpu"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "i_group_start == -1"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_thread_group_start",
          "args": [
            "i",
            "&tg"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "get_cpu_thread_group_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "789-806",
          "snippet": "static int get_cpu_thread_group_start(int cpu, struct thread_groups *tg)\n{\n\tint hw_cpu_id = get_hard_smp_processor_id(cpu);\n\tint i, j;\n\n\tfor (i = 0; i < tg->nr_groups; i++) {\n\t\tint group_start = i * tg->threads_per_group;\n\n\t\tfor (j = 0; j < tg->threads_per_group; j++) {\n\t\t\tint idx = group_start + j;\n\n\t\t\tif (tg->thread_list[idx] == hw_cpu_id)\n\t\t\t\treturn group_start;\n\t\t}\n\t}\n\n\treturn -1;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic int get_cpu_thread_group_start(int cpu, struct thread_groups *tg)\n{\n\tint hw_cpu_id = get_hard_smp_processor_id(cpu);\n\tint i, j;\n\n\tfor (i = 0; i < tg->nr_groups; i++) {\n\t\tint group_start = i * tg->threads_per_group;\n\n\t\tfor (j = 0; j < tg->threads_per_group; j++) {\n\t\t\tint idx = group_start + j;\n\n\t\t\tif (tg->thread_list[idx] == hw_cpu_id)\n\t\t\t\treturn group_start;\n\t\t}\n\t}\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&per_cpu(cpu_l1_cache_map, cpu)",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_l1_cache_map",
            "cpu"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "cpu_group_start == -1"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_thread_groups",
          "args": [
            "dn",
            "&tg",
            "THREAD_GROUP_SHARE_L1"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "parse_thread_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "736-773",
          "snippet": "static int parse_thread_groups(struct device_node *dn,\n\t\t\t       struct thread_groups *tg,\n\t\t\t       unsigned int property)\n{\n\tint i;\n\tu32 thread_group_array[3 + MAX_THREAD_LIST_SIZE];\n\tu32 *thread_list;\n\tsize_t total_threads;\n\tint ret;\n\n\tret = of_property_read_u32_array(dn, \"ibm,thread-groups\",\n\t\t\t\t\t thread_group_array, 3);\n\tif (ret)\n\t\treturn ret;\n\n\ttg->property = thread_group_array[0];\n\ttg->nr_groups = thread_group_array[1];\n\ttg->threads_per_group = thread_group_array[2];\n\tif (tg->property != property ||\n\t    tg->nr_groups < 1 ||\n\t    tg->threads_per_group < 1)\n\t\treturn -ENODATA;\n\n\ttotal_threads = tg->nr_groups * tg->threads_per_group;\n\n\tret = of_property_read_u32_array(dn, \"ibm,thread-groups\",\n\t\t\t\t\t thread_group_array,\n\t\t\t\t\t 3 + total_threads);\n\tif (ret)\n\t\treturn ret;\n\n\tthread_list = &thread_group_array[3];\n\n\tfor (i = 0 ; i < total_threads; i++)\n\t\ttg->thread_list[i] = thread_list[i];\n\n\treturn 0;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MAX_THREAD_LIST_SIZE\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\n#define MAX_THREAD_LIST_SIZE\t8\n\nstatic int parse_thread_groups(struct device_node *dn,\n\t\t\t       struct thread_groups *tg,\n\t\t\t       unsigned int property)\n{\n\tint i;\n\tu32 thread_group_array[3 + MAX_THREAD_LIST_SIZE];\n\tu32 *thread_list;\n\tsize_t total_threads;\n\tint ret;\n\n\tret = of_property_read_u32_array(dn, \"ibm,thread-groups\",\n\t\t\t\t\t thread_group_array, 3);\n\tif (ret)\n\t\treturn ret;\n\n\ttg->property = thread_group_array[0];\n\ttg->nr_groups = thread_group_array[1];\n\ttg->threads_per_group = thread_group_array[2];\n\tif (tg->property != property ||\n\t    tg->nr_groups < 1 ||\n\t    tg->threads_per_group < 1)\n\t\treturn -ENODATA;\n\n\ttotal_threads = tg->nr_groups * tg->threads_per_group;\n\n\tret = of_property_read_u32_array(dn, \"ibm,thread-groups\",\n\t\t\t\t\t thread_group_array,\n\t\t\t\t\t 3 + total_threads);\n\tif (ret)\n\t\treturn ret;\n\n\tthread_list = &thread_group_array[3];\n\n\tfor (i = 0 ; i < total_threads; i++)\n\t\ttg->thread_list[i] = thread_list[i];\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_first_thread_sibling",
          "args": [
            "cpu"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_cpu_node",
          "args": [
            "cpu",
            "NULL"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\n#define THREAD_GROUP_SHARE_L1   1\n\nstatic int init_cpu_l1_cache_map(int cpu)\n\n{\n\tstruct device_node *dn = of_get_cpu_node(cpu, NULL);\n\tstruct thread_groups tg = {.property = 0,\n\t\t\t\t   .nr_groups = 0,\n\t\t\t\t   .threads_per_group = 0};\n\tint first_thread = cpu_first_thread_sibling(cpu);\n\tint i, cpu_group_start = -1, err = 0;\n\n\tif (!dn)\n\t\treturn -ENODATA;\n\n\terr = parse_thread_groups(dn, &tg, THREAD_GROUP_SHARE_L1);\n\tif (err)\n\t\tgoto out;\n\n\tcpu_group_start = get_cpu_thread_group_start(cpu, &tg);\n\n\tif (unlikely(cpu_group_start == -1)) {\n\t\tWARN_ON_ONCE(1);\n\t\terr = -ENODATA;\n\t\tgoto out;\n\t}\n\n\tzalloc_cpumask_var_node(&per_cpu(cpu_l1_cache_map, cpu),\n\t\t\t\tGFP_KERNEL, cpu_to_node(cpu));\n\n\tfor (i = first_thread; i < first_thread + threads_per_core; i++) {\n\t\tint i_group_start = get_cpu_thread_group_start(i, &tg);\n\n\t\tif (unlikely(i_group_start == -1)) {\n\t\t\tWARN_ON_ONCE(1);\n\t\t\terr = -ENODATA;\n\t\t\tgoto out;\n\t\t}\n\n\t\tif (i_group_start == cpu_group_start)\n\t\t\tcpumask_set_cpu(i, per_cpu(cpu_l1_cache_map, cpu));\n\t}\n\nout:\n\tof_node_put(dn);\n\treturn err;\n}"
  },
  {
    "function_name": "get_cpu_thread_group_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "789-806",
    "snippet": "static int get_cpu_thread_group_start(int cpu, struct thread_groups *tg)\n{\n\tint hw_cpu_id = get_hard_smp_processor_id(cpu);\n\tint i, j;\n\n\tfor (i = 0; i < tg->nr_groups; i++) {\n\t\tint group_start = i * tg->threads_per_group;\n\n\t\tfor (j = 0; j < tg->threads_per_group; j++) {\n\t\t\tint idx = group_start + j;\n\n\t\t\tif (tg->thread_list[idx] == hw_cpu_id)\n\t\t\t\treturn group_start;\n\t\t}\n\t}\n\n\treturn -1;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_hard_smp_processor_id",
          "args": [
            "cpu"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic int get_cpu_thread_group_start(int cpu, struct thread_groups *tg)\n{\n\tint hw_cpu_id = get_hard_smp_processor_id(cpu);\n\tint i, j;\n\n\tfor (i = 0; i < tg->nr_groups; i++) {\n\t\tint group_start = i * tg->threads_per_group;\n\n\t\tfor (j = 0; j < tg->threads_per_group; j++) {\n\t\t\tint idx = group_start + j;\n\n\t\t\tif (tg->thread_list[idx] == hw_cpu_id)\n\t\t\t\treturn group_start;\n\t\t}\n\t}\n\n\treturn -1;\n}"
  },
  {
    "function_name": "parse_thread_groups",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "736-773",
    "snippet": "static int parse_thread_groups(struct device_node *dn,\n\t\t\t       struct thread_groups *tg,\n\t\t\t       unsigned int property)\n{\n\tint i;\n\tu32 thread_group_array[3 + MAX_THREAD_LIST_SIZE];\n\tu32 *thread_list;\n\tsize_t total_threads;\n\tint ret;\n\n\tret = of_property_read_u32_array(dn, \"ibm,thread-groups\",\n\t\t\t\t\t thread_group_array, 3);\n\tif (ret)\n\t\treturn ret;\n\n\ttg->property = thread_group_array[0];\n\ttg->nr_groups = thread_group_array[1];\n\ttg->threads_per_group = thread_group_array[2];\n\tif (tg->property != property ||\n\t    tg->nr_groups < 1 ||\n\t    tg->threads_per_group < 1)\n\t\treturn -ENODATA;\n\n\ttotal_threads = tg->nr_groups * tg->threads_per_group;\n\n\tret = of_property_read_u32_array(dn, \"ibm,thread-groups\",\n\t\t\t\t\t thread_group_array,\n\t\t\t\t\t 3 + total_threads);\n\tif (ret)\n\t\treturn ret;\n\n\tthread_list = &thread_group_array[3];\n\n\tfor (i = 0 ; i < total_threads; i++)\n\t\ttg->thread_list[i] = thread_list[i];\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define MAX_THREAD_LIST_SIZE\t8"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_property_read_u32_array",
          "args": [
            "dn",
            "\"ibm,thread-groups\"",
            "thread_group_array",
            "3 + total_threads"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_property_read_u32_array",
          "args": [
            "dn",
            "\"ibm,thread-groups\"",
            "thread_group_array",
            "3"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\n#define MAX_THREAD_LIST_SIZE\t8\n\nstatic int parse_thread_groups(struct device_node *dn,\n\t\t\t       struct thread_groups *tg,\n\t\t\t       unsigned int property)\n{\n\tint i;\n\tu32 thread_group_array[3 + MAX_THREAD_LIST_SIZE];\n\tu32 *thread_list;\n\tsize_t total_threads;\n\tint ret;\n\n\tret = of_property_read_u32_array(dn, \"ibm,thread-groups\",\n\t\t\t\t\t thread_group_array, 3);\n\tif (ret)\n\t\treturn ret;\n\n\ttg->property = thread_group_array[0];\n\ttg->nr_groups = thread_group_array[1];\n\ttg->threads_per_group = thread_group_array[2];\n\tif (tg->property != property ||\n\t    tg->nr_groups < 1 ||\n\t    tg->threads_per_group < 1)\n\t\treturn -ENODATA;\n\n\ttotal_threads = tg->nr_groups * tg->threads_per_group;\n\n\tret = of_property_read_u32_array(dn, \"ibm,thread-groups\",\n\t\t\t\t\t thread_group_array,\n\t\t\t\t\t 3 + total_threads);\n\tif (ret)\n\t\treturn ret;\n\n\tthread_list = &thread_group_array[3];\n\n\tfor (i = 0 ; i < total_threads; i++)\n\t\ttg->thread_list[i] = thread_list[i];\n\n\treturn 0;\n}"
  },
  {
    "function_name": "or_cpumasks_related",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "677-693",
    "snippet": "static void or_cpumasks_related(int i, int j, struct cpumask *(*srcmask)(int),\n\t\t\t\tstruct cpumask *(*dstmask)(int))\n{\n\tstruct cpumask *mask;\n\tint k;\n\n\tmask = srcmask(j);\n\tfor_each_cpu(k, srcmask(i))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n\n\tif (i == j)\n\t\treturn;\n\n\tmask = srcmask(i);\n\tfor_each_cpu(k, srcmask(j))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_or",
          "args": [
            "dstmask(k)",
            "dstmask(k)",
            "mask"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dstmask",
          "args": [
            "k"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dstmask",
          "args": [
            "k"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "k",
            "srcmask(j)"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "srcmask",
          "args": [
            "j"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "srcmask",
          "args": [
            "i"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_or",
          "args": [
            "dstmask(k)",
            "dstmask(k)",
            "mask"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dstmask",
          "args": [
            "k"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dstmask",
          "args": [
            "k"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "k",
            "srcmask(i)"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "srcmask",
          "args": [
            "i"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "srcmask",
          "args": [
            "j"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void or_cpumasks_related(int i, int j, struct cpumask *(*srcmask)(int),\n\t\t\t\tstruct cpumask *(*dstmask)(int))\n{\n\tstruct cpumask *mask;\n\tint k;\n\n\tmask = srcmask(j);\n\tfor_each_cpu(k, srcmask(i))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n\n\tif (i == j)\n\t\treturn;\n\n\tmask = srcmask(i);\n\tfor_each_cpu(k, srcmask(j))\n\t\tcpumask_or(dstmask(k), dstmask(k), mask);\n}"
  },
  {
    "function_name": "set_cpus_unrelated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "665-670",
    "snippet": "static void set_cpus_unrelated(int i, int j,\n\t\tstruct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_clear_cpu(i, get_cpumask(j));\n\tcpumask_clear_cpu(j, get_cpumask(i));\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "j",
            "get_cpumask(i)"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpumask",
          "args": [
            "i"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "i",
            "get_cpumask(j)"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpumask",
          "args": [
            "j"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void set_cpus_unrelated(int i, int j,\n\t\tstruct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_clear_cpu(i, get_cpumask(j));\n\tcpumask_clear_cpu(j, get_cpumask(i));\n}"
  },
  {
    "function_name": "set_cpus_related",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "658-662",
    "snippet": "static void set_cpus_related(int i, int j, struct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_set_cpu(i, get_cpumask(j));\n\tcpumask_set_cpu(j, get_cpumask(i));\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "j",
            "get_cpumask(i)"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpumask",
          "args": [
            "i"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "i",
            "get_cpumask(j)"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpumask",
          "args": [
            "j"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void set_cpus_related(int i, int j, struct cpumask *(*get_cpumask)(int))\n{\n\tcpumask_set_cpu(i, get_cpumask(j));\n\tcpumask_set_cpu(j, get_cpumask(i));\n}"
  },
  {
    "function_name": "smp_store_cpu_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "644-651",
    "snippet": "static void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_TLB1CFG"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "next_tlbcam_idx",
            "id"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PVR"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cpu_pvr",
            "id"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void smp_store_cpu_info(int id)\n{\n\tper_cpu(cpu_pvr, id) = mfspr(SPRN_PVR);\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tper_cpu(next_tlbcam_idx, id)\n\t\t= (mfspr(SPRN_TLB1CFG) & TLBnCFG_N_ENTRY) - 1;\n#endif\n}"
  },
  {
    "function_name": "smp_send_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "623-639",
    "snippet": "void smp_send_stop(void)\n{\n\tstatic bool stopped = false;\n\n\t/*\n\t * Prevent waiting on csd lock from a previous smp_send_stop.\n\t * This is racy, but in general callers try to do the right\n\t * thing and only fire off one smp_send_stop (e.g., see\n\t * kernel/panic.c)\n\t */\n\tif (stopped)\n\t\treturn;\n\n\tstopped = true;\n\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_call_function",
          "args": [
            "stop_this_cpu",
            "NULL",
            "0"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_send_stop(void)\n{\n\tstatic bool stopped = false;\n\n\t/*\n\t * Prevent waiting on csd lock from a previous smp_send_stop.\n\t * This is racy, but in general callers try to do the right\n\t * thing and only fire off one smp_send_stop (e.g., see\n\t * kernel/panic.c)\n\t */\n\tif (stopped)\n\t\treturn;\n\n\tstopped = true;\n\n\tsmp_call_function(stop_this_cpu, NULL, 0);\n}"
  },
  {
    "function_name": "stop_this_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "615-621",
    "snippet": "static void stop_this_cpu(void *dummy)\n{\n\thard_irq_disable();\n\tspin_begin();\n\twhile (1)\n\t\tspin_cpu_relax();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_cpu_relax",
          "args": [],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_begin",
          "args": [],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hard_irq_disable",
          "args": [],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void stop_this_cpu(void *dummy)\n{\n\thard_irq_disable();\n\tspin_begin();\n\twhile (1)\n\t\tspin_cpu_relax();\n}"
  },
  {
    "function_name": "smp_send_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "608-611",
    "snippet": "void smp_send_stop(void)\n{\n\tsmp_send_nmi_ipi(NMI_IPI_ALL_OTHERS, nmi_stop_this_cpu, 1000000);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_send_nmi_ipi",
          "args": [
            "NMI_IPI_ALL_OTHERS",
            "nmi_stop_this_cpu",
            "1000000"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_nmi_ipi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "539-542",
          "snippet": "int smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *), u64 delay_us)\n{\n\treturn __smp_send_nmi_ipi(cpu, fn, delay_us, false);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *), u64 delay_us)\n{\n\treturn __smp_send_nmi_ipi(cpu, fn, delay_us, false);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_send_stop(void)\n{\n\tsmp_send_nmi_ipi(NMI_IPI_ALL_OTHERS, nmi_stop_this_cpu, 1000000);\n}"
  },
  {
    "function_name": "nmi_stop_this_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "598-606",
    "snippet": "static void nmi_stop_this_cpu(struct pt_regs *regs)\n{\n\t/*\n\t * IRQs are already hard disabled by the smp_handle_nmi_ipi.\n\t */\n\tspin_begin();\n\twhile (1)\n\t\tspin_cpu_relax();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_cpu_relax",
          "args": [],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_begin",
          "args": [],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_stop_this_cpu(struct pt_regs *regs)\n{\n\t/*\n\t * IRQs are already hard disabled by the smp_handle_nmi_ipi.\n\t */\n\tspin_begin();\n\twhile (1)\n\t\tspin_cpu_relax();\n}"
  },
  {
    "function_name": "crash_send_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "573-594",
    "snippet": "void crash_send_ipi(void (*crash_ipi_callback)(struct pt_regs *))\n{\n\tint cpu;\n\n\tsmp_send_nmi_ipi(NMI_IPI_ALL_OTHERS, crash_ipi_callback, 1000000);\n\tif (kdump_in_progress() && crash_wake_offline) {\n\t\tfor_each_present_cpu(cpu) {\n\t\t\tif (cpu_online(cpu))\n\t\t\t\tcontinue;\n\t\t\t/*\n\t\t\t * crash_ipi_callback will wait for\n\t\t\t * all cpus, including offline CPUs.\n\t\t\t * We don't care about nmi_ipi_function.\n\t\t\t * Offline cpus will jump straight into\n\t\t\t * crash_ipi_callback, we can skip the\n\t\t\t * entire NMI dance and waiting for\n\t\t\t * cpus to clear pending mask, etc.\n\t\t\t */\n\t\t\tdo_smp_send_nmi_ipi(cpu, false);\n\t\t}\n\t}\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_smp_send_nmi_ipi",
          "args": [
            "cpu",
            "false"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "do_smp_send_nmi_ipi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "450-466",
          "snippet": "static void do_smp_send_nmi_ipi(int cpu, bool safe)\n{\n\tif (!safe && smp_ops->cause_nmi_ipi && smp_ops->cause_nmi_ipi(cpu))\n\t\treturn;\n\n\tif (cpu >= 0) {\n\t\tdo_message_pass(cpu, PPC_MSG_NMI_IPI);\n\t} else {\n\t\tint c;\n\n\t\tfor_each_online_cpu(c) {\n\t\t\tif (c == raw_smp_processor_id())\n\t\t\t\tcontinue;\n\t\t\tdo_message_pass(c, PPC_MSG_NMI_IPI);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic void do_smp_send_nmi_ipi(int cpu, bool safe)\n{\n\tif (!safe && smp_ops->cause_nmi_ipi && smp_ops->cause_nmi_ipi(cpu))\n\t\treturn;\n\n\tif (cpu >= 0) {\n\t\tdo_message_pass(cpu, PPC_MSG_NMI_IPI);\n\t} else {\n\t\tint c;\n\n\t\tfor_each_online_cpu(c) {\n\t\t\tif (c == raw_smp_processor_id())\n\t\t\t\tcontinue;\n\t\t\tdo_message_pass(c, PPC_MSG_NMI_IPI);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "cpu"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_cpu_online",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/sysfs.c",
          "lines": "924-1018",
          "snippet": "static int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}",
          "includes": [
            "#include <asm/lppaca.h>",
            "#include <asm/paca.h>",
            "#include \"setup.h\"",
            "#include \"cacheinfo.h\"",
            "#include <asm/svm.h>",
            "#include <asm/idle.h>",
            "#include <asm/firmware.h>",
            "#include <asm/pmc.h>",
            "#include <asm/smp.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/hvcall.h>",
            "#include <asm/cputable.h>",
            "#include <asm/processor.h>",
            "#include <asm/current.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>"
          ],
          "macros_used": [
            "#define unregister_cpu_online NULL",
            "#define HAS_PPC_PA6T",
            "#define HAS_PPC_PMC_G4\t\t1",
            "#define HAS_PPC_PMC_PA6T\t1",
            "#define HAS_PPC_PMC_IBM\t\t1"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cpu, cpu_devices);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/lppaca.h>\n#include <asm/paca.h>\n#include \"setup.h\"\n#include \"cacheinfo.h\"\n#include <asm/svm.h>\n#include <asm/idle.h>\n#include <asm/firmware.h>\n#include <asm/pmc.h>\n#include <asm/smp.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/hvcall.h>\n#include <asm/cputable.h>\n#include <asm/processor.h>\n#include <asm/current.h>\n#include <linux/notifier.h>\n#include <linux/cpumask.h>\n#include <linux/nodemask.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n\n#define unregister_cpu_online NULL\n#define HAS_PPC_PA6T\n#define HAS_PPC_PMC_G4\t\t1\n#define HAS_PPC_PMC_PA6T\t1\n#define HAS_PPC_PMC_IBM\t\t1\n\nstatic DEFINE_PER_CPU(struct cpu, cpu_devices);\n\nstatic int unregister_cpu_online(unsigned int cpu)\n{\n\tstruct cpu *c = &per_cpu(cpu_devices, cpu);\n\tstruct device *s = &c->dev;\n\tstruct device_attribute *attrs, *pmc_attrs;\n\tint i, nattrs;\n\n\tBUG_ON(!c->hotpluggable);\n\n#ifdef CONFIG_PPC64\n\tif (cpu_has_feature(CPU_FTR_SMT))\n\t\tdevice_remove_file(s, &dev_attr_smt_snooze_delay);\n#endif\n\n\t/* PMC stuff */\n\tswitch (cur_cpu_spec->pmc_type) {\n#ifdef HAS_PPC_PMC_IBM\n\tcase PPC_PMC_IBM:\n\t\tattrs = ibm_common_attrs;\n\t\tnattrs = sizeof(ibm_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_IBM */\n#ifdef HAS_PPC_PMC_G4\n\tcase PPC_PMC_G4:\n\t\tattrs = g4_common_attrs;\n\t\tnattrs = sizeof(g4_common_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = classic_pmc_attrs;\n\t\tbreak;\n#endif /* HAS_PPC_PMC_G4 */\n#if defined(HAS_PPC_PMC_PA6T) || defined(HAS_PPC_PA6T)\n\tcase PPC_PMC_PA6T:\n\t\t/* PA Semi starts counting at PMC0 */\n\t\tattrs = pa6t_attrs;\n\t\tnattrs = sizeof(pa6t_attrs) / sizeof(struct device_attribute);\n\t\tpmc_attrs = NULL;\n\t\tbreak;\n#endif\n\tdefault:\n\t\tattrs = NULL;\n\t\tnattrs = 0;\n\t\tpmc_attrs = NULL;\n\t}\n\n\tfor (i = 0; i < nattrs; i++)\n\t\tdevice_remove_file(s, &attrs[i]);\n\n\tif (pmc_attrs)\n\t\tfor (i = 0; i < cur_cpu_spec->num_pmcs; i++)\n\t\t\tdevice_remove_file(s, &pmc_attrs[i]);\n\n#ifdef CONFIG_PPC64\n#ifdef CONFIG_PMU_SYSFS\n\tif (cpu_has_feature(CPU_FTR_MMCRA))\n\t\tdevice_remove_file(s, &dev_attr_mmcra);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_31))\n\t\tdevice_remove_file(s, &dev_attr_mmcr3);\n#endif /* CONFIG_PMU_SYSFS */\n\n\tif (cpu_has_feature(CPU_FTR_PURR)) {\n\t\tdevice_remove_file(s, &dev_attr_purr);\n\t\tremove_idle_purr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_SPURR)) {\n\t\tdevice_remove_file(s, &dev_attr_spurr);\n\t\tremove_idle_spurr_file(s);\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DSCR))\n\t\tdevice_remove_file(s, &dev_attr_dscr);\n\n\tif (cpu_has_feature(CPU_FTR_PPCAS_ARCH_V2))\n\t\tdevice_remove_file(s, &dev_attr_pir);\n\n\tif (cpu_has_feature(CPU_FTR_ARCH_206) &&\n\t\t!firmware_has_feature(FW_FEATURE_LPAR))\n\t\tdevice_remove_file(s, &dev_attr_tscr);\n#endif /* CONFIG_PPC64 */\n\n#ifdef CONFIG_PPC_FSL_BOOK3E\n\tif (PVR_VER(cur_cpu_spec->pvr_value) == PVR_VER_E6500) {\n\t\tdevice_remove_file(s, &dev_attr_pw20_state);\n\t\tdevice_remove_file(s, &dev_attr_pw20_wait_time);\n\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle);\n\t\tdevice_remove_file(s, &dev_attr_altivec_idle_wait_time);\n\t}\n#endif\n\tcacheinfo_cpu_offline(cpu);\n\tof_node_put(s->of_node);\n\ts->of_node = NULL;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kdump_in_progress",
          "args": [],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_send_nmi_ipi",
          "args": [
            "NMI_IPI_ALL_OTHERS",
            "crash_ipi_callback",
            "1000000"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_nmi_ipi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "539-542",
          "snippet": "int smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *), u64 delay_us)\n{\n\treturn __smp_send_nmi_ipi(cpu, fn, delay_us, false);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *), u64 delay_us)\n{\n\treturn __smp_send_nmi_ipi(cpu, fn, delay_us, false);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid crash_send_ipi(void (*crash_ipi_callback)(struct pt_regs *))\n{\n\tint cpu;\n\n\tsmp_send_nmi_ipi(NMI_IPI_ALL_OTHERS, crash_ipi_callback, 1000000);\n\tif (kdump_in_progress() && crash_wake_offline) {\n\t\tfor_each_present_cpu(cpu) {\n\t\t\tif (cpu_online(cpu))\n\t\t\t\tcontinue;\n\t\t\t/*\n\t\t\t * crash_ipi_callback will wait for\n\t\t\t * all cpus, including offline CPUs.\n\t\t\t * We don't care about nmi_ipi_function.\n\t\t\t * Offline cpus will jump straight into\n\t\t\t * crash_ipi_callback, we can skip the\n\t\t\t * entire NMI dance and waiting for\n\t\t\t * cpus to clear pending mask, etc.\n\t\t\t */\n\t\t\tdo_smp_send_nmi_ipi(cpu, false);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "smp_send_debugger_break",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "566-569",
    "snippet": "void smp_send_debugger_break(void)\n{\n\tsmp_send_nmi_ipi(NMI_IPI_ALL_OTHERS, debugger_ipi_callback, 1000000);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_send_nmi_ipi",
          "args": [
            "NMI_IPI_ALL_OTHERS",
            "debugger_ipi_callback",
            "1000000"
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_nmi_ipi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "539-542",
          "snippet": "int smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *), u64 delay_us)\n{\n\treturn __smp_send_nmi_ipi(cpu, fn, delay_us, false);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *), u64 delay_us)\n{\n\treturn __smp_send_nmi_ipi(cpu, fn, delay_us, false);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_send_debugger_break(void)\n{\n\tsmp_send_nmi_ipi(NMI_IPI_ALL_OTHERS, debugger_ipi_callback, 1000000);\n}"
  },
  {
    "function_name": "debugger_ipi_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "561-564",
    "snippet": "void debugger_ipi_callback(struct pt_regs *regs)\n{\n\tdebugger_ipi(regs);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugger_ipi",
          "args": [
            "regs"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "debugger_ipi_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "561-564",
          "snippet": "void debugger_ipi_callback(struct pt_regs *regs)\n{\n\tdebugger_ipi(regs);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid debugger_ipi_callback(struct pt_regs *regs)\n{\n\tdebugger_ipi(regs);\n}"
  },
  {
    "function_name": "tick_broadcast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "551-557",
    "snippet": "void tick_broadcast(const struct cpumask *mask)\n{\n\tunsigned int cpu;\n\n\tfor_each_cpu(cpu, mask)\n\t\tdo_message_pass(cpu, PPC_MSG_TICK_BROADCAST);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_message_pass",
          "args": [
            "cpu",
            "PPC_MSG_TICK_BROADCAST"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "do_message_pass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "332-340",
          "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "cpu",
            "mask"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid tick_broadcast(const struct cpumask *mask)\n{\n\tunsigned int cpu;\n\n\tfor_each_cpu(cpu, mask)\n\t\tdo_message_pass(cpu, PPC_MSG_TICK_BROADCAST);\n}"
  },
  {
    "function_name": "smp_send_safe_nmi_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "544-547",
    "snippet": "int smp_send_safe_nmi_ipi(int cpu, void (*fn)(struct pt_regs *), u64 delay_us)\n{\n\treturn __smp_send_nmi_ipi(cpu, fn, delay_us, true);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__smp_send_nmi_ipi",
          "args": [
            "cpu",
            "fn",
            "delay_us",
            "true"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "__smp_send_nmi_ipi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "474-537",
          "snippet": "static int __smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *),\n\t\t\t\tu64 delay_us, bool safe)\n{\n\tunsigned long flags;\n\tint me = raw_smp_processor_id();\n\tint ret = 1;\n\n\tBUG_ON(cpu == me);\n\tBUG_ON(cpu < 0 && cpu != NMI_IPI_ALL_OTHERS);\n\n\tif (unlikely(!smp_ops))\n\t\treturn 0;\n\n\tnmi_ipi_lock_start(&flags);\n\twhile (nmi_ipi_busy) {\n\t\tnmi_ipi_unlock_end(&flags);\n\t\tspin_until_cond(!nmi_ipi_busy);\n\t\tnmi_ipi_lock_start(&flags);\n\t}\n\tnmi_ipi_busy = true;\n\tnmi_ipi_function = fn;\n\n\tWARN_ON_ONCE(!cpumask_empty(&nmi_ipi_pending_mask));\n\n\tif (cpu < 0) {\n\t\t/* ALL_OTHERS */\n\t\tcpumask_copy(&nmi_ipi_pending_mask, cpu_online_mask);\n\t\tcpumask_clear_cpu(me, &nmi_ipi_pending_mask);\n\t} else {\n\t\tcpumask_set_cpu(cpu, &nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_unlock();\n\n\t/* Interrupts remain hard disabled */\n\n\tdo_smp_send_nmi_ipi(cpu, safe);\n\n\tnmi_ipi_lock();\n\t/* nmi_ipi_busy is set here, so unlock/lock is okay */\n\twhile (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\tnmi_ipi_unlock();\n\t\tudelay(1);\n\t\tnmi_ipi_lock();\n\t\tif (delay_us) {\n\t\t\tdelay_us--;\n\t\t\tif (!delay_us)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\t/* Timeout waiting for CPUs to call smp_handle_nmi_ipi */\n\t\tret = 0;\n\t\tcpumask_clear(&nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_function = NULL;\n\tnmi_ipi_busy = false;\n\n\tnmi_ipi_unlock_end(&flags);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic int __smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *),\n\t\t\t\tu64 delay_us, bool safe)\n{\n\tunsigned long flags;\n\tint me = raw_smp_processor_id();\n\tint ret = 1;\n\n\tBUG_ON(cpu == me);\n\tBUG_ON(cpu < 0 && cpu != NMI_IPI_ALL_OTHERS);\n\n\tif (unlikely(!smp_ops))\n\t\treturn 0;\n\n\tnmi_ipi_lock_start(&flags);\n\twhile (nmi_ipi_busy) {\n\t\tnmi_ipi_unlock_end(&flags);\n\t\tspin_until_cond(!nmi_ipi_busy);\n\t\tnmi_ipi_lock_start(&flags);\n\t}\n\tnmi_ipi_busy = true;\n\tnmi_ipi_function = fn;\n\n\tWARN_ON_ONCE(!cpumask_empty(&nmi_ipi_pending_mask));\n\n\tif (cpu < 0) {\n\t\t/* ALL_OTHERS */\n\t\tcpumask_copy(&nmi_ipi_pending_mask, cpu_online_mask);\n\t\tcpumask_clear_cpu(me, &nmi_ipi_pending_mask);\n\t} else {\n\t\tcpumask_set_cpu(cpu, &nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_unlock();\n\n\t/* Interrupts remain hard disabled */\n\n\tdo_smp_send_nmi_ipi(cpu, safe);\n\n\tnmi_ipi_lock();\n\t/* nmi_ipi_busy is set here, so unlock/lock is okay */\n\twhile (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\tnmi_ipi_unlock();\n\t\tudelay(1);\n\t\tnmi_ipi_lock();\n\t\tif (delay_us) {\n\t\t\tdelay_us--;\n\t\t\tif (!delay_us)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\t/* Timeout waiting for CPUs to call smp_handle_nmi_ipi */\n\t\tret = 0;\n\t\tcpumask_clear(&nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_function = NULL;\n\tnmi_ipi_busy = false;\n\n\tnmi_ipi_unlock_end(&flags);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smp_send_safe_nmi_ipi(int cpu, void (*fn)(struct pt_regs *), u64 delay_us)\n{\n\treturn __smp_send_nmi_ipi(cpu, fn, delay_us, true);\n}"
  },
  {
    "function_name": "smp_send_nmi_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "539-542",
    "snippet": "int smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *), u64 delay_us)\n{\n\treturn __smp_send_nmi_ipi(cpu, fn, delay_us, false);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__smp_send_nmi_ipi",
          "args": [
            "cpu",
            "fn",
            "delay_us",
            "false"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "__smp_send_nmi_ipi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "474-537",
          "snippet": "static int __smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *),\n\t\t\t\tu64 delay_us, bool safe)\n{\n\tunsigned long flags;\n\tint me = raw_smp_processor_id();\n\tint ret = 1;\n\n\tBUG_ON(cpu == me);\n\tBUG_ON(cpu < 0 && cpu != NMI_IPI_ALL_OTHERS);\n\n\tif (unlikely(!smp_ops))\n\t\treturn 0;\n\n\tnmi_ipi_lock_start(&flags);\n\twhile (nmi_ipi_busy) {\n\t\tnmi_ipi_unlock_end(&flags);\n\t\tspin_until_cond(!nmi_ipi_busy);\n\t\tnmi_ipi_lock_start(&flags);\n\t}\n\tnmi_ipi_busy = true;\n\tnmi_ipi_function = fn;\n\n\tWARN_ON_ONCE(!cpumask_empty(&nmi_ipi_pending_mask));\n\n\tif (cpu < 0) {\n\t\t/* ALL_OTHERS */\n\t\tcpumask_copy(&nmi_ipi_pending_mask, cpu_online_mask);\n\t\tcpumask_clear_cpu(me, &nmi_ipi_pending_mask);\n\t} else {\n\t\tcpumask_set_cpu(cpu, &nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_unlock();\n\n\t/* Interrupts remain hard disabled */\n\n\tdo_smp_send_nmi_ipi(cpu, safe);\n\n\tnmi_ipi_lock();\n\t/* nmi_ipi_busy is set here, so unlock/lock is okay */\n\twhile (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\tnmi_ipi_unlock();\n\t\tudelay(1);\n\t\tnmi_ipi_lock();\n\t\tif (delay_us) {\n\t\t\tdelay_us--;\n\t\t\tif (!delay_us)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\t/* Timeout waiting for CPUs to call smp_handle_nmi_ipi */\n\t\tret = 0;\n\t\tcpumask_clear(&nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_function = NULL;\n\tnmi_ipi_busy = false;\n\n\tnmi_ipi_unlock_end(&flags);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic int __smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *),\n\t\t\t\tu64 delay_us, bool safe)\n{\n\tunsigned long flags;\n\tint me = raw_smp_processor_id();\n\tint ret = 1;\n\n\tBUG_ON(cpu == me);\n\tBUG_ON(cpu < 0 && cpu != NMI_IPI_ALL_OTHERS);\n\n\tif (unlikely(!smp_ops))\n\t\treturn 0;\n\n\tnmi_ipi_lock_start(&flags);\n\twhile (nmi_ipi_busy) {\n\t\tnmi_ipi_unlock_end(&flags);\n\t\tspin_until_cond(!nmi_ipi_busy);\n\t\tnmi_ipi_lock_start(&flags);\n\t}\n\tnmi_ipi_busy = true;\n\tnmi_ipi_function = fn;\n\n\tWARN_ON_ONCE(!cpumask_empty(&nmi_ipi_pending_mask));\n\n\tif (cpu < 0) {\n\t\t/* ALL_OTHERS */\n\t\tcpumask_copy(&nmi_ipi_pending_mask, cpu_online_mask);\n\t\tcpumask_clear_cpu(me, &nmi_ipi_pending_mask);\n\t} else {\n\t\tcpumask_set_cpu(cpu, &nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_unlock();\n\n\t/* Interrupts remain hard disabled */\n\n\tdo_smp_send_nmi_ipi(cpu, safe);\n\n\tnmi_ipi_lock();\n\t/* nmi_ipi_busy is set here, so unlock/lock is okay */\n\twhile (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\tnmi_ipi_unlock();\n\t\tudelay(1);\n\t\tnmi_ipi_lock();\n\t\tif (delay_us) {\n\t\t\tdelay_us--;\n\t\t\tif (!delay_us)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\t/* Timeout waiting for CPUs to call smp_handle_nmi_ipi */\n\t\tret = 0;\n\t\tcpumask_clear(&nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_function = NULL;\n\tnmi_ipi_busy = false;\n\n\tnmi_ipi_unlock_end(&flags);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *), u64 delay_us)\n{\n\treturn __smp_send_nmi_ipi(cpu, fn, delay_us, false);\n}"
  },
  {
    "function_name": "__smp_send_nmi_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "474-537",
    "snippet": "static int __smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *),\n\t\t\t\tu64 delay_us, bool safe)\n{\n\tunsigned long flags;\n\tint me = raw_smp_processor_id();\n\tint ret = 1;\n\n\tBUG_ON(cpu == me);\n\tBUG_ON(cpu < 0 && cpu != NMI_IPI_ALL_OTHERS);\n\n\tif (unlikely(!smp_ops))\n\t\treturn 0;\n\n\tnmi_ipi_lock_start(&flags);\n\twhile (nmi_ipi_busy) {\n\t\tnmi_ipi_unlock_end(&flags);\n\t\tspin_until_cond(!nmi_ipi_busy);\n\t\tnmi_ipi_lock_start(&flags);\n\t}\n\tnmi_ipi_busy = true;\n\tnmi_ipi_function = fn;\n\n\tWARN_ON_ONCE(!cpumask_empty(&nmi_ipi_pending_mask));\n\n\tif (cpu < 0) {\n\t\t/* ALL_OTHERS */\n\t\tcpumask_copy(&nmi_ipi_pending_mask, cpu_online_mask);\n\t\tcpumask_clear_cpu(me, &nmi_ipi_pending_mask);\n\t} else {\n\t\tcpumask_set_cpu(cpu, &nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_unlock();\n\n\t/* Interrupts remain hard disabled */\n\n\tdo_smp_send_nmi_ipi(cpu, safe);\n\n\tnmi_ipi_lock();\n\t/* nmi_ipi_busy is set here, so unlock/lock is okay */\n\twhile (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\tnmi_ipi_unlock();\n\t\tudelay(1);\n\t\tnmi_ipi_lock();\n\t\tif (delay_us) {\n\t\t\tdelay_us--;\n\t\t\tif (!delay_us)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\t/* Timeout waiting for CPUs to call smp_handle_nmi_ipi */\n\t\tret = 0;\n\t\tcpumask_clear(&nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_function = NULL;\n\tnmi_ipi_busy = false;\n\n\tnmi_ipi_unlock_end(&flags);\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nmi_ipi_unlock_end",
          "args": [
            "&flags"
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "nmi_ipi_unlock_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "414-418",
          "snippet": "static void nmi_ipi_unlock_end(unsigned long *flags)\n{\n\tnmi_ipi_unlock();\n\traw_local_irq_restore(*flags);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_unlock_end(unsigned long *flags)\n{\n\tnmi_ipi_unlock();\n\traw_local_irq_restore(*flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_clear",
          "args": [
            "&nmi_ipi_pending_mask"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "&nmi_ipi_pending_mask"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nmi_ipi_lock",
          "args": [],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "nmi_ipi_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "401-405",
          "snippet": "static void nmi_ipi_lock(void)\n{\n\twhile (atomic_cmpxchg(&__nmi_ipi_lock, 0, 1) == 1)\n\t\tspin_until_cond(atomic_read(&__nmi_ipi_lock) == 0);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_lock(void)\n{\n\twhile (atomic_cmpxchg(&__nmi_ipi_lock, 0, 1) == 1)\n\t\tspin_until_cond(atomic_read(&__nmi_ipi_lock) == 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "udelay",
          "args": [
            "1"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "udelay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "478-481",
          "snippet": "void udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned long tb_ticks_per_usec = 100;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_usec = 100;\n\nvoid udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nmi_ipi_unlock",
          "args": [],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "nmi_ipi_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "407-412",
          "snippet": "static void nmi_ipi_unlock(void)\n{\n\tsmp_mb();\n\tWARN_ON(atomic_read(&__nmi_ipi_lock) != 1);\n\tatomic_set(&__nmi_ipi_lock, 0);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_unlock(void)\n{\n\tsmp_mb();\n\tWARN_ON(atomic_read(&__nmi_ipi_lock) != 1);\n\tatomic_set(&__nmi_ipi_lock, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "&nmi_ipi_pending_mask"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_smp_send_nmi_ipi",
          "args": [
            "cpu",
            "safe"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "do_smp_send_nmi_ipi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "450-466",
          "snippet": "static void do_smp_send_nmi_ipi(int cpu, bool safe)\n{\n\tif (!safe && smp_ops->cause_nmi_ipi && smp_ops->cause_nmi_ipi(cpu))\n\t\treturn;\n\n\tif (cpu >= 0) {\n\t\tdo_message_pass(cpu, PPC_MSG_NMI_IPI);\n\t} else {\n\t\tint c;\n\n\t\tfor_each_online_cpu(c) {\n\t\t\tif (c == raw_smp_processor_id())\n\t\t\t\tcontinue;\n\t\t\tdo_message_pass(c, PPC_MSG_NMI_IPI);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic void do_smp_send_nmi_ipi(int cpu, bool safe)\n{\n\tif (!safe && smp_ops->cause_nmi_ipi && smp_ops->cause_nmi_ipi(cpu))\n\t\treturn;\n\n\tif (cpu >= 0) {\n\t\tdo_message_pass(cpu, PPC_MSG_NMI_IPI);\n\t} else {\n\t\tint c;\n\n\t\tfor_each_online_cpu(c) {\n\t\t\tif (c == raw_smp_processor_id())\n\t\t\t\tcontinue;\n\t\t\tdo_message_pass(c, PPC_MSG_NMI_IPI);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "&nmi_ipi_pending_mask"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "me",
            "&nmi_ipi_pending_mask"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_copy",
          "args": [
            "&nmi_ipi_pending_mask",
            "cpu_online_mask"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!cpumask_empty(&nmi_ipi_pending_mask)"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "&nmi_ipi_pending_mask"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nmi_ipi_lock_start",
          "args": [
            "&flags"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "nmi_ipi_lock_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "389-399",
          "snippet": "static void nmi_ipi_lock_start(unsigned long *flags)\n{\n\traw_local_irq_save(*flags);\n\thard_irq_disable();\n\twhile (atomic_cmpxchg(&__nmi_ipi_lock, 0, 1) == 1) {\n\t\traw_local_irq_restore(*flags);\n\t\tspin_until_cond(atomic_read(&__nmi_ipi_lock) == 0);\n\t\traw_local_irq_save(*flags);\n\t\thard_irq_disable();\n\t}\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_lock_start(unsigned long *flags)\n{\n\traw_local_irq_save(*flags);\n\thard_irq_disable();\n\twhile (atomic_cmpxchg(&__nmi_ipi_lock, 0, 1) == 1) {\n\t\traw_local_irq_restore(*flags);\n\t\tspin_until_cond(atomic_read(&__nmi_ipi_lock) == 0);\n\t\traw_local_irq_save(*flags);\n\t\thard_irq_disable();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_until_cond",
          "args": [
            "!nmi_ipi_busy"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!smp_ops"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "cpu < 0 && cpu != NMI_IPI_ALL_OTHERS"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "cpu == me"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_smp_processor_id",
          "args": [],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic int __smp_send_nmi_ipi(int cpu, void (*fn)(struct pt_regs *),\n\t\t\t\tu64 delay_us, bool safe)\n{\n\tunsigned long flags;\n\tint me = raw_smp_processor_id();\n\tint ret = 1;\n\n\tBUG_ON(cpu == me);\n\tBUG_ON(cpu < 0 && cpu != NMI_IPI_ALL_OTHERS);\n\n\tif (unlikely(!smp_ops))\n\t\treturn 0;\n\n\tnmi_ipi_lock_start(&flags);\n\twhile (nmi_ipi_busy) {\n\t\tnmi_ipi_unlock_end(&flags);\n\t\tspin_until_cond(!nmi_ipi_busy);\n\t\tnmi_ipi_lock_start(&flags);\n\t}\n\tnmi_ipi_busy = true;\n\tnmi_ipi_function = fn;\n\n\tWARN_ON_ONCE(!cpumask_empty(&nmi_ipi_pending_mask));\n\n\tif (cpu < 0) {\n\t\t/* ALL_OTHERS */\n\t\tcpumask_copy(&nmi_ipi_pending_mask, cpu_online_mask);\n\t\tcpumask_clear_cpu(me, &nmi_ipi_pending_mask);\n\t} else {\n\t\tcpumask_set_cpu(cpu, &nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_unlock();\n\n\t/* Interrupts remain hard disabled */\n\n\tdo_smp_send_nmi_ipi(cpu, safe);\n\n\tnmi_ipi_lock();\n\t/* nmi_ipi_busy is set here, so unlock/lock is okay */\n\twhile (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\tnmi_ipi_unlock();\n\t\tudelay(1);\n\t\tnmi_ipi_lock();\n\t\tif (delay_us) {\n\t\t\tdelay_us--;\n\t\t\tif (!delay_us)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!cpumask_empty(&nmi_ipi_pending_mask)) {\n\t\t/* Timeout waiting for CPUs to call smp_handle_nmi_ipi */\n\t\tret = 0;\n\t\tcpumask_clear(&nmi_ipi_pending_mask);\n\t}\n\n\tnmi_ipi_function = NULL;\n\tnmi_ipi_busy = false;\n\n\tnmi_ipi_unlock_end(&flags);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "do_smp_send_nmi_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "450-466",
    "snippet": "static void do_smp_send_nmi_ipi(int cpu, bool safe)\n{\n\tif (!safe && smp_ops->cause_nmi_ipi && smp_ops->cause_nmi_ipi(cpu))\n\t\treturn;\n\n\tif (cpu >= 0) {\n\t\tdo_message_pass(cpu, PPC_MSG_NMI_IPI);\n\t} else {\n\t\tint c;\n\n\t\tfor_each_online_cpu(c) {\n\t\t\tif (c == raw_smp_processor_id())\n\t\t\t\tcontinue;\n\t\t\tdo_message_pass(c, PPC_MSG_NMI_IPI);\n\t\t}\n\t}\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_message_pass",
          "args": [
            "c",
            "PPC_MSG_NMI_IPI"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "do_message_pass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "332-340",
          "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_smp_processor_id",
          "args": [],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_ops->cause_nmi_ipi",
          "args": [
            "cpu"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic void do_smp_send_nmi_ipi(int cpu, bool safe)\n{\n\tif (!safe && smp_ops->cause_nmi_ipi && smp_ops->cause_nmi_ipi(cpu))\n\t\treturn;\n\n\tif (cpu >= 0) {\n\t\tdo_message_pass(cpu, PPC_MSG_NMI_IPI);\n\t} else {\n\t\tint c;\n\n\t\tfor_each_online_cpu(c) {\n\t\t\tif (c == raw_smp_processor_id())\n\t\t\t\tcontinue;\n\t\t\tdo_message_pass(c, PPC_MSG_NMI_IPI);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "smp_handle_nmi_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "423-448",
    "snippet": "int smp_handle_nmi_ipi(struct pt_regs *regs)\n{\n\tvoid (*fn)(struct pt_regs *) = NULL;\n\tunsigned long flags;\n\tint me = raw_smp_processor_id();\n\tint ret = 0;\n\n\t/*\n\t * Unexpected NMIs are possible here because the interrupt may not\n\t * be able to distinguish NMI IPIs from other types of NMIs, or\n\t * because the caller may have timed out.\n\t */\n\tnmi_ipi_lock_start(&flags);\n\tif (cpumask_test_cpu(me, &nmi_ipi_pending_mask)) {\n\t\tcpumask_clear_cpu(me, &nmi_ipi_pending_mask);\n\t\tfn = READ_ONCE(nmi_ipi_function);\n\t\tWARN_ON_ONCE(!fn);\n\t\tret = 1;\n\t}\n\tnmi_ipi_unlock_end(&flags);\n\n\tif (fn)\n\t\tfn(regs);\n\n\treturn ret;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fn",
          "args": [
            "regs"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "watchdog_timer_fn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/watchdog.c",
          "lines": "296-311",
          "snippet": "static enum hrtimer_restart watchdog_timer_fn(struct hrtimer *hrtimer)\n{\n\tint cpu = smp_processor_id();\n\n\tif (!(watchdog_enabled & NMI_WATCHDOG_ENABLED))\n\t\treturn HRTIMER_NORESTART;\n\n\tif (!cpumask_test_cpu(cpu, &watchdog_cpumask))\n\t\treturn HRTIMER_NORESTART;\n\n\twatchdog_timer_interrupt(cpu);\n\n\thrtimer_forward_now(hrtimer, ms_to_ktime(wd_timer_period_ms));\n\n\treturn HRTIMER_RESTART;\n}",
          "includes": [
            "#include <asm/paca.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/slab.h>",
            "#include <linux/reboot.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/export.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/init.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u64 wd_timer_period_ms"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/paca.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/sched/debug.h>\n#include <linux/kdebug.h>\n#include <linux/slab.h>\n#include <linux/reboot.h>\n#include <linux/hardirq.h>\n#include <linux/kprobes.h>\n#include <linux/export.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/init.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n\nstatic u64 wd_timer_period_ms;\n\nstatic enum hrtimer_restart watchdog_timer_fn(struct hrtimer *hrtimer)\n{\n\tint cpu = smp_processor_id();\n\n\tif (!(watchdog_enabled & NMI_WATCHDOG_ENABLED))\n\t\treturn HRTIMER_NORESTART;\n\n\tif (!cpumask_test_cpu(cpu, &watchdog_cpumask))\n\t\treturn HRTIMER_NORESTART;\n\n\twatchdog_timer_interrupt(cpu);\n\n\thrtimer_forward_now(hrtimer, ms_to_ktime(wd_timer_period_ms));\n\n\treturn HRTIMER_RESTART;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nmi_ipi_unlock_end",
          "args": [
            "&flags"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "nmi_ipi_unlock_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "414-418",
          "snippet": "static void nmi_ipi_unlock_end(unsigned long *flags)\n{\n\tnmi_ipi_unlock();\n\traw_local_irq_restore(*flags);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_unlock_end(unsigned long *flags)\n{\n\tnmi_ipi_unlock();\n\traw_local_irq_restore(*flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!fn"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "nmi_ipi_function"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "me",
            "&nmi_ipi_pending_mask"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_test_cpu",
          "args": [
            "me",
            "&nmi_ipi_pending_mask"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nmi_ipi_lock_start",
          "args": [
            "&flags"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "nmi_ipi_lock_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "389-399",
          "snippet": "static void nmi_ipi_lock_start(unsigned long *flags)\n{\n\traw_local_irq_save(*flags);\n\thard_irq_disable();\n\twhile (atomic_cmpxchg(&__nmi_ipi_lock, 0, 1) == 1) {\n\t\traw_local_irq_restore(*flags);\n\t\tspin_until_cond(atomic_read(&__nmi_ipi_lock) == 0);\n\t\traw_local_irq_save(*flags);\n\t\thard_irq_disable();\n\t}\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_lock_start(unsigned long *flags)\n{\n\traw_local_irq_save(*flags);\n\thard_irq_disable();\n\twhile (atomic_cmpxchg(&__nmi_ipi_lock, 0, 1) == 1) {\n\t\traw_local_irq_restore(*flags);\n\t\tspin_until_cond(atomic_read(&__nmi_ipi_lock) == 0);\n\t\traw_local_irq_save(*flags);\n\t\thard_irq_disable();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_smp_processor_id",
          "args": [],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smp_handle_nmi_ipi(struct pt_regs *regs)\n{\n\tvoid (*fn)(struct pt_regs *) = NULL;\n\tunsigned long flags;\n\tint me = raw_smp_processor_id();\n\tint ret = 0;\n\n\t/*\n\t * Unexpected NMIs are possible here because the interrupt may not\n\t * be able to distinguish NMI IPIs from other types of NMIs, or\n\t * because the caller may have timed out.\n\t */\n\tnmi_ipi_lock_start(&flags);\n\tif (cpumask_test_cpu(me, &nmi_ipi_pending_mask)) {\n\t\tcpumask_clear_cpu(me, &nmi_ipi_pending_mask);\n\t\tfn = READ_ONCE(nmi_ipi_function);\n\t\tWARN_ON_ONCE(!fn);\n\t\tret = 1;\n\t}\n\tnmi_ipi_unlock_end(&flags);\n\n\tif (fn)\n\t\tfn(regs);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nmi_ipi_unlock_end",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "414-418",
    "snippet": "static void nmi_ipi_unlock_end(unsigned long *flags)\n{\n\tnmi_ipi_unlock();\n\traw_local_irq_restore(*flags);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_local_irq_restore",
          "args": [
            "*flags"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nmi_ipi_unlock",
          "args": [],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "nmi_ipi_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "407-412",
          "snippet": "static void nmi_ipi_unlock(void)\n{\n\tsmp_mb();\n\tWARN_ON(atomic_read(&__nmi_ipi_lock) != 1);\n\tatomic_set(&__nmi_ipi_lock, 0);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_unlock(void)\n{\n\tsmp_mb();\n\tWARN_ON(atomic_read(&__nmi_ipi_lock) != 1);\n\tatomic_set(&__nmi_ipi_lock, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_unlock_end(unsigned long *flags)\n{\n\tnmi_ipi_unlock();\n\traw_local_irq_restore(*flags);\n}"
  },
  {
    "function_name": "nmi_ipi_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "407-412",
    "snippet": "static void nmi_ipi_unlock(void)\n{\n\tsmp_mb();\n\tWARN_ON(atomic_read(&__nmi_ipi_lock) != 1);\n\tatomic_set(&__nmi_ipi_lock, 0);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&__nmi_ipi_lock",
            "0"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "atomic_read(&__nmi_ipi_lock) != 1"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&__nmi_ipi_lock"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_unlock(void)\n{\n\tsmp_mb();\n\tWARN_ON(atomic_read(&__nmi_ipi_lock) != 1);\n\tatomic_set(&__nmi_ipi_lock, 0);\n}"
  },
  {
    "function_name": "nmi_ipi_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "401-405",
    "snippet": "static void nmi_ipi_lock(void)\n{\n\twhile (atomic_cmpxchg(&__nmi_ipi_lock, 0, 1) == 1)\n\t\tspin_until_cond(atomic_read(&__nmi_ipi_lock) == 0);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_until_cond",
          "args": [
            "atomic_read(&__nmi_ipi_lock) == 0"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&__nmi_ipi_lock"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_cmpxchg",
          "args": [
            "&__nmi_ipi_lock",
            "0",
            "1"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_lock(void)\n{\n\twhile (atomic_cmpxchg(&__nmi_ipi_lock, 0, 1) == 1)\n\t\tspin_until_cond(atomic_read(&__nmi_ipi_lock) == 0);\n}"
  },
  {
    "function_name": "nmi_ipi_lock_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "389-399",
    "snippet": "static void nmi_ipi_lock_start(unsigned long *flags)\n{\n\traw_local_irq_save(*flags);\n\thard_irq_disable();\n\twhile (atomic_cmpxchg(&__nmi_ipi_lock, 0, 1) == 1) {\n\t\traw_local_irq_restore(*flags);\n\t\tspin_until_cond(atomic_read(&__nmi_ipi_lock) == 0);\n\t\traw_local_irq_save(*flags);\n\t\thard_irq_disable();\n\t}\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hard_irq_disable",
          "args": [],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_local_irq_save",
          "args": [
            "*flags"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_until_cond",
          "args": [
            "atomic_read(&__nmi_ipi_lock) == 0"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&__nmi_ipi_lock"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_local_irq_restore",
          "args": [
            "*flags"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_cmpxchg",
          "args": [
            "&__nmi_ipi_lock",
            "0",
            "1"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hard_irq_disable",
          "args": [],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_local_irq_save",
          "args": [
            "*flags"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic void nmi_ipi_lock_start(unsigned long *flags)\n{\n\traw_local_irq_save(*flags);\n\thard_irq_disable();\n\twhile (atomic_cmpxchg(&__nmi_ipi_lock, 0, 1) == 1) {\n\t\traw_local_irq_restore(*flags);\n\t\tspin_until_cond(atomic_read(&__nmi_ipi_lock) == 0);\n\t\traw_local_irq_save(*flags);\n\t\thard_irq_disable();\n\t}\n}"
  },
  {
    "function_name": "arch_send_call_function_ipi_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "354-360",
    "snippet": "void arch_send_call_function_ipi_mask(const struct cpumask *mask)\n{\n\tunsigned int cpu;\n\n\tfor_each_cpu(cpu, mask)\n\t\tdo_message_pass(cpu, PPC_MSG_CALL_FUNCTION);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_message_pass",
          "args": [
            "cpu",
            "PPC_MSG_CALL_FUNCTION"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "do_message_pass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "332-340",
          "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "cpu",
            "mask"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid arch_send_call_function_ipi_mask(const struct cpumask *mask)\n{\n\tunsigned int cpu;\n\n\tfor_each_cpu(cpu, mask)\n\t\tdo_message_pass(cpu, PPC_MSG_CALL_FUNCTION);\n}"
  },
  {
    "function_name": "arch_send_call_function_single_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "349-352",
    "snippet": "void arch_send_call_function_single_ipi(int cpu)\n{\n\tdo_message_pass(cpu, PPC_MSG_CALL_FUNCTION);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_message_pass",
          "args": [
            "cpu",
            "PPC_MSG_CALL_FUNCTION"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "do_message_pass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "332-340",
          "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid arch_send_call_function_single_ipi(int cpu)\n{\n\tdo_message_pass(cpu, PPC_MSG_CALL_FUNCTION);\n}"
  },
  {
    "function_name": "smp_send_reschedule",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "342-346",
    "snippet": "void smp_send_reschedule(int cpu)\n{\n\tif (likely(smp_ops))\n\t\tdo_message_pass(cpu, PPC_MSG_RESCHEDULE);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_message_pass",
          "args": [
            "cpu",
            "PPC_MSG_RESCHEDULE"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "do_message_pass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "332-340",
          "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "smp_ops"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid smp_send_reschedule(int cpu)\n{\n\tif (likely(smp_ops))\n\t\tdo_message_pass(cpu, PPC_MSG_RESCHEDULE);\n}"
  },
  {
    "function_name": "do_message_pass",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "332-340",
    "snippet": "static inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_ops->message_pass",
          "args": [
            "cpu",
            "msg"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nstatic inline void do_message_pass(int cpu, int msg)\n{\n\tif (smp_ops->message_pass)\n\t\tsmp_ops->message_pass(cpu, msg);\n#ifdef CONFIG_PPC_SMP_MUXED_IPI\n\telse\n\t\tsmp_muxed_ipi_message_pass(cpu, msg);\n#endif\n}"
  },
  {
    "function_name": "smp_ipi_demux_relaxed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "295-329",
    "snippet": "irqreturn_t smp_ipi_demux_relaxed(void)\n{\n\tstruct cpu_messages *info;\n\tunsigned long all;\n\n\tinfo = this_cpu_ptr(&ipi_message);\n\tdo {\n\t\tall = xchg(&info->messages, 0);\n#if defined(CONFIG_KVM_XICS) && defined(CONFIG_KVM_BOOK3S_HV_POSSIBLE)\n\t\t/*\n\t\t * Must check for PPC_MSG_RM_HOST_ACTION messages\n\t\t * before PPC_MSG_CALL_FUNCTION messages because when\n\t\t * a VM is destroyed, we call kick_all_cpus_sync()\n\t\t * to ensure that any pending PPC_MSG_RM_HOST_ACTION\n\t\t * messages have completed before we free any VCPUs.\n\t\t */\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RM_HOST_ACTION))\n\t\t\tkvmppc_xics_ipi_action();\n#endif\n\t\tif (all & IPI_MESSAGE(PPC_MSG_CALL_FUNCTION))\n\t\t\tgeneric_smp_call_function_interrupt();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RESCHEDULE))\n\t\t\tscheduler_ipi();\n#ifdef CONFIG_GENERIC_CLOCKEVENTS_BROADCAST\n\t\tif (all & IPI_MESSAGE(PPC_MSG_TICK_BROADCAST))\n\t\t\ttimer_broadcast_interrupt();\n#endif\n#ifdef CONFIG_NMI_IPI\n\t\tif (all & IPI_MESSAGE(PPC_MSG_NMI_IPI))\n\t\t\tnmi_ipi_action(0, NULL);\n#endif\n\t} while (info->messages);\n\n\treturn IRQ_HANDLED;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nmi_ipi_action",
          "args": [
            "0",
            "NULL"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "nmi_ipi_action",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "197-201",
          "snippet": "static irqreturn_t nmi_ipi_action(int irq, void *data)\n{\n\tsmp_handle_nmi_ipi(get_irq_regs());\n\treturn IRQ_HANDLED;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irqreturn_t nmi_ipi_action(int irq, void *data)\n{\n\tsmp_handle_nmi_ipi(get_irq_regs());\n\treturn IRQ_HANDLED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IPI_MESSAGE",
          "args": [
            "PPC_MSG_NMI_IPI"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timer_broadcast_interrupt",
          "args": [],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "timer_broadcast_interrupt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "640-647",
          "snippet": "void timer_broadcast_interrupt(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = ~(u64)0;\n\ttick_receive_broadcast();\n\t__this_cpu_inc(irq_stat.broadcast_irqs_event);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid timer_broadcast_interrupt(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = ~(u64)0;\n\ttick_receive_broadcast();\n\t__this_cpu_inc(irq_stat.broadcast_irqs_event);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IPI_MESSAGE",
          "args": [
            "PPC_MSG_TICK_BROADCAST"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scheduler_ipi",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IPI_MESSAGE",
          "args": [
            "PPC_MSG_RESCHEDULE"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generic_smp_call_function_interrupt",
          "args": [],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IPI_MESSAGE",
          "args": [
            "PPC_MSG_CALL_FUNCTION"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvmppc_xics_ipi_action",
          "args": [],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IPI_MESSAGE",
          "args": [
            "PPC_MSG_RM_HOST_ACTION"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xchg",
          "args": [
            "&info->messages",
            "0"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&ipi_message"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nirqreturn_t smp_ipi_demux_relaxed(void)\n{\n\tstruct cpu_messages *info;\n\tunsigned long all;\n\n\tinfo = this_cpu_ptr(&ipi_message);\n\tdo {\n\t\tall = xchg(&info->messages, 0);\n#if defined(CONFIG_KVM_XICS) && defined(CONFIG_KVM_BOOK3S_HV_POSSIBLE)\n\t\t/*\n\t\t * Must check for PPC_MSG_RM_HOST_ACTION messages\n\t\t * before PPC_MSG_CALL_FUNCTION messages because when\n\t\t * a VM is destroyed, we call kick_all_cpus_sync()\n\t\t * to ensure that any pending PPC_MSG_RM_HOST_ACTION\n\t\t * messages have completed before we free any VCPUs.\n\t\t */\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RM_HOST_ACTION))\n\t\t\tkvmppc_xics_ipi_action();\n#endif\n\t\tif (all & IPI_MESSAGE(PPC_MSG_CALL_FUNCTION))\n\t\t\tgeneric_smp_call_function_interrupt();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RESCHEDULE))\n\t\t\tscheduler_ipi();\n#ifdef CONFIG_GENERIC_CLOCKEVENTS_BROADCAST\n\t\tif (all & IPI_MESSAGE(PPC_MSG_TICK_BROADCAST))\n\t\t\ttimer_broadcast_interrupt();\n#endif\n#ifdef CONFIG_NMI_IPI\n\t\tif (all & IPI_MESSAGE(PPC_MSG_NMI_IPI))\n\t\t\tnmi_ipi_action(0, NULL);\n#endif\n\t} while (info->messages);\n\n\treturn IRQ_HANDLED;\n}"
  },
  {
    "function_name": "smp_ipi_demux",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "287-292",
    "snippet": "irqreturn_t smp_ipi_demux(void)\n{\n\tmb();\t/* order any irq clear */\n\n\treturn smp_ipi_demux_relaxed();\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_ipi_demux_relaxed",
          "args": [],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "smp_ipi_demux_relaxed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "295-329",
          "snippet": "irqreturn_t smp_ipi_demux_relaxed(void)\n{\n\tstruct cpu_messages *info;\n\tunsigned long all;\n\n\tinfo = this_cpu_ptr(&ipi_message);\n\tdo {\n\t\tall = xchg(&info->messages, 0);\n#if defined(CONFIG_KVM_XICS) && defined(CONFIG_KVM_BOOK3S_HV_POSSIBLE)\n\t\t/*\n\t\t * Must check for PPC_MSG_RM_HOST_ACTION messages\n\t\t * before PPC_MSG_CALL_FUNCTION messages because when\n\t\t * a VM is destroyed, we call kick_all_cpus_sync()\n\t\t * to ensure that any pending PPC_MSG_RM_HOST_ACTION\n\t\t * messages have completed before we free any VCPUs.\n\t\t */\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RM_HOST_ACTION))\n\t\t\tkvmppc_xics_ipi_action();\n#endif\n\t\tif (all & IPI_MESSAGE(PPC_MSG_CALL_FUNCTION))\n\t\t\tgeneric_smp_call_function_interrupt();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RESCHEDULE))\n\t\t\tscheduler_ipi();\n#ifdef CONFIG_GENERIC_CLOCKEVENTS_BROADCAST\n\t\tif (all & IPI_MESSAGE(PPC_MSG_TICK_BROADCAST))\n\t\t\ttimer_broadcast_interrupt();\n#endif\n#ifdef CONFIG_NMI_IPI\n\t\tif (all & IPI_MESSAGE(PPC_MSG_NMI_IPI))\n\t\t\tnmi_ipi_action(0, NULL);\n#endif\n\t} while (info->messages);\n\n\treturn IRQ_HANDLED;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nirqreturn_t smp_ipi_demux_relaxed(void)\n{\n\tstruct cpu_messages *info;\n\tunsigned long all;\n\n\tinfo = this_cpu_ptr(&ipi_message);\n\tdo {\n\t\tall = xchg(&info->messages, 0);\n#if defined(CONFIG_KVM_XICS) && defined(CONFIG_KVM_BOOK3S_HV_POSSIBLE)\n\t\t/*\n\t\t * Must check for PPC_MSG_RM_HOST_ACTION messages\n\t\t * before PPC_MSG_CALL_FUNCTION messages because when\n\t\t * a VM is destroyed, we call kick_all_cpus_sync()\n\t\t * to ensure that any pending PPC_MSG_RM_HOST_ACTION\n\t\t * messages have completed before we free any VCPUs.\n\t\t */\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RM_HOST_ACTION))\n\t\t\tkvmppc_xics_ipi_action();\n#endif\n\t\tif (all & IPI_MESSAGE(PPC_MSG_CALL_FUNCTION))\n\t\t\tgeneric_smp_call_function_interrupt();\n\t\tif (all & IPI_MESSAGE(PPC_MSG_RESCHEDULE))\n\t\t\tscheduler_ipi();\n#ifdef CONFIG_GENERIC_CLOCKEVENTS_BROADCAST\n\t\tif (all & IPI_MESSAGE(PPC_MSG_TICK_BROADCAST))\n\t\t\ttimer_broadcast_interrupt();\n#endif\n#ifdef CONFIG_NMI_IPI\n\t\tif (all & IPI_MESSAGE(PPC_MSG_NMI_IPI))\n\t\t\tnmi_ipi_action(0, NULL);\n#endif\n\t} while (info->messages);\n\n\treturn IRQ_HANDLED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nirqreturn_t smp_ipi_demux(void)\n{\n\tmb();\t/* order any irq clear */\n\n\treturn smp_ipi_demux_relaxed();\n}"
  },
  {
    "function_name": "smp_muxed_ipi_message_pass",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "270-279",
    "snippet": "void smp_muxed_ipi_message_pass(int cpu, int msg)\n{\n\tsmp_muxed_ipi_set_message(cpu, msg);\n\n\t/*\n\t * cause_ipi functions are required to include a full barrier\n\t * before doing whatever causes the IPI.\n\t */\n\tsmp_ops->cause_ipi(cpu);\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct smp_ops_t *smp_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_ops->cause_ipi",
          "args": [
            "cpu"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_muxed_ipi_set_message",
          "args": [
            "cpu",
            "msg"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "smp_muxed_ipi_set_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "258-268",
          "snippet": "void smp_muxed_ipi_set_message(int cpu, int msg)\n{\n\tstruct cpu_messages *info = &per_cpu(ipi_message, cpu);\n\tchar *message = (char *)&info->messages;\n\n\t/*\n\t * Order previous accesses before accesses in the IPI handler.\n\t */\n\tsmp_mb();\n\tmessage[msg] = 1;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_muxed_ipi_set_message(int cpu, int msg)\n{\n\tstruct cpu_messages *info = &per_cpu(ipi_message, cpu);\n\tchar *message = (char *)&info->messages;\n\n\t/*\n\t * Order previous accesses before accesses in the IPI handler.\n\t */\n\tsmp_mb();\n\tmessage[msg] = 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid smp_muxed_ipi_message_pass(int cpu, int msg)\n{\n\tsmp_muxed_ipi_set_message(cpu, msg);\n\n\t/*\n\t * cause_ipi functions are required to include a full barrier\n\t * before doing whatever causes the IPI.\n\t */\n\tsmp_ops->cause_ipi(cpu);\n}"
  },
  {
    "function_name": "smp_muxed_ipi_set_message",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "258-268",
    "snippet": "void smp_muxed_ipi_set_message(int cpu, int msg)\n{\n\tstruct cpu_messages *info = &per_cpu(ipi_message, cpu);\n\tchar *message = (char *)&info->messages;\n\n\t/*\n\t * Order previous accesses before accesses in the IPI handler.\n\t */\n\tsmp_mb();\n\tmessage[msg] = 1;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "ipi_message",
            "cpu"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid smp_muxed_ipi_set_message(int cpu, int msg)\n{\n\tstruct cpu_messages *info = &per_cpu(ipi_message, cpu);\n\tchar *message = (char *)&info->messages;\n\n\t/*\n\t * Order previous accesses before accesses in the IPI handler.\n\t */\n\tsmp_mb();\n\tmessage[msg] = 1;\n}"
  },
  {
    "function_name": "smp_request_message_ipi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "232-250",
    "snippet": "int smp_request_message_ipi(int virq, int msg)\n{\n\tint err;\n\n\tif (msg < 0 || msg > PPC_MSG_NMI_IPI)\n\t\treturn -EINVAL;\n#ifndef CONFIG_NMI_IPI\n\tif (msg == PPC_MSG_NMI_IPI)\n\t\treturn 1;\n#endif\n\n\terr = request_irq(virq, smp_ipi_action[msg],\n\t\t\t  IRQF_PERCPU | IRQF_NO_THREAD | IRQF_NO_SUSPEND,\n\t\t\t  smp_ipi_name[msg], NULL);\n\tWARN(err < 0, \"unable to request_irq %d for %s (rc %d)\\n\",\n\t\tvirq, smp_ipi_name[msg], err);\n\n\treturn err;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static irq_handler_t smp_ipi_action[] = {\n\t[PPC_MSG_CALL_FUNCTION] =  call_function_action,\n\t[PPC_MSG_RESCHEDULE] = reschedule_action,\n#ifdef CONFIG_GENERIC_CLOCKEVENTS_BROADCAST\n\t[PPC_MSG_TICK_BROADCAST] = tick_broadcast_ipi_action,\n#endif\n#ifdef CONFIG_NMI_IPI\n\t[PPC_MSG_NMI_IPI] = nmi_ipi_action,\n#endif\n};",
      "const char *smp_ipi_name[] = {\n\t[PPC_MSG_CALL_FUNCTION] =  \"ipi call function\",\n\t[PPC_MSG_RESCHEDULE] = \"ipi reschedule\",\n#ifdef CONFIG_GENERIC_CLOCKEVENTS_BROADCAST\n\t[PPC_MSG_TICK_BROADCAST] = \"ipi tick-broadcast\",\n#endif\n#ifdef CONFIG_NMI_IPI\n\t[PPC_MSG_NMI_IPI] = \"nmi ipi\",\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "err < 0",
            "\"unable to request_irq %d for %s (rc %d)\\n\"",
            "virq",
            "smp_ipi_name[msg]",
            "err"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request_irq",
          "args": [
            "virq",
            "smp_ipi_action[msg]",
            "IRQF_PERCPU | IRQF_NO_THREAD | IRQF_NO_SUSPEND",
            "smp_ipi_name[msg]",
            "NULL"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irq_handler_t smp_ipi_action[] = {\n\t[PPC_MSG_CALL_FUNCTION] =  call_function_action,\n\t[PPC_MSG_RESCHEDULE] = reschedule_action,\n#ifdef CONFIG_GENERIC_CLOCKEVENTS_BROADCAST\n\t[PPC_MSG_TICK_BROADCAST] = tick_broadcast_ipi_action,\n#endif\n#ifdef CONFIG_NMI_IPI\n\t[PPC_MSG_NMI_IPI] = nmi_ipi_action,\n#endif\n};\nconst char *smp_ipi_name[] = {\n\t[PPC_MSG_CALL_FUNCTION] =  \"ipi call function\",\n\t[PPC_MSG_RESCHEDULE] = \"ipi reschedule\",\n#ifdef CONFIG_GENERIC_CLOCKEVENTS_BROADCAST\n\t[PPC_MSG_TICK_BROADCAST] = \"ipi tick-broadcast\",\n#endif\n#ifdef CONFIG_NMI_IPI\n\t[PPC_MSG_NMI_IPI] = \"nmi ipi\",\n#endif\n};\n\nint smp_request_message_ipi(int virq, int msg)\n{\n\tint err;\n\n\tif (msg < 0 || msg > PPC_MSG_NMI_IPI)\n\t\treturn -EINVAL;\n#ifndef CONFIG_NMI_IPI\n\tif (msg == PPC_MSG_NMI_IPI)\n\t\treturn 1;\n#endif\n\n\terr = request_irq(virq, smp_ipi_action[msg],\n\t\t\t  IRQF_PERCPU | IRQF_NO_THREAD | IRQF_NO_SUSPEND,\n\t\t\t  smp_ipi_name[msg], NULL);\n\tWARN(err < 0, \"unable to request_irq %d for %s (rc %d)\\n\",\n\t\tvirq, smp_ipi_name[msg], err);\n\n\treturn err;\n}"
  },
  {
    "function_name": "nmi_ipi_action",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "197-201",
    "snippet": "static irqreturn_t nmi_ipi_action(int irq, void *data)\n{\n\tsmp_handle_nmi_ipi(get_irq_regs());\n\treturn IRQ_HANDLED;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_handle_nmi_ipi",
          "args": [
            "get_irq_regs()"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "smp_handle_nmi_ipi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "423-448",
          "snippet": "int smp_handle_nmi_ipi(struct pt_regs *regs)\n{\n\tvoid (*fn)(struct pt_regs *) = NULL;\n\tunsigned long flags;\n\tint me = raw_smp_processor_id();\n\tint ret = 0;\n\n\t/*\n\t * Unexpected NMIs are possible here because the interrupt may not\n\t * be able to distinguish NMI IPIs from other types of NMIs, or\n\t * because the caller may have timed out.\n\t */\n\tnmi_ipi_lock_start(&flags);\n\tif (cpumask_test_cpu(me, &nmi_ipi_pending_mask)) {\n\t\tcpumask_clear_cpu(me, &nmi_ipi_pending_mask);\n\t\tfn = READ_ONCE(nmi_ipi_function);\n\t\tWARN_ON_ONCE(!fn);\n\t\tret = 1;\n\t}\n\tnmi_ipi_unlock_end(&flags);\n\n\tif (fn)\n\t\tfn(regs);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smp_handle_nmi_ipi(struct pt_regs *regs)\n{\n\tvoid (*fn)(struct pt_regs *) = NULL;\n\tunsigned long flags;\n\tint me = raw_smp_processor_id();\n\tint ret = 0;\n\n\t/*\n\t * Unexpected NMIs are possible here because the interrupt may not\n\t * be able to distinguish NMI IPIs from other types of NMIs, or\n\t * because the caller may have timed out.\n\t */\n\tnmi_ipi_lock_start(&flags);\n\tif (cpumask_test_cpu(me, &nmi_ipi_pending_mask)) {\n\t\tcpumask_clear_cpu(me, &nmi_ipi_pending_mask);\n\t\tfn = READ_ONCE(nmi_ipi_function);\n\t\tWARN_ON_ONCE(!fn);\n\t\tret = 1;\n\t}\n\tnmi_ipi_unlock_end(&flags);\n\n\tif (fn)\n\t\tfn(regs);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_irq_regs",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irqreturn_t nmi_ipi_action(int irq, void *data)\n{\n\tsmp_handle_nmi_ipi(get_irq_regs());\n\treturn IRQ_HANDLED;\n}"
  },
  {
    "function_name": "tick_broadcast_ipi_action",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "189-193",
    "snippet": "static irqreturn_t tick_broadcast_ipi_action(int irq, void *data)\n{\n\ttimer_broadcast_interrupt();\n\treturn IRQ_HANDLED;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "timer_broadcast_interrupt",
          "args": [],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "timer_broadcast_interrupt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "640-647",
          "snippet": "void timer_broadcast_interrupt(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = ~(u64)0;\n\ttick_receive_broadcast();\n\t__this_cpu_inc(irq_stat.broadcast_irqs_event);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nvoid timer_broadcast_interrupt(void)\n{\n\tu64 *next_tb = this_cpu_ptr(&decrementers_next_tb);\n\n\t*next_tb = ~(u64)0;\n\ttick_receive_broadcast();\n\t__this_cpu_inc(irq_stat.broadcast_irqs_event);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irqreturn_t tick_broadcast_ipi_action(int irq, void *data)\n{\n\ttimer_broadcast_interrupt();\n\treturn IRQ_HANDLED;\n}"
  },
  {
    "function_name": "reschedule_action",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "182-186",
    "snippet": "static irqreturn_t reschedule_action(int irq, void *data)\n{\n\tscheduler_ipi();\n\treturn IRQ_HANDLED;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scheduler_ipi",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irqreturn_t reschedule_action(int irq, void *data)\n{\n\tscheduler_ipi();\n\treturn IRQ_HANDLED;\n}"
  },
  {
    "function_name": "call_function_action",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "176-180",
    "snippet": "static irqreturn_t call_function_action(int irq, void *data)\n{\n\tgeneric_smp_call_function_interrupt();\n\treturn IRQ_HANDLED;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "generic_smp_call_function_interrupt",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic irqreturn_t call_function_action(int irq, void *data)\n{\n\tgeneric_smp_call_function_interrupt();\n\treturn IRQ_HANDLED;\n}"
  },
  {
    "function_name": "smp_generic_kick_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "146-173",
    "snippet": "int smp_generic_kick_cpu(int nr)\n{\n\tif (nr < 0 || nr >= nr_cpu_ids)\n\t\treturn -EINVAL;\n\n\t/*\n\t * The processor is currently spinning, waiting for the\n\t * cpu_start field to become non-zero After we set cpu_start,\n\t * the processor will continue on to secondary_start\n\t */\n\tif (!paca_ptrs[nr]->cpu_start) {\n\t\tpaca_ptrs[nr]->cpu_start = 1;\n\t\tsmp_mb();\n\t\treturn 0;\n\t}\n\n#ifdef CONFIG_HOTPLUG_CPU\n\t/*\n\t * Ok it's not there, so it might be soft-unplugged, let's\n\t * try to bring it back\n\t */\n\tgeneric_set_cpu_up(nr);\n\tsmp_wmb();\n\tsmp_send_reschedule(nr);\n#endif /* CONFIG_HOTPLUG_CPU */\n\n\treturn 0;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_send_reschedule",
          "args": [
            "nr"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "smp_send_reschedule",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "342-346",
          "snippet": "void smp_send_reschedule(int cpu)\n{\n\tif (likely(smp_ops))\n\t\tdo_message_pass(cpu, PPC_MSG_RESCHEDULE);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct smp_ops_t *smp_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstruct smp_ops_t *smp_ops;\n\nvoid smp_send_reschedule(int cpu)\n{\n\tif (likely(smp_ops))\n\t\tdo_message_pass(cpu, PPC_MSG_RESCHEDULE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_wmb",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generic_set_cpu_up",
          "args": [
            "nr"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "generic_set_cpu_up",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
          "lines": "1067-1070",
          "snippet": "void generic_set_cpu_up(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_UP_PREPARE;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/kup.h>",
            "#include <asm/ftrace.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/kexec.h>",
            "#include <asm/debug.h>",
            "#include <asm/vdso.h>",
            "#include <asm/paca.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/mpic.h>",
            "#include <asm/cputable.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/machdep.h>",
            "#include <asm/time.h>",
            "#include <asm/smp.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/dbell.h>",
            "#include <asm/kvm_ppc.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/irq.h>",
            "#include <linux/atomic.h>",
            "#include <asm/ptrace.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/stackprotector.h>",
            "#include <linux/random.h>",
            "#include <linux/processor.h>",
            "#include <linux/profile.h>",
            "#include <linux/topology.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/device.h>",
            "#include <linux/err.h>",
            "#include <linux/cache.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/delay.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nvoid generic_set_cpu_up(unsigned int cpu)\n{\n\tper_cpu(cpu_state, cpu) = CPU_UP_PREPARE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smp_generic_kick_cpu(int nr)\n{\n\tif (nr < 0 || nr >= nr_cpu_ids)\n\t\treturn -EINVAL;\n\n\t/*\n\t * The processor is currently spinning, waiting for the\n\t * cpu_start field to become non-zero After we set cpu_start,\n\t * the processor will continue on to secondary_start\n\t */\n\tif (!paca_ptrs[nr]->cpu_start) {\n\t\tpaca_ptrs[nr]->cpu_start = 1;\n\t\tsmp_mb();\n\t\treturn 0;\n\t}\n\n#ifdef CONFIG_HOTPLUG_CPU\n\t/*\n\t * Ok it's not there, so it might be soft-unplugged, let's\n\t * try to bring it back\n\t */\n\tgeneric_set_cpu_up(nr);\n\tsmp_wmb();\n\tsmp_send_reschedule(nr);\n#endif /* CONFIG_HOTPLUG_CPU */\n\n\treturn 0;\n}"
  },
  {
    "function_name": "smp_generic_cpu_bootable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/smp.c",
    "lines": "128-142",
    "snippet": "int smp_generic_cpu_bootable(unsigned int nr)\n{\n\t/* Special case - we inhibit secondary thread startup\n\t * during boot if the user requests it.\n\t */\n\tif (system_state < SYSTEM_RUNNING && cpu_has_feature(CPU_FTR_SMT)) {\n\t\tif (!smt_enabled_at_boot && cpu_thread_in_core(nr) != 0)\n\t\t\treturn 0;\n\t\tif (smt_enabled_at_boot\n\t\t    && cpu_thread_in_core(nr) >= smt_enabled_at_boot)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include <asm/udbg.h>",
      "#include <asm/kup.h>",
      "#include <asm/ftrace.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/kexec.h>",
      "#include <asm/debug.h>",
      "#include <asm/vdso.h>",
      "#include <asm/paca.h>",
      "#include <asm/vdso_datapage.h>",
      "#include <asm/mpic.h>",
      "#include <asm/cputable.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/machdep.h>",
      "#include <asm/time.h>",
      "#include <asm/smp.h>",
      "#include <asm/prom.h>",
      "#include <asm/page.h>",
      "#include <asm/dbell.h>",
      "#include <asm/kvm_ppc.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/irq.h>",
      "#include <linux/atomic.h>",
      "#include <asm/ptrace.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/stackprotector.h>",
      "#include <linux/random.h>",
      "#include <linux/processor.h>",
      "#include <linux/profile.h>",
      "#include <linux/topology.h>",
      "#include <linux/notifier.h>",
      "#include <linux/cpu.h>",
      "#include <linux/device.h>",
      "#include <linux/err.h>",
      "#include <linux/cache.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/init.h>",
      "#include <linux/delay.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched/topology.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int smt_enabled_at_boot = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_thread_in_core",
          "args": [
            "nr"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_thread_in_core",
          "args": [
            "nr"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_SMT"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/kup.h>\n#include <asm/ftrace.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/asm-prototypes.h>\n#include <asm/kexec.h>\n#include <asm/debug.h>\n#include <asm/vdso.h>\n#include <asm/paca.h>\n#include <asm/vdso_datapage.h>\n#include <asm/mpic.h>\n#include <asm/cputable.h>\n#include <asm/cputhreads.h>\n#include <asm/machdep.h>\n#include <asm/time.h>\n#include <asm/smp.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/dbell.h>\n#include <asm/kvm_ppc.h>\n#include <asm/hw_irq.h>\n#include <asm/irq.h>\n#include <linux/atomic.h>\n#include <asm/ptrace.h>\n#include <linux/pgtable.h>\n#include <linux/stackprotector.h>\n#include <linux/random.h>\n#include <linux/processor.h>\n#include <linux/profile.h>\n#include <linux/topology.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/device.h>\n#include <linux/err.h>\n#include <linux/cache.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint smt_enabled_at_boot = 1;\n\nint smp_generic_cpu_bootable(unsigned int nr)\n{\n\t/* Special case - we inhibit secondary thread startup\n\t * during boot if the user requests it.\n\t */\n\tif (system_state < SYSTEM_RUNNING && cpu_has_feature(CPU_FTR_SMT)) {\n\t\tif (!smt_enabled_at_boot && cpu_thread_in_core(nr) != 0)\n\t\t\treturn 0;\n\t\tif (smt_enabled_at_boot\n\t\t    && cpu_thread_in_core(nr) >= smt_enabled_at_boot)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  }
]