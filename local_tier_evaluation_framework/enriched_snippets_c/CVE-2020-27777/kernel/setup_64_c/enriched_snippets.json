[
  {
    "function_name": "rfi_flush_debugfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "1078-1082",
    "snippet": "static __init int rfi_flush_debugfs_init(void)\n{\n\tdebugfs_create_file(\"rfi_flush\", 0600, powerpc_debugfs_root, NULL, &fops_rfi_flush);\n\treturn 0;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "\"rfi_flush\"",
            "0600",
            "powerpc_debugfs_root",
            "NULL",
            "&fops_rfi_flush"
          ],
          "line": 1080
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic __init int rfi_flush_debugfs_init(void)\n{\n\tdebugfs_create_file(\"rfi_flush\", 0600, powerpc_debugfs_root, NULL, &fops_rfi_flush);\n\treturn 0;\n}"
  },
  {
    "function_name": "rfi_flush_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "1070-1074",
    "snippet": "static int rfi_flush_get(void *data, u64 *val)\n{\n\t*val = rfi_flush ? 1 : 0;\n\treturn 0;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic int rfi_flush_get(void *data, u64 *val)\n{\n\t*val = rfi_flush ? 1 : 0;\n\treturn 0;\n}"
  },
  {
    "function_name": "rfi_flush_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "1052-1068",
    "snippet": "static int rfi_flush_set(void *data, u64 val)\n{\n\tbool enable;\n\n\tif (val == 1)\n\t\tenable = true;\n\telse if (val == 0)\n\t\tenable = false;\n\telse\n\t\treturn -EINVAL;\n\n\t/* Only do anything if we're changing state */\n\tif (enable != rfi_flush)\n\t\trfi_flush_enable(enable);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rfi_flush_enable",
          "args": [
            "enable"
          ],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "rfi_flush_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "978-987",
          "snippet": "void rfi_flush_enable(bool enable)\n{\n\tif (enable) {\n\t\tdo_rfi_flush_fixups(enabled_flush_types);\n\t\ton_each_cpu(do_nothing, NULL, 1);\n\t} else\n\t\tdo_rfi_flush_fixups(L1D_FLUSH_NONE);\n\n\trfi_flush = enable;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid rfi_flush_enable(bool enable)\n{\n\tif (enable) {\n\t\tdo_rfi_flush_fixups(enabled_flush_types);\n\t\ton_each_cpu(do_nothing, NULL, 1);\n\t} else\n\t\tdo_rfi_flush_fixups(L1D_FLUSH_NONE);\n\n\trfi_flush = enable;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic int rfi_flush_set(void *data, u64 val)\n{\n\tbool enable;\n\n\tif (val == 1)\n\t\tenable = true;\n\telse if (val == 0)\n\t\tenable = false;\n\telse\n\t\treturn -EINVAL;\n\n\t/* Only do anything if we're changing state */\n\tif (enable != rfi_flush)\n\t\trfi_flush_enable(enable);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "setup_rfi_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "1032-1049",
    "snippet": "void setup_rfi_flush(enum l1d_flush_type types, bool enable)\n{\n\tif (types & L1D_FLUSH_FALLBACK) {\n\t\tpr_info(\"rfi-flush: fallback displacement flush available\\n\");\n\t\tinit_fallback_flush();\n\t}\n\n\tif (types & L1D_FLUSH_ORI)\n\t\tpr_info(\"rfi-flush: ori type flush available\\n\");\n\n\tif (types & L1D_FLUSH_MTTRIG)\n\t\tpr_info(\"rfi-flush: mttrig type flush available\\n\");\n\n\tenabled_flush_types = types;\n\n\tif (!no_rfi_flush && !cpu_mitigations_off())\n\t\trfi_flush_enable(enable);\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rfi_flush_enable",
          "args": [
            "enable"
          ],
          "line": 1048
        },
        "resolved": true,
        "details": {
          "function_name": "rfi_flush_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "978-987",
          "snippet": "void rfi_flush_enable(bool enable)\n{\n\tif (enable) {\n\t\tdo_rfi_flush_fixups(enabled_flush_types);\n\t\ton_each_cpu(do_nothing, NULL, 1);\n\t} else\n\t\tdo_rfi_flush_fixups(L1D_FLUSH_NONE);\n\n\trfi_flush = enable;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid rfi_flush_enable(bool enable)\n{\n\tif (enable) {\n\t\tdo_rfi_flush_fixups(enabled_flush_types);\n\t\ton_each_cpu(do_nothing, NULL, 1);\n\t} else\n\t\tdo_rfi_flush_fixups(L1D_FLUSH_NONE);\n\n\trfi_flush = enable;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_mitigations_off",
          "args": [],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"rfi-flush: mttrig type flush available\\n\""
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"rfi-flush: ori type flush available\\n\""
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_fallback_flush",
          "args": [],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "init_fallback_flush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "989-1030",
          "snippet": "static void __ref init_fallback_flush(void)\n{\n\tu64 l1d_size, limit;\n\tint cpu;\n\n\t/* Only allocate the fallback flush area once (at boot time). */\n\tif (l1d_flush_fallback_area)\n\t\treturn;\n\n\tl1d_size = ppc64_caches.l1d.size;\n\n\t/*\n\t * If there is no d-cache-size property in the device tree, l1d_size\n\t * could be zero. That leads to the loop in the asm wrapping around to\n\t * 2^64-1, and then walking off the end of the fallback area and\n\t * eventually causing a page fault which is fatal. Just default to\n\t * something vaguely sane.\n\t */\n\tif (!l1d_size)\n\t\tl1d_size = (64 * 1024);\n\n\tlimit = min(ppc64_bolted_size(), ppc64_rma_size);\n\n\t/*\n\t * Align to L1d size, and size it at 2x L1d size, to catch possible\n\t * hardware prefetch runoff. We don't have a recipe for load patterns to\n\t * reliably avoid the prefetcher.\n\t */\n\tl1d_flush_fallback_area = memblock_alloc_try_nid(l1d_size * 2,\n\t\t\t\t\t\tl1d_size, MEMBLOCK_LOW_LIMIT,\n\t\t\t\t\t\tlimit, NUMA_NO_NODE);\n\tif (!l1d_flush_fallback_area)\n\t\tpanic(\"%s: Failed to allocate %llu bytes align=0x%llx max_addr=%pa\\n\",\n\t\t      __func__, l1d_size * 2, l1d_size, &limit);\n\n\n\tfor_each_possible_cpu(cpu) {\n\t\tstruct paca_struct *paca = paca_ptrs[cpu];\n\t\tpaca->rfi_flush_fallback_area = l1d_flush_fallback_area;\n\t\tpaca->l1d_flush_size = l1d_size;\n\t}\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct ppc64_caches ppc64_caches = {\n\t.l1d = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6,\n\t},\n\t.l1i = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct ppc64_caches ppc64_caches = {\n\t.l1d = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6,\n\t},\n\t.l1i = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6\n\t},\n};\n\nstatic void __ref init_fallback_flush(void)\n{\n\tu64 l1d_size, limit;\n\tint cpu;\n\n\t/* Only allocate the fallback flush area once (at boot time). */\n\tif (l1d_flush_fallback_area)\n\t\treturn;\n\n\tl1d_size = ppc64_caches.l1d.size;\n\n\t/*\n\t * If there is no d-cache-size property in the device tree, l1d_size\n\t * could be zero. That leads to the loop in the asm wrapping around to\n\t * 2^64-1, and then walking off the end of the fallback area and\n\t * eventually causing a page fault which is fatal. Just default to\n\t * something vaguely sane.\n\t */\n\tif (!l1d_size)\n\t\tl1d_size = (64 * 1024);\n\n\tlimit = min(ppc64_bolted_size(), ppc64_rma_size);\n\n\t/*\n\t * Align to L1d size, and size it at 2x L1d size, to catch possible\n\t * hardware prefetch runoff. We don't have a recipe for load patterns to\n\t * reliably avoid the prefetcher.\n\t */\n\tl1d_flush_fallback_area = memblock_alloc_try_nid(l1d_size * 2,\n\t\t\t\t\t\tl1d_size, MEMBLOCK_LOW_LIMIT,\n\t\t\t\t\t\tlimit, NUMA_NO_NODE);\n\tif (!l1d_flush_fallback_area)\n\t\tpanic(\"%s: Failed to allocate %llu bytes align=0x%llx max_addr=%pa\\n\",\n\t\t      __func__, l1d_size * 2, l1d_size, &limit);\n\n\n\tfor_each_possible_cpu(cpu) {\n\t\tstruct paca_struct *paca = paca_ptrs[cpu];\n\t\tpaca->rfi_flush_fallback_area = l1d_flush_fallback_area;\n\t\tpaca->l1d_flush_size = l1d_size;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"rfi-flush: fallback displacement flush available\\n\""
          ],
          "line": 1035
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid setup_rfi_flush(enum l1d_flush_type types, bool enable)\n{\n\tif (types & L1D_FLUSH_FALLBACK) {\n\t\tpr_info(\"rfi-flush: fallback displacement flush available\\n\");\n\t\tinit_fallback_flush();\n\t}\n\n\tif (types & L1D_FLUSH_ORI)\n\t\tpr_info(\"rfi-flush: ori type flush available\\n\");\n\n\tif (types & L1D_FLUSH_MTTRIG)\n\t\tpr_info(\"rfi-flush: mttrig type flush available\\n\");\n\n\tenabled_flush_types = types;\n\n\tif (!no_rfi_flush && !cpu_mitigations_off())\n\t\trfi_flush_enable(enable);\n}"
  },
  {
    "function_name": "init_fallback_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "989-1030",
    "snippet": "static void __ref init_fallback_flush(void)\n{\n\tu64 l1d_size, limit;\n\tint cpu;\n\n\t/* Only allocate the fallback flush area once (at boot time). */\n\tif (l1d_flush_fallback_area)\n\t\treturn;\n\n\tl1d_size = ppc64_caches.l1d.size;\n\n\t/*\n\t * If there is no d-cache-size property in the device tree, l1d_size\n\t * could be zero. That leads to the loop in the asm wrapping around to\n\t * 2^64-1, and then walking off the end of the fallback area and\n\t * eventually causing a page fault which is fatal. Just default to\n\t * something vaguely sane.\n\t */\n\tif (!l1d_size)\n\t\tl1d_size = (64 * 1024);\n\n\tlimit = min(ppc64_bolted_size(), ppc64_rma_size);\n\n\t/*\n\t * Align to L1d size, and size it at 2x L1d size, to catch possible\n\t * hardware prefetch runoff. We don't have a recipe for load patterns to\n\t * reliably avoid the prefetcher.\n\t */\n\tl1d_flush_fallback_area = memblock_alloc_try_nid(l1d_size * 2,\n\t\t\t\t\t\tl1d_size, MEMBLOCK_LOW_LIMIT,\n\t\t\t\t\t\tlimit, NUMA_NO_NODE);\n\tif (!l1d_flush_fallback_area)\n\t\tpanic(\"%s: Failed to allocate %llu bytes align=0x%llx max_addr=%pa\\n\",\n\t\t      __func__, l1d_size * 2, l1d_size, &limit);\n\n\n\tfor_each_possible_cpu(cpu) {\n\t\tstruct paca_struct *paca = paca_ptrs[cpu];\n\t\tpaca->rfi_flush_fallback_area = l1d_flush_fallback_area;\n\t\tpaca->l1d_flush_size = l1d_size;\n\t}\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ppc64_caches ppc64_caches = {\n\t.l1d = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6,\n\t},\n\t.l1i = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6\n\t},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"%s: Failed to allocate %llu bytes align=0x%llx max_addr=%pa\\n\"",
            "__func__",
            "l1d_size * 2",
            "l1d_size",
            "&limit"
          ],
          "line": 1021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc_try_nid",
          "args": [
            "l1d_size * 2",
            "l1d_size",
            "MEMBLOCK_LOW_LIMIT",
            "limit",
            "NUMA_NO_NODE"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "ppc64_bolted_size()",
            "ppc64_rma_size"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc64_bolted_size",
          "args": [],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "ppc64_bolted_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "633-652",
          "snippet": "__init u64 ppc64_bolted_size(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\t/* XXX: BookE ppc64_rma_limit setup seems to disagree? */\n\tif (early_mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS radix, does not take faults on linear mapping */\n\tif (early_radix_enabled())\n\t\treturn ULONG_MAX;\n\n\t/* BookS hash, the first segment is bolted */\n\tif (early_mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\n__init u64 ppc64_bolted_size(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\t/* XXX: BookE ppc64_rma_limit setup seems to disagree? */\n\tif (early_mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS radix, does not take faults on linear mapping */\n\tif (early_radix_enabled())\n\t\treturn ULONG_MAX;\n\n\t/* BookS hash, the first segment is bolted */\n\tif (early_mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct ppc64_caches ppc64_caches = {\n\t.l1d = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6,\n\t},\n\t.l1i = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6\n\t},\n};\n\nstatic void __ref init_fallback_flush(void)\n{\n\tu64 l1d_size, limit;\n\tint cpu;\n\n\t/* Only allocate the fallback flush area once (at boot time). */\n\tif (l1d_flush_fallback_area)\n\t\treturn;\n\n\tl1d_size = ppc64_caches.l1d.size;\n\n\t/*\n\t * If there is no d-cache-size property in the device tree, l1d_size\n\t * could be zero. That leads to the loop in the asm wrapping around to\n\t * 2^64-1, and then walking off the end of the fallback area and\n\t * eventually causing a page fault which is fatal. Just default to\n\t * something vaguely sane.\n\t */\n\tif (!l1d_size)\n\t\tl1d_size = (64 * 1024);\n\n\tlimit = min(ppc64_bolted_size(), ppc64_rma_size);\n\n\t/*\n\t * Align to L1d size, and size it at 2x L1d size, to catch possible\n\t * hardware prefetch runoff. We don't have a recipe for load patterns to\n\t * reliably avoid the prefetcher.\n\t */\n\tl1d_flush_fallback_area = memblock_alloc_try_nid(l1d_size * 2,\n\t\t\t\t\t\tl1d_size, MEMBLOCK_LOW_LIMIT,\n\t\t\t\t\t\tlimit, NUMA_NO_NODE);\n\tif (!l1d_flush_fallback_area)\n\t\tpanic(\"%s: Failed to allocate %llu bytes align=0x%llx max_addr=%pa\\n\",\n\t\t      __func__, l1d_size * 2, l1d_size, &limit);\n\n\n\tfor_each_possible_cpu(cpu) {\n\t\tstruct paca_struct *paca = paca_ptrs[cpu];\n\t\tpaca->rfi_flush_fallback_area = l1d_flush_fallback_area;\n\t\tpaca->l1d_flush_size = l1d_size;\n\t}\n}"
  },
  {
    "function_name": "rfi_flush_enable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "978-987",
    "snippet": "void rfi_flush_enable(bool enable)\n{\n\tif (enable) {\n\t\tdo_rfi_flush_fixups(enabled_flush_types);\n\t\ton_each_cpu(do_nothing, NULL, 1);\n\t} else\n\t\tdo_rfi_flush_fixups(L1D_FLUSH_NONE);\n\n\trfi_flush = enable;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_rfi_flush_fixups",
          "args": [
            "L1D_FLUSH_NONE"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "on_each_cpu",
          "args": [
            "do_nothing",
            "NULL",
            "1"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_rfi_flush_fixups",
          "args": [
            "enabled_flush_types"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid rfi_flush_enable(bool enable)\n{\n\tif (enable) {\n\t\tdo_rfi_flush_fixups(enabled_flush_types);\n\t\ton_each_cpu(do_nothing, NULL, 1);\n\t} else\n\t\tdo_rfi_flush_fixups(L1D_FLUSH_NONE);\n\n\trfi_flush = enable;\n}"
  },
  {
    "function_name": "do_nothing",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "970-976",
    "snippet": "static void do_nothing(void *unused)\n{\n\t/*\n\t * We don't need to do the flush explicitly, just enter+exit kernel is\n\t * sufficient, the RFI exit handlers will do the right thing.\n\t */\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void do_nothing(void *unused)\n{\n\t/*\n\t * We don't need to do the flush explicitly, just enter+exit kernel is\n\t * sufficient, the RFI exit handlers will do the right thing.\n\t */\n}"
  },
  {
    "function_name": "handle_no_pti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "962-967",
    "snippet": "static int __init handle_no_pti(char *p)\n{\n\tpr_info(\"rfi-flush: disabling due to 'nopti' on command line.\\n\");\n\thandle_no_rfi_flush(NULL);\n\treturn 0;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "handle_no_rfi_flush",
          "args": [
            "NULL"
          ],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "handle_no_rfi_flush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "950-955",
          "snippet": "static int __init handle_no_rfi_flush(char *p)\n{\n\tpr_info(\"rfi-flush: disabled on command line.\");\n\tno_rfi_flush = true;\n\treturn 0;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic int __init handle_no_rfi_flush(char *p)\n{\n\tpr_info(\"rfi-flush: disabled on command line.\");\n\tno_rfi_flush = true;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"rfi-flush: disabling due to 'nopti' on command line.\\n\""
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic int __init handle_no_pti(char *p)\n{\n\tpr_info(\"rfi-flush: disabling due to 'nopti' on command line.\\n\");\n\thandle_no_rfi_flush(NULL);\n\treturn 0;\n}"
  },
  {
    "function_name": "handle_no_rfi_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "950-955",
    "snippet": "static int __init handle_no_rfi_flush(char *p)\n{\n\tpr_info(\"rfi-flush: disabled on command line.\");\n\tno_rfi_flush = true;\n\treturn 0;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"rfi-flush: disabled on command line.\""
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic int __init handle_no_rfi_flush(char *p)\n{\n\tpr_info(\"rfi-flush: disabled on command line.\");\n\tno_rfi_flush = true;\n\treturn 0;\n}"
  },
  {
    "function_name": "disable_hardlockup_detector",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "931-941",
    "snippet": "static int __init disable_hardlockup_detector(void)\n{\n#ifdef CONFIG_HARDLOCKUP_DETECTOR_PERF\n\thardlockup_detector_disable();\n#else\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\thardlockup_detector_disable();\n#endif\n\n\treturn 0;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hardlockup_detector_disable",
          "args": [],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hardlockup_detector_disable",
          "args": [],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic int __init disable_hardlockup_detector(void)\n{\n#ifdef CONFIG_HARDLOCKUP_DETECTOR_PERF\n\thardlockup_detector_disable();\n#else\n\tif (firmware_has_feature(FW_FEATURE_LPAR))\n\t\thardlockup_detector_disable();\n#endif\n\n\treturn 0;\n}"
  },
  {
    "function_name": "hw_nmi_get_sample_period",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "917-920",
    "snippet": "u64 hw_nmi_get_sample_period(int watchdog_thresh)\n{\n\treturn ppc_proc_freq * watchdog_thresh;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nu64 hw_nmi_get_sample_period(int watchdog_thresh)\n{\n\treturn ppc_proc_freq * watchdog_thresh;\n}"
  },
  {
    "function_name": "memory_block_size_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "902-908",
    "snippet": "unsigned long memory_block_size_bytes(void)\n{\n\tif (ppc_md.memory_block_size)\n\t\treturn ppc_md.memory_block_size();\n\n\treturn MIN_MEMORY_BLOCK_SIZE;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.memory_block_size",
          "args": [],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nunsigned long memory_block_size_bytes(void)\n{\n\tif (ppc_md.memory_block_size)\n\t\treturn ppc_md.memory_block_size();\n\n\treturn MIN_MEMORY_BLOCK_SIZE;\n}"
  },
  {
    "function_name": "setup_per_cpu_areas",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "860-898",
    "snippet": "void __init setup_per_cpu_areas(void)\n{\n\tconst size_t dyn_size = PERCPU_MODULE_RESERVE + PERCPU_DYNAMIC_RESERVE;\n\tsize_t atom_size;\n\tunsigned long delta;\n\tunsigned int cpu;\n\tint rc = -EINVAL;\n\n\t/*\n\t * Linear mapping is one of 4K, 1M and 16M.  For 4K, no need\n\t * to group units.  For larger mappings, use 1M atom which\n\t * should be large enough to contain a number of units.\n\t */\n\tif (mmu_linear_psize == MMU_PAGE_4K)\n\t\tatom_size = PAGE_SIZE;\n\telse\n\t\tatom_size = 1 << 20;\n\n\tif (pcpu_chosen_fc != PCPU_FC_PAGE) {\n\t\trc = pcpu_embed_first_chunk(0, dyn_size, atom_size, pcpu_cpu_distance,\n\t\t\t\t\t    pcpu_alloc_bootmem, pcpu_free_bootmem);\n\t\tif (rc)\n\t\t\tpr_warn(\"PERCPU: %s allocator failed (%d), \"\n\t\t\t\t\"falling back to page size\\n\",\n\t\t\t\tpcpu_fc_names[pcpu_chosen_fc], rc);\n\t}\n\n\tif (rc < 0)\n\t\trc = pcpu_page_first_chunk(0, pcpu_alloc_bootmem, pcpu_free_bootmem,\n\t\t\t\t\t   pcpu_populate_pte);\n\tif (rc < 0)\n\t\tpanic(\"cannot initialize percpu area (err=%d)\", rc);\n\n\tdelta = (unsigned long)pcpu_base_addr - (unsigned long)__per_cpu_start;\n\tfor_each_possible_cpu(cpu) {\n                __per_cpu_offset[cpu] = delta + pcpu_unit_offsets[cpu];\n\t\tpaca_ptrs[cpu]->data_offset = __per_cpu_offset[cpu];\n\t}\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"cannot initialize percpu area (err=%d)\"",
            "rc"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "watchdog_smp_panic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/watchdog.c",
          "lines": "147-199",
          "snippet": "static void watchdog_smp_panic(int cpu, u64 tb)\n{\n\tunsigned long flags;\n\tint c;\n\n\twd_smp_lock(&flags);\n\t/* Double check some things under lock */\n\tif ((s64)(tb - wd_smp_last_reset_tb) < (s64)wd_smp_panic_timeout_tb)\n\t\tgoto out;\n\tif (cpumask_test_cpu(cpu, &wd_smp_cpus_pending))\n\t\tgoto out;\n\tif (cpumask_weight(&wd_smp_cpus_pending) == 0)\n\t\tgoto out;\n\n\tpr_emerg(\"CPU %d detected hard LOCKUP on other CPUs %*pbl\\n\",\n\t\t cpu, cpumask_pr_args(&wd_smp_cpus_pending));\n\tpr_emerg(\"CPU %d TB:%lld, last SMP heartbeat TB:%lld (%lldms ago)\\n\",\n\t\t cpu, tb, wd_smp_last_reset_tb,\n\t\t tb_to_ns(tb - wd_smp_last_reset_tb) / 1000000);\n\n\tif (!sysctl_hardlockup_all_cpu_backtrace) {\n\t\t/*\n\t\t * Try to trigger the stuck CPUs, unless we are going to\n\t\t * get a backtrace on all of them anyway.\n\t\t */\n\t\tfor_each_cpu(c, &wd_smp_cpus_pending) {\n\t\t\tif (c == cpu)\n\t\t\t\tcontinue;\n\t\t\tsmp_send_nmi_ipi(c, wd_lockup_ipi, 1000000);\n\t\t}\n\t}\n\n\t/* Take the stuck CPUs out of the watch group */\n\tset_cpumask_stuck(&wd_smp_cpus_pending, tb);\n\n\twd_smp_unlock(&flags);\n\n\tprintk_safe_flush();\n\t/*\n\t * printk_safe_flush() seems to require another print\n\t * before anything actually goes out to console.\n\t */\n\tif (sysctl_hardlockup_all_cpu_backtrace)\n\t\ttrigger_allbutself_cpu_backtrace();\n\n\tif (hardlockup_panic)\n\t\tnmi_panic(NULL, \"Hard LOCKUP\");\n\n\treturn;\n\nout:\n\twd_smp_unlock(&flags);\n}",
          "includes": [
            "#include <asm/paca.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/slab.h>",
            "#include <linux/reboot.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/export.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/init.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u64 wd_smp_panic_timeout_tb",
            "static cpumask_t wd_smp_cpus_pending;",
            "static u64 wd_smp_last_reset_tb;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/paca.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/sched/debug.h>\n#include <linux/kdebug.h>\n#include <linux/slab.h>\n#include <linux/reboot.h>\n#include <linux/hardirq.h>\n#include <linux/kprobes.h>\n#include <linux/export.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/init.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n\nstatic u64 wd_smp_panic_timeout_tb;\nstatic cpumask_t wd_smp_cpus_pending;\nstatic u64 wd_smp_last_reset_tb;\n\nstatic void watchdog_smp_panic(int cpu, u64 tb)\n{\n\tunsigned long flags;\n\tint c;\n\n\twd_smp_lock(&flags);\n\t/* Double check some things under lock */\n\tif ((s64)(tb - wd_smp_last_reset_tb) < (s64)wd_smp_panic_timeout_tb)\n\t\tgoto out;\n\tif (cpumask_test_cpu(cpu, &wd_smp_cpus_pending))\n\t\tgoto out;\n\tif (cpumask_weight(&wd_smp_cpus_pending) == 0)\n\t\tgoto out;\n\n\tpr_emerg(\"CPU %d detected hard LOCKUP on other CPUs %*pbl\\n\",\n\t\t cpu, cpumask_pr_args(&wd_smp_cpus_pending));\n\tpr_emerg(\"CPU %d TB:%lld, last SMP heartbeat TB:%lld (%lldms ago)\\n\",\n\t\t cpu, tb, wd_smp_last_reset_tb,\n\t\t tb_to_ns(tb - wd_smp_last_reset_tb) / 1000000);\n\n\tif (!sysctl_hardlockup_all_cpu_backtrace) {\n\t\t/*\n\t\t * Try to trigger the stuck CPUs, unless we are going to\n\t\t * get a backtrace on all of them anyway.\n\t\t */\n\t\tfor_each_cpu(c, &wd_smp_cpus_pending) {\n\t\t\tif (c == cpu)\n\t\t\t\tcontinue;\n\t\t\tsmp_send_nmi_ipi(c, wd_lockup_ipi, 1000000);\n\t\t}\n\t}\n\n\t/* Take the stuck CPUs out of the watch group */\n\tset_cpumask_stuck(&wd_smp_cpus_pending, tb);\n\n\twd_smp_unlock(&flags);\n\n\tprintk_safe_flush();\n\t/*\n\t * printk_safe_flush() seems to require another print\n\t * before anything actually goes out to console.\n\t */\n\tif (sysctl_hardlockup_all_cpu_backtrace)\n\t\ttrigger_allbutself_cpu_backtrace();\n\n\tif (hardlockup_panic)\n\t\tnmi_panic(NULL, \"Hard LOCKUP\");\n\n\treturn;\n\nout:\n\twd_smp_unlock(&flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pcpu_page_first_chunk",
          "args": [
            "0",
            "pcpu_alloc_bootmem",
            "pcpu_free_bootmem",
            "pcpu_populate_pte"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"PERCPU: %s allocator failed (%d), \"\n\t\t\t\t\"falling back to page size\\n\"",
            "pcpu_fc_names[pcpu_chosen_fc]",
            "rc"
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pcpu_embed_first_chunk",
          "args": [
            "0",
            "dyn_size",
            "atom_size",
            "pcpu_cpu_distance",
            "pcpu_alloc_bootmem",
            "pcpu_free_bootmem"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init setup_per_cpu_areas(void)\n{\n\tconst size_t dyn_size = PERCPU_MODULE_RESERVE + PERCPU_DYNAMIC_RESERVE;\n\tsize_t atom_size;\n\tunsigned long delta;\n\tunsigned int cpu;\n\tint rc = -EINVAL;\n\n\t/*\n\t * Linear mapping is one of 4K, 1M and 16M.  For 4K, no need\n\t * to group units.  For larger mappings, use 1M atom which\n\t * should be large enough to contain a number of units.\n\t */\n\tif (mmu_linear_psize == MMU_PAGE_4K)\n\t\tatom_size = PAGE_SIZE;\n\telse\n\t\tatom_size = 1 << 20;\n\n\tif (pcpu_chosen_fc != PCPU_FC_PAGE) {\n\t\trc = pcpu_embed_first_chunk(0, dyn_size, atom_size, pcpu_cpu_distance,\n\t\t\t\t\t    pcpu_alloc_bootmem, pcpu_free_bootmem);\n\t\tif (rc)\n\t\t\tpr_warn(\"PERCPU: %s allocator failed (%d), \"\n\t\t\t\t\"falling back to page size\\n\",\n\t\t\t\tpcpu_fc_names[pcpu_chosen_fc], rc);\n\t}\n\n\tif (rc < 0)\n\t\trc = pcpu_page_first_chunk(0, pcpu_alloc_bootmem, pcpu_free_bootmem,\n\t\t\t\t\t   pcpu_populate_pte);\n\tif (rc < 0)\n\t\tpanic(\"cannot initialize percpu area (err=%d)\", rc);\n\n\tdelta = (unsigned long)pcpu_base_addr - (unsigned long)__per_cpu_start;\n\tfor_each_possible_cpu(cpu) {\n                __per_cpu_offset[cpu] = delta + pcpu_unit_offsets[cpu];\n\t\tpaca_ptrs[cpu]->data_offset = __per_cpu_offset[cpu];\n\t}\n}"
  },
  {
    "function_name": "pcpu_populate_pte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "815-857",
    "snippet": "static void __init pcpu_populate_pte(unsigned long addr)\n{\n\tpgd_t *pgd = pgd_offset_k(addr);\n\tp4d_t *p4d;\n\tpud_t *pud;\n\tpmd_t *pmd;\n\n\tp4d = p4d_offset(pgd, addr);\n\tif (p4d_none(*p4d)) {\n\t\tpud_t *new;\n\n\t\tnew = memblock_alloc(PUD_TABLE_SIZE, PUD_TABLE_SIZE);\n\t\tif (!new)\n\t\t\tgoto err_alloc;\n\t\tp4d_populate(&init_mm, p4d, new);\n\t}\n\n\tpud = pud_offset(p4d, addr);\n\tif (pud_none(*pud)) {\n\t\tpmd_t *new;\n\n\t\tnew = memblock_alloc(PMD_TABLE_SIZE, PMD_TABLE_SIZE);\n\t\tif (!new)\n\t\t\tgoto err_alloc;\n\t\tpud_populate(&init_mm, pud, new);\n\t}\n\n\tpmd = pmd_offset(pud, addr);\n\tif (!pmd_present(*pmd)) {\n\t\tpte_t *new;\n\n\t\tnew = memblock_alloc(PTE_TABLE_SIZE, PTE_TABLE_SIZE);\n\t\tif (!new)\n\t\t\tgoto err_alloc;\n\t\tpmd_populate_kernel(&init_mm, pmd, new);\n\t}\n\n\treturn;\n\nerr_alloc:\n\tpanic(\"%s: Failed to allocate %lu bytes align=%lx from=%lx\\n\",\n\t      __func__, PAGE_SIZE, PAGE_SIZE, PAGE_SIZE);\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"%s: Failed to allocate %lu bytes align=%lx from=%lx\\n\"",
            "__func__",
            "PAGE_SIZE",
            "PAGE_SIZE",
            "PAGE_SIZE"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_populate_kernel",
          "args": [
            "&init_mm",
            "pmd",
            "new"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "PTE_TABLE_SIZE",
            "PTE_TABLE_SIZE"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_present",
          "args": [
            "*pmd"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_offset",
          "args": [
            "pud",
            "addr"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_populate",
          "args": [
            "&init_mm",
            "pud",
            "new"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "PMD_TABLE_SIZE",
            "PMD_TABLE_SIZE"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_none",
          "args": [
            "*pud"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_offset",
          "args": [
            "p4d",
            "addr"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_populate",
          "args": [
            "&init_mm",
            "p4d",
            "new"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "PUD_TABLE_SIZE",
            "PUD_TABLE_SIZE"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_none",
          "args": [
            "*p4d"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_offset",
          "args": [
            "pgd",
            "addr"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_offset_k",
          "args": [
            "addr"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void __init pcpu_populate_pte(unsigned long addr)\n{\n\tpgd_t *pgd = pgd_offset_k(addr);\n\tp4d_t *p4d;\n\tpud_t *pud;\n\tpmd_t *pmd;\n\n\tp4d = p4d_offset(pgd, addr);\n\tif (p4d_none(*p4d)) {\n\t\tpud_t *new;\n\n\t\tnew = memblock_alloc(PUD_TABLE_SIZE, PUD_TABLE_SIZE);\n\t\tif (!new)\n\t\t\tgoto err_alloc;\n\t\tp4d_populate(&init_mm, p4d, new);\n\t}\n\n\tpud = pud_offset(p4d, addr);\n\tif (pud_none(*pud)) {\n\t\tpmd_t *new;\n\n\t\tnew = memblock_alloc(PMD_TABLE_SIZE, PMD_TABLE_SIZE);\n\t\tif (!new)\n\t\t\tgoto err_alloc;\n\t\tpud_populate(&init_mm, pud, new);\n\t}\n\n\tpmd = pmd_offset(pud, addr);\n\tif (!pmd_present(*pmd)) {\n\t\tpte_t *new;\n\n\t\tnew = memblock_alloc(PTE_TABLE_SIZE, PTE_TABLE_SIZE);\n\t\tif (!new)\n\t\t\tgoto err_alloc;\n\t\tpmd_populate_kernel(&init_mm, pmd, new);\n\t}\n\n\treturn;\n\nerr_alloc:\n\tpanic(\"%s: Failed to allocate %lu bytes align=%lx from=%lx\\n\",\n\t      __func__, PAGE_SIZE, PAGE_SIZE, PAGE_SIZE);\n}"
  },
  {
    "function_name": "pcpu_cpu_distance",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "804-810",
    "snippet": "static int pcpu_cpu_distance(unsigned int from, unsigned int to)\n{\n\tif (early_cpu_to_node(from) == early_cpu_to_node(to))\n\t\treturn LOCAL_DISTANCE;\n\telse\n\t\treturn REMOTE_DISTANCE;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "early_cpu_to_node",
          "args": [
            "to"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_cpu_to_node",
          "args": [
            "from"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic int pcpu_cpu_distance(unsigned int from, unsigned int to)\n{\n\tif (early_cpu_to_node(from) == early_cpu_to_node(to))\n\t\treturn LOCAL_DISTANCE;\n\telse\n\t\treturn REMOTE_DISTANCE;\n}"
  },
  {
    "function_name": "pcpu_free_bootmem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "799-802",
    "snippet": "static void __init pcpu_free_bootmem(void *ptr, size_t size)\n{\n\tmemblock_free(__pa(ptr), size);\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memblock_free",
          "args": [
            "__pa(ptr)",
            "size"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "ptr"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "__parse_fpscr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/traps.c",
          "lines": "1164-1189",
          "snippet": "static inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/nmi.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/kprobes.h>",
            "#include <sysdev/fsl_pci.h>",
            "#include <asm/hmi.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rio.h>",
            "#include <asm/ppc-opcode.h>",
            "#include <asm/kexec.h>",
            "#include <asm/tm.h>",
            "#include <asm/processor.h>",
            "#include <asm/firmware.h>",
            "#include <asm/backlight.h>",
            "#include <asm/reg.h>",
            "#include <asm/pmc.h>",
            "#include <asm/rtas.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/emulated_ops.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/console.h>",
            "#include <linux/smp.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/bug.h>",
            "#include <linux/backlight.h>",
            "#include <linux/kexec.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/delay.h>",
            "#include <linux/prctl.h>",
            "#include <linux/module.h>\t/* print_modules */",
            "#include <linux/extable.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/user.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/nmi.h>\n#include <asm/stacktrace.h>\n#include <asm/kprobes.h>\n#include <sysdev/fsl_pci.h>\n#include <asm/hmi.h>\n#include <asm/asm-prototypes.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/fadump.h>\n#include <asm/rio.h>\n#include <asm/ppc-opcode.h>\n#include <asm/kexec.h>\n#include <asm/tm.h>\n#include <asm/processor.h>\n#include <asm/firmware.h>\n#include <asm/backlight.h>\n#include <asm/reg.h>\n#include <asm/pmc.h>\n#include <asm/rtas.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/uaccess.h>\n#include <asm/emulated_ops.h>\n#include <linux/kmsg_dump.h>\n#include <linux/console.h>\n#include <linux/smp.h>\n#include <linux/context_tracking.h>\n#include <linux/ratelimit.h>\n#include <linux/kdebug.h>\n#include <linux/bug.h>\n#include <linux/backlight.h>\n#include <linux/kexec.h>\n#include <linux/kprobes.h>\n#include <linux/delay.h>\n#include <linux/prctl.h>\n#include <linux/module.h>\t/* print_modules */\n#include <linux/extable.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/user.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/pkeys.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void __init pcpu_free_bootmem(void *ptr, size_t size)\n{\n\tmemblock_free(__pa(ptr), size);\n}"
  },
  {
    "function_name": "pcpu_alloc_bootmem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "773-797",
    "snippet": "static void * __init pcpu_alloc_bootmem(unsigned int cpu, size_t size,\n\t\t\t\t\tsize_t align)\n{\n\tconst unsigned long goal = __pa(MAX_DMA_ADDRESS);\n#ifdef CONFIG_NEED_MULTIPLE_NODES\n\tint node = early_cpu_to_node(cpu);\n\tvoid *ptr;\n\n\tif (!node_online(node) || !NODE_DATA(node)) {\n\t\tptr = memblock_alloc_from(size, align, goal);\n\t\tpr_info(\"cpu %d has no node %d or node-local memory\\n\",\n\t\t\tcpu, node);\n\t\tpr_debug(\"per cpu data for cpu%d %lu bytes at %016lx\\n\",\n\t\t\t cpu, size, __pa(ptr));\n\t} else {\n\t\tptr = memblock_alloc_try_nid(size, align, goal,\n\t\t\t\t\t     MEMBLOCK_ALLOC_ACCESSIBLE, node);\n\t\tpr_debug(\"per cpu data for cpu%d %lu bytes on node%d at \"\n\t\t\t \"%016lx\\n\", cpu, size, node, __pa(ptr));\n\t}\n\treturn ptr;\n#else\n\treturn memblock_alloc_from(size, align, goal);\n#endif\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memblock_alloc_from",
          "args": [
            "size",
            "align",
            "goal"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"per cpu data for cpu%d %lu bytes on node%d at \"\n\t\t\t \"%016lx\\n\"",
            "cpu",
            "size",
            "node",
            "__pa(ptr)"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "ptr"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "__parse_fpscr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/traps.c",
          "lines": "1164-1189",
          "snippet": "static inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/nmi.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/kprobes.h>",
            "#include <sysdev/fsl_pci.h>",
            "#include <asm/hmi.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rio.h>",
            "#include <asm/ppc-opcode.h>",
            "#include <asm/kexec.h>",
            "#include <asm/tm.h>",
            "#include <asm/processor.h>",
            "#include <asm/firmware.h>",
            "#include <asm/backlight.h>",
            "#include <asm/reg.h>",
            "#include <asm/pmc.h>",
            "#include <asm/rtas.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/emulated_ops.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/console.h>",
            "#include <linux/smp.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/bug.h>",
            "#include <linux/backlight.h>",
            "#include <linux/kexec.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/delay.h>",
            "#include <linux/prctl.h>",
            "#include <linux/module.h>\t/* print_modules */",
            "#include <linux/extable.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/user.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/nmi.h>\n#include <asm/stacktrace.h>\n#include <asm/kprobes.h>\n#include <sysdev/fsl_pci.h>\n#include <asm/hmi.h>\n#include <asm/asm-prototypes.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/fadump.h>\n#include <asm/rio.h>\n#include <asm/ppc-opcode.h>\n#include <asm/kexec.h>\n#include <asm/tm.h>\n#include <asm/processor.h>\n#include <asm/firmware.h>\n#include <asm/backlight.h>\n#include <asm/reg.h>\n#include <asm/pmc.h>\n#include <asm/rtas.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/uaccess.h>\n#include <asm/emulated_ops.h>\n#include <linux/kmsg_dump.h>\n#include <linux/console.h>\n#include <linux/smp.h>\n#include <linux/context_tracking.h>\n#include <linux/ratelimit.h>\n#include <linux/kdebug.h>\n#include <linux/bug.h>\n#include <linux/backlight.h>\n#include <linux/kexec.h>\n#include <linux/kprobes.h>\n#include <linux/delay.h>\n#include <linux/prctl.h>\n#include <linux/module.h>\t/* print_modules */\n#include <linux/extable.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/user.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/pkeys.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memblock_alloc_try_nid",
          "args": [
            "size",
            "align",
            "goal",
            "MEMBLOCK_ALLOC_ACCESSIBLE",
            "node"
          ],
          "line": 788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"per cpu data for cpu%d %lu bytes at %016lx\\n\"",
            "cpu",
            "size",
            "__pa(ptr)"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"cpu %d has no node %d or node-local memory\\n\"",
            "cpu",
            "node"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc_from",
          "args": [
            "size",
            "align",
            "goal"
          ],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NODE_DATA",
          "args": [
            "node"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node_online",
          "args": [
            "node"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void * __init pcpu_alloc_bootmem(unsigned int cpu, size_t size,\n\t\t\t\t\tsize_t align)\n{\n\tconst unsigned long goal = __pa(MAX_DMA_ADDRESS);\n#ifdef CONFIG_NEED_MULTIPLE_NODES\n\tint node = early_cpu_to_node(cpu);\n\tvoid *ptr;\n\n\tif (!node_online(node) || !NODE_DATA(node)) {\n\t\tptr = memblock_alloc_from(size, align, goal);\n\t\tpr_info(\"cpu %d has no node %d or node-local memory\\n\",\n\t\t\tcpu, node);\n\t\tpr_debug(\"per cpu data for cpu%d %lu bytes at %016lx\\n\",\n\t\t\t cpu, size, __pa(ptr));\n\t} else {\n\t\tptr = memblock_alloc_try_nid(size, align, goal,\n\t\t\t\t\t     MEMBLOCK_ALLOC_ACCESSIBLE, node);\n\t\tpr_debug(\"per cpu data for cpu%d %lu bytes on node%d at \"\n\t\t\t \"%016lx\\n\", cpu, size, node, __pa(ptr));\n\t}\n\treturn ptr;\n#else\n\treturn memblock_alloc_from(size, align, goal);\n#endif\n}"
  },
  {
    "function_name": "emergency_stack_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "716-757",
    "snippet": "void __init emergency_stack_init(void)\n{\n\tu64 limit, mce_limit;\n\tunsigned int i;\n\n\t/*\n\t * Emergency stacks must be under 256MB, we cannot afford to take\n\t * SLB misses on them. The ABI also requires them to be 128-byte\n\t * aligned.\n\t *\n\t * Since we use these as temporary stacks during secondary CPU\n\t * bringup, machine check, system reset, and HMI, we need to get\n\t * at them in real mode. This means they must also be within the RMO\n\t * region.\n\t *\n\t * The IRQ stacks allocated elsewhere in this file are zeroed and\n\t * initialized in kernel/irq.c. These are initialized here in order\n\t * to have emergency stacks available as early as possible.\n\t */\n\tlimit = mce_limit = min(ppc64_bolted_size(), ppc64_rma_size);\n\n\t/*\n\t * Machine check on pseries calls rtas, but can't use the static\n\t * rtas_args due to a machine check hitting while the lock is held.\n\t * rtas args have to be under 4GB, so the machine check stack is\n\t * limited to 4GB so args can be put on stack.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) && mce_limit > SZ_4G)\n\t\tmce_limit = SZ_4G;\n\n\tfor_each_possible_cpu(i) {\n\t\tpaca_ptrs[i]->emergency_sp = alloc_stack(limit, i) + THREAD_SIZE;\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t\t/* emergency stack for NMI exception handling. */\n\t\tpaca_ptrs[i]->nmi_emergency_sp = alloc_stack(limit, i) + THREAD_SIZE;\n\n\t\t/* emergency stack for machine check exception handling. */\n\t\tpaca_ptrs[i]->mc_emergency_sp = alloc_stack(mce_limit, i) + THREAD_SIZE;\n#endif\n\t}\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_stack",
          "args": [
            "mce_limit",
            "i"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "654-667",
          "snippet": "static void *__init alloc_stack(unsigned long limit, int cpu)\n{\n\tvoid *ptr;\n\n\tBUILD_BUG_ON(STACK_INT_FRAME_SIZE % 16);\n\n\tptr = memblock_alloc_try_nid(THREAD_SIZE, THREAD_ALIGN,\n\t\t\t\t     MEMBLOCK_LOW_LIMIT, limit,\n\t\t\t\t     early_cpu_to_node(cpu));\n\tif (!ptr)\n\t\tpanic(\"cannot allocate stacks\");\n\n\treturn ptr;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void *__init alloc_stack(unsigned long limit, int cpu)\n{\n\tvoid *ptr;\n\n\tBUILD_BUG_ON(STACK_INT_FRAME_SIZE % 16);\n\n\tptr = memblock_alloc_try_nid(THREAD_SIZE, THREAD_ALIGN,\n\t\t\t\t     MEMBLOCK_LOW_LIMIT, limit,\n\t\t\t\t     early_cpu_to_node(cpu));\n\tif (!ptr)\n\t\tpanic(\"cannot allocate stacks\");\n\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_LPAR"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "ppc64_bolted_size()",
            "ppc64_rma_size"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc64_bolted_size",
          "args": [],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "ppc64_bolted_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "633-652",
          "snippet": "__init u64 ppc64_bolted_size(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\t/* XXX: BookE ppc64_rma_limit setup seems to disagree? */\n\tif (early_mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS radix, does not take faults on linear mapping */\n\tif (early_radix_enabled())\n\t\treturn ULONG_MAX;\n\n\t/* BookS hash, the first segment is bolted */\n\tif (early_mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\n__init u64 ppc64_bolted_size(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\t/* XXX: BookE ppc64_rma_limit setup seems to disagree? */\n\tif (early_mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS radix, does not take faults on linear mapping */\n\tif (early_radix_enabled())\n\t\treturn ULONG_MAX;\n\n\t/* BookS hash, the first segment is bolted */\n\tif (early_mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init emergency_stack_init(void)\n{\n\tu64 limit, mce_limit;\n\tunsigned int i;\n\n\t/*\n\t * Emergency stacks must be under 256MB, we cannot afford to take\n\t * SLB misses on them. The ABI also requires them to be 128-byte\n\t * aligned.\n\t *\n\t * Since we use these as temporary stacks during secondary CPU\n\t * bringup, machine check, system reset, and HMI, we need to get\n\t * at them in real mode. This means they must also be within the RMO\n\t * region.\n\t *\n\t * The IRQ stacks allocated elsewhere in this file are zeroed and\n\t * initialized in kernel/irq.c. These are initialized here in order\n\t * to have emergency stacks available as early as possible.\n\t */\n\tlimit = mce_limit = min(ppc64_bolted_size(), ppc64_rma_size);\n\n\t/*\n\t * Machine check on pseries calls rtas, but can't use the static\n\t * rtas_args due to a machine check hitting while the lock is held.\n\t * rtas args have to be under 4GB, so the machine check stack is\n\t * limited to 4GB so args can be put on stack.\n\t */\n\tif (firmware_has_feature(FW_FEATURE_LPAR) && mce_limit > SZ_4G)\n\t\tmce_limit = SZ_4G;\n\n\tfor_each_possible_cpu(i) {\n\t\tpaca_ptrs[i]->emergency_sp = alloc_stack(limit, i) + THREAD_SIZE;\n\n#ifdef CONFIG_PPC_BOOK3S_64\n\t\t/* emergency stack for NMI exception handling. */\n\t\tpaca_ptrs[i]->nmi_emergency_sp = alloc_stack(limit, i) + THREAD_SIZE;\n\n\t\t/* emergency stack for machine check exception handling. */\n\t\tpaca_ptrs[i]->mc_emergency_sp = alloc_stack(mce_limit, i) + THREAD_SIZE;\n#endif\n\t}\n}"
  },
  {
    "function_name": "exc_lvl_early_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "686-708",
    "snippet": "void __init exc_lvl_early_init(void)\n{\n\tunsigned int i;\n\n\tfor_each_possible_cpu(i) {\n\t\tvoid *sp;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tcritirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->crit_kstack = sp + THREAD_SIZE;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tdbgirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->dbg_kstack = sp + THREAD_SIZE;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tmcheckirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->mc_kstack = sp + THREAD_SIZE;\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DEBUG_LVL_EXC))\n\t\tpatch_exception(0x040, exc_debug_debug_book3e);\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "patch_exception",
          "args": [
            "0x040",
            "exc_debug_debug_book3e"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_DEBUG_LVL_EXC"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_stack",
          "args": [
            "ULONG_MAX",
            "i"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "654-667",
          "snippet": "static void *__init alloc_stack(unsigned long limit, int cpu)\n{\n\tvoid *ptr;\n\n\tBUILD_BUG_ON(STACK_INT_FRAME_SIZE % 16);\n\n\tptr = memblock_alloc_try_nid(THREAD_SIZE, THREAD_ALIGN,\n\t\t\t\t     MEMBLOCK_LOW_LIMIT, limit,\n\t\t\t\t     early_cpu_to_node(cpu));\n\tif (!ptr)\n\t\tpanic(\"cannot allocate stacks\");\n\n\treturn ptr;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void *__init alloc_stack(unsigned long limit, int cpu)\n{\n\tvoid *ptr;\n\n\tBUILD_BUG_ON(STACK_INT_FRAME_SIZE % 16);\n\n\tptr = memblock_alloc_try_nid(THREAD_SIZE, THREAD_ALIGN,\n\t\t\t\t     MEMBLOCK_LOW_LIMIT, limit,\n\t\t\t\t     early_cpu_to_node(cpu));\n\tif (!ptr)\n\t\tpanic(\"cannot allocate stacks\");\n\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init exc_lvl_early_init(void)\n{\n\tunsigned int i;\n\n\tfor_each_possible_cpu(i) {\n\t\tvoid *sp;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tcritirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->crit_kstack = sp + THREAD_SIZE;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tdbgirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->dbg_kstack = sp + THREAD_SIZE;\n\n\t\tsp = alloc_stack(ULONG_MAX, i);\n\t\tmcheckirq_ctx[i] = sp;\n\t\tpaca_ptrs[i]->mc_kstack = sp + THREAD_SIZE;\n\t}\n\n\tif (cpu_has_feature(CPU_FTR_DEBUG_LVL_EXC))\n\t\tpatch_exception(0x040, exc_debug_debug_book3e);\n}"
  },
  {
    "function_name": "irqstack_early_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "669-683",
    "snippet": "void __init irqstack_early_init(void)\n{\n\tu64 limit = ppc64_bolted_size();\n\tunsigned int i;\n\n\t/*\n\t * Interrupt stacks must be in the first segment since we\n\t * cannot afford to take SLB misses on them. They are not\n\t * accessed in realmode.\n\t */\n\tfor_each_possible_cpu(i) {\n\t\tsoftirq_ctx[i] = alloc_stack(limit, i);\n\t\thardirq_ctx[i] = alloc_stack(limit, i);\n\t}\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_stack",
          "args": [
            "limit",
            "i"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "654-667",
          "snippet": "static void *__init alloc_stack(unsigned long limit, int cpu)\n{\n\tvoid *ptr;\n\n\tBUILD_BUG_ON(STACK_INT_FRAME_SIZE % 16);\n\n\tptr = memblock_alloc_try_nid(THREAD_SIZE, THREAD_ALIGN,\n\t\t\t\t     MEMBLOCK_LOW_LIMIT, limit,\n\t\t\t\t     early_cpu_to_node(cpu));\n\tif (!ptr)\n\t\tpanic(\"cannot allocate stacks\");\n\n\treturn ptr;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void *__init alloc_stack(unsigned long limit, int cpu)\n{\n\tvoid *ptr;\n\n\tBUILD_BUG_ON(STACK_INT_FRAME_SIZE % 16);\n\n\tptr = memblock_alloc_try_nid(THREAD_SIZE, THREAD_ALIGN,\n\t\t\t\t     MEMBLOCK_LOW_LIMIT, limit,\n\t\t\t\t     early_cpu_to_node(cpu));\n\tif (!ptr)\n\t\tpanic(\"cannot allocate stacks\");\n\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppc64_bolted_size",
          "args": [],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "ppc64_bolted_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "633-652",
          "snippet": "__init u64 ppc64_bolted_size(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\t/* XXX: BookE ppc64_rma_limit setup seems to disagree? */\n\tif (early_mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS radix, does not take faults on linear mapping */\n\tif (early_radix_enabled())\n\t\treturn ULONG_MAX;\n\n\t/* BookS hash, the first segment is bolted */\n\tif (early_mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\n__init u64 ppc64_bolted_size(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\t/* XXX: BookE ppc64_rma_limit setup seems to disagree? */\n\tif (early_mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS radix, does not take faults on linear mapping */\n\tif (early_radix_enabled())\n\t\treturn ULONG_MAX;\n\n\t/* BookS hash, the first segment is bolted */\n\tif (early_mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init irqstack_early_init(void)\n{\n\tu64 limit = ppc64_bolted_size();\n\tunsigned int i;\n\n\t/*\n\t * Interrupt stacks must be in the first segment since we\n\t * cannot afford to take SLB misses on them. They are not\n\t * accessed in realmode.\n\t */\n\tfor_each_possible_cpu(i) {\n\t\tsoftirq_ctx[i] = alloc_stack(limit, i);\n\t\thardirq_ctx[i] = alloc_stack(limit, i);\n\t}\n}"
  },
  {
    "function_name": "alloc_stack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "654-667",
    "snippet": "static void *__init alloc_stack(unsigned long limit, int cpu)\n{\n\tvoid *ptr;\n\n\tBUILD_BUG_ON(STACK_INT_FRAME_SIZE % 16);\n\n\tptr = memblock_alloc_try_nid(THREAD_SIZE, THREAD_ALIGN,\n\t\t\t\t     MEMBLOCK_LOW_LIMIT, limit,\n\t\t\t\t     early_cpu_to_node(cpu));\n\tif (!ptr)\n\t\tpanic(\"cannot allocate stacks\");\n\n\treturn ptr;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"cannot allocate stacks\""
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc_try_nid",
          "args": [
            "THREAD_SIZE",
            "THREAD_ALIGN",
            "MEMBLOCK_LOW_LIMIT",
            "limit",
            "early_cpu_to_node(cpu)"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "STACK_INT_FRAME_SIZE % 16"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void *__init alloc_stack(unsigned long limit, int cpu)\n{\n\tvoid *ptr;\n\n\tBUILD_BUG_ON(STACK_INT_FRAME_SIZE % 16);\n\n\tptr = memblock_alloc_try_nid(THREAD_SIZE, THREAD_ALIGN,\n\t\t\t\t     MEMBLOCK_LOW_LIMIT, limit,\n\t\t\t\t     early_cpu_to_node(cpu));\n\tif (!ptr)\n\t\tpanic(\"cannot allocate stacks\");\n\n\treturn ptr;\n}"
  },
  {
    "function_name": "ppc64_bolted_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "633-652",
    "snippet": "__init u64 ppc64_bolted_size(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\t/* XXX: BookE ppc64_rma_limit setup seems to disagree? */\n\tif (early_mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS radix, does not take faults on linear mapping */\n\tif (early_radix_enabled())\n\t\treturn ULONG_MAX;\n\n\t/* BookS hash, the first segment is bolted */\n\tif (early_mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "early_mmu_has_feature",
          "args": [
            "MMU_FTR_1T_SEGMENT"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_radix_enabled",
          "args": [],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_mmu_has_feature",
          "args": [
            "MMU_FTR_TYPE_FSL_E"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\n__init u64 ppc64_bolted_size(void)\n{\n#ifdef CONFIG_PPC_BOOK3E\n\t/* Freescale BookE bolts the entire linear mapping */\n\t/* XXX: BookE ppc64_rma_limit setup seems to disagree? */\n\tif (early_mmu_has_feature(MMU_FTR_TYPE_FSL_E))\n\t\treturn linear_map_top;\n\t/* Other BookE, we assume the first GB is bolted */\n\treturn 1ul << 30;\n#else\n\t/* BookS radix, does not take faults on linear mapping */\n\tif (early_radix_enabled())\n\t\treturn ULONG_MAX;\n\n\t/* BookS hash, the first segment is bolted */\n\tif (early_mmu_has_feature(MMU_FTR_1T_SEGMENT))\n\t\treturn 1UL << SID_SHIFT_1T;\n\treturn 1UL << SID_SHIFT;\n#endif\n}"
  },
  {
    "function_name": "initialize_cache_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "566-622",
    "snippet": "void __init initialize_cache_info(void)\n{\n\tstruct device_node *cpu = NULL, *l2, *l3 = NULL;\n\tu32 pvr;\n\n\t/*\n\t * All shipping POWER8 machines have a firmware bug that\n\t * puts incorrect information in the device-tree. This will\n\t * be (hopefully) fixed for future chips but for now hard\n\t * code the values if we are running on one of these\n\t */\n\tpvr = PVR_VER(mfspr(SPRN_PVR));\n\tif (pvr == PVR_POWER8 || pvr == PVR_POWER8E ||\n\t    pvr == PVR_POWER8NVL) {\n\t\t\t\t\t\t/* size    lsize   blk  sets */\n\t\tinit_cache_info(&ppc64_caches.l1i, 0x8000,   128,  128, 32);\n\t\tinit_cache_info(&ppc64_caches.l1d, 0x10000,  128,  128, 64);\n\t\tinit_cache_info(&ppc64_caches.l2,  0x80000,  128,  0,   512);\n\t\tinit_cache_info(&ppc64_caches.l3,  0x800000, 128,  0,   8192);\n\t} else\n\t\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\t/*\n\t * We're assuming *all* of the CPUs have the same\n\t * d-cache and i-cache sizes... -Peter\n\t */\n\tif (cpu) {\n\t\tif (!parse_cache_info(cpu, false, &ppc64_caches.l1d))\n\t\t\tpr_warn(\"Argh, can't find dcache properties !\\n\");\n\n\t\tif (!parse_cache_info(cpu, true, &ppc64_caches.l1i))\n\t\t\tpr_warn(\"Argh, can't find icache properties !\\n\");\n\n\t\t/*\n\t\t * Try to find the L2 and L3 if any. Assume they are\n\t\t * unified and use the D-side properties.\n\t\t */\n\t\tl2 = of_find_next_cache_node(cpu);\n\t\tof_node_put(cpu);\n\t\tif (l2) {\n\t\t\tparse_cache_info(l2, false, &ppc64_caches.l2);\n\t\t\tl3 = of_find_next_cache_node(l2);\n\t\t\tof_node_put(l2);\n\t\t}\n\t\tif (l3) {\n\t\t\tparse_cache_info(l3, false, &ppc64_caches.l3);\n\t\t\tof_node_put(l3);\n\t\t}\n\t}\n\n\t/* For use by binfmt_elf */\n\tdcache_bsize = ppc64_caches.l1d.block_size;\n\ticache_bsize = ppc64_caches.l1i.block_size;\n\n\tcur_cpu_spec->dcache_bsize = dcache_bsize;\n\tcur_cpu_spec->icache_bsize = icache_bsize;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ppc64_caches ppc64_caches = {\n\t.l1d = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6,\n\t},\n\t.l1i = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6\n\t},\n};",
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "l3"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_cache_info",
          "args": [
            "l3",
            "false",
            "&ppc64_caches.l3"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "parse_cache_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "507-564",
          "snippet": "static bool __init parse_cache_info(struct device_node *np,\n\t\t\t\t    bool icache,\n\t\t\t\t    struct ppc_cache_info *info)\n{\n\tstatic const char *ipropnames[] __initdata = {\n\t\t\"i-cache-size\",\n\t\t\"i-cache-sets\",\n\t\t\"i-cache-block-size\",\n\t\t\"i-cache-line-size\",\n\t};\n\tstatic const char *dpropnames[] __initdata = {\n\t\t\"d-cache-size\",\n\t\t\"d-cache-sets\",\n\t\t\"d-cache-block-size\",\n\t\t\"d-cache-line-size\",\n\t};\n\tconst char **propnames = icache ? ipropnames : dpropnames;\n\tconst __be32 *sizep, *lsizep, *bsizep, *setsp;\n\tu32 size, lsize, bsize, sets;\n\tbool success = true;\n\n\tsize = 0;\n\tsets = -1u;\n\tlsize = bsize = cur_cpu_spec->dcache_bsize;\n\tsizep = of_get_property(np, propnames[0], NULL);\n\tif (sizep != NULL)\n\t\tsize = be32_to_cpu(*sizep);\n\tsetsp = of_get_property(np, propnames[1], NULL);\n\tif (setsp != NULL)\n\t\tsets = be32_to_cpu(*setsp);\n\tbsizep = of_get_property(np, propnames[2], NULL);\n\tlsizep = of_get_property(np, propnames[3], NULL);\n\tif (bsizep == NULL)\n\t\tbsizep = lsizep;\n\tif (lsizep == NULL)\n\t\tlsizep = bsizep;\n\tif (lsizep != NULL)\n\t\tlsize = be32_to_cpu(*lsizep);\n\tif (bsizep != NULL)\n\t\tbsize = be32_to_cpu(*bsizep);\n\tif (sizep == NULL || bsizep == NULL || lsizep == NULL)\n\t\tsuccess = false;\n\n\t/*\n\t * OF is weird .. it represents fully associative caches\n\t * as \"1 way\" which doesn't make much sense and doesn't\n\t * leave room for direct mapped. We'll assume that 0\n\t * in OF means direct mapped for that reason.\n\t */\n\tif (sets == 1)\n\t\tsets = 0;\n\telse if (sets == 0)\n\t\tsets = 1;\n\n\tinit_cache_info(info, size, lsize, bsize, sets);\n\n\treturn success;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic bool __init parse_cache_info(struct device_node *np,\n\t\t\t\t    bool icache,\n\t\t\t\t    struct ppc_cache_info *info)\n{\n\tstatic const char *ipropnames[] __initdata = {\n\t\t\"i-cache-size\",\n\t\t\"i-cache-sets\",\n\t\t\"i-cache-block-size\",\n\t\t\"i-cache-line-size\",\n\t};\n\tstatic const char *dpropnames[] __initdata = {\n\t\t\"d-cache-size\",\n\t\t\"d-cache-sets\",\n\t\t\"d-cache-block-size\",\n\t\t\"d-cache-line-size\",\n\t};\n\tconst char **propnames = icache ? ipropnames : dpropnames;\n\tconst __be32 *sizep, *lsizep, *bsizep, *setsp;\n\tu32 size, lsize, bsize, sets;\n\tbool success = true;\n\n\tsize = 0;\n\tsets = -1u;\n\tlsize = bsize = cur_cpu_spec->dcache_bsize;\n\tsizep = of_get_property(np, propnames[0], NULL);\n\tif (sizep != NULL)\n\t\tsize = be32_to_cpu(*sizep);\n\tsetsp = of_get_property(np, propnames[1], NULL);\n\tif (setsp != NULL)\n\t\tsets = be32_to_cpu(*setsp);\n\tbsizep = of_get_property(np, propnames[2], NULL);\n\tlsizep = of_get_property(np, propnames[3], NULL);\n\tif (bsizep == NULL)\n\t\tbsizep = lsizep;\n\tif (lsizep == NULL)\n\t\tlsizep = bsizep;\n\tif (lsizep != NULL)\n\t\tlsize = be32_to_cpu(*lsizep);\n\tif (bsizep != NULL)\n\t\tbsize = be32_to_cpu(*bsizep);\n\tif (sizep == NULL || bsizep == NULL || lsizep == NULL)\n\t\tsuccess = false;\n\n\t/*\n\t * OF is weird .. it represents fully associative caches\n\t * as \"1 way\" which doesn't make much sense and doesn't\n\t * leave room for direct mapped. We'll assume that 0\n\t * in OF means direct mapped for that reason.\n\t */\n\tif (sets == 1)\n\t\tsets = 0;\n\telse if (sets == 0)\n\t\tsets = 1;\n\n\tinit_cache_info(info, size, lsize, bsize, sets);\n\n\treturn success;\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "l2"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_next_cache_node",
          "args": [
            "l2"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "cpu"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_next_cache_node",
          "args": [
            "cpu"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Argh, can't find icache properties !\\n\""
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Argh, can't find dcache properties !\\n\""
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_type",
          "args": [
            "NULL",
            "\"cpu\""
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_cache_info",
          "args": [
            "&ppc64_caches.l3",
            "0x800000",
            "128",
            "0",
            "8192"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "init_cache_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "488-505",
          "snippet": "static void init_cache_info(struct ppc_cache_info *info, u32 size, u32 lsize,\n\t\t\t    u32 bsize, u32 sets)\n{\n\tinfo->size = size;\n\tinfo->sets = sets;\n\tinfo->line_size = lsize;\n\tinfo->block_size = bsize;\n\tinfo->log_block_size = __ilog2(bsize);\n\tif (bsize)\n\t\tinfo->blocks_per_page = PAGE_SIZE / bsize;\n\telse\n\t\tinfo->blocks_per_page = 0;\n\n\tif (sets == 0)\n\t\tinfo->assoc = 0xffff;\n\telse\n\t\tinfo->assoc = size / (sets * lsize);\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void init_cache_info(struct ppc_cache_info *info, u32 size, u32 lsize,\n\t\t\t    u32 bsize, u32 sets)\n{\n\tinfo->size = size;\n\tinfo->sets = sets;\n\tinfo->line_size = lsize;\n\tinfo->block_size = bsize;\n\tinfo->log_block_size = __ilog2(bsize);\n\tif (bsize)\n\t\tinfo->blocks_per_page = PAGE_SIZE / bsize;\n\telse\n\t\tinfo->blocks_per_page = 0;\n\n\tif (sets == 0)\n\t\tinfo->assoc = 0xffff;\n\telse\n\t\tinfo->assoc = size / (sets * lsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PVR_VER",
          "args": [
            "mfspr(SPRN_PVR)"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PVR"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct ppc64_caches ppc64_caches = {\n\t.l1d = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6,\n\t},\n\t.l1i = {\n\t\t.block_size = 0x40,\n\t\t.log_block_size = 6\n\t},\n};\nvoid __init;\n\nvoid __init initialize_cache_info(void)\n{\n\tstruct device_node *cpu = NULL, *l2, *l3 = NULL;\n\tu32 pvr;\n\n\t/*\n\t * All shipping POWER8 machines have a firmware bug that\n\t * puts incorrect information in the device-tree. This will\n\t * be (hopefully) fixed for future chips but for now hard\n\t * code the values if we are running on one of these\n\t */\n\tpvr = PVR_VER(mfspr(SPRN_PVR));\n\tif (pvr == PVR_POWER8 || pvr == PVR_POWER8E ||\n\t    pvr == PVR_POWER8NVL) {\n\t\t\t\t\t\t/* size    lsize   blk  sets */\n\t\tinit_cache_info(&ppc64_caches.l1i, 0x8000,   128,  128, 32);\n\t\tinit_cache_info(&ppc64_caches.l1d, 0x10000,  128,  128, 64);\n\t\tinit_cache_info(&ppc64_caches.l2,  0x80000,  128,  0,   512);\n\t\tinit_cache_info(&ppc64_caches.l3,  0x800000, 128,  0,   8192);\n\t} else\n\t\tcpu = of_find_node_by_type(NULL, \"cpu\");\n\n\t/*\n\t * We're assuming *all* of the CPUs have the same\n\t * d-cache and i-cache sizes... -Peter\n\t */\n\tif (cpu) {\n\t\tif (!parse_cache_info(cpu, false, &ppc64_caches.l1d))\n\t\t\tpr_warn(\"Argh, can't find dcache properties !\\n\");\n\n\t\tif (!parse_cache_info(cpu, true, &ppc64_caches.l1i))\n\t\t\tpr_warn(\"Argh, can't find icache properties !\\n\");\n\n\t\t/*\n\t\t * Try to find the L2 and L3 if any. Assume they are\n\t\t * unified and use the D-side properties.\n\t\t */\n\t\tl2 = of_find_next_cache_node(cpu);\n\t\tof_node_put(cpu);\n\t\tif (l2) {\n\t\t\tparse_cache_info(l2, false, &ppc64_caches.l2);\n\t\t\tl3 = of_find_next_cache_node(l2);\n\t\t\tof_node_put(l2);\n\t\t}\n\t\tif (l3) {\n\t\t\tparse_cache_info(l3, false, &ppc64_caches.l3);\n\t\t\tof_node_put(l3);\n\t\t}\n\t}\n\n\t/* For use by binfmt_elf */\n\tdcache_bsize = ppc64_caches.l1d.block_size;\n\ticache_bsize = ppc64_caches.l1i.block_size;\n\n\tcur_cpu_spec->dcache_bsize = dcache_bsize;\n\tcur_cpu_spec->icache_bsize = icache_bsize;\n}"
  },
  {
    "function_name": "parse_cache_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "507-564",
    "snippet": "static bool __init parse_cache_info(struct device_node *np,\n\t\t\t\t    bool icache,\n\t\t\t\t    struct ppc_cache_info *info)\n{\n\tstatic const char *ipropnames[] __initdata = {\n\t\t\"i-cache-size\",\n\t\t\"i-cache-sets\",\n\t\t\"i-cache-block-size\",\n\t\t\"i-cache-line-size\",\n\t};\n\tstatic const char *dpropnames[] __initdata = {\n\t\t\"d-cache-size\",\n\t\t\"d-cache-sets\",\n\t\t\"d-cache-block-size\",\n\t\t\"d-cache-line-size\",\n\t};\n\tconst char **propnames = icache ? ipropnames : dpropnames;\n\tconst __be32 *sizep, *lsizep, *bsizep, *setsp;\n\tu32 size, lsize, bsize, sets;\n\tbool success = true;\n\n\tsize = 0;\n\tsets = -1u;\n\tlsize = bsize = cur_cpu_spec->dcache_bsize;\n\tsizep = of_get_property(np, propnames[0], NULL);\n\tif (sizep != NULL)\n\t\tsize = be32_to_cpu(*sizep);\n\tsetsp = of_get_property(np, propnames[1], NULL);\n\tif (setsp != NULL)\n\t\tsets = be32_to_cpu(*setsp);\n\tbsizep = of_get_property(np, propnames[2], NULL);\n\tlsizep = of_get_property(np, propnames[3], NULL);\n\tif (bsizep == NULL)\n\t\tbsizep = lsizep;\n\tif (lsizep == NULL)\n\t\tlsizep = bsizep;\n\tif (lsizep != NULL)\n\t\tlsize = be32_to_cpu(*lsizep);\n\tif (bsizep != NULL)\n\t\tbsize = be32_to_cpu(*bsizep);\n\tif (sizep == NULL || bsizep == NULL || lsizep == NULL)\n\t\tsuccess = false;\n\n\t/*\n\t * OF is weird .. it represents fully associative caches\n\t * as \"1 way\" which doesn't make much sense and doesn't\n\t * leave room for direct mapped. We'll assume that 0\n\t * in OF means direct mapped for that reason.\n\t */\n\tif (sets == 1)\n\t\tsets = 0;\n\telse if (sets == 0)\n\t\tsets = 1;\n\n\tinit_cache_info(info, size, lsize, bsize, sets);\n\n\treturn success;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_cache_info",
          "args": [
            "info",
            "size",
            "lsize",
            "bsize",
            "sets"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "init_cache_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "488-505",
          "snippet": "static void init_cache_info(struct ppc_cache_info *info, u32 size, u32 lsize,\n\t\t\t    u32 bsize, u32 sets)\n{\n\tinfo->size = size;\n\tinfo->sets = sets;\n\tinfo->line_size = lsize;\n\tinfo->block_size = bsize;\n\tinfo->log_block_size = __ilog2(bsize);\n\tif (bsize)\n\t\tinfo->blocks_per_page = PAGE_SIZE / bsize;\n\telse\n\t\tinfo->blocks_per_page = 0;\n\n\tif (sets == 0)\n\t\tinfo->assoc = 0xffff;\n\telse\n\t\tinfo->assoc = size / (sets * lsize);\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void init_cache_info(struct ppc_cache_info *info, u32 size, u32 lsize,\n\t\t\t    u32 bsize, u32 sets)\n{\n\tinfo->size = size;\n\tinfo->sets = sets;\n\tinfo->line_size = lsize;\n\tinfo->block_size = bsize;\n\tinfo->log_block_size = __ilog2(bsize);\n\tif (bsize)\n\t\tinfo->blocks_per_page = PAGE_SIZE / bsize;\n\telse\n\t\tinfo->blocks_per_page = 0;\n\n\tif (sets == 0)\n\t\tinfo->assoc = 0xffff;\n\telse\n\t\tinfo->assoc = size / (sets * lsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*bsizep"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*lsizep"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "propnames[3]",
            "NULL"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "propnames[2]",
            "NULL"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*setsp"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "propnames[1]",
            "NULL"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*sizep"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "propnames[0]",
            "NULL"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic bool __init parse_cache_info(struct device_node *np,\n\t\t\t\t    bool icache,\n\t\t\t\t    struct ppc_cache_info *info)\n{\n\tstatic const char *ipropnames[] __initdata = {\n\t\t\"i-cache-size\",\n\t\t\"i-cache-sets\",\n\t\t\"i-cache-block-size\",\n\t\t\"i-cache-line-size\",\n\t};\n\tstatic const char *dpropnames[] __initdata = {\n\t\t\"d-cache-size\",\n\t\t\"d-cache-sets\",\n\t\t\"d-cache-block-size\",\n\t\t\"d-cache-line-size\",\n\t};\n\tconst char **propnames = icache ? ipropnames : dpropnames;\n\tconst __be32 *sizep, *lsizep, *bsizep, *setsp;\n\tu32 size, lsize, bsize, sets;\n\tbool success = true;\n\n\tsize = 0;\n\tsets = -1u;\n\tlsize = bsize = cur_cpu_spec->dcache_bsize;\n\tsizep = of_get_property(np, propnames[0], NULL);\n\tif (sizep != NULL)\n\t\tsize = be32_to_cpu(*sizep);\n\tsetsp = of_get_property(np, propnames[1], NULL);\n\tif (setsp != NULL)\n\t\tsets = be32_to_cpu(*setsp);\n\tbsizep = of_get_property(np, propnames[2], NULL);\n\tlsizep = of_get_property(np, propnames[3], NULL);\n\tif (bsizep == NULL)\n\t\tbsizep = lsizep;\n\tif (lsizep == NULL)\n\t\tlsizep = bsizep;\n\tif (lsizep != NULL)\n\t\tlsize = be32_to_cpu(*lsizep);\n\tif (bsizep != NULL)\n\t\tbsize = be32_to_cpu(*bsizep);\n\tif (sizep == NULL || bsizep == NULL || lsizep == NULL)\n\t\tsuccess = false;\n\n\t/*\n\t * OF is weird .. it represents fully associative caches\n\t * as \"1 way\" which doesn't make much sense and doesn't\n\t * leave room for direct mapped. We'll assume that 0\n\t * in OF means direct mapped for that reason.\n\t */\n\tif (sets == 1)\n\t\tsets = 0;\n\telse if (sets == 0)\n\t\tsets = 1;\n\n\tinit_cache_info(info, size, lsize, bsize, sets);\n\n\treturn success;\n}"
  },
  {
    "function_name": "init_cache_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "488-505",
    "snippet": "static void init_cache_info(struct ppc_cache_info *info, u32 size, u32 lsize,\n\t\t\t    u32 bsize, u32 sets)\n{\n\tinfo->size = size;\n\tinfo->sets = sets;\n\tinfo->line_size = lsize;\n\tinfo->block_size = bsize;\n\tinfo->log_block_size = __ilog2(bsize);\n\tif (bsize)\n\t\tinfo->blocks_per_page = PAGE_SIZE / bsize;\n\telse\n\t\tinfo->blocks_per_page = 0;\n\n\tif (sets == 0)\n\t\tinfo->assoc = 0xffff;\n\telse\n\t\tinfo->assoc = size / (sets * lsize);\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__ilog2",
          "args": [
            "bsize"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void init_cache_info(struct ppc_cache_info *info, u32 size, u32 lsize,\n\t\t\t    u32 bsize, u32 sets)\n{\n\tinfo->size = size;\n\tinfo->sets = sets;\n\tinfo->line_size = lsize;\n\tinfo->block_size = bsize;\n\tinfo->log_block_size = __ilog2(bsize);\n\tif (bsize)\n\t\tinfo->blocks_per_page = PAGE_SIZE / bsize;\n\telse\n\t\tinfo->blocks_per_page = 0;\n\n\tif (sets == 0)\n\t\tinfo->assoc = 0xffff;\n\telse\n\t\tinfo->assoc = size / (sets * lsize);\n}"
  },
  {
    "function_name": "smp_release_cpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "450-477",
    "snippet": "void smp_release_cpus(void)\n{\n\tunsigned long *ptr;\n\tint i;\n\n\tif (!use_spinloop())\n\t\treturn;\n\n\t/* All secondary cpus are spinning on a common spinloop, release them\n\t * all now so they can start to spin on their individual paca\n\t * spinloops. For non SMP kernels, the secondary cpus never get out\n\t * of the common spinloop.\n\t */\n\n\tptr  = (unsigned long *)((unsigned long)&__secondary_hold_spinloop\n\t\t\t- PHYSICAL_START);\n\t*ptr = ppc_function_entry(generic_secondary_smp_init);\n\n\t/* And wait a bit for them to catch up */\n\tfor (i = 0; i < 100000; i++) {\n\t\tmb();\n\t\tHMT_low();\n\t\tif (spinning_secondaries == 0)\n\t\t\tbreak;\n\t\tudelay(1);\n\t}\n\tpr_debug(\"spinning_secondaries = %d\\n\", spinning_secondaries);\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int spinning_secondaries;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"spinning_secondaries = %d\\n\"",
            "spinning_secondaries"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udelay",
          "args": [
            "1"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "udelay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/time.c",
          "lines": "478-481",
          "snippet": "void udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}",
          "includes": [
            "#include <asm/dtl.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/clockchips.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/firmware.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/smp.h>",
            "#include <asm/div64.h>",
            "#include <asm/irq.h>",
            "#include <asm/prom.h>",
            "#include <asm/time.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/cache.h>",
            "#include <asm/nvram.h>",
            "#include <asm/io.h>",
            "#include <asm/trace.h>",
            "#include <linux/processor.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/suspend.h>",
            "#include <linux/of_clk.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/delay.h>",
            "#include <linux/irq.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/rtc.h>",
            "#include <linux/percpu.h>",
            "#include <linux/security.h>",
            "#include <linux/cpu.h>",
            "#include <linux/profile.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/timex.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/param.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned long tb_ticks_per_usec = 100;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/dtl.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/clockchips.h>\n#include <asm/asm-prototypes.h>\n#include <asm/firmware.h>\n#include <asm/vdso_datapage.h>\n#include <asm/smp.h>\n#include <asm/div64.h>\n#include <asm/irq.h>\n#include <asm/prom.h>\n#include <asm/time.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/cache.h>\n#include <asm/nvram.h>\n#include <asm/io.h>\n#include <asm/trace.h>\n#include <linux/processor.h>\n#include <linux/sched/cputime.h>\n#include <linux/suspend.h>\n#include <linux/of_clk.h>\n#include <linux/irq_work.h>\n#include <linux/delay.h>\n#include <linux/irq.h>\n#include <linux/posix-timers.h>\n#include <linux/jiffies.h>\n#include <linux/rtc.h>\n#include <linux/percpu.h>\n#include <linux/security.h>\n#include <linux/cpu.h>\n#include <linux/profile.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/kernel_stat.h>\n#include <linux/timex.h>\n#include <linux/interrupt.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/param.h>\n#include <linux/kernel.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/errno.h>\n\nunsigned long tb_ticks_per_usec = 100;\n\nvoid udelay(unsigned long usecs)\n{\n\t__delay(tb_ticks_per_usec * usecs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HMT_low",
          "args": [],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_function_entry",
          "args": [
            "generic_secondary_smp_init"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "use_spinloop",
          "args": [],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "use_spinloop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "430-448",
          "snippet": "static bool use_spinloop(void)\n{\n\tif (IS_ENABLED(CONFIG_PPC_BOOK3S)) {\n\t\t/*\n\t\t * See comments in head_64.S -- not all platforms insert\n\t\t * secondaries at __secondary_hold and wait at the spin\n\t\t * loop.\n\t\t */\n\t\tif (firmware_has_feature(FW_FEATURE_OPAL))\n\t\t\treturn false;\n\t\treturn true;\n\t}\n\n\t/*\n\t * When book3e boots from kexec, the ePAPR spin table does\n\t * not get used.\n\t */\n\treturn of_property_read_bool(of_chosen, \"linux,booted-from-kexec\");\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic bool use_spinloop(void)\n{\n\tif (IS_ENABLED(CONFIG_PPC_BOOK3S)) {\n\t\t/*\n\t\t * See comments in head_64.S -- not all platforms insert\n\t\t * secondaries at __secondary_hold and wait at the spin\n\t\t * loop.\n\t\t */\n\t\tif (firmware_has_feature(FW_FEATURE_OPAL))\n\t\t\treturn false;\n\t\treturn true;\n\t}\n\n\t/*\n\t * When book3e boots from kexec, the ePAPR spin table does\n\t * not get used.\n\t */\n\treturn of_property_read_bool(of_chosen, \"linux,booted-from-kexec\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nint spinning_secondaries;\n\nvoid smp_release_cpus(void)\n{\n\tunsigned long *ptr;\n\tint i;\n\n\tif (!use_spinloop())\n\t\treturn;\n\n\t/* All secondary cpus are spinning on a common spinloop, release them\n\t * all now so they can start to spin on their individual paca\n\t * spinloops. For non SMP kernels, the secondary cpus never get out\n\t * of the common spinloop.\n\t */\n\n\tptr  = (unsigned long *)((unsigned long)&__secondary_hold_spinloop\n\t\t\t- PHYSICAL_START);\n\t*ptr = ppc_function_entry(generic_secondary_smp_init);\n\n\t/* And wait a bit for them to catch up */\n\tfor (i = 0; i < 100000; i++) {\n\t\tmb();\n\t\tHMT_low();\n\t\tif (spinning_secondaries == 0)\n\t\t\tbreak;\n\t\tudelay(1);\n\t}\n\tpr_debug(\"spinning_secondaries = %d\\n\", spinning_secondaries);\n}"
  },
  {
    "function_name": "use_spinloop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "430-448",
    "snippet": "static bool use_spinloop(void)\n{\n\tif (IS_ENABLED(CONFIG_PPC_BOOK3S)) {\n\t\t/*\n\t\t * See comments in head_64.S -- not all platforms insert\n\t\t * secondaries at __secondary_hold and wait at the spin\n\t\t * loop.\n\t\t */\n\t\tif (firmware_has_feature(FW_FEATURE_OPAL))\n\t\t\treturn false;\n\t\treturn true;\n\t}\n\n\t/*\n\t * When book3e boots from kexec, the ePAPR spin table does\n\t * not get used.\n\t */\n\treturn of_property_read_bool(of_chosen, \"linux,booted-from-kexec\");\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_property_read_bool",
          "args": [
            "of_chosen",
            "\"linux,booted-from-kexec\""
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_OPAL"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_BOOK3S"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic bool use_spinloop(void)\n{\n\tif (IS_ENABLED(CONFIG_PPC_BOOK3S)) {\n\t\t/*\n\t\t * See comments in head_64.S -- not all platforms insert\n\t\t * secondaries at __secondary_hold and wait at the spin\n\t\t * loop.\n\t\t */\n\t\tif (firmware_has_feature(FW_FEATURE_OPAL))\n\t\t\treturn false;\n\t\treturn true;\n\t}\n\n\t/*\n\t * When book3e boots from kexec, the ePAPR spin table does\n\t * not get used.\n\t */\n\treturn of_property_read_bool(of_chosen, \"linux,booted-from-kexec\");\n}"
  },
  {
    "function_name": "panic_smp_self_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "421-427",
    "snippet": "void panic_smp_self_stop(void)\n{\n\thard_irq_disable();\n\tspin_begin();\n\twhile (1)\n\t\tspin_cpu_relax();\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_cpu_relax",
          "args": [],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_begin",
          "args": [],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hard_irq_disable",
          "args": [],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid panic_smp_self_stop(void)\n{\n\thard_irq_disable();\n\tspin_begin();\n\twhile (1)\n\t\tspin_cpu_relax();\n}"
  },
  {
    "function_name": "early_setup_secondary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "400-417",
    "snippet": "void early_setup_secondary(void)\n{\n\t/* Mark interrupts disabled in PACA */\n\tirq_soft_mask_set(IRQS_DISABLED);\n\n\t/* Initialize the hash table or TLB handling */\n\tearly_init_mmu_secondary();\n\n\t/* Perform any KUP setup that is per-cpu */\n\tsetup_kup();\n\n\t/*\n\t * At this point, we can let interrupts switch to virtual mode\n\t * (the MMU has been setup), so adjust the MSR in the PACA to\n\t * have IR and DR set.\n\t */\n\tcpu_ready_for_interrupts();\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_ready_for_interrupts",
          "args": [],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_ready_for_interrupts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "225-257",
          "snippet": "static void cpu_ready_for_interrupts(void)\n{\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. This\n\t * is called once for every processor.\n\t *\n\t * If we are not in hypervisor mode the job is done once for\n\t * the whole partition in configure_exceptions().\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n\n\t/*\n\t * Set HFSCR:TM based on CPU features:\n\t * In the special case of TM no suspend (P9N DD2.1), Linux is\n\t * told TM is off via the dt-ftrs but told to (partially) use\n\t * it via OPAL_REINIT_CPUS_TM_SUSPEND_DISABLED. So HFSCR[TM]\n\t * will be off from dt-ftrs but we need to turn it on for the\n\t * no suspend case.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE)) {\n\t\tif (cpu_has_feature(CPU_FTR_TM_COMP))\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) | HFSCR_TM);\n\t\telse\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) & ~HFSCR_TM);\n\t}\n\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void cpu_ready_for_interrupts(void)\n{\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. This\n\t * is called once for every processor.\n\t *\n\t * If we are not in hypervisor mode the job is done once for\n\t * the whole partition in configure_exceptions().\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n\n\t/*\n\t * Set HFSCR:TM based on CPU features:\n\t * In the special case of TM no suspend (P9N DD2.1), Linux is\n\t * told TM is off via the dt-ftrs but told to (partially) use\n\t * it via OPAL_REINIT_CPUS_TM_SUSPEND_DISABLED. So HFSCR[TM]\n\t * will be off from dt-ftrs but we need to turn it on for the\n\t * no suspend case.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE)) {\n\t\tif (cpu_has_feature(CPU_FTR_TM_COMP))\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) | HFSCR_TM);\n\t\telse\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) & ~HFSCR_TM);\n\t}\n\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_kup",
          "args": [],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_init_mmu_secondary",
          "args": [],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_soft_mask_set",
          "args": [
            "IRQS_DISABLED"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid early_setup_secondary(void)\n{\n\t/* Mark interrupts disabled in PACA */\n\tirq_soft_mask_set(IRQS_DISABLED);\n\n\t/* Initialize the hash table or TLB handling */\n\tearly_init_mmu_secondary();\n\n\t/* Perform any KUP setup that is per-cpu */\n\tsetup_kup();\n\n\t/*\n\t * At this point, we can let interrupts switch to virtual mode\n\t * (the MMU has been setup), so adjust the MSR in the PACA to\n\t * have IR and DR set.\n\t */\n\tcpu_ready_for_interrupts();\n}"
  },
  {
    "function_name": "early_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "286-397",
    "snippet": "__nostackprotector early_setup(unsigned long dt_ptr)\n{\n\tstatic __initdata struct paca_struct boot_paca;\n\n\t/* -------- printk is _NOT_ safe to use here ! ------- */\n\n\t/*\n\t * Assume we're on cpu 0 for now.\n\t *\n\t * We need to load a PACA very early for a few reasons.\n\t *\n\t * The stack protector canary is stored in the paca, so as soon as we\n\t * call any stack protected code we need r13 pointing somewhere valid.\n\t *\n\t * If we are using kcov it will call in_task() in its instrumentation,\n\t * which relies on the current task from the PACA.\n\t *\n\t * dt_cpu_ftrs_init() calls into generic OF/fdt code, as well as\n\t * printk(), which can trigger both stack protector and kcov.\n\t *\n\t * percpu variables and spin locks also use the paca.\n\t *\n\t * So set up a temporary paca. It will be replaced below once we know\n\t * what CPU we are on.\n\t */\n\tinitialise_paca(&boot_paca, 0);\n\tsetup_paca(&boot_paca);\n\tfixup_boot_paca();\n\n\t/* -------- printk is now safe to use ------- */\n\n\t/* Try new device tree based feature discovery ... */\n\tif (!dt_cpu_ftrs_init(__va(dt_ptr)))\n\t\t/* Otherwise use the old style CPU table */\n\t\tidentify_cpu(0, mfspr(SPRN_PVR));\n\n\t/* Enable early debugging if any specified (see udbg.h) */\n\tudbg_early_init();\n\n\tudbg_printf(\" -> %s(), dt_ptr: 0x%lx\\n\", __func__, dt_ptr);\n\n\t/*\n\t * Do early initialization using the flattened device\n\t * tree, such as retrieving the physical memory map or\n\t * calculating/retrieving the hash table size.\n\t */\n\tearly_init_devtree(__va(dt_ptr));\n\n\t/* Now we know the logical id of our boot cpu, setup the paca. */\n\tif (boot_cpuid != 0) {\n\t\t/* Poison paca_ptrs[0] again if it's not the boot cpu */\n\t\tmemset(&paca_ptrs[0], 0x88, sizeof(paca_ptrs[0]));\n\t}\n\tsetup_paca(paca_ptrs[boot_cpuid]);\n\tfixup_boot_paca();\n\n\t/*\n\t * Configure exception handlers. This include setting up trampolines\n\t * if needed, setting exception endian mode, etc...\n\t */\n\tconfigure_exceptions();\n\n\t/*\n\t * Configure Kernel Userspace Protection. This needs to happen before\n\t * feature fixups for platforms that implement this using features.\n\t */\n\tsetup_kup();\n\n\t/* Apply all the dynamic patching */\n\tapply_feature_fixups();\n\tsetup_feature_keys();\n\n\tearly_ioremap_setup();\n\n\t/* Initialize the hash table or TLB handling */\n\tearly_init_mmu();\n\n\t/*\n\t * After firmware and early platform setup code has set things up,\n\t * we note the SPR values for configurable control/performance\n\t * registers, and use those as initial defaults.\n\t */\n\trecord_spr_defaults();\n\n\t/*\n\t * At this point, we can let interrupts switch to virtual mode\n\t * (the MMU has been setup), so adjust the MSR in the PACA to\n\t * have IR and DR set and enable AIL if it exists\n\t */\n\tcpu_ready_for_interrupts();\n\n\t/*\n\t * We enable ftrace here, but since we only support DYNAMIC_FTRACE, it\n\t * will only actually get enabled on the boot cpu much later once\n\t * ftrace itself has been initialized.\n\t */\n\tthis_cpu_enable_ftrace();\n\n\tudbg_printf(\" <- %s()\\n\", __func__);\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t/*\n\t * This needs to be done *last* (after the above udbg_printf() even)\n\t *\n\t * Right after we return from this function, we turn on the MMU\n\t * which means the real-mode access trick that btext does will\n\t * no longer work, it needs to switch to using a real MMU\n\t * mapping. This call will ensure that it does\n\t */\n\tbtext_map();\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "btext_map",
          "args": [],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "btext_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/btext.c",
          "lines": "153-171",
          "snippet": "void btext_map(void)\n{\n\tunsigned long base, offset, size;\n\tunsigned char *vbase;\n\n\t/* By default, we are no longer mapped */\n\tboot_text_mapped = 0;\n\tif (!dispDeviceBase)\n\t\treturn;\n\tbase = ((unsigned long) dispDeviceBase) & 0xFFFFF000UL;\n\toffset = ((unsigned long) dispDeviceBase) - base;\n\tsize = dispDeviceRowBytes * dispDeviceRect[3] + offset\n\t\t+ dispDeviceRect[0];\n\tvbase = ioremap_wc(base, size);\n\tif (!vbase)\n\t\treturn;\n\tlogicalDisplayBase = vbase + offset;\n\tboot_text_mapped = 1;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/btext.h>",
            "#include <asm/prom.h>",
            "#include <asm/sections.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int dispDeviceRowBytes",
            "static int dispDeviceRect[4]",
            "static unsigned char *dispDeviceBase",
            "static unsigned char *logicalDisplayBase",
            "int boot_text_mapped"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/btext.h>\n#include <asm/prom.h>\n#include <asm/sections.h>\n#include <linux/pgtable.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int dispDeviceRowBytes;\nstatic int dispDeviceRect[4];\nstatic unsigned char *dispDeviceBase;\nstatic unsigned char *logicalDisplayBase;\nint boot_text_mapped;\n\nvoid btext_map(void)\n{\n\tunsigned long base, offset, size;\n\tunsigned char *vbase;\n\n\t/* By default, we are no longer mapped */\n\tboot_text_mapped = 0;\n\tif (!dispDeviceBase)\n\t\treturn;\n\tbase = ((unsigned long) dispDeviceBase) & 0xFFFFF000UL;\n\toffset = ((unsigned long) dispDeviceBase) - base;\n\tsize = dispDeviceRowBytes * dispDeviceRect[3] + offset\n\t\t+ dispDeviceRect[0];\n\tvbase = ioremap_wc(base, size);\n\tif (!vbase)\n\t\treturn;\n\tlogicalDisplayBase = vbase + offset;\n\tboot_text_mapped = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "udbg_printf",
          "args": [
            "\" <- %s()\\n\"",
            "__func__"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg.c",
          "lines": "121-132",
          "snippet": "void udbg_printf(const char *fmt, ...)\n{\n\tif (udbg_putc) {\n\t\tchar buf[UDBG_BUFSIZE];\n\t\tva_list args;\n\n\t\tva_start(args, fmt);\n\t\tvsnprintf(buf, UDBG_BUFSIZE, fmt, args);\n\t\tudbg_puts(buf);\n\t\tva_end(args);\n\t}\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define UDBG_BUFSIZE 256"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n#include <stdarg.h>\n\n#define UDBG_BUFSIZE 256\n\nvoid udbg_printf(const char *fmt, ...)\n{\n\tif (udbg_putc) {\n\t\tchar buf[UDBG_BUFSIZE];\n\t\tva_list args;\n\n\t\tva_start(args, fmt);\n\t\tvsnprintf(buf, UDBG_BUFSIZE, fmt, args);\n\t\tudbg_puts(buf);\n\t\tva_end(args);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "this_cpu_enable_ftrace",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_ready_for_interrupts",
          "args": [],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_ready_for_interrupts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "225-257",
          "snippet": "static void cpu_ready_for_interrupts(void)\n{\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. This\n\t * is called once for every processor.\n\t *\n\t * If we are not in hypervisor mode the job is done once for\n\t * the whole partition in configure_exceptions().\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n\n\t/*\n\t * Set HFSCR:TM based on CPU features:\n\t * In the special case of TM no suspend (P9N DD2.1), Linux is\n\t * told TM is off via the dt-ftrs but told to (partially) use\n\t * it via OPAL_REINIT_CPUS_TM_SUSPEND_DISABLED. So HFSCR[TM]\n\t * will be off from dt-ftrs but we need to turn it on for the\n\t * no suspend case.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE)) {\n\t\tif (cpu_has_feature(CPU_FTR_TM_COMP))\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) | HFSCR_TM);\n\t\telse\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) & ~HFSCR_TM);\n\t}\n\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void cpu_ready_for_interrupts(void)\n{\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. This\n\t * is called once for every processor.\n\t *\n\t * If we are not in hypervisor mode the job is done once for\n\t * the whole partition in configure_exceptions().\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n\n\t/*\n\t * Set HFSCR:TM based on CPU features:\n\t * In the special case of TM no suspend (P9N DD2.1), Linux is\n\t * told TM is off via the dt-ftrs but told to (partially) use\n\t * it via OPAL_REINIT_CPUS_TM_SUSPEND_DISABLED. So HFSCR[TM]\n\t * will be off from dt-ftrs but we need to turn it on for the\n\t * no suspend case.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE)) {\n\t\tif (cpu_has_feature(CPU_FTR_TM_COMP))\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) | HFSCR_TM);\n\t\telse\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) & ~HFSCR_TM);\n\t}\n\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "record_spr_defaults",
          "args": [],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "record_spr_defaults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "261-265",
          "snippet": "void __init record_spr_defaults(void)\n{\n\tif (early_cpu_has_feature(CPU_FTR_DSCR))\n\t\tspr_default_dscr = mfspr(SPRN_DSCR);\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned long spr_default_dscr = 0;",
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nunsigned long spr_default_dscr = 0;\nvoid __init;\n\nvoid __init record_spr_defaults(void)\n{\n\tif (early_cpu_has_feature(CPU_FTR_DSCR))\n\t\tspr_default_dscr = mfspr(SPRN_DSCR);\n}"
        }
      },
      {
        "call_info": {
          "callee": "early_init_mmu",
          "args": [],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_ioremap_setup",
          "args": [],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_feature_keys",
          "args": [],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "apply_feature_fixups",
          "args": [],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_kup",
          "args": [],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "configure_exceptions",
          "args": [],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "configure_exceptions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "189-223",
          "snippet": "static void __init configure_exceptions(void)\n{\n\t/*\n\t * Setup the trampolines from the lowmem exception vectors\n\t * to the kdump kernel when not using a relocatable kernel.\n\t */\n\tsetup_kdump_trampoline();\n\n\t/* Under a PAPR hypervisor, we need hypercalls */\n\tif (firmware_has_feature(FW_FEATURE_SET_MODE)) {\n\t\t/* Enable AIL if possible */\n\t\tif (!pseries_enable_reloc_on_exc()) {\n\t\t\tinit_task.thread.fscr &= ~FSCR_SCV;\n\t\t\tcur_cpu_spec->cpu_user_features2 &= ~PPC_FEATURE2_SCV;\n\t\t}\n\n\t\t/*\n\t\t * Tell the hypervisor that we want our exceptions to\n\t\t * be taken in little endian mode.\n\t\t *\n\t\t * We don't call this for big endian as our calling convention\n\t\t * makes us always enter in BE, and the call may fail under\n\t\t * some circumstances with kdump.\n\t\t */\n#ifdef __LITTLE_ENDIAN__\n\t\tpseries_little_endian_exceptions();\n#endif\n\t} else {\n\t\t/* Set endian mode using OPAL */\n\t\tif (firmware_has_feature(FW_FEATURE_OPAL))\n\t\t\topal_configure_cores();\n\n\t\t/* AIL on native is done in cpu_ready_for_interrupts() */\n\t}\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void __init configure_exceptions(void)\n{\n\t/*\n\t * Setup the trampolines from the lowmem exception vectors\n\t * to the kdump kernel when not using a relocatable kernel.\n\t */\n\tsetup_kdump_trampoline();\n\n\t/* Under a PAPR hypervisor, we need hypercalls */\n\tif (firmware_has_feature(FW_FEATURE_SET_MODE)) {\n\t\t/* Enable AIL if possible */\n\t\tif (!pseries_enable_reloc_on_exc()) {\n\t\t\tinit_task.thread.fscr &= ~FSCR_SCV;\n\t\t\tcur_cpu_spec->cpu_user_features2 &= ~PPC_FEATURE2_SCV;\n\t\t}\n\n\t\t/*\n\t\t * Tell the hypervisor that we want our exceptions to\n\t\t * be taken in little endian mode.\n\t\t *\n\t\t * We don't call this for big endian as our calling convention\n\t\t * makes us always enter in BE, and the call may fail under\n\t\t * some circumstances with kdump.\n\t\t */\n#ifdef __LITTLE_ENDIAN__\n\t\tpseries_little_endian_exceptions();\n#endif\n\t} else {\n\t\t/* Set endian mode using OPAL */\n\t\tif (firmware_has_feature(FW_FEATURE_OPAL))\n\t\t\topal_configure_cores();\n\n\t\t/* AIL on native is done in cpu_ready_for_interrupts() */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fixup_boot_paca",
          "args": [],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_boot_paca",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
          "lines": "179-187",
          "snippet": "static void __init fixup_boot_paca(void)\n{\n\t/* The boot cpu is started */\n\tget_paca()->cpu_start = 1;\n\t/* Allow percpu accesses to work until we setup percpu data */\n\tget_paca()->data_offset = 0;\n\t/* Mark interrupts disabled in PACA */\n\tirq_soft_mask_set(IRQS_DISABLED);\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/early_ioremap.h>",
            "#include <asm/kup.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/opal.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/kexec.h>",
            "#include <asm/udbg.h>",
            "#include <asm/xmon.h>",
            "#include <asm/firmware.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/sections.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/paca.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memory.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/pci.h>",
            "#include <linux/memblock.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/tty.h>",
            "#include <linux/utsname.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void __init fixup_boot_paca(void)\n{\n\t/* The boot cpu is started */\n\tget_paca()->cpu_start = 1;\n\t/* Allow percpu accesses to work until we setup percpu data */\n\tget_paca()->data_offset = 0;\n\t/* Mark interrupts disabled in PACA */\n\tirq_soft_mask_set(IRQS_DISABLED);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_paca",
          "args": [
            "paca_ptrs[boot_cpuid]"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "setup_paca",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/paca.c",
          "lines": "244-266",
          "snippet": "void __nostackprotector setup_paca(struct paca_struct *new_paca)\n{\n\t/* Setup r13 */\n\tlocal_paca = new_paca;\n\n#ifdef CONFIG_PPC_BOOK3E\n\t/* On Book3E, initialize the TLB miss exception frames */\n\tmtspr(SPRN_SPRG_TLB_EXFRAME, local_paca->extlb);\n#else\n\t/*\n\t * In HV mode, we setup both HPACA and PACA to avoid problems\n\t * if we do a GET_PACA() before the feature fixups have been\n\t * applied.\n\t *\n\t * Normally you should test against CPU_FTR_HVMODE, but CPU features\n\t * are not yet set up when we first reach here.\n\t */\n\tif (mfmsr() & MSR_HV)\n\t\tmtspr(SPRN_SPRG_HPACA, local_paca);\n#endif\n\tmtspr(SPRN_SPRG_PACA, local_paca);\n\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/rtas.h>",
            "#include <asm/ultravisor.h>",
            "#include <asm/svm.h>",
            "#include <asm/kexec.h>",
            "#include <asm/sections.h>",
            "#include <asm/paca.h>",
            "#include <asm/lppaca.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/numa.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/smp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/rtas.h>\n#include <asm/ultravisor.h>\n#include <asm/svm.h>\n#include <asm/kexec.h>\n#include <asm/sections.h>\n#include <asm/paca.h>\n#include <asm/lppaca.h>\n#include <linux/pgtable.h>\n#include <linux/numa.h>\n#include <linux/sched/task.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/smp.h>\n\nvoid __nostackprotector setup_paca(struct paca_struct *new_paca)\n{\n\t/* Setup r13 */\n\tlocal_paca = new_paca;\n\n#ifdef CONFIG_PPC_BOOK3E\n\t/* On Book3E, initialize the TLB miss exception frames */\n\tmtspr(SPRN_SPRG_TLB_EXFRAME, local_paca->extlb);\n#else\n\t/*\n\t * In HV mode, we setup both HPACA and PACA to avoid problems\n\t * if we do a GET_PACA() before the feature fixups have been\n\t * applied.\n\t *\n\t * Normally you should test against CPU_FTR_HVMODE, but CPU features\n\t * are not yet set up when we first reach here.\n\t */\n\tif (mfmsr() & MSR_HV)\n\t\tmtspr(SPRN_SPRG_HPACA, local_paca);\n#endif\n\tmtspr(SPRN_SPRG_PACA, local_paca);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&paca_ptrs[0]",
            "0x88",
            "sizeof(paca_ptrs[0])"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "122-147",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "early_init_devtree",
          "args": [
            "__va(dt_ptr)"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "early_init_devtree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom.c",
          "lines": "715-842",
          "snippet": "void __init early_init_devtree(void *params)\n{\n\tphys_addr_t limit;\n\n\tDBG(\" -> early_init_devtree(%px)\\n\", params);\n\n\t/* Too early to BUG_ON(), do it by hand */\n\tif (!early_init_dt_verify(params))\n\t\tpanic(\"BUG: Failed verifying flat device tree, bad version?\");\n\n#ifdef CONFIG_PPC_RTAS\n\t/* Some machines might need RTAS info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_rtas, NULL);\n#endif\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Some machines might need OPAL info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_opal, NULL);\n\n\t/* Scan tree for ultravisor feature */\n\tof_scan_flat_dt(early_init_dt_scan_ultravisor, NULL);\n#endif\n\n#if defined(CONFIG_FA_DUMP) || defined(CONFIG_PRESERVE_FA_DUMP)\n\t/* scan tree to see if dump is active during last boot */\n\tof_scan_flat_dt(early_init_dt_scan_fw_dump, NULL);\n#endif\n\n\t/* Retrieve various informations from the /chosen node of the\n\t * device-tree, including the platform type, initrd location and\n\t * size, TCE reserve, and more ...\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_chosen_ppc, boot_command_line);\n\n\t/* Scan memory nodes and rebuild MEMBLOCKs */\n\tof_scan_flat_dt(early_init_dt_scan_root, NULL);\n\tof_scan_flat_dt(early_init_dt_scan_memory_ppc, NULL);\n\n\tparse_early_param();\n\n\t/* make sure we've parsed cmdline for mem= before this */\n\tif (memory_limit)\n\t\tfirst_memblock_size = min_t(u64, first_memblock_size, memory_limit);\n\tsetup_initial_memory_limit(memstart_addr, first_memblock_size);\n\t/* Reserve MEMBLOCK regions used by kernel, initrd, dt, etc... */\n\tmemblock_reserve(PHYSICAL_START, __pa(klimit) - PHYSICAL_START);\n\t/* If relocatable, reserve first 32k for interrupt vectors etc. */\n\tif (PHYSICAL_START > MEMORY_START)\n\t\tmemblock_reserve(MEMORY_START, 0x8000);\n\treserve_kdump_trampoline();\n#if defined(CONFIG_FA_DUMP) || defined(CONFIG_PRESERVE_FA_DUMP)\n\t/*\n\t * If we fail to reserve memory for firmware-assisted dump then\n\t * fallback to kexec based kdump.\n\t */\n\tif (fadump_reserve_mem() == 0)\n#endif\n\t\treserve_crashkernel();\n\tearly_reserve_mem();\n\n\t/* Ensure that total memory size is page-aligned. */\n\tlimit = ALIGN(memory_limit ?: memblock_phys_mem_size(), PAGE_SIZE);\n\tmemblock_enforce_memory_limit(limit);\n\n#if defined(CONFIG_PPC_BOOK3S_64) && defined(CONFIG_PPC_4K_PAGES)\n\tif (!early_radix_enabled())\n\t\tmemblock_cap_memory_range(0, 1UL << (H_MAX_PHYSMEM_BITS));\n#endif\n\n\tmemblock_allow_resize();\n\tmemblock_dump_all();\n\n\tDBG(\"Phys. mem: %llx\\n\", (unsigned long long)memblock_phys_mem_size());\n\n\t/* We may need to relocate the flat tree, do it now.\n\t * FIXME .. and the initrd too? */\n\tmove_device_tree();\n\n\tallocate_paca_ptrs();\n\n\tDBG(\"Scanning CPUs ...\\n\");\n\n\tdt_cpu_ftrs_scan();\n\n\t/* Retrieve CPU related informations from the flat tree\n\t * (altivec support, boot CPU ID, ...)\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_cpus, NULL);\n\tif (boot_cpuid < 0) {\n\t\tprintk(\"Failed to identify boot CPU !\\n\");\n\t\tBUG();\n\t}\n\n\tsave_fscr_to_task();\n\n#if defined(CONFIG_SMP) && defined(CONFIG_PPC64)\n\t/* We'll later wait for secondaries to check in; there are\n\t * NCPUS-1 non-boot CPUs  :-)\n\t */\n\tspinning_secondaries = boot_cpu_count - 1;\n#endif\n\n\tmmu_early_init_devtree();\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Scan and build the list of machine check recoverable ranges */\n\tof_scan_flat_dt(early_init_dt_scan_recoverable_ranges, NULL);\n#endif\n\tepapr_paravirt_early_init();\n\n\t/* Now try to figure out if we are running on LPAR and so on */\n\tpseries_probe_fw_features();\n\n\t/*\n\t * Initialize pkey features and default AMR/IAMR values\n\t */\n\tpkey_early_init_devtree();\n\n#ifdef CONFIG_PPC_PS3\n\t/* Identify PS3 firmware */\n\tif (of_flat_dt_is_compatible(of_get_flat_dt_root(), \"sony,ps3\"))\n\t\tpowerpc_firmware_features |= FW_FEATURE_PS3_POSSIBLE;\n#endif\n\n\ttm_init();\n\n\tDBG(\" <- early_init_devtree()\\n\");\n}",
          "includes": [
            "#include <mm/mmu_decl.h>",
            "#include <asm/ultravisor.h>",
            "#include <asm/drmem.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/firmware.h>",
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/fadump.h>",
            "#include <asm/opal.h>",
            "#include <asm/kexec.h>",
            "#include <asm/pci-bridge.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/powernv.h>",
            "#include <asm/paca.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/cpu.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/of_fdt.h>",
            "#include <linux/of.h>",
            "#include <linux/memblock.h>",
            "#include <linux/irq.h>",
            "#include <linux/kexec.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static phys_addr_t first_memblock_size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mm/mmu_decl.h>\n#include <asm/ultravisor.h>\n#include <asm/drmem.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/firmware.h>\n#include <asm/epapr_hcalls.h>\n#include <asm/fadump.h>\n#include <asm/opal.h>\n#include <asm/kexec.h>\n#include <asm/pci-bridge.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/powernv.h>\n#include <asm/paca.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/cpu.h>\n#include <linux/libfdt.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/memblock.h>\n#include <linux/irq.h>\n#include <linux/kexec.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic phys_addr_t first_memblock_size;\n\nvoid __init early_init_devtree(void *params)\n{\n\tphys_addr_t limit;\n\n\tDBG(\" -> early_init_devtree(%px)\\n\", params);\n\n\t/* Too early to BUG_ON(), do it by hand */\n\tif (!early_init_dt_verify(params))\n\t\tpanic(\"BUG: Failed verifying flat device tree, bad version?\");\n\n#ifdef CONFIG_PPC_RTAS\n\t/* Some machines might need RTAS info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_rtas, NULL);\n#endif\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Some machines might need OPAL info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_opal, NULL);\n\n\t/* Scan tree for ultravisor feature */\n\tof_scan_flat_dt(early_init_dt_scan_ultravisor, NULL);\n#endif\n\n#if defined(CONFIG_FA_DUMP) || defined(CONFIG_PRESERVE_FA_DUMP)\n\t/* scan tree to see if dump is active during last boot */\n\tof_scan_flat_dt(early_init_dt_scan_fw_dump, NULL);\n#endif\n\n\t/* Retrieve various informations from the /chosen node of the\n\t * device-tree, including the platform type, initrd location and\n\t * size, TCE reserve, and more ...\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_chosen_ppc, boot_command_line);\n\n\t/* Scan memory nodes and rebuild MEMBLOCKs */\n\tof_scan_flat_dt(early_init_dt_scan_root, NULL);\n\tof_scan_flat_dt(early_init_dt_scan_memory_ppc, NULL);\n\n\tparse_early_param();\n\n\t/* make sure we've parsed cmdline for mem= before this */\n\tif (memory_limit)\n\t\tfirst_memblock_size = min_t(u64, first_memblock_size, memory_limit);\n\tsetup_initial_memory_limit(memstart_addr, first_memblock_size);\n\t/* Reserve MEMBLOCK regions used by kernel, initrd, dt, etc... */\n\tmemblock_reserve(PHYSICAL_START, __pa(klimit) - PHYSICAL_START);\n\t/* If relocatable, reserve first 32k for interrupt vectors etc. */\n\tif (PHYSICAL_START > MEMORY_START)\n\t\tmemblock_reserve(MEMORY_START, 0x8000);\n\treserve_kdump_trampoline();\n#if defined(CONFIG_FA_DUMP) || defined(CONFIG_PRESERVE_FA_DUMP)\n\t/*\n\t * If we fail to reserve memory for firmware-assisted dump then\n\t * fallback to kexec based kdump.\n\t */\n\tif (fadump_reserve_mem() == 0)\n#endif\n\t\treserve_crashkernel();\n\tearly_reserve_mem();\n\n\t/* Ensure that total memory size is page-aligned. */\n\tlimit = ALIGN(memory_limit ?: memblock_phys_mem_size(), PAGE_SIZE);\n\tmemblock_enforce_memory_limit(limit);\n\n#if defined(CONFIG_PPC_BOOK3S_64) && defined(CONFIG_PPC_4K_PAGES)\n\tif (!early_radix_enabled())\n\t\tmemblock_cap_memory_range(0, 1UL << (H_MAX_PHYSMEM_BITS));\n#endif\n\n\tmemblock_allow_resize();\n\tmemblock_dump_all();\n\n\tDBG(\"Phys. mem: %llx\\n\", (unsigned long long)memblock_phys_mem_size());\n\n\t/* We may need to relocate the flat tree, do it now.\n\t * FIXME .. and the initrd too? */\n\tmove_device_tree();\n\n\tallocate_paca_ptrs();\n\n\tDBG(\"Scanning CPUs ...\\n\");\n\n\tdt_cpu_ftrs_scan();\n\n\t/* Retrieve CPU related informations from the flat tree\n\t * (altivec support, boot CPU ID, ...)\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_cpus, NULL);\n\tif (boot_cpuid < 0) {\n\t\tprintk(\"Failed to identify boot CPU !\\n\");\n\t\tBUG();\n\t}\n\n\tsave_fscr_to_task();\n\n#if defined(CONFIG_SMP) && defined(CONFIG_PPC64)\n\t/* We'll later wait for secondaries to check in; there are\n\t * NCPUS-1 non-boot CPUs  :-)\n\t */\n\tspinning_secondaries = boot_cpu_count - 1;\n#endif\n\n\tmmu_early_init_devtree();\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Scan and build the list of machine check recoverable ranges */\n\tof_scan_flat_dt(early_init_dt_scan_recoverable_ranges, NULL);\n#endif\n\tepapr_paravirt_early_init();\n\n\t/* Now try to figure out if we are running on LPAR and so on */\n\tpseries_probe_fw_features();\n\n\t/*\n\t * Initialize pkey features and default AMR/IAMR values\n\t */\n\tpkey_early_init_devtree();\n\n#ifdef CONFIG_PPC_PS3\n\t/* Identify PS3 firmware */\n\tif (of_flat_dt_is_compatible(of_get_flat_dt_root(), \"sony,ps3\"))\n\t\tpowerpc_firmware_features |= FW_FEATURE_PS3_POSSIBLE;\n#endif\n\n\ttm_init();\n\n\tDBG(\" <- early_init_devtree()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "dt_ptr"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udbg_early_init",
          "args": [],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_early_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg.c",
          "lines": "25-77",
          "snippet": "void __init udbg_early_init(void)\n{\n#if defined(CONFIG_PPC_EARLY_DEBUG_LPAR)\n\t/* For LPAR machines that have an HVC console on vterm 0 */\n\tudbg_init_debug_lpar();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_LPAR_HVSI)\n\t/* For LPAR machines that have an HVSI console on vterm 0 */\n\tudbg_init_debug_lpar_hvsi();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_G5)\n\t/* For use on Apple G5 machines */\n\tudbg_init_pmac_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_PANEL)\n\t/* RTAS panel debug */\n\tudbg_init_rtas_panel();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_CONSOLE)\n\t/* RTAS console debug */\n\tudbg_init_rtas_console();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MAPLE)\n\t/* Maple real mode debug */\n\tudbg_init_maple_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PAS_REALMODE)\n\tudbg_init_pas_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_BOOTX)\n\tudbg_init_btext();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_44x)\n\t/* PPC44x debug */\n\tudbg_init_44x_as1();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_40x)\n\t/* PPC40x debug */\n\tudbg_init_40x_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_CPM)\n\tudbg_init_cpm();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_USBGECKO)\n\tudbg_init_usbgecko();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MEMCONS)\n\t/* In memory console */\n\tudbg_init_memcons();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_EHV_BC)\n\tudbg_init_ehv_bc();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PS3GELIC)\n\tudbg_init_ps3gelic();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_RAW)\n\tudbg_init_debug_opal_raw();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_HVSI)\n\tudbg_init_debug_opal_hvsi();\n#endif\n\n#ifdef CONFIG_PPC_EARLY_DEBUG\n\tconsole_loglevel = CONSOLE_LOGLEVEL_DEBUG;\n\n\tregister_early_udbg_console();\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n#include <stdarg.h>\n\nvoid __init udbg_early_init(void)\n{\n#if defined(CONFIG_PPC_EARLY_DEBUG_LPAR)\n\t/* For LPAR machines that have an HVC console on vterm 0 */\n\tudbg_init_debug_lpar();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_LPAR_HVSI)\n\t/* For LPAR machines that have an HVSI console on vterm 0 */\n\tudbg_init_debug_lpar_hvsi();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_G5)\n\t/* For use on Apple G5 machines */\n\tudbg_init_pmac_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_PANEL)\n\t/* RTAS panel debug */\n\tudbg_init_rtas_panel();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_CONSOLE)\n\t/* RTAS console debug */\n\tudbg_init_rtas_console();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MAPLE)\n\t/* Maple real mode debug */\n\tudbg_init_maple_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PAS_REALMODE)\n\tudbg_init_pas_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_BOOTX)\n\tudbg_init_btext();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_44x)\n\t/* PPC44x debug */\n\tudbg_init_44x_as1();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_40x)\n\t/* PPC40x debug */\n\tudbg_init_40x_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_CPM)\n\tudbg_init_cpm();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_USBGECKO)\n\tudbg_init_usbgecko();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MEMCONS)\n\t/* In memory console */\n\tudbg_init_memcons();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_EHV_BC)\n\tudbg_init_ehv_bc();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PS3GELIC)\n\tudbg_init_ps3gelic();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_RAW)\n\tudbg_init_debug_opal_raw();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_HVSI)\n\tudbg_init_debug_opal_hvsi();\n#endif\n\n#ifdef CONFIG_PPC_EARLY_DEBUG\n\tconsole_loglevel = CONSOLE_LOGLEVEL_DEBUG;\n\n\tregister_early_udbg_console();\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "identify_cpu",
          "args": [
            "0",
            "mfspr(SPRN_PVR)"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "identify_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cputable.c",
          "lines": "2167-2182",
          "snippet": "struct cpu_spec * __init identify_cpu(unsigned long offset, unsigned int pvr)\n{\n\tstruct cpu_spec *s = cpu_specs;\n\tint i;\n\n\ts = PTRRELOC(s);\n\n\tfor (i = 0; i < ARRAY_SIZE(cpu_specs); i++,s++) {\n\t\tif ((pvr & s->pvr_mask) == s->pvr_value)\n\t\t\treturn setup_cpu_spec(offset, s);\n\t}\n\n\tBUG();\n\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/prom.h>\t\t/* for PTRRELOC on ARCH=ppc */",
            "#include <asm/cputable.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/threads.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/prom.h>\t\t/* for PTRRELOC on ARCH=ppc */\n#include <asm/cputable.h>\n#include <asm/oprofile_impl.h>\n#include <linux/jump_label.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/threads.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n\nstruct cpu_spec * __init identify_cpu(unsigned long offset, unsigned int pvr)\n{\n\tstruct cpu_spec *s = cpu_specs;\n\tint i;\n\n\ts = PTRRELOC(s);\n\n\tfor (i = 0; i < ARRAY_SIZE(cpu_specs); i++,s++) {\n\t\tif ((pvr & s->pvr_mask) == s->pvr_value)\n\t\t\treturn setup_cpu_spec(offset, s);\n\t}\n\n\tBUG();\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_PVR"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_cpu_ftrs_init",
          "args": [
            "__va(dt_ptr)"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "dt_cpu_ftrs_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/dt_cpu_ftrs.c",
          "lines": "872-890",
          "snippet": "bool __init dt_cpu_ftrs_init(void *fdt)\n{\n\tusing_dt_cpu_ftrs = false;\n\n\t/* Setup and verify the FDT, if it fails we just bail */\n\tif (!early_init_dt_verify(fdt))\n\t\treturn false;\n\n\tif (!of_scan_flat_dt(fdt_find_cpu_features, NULL))\n\t\treturn false;\n\n\tif (disabled_on_cmdline())\n\t\treturn false;\n\n\tcpufeatures_setup_cpu();\n\n\tusing_dt_cpu_ftrs = true;\n\treturn true;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/prom.h>",
            "#include <asm/oprofile_impl.h>",
            "#include <asm/mmu.h>",
            "#include <asm/mce.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/cputable.h>",
            "#include <linux/threads.h>",
            "#include <linux/string.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/memblock.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/init.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/prom.h>\n#include <asm/oprofile_impl.h>\n#include <asm/mmu.h>\n#include <asm/mce.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <linux/threads.h>\n#include <linux/string.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/memblock.h>\n#include <linux/libfdt.h>\n#include <linux/jump_label.h>\n#include <linux/init.h>\n#include <linux/export.h>\n\nbool __init dt_cpu_ftrs_init(void *fdt)\n{\n\tusing_dt_cpu_ftrs = false;\n\n\t/* Setup and verify the FDT, if it fails we just bail */\n\tif (!early_init_dt_verify(fdt))\n\t\treturn false;\n\n\tif (!of_scan_flat_dt(fdt_find_cpu_features, NULL))\n\t\treturn false;\n\n\tif (disabled_on_cmdline())\n\t\treturn false;\n\n\tcpufeatures_setup_cpu();\n\n\tusing_dt_cpu_ftrs = true;\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "dt_ptr"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initialise_paca",
          "args": [
            "&boot_paca",
            "0"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "initialise_paca",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/paca.c",
          "lines": "211-241",
          "snippet": "__nostackprotector initialise_paca(struct paca_struct *new_paca, int cpu)\n{\n#ifdef CONFIG_PPC_PSERIES\n\tnew_paca->lppaca_ptr = NULL;\n#endif\n#ifdef CONFIG_PPC_BOOK3E\n\tnew_paca->kernel_pgd = swapper_pg_dir;\n#endif\n\tnew_paca->lock_token = 0x8000;\n\tnew_paca->paca_index = cpu;\n\tnew_paca->kernel_toc = kernel_toc_addr();\n\tnew_paca->kernelbase = (unsigned long) _stext;\n\t/* Only set MSR:IR/DR when MMU is initialized */\n\tnew_paca->kernel_msr = MSR_KERNEL & ~(MSR_IR | MSR_DR);\n\tnew_paca->hw_cpu_id = 0xffff;\n\tnew_paca->kexec_state = KEXEC_STATE_NONE;\n\tnew_paca->__current = &init_task;\n\tnew_paca->data_offset = 0xfeeeeeeeeeeeeeeeULL;\n#ifdef CONFIG_PPC_BOOK3S_64\n\tnew_paca->slb_shadow_ptr = NULL;\n#endif\n\n#ifdef CONFIG_PPC_BOOK3E\n\t/* For now -- if we have threads this will be adjusted later */\n\tnew_paca->tcd_ptr = &new_paca->tcd;\n#endif\n\n#ifdef CONFIG_PPC_PSERIES\n\tnew_paca->rtas_args_reentrant = NULL;\n#endif\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/rtas.h>",
            "#include <asm/ultravisor.h>",
            "#include <asm/svm.h>",
            "#include <asm/kexec.h>",
            "#include <asm/sections.h>",
            "#include <asm/paca.h>",
            "#include <asm/lppaca.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/numa.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/smp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/rtas.h>\n#include <asm/ultravisor.h>\n#include <asm/svm.h>\n#include <asm/kexec.h>\n#include <asm/sections.h>\n#include <asm/paca.h>\n#include <asm/lppaca.h>\n#include <linux/pgtable.h>\n#include <linux/numa.h>\n#include <linux/sched/task.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/smp.h>\n\n__nostackprotector initialise_paca(struct paca_struct *new_paca, int cpu)\n{\n#ifdef CONFIG_PPC_PSERIES\n\tnew_paca->lppaca_ptr = NULL;\n#endif\n#ifdef CONFIG_PPC_BOOK3E\n\tnew_paca->kernel_pgd = swapper_pg_dir;\n#endif\n\tnew_paca->lock_token = 0x8000;\n\tnew_paca->paca_index = cpu;\n\tnew_paca->kernel_toc = kernel_toc_addr();\n\tnew_paca->kernelbase = (unsigned long) _stext;\n\t/* Only set MSR:IR/DR when MMU is initialized */\n\tnew_paca->kernel_msr = MSR_KERNEL & ~(MSR_IR | MSR_DR);\n\tnew_paca->hw_cpu_id = 0xffff;\n\tnew_paca->kexec_state = KEXEC_STATE_NONE;\n\tnew_paca->__current = &init_task;\n\tnew_paca->data_offset = 0xfeeeeeeeeeeeeeeeULL;\n#ifdef CONFIG_PPC_BOOK3S_64\n\tnew_paca->slb_shadow_ptr = NULL;\n#endif\n\n#ifdef CONFIG_PPC_BOOK3E\n\t/* For now -- if we have threads this will be adjusted later */\n\tnew_paca->tcd_ptr = &new_paca->tcd;\n#endif\n\n#ifdef CONFIG_PPC_PSERIES\n\tnew_paca->rtas_args_reentrant = NULL;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\n__nostackprotector early_setup(unsigned long dt_ptr)\n{\n\tstatic __initdata struct paca_struct boot_paca;\n\n\t/* -------- printk is _NOT_ safe to use here ! ------- */\n\n\t/*\n\t * Assume we're on cpu 0 for now.\n\t *\n\t * We need to load a PACA very early for a few reasons.\n\t *\n\t * The stack protector canary is stored in the paca, so as soon as we\n\t * call any stack protected code we need r13 pointing somewhere valid.\n\t *\n\t * If we are using kcov it will call in_task() in its instrumentation,\n\t * which relies on the current task from the PACA.\n\t *\n\t * dt_cpu_ftrs_init() calls into generic OF/fdt code, as well as\n\t * printk(), which can trigger both stack protector and kcov.\n\t *\n\t * percpu variables and spin locks also use the paca.\n\t *\n\t * So set up a temporary paca. It will be replaced below once we know\n\t * what CPU we are on.\n\t */\n\tinitialise_paca(&boot_paca, 0);\n\tsetup_paca(&boot_paca);\n\tfixup_boot_paca();\n\n\t/* -------- printk is now safe to use ------- */\n\n\t/* Try new device tree based feature discovery ... */\n\tif (!dt_cpu_ftrs_init(__va(dt_ptr)))\n\t\t/* Otherwise use the old style CPU table */\n\t\tidentify_cpu(0, mfspr(SPRN_PVR));\n\n\t/* Enable early debugging if any specified (see udbg.h) */\n\tudbg_early_init();\n\n\tudbg_printf(\" -> %s(), dt_ptr: 0x%lx\\n\", __func__, dt_ptr);\n\n\t/*\n\t * Do early initialization using the flattened device\n\t * tree, such as retrieving the physical memory map or\n\t * calculating/retrieving the hash table size.\n\t */\n\tearly_init_devtree(__va(dt_ptr));\n\n\t/* Now we know the logical id of our boot cpu, setup the paca. */\n\tif (boot_cpuid != 0) {\n\t\t/* Poison paca_ptrs[0] again if it's not the boot cpu */\n\t\tmemset(&paca_ptrs[0], 0x88, sizeof(paca_ptrs[0]));\n\t}\n\tsetup_paca(paca_ptrs[boot_cpuid]);\n\tfixup_boot_paca();\n\n\t/*\n\t * Configure exception handlers. This include setting up trampolines\n\t * if needed, setting exception endian mode, etc...\n\t */\n\tconfigure_exceptions();\n\n\t/*\n\t * Configure Kernel Userspace Protection. This needs to happen before\n\t * feature fixups for platforms that implement this using features.\n\t */\n\tsetup_kup();\n\n\t/* Apply all the dynamic patching */\n\tapply_feature_fixups();\n\tsetup_feature_keys();\n\n\tearly_ioremap_setup();\n\n\t/* Initialize the hash table or TLB handling */\n\tearly_init_mmu();\n\n\t/*\n\t * After firmware and early platform setup code has set things up,\n\t * we note the SPR values for configurable control/performance\n\t * registers, and use those as initial defaults.\n\t */\n\trecord_spr_defaults();\n\n\t/*\n\t * At this point, we can let interrupts switch to virtual mode\n\t * (the MMU has been setup), so adjust the MSR in the PACA to\n\t * have IR and DR set and enable AIL if it exists\n\t */\n\tcpu_ready_for_interrupts();\n\n\t/*\n\t * We enable ftrace here, but since we only support DYNAMIC_FTRACE, it\n\t * will only actually get enabled on the boot cpu much later once\n\t * ftrace itself has been initialized.\n\t */\n\tthis_cpu_enable_ftrace();\n\n\tudbg_printf(\" <- %s()\\n\", __func__);\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t/*\n\t * This needs to be done *last* (after the above udbg_printf() even)\n\t *\n\t * Right after we return from this function, we turn on the MMU\n\t * which means the real-mode access trick that btext does will\n\t * no longer work, it needs to switch to using a real MMU\n\t * mapping. This call will ensure that it does\n\t */\n\tbtext_map();\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n}"
  },
  {
    "function_name": "record_spr_defaults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "261-265",
    "snippet": "void __init record_spr_defaults(void)\n{\n\tif (early_cpu_has_feature(CPU_FTR_DSCR))\n\t\tspr_default_dscr = mfspr(SPRN_DSCR);\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long spr_default_dscr = 0;",
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_DSCR"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_cpu_has_feature",
          "args": [
            "CPU_FTR_DSCR"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nunsigned long spr_default_dscr = 0;\nvoid __init;\n\nvoid __init record_spr_defaults(void)\n{\n\tif (early_cpu_has_feature(CPU_FTR_DSCR))\n\t\tspr_default_dscr = mfspr(SPRN_DSCR);\n}"
  },
  {
    "function_name": "cpu_ready_for_interrupts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "225-257",
    "snippet": "static void cpu_ready_for_interrupts(void)\n{\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. This\n\t * is called once for every processor.\n\t *\n\t * If we are not in hypervisor mode the job is done once for\n\t * the whole partition in configure_exceptions().\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n\n\t/*\n\t * Set HFSCR:TM based on CPU features:\n\t * In the special case of TM no suspend (P9N DD2.1), Linux is\n\t * told TM is off via the dt-ftrs but told to (partially) use\n\t * it via OPAL_REINIT_CPUS_TM_SUSPEND_DISABLED. So HFSCR[TM]\n\t * will be off from dt-ftrs but we need to turn it on for the\n\t * no suspend case.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE)) {\n\t\tif (cpu_has_feature(CPU_FTR_TM_COMP))\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) | HFSCR_TM);\n\t\telse\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) & ~HFSCR_TM);\n\t}\n\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_HFSCR",
            "mfspr(SPRN_HFSCR) & ~HFSCR_TM"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_HFSCR"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_HFSCR",
            "mfspr(SPRN_HFSCR) | HFSCR_TM"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_HFSCR"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_TM_COMP"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_HVMODE"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtspr",
          "args": [
            "SPRN_LPCR",
            "lpcr | LPCR_AIL_3"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mfspr",
          "args": [
            "SPRN_LPCR"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_ARCH_207S"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_HVMODE"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstatic void cpu_ready_for_interrupts(void)\n{\n\t/*\n\t * Enable AIL if supported, and we are in hypervisor mode. This\n\t * is called once for every processor.\n\t *\n\t * If we are not in hypervisor mode the job is done once for\n\t * the whole partition in configure_exceptions().\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE) &&\n\t    cpu_has_feature(CPU_FTR_ARCH_207S)) {\n\t\tunsigned long lpcr = mfspr(SPRN_LPCR);\n\t\tmtspr(SPRN_LPCR, lpcr | LPCR_AIL_3);\n\t}\n\n\t/*\n\t * Set HFSCR:TM based on CPU features:\n\t * In the special case of TM no suspend (P9N DD2.1), Linux is\n\t * told TM is off via the dt-ftrs but told to (partially) use\n\t * it via OPAL_REINIT_CPUS_TM_SUSPEND_DISABLED. So HFSCR[TM]\n\t * will be off from dt-ftrs but we need to turn it on for the\n\t * no suspend case.\n\t */\n\tif (cpu_has_feature(CPU_FTR_HVMODE)) {\n\t\tif (cpu_has_feature(CPU_FTR_TM_COMP))\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) | HFSCR_TM);\n\t\telse\n\t\t\tmtspr(SPRN_HFSCR, mfspr(SPRN_HFSCR) & ~HFSCR_TM);\n\t}\n\n\t/* Set IR and DR in PACA MSR */\n\tget_paca()->kernel_msr = MSR_KERNEL;\n}"
  },
  {
    "function_name": "configure_exceptions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "189-223",
    "snippet": "static void __init configure_exceptions(void)\n{\n\t/*\n\t * Setup the trampolines from the lowmem exception vectors\n\t * to the kdump kernel when not using a relocatable kernel.\n\t */\n\tsetup_kdump_trampoline();\n\n\t/* Under a PAPR hypervisor, we need hypercalls */\n\tif (firmware_has_feature(FW_FEATURE_SET_MODE)) {\n\t\t/* Enable AIL if possible */\n\t\tif (!pseries_enable_reloc_on_exc()) {\n\t\t\tinit_task.thread.fscr &= ~FSCR_SCV;\n\t\t\tcur_cpu_spec->cpu_user_features2 &= ~PPC_FEATURE2_SCV;\n\t\t}\n\n\t\t/*\n\t\t * Tell the hypervisor that we want our exceptions to\n\t\t * be taken in little endian mode.\n\t\t *\n\t\t * We don't call this for big endian as our calling convention\n\t\t * makes us always enter in BE, and the call may fail under\n\t\t * some circumstances with kdump.\n\t\t */\n#ifdef __LITTLE_ENDIAN__\n\t\tpseries_little_endian_exceptions();\n#endif\n\t} else {\n\t\t/* Set endian mode using OPAL */\n\t\tif (firmware_has_feature(FW_FEATURE_OPAL))\n\t\t\topal_configure_cores();\n\n\t\t/* AIL on native is done in cpu_ready_for_interrupts() */\n\t}\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "opal_configure_cores",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_OPAL"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pseries_little_endian_exceptions",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pseries_enable_reloc_on_exc",
          "args": [],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "firmware_has_feature",
          "args": [
            "FW_FEATURE_SET_MODE"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_kdump_trampoline",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "setup_kdump_trampoline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/crash_dump.c",
          "lines": "52-68",
          "snippet": "void __init setup_kdump_trampoline(void)\n{\n\tunsigned long i;\n\n\tDBG(\" -> setup_kdump_trampoline()\\n\");\n\n\tfor (i = KDUMP_TRAMPOLINE_START; i < KDUMP_TRAMPOLINE_END; i += 8) {\n\t\tcreate_trampoline(i);\n\t}\n\n#ifdef CONFIG_PPC_PSERIES\n\tcreate_trampoline(__pa(system_reset_fwnmi) - PHYSICAL_START);\n\tcreate_trampoline(__pa(machine_check_fwnmi) - PHYSICAL_START);\n#endif /* CONFIG_PPC_PSERIES */\n\n\tDBG(\" <- setup_kdump_trampoline()\\n\");\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/inst.h>",
            "#include <asm/rtas.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/firmware.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/code-patching.h>",
            "#include <linux/memblock.h>",
            "#include <linux/io.h>",
            "#include <linux/crash_dump.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/inst.h>\n#include <asm/rtas.h>\n#include <linux/uaccess.h>\n#include <asm/firmware.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/code-patching.h>\n#include <linux/memblock.h>\n#include <linux/io.h>\n#include <linux/crash_dump.h>\n\nvoid __init setup_kdump_trampoline(void)\n{\n\tunsigned long i;\n\n\tDBG(\" -> setup_kdump_trampoline()\\n\");\n\n\tfor (i = KDUMP_TRAMPOLINE_START; i < KDUMP_TRAMPOLINE_END; i += 8) {\n\t\tcreate_trampoline(i);\n\t}\n\n#ifdef CONFIG_PPC_PSERIES\n\tcreate_trampoline(__pa(system_reset_fwnmi) - PHYSICAL_START);\n\tcreate_trampoline(__pa(machine_check_fwnmi) - PHYSICAL_START);\n#endif /* CONFIG_PPC_PSERIES */\n\n\tDBG(\" <- setup_kdump_trampoline()\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void __init configure_exceptions(void)\n{\n\t/*\n\t * Setup the trampolines from the lowmem exception vectors\n\t * to the kdump kernel when not using a relocatable kernel.\n\t */\n\tsetup_kdump_trampoline();\n\n\t/* Under a PAPR hypervisor, we need hypercalls */\n\tif (firmware_has_feature(FW_FEATURE_SET_MODE)) {\n\t\t/* Enable AIL if possible */\n\t\tif (!pseries_enable_reloc_on_exc()) {\n\t\t\tinit_task.thread.fscr &= ~FSCR_SCV;\n\t\t\tcur_cpu_spec->cpu_user_features2 &= ~PPC_FEATURE2_SCV;\n\t\t}\n\n\t\t/*\n\t\t * Tell the hypervisor that we want our exceptions to\n\t\t * be taken in little endian mode.\n\t\t *\n\t\t * We don't call this for big endian as our calling convention\n\t\t * makes us always enter in BE, and the call may fail under\n\t\t * some circumstances with kdump.\n\t\t */\n#ifdef __LITTLE_ENDIAN__\n\t\tpseries_little_endian_exceptions();\n#endif\n\t} else {\n\t\t/* Set endian mode using OPAL */\n\t\tif (firmware_has_feature(FW_FEATURE_OPAL))\n\t\t\topal_configure_cores();\n\n\t\t/* AIL on native is done in cpu_ready_for_interrupts() */\n\t}\n}"
  },
  {
    "function_name": "fixup_boot_paca",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "179-187",
    "snippet": "static void __init fixup_boot_paca(void)\n{\n\t/* The boot cpu is started */\n\tget_paca()->cpu_start = 1;\n\t/* Allow percpu accesses to work until we setup percpu data */\n\tget_paca()->data_offset = 0;\n\t/* Mark interrupts disabled in PACA */\n\tirq_soft_mask_set(IRQS_DISABLED);\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_soft_mask_set",
          "args": [
            "IRQS_DISABLED"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_paca",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic void __init fixup_boot_paca(void)\n{\n\t/* The boot cpu is started */\n\tget_paca()->cpu_start = 1;\n\t/* Allow percpu accesses to work until we setup percpu data */\n\tget_paca()->data_offset = 0;\n\t/* Mark interrupts disabled in PACA */\n\tirq_soft_mask_set(IRQS_DISABLED);\n}"
  },
  {
    "function_name": "early_smt_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "169-173",
    "snippet": "static int __init early_smt_enabled(char *p)\n{\n\tsmt_enabled_cmdline = p;\n\treturn 0;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nstatic int __init early_smt_enabled(char *p)\n{\n\tsmt_enabled_cmdline = p;\n\treturn 0;\n}"
  },
  {
    "function_name": "check_smt_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "127-166",
    "snippet": "void __init check_smt_enabled(void)\n{\n\tstruct device_node *dn;\n\tconst char *smt_option;\n\n\t/* Default to enabling all threads */\n\tsmt_enabled_at_boot = threads_per_core;\n\n\t/* Allow the command line to overrule the OF option */\n\tif (smt_enabled_cmdline) {\n\t\tif (!strcmp(smt_enabled_cmdline, \"on\"))\n\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\telse if (!strcmp(smt_enabled_cmdline, \"off\"))\n\t\t\tsmt_enabled_at_boot = 0;\n\t\telse {\n\t\t\tint smt;\n\t\t\tint rc;\n\n\t\t\trc = kstrtoint(smt_enabled_cmdline, 10, &smt);\n\t\t\tif (!rc)\n\t\t\t\tsmt_enabled_at_boot =\n\t\t\t\t\tmin(threads_per_core, smt);\n\t\t}\n\t} else {\n\t\tdn = of_find_node_by_path(\"/options\");\n\t\tif (dn) {\n\t\t\tsmt_option = of_get_property(dn, \"ibm,smt-enabled\",\n\t\t\t\t\t\t     NULL);\n\n\t\t\tif (smt_option) {\n\t\t\t\tif (!strcmp(smt_option, \"on\"))\n\t\t\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\t\t\telse if (!strcmp(smt_option, \"off\"))\n\t\t\t\t\tsmt_enabled_at_boot = 0;\n\t\t\t}\n\n\t\t\tof_node_put(dn);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "dn"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "smt_option",
            "\"off\""
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "dn",
            "\"ibm,smt-enabled\"",
            "NULL"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_find_node_by_path",
          "args": [
            "\"/options\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "threads_per_core",
            "smt"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrtoint",
          "args": [
            "smt_enabled_cmdline",
            "10",
            "&smt"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init check_smt_enabled(void)\n{\n\tstruct device_node *dn;\n\tconst char *smt_option;\n\n\t/* Default to enabling all threads */\n\tsmt_enabled_at_boot = threads_per_core;\n\n\t/* Allow the command line to overrule the OF option */\n\tif (smt_enabled_cmdline) {\n\t\tif (!strcmp(smt_enabled_cmdline, \"on\"))\n\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\telse if (!strcmp(smt_enabled_cmdline, \"off\"))\n\t\t\tsmt_enabled_at_boot = 0;\n\t\telse {\n\t\t\tint smt;\n\t\t\tint rc;\n\n\t\t\trc = kstrtoint(smt_enabled_cmdline, 10, &smt);\n\t\t\tif (!rc)\n\t\t\t\tsmt_enabled_at_boot =\n\t\t\t\t\tmin(threads_per_core, smt);\n\t\t}\n\t} else {\n\t\tdn = of_find_node_by_path(\"/options\");\n\t\tif (dn) {\n\t\t\tsmt_option = of_get_property(dn, \"ibm,smt-enabled\",\n\t\t\t\t\t\t     NULL);\n\n\t\t\tif (smt_option) {\n\t\t\t\tif (!strcmp(smt_option, \"on\"))\n\t\t\t\t\tsmt_enabled_at_boot = threads_per_core;\n\t\t\t\telse if (!strcmp(smt_option, \"off\"))\n\t\t\t\t\tsmt_enabled_at_boot = 0;\n\t\t\t}\n\n\t\t\tof_node_put(dn);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "setup_tlb_core_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_64.c",
    "lines": "89-119",
    "snippet": "void __init setup_tlb_core_data(void)\n{\n\tint cpu;\n\n\tBUILD_BUG_ON(offsetof(struct tlb_core_data, lock) != 0);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tint first = cpu_first_thread_sibling(cpu);\n\n\t\t/*\n\t\t * If we boot via kdump on a non-primary thread,\n\t\t * make sure we point at the thread that actually\n\t\t * set up this TLB.\n\t\t */\n\t\tif (cpu_first_thread_sibling(boot_cpuid) == first)\n\t\t\tfirst = boot_cpuid;\n\n\t\tpaca_ptrs[cpu]->tcd_ptr = &paca_ptrs[first]->tcd;\n\n\t\t/*\n\t\t * If we have threads, we need either tlbsrx.\n\t\t * or e6500 tablewalk mode, or else TLB handlers\n\t\t * will be racy and could produce duplicate entries.\n\t\t * Should we panic instead?\n\t\t */\n\t\tWARN_ONCE(smt_enabled_at_boot >= 2 &&\n\t\t\t  !mmu_has_feature(MMU_FTR_USE_TLBRSRV) &&\n\t\t\t  book3e_htw_mode != PPC_HTW_E6500,\n\t\t\t  \"%s: unsupported MMU configuration\\n\", __func__);\n\t}\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/early_ioremap.h>",
      "#include <asm/kup.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/hw_irq.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/opal.h>",
      "#include <asm/livepatch.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/kexec.h>",
      "#include <asm/udbg.h>",
      "#include <asm/xmon.h>",
      "#include <asm/firmware.h>",
      "#include <asm/mmu.h>",
      "#include <asm/page.h>",
      "#include <asm/cache.h>",
      "#include <asm/serial.h>",
      "#include <asm/iommu.h>",
      "#include <asm/rtas.h>",
      "#include <asm/setup.h>",
      "#include <asm/nvram.h>",
      "#include <asm/btext.h>",
      "#include <asm/sections.h>",
      "#include <asm/dt_cpu_ftrs.h>",
      "#include <asm/cputable.h>",
      "#include <asm/time.h>",
      "#include <asm/paca.h>",
      "#include <asm/machdep.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/kdump.h>",
      "#include <asm/io.h>",
      "#include <asm/debugfs.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memory.h>",
      "#include <linux/lockdep.h>",
      "#include <linux/pci.h>",
      "#include <linux/memblock.h>",
      "#include <linux/serial_8250.h>",
      "#include <linux/serial.h>",
      "#include <linux/unistd.h>",
      "#include <linux/cpu.h>",
      "#include <linux/notifier.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/tty.h>",
      "#include <linux/utsname.h>",
      "#include <linux/console.h>",
      "#include <linux/ioport.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "smt_enabled_at_boot >= 2 &&\n\t\t\t  !mmu_has_feature(MMU_FTR_USE_TLBRSRV) &&\n\t\t\t  book3e_htw_mode != PPC_HTW_E6500",
            "\"%s: unsupported MMU configuration\\n\"",
            "__func__"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mmu_has_feature",
          "args": [
            "MMU_FTR_USE_TLBRSRV"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_first_thread_sibling",
          "args": [
            "boot_cpuid"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_first_thread_sibling",
          "args": [
            "cpu"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "offsetof(struct tlb_core_data, lock) != 0"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/pgalloc.h>\n#include <asm/early_ioremap.h>\n#include <asm/kup.h>\n#include <asm/feature-fixups.h>\n#include <asm/hw_irq.h>\n#include <asm/cputhreads.h>\n#include <asm/opal.h>\n#include <asm/livepatch.h>\n#include <asm/code-patching.h>\n#include <asm/kexec.h>\n#include <asm/udbg.h>\n#include <asm/xmon.h>\n#include <asm/firmware.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/sections.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/paca.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/nmi.h>\n#include <linux/memory.h>\n#include <linux/lockdep.h>\n#include <linux/pci.h>\n#include <linux/memblock.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/tty.h>\n#include <linux/utsname.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nvoid __init;\n\nvoid __init setup_tlb_core_data(void)\n{\n\tint cpu;\n\n\tBUILD_BUG_ON(offsetof(struct tlb_core_data, lock) != 0);\n\n\tfor_each_possible_cpu(cpu) {\n\t\tint first = cpu_first_thread_sibling(cpu);\n\n\t\t/*\n\t\t * If we boot via kdump on a non-primary thread,\n\t\t * make sure we point at the thread that actually\n\t\t * set up this TLB.\n\t\t */\n\t\tif (cpu_first_thread_sibling(boot_cpuid) == first)\n\t\t\tfirst = boot_cpuid;\n\n\t\tpaca_ptrs[cpu]->tcd_ptr = &paca_ptrs[first]->tcd;\n\n\t\t/*\n\t\t * If we have threads, we need either tlbsrx.\n\t\t * or e6500 tablewalk mode, or else TLB handlers\n\t\t * will be racy and could produce duplicate entries.\n\t\t * Should we panic instead?\n\t\t */\n\t\tWARN_ONCE(smt_enabled_at_boot >= 2 &&\n\t\t\t  !mmu_has_feature(MMU_FTR_USE_TLBRSRV) &&\n\t\t\t  book3e_htw_mode != PPC_HTW_E6500,\n\t\t\t  \"%s: unsupported MMU configuration\\n\", __func__);\n\t}\n}"
  }
]