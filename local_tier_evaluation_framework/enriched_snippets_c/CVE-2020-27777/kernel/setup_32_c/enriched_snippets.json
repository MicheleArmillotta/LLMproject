[
  {
    "function_name": "initialize_cache_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
    "lines": "216-228",
    "snippet": "__init void initialize_cache_info(void)\n{\n\t/*\n\t * Set cache line size based on type of cpu as a default.\n\t * Systems with OF can look in the properties on the cpu node(s)\n\t * for a possibly more accurate value.\n\t */\n\tdcache_bsize = cur_cpu_spec->dcache_bsize;\n\ticache_bsize = cur_cpu_spec->icache_bsize;\n\tucache_bsize = 0;\n\tif (IS_ENABLED(CONFIG_PPC_BOOK3S_601) || IS_ENABLED(CONFIG_E200))\n\t\tucache_bsize = icache_bsize = dcache_bsize;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/early_ioremap.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/kdump.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/udbg.h>",
      "#include <asm/serial.h>",
      "#include <asm/time.h>",
      "#include <asm/xmon.h>",
      "#include <asm/nvram.h>",
      "#include <asm/sections.h>",
      "#include <asm/pmac_feature.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/btext.h>",
      "#include <asm/bootx.h>",
      "#include <asm/cputable.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/setup.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nvram.h>",
      "#include <linux/export.h>",
      "#include <linux/memblock.h>",
      "#include <linux/console.h>",
      "#include <linux/cpu.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/tty.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_E200"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_BOOK3S_601"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\n__init void initialize_cache_info(void)\n{\n\t/*\n\t * Set cache line size based on type of cpu as a default.\n\t * Systems with OF can look in the properties on the cpu node(s)\n\t * for a possibly more accurate value.\n\t */\n\tdcache_bsize = cur_cpu_spec->dcache_bsize;\n\ticache_bsize = cur_cpu_spec->icache_bsize;\n\tucache_bsize = 0;\n\tif (IS_ENABLED(CONFIG_PPC_BOOK3S_601) || IS_ENABLED(CONFIG_E200))\n\t\tucache_bsize = icache_bsize = dcache_bsize;\n}"
  },
  {
    "function_name": "setup_power_save",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
    "lines": "201-214",
    "snippet": "void __init setup_power_save(void)\n{\n#ifdef CONFIG_PPC_BOOK3S_32\n\tif (cpu_has_feature(CPU_FTR_CAN_DOZE) ||\n\t    cpu_has_feature(CPU_FTR_CAN_NAP))\n\t\tppc_md.power_save = ppc6xx_idle;\n#endif\n\n#ifdef CONFIG_E500\n\tif (cpu_has_feature(CPU_FTR_CAN_DOZE) ||\n\t    cpu_has_feature(CPU_FTR_CAN_NAP))\n\t\tppc_md.power_save = e500_idle;\n#endif\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/early_ioremap.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/kdump.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/udbg.h>",
      "#include <asm/serial.h>",
      "#include <asm/time.h>",
      "#include <asm/xmon.h>",
      "#include <asm/nvram.h>",
      "#include <asm/sections.h>",
      "#include <asm/pmac_feature.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/btext.h>",
      "#include <asm/bootx.h>",
      "#include <asm/cputable.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/setup.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nvram.h>",
      "#include <linux/export.h>",
      "#include <linux/memblock.h>",
      "#include <linux/console.h>",
      "#include <linux/cpu.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/tty.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_CAN_NAP"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_CAN_DOZE"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_CAN_NAP"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_CAN_DOZE"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nvoid __init setup_power_save(void)\n{\n#ifdef CONFIG_PPC_BOOK3S_32\n\tif (cpu_has_feature(CPU_FTR_CAN_DOZE) ||\n\t    cpu_has_feature(CPU_FTR_CAN_NAP))\n\t\tppc_md.power_save = ppc6xx_idle;\n#endif\n\n#ifdef CONFIG_E500\n\tif (cpu_has_feature(CPU_FTR_CAN_DOZE) ||\n\t    cpu_has_feature(CPU_FTR_CAN_NAP))\n\t\tppc_md.power_save = e500_idle;\n#endif\n}"
  },
  {
    "function_name": "exc_lvl_early_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
    "lines": "179-198",
    "snippet": "void __init exc_lvl_early_init(void)\n{\n\tunsigned int i, hw_cpu;\n\n\t/* interrupt stacks must be in lowmem, we get that for free on ppc32\n\t * as the memblock is limited to lowmem by MEMBLOCK_REAL_LIMIT */\n\tfor_each_possible_cpu(i) {\n#ifdef CONFIG_SMP\n\t\thw_cpu = get_hard_smp_processor_id(i);\n#else\n\t\thw_cpu = 0;\n#endif\n\n\t\tcritirq_ctx[hw_cpu] = alloc_stack();\n#ifdef CONFIG_BOOKE\n\t\tdbgirq_ctx[hw_cpu] = alloc_stack();\n\t\tmcheckirq_ctx[hw_cpu] = alloc_stack();\n#endif\n\t}\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/early_ioremap.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/kdump.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/udbg.h>",
      "#include <asm/serial.h>",
      "#include <asm/time.h>",
      "#include <asm/xmon.h>",
      "#include <asm/nvram.h>",
      "#include <asm/sections.h>",
      "#include <asm/pmac_feature.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/btext.h>",
      "#include <asm/bootx.h>",
      "#include <asm/cputable.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/setup.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nvram.h>",
      "#include <linux/export.h>",
      "#include <linux/memblock.h>",
      "#include <linux/console.h>",
      "#include <linux/cpu.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/tty.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_stack",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
          "lines": "140-149",
          "snippet": "static void *__init alloc_stack(void)\n{\n\tvoid *ptr = memblock_alloc(THREAD_SIZE, THREAD_ALIGN);\n\n\tif (!ptr)\n\t\tpanic(\"cannot allocate %d bytes for stack at %pS\\n\",\n\t\t      THREAD_SIZE, (void *)_RET_IP_);\n\n\treturn ptr;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/early_ioremap.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/kdump.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/udbg.h>",
            "#include <asm/serial.h>",
            "#include <asm/time.h>",
            "#include <asm/xmon.h>",
            "#include <asm/nvram.h>",
            "#include <asm/sections.h>",
            "#include <asm/pmac_feature.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/btext.h>",
            "#include <asm/bootx.h>",
            "#include <asm/cputable.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/setup.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/io.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nvram.h>",
            "#include <linux/export.h>",
            "#include <linux/memblock.h>",
            "#include <linux/console.h>",
            "#include <linux/cpu.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/tty.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nstatic void *__init alloc_stack(void)\n{\n\tvoid *ptr = memblock_alloc(THREAD_SIZE, THREAD_ALIGN);\n\n\tif (!ptr)\n\t\tpanic(\"cannot allocate %d bytes for stack at %pS\\n\",\n\t\t      THREAD_SIZE, (void *)_RET_IP_);\n\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_hard_smp_processor_id",
          "args": [
            "i"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nvoid __init exc_lvl_early_init(void)\n{\n\tunsigned int i, hw_cpu;\n\n\t/* interrupt stacks must be in lowmem, we get that for free on ppc32\n\t * as the memblock is limited to lowmem by MEMBLOCK_REAL_LIMIT */\n\tfor_each_possible_cpu(i) {\n#ifdef CONFIG_SMP\n\t\thw_cpu = get_hard_smp_processor_id(i);\n#else\n\t\thw_cpu = 0;\n#endif\n\n\t\tcritirq_ctx[hw_cpu] = alloc_stack();\n#ifdef CONFIG_BOOKE\n\t\tdbgirq_ctx[hw_cpu] = alloc_stack();\n\t\tmcheckirq_ctx[hw_cpu] = alloc_stack();\n#endif\n\t}\n}"
  },
  {
    "function_name": "emergency_stack_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
    "lines": "169-175",
    "snippet": "void __init emergency_stack_init(void)\n{\n\tunsigned int i;\n\n\tfor_each_possible_cpu(i)\n\t\temergency_ctx[i] = alloc_stack();\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/early_ioremap.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/kdump.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/udbg.h>",
      "#include <asm/serial.h>",
      "#include <asm/time.h>",
      "#include <asm/xmon.h>",
      "#include <asm/nvram.h>",
      "#include <asm/sections.h>",
      "#include <asm/pmac_feature.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/btext.h>",
      "#include <asm/bootx.h>",
      "#include <asm/cputable.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/setup.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nvram.h>",
      "#include <linux/export.h>",
      "#include <linux/memblock.h>",
      "#include <linux/console.h>",
      "#include <linux/cpu.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/tty.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_stack",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
          "lines": "140-149",
          "snippet": "static void *__init alloc_stack(void)\n{\n\tvoid *ptr = memblock_alloc(THREAD_SIZE, THREAD_ALIGN);\n\n\tif (!ptr)\n\t\tpanic(\"cannot allocate %d bytes for stack at %pS\\n\",\n\t\t      THREAD_SIZE, (void *)_RET_IP_);\n\n\treturn ptr;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/early_ioremap.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/kdump.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/udbg.h>",
            "#include <asm/serial.h>",
            "#include <asm/time.h>",
            "#include <asm/xmon.h>",
            "#include <asm/nvram.h>",
            "#include <asm/sections.h>",
            "#include <asm/pmac_feature.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/btext.h>",
            "#include <asm/bootx.h>",
            "#include <asm/cputable.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/setup.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/io.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nvram.h>",
            "#include <linux/export.h>",
            "#include <linux/memblock.h>",
            "#include <linux/console.h>",
            "#include <linux/cpu.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/tty.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nstatic void *__init alloc_stack(void)\n{\n\tvoid *ptr = memblock_alloc(THREAD_SIZE, THREAD_ALIGN);\n\n\tif (!ptr)\n\t\tpanic(\"cannot allocate %d bytes for stack at %pS\\n\",\n\t\t      THREAD_SIZE, (void *)_RET_IP_);\n\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nvoid __init emergency_stack_init(void)\n{\n\tunsigned int i;\n\n\tfor_each_possible_cpu(i)\n\t\temergency_ctx[i] = alloc_stack();\n}"
  },
  {
    "function_name": "irqstack_early_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
    "lines": "151-164",
    "snippet": "void __init irqstack_early_init(void)\n{\n\tunsigned int i;\n\n\tif (IS_ENABLED(CONFIG_VMAP_STACK))\n\t\treturn;\n\n\t/* interrupt stacks must be in lowmem, we get that for free on ppc32\n\t * as the memblock is limited to lowmem by default */\n\tfor_each_possible_cpu(i) {\n\t\tsoftirq_ctx[i] = alloc_stack();\n\t\thardirq_ctx[i] = alloc_stack();\n\t}\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/early_ioremap.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/kdump.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/udbg.h>",
      "#include <asm/serial.h>",
      "#include <asm/time.h>",
      "#include <asm/xmon.h>",
      "#include <asm/nvram.h>",
      "#include <asm/sections.h>",
      "#include <asm/pmac_feature.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/btext.h>",
      "#include <asm/bootx.h>",
      "#include <asm/cputable.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/setup.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nvram.h>",
      "#include <linux/export.h>",
      "#include <linux/memblock.h>",
      "#include <linux/console.h>",
      "#include <linux/cpu.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/tty.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_stack",
          "args": [],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
          "lines": "140-149",
          "snippet": "static void *__init alloc_stack(void)\n{\n\tvoid *ptr = memblock_alloc(THREAD_SIZE, THREAD_ALIGN);\n\n\tif (!ptr)\n\t\tpanic(\"cannot allocate %d bytes for stack at %pS\\n\",\n\t\t      THREAD_SIZE, (void *)_RET_IP_);\n\n\treturn ptr;\n}",
          "includes": [
            "#include \"setup.h\"",
            "#include <asm/early_ioremap.h>",
            "#include <asm/feature-fixups.h>",
            "#include <asm/kdump.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/udbg.h>",
            "#include <asm/serial.h>",
            "#include <asm/time.h>",
            "#include <asm/xmon.h>",
            "#include <asm/nvram.h>",
            "#include <asm/sections.h>",
            "#include <asm/pmac_feature.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/machdep.h>",
            "#include <asm/btext.h>",
            "#include <asm/bootx.h>",
            "#include <asm/cputable.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/setup.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/io.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/nvram.h>",
            "#include <linux/export.h>",
            "#include <linux/memblock.h>",
            "#include <linux/console.h>",
            "#include <linux/cpu.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/tty.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nstatic void *__init alloc_stack(void)\n{\n\tvoid *ptr = memblock_alloc(THREAD_SIZE, THREAD_ALIGN);\n\n\tif (!ptr)\n\t\tpanic(\"cannot allocate %d bytes for stack at %pS\\n\",\n\t\t      THREAD_SIZE, (void *)_RET_IP_);\n\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_VMAP_STACK"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nvoid __init irqstack_early_init(void)\n{\n\tunsigned int i;\n\n\tif (IS_ENABLED(CONFIG_VMAP_STACK))\n\t\treturn;\n\n\t/* interrupt stacks must be in lowmem, we get that for free on ppc32\n\t * as the memblock is limited to lowmem by default */\n\tfor_each_possible_cpu(i) {\n\t\tsoftirq_ctx[i] = alloc_stack();\n\t\thardirq_ctx[i] = alloc_stack();\n\t}\n}"
  },
  {
    "function_name": "alloc_stack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
    "lines": "140-149",
    "snippet": "static void *__init alloc_stack(void)\n{\n\tvoid *ptr = memblock_alloc(THREAD_SIZE, THREAD_ALIGN);\n\n\tif (!ptr)\n\t\tpanic(\"cannot allocate %d bytes for stack at %pS\\n\",\n\t\t      THREAD_SIZE, (void *)_RET_IP_);\n\n\treturn ptr;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/early_ioremap.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/kdump.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/udbg.h>",
      "#include <asm/serial.h>",
      "#include <asm/time.h>",
      "#include <asm/xmon.h>",
      "#include <asm/nvram.h>",
      "#include <asm/sections.h>",
      "#include <asm/pmac_feature.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/btext.h>",
      "#include <asm/bootx.h>",
      "#include <asm/cputable.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/setup.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nvram.h>",
      "#include <linux/export.h>",
      "#include <linux/memblock.h>",
      "#include <linux/console.h>",
      "#include <linux/cpu.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/tty.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"cannot allocate %d bytes for stack at %pS\\n\"",
            "THREAD_SIZE",
            "(void *)_RET_IP_"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "ppc_panic_event",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup-common.c",
          "lines": "691-708",
          "snippet": "static int ppc_panic_event(struct notifier_block *this,\n                             unsigned long event, void *ptr)\n{\n\t/*\n\t * panic does a local_irq_disable, but we really\n\t * want interrupts to be hard disabled.\n\t */\n\thard_irq_disable();\n\n\t/*\n\t * If firmware-assisted dump has been registered then trigger\n\t * firmware-assisted dump and let firmware handle everything else.\n\t */\n\tcrash_fadump(NULL, ptr);\n\tif (ppc_md.panic)\n\t\tppc_md.panic(ptr);  /* May not return */\n\treturn NOTIFY_DONE;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include \"setup.h\"",
            "#include <asm/kasan.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/hugetlb.h>",
            "#include <asm/udbg.h>",
            "#include <asm/fadump.h>",
            "#include <mm/mmu_decl.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/xmon.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/cache.h>",
            "#include <asm/serial.h>",
            "#include <asm/iommu.h>",
            "#include <asm/rtas.h>",
            "#include <asm/setup.h>",
            "#include <asm/nvram.h>",
            "#include <asm/btext.h>",
            "#include <asm/firmware.h>",
            "#include <asm/sections.h>",
            "#include <asm/cputable.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/elf.h>",
            "#include <asm/smp.h>",
            "#include <asm/vdso_datapage.h>",
            "#include <asm/processor.h>",
            "#include <asm/prom.h>",
            "#include <asm/paca.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/of_platform.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/serial_8250.h>",
            "#include <linux/serial.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/root_dev.h>",
            "#include <linux/screen_info.h>",
            "#include <linux/console.h>",
            "#include <linux/ioport.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct machdep_calls ppc_md;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include \"setup.h\"\n#include <asm/kasan.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/mmu_context.h>\n#include <asm/livepatch.h>\n#include <asm/hugetlb.h>\n#include <asm/udbg.h>\n#include <asm/fadump.h>\n#include <mm/mmu_decl.h>\n#include <asm/cputhreads.h>\n#include <asm/xmon.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/cache.h>\n#include <asm/serial.h>\n#include <asm/iommu.h>\n#include <asm/rtas.h>\n#include <asm/setup.h>\n#include <asm/nvram.h>\n#include <asm/btext.h>\n#include <asm/firmware.h>\n#include <asm/sections.h>\n#include <asm/cputable.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/vdso_datapage.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/paca.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/pgtable.h>\n#include <linux/hugetlb.h>\n#include <linux/of_platform.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/serial_8250.h>\n#include <linux/serial.h>\n#include <linux/unistd.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/root_dev.h>\n#include <linux/screen_info.h>\n#include <linux/console.h>\n#include <linux/ioport.h>\n#include <linux/seq_file.h>\n#include <linux/platform_device.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/export.h>\n\nstruct machdep_calls ppc_md;\n\nstatic int ppc_panic_event(struct notifier_block *this,\n                             unsigned long event, void *ptr)\n{\n\t/*\n\t * panic does a local_irq_disable, but we really\n\t * want interrupts to be hard disabled.\n\t */\n\thard_irq_disable();\n\n\t/*\n\t * If firmware-assisted dump has been registered then trigger\n\t * firmware-assisted dump and let firmware handle everything else.\n\t */\n\tcrash_fadump(NULL, ptr);\n\tif (ppc_md.panic)\n\t\tppc_md.panic(ptr);  /* May not return */\n\treturn NOTIFY_DONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "THREAD_SIZE",
            "THREAD_ALIGN"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nstatic void *__init alloc_stack(void)\n{\n\tvoid *ptr = memblock_alloc(THREAD_SIZE, THREAD_ALIGN);\n\n\tif (!ptr)\n\t\tpanic(\"cannot allocate %d bytes for stack at %pS\\n\",\n\t\t      THREAD_SIZE, (void *)_RET_IP_);\n\n\treturn ptr;\n}"
  },
  {
    "function_name": "ppc_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
    "lines": "126-137",
    "snippet": "static int __init ppc_init(void)\n{\n\t/* clear the progress line */\n\tif (ppc_md.progress)\n\t\tppc_md.progress(\"             \", 0xffff);\n\n\t/* call platform init */\n\tif (ppc_md.init != NULL) {\n\t\tppc_md.init();\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/early_ioremap.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/kdump.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/udbg.h>",
      "#include <asm/serial.h>",
      "#include <asm/time.h>",
      "#include <asm/xmon.h>",
      "#include <asm/nvram.h>",
      "#include <asm/sections.h>",
      "#include <asm/pmac_feature.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/btext.h>",
      "#include <asm/bootx.h>",
      "#include <asm/cputable.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/setup.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nvram.h>",
      "#include <linux/export.h>",
      "#include <linux/memblock.h>",
      "#include <linux/console.h>",
      "#include <linux/cpu.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/tty.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ppc_md.init",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_md.progress",
          "args": [
            "\"             \"",
            "0xffff"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nstatic int __init ppc_init(void)\n{\n\t/* clear the progress line */\n\tif (ppc_md.progress)\n\t\tppc_md.progress(\"             \", 0xffff);\n\n\t/* call platform init */\n\tif (ppc_md.init != NULL) {\n\t\tppc_md.init();\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "ppc_setup_l3cr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
    "lines": "115-123",
    "snippet": "static int __init ppc_setup_l3cr(char *str)\n{\n\tif (cpu_has_feature(CPU_FTR_L3CR)) {\n\t\tunsigned long val = simple_strtoul(str, NULL, 0);\n\t\tprintk(KERN_INFO \"l3cr set to %lx\\n\", val);\n\t\t_set_L3CR(val);\t\t/* and enable it */\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/early_ioremap.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/kdump.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/udbg.h>",
      "#include <asm/serial.h>",
      "#include <asm/time.h>",
      "#include <asm/xmon.h>",
      "#include <asm/nvram.h>",
      "#include <asm/sections.h>",
      "#include <asm/pmac_feature.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/btext.h>",
      "#include <asm/bootx.h>",
      "#include <asm/cputable.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/setup.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nvram.h>",
      "#include <linux/export.h>",
      "#include <linux/memblock.h>",
      "#include <linux/console.h>",
      "#include <linux/cpu.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/tty.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_set_L3CR",
          "args": [
            "val"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"l3cr set to %lx\\n\"",
            "val"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "110-157",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/topology.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool full_rtas_msgs;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <linux/topology.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic bool full_rtas_msgs;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "str",
            "NULL",
            "0"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_L3CR"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nstatic int __init ppc_setup_l3cr(char *str)\n{\n\tif (cpu_has_feature(CPU_FTR_L3CR)) {\n\t\tunsigned long val = simple_strtoul(str, NULL, 0);\n\t\tprintk(KERN_INFO \"l3cr set to %lx\\n\", val);\n\t\t_set_L3CR(val);\t\t/* and enable it */\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "ppc_setup_l2cr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
    "lines": "102-111",
    "snippet": "static int __init ppc_setup_l2cr(char *str)\n{\n\tif (cpu_has_feature(CPU_FTR_L2CR)) {\n\t\tunsigned long val = simple_strtoul(str, NULL, 0);\n\t\tprintk(KERN_INFO \"l2cr set to %lx\\n\", val);\n\t\t_set_L2CR(0);\t\t/* force invalidate by disable cache */\n\t\t_set_L2CR(val);\t\t/* and enable it */\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/early_ioremap.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/kdump.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/udbg.h>",
      "#include <asm/serial.h>",
      "#include <asm/time.h>",
      "#include <asm/xmon.h>",
      "#include <asm/nvram.h>",
      "#include <asm/sections.h>",
      "#include <asm/pmac_feature.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/btext.h>",
      "#include <asm/bootx.h>",
      "#include <asm/cputable.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/setup.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nvram.h>",
      "#include <linux/export.h>",
      "#include <linux/memblock.h>",
      "#include <linux/console.h>",
      "#include <linux/cpu.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/tty.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_set_L2CR",
          "args": [
            "val"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_set_L2CR",
          "args": [
            "0"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"l2cr set to %lx\\n\"",
            "val"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "printk_log_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/rtasd.c",
          "lines": "110-157",
          "snippet": "static void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}",
          "includes": [
            "#include <asm/topology.h>",
            "#include <asm/machdep.h>",
            "#include <linux/atomic.h>",
            "#include <asm/nvram.h>",
            "#include <asm/prom.h>",
            "#include <asm/rtas.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/topology.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/cpu.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool full_rtas_msgs;",
            "static int error_log_cnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/topology.h>\n#include <asm/machdep.h>\n#include <linux/atomic.h>\n#include <asm/nvram.h>\n#include <asm/prom.h>\n#include <asm/rtas.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <linux/topology.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/cpu.h>\n#include <linux/spinlock.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/types.h>\n\nstatic bool full_rtas_msgs;\nstatic int error_log_cnt;\n\nstatic void printk_log_rtas(char *buf, int len)\n{\n\n\tint i,j,n = 0;\n\tint perline = 16;\n\tchar buffer[64];\n\tchar * str = \"RTAS event\";\n\n\tif (full_rtas_msgs) {\n\t\tprintk(RTAS_DEBUG \"%d -------- %s begin --------\\n\",\n\t\t       error_log_cnt, str);\n\n\t\t/*\n\t\t * Print perline bytes on each line, each line will start\n\t\t * with RTAS and a changing number, so syslogd will\n\t\t * print lines that are otherwise the same.  Separate every\n\t\t * 4 bytes with a space.\n\t\t */\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tj = i % perline;\n\t\t\tif (j == 0) {\n\t\t\t\tmemset(buffer, 0, sizeof(buffer));\n\t\t\t\tn = sprintf(buffer, \"RTAS %d:\", i/perline);\n\t\t\t}\n\n\t\t\tif ((i % 4) == 0)\n\t\t\t\tn += sprintf(buffer+n, \" \");\n\n\t\t\tn += sprintf(buffer+n, \"%02x\", (unsigned char)buf[i]);\n\n\t\t\tif (j == (perline-1))\n\t\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\t\t}\n\t\tif ((i % perline) != 0)\n\t\t\tprintk(KERN_DEBUG \"%s\\n\", buffer);\n\n\t\tprintk(RTAS_DEBUG \"%d -------- %s end ----------\\n\",\n\t\t       error_log_cnt, str);\n\t} else {\n\t\tstruct rtas_error_log *errlog = (struct rtas_error_log *)buf;\n\n\t\tprintk(RTAS_DEBUG \"event: %d, Type: %s (%d), Severity: %d\\n\",\n\t\t       error_log_cnt,\n\t\t       rtas_event_type(rtas_error_type(errlog)),\n\t\t       rtas_error_type(errlog),\n\t\t       rtas_error_severity(errlog));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "str",
            "NULL",
            "0"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_has_feature",
          "args": [
            "CPU_FTR_L2CR"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nstatic int __init ppc_setup_l2cr(char *str)\n{\n\tif (cpu_has_feature(CPU_FTR_L2CR)) {\n\t\tunsigned long val = simple_strtoul(str, NULL, 0);\n\t\tprintk(KERN_INFO \"l2cr set to %lx\\n\", val);\n\t\t_set_L2CR(0);\t\t/* force invalidate by disable cache */\n\t\t_set_L2CR(val);\t\t/* and enable it */\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "machine_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/setup_32.c",
    "lines": "75-99",
    "snippet": "__init machine_init(u64 dt_ptr)\n{\n\tstruct ppc_inst *addr = (struct ppc_inst *)patch_site_addr(&patch__memset_nocache);\n\tstruct ppc_inst insn;\n\n\t/* Configure static keys first, now that we're relocated. */\n\tsetup_feature_keys();\n\n\tearly_ioremap_init();\n\n\t/* Enable early debugging if any specified (see udbg.h) */\n\tudbg_early_init();\n\n\tpatch_instruction_site(&patch__memcpy_nocache, ppc_inst(PPC_INST_NOP));\n\n\tcreate_cond_branch(&insn, addr, branch_target(addr), 0x820000);\n\tpatch_instruction(addr, insn);\t/* replace b by bne cr0 */\n\n\t/* Do some early initialization based on the flat device tree */\n\tearly_init_devtree(__va(dt_ptr));\n\n\tearly_init_mmu();\n\n\tsetup_kdump_trampoline();\n}",
    "includes": [
      "#include \"setup.h\"",
      "#include <asm/early_ioremap.h>",
      "#include <asm/feature-fixups.h>",
      "#include <asm/kdump.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/cpu_has_feature.h>",
      "#include <asm/code-patching.h>",
      "#include <asm/udbg.h>",
      "#include <asm/serial.h>",
      "#include <asm/time.h>",
      "#include <asm/xmon.h>",
      "#include <asm/nvram.h>",
      "#include <asm/sections.h>",
      "#include <asm/pmac_feature.h>",
      "#include <linux/uaccess.h>",
      "#include <asm/machdep.h>",
      "#include <asm/btext.h>",
      "#include <asm/bootx.h>",
      "#include <asm/cputable.h>",
      "#include <asm/elf.h>",
      "#include <asm/smp.h>",
      "#include <asm/setup.h>",
      "#include <asm/processor.h>",
      "#include <asm/prom.h>",
      "#include <asm/io.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/nvram.h>",
      "#include <linux/export.h>",
      "#include <linux/memblock.h>",
      "#include <linux/console.h>",
      "#include <linux/cpu.h>",
      "#include <linux/root_dev.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/tty.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/reboot.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/sched.h>",
      "#include <linux/string.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setup_kdump_trampoline",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "setup_kdump_trampoline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/crash_dump.c",
          "lines": "52-68",
          "snippet": "void __init setup_kdump_trampoline(void)\n{\n\tunsigned long i;\n\n\tDBG(\" -> setup_kdump_trampoline()\\n\");\n\n\tfor (i = KDUMP_TRAMPOLINE_START; i < KDUMP_TRAMPOLINE_END; i += 8) {\n\t\tcreate_trampoline(i);\n\t}\n\n#ifdef CONFIG_PPC_PSERIES\n\tcreate_trampoline(__pa(system_reset_fwnmi) - PHYSICAL_START);\n\tcreate_trampoline(__pa(machine_check_fwnmi) - PHYSICAL_START);\n#endif /* CONFIG_PPC_PSERIES */\n\n\tDBG(\" <- setup_kdump_trampoline()\\n\");\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/inst.h>",
            "#include <asm/rtas.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/firmware.h>",
            "#include <asm/prom.h>",
            "#include <asm/kdump.h>",
            "#include <asm/code-patching.h>",
            "#include <linux/memblock.h>",
            "#include <linux/io.h>",
            "#include <linux/crash_dump.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/inst.h>\n#include <asm/rtas.h>\n#include <linux/uaccess.h>\n#include <asm/firmware.h>\n#include <asm/prom.h>\n#include <asm/kdump.h>\n#include <asm/code-patching.h>\n#include <linux/memblock.h>\n#include <linux/io.h>\n#include <linux/crash_dump.h>\n\nvoid __init setup_kdump_trampoline(void)\n{\n\tunsigned long i;\n\n\tDBG(\" -> setup_kdump_trampoline()\\n\");\n\n\tfor (i = KDUMP_TRAMPOLINE_START; i < KDUMP_TRAMPOLINE_END; i += 8) {\n\t\tcreate_trampoline(i);\n\t}\n\n#ifdef CONFIG_PPC_PSERIES\n\tcreate_trampoline(__pa(system_reset_fwnmi) - PHYSICAL_START);\n\tcreate_trampoline(__pa(machine_check_fwnmi) - PHYSICAL_START);\n#endif /* CONFIG_PPC_PSERIES */\n\n\tDBG(\" <- setup_kdump_trampoline()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "early_init_mmu",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_init_devtree",
          "args": [
            "__va(dt_ptr)"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "early_init_devtree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom.c",
          "lines": "715-842",
          "snippet": "void __init early_init_devtree(void *params)\n{\n\tphys_addr_t limit;\n\n\tDBG(\" -> early_init_devtree(%px)\\n\", params);\n\n\t/* Too early to BUG_ON(), do it by hand */\n\tif (!early_init_dt_verify(params))\n\t\tpanic(\"BUG: Failed verifying flat device tree, bad version?\");\n\n#ifdef CONFIG_PPC_RTAS\n\t/* Some machines might need RTAS info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_rtas, NULL);\n#endif\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Some machines might need OPAL info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_opal, NULL);\n\n\t/* Scan tree for ultravisor feature */\n\tof_scan_flat_dt(early_init_dt_scan_ultravisor, NULL);\n#endif\n\n#if defined(CONFIG_FA_DUMP) || defined(CONFIG_PRESERVE_FA_DUMP)\n\t/* scan tree to see if dump is active during last boot */\n\tof_scan_flat_dt(early_init_dt_scan_fw_dump, NULL);\n#endif\n\n\t/* Retrieve various informations from the /chosen node of the\n\t * device-tree, including the platform type, initrd location and\n\t * size, TCE reserve, and more ...\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_chosen_ppc, boot_command_line);\n\n\t/* Scan memory nodes and rebuild MEMBLOCKs */\n\tof_scan_flat_dt(early_init_dt_scan_root, NULL);\n\tof_scan_flat_dt(early_init_dt_scan_memory_ppc, NULL);\n\n\tparse_early_param();\n\n\t/* make sure we've parsed cmdline for mem= before this */\n\tif (memory_limit)\n\t\tfirst_memblock_size = min_t(u64, first_memblock_size, memory_limit);\n\tsetup_initial_memory_limit(memstart_addr, first_memblock_size);\n\t/* Reserve MEMBLOCK regions used by kernel, initrd, dt, etc... */\n\tmemblock_reserve(PHYSICAL_START, __pa(klimit) - PHYSICAL_START);\n\t/* If relocatable, reserve first 32k for interrupt vectors etc. */\n\tif (PHYSICAL_START > MEMORY_START)\n\t\tmemblock_reserve(MEMORY_START, 0x8000);\n\treserve_kdump_trampoline();\n#if defined(CONFIG_FA_DUMP) || defined(CONFIG_PRESERVE_FA_DUMP)\n\t/*\n\t * If we fail to reserve memory for firmware-assisted dump then\n\t * fallback to kexec based kdump.\n\t */\n\tif (fadump_reserve_mem() == 0)\n#endif\n\t\treserve_crashkernel();\n\tearly_reserve_mem();\n\n\t/* Ensure that total memory size is page-aligned. */\n\tlimit = ALIGN(memory_limit ?: memblock_phys_mem_size(), PAGE_SIZE);\n\tmemblock_enforce_memory_limit(limit);\n\n#if defined(CONFIG_PPC_BOOK3S_64) && defined(CONFIG_PPC_4K_PAGES)\n\tif (!early_radix_enabled())\n\t\tmemblock_cap_memory_range(0, 1UL << (H_MAX_PHYSMEM_BITS));\n#endif\n\n\tmemblock_allow_resize();\n\tmemblock_dump_all();\n\n\tDBG(\"Phys. mem: %llx\\n\", (unsigned long long)memblock_phys_mem_size());\n\n\t/* We may need to relocate the flat tree, do it now.\n\t * FIXME .. and the initrd too? */\n\tmove_device_tree();\n\n\tallocate_paca_ptrs();\n\n\tDBG(\"Scanning CPUs ...\\n\");\n\n\tdt_cpu_ftrs_scan();\n\n\t/* Retrieve CPU related informations from the flat tree\n\t * (altivec support, boot CPU ID, ...)\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_cpus, NULL);\n\tif (boot_cpuid < 0) {\n\t\tprintk(\"Failed to identify boot CPU !\\n\");\n\t\tBUG();\n\t}\n\n\tsave_fscr_to_task();\n\n#if defined(CONFIG_SMP) && defined(CONFIG_PPC64)\n\t/* We'll later wait for secondaries to check in; there are\n\t * NCPUS-1 non-boot CPUs  :-)\n\t */\n\tspinning_secondaries = boot_cpu_count - 1;\n#endif\n\n\tmmu_early_init_devtree();\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Scan and build the list of machine check recoverable ranges */\n\tof_scan_flat_dt(early_init_dt_scan_recoverable_ranges, NULL);\n#endif\n\tepapr_paravirt_early_init();\n\n\t/* Now try to figure out if we are running on LPAR and so on */\n\tpseries_probe_fw_features();\n\n\t/*\n\t * Initialize pkey features and default AMR/IAMR values\n\t */\n\tpkey_early_init_devtree();\n\n#ifdef CONFIG_PPC_PS3\n\t/* Identify PS3 firmware */\n\tif (of_flat_dt_is_compatible(of_get_flat_dt_root(), \"sony,ps3\"))\n\t\tpowerpc_firmware_features |= FW_FEATURE_PS3_POSSIBLE;\n#endif\n\n\ttm_init();\n\n\tDBG(\" <- early_init_devtree()\\n\");\n}",
          "includes": [
            "#include <mm/mmu_decl.h>",
            "#include <asm/ultravisor.h>",
            "#include <asm/drmem.h>",
            "#include <asm/dt_cpu_ftrs.h>",
            "#include <asm/firmware.h>",
            "#include <asm/epapr_hcalls.h>",
            "#include <asm/fadump.h>",
            "#include <asm/opal.h>",
            "#include <asm/kexec.h>",
            "#include <asm/pci-bridge.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/powernv.h>",
            "#include <asm/paca.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/kdump.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/cpu.h>",
            "#include <linux/libfdt.h>",
            "#include <linux/of_fdt.h>",
            "#include <linux/of.h>",
            "#include <linux/memblock.h>",
            "#include <linux/irq.h>",
            "#include <linux/kexec.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static phys_addr_t first_memblock_size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mm/mmu_decl.h>\n#include <asm/ultravisor.h>\n#include <asm/drmem.h>\n#include <asm/dt_cpu_ftrs.h>\n#include <asm/firmware.h>\n#include <asm/epapr_hcalls.h>\n#include <asm/fadump.h>\n#include <asm/opal.h>\n#include <asm/kexec.h>\n#include <asm/pci-bridge.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/powernv.h>\n#include <asm/paca.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/kdump.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/cpu.h>\n#include <linux/libfdt.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/memblock.h>\n#include <linux/irq.h>\n#include <linux/kexec.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic phys_addr_t first_memblock_size;\n\nvoid __init early_init_devtree(void *params)\n{\n\tphys_addr_t limit;\n\n\tDBG(\" -> early_init_devtree(%px)\\n\", params);\n\n\t/* Too early to BUG_ON(), do it by hand */\n\tif (!early_init_dt_verify(params))\n\t\tpanic(\"BUG: Failed verifying flat device tree, bad version?\");\n\n#ifdef CONFIG_PPC_RTAS\n\t/* Some machines might need RTAS info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_rtas, NULL);\n#endif\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Some machines might need OPAL info for debugging, grab it now. */\n\tof_scan_flat_dt(early_init_dt_scan_opal, NULL);\n\n\t/* Scan tree for ultravisor feature */\n\tof_scan_flat_dt(early_init_dt_scan_ultravisor, NULL);\n#endif\n\n#if defined(CONFIG_FA_DUMP) || defined(CONFIG_PRESERVE_FA_DUMP)\n\t/* scan tree to see if dump is active during last boot */\n\tof_scan_flat_dt(early_init_dt_scan_fw_dump, NULL);\n#endif\n\n\t/* Retrieve various informations from the /chosen node of the\n\t * device-tree, including the platform type, initrd location and\n\t * size, TCE reserve, and more ...\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_chosen_ppc, boot_command_line);\n\n\t/* Scan memory nodes and rebuild MEMBLOCKs */\n\tof_scan_flat_dt(early_init_dt_scan_root, NULL);\n\tof_scan_flat_dt(early_init_dt_scan_memory_ppc, NULL);\n\n\tparse_early_param();\n\n\t/* make sure we've parsed cmdline for mem= before this */\n\tif (memory_limit)\n\t\tfirst_memblock_size = min_t(u64, first_memblock_size, memory_limit);\n\tsetup_initial_memory_limit(memstart_addr, first_memblock_size);\n\t/* Reserve MEMBLOCK regions used by kernel, initrd, dt, etc... */\n\tmemblock_reserve(PHYSICAL_START, __pa(klimit) - PHYSICAL_START);\n\t/* If relocatable, reserve first 32k for interrupt vectors etc. */\n\tif (PHYSICAL_START > MEMORY_START)\n\t\tmemblock_reserve(MEMORY_START, 0x8000);\n\treserve_kdump_trampoline();\n#if defined(CONFIG_FA_DUMP) || defined(CONFIG_PRESERVE_FA_DUMP)\n\t/*\n\t * If we fail to reserve memory for firmware-assisted dump then\n\t * fallback to kexec based kdump.\n\t */\n\tif (fadump_reserve_mem() == 0)\n#endif\n\t\treserve_crashkernel();\n\tearly_reserve_mem();\n\n\t/* Ensure that total memory size is page-aligned. */\n\tlimit = ALIGN(memory_limit ?: memblock_phys_mem_size(), PAGE_SIZE);\n\tmemblock_enforce_memory_limit(limit);\n\n#if defined(CONFIG_PPC_BOOK3S_64) && defined(CONFIG_PPC_4K_PAGES)\n\tif (!early_radix_enabled())\n\t\tmemblock_cap_memory_range(0, 1UL << (H_MAX_PHYSMEM_BITS));\n#endif\n\n\tmemblock_allow_resize();\n\tmemblock_dump_all();\n\n\tDBG(\"Phys. mem: %llx\\n\", (unsigned long long)memblock_phys_mem_size());\n\n\t/* We may need to relocate the flat tree, do it now.\n\t * FIXME .. and the initrd too? */\n\tmove_device_tree();\n\n\tallocate_paca_ptrs();\n\n\tDBG(\"Scanning CPUs ...\\n\");\n\n\tdt_cpu_ftrs_scan();\n\n\t/* Retrieve CPU related informations from the flat tree\n\t * (altivec support, boot CPU ID, ...)\n\t */\n\tof_scan_flat_dt(early_init_dt_scan_cpus, NULL);\n\tif (boot_cpuid < 0) {\n\t\tprintk(\"Failed to identify boot CPU !\\n\");\n\t\tBUG();\n\t}\n\n\tsave_fscr_to_task();\n\n#if defined(CONFIG_SMP) && defined(CONFIG_PPC64)\n\t/* We'll later wait for secondaries to check in; there are\n\t * NCPUS-1 non-boot CPUs  :-)\n\t */\n\tspinning_secondaries = boot_cpu_count - 1;\n#endif\n\n\tmmu_early_init_devtree();\n\n#ifdef CONFIG_PPC_POWERNV\n\t/* Scan and build the list of machine check recoverable ranges */\n\tof_scan_flat_dt(early_init_dt_scan_recoverable_ranges, NULL);\n#endif\n\tepapr_paravirt_early_init();\n\n\t/* Now try to figure out if we are running on LPAR and so on */\n\tpseries_probe_fw_features();\n\n\t/*\n\t * Initialize pkey features and default AMR/IAMR values\n\t */\n\tpkey_early_init_devtree();\n\n#ifdef CONFIG_PPC_PS3\n\t/* Identify PS3 firmware */\n\tif (of_flat_dt_is_compatible(of_get_flat_dt_root(), \"sony,ps3\"))\n\t\tpowerpc_firmware_features |= FW_FEATURE_PS3_POSSIBLE;\n#endif\n\n\ttm_init();\n\n\tDBG(\" <- early_init_devtree()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "__va",
          "args": [
            "dt_ptr"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "patch_instruction",
          "args": [
            "addr",
            "insn"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_cond_branch",
          "args": [
            "&insn",
            "addr",
            "branch_target(addr)",
            "0x820000"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "branch_target",
          "args": [
            "addr"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "patch_instruction_site",
          "args": [
            "&patch__memcpy_nocache",
            "ppc_inst(PPC_INST_NOP)"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppc_inst",
          "args": [
            "PPC_INST_NOP"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udbg_early_init",
          "args": [],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "udbg_early_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/udbg.c",
          "lines": "25-77",
          "snippet": "void __init udbg_early_init(void)\n{\n#if defined(CONFIG_PPC_EARLY_DEBUG_LPAR)\n\t/* For LPAR machines that have an HVC console on vterm 0 */\n\tudbg_init_debug_lpar();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_LPAR_HVSI)\n\t/* For LPAR machines that have an HVSI console on vterm 0 */\n\tudbg_init_debug_lpar_hvsi();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_G5)\n\t/* For use on Apple G5 machines */\n\tudbg_init_pmac_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_PANEL)\n\t/* RTAS panel debug */\n\tudbg_init_rtas_panel();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_CONSOLE)\n\t/* RTAS console debug */\n\tudbg_init_rtas_console();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MAPLE)\n\t/* Maple real mode debug */\n\tudbg_init_maple_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PAS_REALMODE)\n\tudbg_init_pas_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_BOOTX)\n\tudbg_init_btext();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_44x)\n\t/* PPC44x debug */\n\tudbg_init_44x_as1();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_40x)\n\t/* PPC40x debug */\n\tudbg_init_40x_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_CPM)\n\tudbg_init_cpm();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_USBGECKO)\n\tudbg_init_usbgecko();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MEMCONS)\n\t/* In memory console */\n\tudbg_init_memcons();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_EHV_BC)\n\tudbg_init_ehv_bc();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PS3GELIC)\n\tudbg_init_ps3gelic();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_RAW)\n\tudbg_init_debug_opal_raw();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_HVSI)\n\tudbg_init_debug_opal_hvsi();\n#endif\n\n#ifdef CONFIG_PPC_EARLY_DEBUG\n\tconsole_loglevel = CONSOLE_LOGLEVEL_DEBUG;\n\n\tregister_early_udbg_console();\n#endif\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n#include <stdarg.h>\n\nvoid __init udbg_early_init(void)\n{\n#if defined(CONFIG_PPC_EARLY_DEBUG_LPAR)\n\t/* For LPAR machines that have an HVC console on vterm 0 */\n\tudbg_init_debug_lpar();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_LPAR_HVSI)\n\t/* For LPAR machines that have an HVSI console on vterm 0 */\n\tudbg_init_debug_lpar_hvsi();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_G5)\n\t/* For use on Apple G5 machines */\n\tudbg_init_pmac_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_PANEL)\n\t/* RTAS panel debug */\n\tudbg_init_rtas_panel();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_RTAS_CONSOLE)\n\t/* RTAS console debug */\n\tudbg_init_rtas_console();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MAPLE)\n\t/* Maple real mode debug */\n\tudbg_init_maple_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PAS_REALMODE)\n\tudbg_init_pas_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_BOOTX)\n\tudbg_init_btext();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_44x)\n\t/* PPC44x debug */\n\tudbg_init_44x_as1();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_40x)\n\t/* PPC40x debug */\n\tudbg_init_40x_realmode();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_CPM)\n\tudbg_init_cpm();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_USBGECKO)\n\tudbg_init_usbgecko();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_MEMCONS)\n\t/* In memory console */\n\tudbg_init_memcons();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_EHV_BC)\n\tudbg_init_ehv_bc();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_PS3GELIC)\n\tudbg_init_ps3gelic();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_RAW)\n\tudbg_init_debug_opal_raw();\n#elif defined(CONFIG_PPC_EARLY_DEBUG_OPAL_HVSI)\n\tudbg_init_debug_opal_hvsi();\n#endif\n\n#ifdef CONFIG_PPC_EARLY_DEBUG\n\tconsole_loglevel = CONSOLE_LOGLEVEL_DEBUG;\n\n\tregister_early_udbg_console();\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "early_ioremap_init",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_feature_keys",
          "args": [],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "patch_site_addr",
          "args": [
            "&patch__memset_nocache"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"setup.h\"\n#include <asm/early_ioremap.h>\n#include <asm/feature-fixups.h>\n#include <asm/kdump.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/code-patching.h>\n#include <asm/udbg.h>\n#include <asm/serial.h>\n#include <asm/time.h>\n#include <asm/xmon.h>\n#include <asm/nvram.h>\n#include <asm/sections.h>\n#include <asm/pmac_feature.h>\n#include <linux/uaccess.h>\n#include <asm/machdep.h>\n#include <asm/btext.h>\n#include <asm/bootx.h>\n#include <asm/cputable.h>\n#include <asm/elf.h>\n#include <asm/smp.h>\n#include <asm/setup.h>\n#include <asm/processor.h>\n#include <asm/prom.h>\n#include <asm/io.h>\n#include <linux/pgtable.h>\n#include <linux/nvram.h>\n#include <linux/export.h>\n#include <linux/memblock.h>\n#include <linux/console.h>\n#include <linux/cpu.h>\n#include <linux/root_dev.h>\n#include <linux/seq_file.h>\n#include <linux/tty.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\n__init machine_init(u64 dt_ptr)\n{\n\tstruct ppc_inst *addr = (struct ppc_inst *)patch_site_addr(&patch__memset_nocache);\n\tstruct ppc_inst insn;\n\n\t/* Configure static keys first, now that we're relocated. */\n\tsetup_feature_keys();\n\n\tearly_ioremap_init();\n\n\t/* Enable early debugging if any specified (see udbg.h) */\n\tudbg_early_init();\n\n\tpatch_instruction_site(&patch__memcpy_nocache, ppc_inst(PPC_INST_NOP));\n\n\tcreate_cond_branch(&insn, addr, branch_target(addr), 0x820000);\n\tpatch_instruction(addr, insn);\t/* replace b by bne cr0 */\n\n\t/* Do some early initialization based on the flat device tree */\n\tearly_init_devtree(__va(dt_ptr));\n\n\tearly_init_mmu();\n\n\tsetup_kdump_trampoline();\n}"
  }
]