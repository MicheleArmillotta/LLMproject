[
  {
    "function_name": "restore_processor_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/swsusp.c",
    "lines": "28-33",
    "snippet": "void restore_processor_state(void)\n{\n#ifdef CONFIG_PPC32\n\tswitch_mmu_context(current->active_mm, current->active_mm, NULL);\n#endif\n}",
    "includes": [
      "#include <asm/switch_to.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/current.h>",
      "#include <linux/suspend.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "switch_mmu_context",
          "args": [
            "current->active_mm",
            "current->active_mm",
            "NULL"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/switch_to.h>\n#include <asm/mmu_context.h>\n#include <asm/current.h>\n#include <linux/suspend.h>\n#include <linux/sched.h>\n\nvoid restore_processor_state(void)\n{\n#ifdef CONFIG_PPC32\n\tswitch_mmu_context(current->active_mm, current->active_mm, NULL);\n#endif\n}"
  },
  {
    "function_name": "save_processor_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/swsusp.c",
    "lines": "14-26",
    "snippet": "void save_processor_state(void)\n{\n\t/*\n\t * flush out all the special registers so we don't need\n\t * to save them in the snapshot\n\t */\n\tflush_all_to_thread(current);\n\n#ifdef CONFIG_PPC64\n\thard_irq_disable();\n#endif\n\n}",
    "includes": [
      "#include <asm/switch_to.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/current.h>",
      "#include <linux/suspend.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hard_irq_disable",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_all_to_thread",
          "args": [
            "current"
          ],
          "line": 20
        },
        "resolved": true,
        "details": {
          "function_name": "flush_all_to_thread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/process.c",
          "lines": "595-608",
          "snippet": "void flush_all_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tBUG_ON(tsk != current);\n#ifdef CONFIG_SPE\n\t\tif (tsk->thread.regs->msr & MSR_SPE)\n\t\t\ttsk->thread.spefscr = mfspr(SPRN_SPEFSCR);\n#endif\n\t\tsave_all(tsk);\n\n\t\tpreempt_enable();\n\t}\n}",
          "includes": [
            "#include <linux/kdebug.h>",
            "#include <linux/kprobes.h>",
            "#include <asm/hw_breakpoint.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/cpu_has_feature.h>",
            "#include <asm/livepatch.h>",
            "#include <asm/exec.h>",
            "#include <asm/code-patching.h>",
            "#include <asm/hw_irq.h>",
            "#include <asm/firmware.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/syscalls.h>",
            "#include <asm/runlatch.h>",
            "#include <asm/time.h>",
            "#include <asm/machdep.h>",
            "#include <asm/prom.h>",
            "#include <asm/mmu.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <linux/seq_buf.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/elf-randomize.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/random.h>",
            "#include <linux/personality.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/init_task.h>",
            "#include <linux/prctl.h>",
            "#include <linux/elf.h>",
            "#include <linux/user.h>",
            "#include <linux/slab.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/smp.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kdebug.h>\n#include <linux/kprobes.h>\n#include <asm/hw_breakpoint.h>\n#include <asm/stacktrace.h>\n#include <asm/asm-prototypes.h>\n#include <asm/cpu_has_feature.h>\n#include <asm/livepatch.h>\n#include <asm/exec.h>\n#include <asm/code-patching.h>\n#include <asm/hw_irq.h>\n#include <asm/firmware.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/syscalls.h>\n#include <asm/runlatch.h>\n#include <asm/time.h>\n#include <asm/machdep.h>\n#include <asm/prom.h>\n#include <asm/mmu.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <linux/seq_buf.h>\n#include <linux/pkeys.h>\n#include <linux/elf-randomize.h>\n#include <linux/uaccess.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/random.h>\n#include <linux/personality.h>\n#include <linux/kernel_stat.h>\n#include <linux/ftrace.h>\n#include <linux/utsname.h>\n#include <linux/hardirq.h>\n#include <linux/mqueue.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/init_task.h>\n#include <linux/prctl.h>\n#include <linux/elf.h>\n#include <linux/user.h>\n#include <linux/slab.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/smp.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nvoid flush_all_to_thread(struct task_struct *tsk)\n{\n\tif (tsk->thread.regs) {\n\t\tpreempt_disable();\n\t\tBUG_ON(tsk != current);\n#ifdef CONFIG_SPE\n\t\tif (tsk->thread.regs->msr & MSR_SPE)\n\t\t\ttsk->thread.spefscr = mfspr(SPRN_SPEFSCR);\n#endif\n\t\tsave_all(tsk);\n\n\t\tpreempt_enable();\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/switch_to.h>\n#include <asm/mmu_context.h>\n#include <asm/current.h>\n#include <linux/suspend.h>\n#include <linux/sched.h>\n\nvoid save_processor_state(void)\n{\n\t/*\n\t * flush out all the special registers so we don't need\n\t * to save them in the snapshot\n\t */\n\tflush_all_to_thread(current);\n\n#ifdef CONFIG_PPC64\n\thard_irq_disable();\n#endif\n\n}"
  }
]