[
  {
    "function_name": "cacheinfo_rebuild",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "933-941",
    "snippet": "void cacheinfo_rebuild(void)\n{\n\tunsigned int cpu;\n\n\tlockdep_assert_cpus_held();\n\n\tfor_each_online_cpu(cpu)\n\t\tcacheinfo_cpu_online(cpu);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lockdep_assert_cpus_held",
          "args": [],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nvoid cacheinfo_rebuild(void)\n{\n\tunsigned int cpu;\n\n\tlockdep_assert_cpus_held();\n\n\tfor_each_online_cpu(cpu)\n\t\tcacheinfo_cpu_online(cpu);\n}"
  },
  {
    "function_name": "cacheinfo_teardown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "923-931",
    "snippet": "void cacheinfo_teardown(void)\n{\n\tunsigned int cpu;\n\n\tlockdep_assert_cpus_held();\n\n\tfor_each_online_cpu(cpu)\n\t\tcacheinfo_cpu_offline(cpu);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lockdep_assert_cpus_held",
          "args": [],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nvoid cacheinfo_teardown(void)\n{\n\tunsigned int cpu;\n\n\tlockdep_assert_cpus_held();\n\n\tfor_each_online_cpu(cpu)\n\t\tcacheinfo_cpu_offline(cpu);\n}"
  },
  {
    "function_name": "cacheinfo_cpu_offline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "901-921",
    "snippet": "void cacheinfo_cpu_offline(unsigned int cpu_id)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct cache *cache;\n\n\t/* Prevent userspace from seeing inconsistent state - remove\n\t * the sysfs hierarchy first */\n\tcache_dir = per_cpu(cache_dir_pcpu, cpu_id);\n\n\t/* careful, sysfs population may have failed */\n\tif (cache_dir)\n\t\tremove_cache_dir(cache_dir);\n\n\tper_cpu(cache_dir_pcpu, cpu_id) = NULL;\n\n\t/* clear the CPU's bit in its cache chain, possibly freeing\n\t * cache objects */\n\tcache = cache_lookup_by_cpu(cpu_id);\n\tif (cache)\n\t\tcache_cpu_clear(cache, cpu_id);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct cache_dir *, cache_dir_pcpu);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_cpu_clear",
          "args": [
            "cache",
            "cpu_id"
          ],
          "line": 920
        },
        "resolved": true,
        "details": {
          "function_name": "cache_cpu_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "880-899",
          "snippet": "static void cache_cpu_clear(struct cache *cache, int cpu)\n{\n\twhile (cache) {\n\t\tstruct cache *next = cache->next_local;\n\n\t\tWARN_ONCE(!cpumask_test_cpu(cpu, &cache->shared_cpu_map),\n\t\t\t  \"CPU %i not accounted in %pOFP(%s)\\n\",\n\t\t\t  cpu, cache->ofnode,\n\t\t\t  cache_type_string(cache));\n\n\t\tcpumask_clear_cpu(cpu, &cache->shared_cpu_map);\n\n\t\t/* Release the cache object if all the cpus using it\n\t\t * are offline */\n\t\tif (cpumask_empty(&cache->shared_cpu_map))\n\t\t\trelease_cache(cache);\n\n\t\tcache = next;\n\t}\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void cache_cpu_clear(struct cache *cache, int cpu)\n{\n\twhile (cache) {\n\t\tstruct cache *next = cache->next_local;\n\n\t\tWARN_ONCE(!cpumask_test_cpu(cpu, &cache->shared_cpu_map),\n\t\t\t  \"CPU %i not accounted in %pOFP(%s)\\n\",\n\t\t\t  cpu, cache->ofnode,\n\t\t\t  cache_type_string(cache));\n\n\t\tcpumask_clear_cpu(cpu, &cache->shared_cpu_map);\n\n\t\t/* Release the cache object if all the cpus using it\n\t\t * are offline */\n\t\tif (cpumask_empty(&cache->shared_cpu_map))\n\t\t\trelease_cache(cache);\n\n\t\tcache = next;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_lookup_by_cpu",
          "args": [
            "cpu_id"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "cache_lookup_by_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "837-851",
          "snippet": "static struct cache *cache_lookup_by_cpu(unsigned int cpu_id)\n{\n\tstruct device_node *cpu_node;\n\tstruct cache *cache;\n\n\tcpu_node = of_get_cpu_node(cpu_id, NULL);\n\tWARN_ONCE(!cpu_node, \"no OF node found for CPU %i\\n\", cpu_id);\n\tif (!cpu_node)\n\t\treturn NULL;\n\n\tcache = cache_lookup_by_node(cpu_node);\n\tof_node_put(cpu_node);\n\n\treturn cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_lookup_by_cpu(unsigned int cpu_id)\n{\n\tstruct device_node *cpu_node;\n\tstruct cache *cache;\n\n\tcpu_node = of_get_cpu_node(cpu_id, NULL);\n\tWARN_ONCE(!cpu_node, \"no OF node found for CPU %i\\n\", cpu_id);\n\tif (!cpu_node)\n\t\treturn NULL;\n\n\tcache = cache_lookup_by_node(cpu_node);\n\tof_node_put(cpu_node);\n\n\treturn cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cache_dir_pcpu",
            "cpu_id"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "remove_cache_dir",
          "args": [
            "cache_dir"
          ],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "remove_cache_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "868-878",
          "snippet": "static void remove_cache_dir(struct cache_dir *cache_dir)\n{\n\tremove_index_dirs(cache_dir);\n\n\t/* Remove cache dir from sysfs */\n\tkobject_del(cache_dir->kobj);\n\n\tkobject_put(cache_dir->kobj);\n\n\tkfree(cache_dir);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void remove_cache_dir(struct cache_dir *cache_dir)\n{\n\tremove_index_dirs(cache_dir);\n\n\t/* Remove cache dir from sysfs */\n\tkobject_del(cache_dir->kobj);\n\n\tkobject_put(cache_dir->kobj);\n\n\tkfree(cache_dir);\n}"
        }
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cache_dir_pcpu",
            "cpu_id"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic DEFINE_PER_CPU(struct cache_dir *, cache_dir_pcpu);\n\nvoid cacheinfo_cpu_offline(unsigned int cpu_id)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct cache *cache;\n\n\t/* Prevent userspace from seeing inconsistent state - remove\n\t * the sysfs hierarchy first */\n\tcache_dir = per_cpu(cache_dir_pcpu, cpu_id);\n\n\t/* careful, sysfs population may have failed */\n\tif (cache_dir)\n\t\tremove_cache_dir(cache_dir);\n\n\tper_cpu(cache_dir_pcpu, cpu_id) = NULL;\n\n\t/* clear the CPU's bit in its cache chain, possibly freeing\n\t * cache objects */\n\tcache = cache_lookup_by_cpu(cpu_id);\n\tif (cache)\n\t\tcache_cpu_clear(cache, cpu_id);\n}"
  },
  {
    "function_name": "cache_cpu_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "880-899",
    "snippet": "static void cache_cpu_clear(struct cache *cache, int cpu)\n{\n\twhile (cache) {\n\t\tstruct cache *next = cache->next_local;\n\n\t\tWARN_ONCE(!cpumask_test_cpu(cpu, &cache->shared_cpu_map),\n\t\t\t  \"CPU %i not accounted in %pOFP(%s)\\n\",\n\t\t\t  cpu, cache->ofnode,\n\t\t\t  cache_type_string(cache));\n\n\t\tcpumask_clear_cpu(cpu, &cache->shared_cpu_map);\n\n\t\t/* Release the cache object if all the cpus using it\n\t\t * are offline */\n\t\tif (cpumask_empty(&cache->shared_cpu_map))\n\t\t\trelease_cache(cache);\n\n\t\tcache = next;\n\t}\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "release_cache",
          "args": [
            "cache"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "release_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "178-190",
          "snippet": "static void release_cache(struct cache *cache)\n{\n\tif (!cache)\n\t\treturn;\n\n\tpr_debug(\"freeing L%d %s cache for %pOFP\\n\", cache->level,\n\t\t cache_type_string(cache), cache->ofnode);\n\n\trelease_cache_debugcheck(cache);\n\tlist_del(&cache->list);\n\tof_node_put(cache->ofnode);\n\tkfree(cache);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void release_cache(struct cache *cache)\n{\n\tif (!cache)\n\t\treturn;\n\n\tpr_debug(\"freeing L%d %s cache for %pOFP\\n\", cache->level,\n\t\t cache_type_string(cache), cache->ofnode);\n\n\trelease_cache_debugcheck(cache);\n\tlist_del(&cache->list);\n\tof_node_put(cache->ofnode);\n\tkfree(cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "&cache->shared_cpu_map"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "cpu",
            "&cache->shared_cpu_map"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "!cpumask_test_cpu(cpu, &cache->shared_cpu_map)",
            "\"CPU %i not accounted in %pOFP(%s)\\n\"",
            "cpu",
            "cache->ofnode",
            "cache_type_string(cache)"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_type_string",
          "args": [
            "cache"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "cache_type_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "139-142",
          "snippet": "static const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_test_cpu",
          "args": [
            "cpu",
            "&cache->shared_cpu_map"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void cache_cpu_clear(struct cache *cache, int cpu)\n{\n\twhile (cache) {\n\t\tstruct cache *next = cache->next_local;\n\n\t\tWARN_ONCE(!cpumask_test_cpu(cpu, &cache->shared_cpu_map),\n\t\t\t  \"CPU %i not accounted in %pOFP(%s)\\n\",\n\t\t\t  cpu, cache->ofnode,\n\t\t\t  cache_type_string(cache));\n\n\t\tcpumask_clear_cpu(cpu, &cache->shared_cpu_map);\n\n\t\t/* Release the cache object if all the cpus using it\n\t\t * are offline */\n\t\tif (cpumask_empty(&cache->shared_cpu_map))\n\t\t\trelease_cache(cache);\n\n\t\tcache = next;\n\t}\n}"
  },
  {
    "function_name": "remove_cache_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "868-878",
    "snippet": "static void remove_cache_dir(struct cache_dir *cache_dir)\n{\n\tremove_index_dirs(cache_dir);\n\n\t/* Remove cache dir from sysfs */\n\tkobject_del(cache_dir->kobj);\n\n\tkobject_put(cache_dir->kobj);\n\n\tkfree(cache_dir);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cache_dir"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "cache_dir->kobj"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_del",
          "args": [
            "cache_dir->kobj"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "remove_index_dirs",
          "args": [
            "cache_dir"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "remove_index_dirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "853-866",
          "snippet": "static void remove_index_dirs(struct cache_dir *cache_dir)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = cache_dir->index;\n\n\twhile (index) {\n\t\tstruct cache_index_dir *next;\n\n\t\tnext = index->next;\n\t\tkobject_put(&index->kobj);\n\t\tindex = next;\n\t}\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void remove_index_dirs(struct cache_dir *cache_dir)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = cache_dir->index;\n\n\twhile (index) {\n\t\tstruct cache_index_dir *next;\n\n\t\tnext = index->next;\n\t\tkobject_put(&index->kobj);\n\t\tindex = next;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void remove_cache_dir(struct cache_dir *cache_dir)\n{\n\tremove_index_dirs(cache_dir);\n\n\t/* Remove cache dir from sysfs */\n\tkobject_del(cache_dir->kobj);\n\n\tkobject_put(cache_dir->kobj);\n\n\tkfree(cache_dir);\n}"
  },
  {
    "function_name": "remove_index_dirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "853-866",
    "snippet": "static void remove_index_dirs(struct cache_dir *cache_dir)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = cache_dir->index;\n\n\twhile (index) {\n\t\tstruct cache_index_dir *next;\n\n\t\tnext = index->next;\n\t\tkobject_put(&index->kobj);\n\t\tindex = next;\n\t}\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&index->kobj"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void remove_index_dirs(struct cache_dir *cache_dir)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = cache_dir->index;\n\n\twhile (index) {\n\t\tstruct cache_index_dir *next;\n\n\t\tnext = index->next;\n\t\tkobject_put(&index->kobj);\n\t\tindex = next;\n\t}\n}"
  },
  {
    "function_name": "cache_lookup_by_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "837-851",
    "snippet": "static struct cache *cache_lookup_by_cpu(unsigned int cpu_id)\n{\n\tstruct device_node *cpu_node;\n\tstruct cache *cache;\n\n\tcpu_node = of_get_cpu_node(cpu_id, NULL);\n\tWARN_ONCE(!cpu_node, \"no OF node found for CPU %i\\n\", cpu_id);\n\tif (!cpu_node)\n\t\treturn NULL;\n\n\tcache = cache_lookup_by_node(cpu_node);\n\tof_node_put(cpu_node);\n\n\treturn cache;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "cpu_node"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_lookup_by_node",
          "args": [
            "cpu_node"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "cache_lookup_by_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "319-332",
          "snippet": "static struct cache *cache_lookup_by_node(const struct device_node *node)\n{\n\tstruct cache *cache = NULL;\n\tstruct cache *iter;\n\n\tlist_for_each_entry(iter, &cache_list, list) {\n\t\tif (iter->ofnode != node)\n\t\t\tcontinue;\n\t\tcache = cache_find_first_sibling(iter);\n\t\tbreak;\n\t}\n\n\treturn cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(cache_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic LIST_HEAD(cache_list);\n\nstatic struct cache *cache_lookup_by_node(const struct device_node *node)\n{\n\tstruct cache *cache = NULL;\n\tstruct cache *iter;\n\n\tlist_for_each_entry(iter, &cache_list, list) {\n\t\tif (iter->ofnode != node)\n\t\t\tcontinue;\n\t\tcache = cache_find_first_sibling(iter);\n\t\tbreak;\n\t}\n\n\treturn cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "!cpu_node",
            "\"no OF node found for CPU %i\\n\"",
            "cpu_id"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_cpu_node",
          "args": [
            "cpu_id",
            "NULL"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_lookup_by_cpu(unsigned int cpu_id)\n{\n\tstruct device_node *cpu_node;\n\tstruct cache *cache;\n\n\tcpu_node = of_get_cpu_node(cpu_id, NULL);\n\tWARN_ONCE(!cpu_node, \"no OF node found for CPU %i\\n\", cpu_id);\n\tif (!cpu_node)\n\t\treturn NULL;\n\n\tcache = cache_lookup_by_node(cpu_node);\n\tof_node_put(cpu_node);\n\n\treturn cache;\n}"
  },
  {
    "function_name": "cacheinfo_cpu_online",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "821-830",
    "snippet": "void cacheinfo_cpu_online(unsigned int cpu_id)\n{\n\tstruct cache *cache;\n\n\tcache = cache_chain_instantiate(cpu_id);\n\tif (!cache)\n\t\treturn;\n\n\tcacheinfo_sysfs_populate(cpu_id, cache);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cacheinfo_sysfs_populate",
          "args": [
            "cpu_id",
            "cache"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "cacheinfo_sysfs_populate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "802-819",
          "snippet": "static void cacheinfo_sysfs_populate(unsigned int cpu_id,\n\t\t\t\t     struct cache *cache_list)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct cache *cache;\n\tint index = 0;\n\n\tcache_dir = cacheinfo_create_cache_dir(cpu_id);\n\tif (!cache_dir)\n\t\treturn;\n\n\tcache = cache_list;\n\twhile (cache) {\n\t\tcacheinfo_create_index_dir(cache, index, cache_dir);\n\t\tindex++;\n\t\tcache = cache->next_local;\n\t}\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(cache_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic LIST_HEAD(cache_list);\n\nstatic void cacheinfo_sysfs_populate(unsigned int cpu_id,\n\t\t\t\t     struct cache *cache_list)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct cache *cache;\n\tint index = 0;\n\n\tcache_dir = cacheinfo_create_cache_dir(cpu_id);\n\tif (!cache_dir)\n\t\treturn;\n\n\tcache = cache_list;\n\twhile (cache) {\n\t\tcacheinfo_create_index_dir(cache, index, cache_dir);\n\t\tindex++;\n\t\tcache = cache->next_local;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_chain_instantiate",
          "args": [
            "cpu_id"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "cache_chain_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "467-490",
          "snippet": "static struct cache *cache_chain_instantiate(unsigned int cpu_id)\n{\n\tstruct device_node *cpu_node;\n\tstruct cache *cpu_cache = NULL;\n\n\tpr_debug(\"creating cache object(s) for CPU %i\\n\", cpu_id);\n\n\tcpu_node = of_get_cpu_node(cpu_id, NULL);\n\tWARN_ONCE(!cpu_node, \"no OF node found for CPU %i\\n\", cpu_id);\n\tif (!cpu_node)\n\t\tgoto out;\n\n\tcpu_cache = cache_lookup_or_instantiate(cpu_node, 1);\n\tif (!cpu_cache)\n\t\tgoto out;\n\n\tdo_subsidiary_caches(cpu_cache);\n\n\tcache_cpu_set(cpu_cache, cpu_id);\nout:\n\tof_node_put(cpu_node);\n\n\treturn cpu_cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_chain_instantiate(unsigned int cpu_id)\n{\n\tstruct device_node *cpu_node;\n\tstruct cache *cpu_cache = NULL;\n\n\tpr_debug(\"creating cache object(s) for CPU %i\\n\", cpu_id);\n\n\tcpu_node = of_get_cpu_node(cpu_id, NULL);\n\tWARN_ONCE(!cpu_node, \"no OF node found for CPU %i\\n\", cpu_id);\n\tif (!cpu_node)\n\t\tgoto out;\n\n\tcpu_cache = cache_lookup_or_instantiate(cpu_node, 1);\n\tif (!cpu_cache)\n\t\tgoto out;\n\n\tdo_subsidiary_caches(cpu_cache);\n\n\tcache_cpu_set(cpu_cache, cpu_id);\nout:\n\tof_node_put(cpu_node);\n\n\treturn cpu_cache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nvoid cacheinfo_cpu_online(unsigned int cpu_id)\n{\n\tstruct cache *cache;\n\n\tcache = cache_chain_instantiate(cpu_id);\n\tif (!cache)\n\t\treturn;\n\n\tcacheinfo_sysfs_populate(cpu_id, cache);\n}"
  },
  {
    "function_name": "cacheinfo_sysfs_populate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "802-819",
    "snippet": "static void cacheinfo_sysfs_populate(unsigned int cpu_id,\n\t\t\t\t     struct cache *cache_list)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct cache *cache;\n\tint index = 0;\n\n\tcache_dir = cacheinfo_create_cache_dir(cpu_id);\n\tif (!cache_dir)\n\t\treturn;\n\n\tcache = cache_list;\n\twhile (cache) {\n\t\tcacheinfo_create_index_dir(cache, index, cache_dir);\n\t\tindex++;\n\t\tcache = cache->next_local;\n\t}\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(cache_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cacheinfo_create_index_dir",
          "args": [
            "cache",
            "index",
            "cache_dir"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "cacheinfo_create_index_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "777-800",
          "snippet": "static void cacheinfo_create_index_dir(struct cache *cache, int index,\n\t\t\t\t       struct cache_dir *cache_dir)\n{\n\tstruct cache_index_dir *index_dir;\n\tint rc;\n\n\tindex_dir = kzalloc(sizeof(*index_dir), GFP_KERNEL);\n\tif (!index_dir)\n\t\treturn;\n\n\tindex_dir->cache = cache;\n\n\trc = kobject_init_and_add(&index_dir->kobj, &cache_index_type,\n\t\t\t\t  cache_dir->kobj, \"index%d\", index);\n\tif (rc) {\n\t\tkobject_put(&index_dir->kobj);\n\t\treturn;\n\t}\n\n\tindex_dir->next = cache_dir->index;\n\tcache_dir->index = index_dir;\n\n\tcacheinfo_create_index_opt_attrs(index_dir);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kobj_type cache_index_type = {\n\t.release = cache_index_release,\n\t.sysfs_ops = &cache_index_ops,\n\t.default_attrs = cache_index_default_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct kobj_type cache_index_type = {\n\t.release = cache_index_release,\n\t.sysfs_ops = &cache_index_ops,\n\t.default_attrs = cache_index_default_attrs,\n};\n\nstatic void cacheinfo_create_index_dir(struct cache *cache, int index,\n\t\t\t\t       struct cache_dir *cache_dir)\n{\n\tstruct cache_index_dir *index_dir;\n\tint rc;\n\n\tindex_dir = kzalloc(sizeof(*index_dir), GFP_KERNEL);\n\tif (!index_dir)\n\t\treturn;\n\n\tindex_dir->cache = cache;\n\n\trc = kobject_init_and_add(&index_dir->kobj, &cache_index_type,\n\t\t\t\t  cache_dir->kobj, \"index%d\", index);\n\tif (rc) {\n\t\tkobject_put(&index_dir->kobj);\n\t\treturn;\n\t}\n\n\tindex_dir->next = cache_dir->index;\n\tcache_dir->index = index_dir;\n\n\tcacheinfo_create_index_opt_attrs(index_dir);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cacheinfo_create_cache_dir",
          "args": [
            "cpu_id"
          ],
          "line": 809
        },
        "resolved": true,
        "details": {
          "function_name": "cacheinfo_create_cache_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "492-521",
          "snippet": "static struct cache_dir *cacheinfo_create_cache_dir(unsigned int cpu_id)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct device *dev;\n\tstruct kobject *kobj = NULL;\n\n\tdev = get_cpu_device(cpu_id);\n\tWARN_ONCE(!dev, \"no dev for CPU %i\\n\", cpu_id);\n\tif (!dev)\n\t\tgoto err;\n\n\tkobj = kobject_create_and_add(\"cache\", &dev->kobj);\n\tif (!kobj)\n\t\tgoto err;\n\n\tcache_dir = kzalloc(sizeof(*cache_dir), GFP_KERNEL);\n\tif (!cache_dir)\n\t\tgoto err;\n\n\tcache_dir->kobj = kobj;\n\n\tWARN_ON_ONCE(per_cpu(cache_dir_pcpu, cpu_id) != NULL);\n\n\tper_cpu(cache_dir_pcpu, cpu_id) = cache_dir;\n\n\treturn cache_dir;\nerr:\n\tkobject_put(kobj);\n\treturn NULL;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(struct cache_dir *, cache_dir_pcpu);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic DEFINE_PER_CPU(struct cache_dir *, cache_dir_pcpu);\n\nstatic struct cache_dir *cacheinfo_create_cache_dir(unsigned int cpu_id)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct device *dev;\n\tstruct kobject *kobj = NULL;\n\n\tdev = get_cpu_device(cpu_id);\n\tWARN_ONCE(!dev, \"no dev for CPU %i\\n\", cpu_id);\n\tif (!dev)\n\t\tgoto err;\n\n\tkobj = kobject_create_and_add(\"cache\", &dev->kobj);\n\tif (!kobj)\n\t\tgoto err;\n\n\tcache_dir = kzalloc(sizeof(*cache_dir), GFP_KERNEL);\n\tif (!cache_dir)\n\t\tgoto err;\n\n\tcache_dir->kobj = kobj;\n\n\tWARN_ON_ONCE(per_cpu(cache_dir_pcpu, cpu_id) != NULL);\n\n\tper_cpu(cache_dir_pcpu, cpu_id) = cache_dir;\n\n\treturn cache_dir;\nerr:\n\tkobject_put(kobj);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic LIST_HEAD(cache_list);\n\nstatic void cacheinfo_sysfs_populate(unsigned int cpu_id,\n\t\t\t\t     struct cache *cache_list)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct cache *cache;\n\tint index = 0;\n\n\tcache_dir = cacheinfo_create_cache_dir(cpu_id);\n\tif (!cache_dir)\n\t\treturn;\n\n\tcache = cache_list;\n\twhile (cache) {\n\t\tcacheinfo_create_index_dir(cache, index, cache_dir);\n\t\tindex++;\n\t\tcache = cache->next_local;\n\t}\n}"
  },
  {
    "function_name": "cacheinfo_create_index_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "777-800",
    "snippet": "static void cacheinfo_create_index_dir(struct cache *cache, int index,\n\t\t\t\t       struct cache_dir *cache_dir)\n{\n\tstruct cache_index_dir *index_dir;\n\tint rc;\n\n\tindex_dir = kzalloc(sizeof(*index_dir), GFP_KERNEL);\n\tif (!index_dir)\n\t\treturn;\n\n\tindex_dir->cache = cache;\n\n\trc = kobject_init_and_add(&index_dir->kobj, &cache_index_type,\n\t\t\t\t  cache_dir->kobj, \"index%d\", index);\n\tif (rc) {\n\t\tkobject_put(&index_dir->kobj);\n\t\treturn;\n\t}\n\n\tindex_dir->next = cache_dir->index;\n\tcache_dir->index = index_dir;\n\n\tcacheinfo_create_index_opt_attrs(index_dir);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_type cache_index_type = {\n\t.release = cache_index_release,\n\t.sysfs_ops = &cache_index_ops,\n\t.default_attrs = cache_index_default_attrs,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cacheinfo_create_index_opt_attrs",
          "args": [
            "index_dir"
          ],
          "line": 799
        },
        "resolved": true,
        "details": {
          "function_name": "cacheinfo_create_index_opt_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "736-775",
          "snippet": "static void cacheinfo_create_index_opt_attrs(struct cache_index_dir *dir)\n{\n\tconst char *cache_type;\n\tstruct cache *cache;\n\tchar *buf;\n\tint i;\n\n\tbuf = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (!buf)\n\t\treturn;\n\n\tcache = dir->cache;\n\tcache_type = cache_type_string(cache);\n\n\t/* We don't want to create an attribute that can't provide a\n\t * meaningful value.  Check the return value of each optional\n\t * attribute's ->show method before registering the\n\t * attribute.\n\t */\n\tfor (i = 0; i < ARRAY_SIZE(cache_index_opt_attrs); i++) {\n\t\tstruct kobj_attribute *attr;\n\t\tssize_t rc;\n\n\t\tattr = cache_index_opt_attrs[i];\n\n\t\trc = attr->show(&dir->kobj, attr, buf);\n\t\tif (rc <= 0) {\n\t\t\tpr_debug(\"not creating %s attribute for \"\n\t\t\t\t \"%pOFP(%s) (rc = %zd)\\n\",\n\t\t\t\t attr->attr.name, cache->ofnode,\n\t\t\t\t cache_type, rc);\n\t\t\tcontinue;\n\t\t}\n\t\tif (sysfs_create_file(&dir->kobj, &attr->attr))\n\t\t\tpr_debug(\"could not create %s attribute for %pOFP(%s)\\n\",\n\t\t\t\t attr->attr.name, cache->ofnode, cache_type);\n\t}\n\n\tkfree(buf);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kobj_attribute *cache_index_opt_attrs[] = {\n\t&cache_size_attr,\n\t&cache_line_size_attr,\n\t&cache_nr_sets_attr,\n\t&cache_assoc_attr,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct kobj_attribute *cache_index_opt_attrs[] = {\n\t&cache_size_attr,\n\t&cache_line_size_attr,\n\t&cache_nr_sets_attr,\n\t&cache_assoc_attr,\n};\n\nstatic void cacheinfo_create_index_opt_attrs(struct cache_index_dir *dir)\n{\n\tconst char *cache_type;\n\tstruct cache *cache;\n\tchar *buf;\n\tint i;\n\n\tbuf = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (!buf)\n\t\treturn;\n\n\tcache = dir->cache;\n\tcache_type = cache_type_string(cache);\n\n\t/* We don't want to create an attribute that can't provide a\n\t * meaningful value.  Check the return value of each optional\n\t * attribute's ->show method before registering the\n\t * attribute.\n\t */\n\tfor (i = 0; i < ARRAY_SIZE(cache_index_opt_attrs); i++) {\n\t\tstruct kobj_attribute *attr;\n\t\tssize_t rc;\n\n\t\tattr = cache_index_opt_attrs[i];\n\n\t\trc = attr->show(&dir->kobj, attr, buf);\n\t\tif (rc <= 0) {\n\t\t\tpr_debug(\"not creating %s attribute for \"\n\t\t\t\t \"%pOFP(%s) (rc = %zd)\\n\",\n\t\t\t\t attr->attr.name, cache->ofnode,\n\t\t\t\t cache_type, rc);\n\t\t\tcontinue;\n\t\t}\n\t\tif (sysfs_create_file(&dir->kobj, &attr->attr))\n\t\t\tpr_debug(\"could not create %s attribute for %pOFP(%s)\\n\",\n\t\t\t\t attr->attr.name, cache->ofnode, cache_type);\n\t}\n\n\tkfree(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&index_dir->kobj"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_init_and_add",
          "args": [
            "&index_dir->kobj",
            "&cache_index_type",
            "cache_dir->kobj",
            "\"index%d\"",
            "index"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*index_dir)",
            "GFP_KERNEL"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct kobj_type cache_index_type = {\n\t.release = cache_index_release,\n\t.sysfs_ops = &cache_index_ops,\n\t.default_attrs = cache_index_default_attrs,\n};\n\nstatic void cacheinfo_create_index_dir(struct cache *cache, int index,\n\t\t\t\t       struct cache_dir *cache_dir)\n{\n\tstruct cache_index_dir *index_dir;\n\tint rc;\n\n\tindex_dir = kzalloc(sizeof(*index_dir), GFP_KERNEL);\n\tif (!index_dir)\n\t\treturn;\n\n\tindex_dir->cache = cache;\n\n\trc = kobject_init_and_add(&index_dir->kobj, &cache_index_type,\n\t\t\t\t  cache_dir->kobj, \"index%d\", index);\n\tif (rc) {\n\t\tkobject_put(&index_dir->kobj);\n\t\treturn;\n\t}\n\n\tindex_dir->next = cache_dir->index;\n\tcache_dir->index = index_dir;\n\n\tcacheinfo_create_index_opt_attrs(index_dir);\n}"
  },
  {
    "function_name": "cacheinfo_create_index_opt_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "736-775",
    "snippet": "static void cacheinfo_create_index_opt_attrs(struct cache_index_dir *dir)\n{\n\tconst char *cache_type;\n\tstruct cache *cache;\n\tchar *buf;\n\tint i;\n\n\tbuf = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (!buf)\n\t\treturn;\n\n\tcache = dir->cache;\n\tcache_type = cache_type_string(cache);\n\n\t/* We don't want to create an attribute that can't provide a\n\t * meaningful value.  Check the return value of each optional\n\t * attribute's ->show method before registering the\n\t * attribute.\n\t */\n\tfor (i = 0; i < ARRAY_SIZE(cache_index_opt_attrs); i++) {\n\t\tstruct kobj_attribute *attr;\n\t\tssize_t rc;\n\n\t\tattr = cache_index_opt_attrs[i];\n\n\t\trc = attr->show(&dir->kobj, attr, buf);\n\t\tif (rc <= 0) {\n\t\t\tpr_debug(\"not creating %s attribute for \"\n\t\t\t\t \"%pOFP(%s) (rc = %zd)\\n\",\n\t\t\t\t attr->attr.name, cache->ofnode,\n\t\t\t\t cache_type, rc);\n\t\t\tcontinue;\n\t\t}\n\t\tif (sysfs_create_file(&dir->kobj, &attr->attr))\n\t\t\tpr_debug(\"could not create %s attribute for %pOFP(%s)\\n\",\n\t\t\t\t attr->attr.name, cache->ofnode, cache_type);\n\t}\n\n\tkfree(buf);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_attribute *cache_index_opt_attrs[] = {\n\t&cache_size_attr,\n\t&cache_line_size_attr,\n\t&cache_nr_sets_attr,\n\t&cache_assoc_attr,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "buf"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"could not create %s attribute for %pOFP(%s)\\n\"",
            "attr->attr.name",
            "cache->ofnode",
            "cache_type"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_create_file",
          "args": [
            "&dir->kobj",
            "&attr->attr"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"not creating %s attribute for \"\n\t\t\t\t \"%pOFP(%s) (rc = %zd)\\n\"",
            "attr->attr.name",
            "cache->ofnode",
            "cache_type",
            "rc"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attr->show",
          "args": [
            "&dir->kobj",
            "attr",
            "buf"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "cache_index_opt_attrs"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_type_string",
          "args": [
            "cache"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "cache_type_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "139-142",
          "snippet": "static const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "PAGE_SIZE",
            "GFP_KERNEL"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct kobj_attribute *cache_index_opt_attrs[] = {\n\t&cache_size_attr,\n\t&cache_line_size_attr,\n\t&cache_nr_sets_attr,\n\t&cache_assoc_attr,\n};\n\nstatic void cacheinfo_create_index_opt_attrs(struct cache_index_dir *dir)\n{\n\tconst char *cache_type;\n\tstruct cache *cache;\n\tchar *buf;\n\tint i;\n\n\tbuf = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (!buf)\n\t\treturn;\n\n\tcache = dir->cache;\n\tcache_type = cache_type_string(cache);\n\n\t/* We don't want to create an attribute that can't provide a\n\t * meaningful value.  Check the return value of each optional\n\t * attribute's ->show method before registering the\n\t * attribute.\n\t */\n\tfor (i = 0; i < ARRAY_SIZE(cache_index_opt_attrs); i++) {\n\t\tstruct kobj_attribute *attr;\n\t\tssize_t rc;\n\n\t\tattr = cache_index_opt_attrs[i];\n\n\t\trc = attr->show(&dir->kobj, attr, buf);\n\t\tif (rc <= 0) {\n\t\t\tpr_debug(\"not creating %s attribute for \"\n\t\t\t\t \"%pOFP(%s) (rc = %zd)\\n\",\n\t\t\t\t attr->attr.name, cache->ofnode,\n\t\t\t\t cache_type, rc);\n\t\t\tcontinue;\n\t\t}\n\t\tif (sysfs_create_file(&dir->kobj, &attr->attr))\n\t\t\tpr_debug(\"could not create %s attribute for %pOFP(%s)\\n\",\n\t\t\t\t attr->attr.name, cache->ofnode, cache_type);\n\t}\n\n\tkfree(buf);\n}"
  },
  {
    "function_name": "shared_cpu_list_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "693-696",
    "snippet": "static ssize_t shared_cpu_list_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\treturn show_shared_cpumap(k, attr, buf, true);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "show_shared_cpumap",
          "args": [
            "k",
            "attr",
            "buf",
            "true"
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "show_shared_cpumap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "667-686",
          "snippet": "static ssize_t\nshow_shared_cpumap(struct kobject *k, struct kobj_attribute *attr, char *buf, bool list)\n{\n\tstruct cache_index_dir *index;\n\tstruct cache *cache;\n\tconst struct cpumask *mask;\n\tint cpu;\n\n\tindex = kobj_to_cache_index_dir(k);\n\tcache = index->cache;\n\n\tif (has_big_cores) {\n\t\tcpu = index_dir_to_cpu(index);\n\t\tmask = get_big_core_shared_cpu_map(cpu, cache);\n\t} else {\n\t\tmask  = &cache->shared_cpu_map;\n\t}\n\n\treturn cpumap_print_to_pagebuf(list, buf, mask);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t\nshow_shared_cpumap(struct kobject *k, struct kobj_attribute *attr, char *buf, bool list)\n{\n\tstruct cache_index_dir *index;\n\tstruct cache *cache;\n\tconst struct cpumask *mask;\n\tint cpu;\n\n\tindex = kobj_to_cache_index_dir(k);\n\tcache = index->cache;\n\n\tif (has_big_cores) {\n\t\tcpu = index_dir_to_cpu(index);\n\t\tmask = get_big_core_shared_cpu_map(cpu, cache);\n\t} else {\n\t\tmask  = &cache->shared_cpu_map;\n\t}\n\n\treturn cpumap_print_to_pagebuf(list, buf, mask);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t shared_cpu_list_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\treturn show_shared_cpumap(k, attr, buf, true);\n}"
  },
  {
    "function_name": "shared_cpu_map_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "688-691",
    "snippet": "static ssize_t shared_cpu_map_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\treturn show_shared_cpumap(k, attr, buf, false);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "show_shared_cpumap",
          "args": [
            "k",
            "attr",
            "buf",
            "false"
          ],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "show_shared_cpumap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "667-686",
          "snippet": "static ssize_t\nshow_shared_cpumap(struct kobject *k, struct kobj_attribute *attr, char *buf, bool list)\n{\n\tstruct cache_index_dir *index;\n\tstruct cache *cache;\n\tconst struct cpumask *mask;\n\tint cpu;\n\n\tindex = kobj_to_cache_index_dir(k);\n\tcache = index->cache;\n\n\tif (has_big_cores) {\n\t\tcpu = index_dir_to_cpu(index);\n\t\tmask = get_big_core_shared_cpu_map(cpu, cache);\n\t} else {\n\t\tmask  = &cache->shared_cpu_map;\n\t}\n\n\treturn cpumap_print_to_pagebuf(list, buf, mask);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t\nshow_shared_cpumap(struct kobject *k, struct kobj_attribute *attr, char *buf, bool list)\n{\n\tstruct cache_index_dir *index;\n\tstruct cache *cache;\n\tconst struct cpumask *mask;\n\tint cpu;\n\n\tindex = kobj_to_cache_index_dir(k);\n\tcache = index->cache;\n\n\tif (has_big_cores) {\n\t\tcpu = index_dir_to_cpu(index);\n\t\tmask = get_big_core_shared_cpu_map(cpu, cache);\n\t} else {\n\t\tmask  = &cache->shared_cpu_map;\n\t}\n\n\treturn cpumap_print_to_pagebuf(list, buf, mask);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t shared_cpu_map_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\treturn show_shared_cpumap(k, attr, buf, false);\n}"
  },
  {
    "function_name": "show_shared_cpumap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "667-686",
    "snippet": "static ssize_t\nshow_shared_cpumap(struct kobject *k, struct kobj_attribute *attr, char *buf, bool list)\n{\n\tstruct cache_index_dir *index;\n\tstruct cache *cache;\n\tconst struct cpumask *mask;\n\tint cpu;\n\n\tindex = kobj_to_cache_index_dir(k);\n\tcache = index->cache;\n\n\tif (has_big_cores) {\n\t\tcpu = index_dir_to_cpu(index);\n\t\tmask = get_big_core_shared_cpu_map(cpu, cache);\n\t} else {\n\t\tmask  = &cache->shared_cpu_map;\n\t}\n\n\treturn cpumap_print_to_pagebuf(list, buf, mask);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumap_print_to_pagebuf",
          "args": [
            "list",
            "buf",
            "mask"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_big_core_shared_cpu_map",
          "args": [
            "cpu",
            "cache"
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "get_big_core_shared_cpu_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "659-665",
          "snippet": "static const struct cpumask *get_big_core_shared_cpu_map(int cpu, struct cache *cache)\n{\n\tif (cache->level == 1)\n\t\treturn cpu_smallcore_mask(cpu);\n\n\treturn &cache->shared_cpu_map;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cpumask *get_big_core_shared_cpu_map(int cpu, struct cache *cache)\n{\n\tif (cache->level == 1)\n\t\treturn cpu_smallcore_mask(cpu);\n\n\treturn &cache->shared_cpu_map;\n}"
        }
      },
      {
        "call_info": {
          "callee": "index_dir_to_cpu",
          "args": [
            "index"
          ],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "index_dir_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "644-652",
          "snippet": "static unsigned int index_dir_to_cpu(struct cache_index_dir *index)\n{\n\tstruct kobject *index_dir_kobj = &index->kobj;\n\tstruct kobject *cache_dir_kobj = index_dir_kobj->parent;\n\tstruct kobject *cpu_dev_kobj = cache_dir_kobj->parent;\n\tstruct device *dev = kobj_to_dev(cpu_dev_kobj);\n\n\treturn dev->id;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic unsigned int index_dir_to_cpu(struct cache_index_dir *index)\n{\n\tstruct kobject *index_dir_kobj = &index->kobj;\n\tstruct kobject *cache_dir_kobj = index_dir_kobj->parent;\n\tstruct kobject *cpu_dev_kobj = cache_dir_kobj->parent;\n\tstruct device *dev = kobj_to_dev(cpu_dev_kobj);\n\n\treturn dev->id;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobj_to_cache_index_dir",
          "args": [
            "k"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "kobj_to_cache_index_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "134-137",
          "snippet": "static struct cache_index_dir *kobj_to_cache_index_dir(struct kobject *k)\n{\n\treturn container_of(k, struct cache_index_dir, kobj);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache_index_dir *kobj_to_cache_index_dir(struct kobject *k)\n{\n\treturn container_of(k, struct cache_index_dir, kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t\nshow_shared_cpumap(struct kobject *k, struct kobj_attribute *attr, char *buf, bool list)\n{\n\tstruct cache_index_dir *index;\n\tstruct cache *cache;\n\tconst struct cpumask *mask;\n\tint cpu;\n\n\tindex = kobj_to_cache_index_dir(k);\n\tcache = index->cache;\n\n\tif (has_big_cores) {\n\t\tcpu = index_dir_to_cpu(index);\n\t\tmask = get_big_core_shared_cpu_map(cpu, cache);\n\t} else {\n\t\tmask  = &cache->shared_cpu_map;\n\t}\n\n\treturn cpumap_print_to_pagebuf(list, buf, mask);\n}"
  },
  {
    "function_name": "get_big_core_shared_cpu_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "659-665",
    "snippet": "static const struct cpumask *get_big_core_shared_cpu_map(int cpu, struct cache *cache)\n{\n\tif (cache->level == 1)\n\t\treturn cpu_smallcore_mask(cpu);\n\n\treturn &cache->shared_cpu_map;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_smallcore_mask",
          "args": [
            "cpu"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cpumask *get_big_core_shared_cpu_map(int cpu, struct cache *cache)\n{\n\tif (cache->level == 1)\n\t\treturn cpu_smallcore_mask(cpu);\n\n\treturn &cache->shared_cpu_map;\n}"
  },
  {
    "function_name": "index_dir_to_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "644-652",
    "snippet": "static unsigned int index_dir_to_cpu(struct cache_index_dir *index)\n{\n\tstruct kobject *index_dir_kobj = &index->kobj;\n\tstruct kobject *cache_dir_kobj = index_dir_kobj->parent;\n\tstruct kobject *cpu_dev_kobj = cache_dir_kobj->parent;\n\tstruct device *dev = kobj_to_dev(cpu_dev_kobj);\n\n\treturn dev->id;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobj_to_dev",
          "args": [
            "cpu_dev_kobj"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic unsigned int index_dir_to_cpu(struct cache_index_dir *index)\n{\n\tstruct kobject *index_dir_kobj = &index->kobj;\n\tstruct kobject *cache_dir_kobj = index_dir_kobj->parent;\n\tstruct kobject *cpu_dev_kobj = cache_dir_kobj->parent;\n\tstruct device *dev = kobj_to_dev(cpu_dev_kobj);\n\n\treturn dev->id;\n}"
  },
  {
    "function_name": "level_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "630-639",
    "snippet": "static ssize_t level_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tstruct cache_index_dir *index;\n\tstruct cache *cache;\n\n\tindex = kobj_to_cache_index_dir(k);\n\tcache = index->cache;\n\n\treturn sprintf(buf, \"%d\\n\", cache->level);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "cache->level"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobj_to_cache_index_dir",
          "args": [
            "k"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "kobj_to_cache_index_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "134-137",
          "snippet": "static struct cache_index_dir *kobj_to_cache_index_dir(struct kobject *k)\n{\n\treturn container_of(k, struct cache_index_dir, kobj);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache_index_dir *kobj_to_cache_index_dir(struct kobject *k)\n{\n\treturn container_of(k, struct cache_index_dir, kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t level_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tstruct cache_index_dir *index;\n\tstruct cache *cache;\n\n\tindex = kobj_to_cache_index_dir(k);\n\tcache = index->cache;\n\n\treturn sprintf(buf, \"%d\\n\", cache->level);\n}"
  },
  {
    "function_name": "type_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "618-625",
    "snippet": "static ssize_t type_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tstruct cache *cache;\n\n\tcache = index_kobj_to_cache(k);\n\n\treturn sprintf(buf, \"%s\\n\", cache_type_string(cache));\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%s\\n\"",
            "cache_type_string(cache)"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_type_string",
          "args": [
            "cache"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "cache_type_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "139-142",
          "snippet": "static const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "index_kobj_to_cache",
          "args": [
            "k"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "index_kobj_to_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "544-551",
          "snippet": "static struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t type_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tstruct cache *cache;\n\n\tcache = index_kobj_to_cache(k);\n\n\treturn sprintf(buf, \"%s\\n\", cache_type_string(cache));\n}"
  },
  {
    "function_name": "associativity_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "602-613",
    "snippet": "static ssize_t associativity_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tunsigned int associativity;\n\tstruct cache *cache;\n\n\tcache = index_kobj_to_cache(k);\n\n\tif (cache_associativity(cache, &associativity))\n\t\treturn -ENODEV;\n\n\treturn sprintf(buf, \"%u\\n\", associativity);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%u\\n\"",
            "associativity"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_associativity",
          "args": [
            "cache",
            "&associativity"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "cache_associativity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "271-300",
          "snippet": "static int cache_associativity(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int line_size;\n\tunsigned int nr_sets;\n\tunsigned int size;\n\n\tif (cache_nr_sets(cache, &nr_sets))\n\t\tgoto err;\n\n\t/* If the cache is fully associative, there is no need to\n\t * check the other properties.\n\t */\n\tif (nr_sets == 1) {\n\t\t*ret = 0;\n\t\treturn 0;\n\t}\n\n\tif (cache_get_line_size(cache, &line_size))\n\t\tgoto err;\n\tif (cache_size(cache, &size))\n\t\tgoto err;\n\n\tif (!(nr_sets > 0 && size > 0 && line_size > 0))\n\t\tgoto err;\n\n\t*ret = (size / nr_sets) / line_size;\n\treturn 0;\nerr:\n\treturn -ENODEV;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic int cache_associativity(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int line_size;\n\tunsigned int nr_sets;\n\tunsigned int size;\n\n\tif (cache_nr_sets(cache, &nr_sets))\n\t\tgoto err;\n\n\t/* If the cache is fully associative, there is no need to\n\t * check the other properties.\n\t */\n\tif (nr_sets == 1) {\n\t\t*ret = 0;\n\t\treturn 0;\n\t}\n\n\tif (cache_get_line_size(cache, &line_size))\n\t\tgoto err;\n\tif (cache_size(cache, &size))\n\t\tgoto err;\n\n\tif (!(nr_sets > 0 && size > 0 && line_size > 0))\n\t\tgoto err;\n\n\t*ret = (size / nr_sets) / line_size;\n\treturn 0;\nerr:\n\treturn -ENODEV;\n}"
        }
      },
      {
        "call_info": {
          "callee": "index_kobj_to_cache",
          "args": [
            "k"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "index_kobj_to_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "544-551",
          "snippet": "static struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t associativity_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tunsigned int associativity;\n\tstruct cache *cache;\n\n\tcache = index_kobj_to_cache(k);\n\n\tif (cache_associativity(cache, &associativity))\n\t\treturn -ENODEV;\n\n\treturn sprintf(buf, \"%u\\n\", associativity);\n}"
  },
  {
    "function_name": "nr_sets_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "586-597",
    "snippet": "static ssize_t nr_sets_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tunsigned int nr_sets;\n\tstruct cache *cache;\n\n\tcache = index_kobj_to_cache(k);\n\n\tif (cache_nr_sets(cache, &nr_sets))\n\t\treturn -ENODEV;\n\n\treturn sprintf(buf, \"%u\\n\", nr_sets);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%u\\n\"",
            "nr_sets"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_nr_sets",
          "args": [
            "cache",
            "&nr_sets"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "cache_nr_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "256-269",
          "snippet": "static int cache_nr_sets(const struct cache *cache, unsigned int *ret)\n{\n\tconst char *propname;\n\tconst __be32 *nr_sets;\n\n\tpropname = cache_type_info[cache->type].nr_sets_prop;\n\n\tnr_sets = of_get_property(cache->ofnode, propname, NULL);\n\tif (!nr_sets)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(nr_sets, 1);\n\treturn 0;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic int cache_nr_sets(const struct cache *cache, unsigned int *ret)\n{\n\tconst char *propname;\n\tconst __be32 *nr_sets;\n\n\tpropname = cache_type_info[cache->type].nr_sets_prop;\n\n\tnr_sets = of_get_property(cache->ofnode, propname, NULL);\n\tif (!nr_sets)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(nr_sets, 1);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "index_kobj_to_cache",
          "args": [
            "k"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "index_kobj_to_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "544-551",
          "snippet": "static struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t nr_sets_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tunsigned int nr_sets;\n\tstruct cache *cache;\n\n\tcache = index_kobj_to_cache(k);\n\n\tif (cache_nr_sets(cache, &nr_sets))\n\t\treturn -ENODEV;\n\n\treturn sprintf(buf, \"%u\\n\", nr_sets);\n}"
  },
  {
    "function_name": "line_size_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "570-581",
    "snippet": "static ssize_t line_size_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tunsigned int line_size;\n\tstruct cache *cache;\n\n\tcache = index_kobj_to_cache(k);\n\n\tif (cache_get_line_size(cache, &line_size))\n\t\treturn -ENODEV;\n\n\treturn sprintf(buf, \"%u\\n\", line_size);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%u\\n\"",
            "line_size"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_get_line_size",
          "args": [
            "cache",
            "&line_size"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "cache_get_line_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "233-254",
          "snippet": "static int cache_get_line_size(const struct cache *cache, unsigned int *ret)\n{\n\tconst __be32 *line_size;\n\tint i, lim;\n\n\tlim = ARRAY_SIZE(cache_type_info[cache->type].line_size_props);\n\n\tfor (i = 0; i < lim; i++) {\n\t\tconst char *propname;\n\n\t\tpropname = cache_type_info[cache->type].line_size_props[i];\n\t\tline_size = of_get_property(cache->ofnode, propname, NULL);\n\t\tif (line_size)\n\t\t\tbreak;\n\t}\n\n\tif (!line_size)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(line_size, 1);\n\treturn 0;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic int cache_get_line_size(const struct cache *cache, unsigned int *ret)\n{\n\tconst __be32 *line_size;\n\tint i, lim;\n\n\tlim = ARRAY_SIZE(cache_type_info[cache->type].line_size_props);\n\n\tfor (i = 0; i < lim; i++) {\n\t\tconst char *propname;\n\n\t\tpropname = cache_type_info[cache->type].line_size_props[i];\n\t\tline_size = of_get_property(cache->ofnode, propname, NULL);\n\t\tif (line_size)\n\t\t\tbreak;\n\t}\n\n\tif (!line_size)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(line_size, 1);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "index_kobj_to_cache",
          "args": [
            "k"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "index_kobj_to_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "544-551",
          "snippet": "static struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t line_size_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tunsigned int line_size;\n\tstruct cache *cache;\n\n\tcache = index_kobj_to_cache(k);\n\n\tif (cache_get_line_size(cache, &line_size))\n\t\treturn -ENODEV;\n\n\treturn sprintf(buf, \"%u\\n\", line_size);\n}"
  },
  {
    "function_name": "size_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "553-564",
    "snippet": "static ssize_t size_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tunsigned int size_kb;\n\tstruct cache *cache;\n\n\tcache = index_kobj_to_cache(k);\n\n\tif (cache_size_kb(cache, &size_kb))\n\t\treturn -ENODEV;\n\n\treturn sprintf(buf, \"%uK\\n\", size_kb);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%uK\\n\"",
            "size_kb"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_size_kb",
          "args": [
            "cache",
            "&size_kb"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "cache_size_kb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "221-230",
          "snippet": "static int cache_size_kb(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int size;\n\n\tif (cache_size(cache, &size))\n\t\treturn -ENODEV;\n\n\t*ret = size / 1024;\n\treturn 0;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic int cache_size_kb(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int size;\n\n\tif (cache_size(cache, &size))\n\t\treturn -ENODEV;\n\n\t*ret = size / 1024;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "index_kobj_to_cache",
          "args": [
            "k"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "index_kobj_to_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "544-551",
          "snippet": "static struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t size_show(struct kobject *k, struct kobj_attribute *attr, char *buf)\n{\n\tunsigned int size_kb;\n\tstruct cache *cache;\n\n\tcache = index_kobj_to_cache(k);\n\n\tif (cache_size_kb(cache, &size_kb))\n\t\treturn -ENODEV;\n\n\treturn sprintf(buf, \"%uK\\n\", size_kb);\n}"
  },
  {
    "function_name": "index_kobj_to_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "544-551",
    "snippet": "static struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobj_to_cache_index_dir",
          "args": [
            "k"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "kobj_to_cache_index_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "134-137",
          "snippet": "static struct cache_index_dir *kobj_to_cache_index_dir(struct kobject *k)\n{\n\treturn container_of(k, struct cache_index_dir, kobj);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache_index_dir *kobj_to_cache_index_dir(struct kobject *k)\n{\n\treturn container_of(k, struct cache_index_dir, kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *index_kobj_to_cache(struct kobject *k)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(k);\n\n\treturn index->cache;\n}"
  },
  {
    "function_name": "cache_index_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "535-542",
    "snippet": "static ssize_t cache_index_show(struct kobject *k, struct attribute *attr, char *buf)\n{\n\tstruct kobj_attribute *kobj_attr;\n\n\tkobj_attr = container_of(attr, struct kobj_attribute, attr);\n\n\treturn kobj_attr->show(k, kobj_attr, buf);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobj_attr->show",
          "args": [
            "k",
            "kobj_attr",
            "buf"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "attr",
            "structkobj_attribute",
            "attr"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic ssize_t cache_index_show(struct kobject *k, struct attribute *attr, char *buf)\n{\n\tstruct kobj_attribute *kobj_attr;\n\n\tkobj_attr = container_of(attr, struct kobj_attribute, attr);\n\n\treturn kobj_attr->show(k, kobj_attr, buf);\n}"
  },
  {
    "function_name": "cache_index_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "523-533",
    "snippet": "static void cache_index_release(struct kobject *kobj)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(kobj);\n\n\tpr_debug(\"freeing index directory for L%d %s cache\\n\",\n\t\t index->cache->level, cache_type_string(index->cache));\n\n\tkfree(index);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "index"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"freeing index directory for L%d %s cache\\n\"",
            "index->cache->level",
            "cache_type_string(index->cache)"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_type_string",
          "args": [
            "index->cache"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "cache_type_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "139-142",
          "snippet": "static const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobj_to_cache_index_dir",
          "args": [
            "kobj"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "kobj_to_cache_index_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "134-137",
          "snippet": "static struct cache_index_dir *kobj_to_cache_index_dir(struct kobject *k)\n{\n\treturn container_of(k, struct cache_index_dir, kobj);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache_index_dir *kobj_to_cache_index_dir(struct kobject *k)\n{\n\treturn container_of(k, struct cache_index_dir, kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void cache_index_release(struct kobject *kobj)\n{\n\tstruct cache_index_dir *index;\n\n\tindex = kobj_to_cache_index_dir(kobj);\n\n\tpr_debug(\"freeing index directory for L%d %s cache\\n\",\n\t\t index->cache->level, cache_type_string(index->cache));\n\n\tkfree(index);\n}"
  },
  {
    "function_name": "cacheinfo_create_cache_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "492-521",
    "snippet": "static struct cache_dir *cacheinfo_create_cache_dir(unsigned int cpu_id)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct device *dev;\n\tstruct kobject *kobj = NULL;\n\n\tdev = get_cpu_device(cpu_id);\n\tWARN_ONCE(!dev, \"no dev for CPU %i\\n\", cpu_id);\n\tif (!dev)\n\t\tgoto err;\n\n\tkobj = kobject_create_and_add(\"cache\", &dev->kobj);\n\tif (!kobj)\n\t\tgoto err;\n\n\tcache_dir = kzalloc(sizeof(*cache_dir), GFP_KERNEL);\n\tif (!cache_dir)\n\t\tgoto err;\n\n\tcache_dir->kobj = kobj;\n\n\tWARN_ON_ONCE(per_cpu(cache_dir_pcpu, cpu_id) != NULL);\n\n\tper_cpu(cache_dir_pcpu, cpu_id) = cache_dir;\n\n\treturn cache_dir;\nerr:\n\tkobject_put(kobj);\n\treturn NULL;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct cache_dir *, cache_dir_pcpu);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "kobj"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cache_dir_pcpu",
            "cpu_id"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "per_cpu(cache_dir_pcpu, cpu_id) != NULL"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "cache_dir_pcpu",
            "cpu_id"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*cache_dir)",
            "GFP_KERNEL"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_create_and_add",
          "args": [
            "\"cache\"",
            "&dev->kobj"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "!dev",
            "\"no dev for CPU %i\\n\"",
            "cpu_id"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_device",
          "args": [
            "cpu_id"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic DEFINE_PER_CPU(struct cache_dir *, cache_dir_pcpu);\n\nstatic struct cache_dir *cacheinfo_create_cache_dir(unsigned int cpu_id)\n{\n\tstruct cache_dir *cache_dir;\n\tstruct device *dev;\n\tstruct kobject *kobj = NULL;\n\n\tdev = get_cpu_device(cpu_id);\n\tWARN_ONCE(!dev, \"no dev for CPU %i\\n\", cpu_id);\n\tif (!dev)\n\t\tgoto err;\n\n\tkobj = kobject_create_and_add(\"cache\", &dev->kobj);\n\tif (!kobj)\n\t\tgoto err;\n\n\tcache_dir = kzalloc(sizeof(*cache_dir), GFP_KERNEL);\n\tif (!cache_dir)\n\t\tgoto err;\n\n\tcache_dir->kobj = kobj;\n\n\tWARN_ON_ONCE(per_cpu(cache_dir_pcpu, cpu_id) != NULL);\n\n\tper_cpu(cache_dir_pcpu, cpu_id) = cache_dir;\n\n\treturn cache_dir;\nerr:\n\tkobject_put(kobj);\n\treturn NULL;\n}"
  },
  {
    "function_name": "cache_chain_instantiate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "467-490",
    "snippet": "static struct cache *cache_chain_instantiate(unsigned int cpu_id)\n{\n\tstruct device_node *cpu_node;\n\tstruct cache *cpu_cache = NULL;\n\n\tpr_debug(\"creating cache object(s) for CPU %i\\n\", cpu_id);\n\n\tcpu_node = of_get_cpu_node(cpu_id, NULL);\n\tWARN_ONCE(!cpu_node, \"no OF node found for CPU %i\\n\", cpu_id);\n\tif (!cpu_node)\n\t\tgoto out;\n\n\tcpu_cache = cache_lookup_or_instantiate(cpu_node, 1);\n\tif (!cpu_cache)\n\t\tgoto out;\n\n\tdo_subsidiary_caches(cpu_cache);\n\n\tcache_cpu_set(cpu_cache, cpu_id);\nout:\n\tof_node_put(cpu_node);\n\n\treturn cpu_cache;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "cpu_node"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_cpu_set",
          "args": [
            "cpu_cache",
            "cpu_id"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "cache_cpu_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "192-204",
          "snippet": "static void cache_cpu_set(struct cache *cache, int cpu)\n{\n\tstruct cache *next = cache;\n\n\twhile (next) {\n\t\tWARN_ONCE(cpumask_test_cpu(cpu, &next->shared_cpu_map),\n\t\t\t  \"CPU %i already accounted in %pOFP(%s)\\n\",\n\t\t\t  cpu, next->ofnode,\n\t\t\t  cache_type_string(next));\n\t\tcpumask_set_cpu(cpu, &next->shared_cpu_map);\n\t\tnext = next->next_local;\n\t}\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void cache_cpu_set(struct cache *cache, int cpu)\n{\n\tstruct cache *next = cache;\n\n\twhile (next) {\n\t\tWARN_ONCE(cpumask_test_cpu(cpu, &next->shared_cpu_map),\n\t\t\t  \"CPU %i already accounted in %pOFP(%s)\\n\",\n\t\t\t  cpu, next->ofnode,\n\t\t\t  cache_type_string(next));\n\t\tcpumask_set_cpu(cpu, &next->shared_cpu_map);\n\t\tnext = next->next_local;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_subsidiary_caches",
          "args": [
            "cpu_cache"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "do_subsidiary_caches",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "446-465",
          "snippet": "static void do_subsidiary_caches(struct cache *cache)\n{\n\tstruct device_node *subcache_node;\n\tint level = cache->level;\n\n\tdo_subsidiary_caches_debugcheck(cache);\n\n\twhile ((subcache_node = of_find_next_cache_node(cache->ofnode))) {\n\t\tstruct cache *subcache;\n\n\t\tlevel++;\n\t\tsubcache = cache_lookup_or_instantiate(subcache_node, level);\n\t\tof_node_put(subcache_node);\n\t\tif (!subcache)\n\t\t\tbreak;\n\n\t\tlink_cache_lists(cache, subcache);\n\t\tcache = subcache;\n\t}\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void do_subsidiary_caches(struct cache *cache)\n{\n\tstruct device_node *subcache_node;\n\tint level = cache->level;\n\n\tdo_subsidiary_caches_debugcheck(cache);\n\n\twhile ((subcache_node = of_find_next_cache_node(cache->ofnode))) {\n\t\tstruct cache *subcache;\n\n\t\tlevel++;\n\t\tsubcache = cache_lookup_or_instantiate(subcache_node, level);\n\t\tof_node_put(subcache_node);\n\t\tif (!subcache)\n\t\t\tbreak;\n\n\t\tlink_cache_lists(cache, subcache);\n\t\tcache = subcache;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_lookup_or_instantiate",
          "args": [
            "cpu_node",
            "1"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "cache_lookup_or_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "397-412",
          "snippet": "static struct cache *cache_lookup_or_instantiate(struct device_node *node,\n\t\t\t\t\t\t int level)\n{\n\tstruct cache *cache;\n\n\tcache = cache_lookup_by_node(node);\n\n\tWARN_ONCE(cache && cache->level != level,\n\t\t  \"cache level mismatch on lookup (got %d, expected %d)\\n\",\n\t\t  cache->level, level);\n\n\tif (!cache)\n\t\tcache = cache_do_one_devnode(node, level);\n\n\treturn cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_lookup_or_instantiate(struct device_node *node,\n\t\t\t\t\t\t int level)\n{\n\tstruct cache *cache;\n\n\tcache = cache_lookup_by_node(node);\n\n\tWARN_ONCE(cache && cache->level != level,\n\t\t  \"cache level mismatch on lookup (got %d, expected %d)\\n\",\n\t\t  cache->level, level);\n\n\tif (!cache)\n\t\tcache = cache_do_one_devnode(node, level);\n\n\treturn cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "!cpu_node",
            "\"no OF node found for CPU %i\\n\"",
            "cpu_id"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_cpu_node",
          "args": [
            "cpu_id",
            "NULL"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"creating cache object(s) for CPU %i\\n\"",
            "cpu_id"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_chain_instantiate(unsigned int cpu_id)\n{\n\tstruct device_node *cpu_node;\n\tstruct cache *cpu_cache = NULL;\n\n\tpr_debug(\"creating cache object(s) for CPU %i\\n\", cpu_id);\n\n\tcpu_node = of_get_cpu_node(cpu_id, NULL);\n\tWARN_ONCE(!cpu_node, \"no OF node found for CPU %i\\n\", cpu_id);\n\tif (!cpu_node)\n\t\tgoto out;\n\n\tcpu_cache = cache_lookup_or_instantiate(cpu_node, 1);\n\tif (!cpu_cache)\n\t\tgoto out;\n\n\tdo_subsidiary_caches(cpu_cache);\n\n\tcache_cpu_set(cpu_cache, cpu_id);\nout:\n\tof_node_put(cpu_node);\n\n\treturn cpu_cache;\n}"
  },
  {
    "function_name": "do_subsidiary_caches",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "446-465",
    "snippet": "static void do_subsidiary_caches(struct cache *cache)\n{\n\tstruct device_node *subcache_node;\n\tint level = cache->level;\n\n\tdo_subsidiary_caches_debugcheck(cache);\n\n\twhile ((subcache_node = of_find_next_cache_node(cache->ofnode))) {\n\t\tstruct cache *subcache;\n\n\t\tlevel++;\n\t\tsubcache = cache_lookup_or_instantiate(subcache_node, level);\n\t\tof_node_put(subcache_node);\n\t\tif (!subcache)\n\t\t\tbreak;\n\n\t\tlink_cache_lists(cache, subcache);\n\t\tcache = subcache;\n\t}\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "link_cache_lists",
          "args": [
            "cache",
            "subcache"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "link_cache_lists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "414-432",
          "snippet": "static void link_cache_lists(struct cache *smaller, struct cache *bigger)\n{\n\twhile (smaller->next_local) {\n\t\tif (smaller->next_local == bigger)\n\t\t\treturn; /* already linked */\n\t\tsmaller = smaller->next_local;\n\t}\n\n\tsmaller->next_local = bigger;\n\n\t/*\n\t * The cache->next_local list sorts by level ascending:\n\t * L1d -> L1i -> L2 -> L3 ...\n\t */\n\tWARN_ONCE((smaller->level == 1 && bigger->level > 2) ||\n\t\t  (smaller->level > 1 && bigger->level != smaller->level + 1),\n\t\t  \"linking L%i cache %pOFP to L%i cache %pOFP; skipped a level?\\n\",\n\t\t  smaller->level, smaller->ofnode, bigger->level, bigger->ofnode);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void link_cache_lists(struct cache *smaller, struct cache *bigger)\n{\n\twhile (smaller->next_local) {\n\t\tif (smaller->next_local == bigger)\n\t\t\treturn; /* already linked */\n\t\tsmaller = smaller->next_local;\n\t}\n\n\tsmaller->next_local = bigger;\n\n\t/*\n\t * The cache->next_local list sorts by level ascending:\n\t * L1d -> L1i -> L2 -> L3 ...\n\t */\n\tWARN_ONCE((smaller->level == 1 && bigger->level > 2) ||\n\t\t  (smaller->level > 1 && bigger->level != smaller->level + 1),\n\t\t  \"linking L%i cache %pOFP to L%i cache %pOFP; skipped a level?\\n\",\n\t\t  smaller->level, smaller->ofnode, bigger->level, bigger->ofnode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "subcache_node"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_lookup_or_instantiate",
          "args": [
            "subcache_node",
            "level"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "cache_lookup_or_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "397-412",
          "snippet": "static struct cache *cache_lookup_or_instantiate(struct device_node *node,\n\t\t\t\t\t\t int level)\n{\n\tstruct cache *cache;\n\n\tcache = cache_lookup_by_node(node);\n\n\tWARN_ONCE(cache && cache->level != level,\n\t\t  \"cache level mismatch on lookup (got %d, expected %d)\\n\",\n\t\t  cache->level, level);\n\n\tif (!cache)\n\t\tcache = cache_do_one_devnode(node, level);\n\n\treturn cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_lookup_or_instantiate(struct device_node *node,\n\t\t\t\t\t\t int level)\n{\n\tstruct cache *cache;\n\n\tcache = cache_lookup_by_node(node);\n\n\tWARN_ONCE(cache && cache->level != level,\n\t\t  \"cache level mismatch on lookup (got %d, expected %d)\\n\",\n\t\t  cache->level, level);\n\n\tif (!cache)\n\t\tcache = cache_do_one_devnode(node, level);\n\n\treturn cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "of_find_next_cache_node",
          "args": [
            "cache->ofnode"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_subsidiary_caches_debugcheck",
          "args": [
            "cache"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "do_subsidiary_caches_debugcheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "434-444",
          "snippet": "static void do_subsidiary_caches_debugcheck(struct cache *cache)\n{\n\tWARN_ONCE(cache->level != 1,\n\t\t  \"instantiating cache chain from L%d %s cache for \"\n\t\t  \"%pOFP instead of an L1\\n\", cache->level,\n\t\t  cache_type_string(cache), cache->ofnode);\n\tWARN_ONCE(!of_node_is_type(cache->ofnode, \"cpu\"),\n\t\t  \"instantiating cache chain from node %pOFP of type '%s' \"\n\t\t  \"instead of a cpu node\\n\", cache->ofnode,\n\t\t  of_node_get_device_type(cache->ofnode));\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void do_subsidiary_caches_debugcheck(struct cache *cache)\n{\n\tWARN_ONCE(cache->level != 1,\n\t\t  \"instantiating cache chain from L%d %s cache for \"\n\t\t  \"%pOFP instead of an L1\\n\", cache->level,\n\t\t  cache_type_string(cache), cache->ofnode);\n\tWARN_ONCE(!of_node_is_type(cache->ofnode, \"cpu\"),\n\t\t  \"instantiating cache chain from node %pOFP of type '%s' \"\n\t\t  \"instead of a cpu node\\n\", cache->ofnode,\n\t\t  of_node_get_device_type(cache->ofnode));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void do_subsidiary_caches(struct cache *cache)\n{\n\tstruct device_node *subcache_node;\n\tint level = cache->level;\n\n\tdo_subsidiary_caches_debugcheck(cache);\n\n\twhile ((subcache_node = of_find_next_cache_node(cache->ofnode))) {\n\t\tstruct cache *subcache;\n\n\t\tlevel++;\n\t\tsubcache = cache_lookup_or_instantiate(subcache_node, level);\n\t\tof_node_put(subcache_node);\n\t\tif (!subcache)\n\t\t\tbreak;\n\n\t\tlink_cache_lists(cache, subcache);\n\t\tcache = subcache;\n\t}\n}"
  },
  {
    "function_name": "do_subsidiary_caches_debugcheck",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "434-444",
    "snippet": "static void do_subsidiary_caches_debugcheck(struct cache *cache)\n{\n\tWARN_ONCE(cache->level != 1,\n\t\t  \"instantiating cache chain from L%d %s cache for \"\n\t\t  \"%pOFP instead of an L1\\n\", cache->level,\n\t\t  cache_type_string(cache), cache->ofnode);\n\tWARN_ONCE(!of_node_is_type(cache->ofnode, \"cpu\"),\n\t\t  \"instantiating cache chain from node %pOFP of type '%s' \"\n\t\t  \"instead of a cpu node\\n\", cache->ofnode,\n\t\t  of_node_get_device_type(cache->ofnode));\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "!of_node_is_type(cache->ofnode, \"cpu\")",
            "\"instantiating cache chain from node %pOFP of type '%s' \"\n\t\t  \"instead of a cpu node\\n\"",
            "cache->ofnode",
            "of_node_get_device_type(cache->ofnode)"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_get_device_type",
          "args": [
            "cache->ofnode"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_is_type",
          "args": [
            "cache->ofnode",
            "\"cpu\""
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "cache->level != 1",
            "\"instantiating cache chain from L%d %s cache for \"\n\t\t  \"%pOFP instead of an L1\\n\"",
            "cache->level",
            "cache_type_string(cache)",
            "cache->ofnode"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_type_string",
          "args": [
            "cache"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "cache_type_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "139-142",
          "snippet": "static const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void do_subsidiary_caches_debugcheck(struct cache *cache)\n{\n\tWARN_ONCE(cache->level != 1,\n\t\t  \"instantiating cache chain from L%d %s cache for \"\n\t\t  \"%pOFP instead of an L1\\n\", cache->level,\n\t\t  cache_type_string(cache), cache->ofnode);\n\tWARN_ONCE(!of_node_is_type(cache->ofnode, \"cpu\"),\n\t\t  \"instantiating cache chain from node %pOFP of type '%s' \"\n\t\t  \"instead of a cpu node\\n\", cache->ofnode,\n\t\t  of_node_get_device_type(cache->ofnode));\n}"
  },
  {
    "function_name": "link_cache_lists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "414-432",
    "snippet": "static void link_cache_lists(struct cache *smaller, struct cache *bigger)\n{\n\twhile (smaller->next_local) {\n\t\tif (smaller->next_local == bigger)\n\t\t\treturn; /* already linked */\n\t\tsmaller = smaller->next_local;\n\t}\n\n\tsmaller->next_local = bigger;\n\n\t/*\n\t * The cache->next_local list sorts by level ascending:\n\t * L1d -> L1i -> L2 -> L3 ...\n\t */\n\tWARN_ONCE((smaller->level == 1 && bigger->level > 2) ||\n\t\t  (smaller->level > 1 && bigger->level != smaller->level + 1),\n\t\t  \"linking L%i cache %pOFP to L%i cache %pOFP; skipped a level?\\n\",\n\t\t  smaller->level, smaller->ofnode, bigger->level, bigger->ofnode);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "(smaller->level == 1 && bigger->level > 2) ||\n\t\t  (smaller->level > 1 && bigger->level != smaller->level + 1)",
            "\"linking L%i cache %pOFP to L%i cache %pOFP; skipped a level?\\n\"",
            "smaller->level",
            "smaller->ofnode",
            "bigger->level",
            "bigger->ofnode"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void link_cache_lists(struct cache *smaller, struct cache *bigger)\n{\n\twhile (smaller->next_local) {\n\t\tif (smaller->next_local == bigger)\n\t\t\treturn; /* already linked */\n\t\tsmaller = smaller->next_local;\n\t}\n\n\tsmaller->next_local = bigger;\n\n\t/*\n\t * The cache->next_local list sorts by level ascending:\n\t * L1d -> L1i -> L2 -> L3 ...\n\t */\n\tWARN_ONCE((smaller->level == 1 && bigger->level > 2) ||\n\t\t  (smaller->level > 1 && bigger->level != smaller->level + 1),\n\t\t  \"linking L%i cache %pOFP to L%i cache %pOFP; skipped a level?\\n\",\n\t\t  smaller->level, smaller->ofnode, bigger->level, bigger->ofnode);\n}"
  },
  {
    "function_name": "cache_lookup_or_instantiate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "397-412",
    "snippet": "static struct cache *cache_lookup_or_instantiate(struct device_node *node,\n\t\t\t\t\t\t int level)\n{\n\tstruct cache *cache;\n\n\tcache = cache_lookup_by_node(node);\n\n\tWARN_ONCE(cache && cache->level != level,\n\t\t  \"cache level mismatch on lookup (got %d, expected %d)\\n\",\n\t\t  cache->level, level);\n\n\tif (!cache)\n\t\tcache = cache_do_one_devnode(node, level);\n\n\treturn cache;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_do_one_devnode",
          "args": [
            "node",
            "level"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "cache_do_one_devnode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "385-395",
          "snippet": "static struct cache *cache_do_one_devnode(struct device_node *node, int level)\n{\n\tstruct cache *cache;\n\n\tif (cache_node_is_unified(node))\n\t\tcache = cache_do_one_devnode_unified(node, level);\n\telse\n\t\tcache = cache_do_one_devnode_split(node, level);\n\n\treturn cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_do_one_devnode(struct device_node *node, int level)\n{\n\tstruct cache *cache;\n\n\tif (cache_node_is_unified(node))\n\t\tcache = cache_do_one_devnode_unified(node, level);\n\telse\n\t\tcache = cache_do_one_devnode_split(node, level);\n\n\treturn cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "cache && cache->level != level",
            "\"cache level mismatch on lookup (got %d, expected %d)\\n\"",
            "cache->level",
            "level"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_lookup_by_node",
          "args": [
            "node"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "cache_lookup_by_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "319-332",
          "snippet": "static struct cache *cache_lookup_by_node(const struct device_node *node)\n{\n\tstruct cache *cache = NULL;\n\tstruct cache *iter;\n\n\tlist_for_each_entry(iter, &cache_list, list) {\n\t\tif (iter->ofnode != node)\n\t\t\tcontinue;\n\t\tcache = cache_find_first_sibling(iter);\n\t\tbreak;\n\t}\n\n\treturn cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(cache_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic LIST_HEAD(cache_list);\n\nstatic struct cache *cache_lookup_by_node(const struct device_node *node)\n{\n\tstruct cache *cache = NULL;\n\tstruct cache *iter;\n\n\tlist_for_each_entry(iter, &cache_list, list) {\n\t\tif (iter->ofnode != node)\n\t\t\tcontinue;\n\t\tcache = cache_find_first_sibling(iter);\n\t\tbreak;\n\t}\n\n\treturn cache;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_lookup_or_instantiate(struct device_node *node,\n\t\t\t\t\t\t int level)\n{\n\tstruct cache *cache;\n\n\tcache = cache_lookup_by_node(node);\n\n\tWARN_ONCE(cache && cache->level != level,\n\t\t  \"cache level mismatch on lookup (got %d, expected %d)\\n\",\n\t\t  cache->level, level);\n\n\tif (!cache)\n\t\tcache = cache_do_one_devnode(node, level);\n\n\treturn cache;\n}"
  },
  {
    "function_name": "cache_do_one_devnode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "385-395",
    "snippet": "static struct cache *cache_do_one_devnode(struct device_node *node, int level)\n{\n\tstruct cache *cache;\n\n\tif (cache_node_is_unified(node))\n\t\tcache = cache_do_one_devnode_unified(node, level);\n\telse\n\t\tcache = cache_do_one_devnode_split(node, level);\n\n\treturn cache;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_do_one_devnode_split",
          "args": [
            "node",
            "level"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "cache_do_one_devnode_split",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "362-383",
          "snippet": "static struct cache *cache_do_one_devnode_split(struct device_node *node,\n\t\t\t\t\t\tint level)\n{\n\tstruct cache *dcache, *icache;\n\n\tpr_debug(\"creating L%d dcache and icache for %pOFP\\n\", level,\n\t\t node);\n\n\tdcache = new_cache(CACHE_TYPE_DATA, level, node);\n\ticache = new_cache(CACHE_TYPE_INSTRUCTION, level, node);\n\n\tif (!dcache || !icache)\n\t\tgoto err;\n\n\tdcache->next_local = icache;\n\n\treturn dcache;\nerr:\n\trelease_cache(dcache);\n\trelease_cache(icache);\n\treturn NULL;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [
            "#define CACHE_TYPE_DATA        3",
            "#define CACHE_TYPE_INSTRUCTION 2"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\n#define CACHE_TYPE_DATA        3\n#define CACHE_TYPE_INSTRUCTION 2\n\nstatic struct cache *cache_do_one_devnode_split(struct device_node *node,\n\t\t\t\t\t\tint level)\n{\n\tstruct cache *dcache, *icache;\n\n\tpr_debug(\"creating L%d dcache and icache for %pOFP\\n\", level,\n\t\t node);\n\n\tdcache = new_cache(CACHE_TYPE_DATA, level, node);\n\ticache = new_cache(CACHE_TYPE_INSTRUCTION, level, node);\n\n\tif (!dcache || !icache)\n\t\tgoto err;\n\n\tdcache->next_local = icache;\n\n\treturn dcache;\nerr:\n\trelease_cache(dcache);\n\trelease_cache(icache);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_do_one_devnode_unified",
          "args": [
            "node",
            "level"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "cache_do_one_devnode_unified",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "355-360",
          "snippet": "static struct cache *cache_do_one_devnode_unified(struct device_node *node, int level)\n{\n\tpr_debug(\"creating L%d ucache for %pOFP\\n\", level, node);\n\n\treturn new_cache(cache_is_unified_d(node), level, node);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_do_one_devnode_unified(struct device_node *node, int level)\n{\n\tpr_debug(\"creating L%d ucache for %pOFP\\n\", level, node);\n\n\treturn new_cache(cache_is_unified_d(node), level, node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_node_is_unified",
          "args": [
            "node"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "cache_node_is_unified",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "334-337",
          "snippet": "static bool cache_node_is_unified(const struct device_node *np)\n{\n\treturn of_get_property(np, \"cache-unified\", NULL);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic bool cache_node_is_unified(const struct device_node *np)\n{\n\treturn of_get_property(np, \"cache-unified\", NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_do_one_devnode(struct device_node *node, int level)\n{\n\tstruct cache *cache;\n\n\tif (cache_node_is_unified(node))\n\t\tcache = cache_do_one_devnode_unified(node, level);\n\telse\n\t\tcache = cache_do_one_devnode_split(node, level);\n\n\treturn cache;\n}"
  },
  {
    "function_name": "cache_do_one_devnode_split",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "362-383",
    "snippet": "static struct cache *cache_do_one_devnode_split(struct device_node *node,\n\t\t\t\t\t\tint level)\n{\n\tstruct cache *dcache, *icache;\n\n\tpr_debug(\"creating L%d dcache and icache for %pOFP\\n\", level,\n\t\t node);\n\n\tdcache = new_cache(CACHE_TYPE_DATA, level, node);\n\ticache = new_cache(CACHE_TYPE_INSTRUCTION, level, node);\n\n\tif (!dcache || !icache)\n\t\tgoto err;\n\n\tdcache->next_local = icache;\n\n\treturn dcache;\nerr:\n\trelease_cache(dcache);\n\trelease_cache(icache);\n\treturn NULL;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [
      "#define CACHE_TYPE_DATA        3",
      "#define CACHE_TYPE_INSTRUCTION 2"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "release_cache",
          "args": [
            "icache"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "release_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "178-190",
          "snippet": "static void release_cache(struct cache *cache)\n{\n\tif (!cache)\n\t\treturn;\n\n\tpr_debug(\"freeing L%d %s cache for %pOFP\\n\", cache->level,\n\t\t cache_type_string(cache), cache->ofnode);\n\n\trelease_cache_debugcheck(cache);\n\tlist_del(&cache->list);\n\tof_node_put(cache->ofnode);\n\tkfree(cache);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void release_cache(struct cache *cache)\n{\n\tif (!cache)\n\t\treturn;\n\n\tpr_debug(\"freeing L%d %s cache for %pOFP\\n\", cache->level,\n\t\t cache_type_string(cache), cache->ofnode);\n\n\trelease_cache_debugcheck(cache);\n\tlist_del(&cache->list);\n\tof_node_put(cache->ofnode);\n\tkfree(cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_cache",
          "args": [
            "CACHE_TYPE_INSTRUCTION",
            "level",
            "node"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "new_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "154-163",
          "snippet": "static struct cache *new_cache(int type, int level, struct device_node *ofnode)\n{\n\tstruct cache *cache;\n\n\tcache = kzalloc(sizeof(*cache), GFP_KERNEL);\n\tif (cache)\n\t\tcache_init(cache, type, level, ofnode);\n\n\treturn cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *new_cache(int type, int level, struct device_node *ofnode)\n{\n\tstruct cache *cache;\n\n\tcache = kzalloc(sizeof(*cache), GFP_KERNEL);\n\tif (cache)\n\t\tcache_init(cache, type, level, ofnode);\n\n\treturn cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"creating L%d dcache and icache for %pOFP\\n\"",
            "level",
            "node"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\n#define CACHE_TYPE_DATA        3\n#define CACHE_TYPE_INSTRUCTION 2\n\nstatic struct cache *cache_do_one_devnode_split(struct device_node *node,\n\t\t\t\t\t\tint level)\n{\n\tstruct cache *dcache, *icache;\n\n\tpr_debug(\"creating L%d dcache and icache for %pOFP\\n\", level,\n\t\t node);\n\n\tdcache = new_cache(CACHE_TYPE_DATA, level, node);\n\ticache = new_cache(CACHE_TYPE_INSTRUCTION, level, node);\n\n\tif (!dcache || !icache)\n\t\tgoto err;\n\n\tdcache->next_local = icache;\n\n\treturn dcache;\nerr:\n\trelease_cache(dcache);\n\trelease_cache(icache);\n\treturn NULL;\n}"
  },
  {
    "function_name": "cache_do_one_devnode_unified",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "355-360",
    "snippet": "static struct cache *cache_do_one_devnode_unified(struct device_node *node, int level)\n{\n\tpr_debug(\"creating L%d ucache for %pOFP\\n\", level, node);\n\n\treturn new_cache(cache_is_unified_d(node), level, node);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "new_cache",
          "args": [
            "cache_is_unified_d(node)",
            "level",
            "node"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "new_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "154-163",
          "snippet": "static struct cache *new_cache(int type, int level, struct device_node *ofnode)\n{\n\tstruct cache *cache;\n\n\tcache = kzalloc(sizeof(*cache), GFP_KERNEL);\n\tif (cache)\n\t\tcache_init(cache, type, level, ofnode);\n\n\treturn cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *new_cache(int type, int level, struct device_node *ofnode)\n{\n\tstruct cache *cache;\n\n\tcache = kzalloc(sizeof(*cache), GFP_KERNEL);\n\tif (cache)\n\t\tcache_init(cache, type, level, ofnode);\n\n\treturn cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_is_unified_d",
          "args": [
            "node"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "cache_is_unified_d",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "348-353",
          "snippet": "static int cache_is_unified_d(const struct device_node *np)\n{\n\treturn of_get_property(np,\n\t\tcache_type_info[CACHE_TYPE_UNIFIED_D].size_prop, NULL) ?\n\t\tCACHE_TYPE_UNIFIED_D : CACHE_TYPE_UNIFIED;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [
            "#define CACHE_TYPE_UNIFIED_D   1 /* d-cache-size, d-cache-block-size, etc */",
            "#define CACHE_TYPE_UNIFIED     0 /* cache-size, cache-block-size, etc. */"
          ],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\n#define CACHE_TYPE_UNIFIED_D   1 /* d-cache-size, d-cache-block-size, etc */\n#define CACHE_TYPE_UNIFIED     0 /* cache-size, cache-block-size, etc. */\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic int cache_is_unified_d(const struct device_node *np)\n{\n\treturn of_get_property(np,\n\t\tcache_type_info[CACHE_TYPE_UNIFIED_D].size_prop, NULL) ?\n\t\tCACHE_TYPE_UNIFIED_D : CACHE_TYPE_UNIFIED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"creating L%d ucache for %pOFP\\n\"",
            "level",
            "node"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *cache_do_one_devnode_unified(struct device_node *node, int level)\n{\n\tpr_debug(\"creating L%d ucache for %pOFP\\n\", level, node);\n\n\treturn new_cache(cache_is_unified_d(node), level, node);\n}"
  },
  {
    "function_name": "cache_is_unified_d",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "348-353",
    "snippet": "static int cache_is_unified_d(const struct device_node *np)\n{\n\treturn of_get_property(np,\n\t\tcache_type_info[CACHE_TYPE_UNIFIED_D].size_prop, NULL) ?\n\t\tCACHE_TYPE_UNIFIED_D : CACHE_TYPE_UNIFIED;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [
      "#define CACHE_TYPE_UNIFIED_D   1 /* d-cache-size, d-cache-block-size, etc */",
      "#define CACHE_TYPE_UNIFIED     0 /* cache-size, cache-block-size, etc. */"
    ],
    "globals_used": [
      "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "cache_type_info[CACHE_TYPE_UNIFIED_D].size_prop",
            "NULL"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\n#define CACHE_TYPE_UNIFIED_D   1 /* d-cache-size, d-cache-block-size, etc */\n#define CACHE_TYPE_UNIFIED     0 /* cache-size, cache-block-size, etc. */\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic int cache_is_unified_d(const struct device_node *np)\n{\n\treturn of_get_property(np,\n\t\tcache_type_info[CACHE_TYPE_UNIFIED_D].size_prop, NULL) ?\n\t\tCACHE_TYPE_UNIFIED_D : CACHE_TYPE_UNIFIED;\n}"
  },
  {
    "function_name": "cache_node_is_unified",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "334-337",
    "snippet": "static bool cache_node_is_unified(const struct device_node *np)\n{\n\treturn of_get_property(np, \"cache-unified\", NULL);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "np",
            "\"cache-unified\"",
            "NULL"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic bool cache_node_is_unified(const struct device_node *np)\n{\n\treturn of_get_property(np, \"cache-unified\", NULL);\n}"
  },
  {
    "function_name": "cache_lookup_by_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "319-332",
    "snippet": "static struct cache *cache_lookup_by_node(const struct device_node *node)\n{\n\tstruct cache *cache = NULL;\n\tstruct cache *iter;\n\n\tlist_for_each_entry(iter, &cache_list, list) {\n\t\tif (iter->ofnode != node)\n\t\t\tcontinue;\n\t\tcache = cache_find_first_sibling(iter);\n\t\tbreak;\n\t}\n\n\treturn cache;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(cache_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_find_first_sibling",
          "args": [
            "iter"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "cache_find_first_sibling",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "303-316",
          "snippet": "static struct cache *cache_find_first_sibling(struct cache *cache)\n{\n\tstruct cache *iter;\n\n\tif (cache->type == CACHE_TYPE_UNIFIED ||\n\t    cache->type == CACHE_TYPE_UNIFIED_D)\n\t\treturn cache;\n\n\tlist_for_each_entry(iter, &cache_list, list)\n\t\tif (iter->ofnode == cache->ofnode && iter->next_local == cache)\n\t\t\treturn iter;\n\n\treturn cache;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [
            "#define CACHE_TYPE_UNIFIED_D   1 /* d-cache-size, d-cache-block-size, etc */",
            "#define CACHE_TYPE_UNIFIED     0 /* cache-size, cache-block-size, etc. */"
          ],
          "globals_used": [
            "static LIST_HEAD(cache_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\n#define CACHE_TYPE_UNIFIED_D   1 /* d-cache-size, d-cache-block-size, etc */\n#define CACHE_TYPE_UNIFIED     0 /* cache-size, cache-block-size, etc. */\n\nstatic LIST_HEAD(cache_list);\n\nstatic struct cache *cache_find_first_sibling(struct cache *cache)\n{\n\tstruct cache *iter;\n\n\tif (cache->type == CACHE_TYPE_UNIFIED ||\n\t    cache->type == CACHE_TYPE_UNIFIED_D)\n\t\treturn cache;\n\n\tlist_for_each_entry(iter, &cache_list, list)\n\t\tif (iter->ofnode == cache->ofnode && iter->next_local == cache)\n\t\t\treturn iter;\n\n\treturn cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "iter",
            "&cache_list",
            "list"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic LIST_HEAD(cache_list);\n\nstatic struct cache *cache_lookup_by_node(const struct device_node *node)\n{\n\tstruct cache *cache = NULL;\n\tstruct cache *iter;\n\n\tlist_for_each_entry(iter, &cache_list, list) {\n\t\tif (iter->ofnode != node)\n\t\t\tcontinue;\n\t\tcache = cache_find_first_sibling(iter);\n\t\tbreak;\n\t}\n\n\treturn cache;\n}"
  },
  {
    "function_name": "cache_find_first_sibling",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "303-316",
    "snippet": "static struct cache *cache_find_first_sibling(struct cache *cache)\n{\n\tstruct cache *iter;\n\n\tif (cache->type == CACHE_TYPE_UNIFIED ||\n\t    cache->type == CACHE_TYPE_UNIFIED_D)\n\t\treturn cache;\n\n\tlist_for_each_entry(iter, &cache_list, list)\n\t\tif (iter->ofnode == cache->ofnode && iter->next_local == cache)\n\t\t\treturn iter;\n\n\treturn cache;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [
      "#define CACHE_TYPE_UNIFIED_D   1 /* d-cache-size, d-cache-block-size, etc */",
      "#define CACHE_TYPE_UNIFIED     0 /* cache-size, cache-block-size, etc. */"
    ],
    "globals_used": [
      "static LIST_HEAD(cache_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "iter",
            "&cache_list",
            "list"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\n#define CACHE_TYPE_UNIFIED_D   1 /* d-cache-size, d-cache-block-size, etc */\n#define CACHE_TYPE_UNIFIED     0 /* cache-size, cache-block-size, etc. */\n\nstatic LIST_HEAD(cache_list);\n\nstatic struct cache *cache_find_first_sibling(struct cache *cache)\n{\n\tstruct cache *iter;\n\n\tif (cache->type == CACHE_TYPE_UNIFIED ||\n\t    cache->type == CACHE_TYPE_UNIFIED_D)\n\t\treturn cache;\n\n\tlist_for_each_entry(iter, &cache_list, list)\n\t\tif (iter->ofnode == cache->ofnode && iter->next_local == cache)\n\t\t\treturn iter;\n\n\treturn cache;\n}"
  },
  {
    "function_name": "cache_associativity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "271-300",
    "snippet": "static int cache_associativity(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int line_size;\n\tunsigned int nr_sets;\n\tunsigned int size;\n\n\tif (cache_nr_sets(cache, &nr_sets))\n\t\tgoto err;\n\n\t/* If the cache is fully associative, there is no need to\n\t * check the other properties.\n\t */\n\tif (nr_sets == 1) {\n\t\t*ret = 0;\n\t\treturn 0;\n\t}\n\n\tif (cache_get_line_size(cache, &line_size))\n\t\tgoto err;\n\tif (cache_size(cache, &size))\n\t\tgoto err;\n\n\tif (!(nr_sets > 0 && size > 0 && line_size > 0))\n\t\tgoto err;\n\n\t*ret = (size / nr_sets) / line_size;\n\treturn 0;\nerr:\n\treturn -ENODEV;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_size",
          "args": [
            "cache",
            "&size"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "cache_size_kb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "221-230",
          "snippet": "static int cache_size_kb(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int size;\n\n\tif (cache_size(cache, &size))\n\t\treturn -ENODEV;\n\n\t*ret = size / 1024;\n\treturn 0;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic int cache_size_kb(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int size;\n\n\tif (cache_size(cache, &size))\n\t\treturn -ENODEV;\n\n\t*ret = size / 1024;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_get_line_size",
          "args": [
            "cache",
            "&line_size"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "cache_get_line_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "233-254",
          "snippet": "static int cache_get_line_size(const struct cache *cache, unsigned int *ret)\n{\n\tconst __be32 *line_size;\n\tint i, lim;\n\n\tlim = ARRAY_SIZE(cache_type_info[cache->type].line_size_props);\n\n\tfor (i = 0; i < lim; i++) {\n\t\tconst char *propname;\n\n\t\tpropname = cache_type_info[cache->type].line_size_props[i];\n\t\tline_size = of_get_property(cache->ofnode, propname, NULL);\n\t\tif (line_size)\n\t\t\tbreak;\n\t}\n\n\tif (!line_size)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(line_size, 1);\n\treturn 0;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic int cache_get_line_size(const struct cache *cache, unsigned int *ret)\n{\n\tconst __be32 *line_size;\n\tint i, lim;\n\n\tlim = ARRAY_SIZE(cache_type_info[cache->type].line_size_props);\n\n\tfor (i = 0; i < lim; i++) {\n\t\tconst char *propname;\n\n\t\tpropname = cache_type_info[cache->type].line_size_props[i];\n\t\tline_size = of_get_property(cache->ofnode, propname, NULL);\n\t\tif (line_size)\n\t\t\tbreak;\n\t}\n\n\tif (!line_size)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(line_size, 1);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_nr_sets",
          "args": [
            "cache",
            "&nr_sets"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "cache_nr_sets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "256-269",
          "snippet": "static int cache_nr_sets(const struct cache *cache, unsigned int *ret)\n{\n\tconst char *propname;\n\tconst __be32 *nr_sets;\n\n\tpropname = cache_type_info[cache->type].nr_sets_prop;\n\n\tnr_sets = of_get_property(cache->ofnode, propname, NULL);\n\tif (!nr_sets)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(nr_sets, 1);\n\treturn 0;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic int cache_nr_sets(const struct cache *cache, unsigned int *ret)\n{\n\tconst char *propname;\n\tconst __be32 *nr_sets;\n\n\tpropname = cache_type_info[cache->type].nr_sets_prop;\n\n\tnr_sets = of_get_property(cache->ofnode, propname, NULL);\n\tif (!nr_sets)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(nr_sets, 1);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic int cache_associativity(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int line_size;\n\tunsigned int nr_sets;\n\tunsigned int size;\n\n\tif (cache_nr_sets(cache, &nr_sets))\n\t\tgoto err;\n\n\t/* If the cache is fully associative, there is no need to\n\t * check the other properties.\n\t */\n\tif (nr_sets == 1) {\n\t\t*ret = 0;\n\t\treturn 0;\n\t}\n\n\tif (cache_get_line_size(cache, &line_size))\n\t\tgoto err;\n\tif (cache_size(cache, &size))\n\t\tgoto err;\n\n\tif (!(nr_sets > 0 && size > 0 && line_size > 0))\n\t\tgoto err;\n\n\t*ret = (size / nr_sets) / line_size;\n\treturn 0;\nerr:\n\treturn -ENODEV;\n}"
  },
  {
    "function_name": "cache_nr_sets",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "256-269",
    "snippet": "static int cache_nr_sets(const struct cache *cache, unsigned int *ret)\n{\n\tconst char *propname;\n\tconst __be32 *nr_sets;\n\n\tpropname = cache_type_info[cache->type].nr_sets_prop;\n\n\tnr_sets = of_get_property(cache->ofnode, propname, NULL);\n\tif (!nr_sets)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(nr_sets, 1);\n\treturn 0;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_read_number",
          "args": [
            "nr_sets",
            "1"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "cache->ofnode",
            "propname",
            "NULL"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic int cache_nr_sets(const struct cache *cache, unsigned int *ret)\n{\n\tconst char *propname;\n\tconst __be32 *nr_sets;\n\n\tpropname = cache_type_info[cache->type].nr_sets_prop;\n\n\tnr_sets = of_get_property(cache->ofnode, propname, NULL);\n\tif (!nr_sets)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(nr_sets, 1);\n\treturn 0;\n}"
  },
  {
    "function_name": "cache_get_line_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "233-254",
    "snippet": "static int cache_get_line_size(const struct cache *cache, unsigned int *ret)\n{\n\tconst __be32 *line_size;\n\tint i, lim;\n\n\tlim = ARRAY_SIZE(cache_type_info[cache->type].line_size_props);\n\n\tfor (i = 0; i < lim; i++) {\n\t\tconst char *propname;\n\n\t\tpropname = cache_type_info[cache->type].line_size_props[i];\n\t\tline_size = of_get_property(cache->ofnode, propname, NULL);\n\t\tif (line_size)\n\t\t\tbreak;\n\t}\n\n\tif (!line_size)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(line_size, 1);\n\treturn 0;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_read_number",
          "args": [
            "line_size",
            "1"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "cache->ofnode",
            "propname",
            "NULL"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "cache_type_info[cache->type].line_size_props"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic int cache_get_line_size(const struct cache *cache, unsigned int *ret)\n{\n\tconst __be32 *line_size;\n\tint i, lim;\n\n\tlim = ARRAY_SIZE(cache_type_info[cache->type].line_size_props);\n\n\tfor (i = 0; i < lim; i++) {\n\t\tconst char *propname;\n\n\t\tpropname = cache_type_info[cache->type].line_size_props[i];\n\t\tline_size = of_get_property(cache->ofnode, propname, NULL);\n\t\tif (line_size)\n\t\t\tbreak;\n\t}\n\n\tif (!line_size)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(line_size, 1);\n\treturn 0;\n}"
  },
  {
    "function_name": "cache_size_kb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "221-230",
    "snippet": "static int cache_size_kb(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int size;\n\n\tif (cache_size(cache, &size))\n\t\treturn -ENODEV;\n\n\t*ret = size / 1024;\n\treturn 0;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_size",
          "args": [
            "cache",
            "&size"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "cache_size_kb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "221-230",
          "snippet": "static int cache_size_kb(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int size;\n\n\tif (cache_size(cache, &size))\n\t\treturn -ENODEV;\n\n\t*ret = size / 1024;\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic int cache_size_kb(const struct cache *cache, unsigned int *ret)\n{\n\tunsigned int size;\n\n\tif (cache_size(cache, &size))\n\t\treturn -ENODEV;\n\n\t*ret = size / 1024;\n\treturn 0;\n}"
  },
  {
    "function_name": "cache_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "206-219",
    "snippet": "static int cache_size(const struct cache *cache, unsigned int *ret)\n{\n\tconst char *propname;\n\tconst __be32 *cache_size;\n\n\tpropname = cache_type_info[cache->type].size_prop;\n\n\tcache_size = of_get_property(cache->ofnode, propname, NULL);\n\tif (!cache_size)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(cache_size, 1);\n\treturn 0;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "of_read_number",
          "args": [
            "cache_size",
            "1"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_property",
          "args": [
            "cache->ofnode",
            "propname",
            "NULL"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic int cache_size(const struct cache *cache, unsigned int *ret)\n{\n\tconst char *propname;\n\tconst __be32 *cache_size;\n\n\tpropname = cache_type_info[cache->type].size_prop;\n\n\tcache_size = of_get_property(cache->ofnode, propname, NULL);\n\tif (!cache_size)\n\t\treturn -ENODEV;\n\n\t*ret = of_read_number(cache_size, 1);\n\treturn 0;\n}"
  },
  {
    "function_name": "cache_cpu_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "192-204",
    "snippet": "static void cache_cpu_set(struct cache *cache, int cpu)\n{\n\tstruct cache *next = cache;\n\n\twhile (next) {\n\t\tWARN_ONCE(cpumask_test_cpu(cpu, &next->shared_cpu_map),\n\t\t\t  \"CPU %i already accounted in %pOFP(%s)\\n\",\n\t\t\t  cpu, next->ofnode,\n\t\t\t  cache_type_string(next));\n\t\tcpumask_set_cpu(cpu, &next->shared_cpu_map);\n\t\tnext = next->next_local;\n\t}\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "&next->shared_cpu_map"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "cpumask_test_cpu(cpu, &next->shared_cpu_map)",
            "\"CPU %i already accounted in %pOFP(%s)\\n\"",
            "cpu",
            "next->ofnode",
            "cache_type_string(next)"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_type_string",
          "args": [
            "next"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "cache_type_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "139-142",
          "snippet": "static const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_test_cpu",
          "args": [
            "cpu",
            "&next->shared_cpu_map"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void cache_cpu_set(struct cache *cache, int cpu)\n{\n\tstruct cache *next = cache;\n\n\twhile (next) {\n\t\tWARN_ONCE(cpumask_test_cpu(cpu, &next->shared_cpu_map),\n\t\t\t  \"CPU %i already accounted in %pOFP(%s)\\n\",\n\t\t\t  cpu, next->ofnode,\n\t\t\t  cache_type_string(next));\n\t\tcpumask_set_cpu(cpu, &next->shared_cpu_map);\n\t\tnext = next->next_local;\n\t}\n}"
  },
  {
    "function_name": "release_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "178-190",
    "snippet": "static void release_cache(struct cache *cache)\n{\n\tif (!cache)\n\t\treturn;\n\n\tpr_debug(\"freeing L%d %s cache for %pOFP\\n\", cache->level,\n\t\t cache_type_string(cache), cache->ofnode);\n\n\trelease_cache_debugcheck(cache);\n\tlist_del(&cache->list);\n\tof_node_put(cache->ofnode);\n\tkfree(cache);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cache"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_put",
          "args": [
            "cache->ofnode"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&cache->list"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "release_cache_debugcheck",
          "args": [
            "cache"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "release_cache_debugcheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "165-176",
          "snippet": "static void release_cache_debugcheck(struct cache *cache)\n{\n\tstruct cache *iter;\n\n\tlist_for_each_entry(iter, &cache_list, list)\n\t\tWARN_ONCE(iter->next_local == cache,\n\t\t\t  \"cache for %pOFP(%s) refers to cache for %pOFP(%s)\\n\",\n\t\t\t  iter->ofnode,\n\t\t\t  cache_type_string(iter),\n\t\t\t  cache->ofnode,\n\t\t\t  cache_type_string(cache));\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(cache_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic LIST_HEAD(cache_list);\n\nstatic void release_cache_debugcheck(struct cache *cache)\n{\n\tstruct cache *iter;\n\n\tlist_for_each_entry(iter, &cache_list, list)\n\t\tWARN_ONCE(iter->next_local == cache,\n\t\t\t  \"cache for %pOFP(%s) refers to cache for %pOFP(%s)\\n\",\n\t\t\t  iter->ofnode,\n\t\t\t  cache_type_string(iter),\n\t\t\t  cache->ofnode,\n\t\t\t  cache_type_string(cache));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"freeing L%d %s cache for %pOFP\\n\"",
            "cache->level",
            "cache_type_string(cache)",
            "cache->ofnode"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_type_string",
          "args": [
            "cache"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "cache_type_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "139-142",
          "snippet": "static const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic void release_cache(struct cache *cache)\n{\n\tif (!cache)\n\t\treturn;\n\n\tpr_debug(\"freeing L%d %s cache for %pOFP\\n\", cache->level,\n\t\t cache_type_string(cache), cache->ofnode);\n\n\trelease_cache_debugcheck(cache);\n\tlist_del(&cache->list);\n\tof_node_put(cache->ofnode);\n\tkfree(cache);\n}"
  },
  {
    "function_name": "release_cache_debugcheck",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "165-176",
    "snippet": "static void release_cache_debugcheck(struct cache *cache)\n{\n\tstruct cache *iter;\n\n\tlist_for_each_entry(iter, &cache_list, list)\n\t\tWARN_ONCE(iter->next_local == cache,\n\t\t\t  \"cache for %pOFP(%s) refers to cache for %pOFP(%s)\\n\",\n\t\t\t  iter->ofnode,\n\t\t\t  cache_type_string(iter),\n\t\t\t  cache->ofnode,\n\t\t\t  cache_type_string(cache));\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(cache_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "iter->next_local == cache",
            "\"cache for %pOFP(%s) refers to cache for %pOFP(%s)\\n\"",
            "iter->ofnode",
            "cache_type_string(iter)",
            "cache->ofnode",
            "cache_type_string(cache)"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_type_string",
          "args": [
            "cache"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "cache_type_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "139-142",
          "snippet": "static const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "iter",
            "&cache_list",
            "list"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic LIST_HEAD(cache_list);\n\nstatic void release_cache_debugcheck(struct cache *cache)\n{\n\tstruct cache *iter;\n\n\tlist_for_each_entry(iter, &cache_list, list)\n\t\tWARN_ONCE(iter->next_local == cache,\n\t\t\t  \"cache for %pOFP(%s) refers to cache for %pOFP(%s)\\n\",\n\t\t\t  iter->ofnode,\n\t\t\t  cache_type_string(iter),\n\t\t\t  cache->ofnode,\n\t\t\t  cache_type_string(cache));\n}"
  },
  {
    "function_name": "new_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "154-163",
    "snippet": "static struct cache *new_cache(int type, int level, struct device_node *ofnode)\n{\n\tstruct cache *cache;\n\n\tcache = kzalloc(sizeof(*cache), GFP_KERNEL);\n\tif (cache)\n\t\tcache_init(cache, type, level, ofnode);\n\n\treturn cache;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_init",
          "args": [
            "cache",
            "type",
            "level",
            "ofnode"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "cache_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
          "lines": "144-152",
          "snippet": "static void cache_init(struct cache *cache, int type, int level,\n\t\t       struct device_node *ofnode)\n{\n\tcache->type = type;\n\tcache->level = level;\n\tcache->ofnode = of_node_get(ofnode);\n\tINIT_LIST_HEAD(&cache->list);\n\tlist_add(&cache->list, &cache_list);\n}",
          "includes": [
            "#include \"cacheinfo.h\"",
            "#include <asm/smp.h>",
            "#include <asm/cputhreads.h>",
            "#include <asm/prom.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/of.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(cache_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic LIST_HEAD(cache_list);\n\nstatic void cache_init(struct cache *cache, int type, int level,\n\t\t       struct device_node *ofnode)\n{\n\tcache->type = type;\n\tcache->level = level;\n\tcache->ofnode = of_node_get(ofnode);\n\tINIT_LIST_HEAD(&cache->list);\n\tlist_add(&cache->list, &cache_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*cache)",
            "GFP_KERNEL"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache *new_cache(int type, int level, struct device_node *ofnode)\n{\n\tstruct cache *cache;\n\n\tcache = kzalloc(sizeof(*cache), GFP_KERNEL);\n\tif (cache)\n\t\tcache_init(cache, type, level, ofnode);\n\n\treturn cache;\n}"
  },
  {
    "function_name": "cache_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "144-152",
    "snippet": "static void cache_init(struct cache *cache, int type, int level,\n\t\t       struct device_node *ofnode)\n{\n\tcache->type = type;\n\tcache->level = level;\n\tcache->ofnode = of_node_get(ofnode);\n\tINIT_LIST_HEAD(&cache->list);\n\tlist_add(&cache->list, &cache_list);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(cache_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&cache->list",
            "&cache_list"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&cache->list"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_node_get",
          "args": [
            "ofnode"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic LIST_HEAD(cache_list);\n\nstatic void cache_init(struct cache *cache, int type, int level,\n\t\t       struct device_node *ofnode)\n{\n\tcache->type = type;\n\tcache->level = level;\n\tcache->ofnode = of_node_get(ofnode);\n\tINIT_LIST_HEAD(&cache->list);\n\tlist_add(&cache->list, &cache_list);\n}"
  },
  {
    "function_name": "cache_type_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "139-142",
    "snippet": "static const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic const struct cache_type_info cache_type_info[] = {\n\t{\n\t\t/* Embedded systems that use cache-size, cache-block-size,\n\t\t * etc. for the Unified (typically L2) cache. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"cache-size\",\n\t\t.line_size_props = { \"cache-line-size\",\n\t\t\t\t     \"cache-block-size\", },\n\t\t.nr_sets_prop    = \"cache-sets\",\n\t},\n\t{\n\t\t/* PowerPC Processor binding says the [di]-cache-*\n\t\t * must be equal on unified caches, so just use\n\t\t * d-cache properties. */\n\t\t.name            = \"Unified\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Instruction\",\n\t\t.size_prop       = \"i-cache-size\",\n\t\t.line_size_props = { \"i-cache-line-size\",\n\t\t\t\t     \"i-cache-block-size\", },\n\t\t.nr_sets_prop    = \"i-cache-sets\",\n\t},\n\t{\n\t\t.name            = \"Data\",\n\t\t.size_prop       = \"d-cache-size\",\n\t\t.line_size_props = { \"d-cache-line-size\",\n\t\t\t\t     \"d-cache-block-size\", },\n\t\t.nr_sets_prop    = \"d-cache-sets\",\n\t},\n};\n\nstatic const char *cache_type_string(const struct cache *cache)\n{\n\treturn cache_type_info[cache->type].name;\n}"
  },
  {
    "function_name": "kobj_to_cache_index_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/cacheinfo.c",
    "lines": "134-137",
    "snippet": "static struct cache_index_dir *kobj_to_cache_index_dir(struct kobject *k)\n{\n\treturn container_of(k, struct cache_index_dir, kobj);\n}",
    "includes": [
      "#include \"cacheinfo.h\"",
      "#include <asm/smp.h>",
      "#include <asm/cputhreads.h>",
      "#include <asm/prom.h>",
      "#include <linux/slab.h>",
      "#include <linux/percpu.h>",
      "#include <linux/of.h>",
      "#include <linux/notifier.h>",
      "#include <linux/list.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/cpumask.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "k",
            "structcache_index_dir",
            "kobj"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cacheinfo.h\"\n#include <asm/smp.h>\n#include <asm/cputhreads.h>\n#include <asm/prom.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/of.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n\nstatic struct cache_index_dir *kobj_to_cache_index_dir(struct kobject *k)\n{\n\treturn container_of(k, struct cache_index_dir, kobj);\n}"
  }
]