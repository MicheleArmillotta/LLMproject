[
  {
    "function_name": "prom_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3322-3520",
    "snippet": "unsigned long __init prom_init(unsigned long r3, unsigned long r4,\n\t\t\t       unsigned long pp,\n\t\t\t       unsigned long r6, unsigned long r7,\n\t\t\t       unsigned long kbase)\n{\t\n\tunsigned long hdr;\n\n#ifdef CONFIG_PPC32\n\tunsigned long offset = reloc_offset();\n\treloc_got2(offset);\n#else\n\treloc_toc();\n#endif\n\n\t/*\n\t * First zero the BSS\n\t */\n\tmemset(&__bss_start, 0, __bss_stop - __bss_start);\n\n\t/*\n\t * Init interface to Open Firmware, get some node references,\n\t * like /chosen\n\t */\n\tprom_init_client_services(pp);\n\n\t/*\n\t * See if this OF is old enough that we need to do explicit maps\n\t * and other workarounds\n\t */\n\tprom_find_mmu();\n\n\t/*\n\t * Init prom stdout device\n\t */\n\tprom_init_stdout();\n\n\tprom_printf(\"Preparing to boot %s\", linux_banner);\n\n\t/*\n\t * Get default machine type. At this point, we do not differentiate\n\t * between pSeries SMP and pSeries LPAR\n\t */\n\tof_platform = prom_find_machine_type();\n\tprom_printf(\"Detected machine type: %x\\n\", of_platform);\n\n#ifndef CONFIG_NONSTATIC_KERNEL\n\t/* Bail if this is a kdump kernel. */\n\tif (PHYSICAL_START > 0)\n\t\tprom_panic(\"Error: You can't boot a kdump kernel from OF!\\n\");\n#endif\n\n\t/*\n\t * Check for an initrd\n\t */\n\tprom_check_initrd(r3, r4);\n\n\t/*\n\t * Do early parsing of command line\n\t */\n\tearly_cmdline_parse();\n\n#ifdef CONFIG_PPC_PSERIES\n\t/*\n\t * On pSeries, inform the firmware about our capabilities\n\t */\n\tif (of_platform == PLATFORM_PSERIES ||\n\t    of_platform == PLATFORM_PSERIES_LPAR)\n\t\tprom_send_capabilities();\n#endif\n\n\t/*\n\t * Copy the CPU hold code\n\t */\n\tif (of_platform != PLATFORM_POWERMAC)\n\t\tcopy_and_flush(0, kbase, 0x100, 0);\n\n\t/*\n\t * Initialize memory management within prom_init\n\t */\n\tprom_init_mem();\n\n\t/*\n\t * Determine which cpu is actually running right _now_\n\t */\n\tprom_find_boot_cpu();\n\n\t/* \n\t * Initialize display devices\n\t */\n\tprom_check_displays();\n\n#if defined(CONFIG_PPC64) && defined(__BIG_ENDIAN__)\n\t/*\n\t * Initialize IOMMU (TCE tables) on pSeries. Do that before anything else\n\t * that uses the allocator, we need to make sure we get the top of memory\n\t * available for us here...\n\t */\n\tif (of_platform == PLATFORM_PSERIES)\n\t\tprom_initialize_tce_table();\n#endif\n\n\t/*\n\t * On non-powermacs, try to instantiate RTAS. PowerMacs don't\n\t * have a usable RTAS implementation.\n\t */\n\tif (of_platform != PLATFORM_POWERMAC)\n\t\tprom_instantiate_rtas();\n\n#ifdef CONFIG_PPC64\n\t/* instantiate sml */\n\tprom_instantiate_sml();\n#endif\n\n\t/*\n\t * On non-powermacs, put all CPUs in spin-loops.\n\t *\n\t * PowerMacs use a different mechanism to spin CPUs\n\t *\n\t * (This must be done after instanciating RTAS)\n\t */\n\tif (of_platform != PLATFORM_POWERMAC)\n\t\tprom_hold_cpus();\n\n\t/*\n\t * Fill in some infos for use by the kernel later on\n\t */\n\tif (prom_memory_limit) {\n\t\t__be64 val = cpu_to_be64(prom_memory_limit);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,memory-limit\",\n\t\t\t     &val, sizeof(val));\n\t}\n#ifdef CONFIG_PPC64\n\tif (prom_iommu_off)\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,iommu-off\",\n\t\t\t     NULL, 0);\n\n\tif (prom_iommu_force_on)\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,iommu-force-on\",\n\t\t\t     NULL, 0);\n\n\tif (prom_tce_alloc_start) {\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,tce-alloc-start\",\n\t\t\t     &prom_tce_alloc_start,\n\t\t\t     sizeof(prom_tce_alloc_start));\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,tce-alloc-end\",\n\t\t\t     &prom_tce_alloc_end,\n\t\t\t     sizeof(prom_tce_alloc_end));\n\t}\n#endif\n\n\t/*\n\t * Fixup any known bugs in the device-tree\n\t */\n\tfixup_device_tree();\n\n\t/*\n\t * Now finally create the flattened device-tree\n\t */\n\tprom_printf(\"copying OF device tree...\\n\");\n\tflatten_device_tree();\n\n\t/*\n\t * in case stdin is USB and still active on IBM machines...\n\t * Unfortunately quiesce crashes on some powermacs if we have\n\t * closed stdin already (in particular the powerbook 101).\n\t */\n\tif (of_platform != PLATFORM_POWERMAC)\n\t\tprom_close_stdin();\n\n\t/*\n\t * Call OF \"quiesce\" method to shut down pending DMA's from\n\t * devices etc...\n\t */\n\tprom_printf(\"Quiescing Open Firmware ...\\n\");\n\tcall_prom(\"quiesce\", 0, 0);\n\n\t/*\n\t * And finally, call the kernel passing it the flattened device\n\t * tree and NULL as r5, thus triggering the new entry point which\n\t * is common to us and kexec\n\t */\n\thdr = dt_header_start;\n\n\tprom_printf(\"Booting Linux via __start() @ 0x%lx ...\\n\", kbase);\n\tprom_debug(\"->dt_header_start=0x%lx\\n\", hdr);\n\n#ifdef CONFIG_PPC32\n\treloc_got2(-offset);\n#else\n\tunreloc_toc();\n#endif\n\n\t/* Move to secure memory if we're supposed to be secure guests. */\n\tsetup_secure_guest(kbase, hdr);\n\n\t__start(hdr, kbase, 0, 0, 0, 0, 0);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PLATFORM_POWERMAC\t0x0400",
      "#define PLATFORM_PSERIES_LPAR\t0x0101",
      "#define PLATFORM_PSERIES\t0x0100"
    ],
    "globals_used": [
      "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);",
      "static struct prom_t __prombss prom;",
      "static unsigned long __prombss dt_header_start;",
      "static int __prombss of_platform;",
      "static unsigned long __prombss prom_memory_limit;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__start",
          "args": [
            "hdr",
            "kbase",
            "0",
            "0",
            "0",
            "0",
            "0"
          ],
          "line": 3517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_secure_guest",
          "args": [
            "kbase",
            "hdr"
          ],
          "line": 3515
        },
        "resolved": true,
        "details": {
          "function_name": "setup_secure_guest",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "3312-3314",
          "snippet": "static void __init setup_secure_guest(unsigned long kbase, unsigned long fdt)\n{\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init setup_secure_guest(unsigned long kbase, unsigned long fdt)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "unreloc_toc",
          "args": [],
          "line": 3511
        },
        "resolved": true,
        "details": {
          "function_name": "unreloc_toc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "3251-3260",
          "snippet": "static void unreloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\tmb();\n\n\t__reloc_toc(-offset, nr_entries);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void unreloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\tmb();\n\n\t__reloc_toc(-offset, nr_entries);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reloc_got2",
          "args": [
            "-offset"
          ],
          "line": 3509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"->dt_header_start=0x%lx\\n\"",
            "hdr"
          ],
          "line": 3506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Booting Linux via __start() @ 0x%lx ...\\n\"",
            "kbase"
          ],
          "line": 3505
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"quiesce\"",
            "0",
            "0"
          ],
          "line": 3496
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "370-392",
          "snippet": "static int __init call_prom(const char *service, int nargs, int nret, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, nret);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom(const char *service, int nargs, int nret, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, nret);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_close_stdin",
          "args": [],
          "line": 3489
        },
        "resolved": true,
        "details": {
          "function_name": "prom_close_stdin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1748-1757",
          "snippet": "static void __init prom_close_stdin(void)\n{\n\t__be32 val;\n\tihandle stdin;\n\n\tif (prom_getprop(prom.chosen, \"stdin\", &val, sizeof(val)) > 0) {\n\t\tstdin = be32_to_cpu(val);\n\t\tcall_prom(\"close\", 1, 0, stdin);\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_close_stdin(void)\n{\n\t__be32 val;\n\tihandle stdin;\n\n\tif (prom_getprop(prom.chosen, \"stdin\", &val, sizeof(val)) > 0) {\n\t\tstdin = be32_to_cpu(val);\n\t\tcall_prom(\"close\", 1, 0, stdin);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "flatten_device_tree",
          "args": [],
          "line": 3481
        },
        "resolved": true,
        "details": {
          "function_name": "flatten_device_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2666-2758",
          "snippet": "static void __init flatten_device_tree(void)\n{\n\tphandle root;\n\tunsigned long mem_start, mem_end, room;\n\tstruct boot_param_header *hdr;\n\tchar *namep;\n\tu64 *rsvmap;\n\n\t/*\n\t * Check how much room we have between alloc top & bottom (+/- a\n\t * few pages), crop to 1MB, as this is our \"chunk\" size\n\t */\n\troom = alloc_top - alloc_bottom - 0x4000;\n\tif (room > DEVTREE_CHUNK_SIZE)\n\t\troom = DEVTREE_CHUNK_SIZE;\n\tprom_debug(\"starting device tree allocs at %lx\\n\", alloc_bottom);\n\n\t/* Now try to claim that */\n\tmem_start = (unsigned long)alloc_up(room, PAGE_SIZE);\n\tif (mem_start == 0)\n\t\tprom_panic(\"Can't allocate initial device-tree chunk\\n\");\n\tmem_end = mem_start + room;\n\n\t/* Get root of tree */\n\troot = call_prom(\"peer\", 1, 1, (phandle)0);\n\tif (root == (phandle)0)\n\t\tprom_panic (\"couldn't get device tree root\\n\");\n\n\t/* Build header and make room for mem rsv map */ \n\tmem_start = ALIGN(mem_start, 4);\n\thdr = make_room(&mem_start, &mem_end,\n\t\t\tsizeof(struct boot_param_header), 4);\n\tdt_header_start = (unsigned long)hdr;\n\trsvmap = make_room(&mem_start, &mem_end, sizeof(mem_reserve_map), 8);\n\n\t/* Start of strings */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_string_start = mem_start;\n\tmem_start += 4; /* hole */\n\n\t/* Add \"phandle\" in there, we'll need it */\n\tnamep = make_room(&mem_start, &mem_end, 16, 1);\n\tprom_strcpy(namep, \"phandle\");\n\tmem_start = (unsigned long)namep + prom_strlen(namep) + 1;\n\n\t/* Build string array */\n\tprom_printf(\"Building dt strings...\\n\"); \n\tscan_dt_build_strings(root, &mem_start, &mem_end);\n\tdt_string_end = mem_start;\n\n\t/* Build structure */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_struct_start = mem_start;\n\tprom_printf(\"Building dt structure...\\n\"); \n\tscan_dt_build_struct(root, &mem_start, &mem_end);\n\tdt_push_token(OF_DT_END, &mem_start, &mem_end);\n\tdt_struct_end = PAGE_ALIGN(mem_start);\n\n\t/* Finish header */\n\thdr->boot_cpuid_phys = cpu_to_be32(prom.cpu);\n\thdr->magic = cpu_to_be32(OF_DT_HEADER);\n\thdr->totalsize = cpu_to_be32(dt_struct_end - dt_header_start);\n\thdr->off_dt_struct = cpu_to_be32(dt_struct_start - dt_header_start);\n\thdr->off_dt_strings = cpu_to_be32(dt_string_start - dt_header_start);\n\thdr->dt_strings_size = cpu_to_be32(dt_string_end - dt_string_start);\n\thdr->off_mem_rsvmap = cpu_to_be32(((unsigned long)rsvmap) - dt_header_start);\n\thdr->version = cpu_to_be32(OF_DT_VERSION);\n\t/* Version 16 is not backward compatible */\n\thdr->last_comp_version = cpu_to_be32(0x10);\n\n\t/* Copy the reserve map in */\n\tmemcpy(rsvmap, mem_reserve_map, sizeof(mem_reserve_map));\n\n#ifdef DEBUG_PROM\n\t{\n\t\tint i;\n\t\tprom_printf(\"reserved memory map:\\n\");\n\t\tfor (i = 0; i < mem_reserve_cnt; i++)\n\t\t\tprom_printf(\"  %llx - %llx\\n\",\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].base),\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].size));\n\t}\n#endif\n\t/* Bump mem_reserve_cnt to cause further reservations to fail\n\t * since it's too late.\n\t */\n\tmem_reserve_cnt = MEM_RESERVE_MAP_SIZE;\n\n\tprom_printf(\"Device tree strings 0x%lx -> 0x%lx\\n\",\n\t\t    dt_string_start, dt_string_end);\n\tprom_printf(\"Device tree struct  0x%lx -> 0x%lx\\n\",\n\t\t    dt_struct_start, dt_struct_end);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8",
            "#define DEVTREE_CHUNK_SIZE\t0x100000"
          ],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static unsigned long __prombss dt_header_start;",
            "static unsigned long __prombss dt_struct_start, dt_struct_end;",
            "static unsigned long __prombss dt_string_start, dt_string_end;",
            "static unsigned long __prombss alloc_top;",
            "static unsigned long __prombss alloc_bottom;",
            "static struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];",
            "static int __prombss mem_reserve_cnt;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic struct prom_t __prombss prom;\nstatic unsigned long __prombss dt_header_start;\nstatic unsigned long __prombss dt_struct_start, dt_struct_end;\nstatic unsigned long __prombss dt_string_start, dt_string_end;\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_bottom;\nstatic struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];\nstatic int __prombss mem_reserve_cnt;\nstatic void __init;\n\nstatic void __init flatten_device_tree(void)\n{\n\tphandle root;\n\tunsigned long mem_start, mem_end, room;\n\tstruct boot_param_header *hdr;\n\tchar *namep;\n\tu64 *rsvmap;\n\n\t/*\n\t * Check how much room we have between alloc top & bottom (+/- a\n\t * few pages), crop to 1MB, as this is our \"chunk\" size\n\t */\n\troom = alloc_top - alloc_bottom - 0x4000;\n\tif (room > DEVTREE_CHUNK_SIZE)\n\t\troom = DEVTREE_CHUNK_SIZE;\n\tprom_debug(\"starting device tree allocs at %lx\\n\", alloc_bottom);\n\n\t/* Now try to claim that */\n\tmem_start = (unsigned long)alloc_up(room, PAGE_SIZE);\n\tif (mem_start == 0)\n\t\tprom_panic(\"Can't allocate initial device-tree chunk\\n\");\n\tmem_end = mem_start + room;\n\n\t/* Get root of tree */\n\troot = call_prom(\"peer\", 1, 1, (phandle)0);\n\tif (root == (phandle)0)\n\t\tprom_panic (\"couldn't get device tree root\\n\");\n\n\t/* Build header and make room for mem rsv map */ \n\tmem_start = ALIGN(mem_start, 4);\n\thdr = make_room(&mem_start, &mem_end,\n\t\t\tsizeof(struct boot_param_header), 4);\n\tdt_header_start = (unsigned long)hdr;\n\trsvmap = make_room(&mem_start, &mem_end, sizeof(mem_reserve_map), 8);\n\n\t/* Start of strings */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_string_start = mem_start;\n\tmem_start += 4; /* hole */\n\n\t/* Add \"phandle\" in there, we'll need it */\n\tnamep = make_room(&mem_start, &mem_end, 16, 1);\n\tprom_strcpy(namep, \"phandle\");\n\tmem_start = (unsigned long)namep + prom_strlen(namep) + 1;\n\n\t/* Build string array */\n\tprom_printf(\"Building dt strings...\\n\"); \n\tscan_dt_build_strings(root, &mem_start, &mem_end);\n\tdt_string_end = mem_start;\n\n\t/* Build structure */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_struct_start = mem_start;\n\tprom_printf(\"Building dt structure...\\n\"); \n\tscan_dt_build_struct(root, &mem_start, &mem_end);\n\tdt_push_token(OF_DT_END, &mem_start, &mem_end);\n\tdt_struct_end = PAGE_ALIGN(mem_start);\n\n\t/* Finish header */\n\thdr->boot_cpuid_phys = cpu_to_be32(prom.cpu);\n\thdr->magic = cpu_to_be32(OF_DT_HEADER);\n\thdr->totalsize = cpu_to_be32(dt_struct_end - dt_header_start);\n\thdr->off_dt_struct = cpu_to_be32(dt_struct_start - dt_header_start);\n\thdr->off_dt_strings = cpu_to_be32(dt_string_start - dt_header_start);\n\thdr->dt_strings_size = cpu_to_be32(dt_string_end - dt_string_start);\n\thdr->off_mem_rsvmap = cpu_to_be32(((unsigned long)rsvmap) - dt_header_start);\n\thdr->version = cpu_to_be32(OF_DT_VERSION);\n\t/* Version 16 is not backward compatible */\n\thdr->last_comp_version = cpu_to_be32(0x10);\n\n\t/* Copy the reserve map in */\n\tmemcpy(rsvmap, mem_reserve_map, sizeof(mem_reserve_map));\n\n#ifdef DEBUG_PROM\n\t{\n\t\tint i;\n\t\tprom_printf(\"reserved memory map:\\n\");\n\t\tfor (i = 0; i < mem_reserve_cnt; i++)\n\t\t\tprom_printf(\"  %llx - %llx\\n\",\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].base),\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].size));\n\t}\n#endif\n\t/* Bump mem_reserve_cnt to cause further reservations to fail\n\t * since it's too late.\n\t */\n\tmem_reserve_cnt = MEM_RESERVE_MAP_SIZE;\n\n\tprom_printf(\"Device tree strings 0x%lx -> 0x%lx\\n\",\n\t\t    dt_string_start, dt_string_end);\n\tprom_printf(\"Device tree struct  0x%lx -> 0x%lx\\n\",\n\t\t    dt_struct_start, dt_struct_end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fixup_device_tree",
          "args": [],
          "line": 3475
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "3159-3167",
          "snippet": "static void __init fixup_device_tree(void)\n{\n\tfixup_device_tree_maple();\n\tfixup_device_tree_maple_memory_controller();\n\tfixup_device_tree_chrp();\n\tfixup_device_tree_pmac();\n\tfixup_device_tree_efika();\n\tfixup_device_tree_pasemi();\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init fixup_device_tree(void)\n{\n\tfixup_device_tree_maple();\n\tfixup_device_tree_maple_memory_controller();\n\tfixup_device_tree_chrp();\n\tfixup_device_tree_pmac();\n\tfixup_device_tree_efika();\n\tfixup_device_tree_pasemi();\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "prom.chosen",
            "\"/chosen\"",
            "\"linux,tce-alloc-end\"",
            "&prom_tce_alloc_end",
            "sizeof(prom_tce_alloc_end)"
          ],
          "line": 3466
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "prom_memory_limit"
          ],
          "line": 3449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_hold_cpus",
          "args": [],
          "line": 3443
        },
        "resolved": true,
        "details": {
          "function_name": "prom_hold_cpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2094-2181",
          "snippet": "static void __init prom_hold_cpus(void)\n{\n\tunsigned long i;\n\tphandle node;\n\tchar type[64];\n\tunsigned long *spinloop\n\t\t= (void *) LOW_ADDR(__secondary_hold_spinloop);\n\tunsigned long *acknowledge\n\t\t= (void *) LOW_ADDR(__secondary_hold_acknowledge);\n\tunsigned long secondary_hold = LOW_ADDR(__secondary_hold);\n\n\t/*\n\t * On pseries, if RTAS supports \"query-cpu-stopped-state\",\n\t * we skip this stage, the CPUs will be started by the\n\t * kernel using RTAS.\n\t */\n\tif ((of_platform == PLATFORM_PSERIES ||\n\t     of_platform == PLATFORM_PSERIES_LPAR) &&\n\t    rtas_has_query_cpu_stopped) {\n\t\tprom_printf(\"prom_hold_cpus: skipped\\n\");\n\t\treturn;\n\t}\n\n\tprom_debug(\"prom_hold_cpus: start...\\n\");\n\tprom_debug(\"    1) spinloop       = 0x%lx\\n\", (unsigned long)spinloop);\n\tprom_debug(\"    1) *spinloop      = 0x%lx\\n\", *spinloop);\n\tprom_debug(\"    1) acknowledge    = 0x%lx\\n\",\n\t\t   (unsigned long)acknowledge);\n\tprom_debug(\"    1) *acknowledge   = 0x%lx\\n\", *acknowledge);\n\tprom_debug(\"    1) secondary_hold = 0x%lx\\n\", secondary_hold);\n\n\t/* Set the common spinloop variable, so all of the secondary cpus\n\t * will block when they are awakened from their OF spinloop.\n\t * This must occur for both SMP and non SMP kernels, since OF will\n\t * be trashed when we move the kernel.\n\t */\n\t*spinloop = 0;\n\n\t/* look for cpus */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tunsigned int cpu_no;\n\t\t__be32 reg;\n\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"cpu\") != 0)\n\t\t\tcontinue;\n\n\t\t/* Skip non-configured cpus. */\n\t\tif (prom_getprop(node, \"status\", type, sizeof(type)) > 0)\n\t\t\tif (prom_strcmp(type, \"okay\") != 0)\n\t\t\t\tcontinue;\n\n\t\treg = cpu_to_be32(-1); /* make sparse happy */\n\t\tprom_getprop(node, \"reg\", &reg, sizeof(reg));\n\t\tcpu_no = be32_to_cpu(reg);\n\n\t\tprom_debug(\"cpu hw idx   = %u\\n\", cpu_no);\n\n\t\t/* Init the acknowledge var which will be reset by\n\t\t * the secondary cpu when it awakens from its OF\n\t\t * spinloop.\n\t\t */\n\t\t*acknowledge = (unsigned long)-1;\n\n\t\tif (cpu_no != prom.cpu) {\n\t\t\t/* Primary Thread of non-boot cpu or any thread */\n\t\t\tprom_printf(\"starting cpu hw idx %u... \", cpu_no);\n\t\t\tcall_prom(\"start-cpu\", 3, 0, node,\n\t\t\t\t  secondary_hold, cpu_no);\n\n\t\t\tfor (i = 0; (i < 100000000) && \n\t\t\t     (*acknowledge == ((unsigned long)-1)); i++ )\n\t\t\t\tmb();\n\n\t\t\tif (*acknowledge == cpu_no)\n\t\t\t\tprom_printf(\"done\\n\");\n\t\t\telse\n\t\t\t\tprom_printf(\"failed: %lx\\n\", *acknowledge);\n\t\t}\n#ifdef CONFIG_SMP\n\t\telse\n\t\t\tprom_printf(\"boot cpu hw idx %u\\n\", cpu_no);\n#endif /* CONFIG_SMP */\n\t}\n\n\tprom_debug(\"prom_hold_cpus: end...\\n\");\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PLATFORM_PSERIES_LPAR\t0x0101",
            "#define PLATFORM_PSERIES\t0x0100"
          ],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static int __prombss of_platform;",
            "static bool  __prombss rtas_has_query_cpu_stopped;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PLATFORM_PSERIES_LPAR\t0x0101\n#define PLATFORM_PSERIES\t0x0100\n\nstatic struct prom_t __prombss prom;\nstatic int __prombss of_platform;\nstatic bool  __prombss rtas_has_query_cpu_stopped;\nstatic void __init;\n\nstatic void __init prom_hold_cpus(void)\n{\n\tunsigned long i;\n\tphandle node;\n\tchar type[64];\n\tunsigned long *spinloop\n\t\t= (void *) LOW_ADDR(__secondary_hold_spinloop);\n\tunsigned long *acknowledge\n\t\t= (void *) LOW_ADDR(__secondary_hold_acknowledge);\n\tunsigned long secondary_hold = LOW_ADDR(__secondary_hold);\n\n\t/*\n\t * On pseries, if RTAS supports \"query-cpu-stopped-state\",\n\t * we skip this stage, the CPUs will be started by the\n\t * kernel using RTAS.\n\t */\n\tif ((of_platform == PLATFORM_PSERIES ||\n\t     of_platform == PLATFORM_PSERIES_LPAR) &&\n\t    rtas_has_query_cpu_stopped) {\n\t\tprom_printf(\"prom_hold_cpus: skipped\\n\");\n\t\treturn;\n\t}\n\n\tprom_debug(\"prom_hold_cpus: start...\\n\");\n\tprom_debug(\"    1) spinloop       = 0x%lx\\n\", (unsigned long)spinloop);\n\tprom_debug(\"    1) *spinloop      = 0x%lx\\n\", *spinloop);\n\tprom_debug(\"    1) acknowledge    = 0x%lx\\n\",\n\t\t   (unsigned long)acknowledge);\n\tprom_debug(\"    1) *acknowledge   = 0x%lx\\n\", *acknowledge);\n\tprom_debug(\"    1) secondary_hold = 0x%lx\\n\", secondary_hold);\n\n\t/* Set the common spinloop variable, so all of the secondary cpus\n\t * will block when they are awakened from their OF spinloop.\n\t * This must occur for both SMP and non SMP kernels, since OF will\n\t * be trashed when we move the kernel.\n\t */\n\t*spinloop = 0;\n\n\t/* look for cpus */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tunsigned int cpu_no;\n\t\t__be32 reg;\n\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"cpu\") != 0)\n\t\t\tcontinue;\n\n\t\t/* Skip non-configured cpus. */\n\t\tif (prom_getprop(node, \"status\", type, sizeof(type)) > 0)\n\t\t\tif (prom_strcmp(type, \"okay\") != 0)\n\t\t\t\tcontinue;\n\n\t\treg = cpu_to_be32(-1); /* make sparse happy */\n\t\tprom_getprop(node, \"reg\", &reg, sizeof(reg));\n\t\tcpu_no = be32_to_cpu(reg);\n\n\t\tprom_debug(\"cpu hw idx   = %u\\n\", cpu_no);\n\n\t\t/* Init the acknowledge var which will be reset by\n\t\t * the secondary cpu when it awakens from its OF\n\t\t * spinloop.\n\t\t */\n\t\t*acknowledge = (unsigned long)-1;\n\n\t\tif (cpu_no != prom.cpu) {\n\t\t\t/* Primary Thread of non-boot cpu or any thread */\n\t\t\tprom_printf(\"starting cpu hw idx %u... \", cpu_no);\n\t\t\tcall_prom(\"start-cpu\", 3, 0, node,\n\t\t\t\t  secondary_hold, cpu_no);\n\n\t\t\tfor (i = 0; (i < 100000000) && \n\t\t\t     (*acknowledge == ((unsigned long)-1)); i++ )\n\t\t\t\tmb();\n\n\t\t\tif (*acknowledge == cpu_no)\n\t\t\t\tprom_printf(\"done\\n\");\n\t\t\telse\n\t\t\t\tprom_printf(\"failed: %lx\\n\", *acknowledge);\n\t\t}\n#ifdef CONFIG_SMP\n\t\telse\n\t\t\tprom_printf(\"boot cpu hw idx %u\\n\", cpu_no);\n#endif /* CONFIG_SMP */\n\t}\n\n\tprom_debug(\"prom_hold_cpus: end...\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_instantiate_sml",
          "args": [],
          "line": 3432
        },
        "resolved": true,
        "details": {
          "function_name": "prom_instantiate_sml",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1869-1941",
          "snippet": "static void __init prom_instantiate_sml(void)\n{\n\tphandle ibmvtpm_node;\n\tihandle ibmvtpm_inst;\n\tu32 entry = 0, size = 0, succ = 0;\n\tu64 base;\n\t__be32 val;\n\n\tprom_debug(\"prom_instantiate_sml: start...\\n\");\n\n\tibmvtpm_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tprom_debug(\"ibmvtpm_node: %x\\n\", ibmvtpm_node);\n\tif (!PHANDLE_VALID(ibmvtpm_node))\n\t\treturn;\n\n\tibmvtpm_inst = call_prom(\"open\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tif (!IHANDLE_VALID(ibmvtpm_inst)) {\n\t\tprom_printf(\"opening vtpm package failed (%x)\\n\", ibmvtpm_inst);\n\t\treturn;\n\t}\n\n\tif (prom_getprop(ibmvtpm_node, \"ibm,sml-efi-reformat-supported\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR) {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &succ,\n\t\t\t\t  ADDR(\"reformat-sml-to-efi-alignment\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || succ == 0) {\n\t\t\tprom_printf(\"Reformat SML to EFI alignment failed\\n\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-allocated-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get allocated size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-handover-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get handover size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for sml\\n\");\n\n\tprom_printf(\"instantiating sml at 0x%llx...\", base);\n\n\tmemset((void *)base, 0, size);\n\n\tif (call_prom_ret(\"call-method\", 4, 2, &entry,\n\t\t\t  ADDR(\"sml-handover\"),\n\t\t\t  ibmvtpm_inst, size, base) != 0 || entry == 0) {\n\t\tprom_printf(\"SML handover failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-base\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-size\",\n\t\t     &size, sizeof(size));\n\n\tprom_debug(\"sml base     = 0x%llx\\n\", base);\n\tprom_debug(\"sml size     = 0x%x\\n\", size);\n\n\tprom_debug(\"prom_instantiate_sml: end...\\n\");\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init prom_instantiate_sml(void)\n{\n\tphandle ibmvtpm_node;\n\tihandle ibmvtpm_inst;\n\tu32 entry = 0, size = 0, succ = 0;\n\tu64 base;\n\t__be32 val;\n\n\tprom_debug(\"prom_instantiate_sml: start...\\n\");\n\n\tibmvtpm_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tprom_debug(\"ibmvtpm_node: %x\\n\", ibmvtpm_node);\n\tif (!PHANDLE_VALID(ibmvtpm_node))\n\t\treturn;\n\n\tibmvtpm_inst = call_prom(\"open\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tif (!IHANDLE_VALID(ibmvtpm_inst)) {\n\t\tprom_printf(\"opening vtpm package failed (%x)\\n\", ibmvtpm_inst);\n\t\treturn;\n\t}\n\n\tif (prom_getprop(ibmvtpm_node, \"ibm,sml-efi-reformat-supported\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR) {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &succ,\n\t\t\t\t  ADDR(\"reformat-sml-to-efi-alignment\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || succ == 0) {\n\t\t\tprom_printf(\"Reformat SML to EFI alignment failed\\n\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-allocated-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get allocated size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-handover-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get handover size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for sml\\n\");\n\n\tprom_printf(\"instantiating sml at 0x%llx...\", base);\n\n\tmemset((void *)base, 0, size);\n\n\tif (call_prom_ret(\"call-method\", 4, 2, &entry,\n\t\t\t  ADDR(\"sml-handover\"),\n\t\t\t  ibmvtpm_inst, size, base) != 0 || entry == 0) {\n\t\tprom_printf(\"SML handover failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-base\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-size\",\n\t\t     &size, sizeof(size));\n\n\tprom_debug(\"sml base     = 0x%llx\\n\", base);\n\tprom_debug(\"sml size     = 0x%x\\n\", size);\n\n\tprom_debug(\"prom_instantiate_sml: end...\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_instantiate_rtas",
          "args": [],
          "line": 3428
        },
        "resolved": true,
        "details": {
          "function_name": "prom_instantiate_rtas",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1802-1863",
          "snippet": "static void __init prom_instantiate_rtas(void)\n{\n\tphandle rtas_node;\n\tihandle rtas_inst;\n\tu32 base, entry = 0;\n\t__be32 val;\n\tu32 size = 0;\n\n\tprom_debug(\"prom_instantiate_rtas: start...\\n\");\n\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"rtas-size\", &val, sizeof(size));\n\tsize = be32_to_cpu(val);\n\tif (size == 0)\n\t\treturn;\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for RTAS\\n\");\n\n\trtas_inst = call_prom(\"open\", 1, 1, ADDR(\"/rtas\"));\n\tif (!IHANDLE_VALID(rtas_inst)) {\n\t\tprom_printf(\"opening rtas package failed (%x)\\n\", rtas_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating rtas at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 3, 2, &entry,\n\t\t\t  ADDR(\"instantiate-rtas\"),\n\t\t\t  rtas_inst, base) != 0\n\t    || entry == 0) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tval = cpu_to_be32(base);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-base\",\n\t\t     &val, sizeof(val));\n\tval = cpu_to_be32(entry);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-entry\",\n\t\t     &val, sizeof(val));\n\n\t/* Check if it supports \"query-cpu-stopped-state\" */\n\tif (prom_getprop(rtas_node, \"query-cpu-stopped-state\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR)\n\t\trtas_has_query_cpu_stopped = true;\n\n\tprom_debug(\"rtas base     = 0x%x\\n\", base);\n\tprom_debug(\"rtas entry    = 0x%x\\n\", entry);\n\tprom_debug(\"rtas size     = 0x%x\\n\", size);\n\n\tprom_debug(\"prom_instantiate_rtas: end...\\n\");\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static bool  __prombss rtas_has_query_cpu_stopped;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic bool  __prombss rtas_has_query_cpu_stopped;\nstatic void __init;\n\nstatic void __init prom_instantiate_rtas(void)\n{\n\tphandle rtas_node;\n\tihandle rtas_inst;\n\tu32 base, entry = 0;\n\t__be32 val;\n\tu32 size = 0;\n\n\tprom_debug(\"prom_instantiate_rtas: start...\\n\");\n\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"rtas-size\", &val, sizeof(size));\n\tsize = be32_to_cpu(val);\n\tif (size == 0)\n\t\treturn;\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for RTAS\\n\");\n\n\trtas_inst = call_prom(\"open\", 1, 1, ADDR(\"/rtas\"));\n\tif (!IHANDLE_VALID(rtas_inst)) {\n\t\tprom_printf(\"opening rtas package failed (%x)\\n\", rtas_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating rtas at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 3, 2, &entry,\n\t\t\t  ADDR(\"instantiate-rtas\"),\n\t\t\t  rtas_inst, base) != 0\n\t    || entry == 0) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tval = cpu_to_be32(base);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-base\",\n\t\t     &val, sizeof(val));\n\tval = cpu_to_be32(entry);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-entry\",\n\t\t     &val, sizeof(val));\n\n\t/* Check if it supports \"query-cpu-stopped-state\" */\n\tif (prom_getprop(rtas_node, \"query-cpu-stopped-state\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR)\n\t\trtas_has_query_cpu_stopped = true;\n\n\tprom_debug(\"rtas base     = 0x%x\\n\", base);\n\tprom_debug(\"rtas entry    = 0x%x\\n\", entry);\n\tprom_debug(\"rtas size     = 0x%x\\n\", size);\n\n\tprom_debug(\"prom_instantiate_rtas: end...\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_initialize_tce_table",
          "args": [],
          "line": 3420
        },
        "resolved": true,
        "details": {
          "function_name": "prom_initialize_tce_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1947-2066",
          "snippet": "static void __init prom_initialize_tce_table(void)\n{\n\tphandle node;\n\tihandle phb_node;\n\tchar compatible[64], type[64], model[64];\n\tchar *path = prom_scratch;\n\tu64 base, align;\n\tu32 minalign, minsize;\n\tu64 tce_entry, *tce_entryp;\n\tu64 local_alloc_top, local_alloc_bottom;\n\tu64 i;\n\n\tif (prom_iommu_off)\n\t\treturn;\n\n\tprom_debug(\"starting prom_initialize_tce_table\\n\");\n\n\t/* Cache current top of allocs so we reserve a single block */\n\tlocal_alloc_top = alloc_top_high;\n\tlocal_alloc_bottom = local_alloc_top;\n\n\t/* Search all nodes looking for PHBs. */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tcompatible[0] = 0;\n\t\ttype[0] = 0;\n\t\tmodel[0] = 0;\n\t\tprom_getprop(node, \"compatible\",\n\t\t\t     compatible, sizeof(compatible));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tprom_getprop(node, \"model\", model, sizeof(model));\n\n\t\tif ((type[0] == 0) || (prom_strstr(type, \"pci\") == NULL))\n\t\t\tcontinue;\n\n\t\t/* Keep the old logic intact to avoid regression. */\n\t\tif (compatible[0] != 0) {\n\t\t\tif ((prom_strstr(compatible, \"python\") == NULL) &&\n\t\t\t    (prom_strstr(compatible, \"Speedwagon\") == NULL) &&\n\t\t\t    (prom_strstr(compatible, \"Winnipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t} else if (model[0] != 0) {\n\t\t\tif ((prom_strstr(model, \"ython\") == NULL) &&\n\t\t\t    (prom_strstr(model, \"peedwagon\") == NULL) &&\n\t\t\t    (prom_strstr(model, \"innipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (prom_getprop(node, \"tce-table-minalign\", &minalign,\n\t\t\t\t sizeof(minalign)) == PROM_ERROR)\n\t\t\tminalign = 0;\n\t\tif (prom_getprop(node, \"tce-table-minsize\", &minsize,\n\t\t\t\t sizeof(minsize)) == PROM_ERROR)\n\t\t\tminsize = 4UL << 20;\n\n\t\t/*\n\t\t * Even though we read what OF wants, we just set the table\n\t\t * size to 4 MB.  This is enough to map 2GB of PCI DMA space.\n\t\t * By doing this, we avoid the pitfalls of trying to DMA to\n\t\t * MMIO space and the DMA alias hole.\n\t\t */\n\t\tminsize = 4UL << 20;\n\n\t\t/* Align to the greater of the align or size */\n\t\talign = max(minalign, minsize);\n\t\tbase = alloc_down(minsize, align, 1);\n\t\tif (base == 0)\n\t\t\tprom_panic(\"ERROR, cannot find space for TCE table.\\n\");\n\t\tif (base < local_alloc_bottom)\n\t\t\tlocal_alloc_bottom = base;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tmemset(path, 0, sizeof(prom_scratch));\n\t\t/* Call OF to setup the TCE hardware */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node,\n\t\t\t      path, sizeof(prom_scratch) - 1) == PROM_ERROR) {\n\t\t\tprom_printf(\"package-to-path failed\\n\");\n\t\t}\n\n\t\t/* Save away the TCE table attributes for later use. */\n\t\tprom_setprop(node, path, \"linux,tce-base\", &base, sizeof(base));\n\t\tprom_setprop(node, path, \"linux,tce-size\", &minsize, sizeof(minsize));\n\n\t\tprom_debug(\"TCE table: %s\\n\", path);\n\t\tprom_debug(\"\\tnode = 0x%x\\n\", node);\n\t\tprom_debug(\"\\tbase = 0x%llx\\n\", base);\n\t\tprom_debug(\"\\tsize = 0x%x\\n\", minsize);\n\n\t\t/* Initialize the table to have a one-to-one mapping\n\t\t * over the allocated size.\n\t\t */\n\t\ttce_entryp = (u64 *)base;\n\t\tfor (i = 0; i < (minsize >> 3) ;tce_entryp++, i++) {\n\t\t\ttce_entry = (i << PAGE_SHIFT);\n\t\t\ttce_entry |= 0x3;\n\t\t\t*tce_entryp = tce_entry;\n\t\t}\n\n\t\tprom_printf(\"opening PHB %s\", path);\n\t\tphb_node = call_prom(\"open\", 1, 1, path);\n\t\tif (phb_node == 0)\n\t\t\tprom_printf(\"... failed\\n\");\n\t\telse\n\t\t\tprom_printf(\"... done\\n\");\n\n\t\tcall_prom(\"call-method\", 6, 0, ADDR(\"set-64-bit-addressing\"),\n\t\t\t  phb_node, -1, minsize,\n\t\t\t  (u32) base, (u32) (base >> 32));\n\t\tcall_prom(\"close\", 1, 0, phb_node);\n\t}\n\n\treserve_mem(local_alloc_bottom, local_alloc_top - local_alloc_bottom);\n\n\t/* These are only really needed if there is a memory limit in\n\t * effect, but we don't know so export them always. */\n\tprom_tce_alloc_start = local_alloc_bottom;\n\tprom_tce_alloc_end = local_alloc_top;\n\n\t/* Flag the first invalid entry */\n\tprom_debug(\"ending prom_initialize_tce_table\\n\");\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static char __prombss prom_scratch[256];",
            "static unsigned long __prombss alloc_top_high;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic char __prombss prom_scratch[256];\nstatic unsigned long __prombss alloc_top_high;\nstatic void __init;\n\nstatic void __init prom_initialize_tce_table(void)\n{\n\tphandle node;\n\tihandle phb_node;\n\tchar compatible[64], type[64], model[64];\n\tchar *path = prom_scratch;\n\tu64 base, align;\n\tu32 minalign, minsize;\n\tu64 tce_entry, *tce_entryp;\n\tu64 local_alloc_top, local_alloc_bottom;\n\tu64 i;\n\n\tif (prom_iommu_off)\n\t\treturn;\n\n\tprom_debug(\"starting prom_initialize_tce_table\\n\");\n\n\t/* Cache current top of allocs so we reserve a single block */\n\tlocal_alloc_top = alloc_top_high;\n\tlocal_alloc_bottom = local_alloc_top;\n\n\t/* Search all nodes looking for PHBs. */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tcompatible[0] = 0;\n\t\ttype[0] = 0;\n\t\tmodel[0] = 0;\n\t\tprom_getprop(node, \"compatible\",\n\t\t\t     compatible, sizeof(compatible));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tprom_getprop(node, \"model\", model, sizeof(model));\n\n\t\tif ((type[0] == 0) || (prom_strstr(type, \"pci\") == NULL))\n\t\t\tcontinue;\n\n\t\t/* Keep the old logic intact to avoid regression. */\n\t\tif (compatible[0] != 0) {\n\t\t\tif ((prom_strstr(compatible, \"python\") == NULL) &&\n\t\t\t    (prom_strstr(compatible, \"Speedwagon\") == NULL) &&\n\t\t\t    (prom_strstr(compatible, \"Winnipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t} else if (model[0] != 0) {\n\t\t\tif ((prom_strstr(model, \"ython\") == NULL) &&\n\t\t\t    (prom_strstr(model, \"peedwagon\") == NULL) &&\n\t\t\t    (prom_strstr(model, \"innipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (prom_getprop(node, \"tce-table-minalign\", &minalign,\n\t\t\t\t sizeof(minalign)) == PROM_ERROR)\n\t\t\tminalign = 0;\n\t\tif (prom_getprop(node, \"tce-table-minsize\", &minsize,\n\t\t\t\t sizeof(minsize)) == PROM_ERROR)\n\t\t\tminsize = 4UL << 20;\n\n\t\t/*\n\t\t * Even though we read what OF wants, we just set the table\n\t\t * size to 4 MB.  This is enough to map 2GB of PCI DMA space.\n\t\t * By doing this, we avoid the pitfalls of trying to DMA to\n\t\t * MMIO space and the DMA alias hole.\n\t\t */\n\t\tminsize = 4UL << 20;\n\n\t\t/* Align to the greater of the align or size */\n\t\talign = max(minalign, minsize);\n\t\tbase = alloc_down(minsize, align, 1);\n\t\tif (base == 0)\n\t\t\tprom_panic(\"ERROR, cannot find space for TCE table.\\n\");\n\t\tif (base < local_alloc_bottom)\n\t\t\tlocal_alloc_bottom = base;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tmemset(path, 0, sizeof(prom_scratch));\n\t\t/* Call OF to setup the TCE hardware */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node,\n\t\t\t      path, sizeof(prom_scratch) - 1) == PROM_ERROR) {\n\t\t\tprom_printf(\"package-to-path failed\\n\");\n\t\t}\n\n\t\t/* Save away the TCE table attributes for later use. */\n\t\tprom_setprop(node, path, \"linux,tce-base\", &base, sizeof(base));\n\t\tprom_setprop(node, path, \"linux,tce-size\", &minsize, sizeof(minsize));\n\n\t\tprom_debug(\"TCE table: %s\\n\", path);\n\t\tprom_debug(\"\\tnode = 0x%x\\n\", node);\n\t\tprom_debug(\"\\tbase = 0x%llx\\n\", base);\n\t\tprom_debug(\"\\tsize = 0x%x\\n\", minsize);\n\n\t\t/* Initialize the table to have a one-to-one mapping\n\t\t * over the allocated size.\n\t\t */\n\t\ttce_entryp = (u64 *)base;\n\t\tfor (i = 0; i < (minsize >> 3) ;tce_entryp++, i++) {\n\t\t\ttce_entry = (i << PAGE_SHIFT);\n\t\t\ttce_entry |= 0x3;\n\t\t\t*tce_entryp = tce_entry;\n\t\t}\n\n\t\tprom_printf(\"opening PHB %s\", path);\n\t\tphb_node = call_prom(\"open\", 1, 1, path);\n\t\tif (phb_node == 0)\n\t\t\tprom_printf(\"... failed\\n\");\n\t\telse\n\t\t\tprom_printf(\"... done\\n\");\n\n\t\tcall_prom(\"call-method\", 6, 0, ADDR(\"set-64-bit-addressing\"),\n\t\t\t  phb_node, -1, minsize,\n\t\t\t  (u32) base, (u32) (base >> 32));\n\t\tcall_prom(\"close\", 1, 0, phb_node);\n\t}\n\n\treserve_mem(local_alloc_bottom, local_alloc_top - local_alloc_bottom);\n\n\t/* These are only really needed if there is a memory limit in\n\t * effect, but we don't know so export them always. */\n\tprom_tce_alloc_start = local_alloc_bottom;\n\tprom_tce_alloc_end = local_alloc_top;\n\n\t/* Flag the first invalid entry */\n\tprom_debug(\"ending prom_initialize_tce_table\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_check_displays",
          "args": [],
          "line": 3411
        },
        "resolved": true,
        "details": {
          "function_name": "prom_check_displays",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2346-2445",
          "snippet": "static void __init prom_check_displays(void)\n{\n\tchar type[16], *path;\n\tphandle node;\n\tihandle ih;\n\tint i;\n\n\tstatic const unsigned char default_colors[] __initconst = {\n\t\t0x00, 0x00, 0x00,\n\t\t0x00, 0x00, 0xaa,\n\t\t0x00, 0xaa, 0x00,\n\t\t0x00, 0xaa, 0xaa,\n\t\t0xaa, 0x00, 0x00,\n\t\t0xaa, 0x00, 0xaa,\n\t\t0xaa, 0xaa, 0x00,\n\t\t0xaa, 0xaa, 0xaa,\n\t\t0x55, 0x55, 0x55,\n\t\t0x55, 0x55, 0xff,\n\t\t0x55, 0xff, 0x55,\n\t\t0x55, 0xff, 0xff,\n\t\t0xff, 0x55, 0x55,\n\t\t0xff, 0x55, 0xff,\n\t\t0xff, 0xff, 0x55,\n\t\t0xff, 0xff, 0xff\n\t};\n\tconst unsigned char *clut;\n\n\tprom_debug(\"Looking for displays\\n\");\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"display\") != 0)\n\t\t\tcontinue;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tpath = prom_scratch;\n\t\tmemset(path, 0, sizeof(prom_scratch));\n\n\t\t/*\n\t\t * leave some room at the end of the path for appending extra\n\t\t * arguments\n\t\t */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node, path,\n\t\t\t      sizeof(prom_scratch) - 10) == PROM_ERROR)\n\t\t\tcontinue;\n\t\tprom_printf(\"found display   : %s, opening... \", path);\n\t\t\n\t\tih = call_prom(\"open\", 1, 1, path);\n\t\tif (ih == 0) {\n\t\t\tprom_printf(\"failed\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Success */\n\t\tprom_printf(\"done\\n\");\n\t\tprom_setprop(node, path, \"linux,opened\", NULL, 0);\n\n\t\t/* Setup a usable color table when the appropriate\n\t\t * method is available. Should update this to set-colors */\n\t\tclut = default_colors;\n\t\tfor (i = 0; i < 16; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n\n#ifdef CONFIG_LOGO_LINUX_CLUT224\n\t\tclut = PTRRELOC(logo_linux_clut224.clut);\n\t\tfor (i = 0; i < logo_linux_clut224.clutsize; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i + 32, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n#endif /* CONFIG_LOGO_LINUX_CLUT224 */\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t\tif (prom_getprop(node, \"linux,boot-display\", NULL, 0) !=\n\t\t    PROM_ERROR) {\n\t\t\tu32 width, height, pitch, addr;\n\n\t\t\tprom_printf(\"Setting btext !\\n\");\n\n\t\t\tif (prom_getprop(node, \"width\", &width, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"height\", &height, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"linebytes\", &pitch, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"address\", &addr, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tprom_printf(\"W=%d H=%d LB=%d addr=0x%x\\n\",\n\t\t\t\t    width, height, pitch, addr);\n\t\t\tbtext_setup_display(width, height, 8, pitch, addr);\n\t\t\tbtext_prepare_BAT();\n\t\t}\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static char __prombss prom_scratch[256];",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic char __prombss prom_scratch[256];\nstatic void __init;\n\nstatic void __init prom_check_displays(void)\n{\n\tchar type[16], *path;\n\tphandle node;\n\tihandle ih;\n\tint i;\n\n\tstatic const unsigned char default_colors[] __initconst = {\n\t\t0x00, 0x00, 0x00,\n\t\t0x00, 0x00, 0xaa,\n\t\t0x00, 0xaa, 0x00,\n\t\t0x00, 0xaa, 0xaa,\n\t\t0xaa, 0x00, 0x00,\n\t\t0xaa, 0x00, 0xaa,\n\t\t0xaa, 0xaa, 0x00,\n\t\t0xaa, 0xaa, 0xaa,\n\t\t0x55, 0x55, 0x55,\n\t\t0x55, 0x55, 0xff,\n\t\t0x55, 0xff, 0x55,\n\t\t0x55, 0xff, 0xff,\n\t\t0xff, 0x55, 0x55,\n\t\t0xff, 0x55, 0xff,\n\t\t0xff, 0xff, 0x55,\n\t\t0xff, 0xff, 0xff\n\t};\n\tconst unsigned char *clut;\n\n\tprom_debug(\"Looking for displays\\n\");\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"display\") != 0)\n\t\t\tcontinue;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tpath = prom_scratch;\n\t\tmemset(path, 0, sizeof(prom_scratch));\n\n\t\t/*\n\t\t * leave some room at the end of the path for appending extra\n\t\t * arguments\n\t\t */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node, path,\n\t\t\t      sizeof(prom_scratch) - 10) == PROM_ERROR)\n\t\t\tcontinue;\n\t\tprom_printf(\"found display   : %s, opening... \", path);\n\t\t\n\t\tih = call_prom(\"open\", 1, 1, path);\n\t\tif (ih == 0) {\n\t\t\tprom_printf(\"failed\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Success */\n\t\tprom_printf(\"done\\n\");\n\t\tprom_setprop(node, path, \"linux,opened\", NULL, 0);\n\n\t\t/* Setup a usable color table when the appropriate\n\t\t * method is available. Should update this to set-colors */\n\t\tclut = default_colors;\n\t\tfor (i = 0; i < 16; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n\n#ifdef CONFIG_LOGO_LINUX_CLUT224\n\t\tclut = PTRRELOC(logo_linux_clut224.clut);\n\t\tfor (i = 0; i < logo_linux_clut224.clutsize; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i + 32, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n#endif /* CONFIG_LOGO_LINUX_CLUT224 */\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t\tif (prom_getprop(node, \"linux,boot-display\", NULL, 0) !=\n\t\t    PROM_ERROR) {\n\t\t\tu32 width, height, pitch, addr;\n\n\t\t\tprom_printf(\"Setting btext !\\n\");\n\n\t\t\tif (prom_getprop(node, \"width\", &width, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"height\", &height, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"linebytes\", &pitch, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"address\", &addr, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tprom_printf(\"W=%d H=%d LB=%d addr=0x%x\\n\",\n\t\t\t\t    width, height, pitch, addr);\n\t\t\tbtext_setup_display(width, height, 8, pitch, addr);\n\t\t\tbtext_prepare_BAT();\n\t\t}\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_find_boot_cpu",
          "args": [],
          "line": 3406
        },
        "resolved": true,
        "details": {
          "function_name": "prom_find_boot_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "3169-3189",
          "snippet": "static void __init prom_find_boot_cpu(void)\n{\n\t__be32 rval;\n\tihandle prom_cpu;\n\tphandle cpu_pkg;\n\n\trval = 0;\n\tif (prom_getprop(prom.chosen, \"cpu\", &rval, sizeof(rval)) <= 0)\n\t\treturn;\n\tprom_cpu = be32_to_cpu(rval);\n\n\tcpu_pkg = call_prom(\"instance-to-package\", 1, 1, prom_cpu);\n\n\tif (!PHANDLE_VALID(cpu_pkg))\n\t\treturn;\n\n\tprom_getprop(cpu_pkg, \"reg\", &rval, sizeof(rval));\n\tprom.cpu = be32_to_cpu(rval);\n\n\tprom_debug(\"Booting CPU hw index = %d\\n\", prom.cpu);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_find_boot_cpu(void)\n{\n\t__be32 rval;\n\tihandle prom_cpu;\n\tphandle cpu_pkg;\n\n\trval = 0;\n\tif (prom_getprop(prom.chosen, \"cpu\", &rval, sizeof(rval)) <= 0)\n\t\treturn;\n\tprom_cpu = be32_to_cpu(rval);\n\n\tcpu_pkg = call_prom(\"instance-to-package\", 1, 1, prom_cpu);\n\n\tif (!PHANDLE_VALID(cpu_pkg))\n\t\treturn;\n\n\tprom_getprop(cpu_pkg, \"reg\", &rval, sizeof(rval));\n\tprom.cpu = be32_to_cpu(rval);\n\n\tprom_debug(\"Booting CPU hw index = %d\\n\", prom.cpu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_init_mem",
          "args": [],
          "line": 3401
        },
        "resolved": true,
        "details": {
          "function_name": "prom_init_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1620-1746",
          "snippet": "static void __init prom_init_mem(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\tcell_t *p, *endp;\n\t__be32 val;\n\tu32 rac, rsc;\n\n\t/*\n\t * We iterate the memory nodes to find\n\t * 1) top of RMO (first node)\n\t * 2) top of memory\n\t */\n\tval = cpu_to_be32(2);\n\tprom_getprop(prom.root, \"#address-cells\", &val, sizeof(val));\n\trac = be32_to_cpu(val);\n\tval = cpu_to_be32(1);\n\tprom_getprop(prom.root, \"#size-cells\", &val, sizeof(rsc));\n\trsc = be32_to_cpu(val);\n\tprom_debug(\"root_addr_cells: %x\\n\", rac);\n\tprom_debug(\"root_size_cells: %x\\n\", rsc);\n\n\tprom_debug(\"scanning memory:\\n\");\n\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (type[0] == 0) {\n\t\t\t/*\n\t\t\t * CHRP Longtrail machines have no device_type\n\t\t\t * on the memory node, so check the name instead...\n\t\t\t */\n\t\t\tprom_getprop(node, \"name\", type, sizeof(type));\n\t\t}\n\t\tif (prom_strcmp(type, \"memory\"))\n\t\t\tcontinue;\n\n\t\tplen = prom_getprop(node, \"reg\", regbuf, sizeof(regbuf));\n\t\tif (plen > sizeof(regbuf)) {\n\t\t\tprom_printf(\"memory node too large for buffer !\\n\");\n\t\t\tplen = sizeof(regbuf);\n\t\t}\n\t\tp = regbuf;\n\t\tendp = p + (plen / sizeof(cell_t));\n\n#ifdef DEBUG_PROM\n\t\tmemset(prom_scratch, 0, sizeof(prom_scratch));\n\t\tcall_prom(\"package-to-path\", 3, 1, node, prom_scratch,\n\t\t\t  sizeof(prom_scratch) - 1);\n\t\tprom_debug(\"  node %s :\\n\", prom_scratch);\n#endif /* DEBUG_PROM */\n\n\t\twhile ((endp - p) >= (rac + rsc)) {\n\t\t\tunsigned long base, size;\n\n\t\t\tbase = prom_next_cell(rac, &p);\n\t\t\tsize = prom_next_cell(rsc, &p);\n\n\t\t\tif (size == 0)\n\t\t\t\tcontinue;\n\t\t\tprom_debug(\"    %lx %lx\\n\", base, size);\n\t\t\tif (base == 0 && (of_platform & PLATFORM_LPAR))\n\t\t\t\trmo_top = size;\n\t\t\tif ((base + size) > ram_top)\n\t\t\t\tram_top = base + size;\n\t\t}\n\t}\n\n\talloc_bottom = PAGE_ALIGN((unsigned long)&_end + 0x4000);\n\n\t/*\n\t * If prom_memory_limit is set we reduce the upper limits *except* for\n\t * alloc_top_high. This must be the real top of RAM so we can put\n\t * TCE's up there.\n\t */\n\n\talloc_top_high = ram_top;\n\n\tif (prom_memory_limit) {\n\t\tif (prom_memory_limit <= alloc_bottom) {\n\t\t\tprom_printf(\"Ignoring mem=%lx <= alloc_bottom.\\n\",\n\t\t\t\t    prom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else if (prom_memory_limit >= ram_top) {\n\t\t\tprom_printf(\"Ignoring mem=%lx >= ram_top.\\n\",\n\t\t\t\t    prom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else {\n\t\t\tram_top = prom_memory_limit;\n\t\t\trmo_top = min(rmo_top, prom_memory_limit);\n\t\t}\n\t}\n\n\t/*\n\t * Setup our top alloc point, that is top of RMO or top of\n\t * segment 0 when running non-LPAR.\n\t * Some RS64 machines have buggy firmware where claims up at\n\t * 1GB fail.  Cap at 768MB as a workaround.\n\t * Since 768MB is plenty of room, and we need to cap to something\n\t * reasonable on 32-bit, cap at 768MB on all machines.\n\t */\n\tif (!rmo_top)\n\t\trmo_top = ram_top;\n\trmo_top = min(0x30000000ul, rmo_top);\n\talloc_top = rmo_top;\n\talloc_top_high = ram_top;\n\n\t/*\n\t * Check if we have an initrd after the kernel but still inside\n\t * the RMO.  If we do move our bottom point to after it.\n\t */\n\tif (prom_initrd_start &&\n\t    prom_initrd_start < rmo_top &&\n\t    prom_initrd_end > alloc_bottom)\n\t\talloc_bottom = PAGE_ALIGN(prom_initrd_end);\n\n\tprom_printf(\"memory layout at init:\\n\");\n\tprom_printf(\"  memory_limit : %lx (16 MB aligned)\\n\",\n\t\t    prom_memory_limit);\n\tprom_printf(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_printf(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_printf(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_printf(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_printf(\"  ram_top      : %lx\\n\", ram_top);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PLATFORM_LPAR\t\t0x0001"
          ],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static char __prombss prom_scratch[256];",
            "static unsigned long __prombss prom_initrd_start, prom_initrd_end;",
            "static int __prombss of_platform;",
            "static unsigned long __prombss prom_memory_limit;",
            "static unsigned long __prombss alloc_top;",
            "static unsigned long __prombss alloc_top_high;",
            "static unsigned long __prombss alloc_bottom;",
            "static unsigned long __prombss rmo_top;",
            "static unsigned long __prombss ram_top;",
            "static cell_t __prombss regbuf[1024];",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PLATFORM_LPAR\t\t0x0001\n\nstatic struct prom_t __prombss prom;\nstatic char __prombss prom_scratch[256];\nstatic unsigned long __prombss prom_initrd_start, prom_initrd_end;\nstatic int __prombss of_platform;\nstatic unsigned long __prombss prom_memory_limit;\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_top_high;\nstatic unsigned long __prombss alloc_bottom;\nstatic unsigned long __prombss rmo_top;\nstatic unsigned long __prombss ram_top;\nstatic cell_t __prombss regbuf[1024];\nstatic void __init;\n\nstatic void __init prom_init_mem(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\tcell_t *p, *endp;\n\t__be32 val;\n\tu32 rac, rsc;\n\n\t/*\n\t * We iterate the memory nodes to find\n\t * 1) top of RMO (first node)\n\t * 2) top of memory\n\t */\n\tval = cpu_to_be32(2);\n\tprom_getprop(prom.root, \"#address-cells\", &val, sizeof(val));\n\trac = be32_to_cpu(val);\n\tval = cpu_to_be32(1);\n\tprom_getprop(prom.root, \"#size-cells\", &val, sizeof(rsc));\n\trsc = be32_to_cpu(val);\n\tprom_debug(\"root_addr_cells: %x\\n\", rac);\n\tprom_debug(\"root_size_cells: %x\\n\", rsc);\n\n\tprom_debug(\"scanning memory:\\n\");\n\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (type[0] == 0) {\n\t\t\t/*\n\t\t\t * CHRP Longtrail machines have no device_type\n\t\t\t * on the memory node, so check the name instead...\n\t\t\t */\n\t\t\tprom_getprop(node, \"name\", type, sizeof(type));\n\t\t}\n\t\tif (prom_strcmp(type, \"memory\"))\n\t\t\tcontinue;\n\n\t\tplen = prom_getprop(node, \"reg\", regbuf, sizeof(regbuf));\n\t\tif (plen > sizeof(regbuf)) {\n\t\t\tprom_printf(\"memory node too large for buffer !\\n\");\n\t\t\tplen = sizeof(regbuf);\n\t\t}\n\t\tp = regbuf;\n\t\tendp = p + (plen / sizeof(cell_t));\n\n#ifdef DEBUG_PROM\n\t\tmemset(prom_scratch, 0, sizeof(prom_scratch));\n\t\tcall_prom(\"package-to-path\", 3, 1, node, prom_scratch,\n\t\t\t  sizeof(prom_scratch) - 1);\n\t\tprom_debug(\"  node %s :\\n\", prom_scratch);\n#endif /* DEBUG_PROM */\n\n\t\twhile ((endp - p) >= (rac + rsc)) {\n\t\t\tunsigned long base, size;\n\n\t\t\tbase = prom_next_cell(rac, &p);\n\t\t\tsize = prom_next_cell(rsc, &p);\n\n\t\t\tif (size == 0)\n\t\t\t\tcontinue;\n\t\t\tprom_debug(\"    %lx %lx\\n\", base, size);\n\t\t\tif (base == 0 && (of_platform & PLATFORM_LPAR))\n\t\t\t\trmo_top = size;\n\t\t\tif ((base + size) > ram_top)\n\t\t\t\tram_top = base + size;\n\t\t}\n\t}\n\n\talloc_bottom = PAGE_ALIGN((unsigned long)&_end + 0x4000);\n\n\t/*\n\t * If prom_memory_limit is set we reduce the upper limits *except* for\n\t * alloc_top_high. This must be the real top of RAM so we can put\n\t * TCE's up there.\n\t */\n\n\talloc_top_high = ram_top;\n\n\tif (prom_memory_limit) {\n\t\tif (prom_memory_limit <= alloc_bottom) {\n\t\t\tprom_printf(\"Ignoring mem=%lx <= alloc_bottom.\\n\",\n\t\t\t\t    prom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else if (prom_memory_limit >= ram_top) {\n\t\t\tprom_printf(\"Ignoring mem=%lx >= ram_top.\\n\",\n\t\t\t\t    prom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else {\n\t\t\tram_top = prom_memory_limit;\n\t\t\trmo_top = min(rmo_top, prom_memory_limit);\n\t\t}\n\t}\n\n\t/*\n\t * Setup our top alloc point, that is top of RMO or top of\n\t * segment 0 when running non-LPAR.\n\t * Some RS64 machines have buggy firmware where claims up at\n\t * 1GB fail.  Cap at 768MB as a workaround.\n\t * Since 768MB is plenty of room, and we need to cap to something\n\t * reasonable on 32-bit, cap at 768MB on all machines.\n\t */\n\tif (!rmo_top)\n\t\trmo_top = ram_top;\n\trmo_top = min(0x30000000ul, rmo_top);\n\talloc_top = rmo_top;\n\talloc_top_high = ram_top;\n\n\t/*\n\t * Check if we have an initrd after the kernel but still inside\n\t * the RMO.  If we do move our bottom point to after it.\n\t */\n\tif (prom_initrd_start &&\n\t    prom_initrd_start < rmo_top &&\n\t    prom_initrd_end > alloc_bottom)\n\t\talloc_bottom = PAGE_ALIGN(prom_initrd_end);\n\n\tprom_printf(\"memory layout at init:\\n\");\n\tprom_printf(\"  memory_limit : %lx (16 MB aligned)\\n\",\n\t\t    prom_memory_limit);\n\tprom_printf(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_printf(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_printf(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_printf(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_printf(\"  ram_top      : %lx\\n\", ram_top);\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_and_flush",
          "args": [
            "0",
            "kbase",
            "0x100",
            "0"
          ],
          "line": 3396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_send_capabilities",
          "args": [],
          "line": 3389
        },
        "resolved": true,
        "details": {
          "function_name": "prom_send_capabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1368-1426",
          "snippet": "static void __init prom_send_capabilities(void)\n{\n\tihandle root;\n\tprom_arg_t ret;\n\tu32 cores;\n\n\t/* Check ibm,arch-vec-5-platform-support and fixup vec5 if required */\n\tprom_check_platform_support();\n\n\troot = call_prom(\"open\", 1, 1, ADDR(\"/\"));\n\tif (root != 0) {\n\t\t/* We need to tell the FW about the number of cores we support.\n\t\t *\n\t\t * To do that, we count the number of threads on the first core\n\t\t * (we assume this is the same for all cores) and use it to\n\t\t * divide NR_CPUS.\n\t\t */\n\n\t\tcores = DIV_ROUND_UP(NR_CPUS, prom_count_smt_threads());\n\t\tprom_printf(\"Max number of cores passed to firmware: %u (NR_CPUS = %d)\\n\",\n\t\t\t    cores, NR_CPUS);\n\n\t\tibm_architecture_vec.vec5.max_cpus = cpu_to_be32(cores);\n\n\t\t/* try calling the ibm,client-architecture-support method */\n\t\tprom_printf(\"Calling ibm,client-architecture-support...\");\n\t\tif (call_prom_ret(\"call-method\", 3, 2, &ret,\n\t\t\t\t  ADDR(\"ibm,client-architecture-support\"),\n\t\t\t\t  root,\n\t\t\t\t  ADDR(&ibm_architecture_vec)) == 0) {\n\t\t\t/* the call exists... */\n\t\t\tif (ret)\n\t\t\t\tprom_printf(\"\\nWARNING: ibm,client-architecture\"\n\t\t\t\t\t    \"-support call FAILED!\\n\");\n\t\t\tcall_prom(\"close\", 1, 0, root);\n\t\t\tprom_printf(\" done\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"close\", 1, 0, root);\n\t\tprom_printf(\" not implemented\\n\");\n\t}\n\n#ifdef __BIG_ENDIAN__\n\t{\n\t\tihandle elfloader;\n\n\t\t/* no ibm,client-architecture-support call, try the old way */\n\t\telfloader = call_prom(\"open\", 1, 1,\n\t\t\t\t      ADDR(\"/packages/elf-loader\"));\n\t\tif (elfloader == 0) {\n\t\t\tprom_printf(\"couldn't open /packages/elf-loader\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"call-method\", 3, 1, ADDR(\"process-elf-header\"),\n\t\t\t  elfloader, ADDR(&fake_elf));\n\t\tcall_prom(\"close\", 1, 0, elfloader);\n\t}\n#endif /* __BIG_ENDIAN__ */\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_send_capabilities(void)\n{\n\tihandle root;\n\tprom_arg_t ret;\n\tu32 cores;\n\n\t/* Check ibm,arch-vec-5-platform-support and fixup vec5 if required */\n\tprom_check_platform_support();\n\n\troot = call_prom(\"open\", 1, 1, ADDR(\"/\"));\n\tif (root != 0) {\n\t\t/* We need to tell the FW about the number of cores we support.\n\t\t *\n\t\t * To do that, we count the number of threads on the first core\n\t\t * (we assume this is the same for all cores) and use it to\n\t\t * divide NR_CPUS.\n\t\t */\n\n\t\tcores = DIV_ROUND_UP(NR_CPUS, prom_count_smt_threads());\n\t\tprom_printf(\"Max number of cores passed to firmware: %u (NR_CPUS = %d)\\n\",\n\t\t\t    cores, NR_CPUS);\n\n\t\tibm_architecture_vec.vec5.max_cpus = cpu_to_be32(cores);\n\n\t\t/* try calling the ibm,client-architecture-support method */\n\t\tprom_printf(\"Calling ibm,client-architecture-support...\");\n\t\tif (call_prom_ret(\"call-method\", 3, 2, &ret,\n\t\t\t\t  ADDR(\"ibm,client-architecture-support\"),\n\t\t\t\t  root,\n\t\t\t\t  ADDR(&ibm_architecture_vec)) == 0) {\n\t\t\t/* the call exists... */\n\t\t\tif (ret)\n\t\t\t\tprom_printf(\"\\nWARNING: ibm,client-architecture\"\n\t\t\t\t\t    \"-support call FAILED!\\n\");\n\t\t\tcall_prom(\"close\", 1, 0, root);\n\t\t\tprom_printf(\" done\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"close\", 1, 0, root);\n\t\tprom_printf(\" not implemented\\n\");\n\t}\n\n#ifdef __BIG_ENDIAN__\n\t{\n\t\tihandle elfloader;\n\n\t\t/* no ibm,client-architecture-support call, try the old way */\n\t\telfloader = call_prom(\"open\", 1, 1,\n\t\t\t\t      ADDR(\"/packages/elf-loader\"));\n\t\tif (elfloader == 0) {\n\t\t\tprom_printf(\"couldn't open /packages/elf-loader\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"call-method\", 3, 1, ADDR(\"process-elf-header\"),\n\t\t\t  elfloader, ADDR(&fake_elf));\n\t\tcall_prom(\"close\", 1, 0, elfloader);\n\t}\n#endif /* __BIG_ENDIAN__ */\n}"
        }
      },
      {
        "call_info": {
          "callee": "early_cmdline_parse",
          "args": [],
          "line": 3381
        },
        "resolved": true,
        "details": {
          "function_name": "early_cmdline_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "767-850",
          "snippet": "static void __init early_cmdline_parse(void)\n{\n\tconst char *opt;\n\n\tchar *p;\n\tint l = 0;\n\n\tprom_cmd_line[0] = 0;\n\tp = prom_cmd_line;\n\n\tif (!IS_ENABLED(CONFIG_CMDLINE_FORCE) && (long)prom.chosen > 0)\n\t\tl = prom_getprop(prom.chosen, \"bootargs\", p, COMMAND_LINE_SIZE-1);\n\n\tif (IS_ENABLED(CONFIG_CMDLINE_EXTEND) || l <= 0 || p[0] == '\\0')\n\t\tprom_strlcat(prom_cmd_line, \" \" CONFIG_CMDLINE,\n\t\t\t     sizeof(prom_cmd_line));\n\n\tprom_printf(\"command line: %s\\n\", prom_cmd_line);\n\n#ifdef CONFIG_PPC64\n\topt = prom_strstr(prom_cmd_line, \"iommu=\");\n\tif (opt) {\n\t\tprom_printf(\"iommu opt is: %s\\n\", opt);\n\t\topt += 6;\n\t\twhile (*opt && *opt == ' ')\n\t\t\topt++;\n\t\tif (!prom_strncmp(opt, \"off\", 3))\n\t\t\tprom_iommu_off = 1;\n\t\telse if (!prom_strncmp(opt, \"force\", 5))\n\t\t\tprom_iommu_force_on = 1;\n\t}\n#endif\n\topt = prom_strstr(prom_cmd_line, \"mem=\");\n\tif (opt) {\n\t\topt += 4;\n\t\tprom_memory_limit = prom_memparse(opt, (const char **)&opt);\n#ifdef CONFIG_PPC64\n\t\t/* Align to 16 MB == size of ppc64 large page */\n\t\tprom_memory_limit = ALIGN(prom_memory_limit, 0x1000000);\n#endif\n\t}\n\n#ifdef CONFIG_PPC_PSERIES\n\tprom_radix_disable = !IS_ENABLED(CONFIG_PPC_RADIX_MMU_DEFAULT);\n\topt = prom_strstr(prom_cmd_line, \"disable_radix\");\n\tif (opt) {\n\t\topt += 13;\n\t\tif (*opt && *opt == '=') {\n\t\t\tbool val;\n\n\t\t\tif (prom_strtobool(++opt, &val))\n\t\t\t\tprom_radix_disable = false;\n\t\t\telse\n\t\t\t\tprom_radix_disable = val;\n\t\t} else\n\t\t\tprom_radix_disable = true;\n\t}\n\tif (prom_radix_disable)\n\t\tprom_debug(\"Radix disabled from cmdline\\n\");\n\n\topt = prom_strstr(prom_cmd_line, \"radix_hcall_invalidate=on\");\n\tif (opt) {\n\t\tprom_radix_gtse_disable = true;\n\t\tprom_debug(\"Radix GTSE disabled from cmdline\\n\");\n\t}\n\n\topt = prom_strstr(prom_cmd_line, \"xive=off\");\n\tif (opt) {\n\t\tprom_xive_disable = true;\n\t\tprom_debug(\"XIVE disabled from cmdline\\n\");\n\t}\n#endif /* CONFIG_PPC_PSERIES */\n\n#ifdef CONFIG_PPC_SVM\n\topt = prom_strstr(prom_cmd_line, \"svm=\");\n\tif (opt) {\n\t\tbool val;\n\n\t\topt += sizeof(\"svm=\") - 1;\n\t\tif (!prom_strtobool(opt, &val))\n\t\t\tprom_svm_enable = val;\n\t}\n#endif /* CONFIG_PPC_SVM */\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static char __prombss prom_cmd_line[COMMAND_LINE_SIZE];",
            "static unsigned long __prombss prom_memory_limit;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic char __prombss prom_cmd_line[COMMAND_LINE_SIZE];\nstatic unsigned long __prombss prom_memory_limit;\nstatic void __init;\n\nstatic void __init early_cmdline_parse(void)\n{\n\tconst char *opt;\n\n\tchar *p;\n\tint l = 0;\n\n\tprom_cmd_line[0] = 0;\n\tp = prom_cmd_line;\n\n\tif (!IS_ENABLED(CONFIG_CMDLINE_FORCE) && (long)prom.chosen > 0)\n\t\tl = prom_getprop(prom.chosen, \"bootargs\", p, COMMAND_LINE_SIZE-1);\n\n\tif (IS_ENABLED(CONFIG_CMDLINE_EXTEND) || l <= 0 || p[0] == '\\0')\n\t\tprom_strlcat(prom_cmd_line, \" \" CONFIG_CMDLINE,\n\t\t\t     sizeof(prom_cmd_line));\n\n\tprom_printf(\"command line: %s\\n\", prom_cmd_line);\n\n#ifdef CONFIG_PPC64\n\topt = prom_strstr(prom_cmd_line, \"iommu=\");\n\tif (opt) {\n\t\tprom_printf(\"iommu opt is: %s\\n\", opt);\n\t\topt += 6;\n\t\twhile (*opt && *opt == ' ')\n\t\t\topt++;\n\t\tif (!prom_strncmp(opt, \"off\", 3))\n\t\t\tprom_iommu_off = 1;\n\t\telse if (!prom_strncmp(opt, \"force\", 5))\n\t\t\tprom_iommu_force_on = 1;\n\t}\n#endif\n\topt = prom_strstr(prom_cmd_line, \"mem=\");\n\tif (opt) {\n\t\topt += 4;\n\t\tprom_memory_limit = prom_memparse(opt, (const char **)&opt);\n#ifdef CONFIG_PPC64\n\t\t/* Align to 16 MB == size of ppc64 large page */\n\t\tprom_memory_limit = ALIGN(prom_memory_limit, 0x1000000);\n#endif\n\t}\n\n#ifdef CONFIG_PPC_PSERIES\n\tprom_radix_disable = !IS_ENABLED(CONFIG_PPC_RADIX_MMU_DEFAULT);\n\topt = prom_strstr(prom_cmd_line, \"disable_radix\");\n\tif (opt) {\n\t\topt += 13;\n\t\tif (*opt && *opt == '=') {\n\t\t\tbool val;\n\n\t\t\tif (prom_strtobool(++opt, &val))\n\t\t\t\tprom_radix_disable = false;\n\t\t\telse\n\t\t\t\tprom_radix_disable = val;\n\t\t} else\n\t\t\tprom_radix_disable = true;\n\t}\n\tif (prom_radix_disable)\n\t\tprom_debug(\"Radix disabled from cmdline\\n\");\n\n\topt = prom_strstr(prom_cmd_line, \"radix_hcall_invalidate=on\");\n\tif (opt) {\n\t\tprom_radix_gtse_disable = true;\n\t\tprom_debug(\"Radix GTSE disabled from cmdline\\n\");\n\t}\n\n\topt = prom_strstr(prom_cmd_line, \"xive=off\");\n\tif (opt) {\n\t\tprom_xive_disable = true;\n\t\tprom_debug(\"XIVE disabled from cmdline\\n\");\n\t}\n#endif /* CONFIG_PPC_PSERIES */\n\n#ifdef CONFIG_PPC_SVM\n\topt = prom_strstr(prom_cmd_line, \"svm=\");\n\tif (opt) {\n\t\tbool val;\n\n\t\topt += sizeof(\"svm=\") - 1;\n\t\tif (!prom_strtobool(opt, &val))\n\t\t\tprom_svm_enable = val;\n\t}\n#endif /* CONFIG_PPC_SVM */\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_check_initrd",
          "args": [
            "r3",
            "r4"
          ],
          "line": 3376
        },
        "resolved": true,
        "details": {
          "function_name": "prom_check_initrd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "3191-3214",
          "snippet": "static void __init prom_check_initrd(unsigned long r3, unsigned long r4)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tif (r3 && r4 && r4 != 0xdeadbeef) {\n\t\t__be64 val;\n\n\t\tprom_initrd_start = is_kernel_addr(r3) ? __pa(r3) : r3;\n\t\tprom_initrd_end = prom_initrd_start + r4;\n\n\t\tval = cpu_to_be64(prom_initrd_start);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-start\",\n\t\t\t     &val, sizeof(val));\n\t\tval = cpu_to_be64(prom_initrd_end);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-end\",\n\t\t\t     &val, sizeof(val));\n\n\t\treserve_mem(prom_initrd_start,\n\t\t\t    prom_initrd_end - prom_initrd_start);\n\n\t\tprom_debug(\"initrd_start=0x%lx\\n\", prom_initrd_start);\n\t\tprom_debug(\"initrd_end=0x%lx\\n\", prom_initrd_end);\n\t}\n#endif /* CONFIG_BLK_DEV_INITRD */\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static unsigned long __prombss prom_initrd_start, prom_initrd_end;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic unsigned long __prombss prom_initrd_start, prom_initrd_end;\nstatic void __init;\n\nstatic void __init prom_check_initrd(unsigned long r3, unsigned long r4)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tif (r3 && r4 && r4 != 0xdeadbeef) {\n\t\t__be64 val;\n\n\t\tprom_initrd_start = is_kernel_addr(r3) ? __pa(r3) : r3;\n\t\tprom_initrd_end = prom_initrd_start + r4;\n\n\t\tval = cpu_to_be64(prom_initrd_start);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-start\",\n\t\t\t     &val, sizeof(val));\n\t\tval = cpu_to_be64(prom_initrd_end);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-end\",\n\t\t\t     &val, sizeof(val));\n\n\t\treserve_mem(prom_initrd_start,\n\t\t\t    prom_initrd_end - prom_initrd_start);\n\n\t\tprom_debug(\"initrd_start=0x%lx\\n\", prom_initrd_start);\n\t\tprom_debug(\"initrd_end=0x%lx\\n\", prom_initrd_end);\n\t}\n#endif /* CONFIG_BLK_DEV_INITRD */\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Error: You can't boot a kdump kernel from OF!\\n\""
          ],
          "line": 3370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_find_machine_type",
          "args": [],
          "line": 3364
        },
        "resolved": true,
        "details": {
          "function_name": "prom_find_machine_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2270-2331",
          "snippet": "static int __init prom_find_machine_type(void)\n{\n\tchar compat[256];\n\tint len, i = 0;\n#ifdef CONFIG_PPC64\n\tphandle rtas;\n\tint x;\n#endif\n\n\t/* Look for a PowerMac or a Cell */\n\tlen = prom_getprop(prom.root, \"compatible\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len > 0) {\n\t\tcompat[len] = 0;\n\t\twhile (i < len) {\n\t\t\tchar *p = &compat[i];\n\t\t\tint sl = prom_strlen(p);\n\t\t\tif (sl == 0)\n\t\t\t\tbreak;\n\t\t\tif (prom_strstr(p, \"Power Macintosh\") ||\n\t\t\t    prom_strstr(p, \"MacRISC\"))\n\t\t\t\treturn PLATFORM_POWERMAC;\n#ifdef CONFIG_PPC64\n\t\t\t/* We must make sure we don't detect the IBM Cell\n\t\t\t * blades as pSeries due to some firmware issues,\n\t\t\t * so we do it here.\n\t\t\t */\n\t\t\tif (prom_strstr(p, \"IBM,CBEA\") ||\n\t\t\t    prom_strstr(p, \"IBM,CPBW-1.0\"))\n\t\t\t\treturn PLATFORM_GENERIC;\n#endif /* CONFIG_PPC64 */\n\t\t\ti += sl + 1;\n\t\t}\n\t}\n#ifdef CONFIG_PPC64\n\t/* Try to figure out if it's an IBM pSeries or any other\n\t * PAPR compliant platform. We assume it is if :\n\t *  - /device_type is \"chrp\" (please, do NOT use that for future\n\t *    non-IBM designs !\n\t *  - it has /rtas\n\t */\n\tlen = prom_getprop(prom.root, \"device_type\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len <= 0)\n\t\treturn PLATFORM_GENERIC;\n\tif (prom_strcmp(compat, \"chrp\"))\n\t\treturn PLATFORM_GENERIC;\n\n\t/* Default to pSeries. We need to know if we are running LPAR */\n\trtas = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tif (!PHANDLE_VALID(rtas))\n\t\treturn PLATFORM_GENERIC;\n\tx = prom_getproplen(rtas, \"ibm,hypertas-functions\");\n\tif (x != PROM_ERROR) {\n\t\tprom_debug(\"Hypertas detected, assuming LPAR !\\n\");\n\t\treturn PLATFORM_PSERIES_LPAR;\n\t}\n\treturn PLATFORM_PSERIES;\n#else\n\treturn PLATFORM_GENERIC;\n#endif\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)",
            "#define PLATFORM_GENERIC\t0x0500",
            "#define PLATFORM_POWERMAC\t0x0400",
            "#define PLATFORM_PSERIES_LPAR\t0x0101",
            "#define PLATFORM_PSERIES\t0x0100"
          ],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n#define PLATFORM_GENERIC\t0x0500\n#define PLATFORM_POWERMAC\t0x0400\n#define PLATFORM_PSERIES_LPAR\t0x0101\n#define PLATFORM_PSERIES\t0x0100\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic int __init prom_find_machine_type(void)\n{\n\tchar compat[256];\n\tint len, i = 0;\n#ifdef CONFIG_PPC64\n\tphandle rtas;\n\tint x;\n#endif\n\n\t/* Look for a PowerMac or a Cell */\n\tlen = prom_getprop(prom.root, \"compatible\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len > 0) {\n\t\tcompat[len] = 0;\n\t\twhile (i < len) {\n\t\t\tchar *p = &compat[i];\n\t\t\tint sl = prom_strlen(p);\n\t\t\tif (sl == 0)\n\t\t\t\tbreak;\n\t\t\tif (prom_strstr(p, \"Power Macintosh\") ||\n\t\t\t    prom_strstr(p, \"MacRISC\"))\n\t\t\t\treturn PLATFORM_POWERMAC;\n#ifdef CONFIG_PPC64\n\t\t\t/* We must make sure we don't detect the IBM Cell\n\t\t\t * blades as pSeries due to some firmware issues,\n\t\t\t * so we do it here.\n\t\t\t */\n\t\t\tif (prom_strstr(p, \"IBM,CBEA\") ||\n\t\t\t    prom_strstr(p, \"IBM,CPBW-1.0\"))\n\t\t\t\treturn PLATFORM_GENERIC;\n#endif /* CONFIG_PPC64 */\n\t\t\ti += sl + 1;\n\t\t}\n\t}\n#ifdef CONFIG_PPC64\n\t/* Try to figure out if it's an IBM pSeries or any other\n\t * PAPR compliant platform. We assume it is if :\n\t *  - /device_type is \"chrp\" (please, do NOT use that for future\n\t *    non-IBM designs !\n\t *  - it has /rtas\n\t */\n\tlen = prom_getprop(prom.root, \"device_type\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len <= 0)\n\t\treturn PLATFORM_GENERIC;\n\tif (prom_strcmp(compat, \"chrp\"))\n\t\treturn PLATFORM_GENERIC;\n\n\t/* Default to pSeries. We need to know if we are running LPAR */\n\trtas = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tif (!PHANDLE_VALID(rtas))\n\t\treturn PLATFORM_GENERIC;\n\tx = prom_getproplen(rtas, \"ibm,hypertas-functions\");\n\tif (x != PROM_ERROR) {\n\t\tprom_debug(\"Hypertas detected, assuming LPAR !\\n\");\n\t\treturn PLATFORM_PSERIES_LPAR;\n\t}\n\treturn PLATFORM_PSERIES;\n#else\n\treturn PLATFORM_GENERIC;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_init_stdout",
          "args": [],
          "line": 3356
        },
        "resolved": true,
        "details": {
          "function_name": "prom_init_stdout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2238-2268",
          "snippet": "static void __init prom_init_stdout(void)\n{\n\tchar *path = of_stdout_device;\n\tchar type[16];\n\tphandle stdout_node;\n\t__be32 val;\n\n\tif (prom_getprop(prom.chosen, \"stdout\", &val, sizeof(val)) <= 0)\n\t\tprom_panic(\"cannot find stdout\");\n\n\tprom.stdout = be32_to_cpu(val);\n\n\t/* Get the full OF pathname of the stdout device */\n\tmemset(path, 0, 256);\n\tcall_prom(\"instance-to-path\", 3, 1, prom.stdout, path, 255);\n\tprom_printf(\"OF stdout device is: %s\\n\", of_stdout_device);\n\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-path\",\n\t\t     path, prom_strlen(path) + 1);\n\n\t/* instance-to-package fails on PA-Semi */\n\tstdout_node = call_prom(\"instance-to-package\", 1, 1, prom.stdout);\n\tif (stdout_node != PROM_ERROR) {\n\t\tval = cpu_to_be32(stdout_node);\n\n\t\t/* If it's a display, note it */\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(stdout_node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"display\") == 0)\n\t\t\tprom_setprop(stdout_node, path, \"linux,boot-display\", NULL, 0);\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static char __prombss of_stdout_device[256];",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic struct prom_t __prombss prom;\nstatic char __prombss of_stdout_device[256];\nstatic void __init;\n\nstatic void __init prom_init_stdout(void)\n{\n\tchar *path = of_stdout_device;\n\tchar type[16];\n\tphandle stdout_node;\n\t__be32 val;\n\n\tif (prom_getprop(prom.chosen, \"stdout\", &val, sizeof(val)) <= 0)\n\t\tprom_panic(\"cannot find stdout\");\n\n\tprom.stdout = be32_to_cpu(val);\n\n\t/* Get the full OF pathname of the stdout device */\n\tmemset(path, 0, 256);\n\tcall_prom(\"instance-to-path\", 3, 1, prom.stdout, path, 255);\n\tprom_printf(\"OF stdout device is: %s\\n\", of_stdout_device);\n\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-path\",\n\t\t     path, prom_strlen(path) + 1);\n\n\t/* instance-to-package fails on PA-Semi */\n\tstdout_node = call_prom(\"instance-to-package\", 1, 1, prom.stdout);\n\tif (stdout_node != PROM_ERROR) {\n\t\tval = cpu_to_be32(stdout_node);\n\n\t\t/* If it's a display, note it */\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(stdout_node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"display\") == 0)\n\t\t\tprom_setprop(stdout_node, path, \"linux,boot-display\", NULL, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_find_mmu",
          "args": [],
          "line": 3351
        },
        "resolved": true,
        "details": {
          "function_name": "prom_find_mmu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2208-2233",
          "snippet": "static void __init prom_find_mmu(void)\n{\n\tphandle oprom;\n\tchar version[64];\n\n\toprom = call_prom(\"finddevice\", 1, 1, ADDR(\"/openprom\"));\n\tif (!PHANDLE_VALID(oprom))\n\t\treturn;\n\tif (prom_getprop(oprom, \"model\", version, sizeof(version)) <= 0)\n\t\treturn;\n\tversion[sizeof(version) - 1] = 0;\n\t/* XXX might need to add other versions here */\n\tif (prom_strcmp(version, \"Open Firmware, 1.0.5\") == 0)\n\t\tof_workarounds = OF_WA_CLAIM;\n\telse if (prom_strncmp(version, \"FirmWorks,3.\", 12) == 0) {\n\t\tof_workarounds = OF_WA_CLAIM | OF_WA_LONGTRAIL;\n\t\tcall_prom(\"interpret\", 1, 1, \"dev /memory 0 to allow-reclaim\");\n\t} else\n\t\treturn;\n\tprom.memory = call_prom(\"open\", 1, 1, ADDR(\"/memory\"));\n\tprom_getprop(prom.chosen, \"mmu\", &prom.mmumap,\n\t\t     sizeof(prom.mmumap));\n\tprom.mmumap = be32_to_cpu(prom.mmumap);\n\tif (!IHANDLE_VALID(prom.memory) || !IHANDLE_VALID(prom.mmumap))\n\t\tof_workarounds &= ~OF_WA_CLAIM;\t\t/* hmmm */\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */"
          ],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_find_mmu(void)\n{\n\tphandle oprom;\n\tchar version[64];\n\n\toprom = call_prom(\"finddevice\", 1, 1, ADDR(\"/openprom\"));\n\tif (!PHANDLE_VALID(oprom))\n\t\treturn;\n\tif (prom_getprop(oprom, \"model\", version, sizeof(version)) <= 0)\n\t\treturn;\n\tversion[sizeof(version) - 1] = 0;\n\t/* XXX might need to add other versions here */\n\tif (prom_strcmp(version, \"Open Firmware, 1.0.5\") == 0)\n\t\tof_workarounds = OF_WA_CLAIM;\n\telse if (prom_strncmp(version, \"FirmWorks,3.\", 12) == 0) {\n\t\tof_workarounds = OF_WA_CLAIM | OF_WA_LONGTRAIL;\n\t\tcall_prom(\"interpret\", 1, 1, \"dev /memory 0 to allow-reclaim\");\n\t} else\n\t\treturn;\n\tprom.memory = call_prom(\"open\", 1, 1, ADDR(\"/memory\"));\n\tprom_getprop(prom.chosen, \"mmu\", &prom.mmumap,\n\t\t     sizeof(prom.mmumap));\n\tprom.mmumap = be32_to_cpu(prom.mmumap);\n\tif (!IHANDLE_VALID(prom.memory) || !IHANDLE_VALID(prom.mmumap))\n\t\tof_workarounds &= ~OF_WA_CLAIM;\t\t/* hmmm */\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_init_client_services",
          "args": [
            "pp"
          ],
          "line": 3345
        },
        "resolved": true,
        "details": {
          "function_name": "prom_init_client_services",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2184-2200",
          "snippet": "static void __init prom_init_client_services(unsigned long pp)\n{\n\t/* Get a handle to the prom entry point before anything else */\n\tprom_entry = pp;\n\n\t/* get a handle for the stdout device */\n\tprom.chosen = call_prom(\"finddevice\", 1, 1, ADDR(\"/chosen\"));\n\tif (!PHANDLE_VALID(prom.chosen))\n\t\tprom_panic(\"cannot find chosen\"); /* msg won't be printed :( */\n\n\t/* get device tree root */\n\tprom.root = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(prom.root))\n\t\tprom_panic(\"cannot find device tree root\"); /* msg won't be printed :( */\n\n\tprom.mmumap = 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic void __init prom_init_client_services(unsigned long pp)\n{\n\t/* Get a handle to the prom entry point before anything else */\n\tprom_entry = pp;\n\n\t/* get a handle for the stdout device */\n\tprom.chosen = call_prom(\"finddevice\", 1, 1, ADDR(\"/chosen\"));\n\tif (!PHANDLE_VALID(prom.chosen))\n\t\tprom_panic(\"cannot find chosen\"); /* msg won't be printed :( */\n\n\t/* get device tree root */\n\tprom.root = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(prom.root))\n\t\tprom_panic(\"cannot find device tree root\"); /* msg won't be printed :( */\n\n\tprom.mmumap = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&__bss_start",
            "0",
            "__bss_stop - __bss_start"
          ],
          "line": 3339
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "122-147",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "reloc_got2",
          "args": [
            "offset"
          ],
          "line": 3331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reloc_offset",
          "args": [],
          "line": 3330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PLATFORM_POWERMAC\t0x0400\n#define PLATFORM_PSERIES_LPAR\t0x0101\n#define PLATFORM_PSERIES\t0x0100\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\nstatic struct prom_t __prombss prom;\nstatic unsigned long __prombss dt_header_start;\nstatic int __prombss of_platform;\nstatic unsigned long __prombss prom_memory_limit;\nstatic void __init;\n\nunsigned long __init prom_init(unsigned long r3, unsigned long r4,\n\t\t\t       unsigned long pp,\n\t\t\t       unsigned long r6, unsigned long r7,\n\t\t\t       unsigned long kbase)\n{\t\n\tunsigned long hdr;\n\n#ifdef CONFIG_PPC32\n\tunsigned long offset = reloc_offset();\n\treloc_got2(offset);\n#else\n\treloc_toc();\n#endif\n\n\t/*\n\t * First zero the BSS\n\t */\n\tmemset(&__bss_start, 0, __bss_stop - __bss_start);\n\n\t/*\n\t * Init interface to Open Firmware, get some node references,\n\t * like /chosen\n\t */\n\tprom_init_client_services(pp);\n\n\t/*\n\t * See if this OF is old enough that we need to do explicit maps\n\t * and other workarounds\n\t */\n\tprom_find_mmu();\n\n\t/*\n\t * Init prom stdout device\n\t */\n\tprom_init_stdout();\n\n\tprom_printf(\"Preparing to boot %s\", linux_banner);\n\n\t/*\n\t * Get default machine type. At this point, we do not differentiate\n\t * between pSeries SMP and pSeries LPAR\n\t */\n\tof_platform = prom_find_machine_type();\n\tprom_printf(\"Detected machine type: %x\\n\", of_platform);\n\n#ifndef CONFIG_NONSTATIC_KERNEL\n\t/* Bail if this is a kdump kernel. */\n\tif (PHYSICAL_START > 0)\n\t\tprom_panic(\"Error: You can't boot a kdump kernel from OF!\\n\");\n#endif\n\n\t/*\n\t * Check for an initrd\n\t */\n\tprom_check_initrd(r3, r4);\n\n\t/*\n\t * Do early parsing of command line\n\t */\n\tearly_cmdline_parse();\n\n#ifdef CONFIG_PPC_PSERIES\n\t/*\n\t * On pSeries, inform the firmware about our capabilities\n\t */\n\tif (of_platform == PLATFORM_PSERIES ||\n\t    of_platform == PLATFORM_PSERIES_LPAR)\n\t\tprom_send_capabilities();\n#endif\n\n\t/*\n\t * Copy the CPU hold code\n\t */\n\tif (of_platform != PLATFORM_POWERMAC)\n\t\tcopy_and_flush(0, kbase, 0x100, 0);\n\n\t/*\n\t * Initialize memory management within prom_init\n\t */\n\tprom_init_mem();\n\n\t/*\n\t * Determine which cpu is actually running right _now_\n\t */\n\tprom_find_boot_cpu();\n\n\t/* \n\t * Initialize display devices\n\t */\n\tprom_check_displays();\n\n#if defined(CONFIG_PPC64) && defined(__BIG_ENDIAN__)\n\t/*\n\t * Initialize IOMMU (TCE tables) on pSeries. Do that before anything else\n\t * that uses the allocator, we need to make sure we get the top of memory\n\t * available for us here...\n\t */\n\tif (of_platform == PLATFORM_PSERIES)\n\t\tprom_initialize_tce_table();\n#endif\n\n\t/*\n\t * On non-powermacs, try to instantiate RTAS. PowerMacs don't\n\t * have a usable RTAS implementation.\n\t */\n\tif (of_platform != PLATFORM_POWERMAC)\n\t\tprom_instantiate_rtas();\n\n#ifdef CONFIG_PPC64\n\t/* instantiate sml */\n\tprom_instantiate_sml();\n#endif\n\n\t/*\n\t * On non-powermacs, put all CPUs in spin-loops.\n\t *\n\t * PowerMacs use a different mechanism to spin CPUs\n\t *\n\t * (This must be done after instanciating RTAS)\n\t */\n\tif (of_platform != PLATFORM_POWERMAC)\n\t\tprom_hold_cpus();\n\n\t/*\n\t * Fill in some infos for use by the kernel later on\n\t */\n\tif (prom_memory_limit) {\n\t\t__be64 val = cpu_to_be64(prom_memory_limit);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,memory-limit\",\n\t\t\t     &val, sizeof(val));\n\t}\n#ifdef CONFIG_PPC64\n\tif (prom_iommu_off)\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,iommu-off\",\n\t\t\t     NULL, 0);\n\n\tif (prom_iommu_force_on)\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,iommu-force-on\",\n\t\t\t     NULL, 0);\n\n\tif (prom_tce_alloc_start) {\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,tce-alloc-start\",\n\t\t\t     &prom_tce_alloc_start,\n\t\t\t     sizeof(prom_tce_alloc_start));\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,tce-alloc-end\",\n\t\t\t     &prom_tce_alloc_end,\n\t\t\t     sizeof(prom_tce_alloc_end));\n\t}\n#endif\n\n\t/*\n\t * Fixup any known bugs in the device-tree\n\t */\n\tfixup_device_tree();\n\n\t/*\n\t * Now finally create the flattened device-tree\n\t */\n\tprom_printf(\"copying OF device tree...\\n\");\n\tflatten_device_tree();\n\n\t/*\n\t * in case stdin is USB and still active on IBM machines...\n\t * Unfortunately quiesce crashes on some powermacs if we have\n\t * closed stdin already (in particular the powerbook 101).\n\t */\n\tif (of_platform != PLATFORM_POWERMAC)\n\t\tprom_close_stdin();\n\n\t/*\n\t * Call OF \"quiesce\" method to shut down pending DMA's from\n\t * devices etc...\n\t */\n\tprom_printf(\"Quiescing Open Firmware ...\\n\");\n\tcall_prom(\"quiesce\", 0, 0);\n\n\t/*\n\t * And finally, call the kernel passing it the flattened device\n\t * tree and NULL as r5, thus triggering the new entry point which\n\t * is common to us and kexec\n\t */\n\thdr = dt_header_start;\n\n\tprom_printf(\"Booting Linux via __start() @ 0x%lx ...\\n\", kbase);\n\tprom_debug(\"->dt_header_start=0x%lx\\n\", hdr);\n\n#ifdef CONFIG_PPC32\n\treloc_got2(-offset);\n#else\n\tunreloc_toc();\n#endif\n\n\t/* Move to secure memory if we're supposed to be secure guests. */\n\tsetup_secure_guest(kbase, hdr);\n\n\t__start(hdr, kbase, 0, 0, 0, 0, 0);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "setup_secure_guest",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3312-3314",
    "snippet": "static void __init setup_secure_guest(unsigned long kbase, unsigned long fdt)\n{\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init setup_secure_guest(unsigned long kbase, unsigned long fdt)\n{\n}"
  },
  {
    "function_name": "setup_secure_guest",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3282-3310",
    "snippet": "static void __init setup_secure_guest(unsigned long kbase, unsigned long fdt)\n{\n\tint ret;\n\n\tif (!prom_svm_enable)\n\t\treturn;\n\n\t/* Switch to secure mode. */\n\tprom_printf(\"Switching to secure mode.\\n\");\n\n\t/*\n\t * The ultravisor will do an integrity check of the kernel image but we\n\t * relocated it so the check will fail. Restore the original image by\n\t * relocating it back to the kernel virtual base address.\n\t */\n\tif (IS_ENABLED(CONFIG_RELOCATABLE))\n\t\trelocate(KERNELBASE);\n\n\tret = enter_secure_mode(kbase, fdt);\n\n\t/* Relocate the kernel again. */\n\tif (IS_ENABLED(CONFIG_RELOCATABLE))\n\t\trelocate(kbase);\n\n\tif (ret != U_SUCCESS) {\n\t\tprom_printf(\"Returned %d from switching to secure mode.\\n\", ret);\n\t\tprom_rtas_os_term(\"Switch to secure mode failed.\\n\");\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_rtas_os_term",
          "args": [
            "\"Switch to secure mode failed.\\n\""
          ],
          "line": 3308
        },
        "resolved": true,
        "details": {
          "function_name": "prom_rtas_os_term",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1773-1796",
          "snippet": "static void __init prom_rtas_os_term(char *str)\n{\n\tphandle rtas_node;\n\t__be32 val;\n\tu32 token;\n\n\tprom_debug(\"%s: start...\\n\", __func__);\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"ibm,os-term\", &val, sizeof(val));\n\ttoken = be32_to_cpu(val);\n\tprom_debug(\"ibm,os-term: %x\\n\", token);\n\tif (token == 0)\n\t\tprom_panic(\"Could not get token for ibm,os-term\\n\");\n\tos_term_args.token = cpu_to_be32(token);\n\tos_term_args.nargs = cpu_to_be32(1);\n\tos_term_args.nret = cpu_to_be32(1);\n\tos_term_args.args[0] = cpu_to_be32(__pa(str));\n\tprom_rtas_hcall((uint64_t)&os_term_args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_rtas_os_term(char *str)\n{\n\tphandle rtas_node;\n\t__be32 val;\n\tu32 token;\n\n\tprom_debug(\"%s: start...\\n\", __func__);\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"ibm,os-term\", &val, sizeof(val));\n\ttoken = be32_to_cpu(val);\n\tprom_debug(\"ibm,os-term: %x\\n\", token);\n\tif (token == 0)\n\t\tprom_panic(\"Could not get token for ibm,os-term\\n\");\n\tos_term_args.token = cpu_to_be32(token);\n\tos_term_args.nargs = cpu_to_be32(1);\n\tos_term_args.nret = cpu_to_be32(1);\n\tos_term_args.args[0] = cpu_to_be32(__pa(str));\n\tprom_rtas_hcall((uint64_t)&os_term_args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Returned %d from switching to secure mode.\\n\"",
            "ret"
          ],
          "line": 3307
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "relocate",
          "args": [
            "kbase"
          ],
          "line": 3304
        },
        "resolved": true,
        "details": {
          "function_name": "fadump_relocate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/fadump.c",
          "lines": "1035-1058",
          "snippet": "static inline unsigned long fadump_relocate(unsigned long paddr)\n{\n\tunsigned long raddr, rstart, rend, rlast, hole_size;\n\tint i;\n\n\thole_size = 0;\n\trlast = 0;\n\traddr = paddr;\n\tfor (i = 0; i < fw_dump.boot_mem_regs_cnt; i++) {\n\t\trstart = fw_dump.boot_mem_addr[i];\n\t\trend = rstart + fw_dump.boot_mem_sz[i];\n\t\thole_size += (rstart - rlast);\n\n\t\tif (paddr >= rstart && paddr < rend) {\n\t\t\traddr += fw_dump.boot_mem_dest_addr - hole_size;\n\t\t\tbreak;\n\t\t}\n\n\t\trlast = rend;\n\t}\n\n\tpr_debug(\"vmcoreinfo: paddr = 0x%lx, raddr = 0x%lx\\n\", paddr, raddr);\n\treturn raddr;\n}",
          "includes": [
            "#include <asm/setup.h>",
            "#include <asm/fadump-internal.h>",
            "#include <asm/fadump.h>",
            "#include <asm/prom.h>",
            "#include <asm/page.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/cma.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/crash_dump.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/delay.h>",
            "#include <linux/memblock.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct fw_dump fw_dump;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/setup.h>\n#include <asm/fadump-internal.h>\n#include <asm/fadump.h>\n#include <asm/prom.h>\n#include <asm/page.h>\n#include <asm/debugfs.h>\n#include <linux/hugetlb.h>\n#include <linux/cma.h>\n#include <linux/slab.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/crash_dump.h>\n#include <linux/seq_file.h>\n#include <linux/delay.h>\n#include <linux/memblock.h>\n#include <linux/string.h>\n\nstatic struct fw_dump fw_dump;\n\nstatic inline unsigned long fadump_relocate(unsigned long paddr)\n{\n\tunsigned long raddr, rstart, rend, rlast, hole_size;\n\tint i;\n\n\thole_size = 0;\n\trlast = 0;\n\traddr = paddr;\n\tfor (i = 0; i < fw_dump.boot_mem_regs_cnt; i++) {\n\t\trstart = fw_dump.boot_mem_addr[i];\n\t\trend = rstart + fw_dump.boot_mem_sz[i];\n\t\thole_size += (rstart - rlast);\n\n\t\tif (paddr >= rstart && paddr < rend) {\n\t\t\traddr += fw_dump.boot_mem_dest_addr - hole_size;\n\t\t\tbreak;\n\t\t}\n\n\t\trlast = rend;\n\t}\n\n\tpr_debug(\"vmcoreinfo: paddr = 0x%lx, raddr = 0x%lx\\n\", paddr, raddr);\n\treturn raddr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_RELOCATABLE"
          ],
          "line": 3303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enter_secure_mode",
          "args": [
            "kbase",
            "fdt"
          ],
          "line": 3300
        },
        "resolved": true,
        "details": {
          "function_name": "enter_secure_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "3268-3277",
          "snippet": "static int enter_secure_mode(unsigned long kbase, unsigned long fdt)\n{\n\tregister unsigned long r3 asm(\"r3\") = UV_ESM;\n\tregister unsigned long r4 asm(\"r4\") = kbase;\n\tregister unsigned long r5 asm(\"r5\") = fdt;\n\n\tasm volatile(\"sc 2\" : \"+r\"(r3) : \"r\"(r4), \"r\"(r5));\n\n\treturn r3;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int enter_secure_mode(unsigned long kbase, unsigned long fdt)\n{\n\tregister unsigned long r3 asm(\"r3\") = UV_ESM;\n\tregister unsigned long r4 asm(\"r4\") = kbase;\n\tregister unsigned long r5 asm(\"r5\") = fdt;\n\n\tasm volatile(\"sc 2\" : \"+r\"(r3) : \"r\"(r4), \"r\"(r5));\n\n\treturn r3;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_RELOCATABLE"
          ],
          "line": 3297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init setup_secure_guest(unsigned long kbase, unsigned long fdt)\n{\n\tint ret;\n\n\tif (!prom_svm_enable)\n\t\treturn;\n\n\t/* Switch to secure mode. */\n\tprom_printf(\"Switching to secure mode.\\n\");\n\n\t/*\n\t * The ultravisor will do an integrity check of the kernel image but we\n\t * relocated it so the check will fail. Restore the original image by\n\t * relocating it back to the kernel virtual base address.\n\t */\n\tif (IS_ENABLED(CONFIG_RELOCATABLE))\n\t\trelocate(KERNELBASE);\n\n\tret = enter_secure_mode(kbase, fdt);\n\n\t/* Relocate the kernel again. */\n\tif (IS_ENABLED(CONFIG_RELOCATABLE))\n\t\trelocate(kbase);\n\n\tif (ret != U_SUCCESS) {\n\t\tprom_printf(\"Returned %d from switching to secure mode.\\n\", ret);\n\t\tprom_rtas_os_term(\"Switch to secure mode failed.\\n\");\n\t}\n}"
  },
  {
    "function_name": "enter_secure_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3268-3277",
    "snippet": "static int enter_secure_mode(unsigned long kbase, unsigned long fdt)\n{\n\tregister unsigned long r3 asm(\"r3\") = UV_ESM;\n\tregister unsigned long r4 asm(\"r4\") = kbase;\n\tregister unsigned long r5 asm(\"r5\") = fdt;\n\n\tasm volatile(\"sc 2\" : \"+r\"(r3) : \"r\"(r4), \"r\"(r5));\n\n\treturn r3;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int enter_secure_mode(unsigned long kbase, unsigned long fdt)\n{\n\tregister unsigned long r3 asm(\"r3\") = UV_ESM;\n\tregister unsigned long r4 asm(\"r4\") = kbase;\n\tregister unsigned long r5 asm(\"r5\") = fdt;\n\n\tasm volatile(\"sc 2\" : \"+r\"(r3) : \"r\"(r4), \"r\"(r5));\n\n\treturn r3;\n}"
  },
  {
    "function_name": "unreloc_toc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3251-3260",
    "snippet": "static void unreloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\tmb();\n\n\t__reloc_toc(-offset, nr_entries);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__reloc_toc",
          "args": [
            "-offset",
            "nr_entries"
          ],
          "line": 3259
        },
        "resolved": true,
        "details": {
          "function_name": "__reloc_toc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "3226-3238",
          "snippet": "static void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 3257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reloc_offset",
          "args": [],
          "line": 3253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void unreloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\tmb();\n\n\t__reloc_toc(-offset, nr_entries);\n}"
  },
  {
    "function_name": "reloc_toc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3240-3249",
    "snippet": "static void reloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\t__reloc_toc(offset, nr_entries);\n\n\tmb();\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 3248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__reloc_toc",
          "args": [
            "offset",
            "nr_entries"
          ],
          "line": 3246
        },
        "resolved": true,
        "details": {
          "function_name": "__reloc_toc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "3226-3238",
          "snippet": "static void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "reloc_offset",
          "args": [],
          "line": 3242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void reloc_toc(void)\n{\n\tunsigned long offset = reloc_offset();\n\tunsigned long nr_entries =\n\t\t(__prom_init_toc_end - __prom_init_toc_start) / sizeof(long);\n\n\t__reloc_toc(offset, nr_entries);\n\n\tmb();\n}"
  },
  {
    "function_name": "__reloc_toc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3226-3238",
    "snippet": "static void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\n\nstatic void __reloc_toc(unsigned long offset, unsigned long nr_entries)\n{\n\tunsigned long i;\n\tunsigned long *toc_entry;\n\n\t/* Get the start of the TOC by using r2 directly. */\n\tasm volatile(\"addi %0,2,-0x8000\" : \"=b\" (toc_entry));\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\t*toc_entry = *toc_entry + offset;\n\t\ttoc_entry++;\n\t}\n}"
  },
  {
    "function_name": "unreloc_toc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3222-3224",
    "snippet": "static void unreloc_toc(void)\n{\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void unreloc_toc(void)\n{\n}"
  },
  {
    "function_name": "reloc_toc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3218-3220",
    "snippet": "static void reloc_toc(void)\n{\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void reloc_toc(void)\n{\n}"
  },
  {
    "function_name": "prom_check_initrd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3191-3214",
    "snippet": "static void __init prom_check_initrd(unsigned long r3, unsigned long r4)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tif (r3 && r4 && r4 != 0xdeadbeef) {\n\t\t__be64 val;\n\n\t\tprom_initrd_start = is_kernel_addr(r3) ? __pa(r3) : r3;\n\t\tprom_initrd_end = prom_initrd_start + r4;\n\n\t\tval = cpu_to_be64(prom_initrd_start);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-start\",\n\t\t\t     &val, sizeof(val));\n\t\tval = cpu_to_be64(prom_initrd_end);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-end\",\n\t\t\t     &val, sizeof(val));\n\n\t\treserve_mem(prom_initrd_start,\n\t\t\t    prom_initrd_end - prom_initrd_start);\n\n\t\tprom_debug(\"initrd_start=0x%lx\\n\", prom_initrd_start);\n\t\tprom_debug(\"initrd_end=0x%lx\\n\", prom_initrd_end);\n\t}\n#endif /* CONFIG_BLK_DEV_INITRD */\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static unsigned long __prombss prom_initrd_start, prom_initrd_end;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"initrd_end=0x%lx\\n\"",
            "prom_initrd_end"
          ],
          "line": 3211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"initrd_start=0x%lx\\n\"",
            "prom_initrd_start"
          ],
          "line": 3210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_mem",
          "args": [
            "prom_initrd_start",
            "prom_initrd_end - prom_initrd_start"
          ],
          "line": 3207
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1593-1614",
          "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = ALIGN(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8"
          ],
          "globals_used": [
            "static struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];",
            "static int __prombss mem_reserve_cnt;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];\nstatic int __prombss mem_reserve_cnt;\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = ALIGN(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "prom.chosen",
            "\"/chosen\"",
            "\"linux,initrd-end\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 3204
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "prom_initrd_end"
          ],
          "line": 3203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "prom_initrd_start"
          ],
          "line": 3200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "r3"
          ],
          "line": 3197
        },
        "resolved": true,
        "details": {
          "function_name": "__parse_fpscr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/traps.c",
          "lines": "1164-1189",
          "snippet": "static inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/nmi.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/kprobes.h>",
            "#include <sysdev/fsl_pci.h>",
            "#include <asm/hmi.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rio.h>",
            "#include <asm/ppc-opcode.h>",
            "#include <asm/kexec.h>",
            "#include <asm/tm.h>",
            "#include <asm/processor.h>",
            "#include <asm/firmware.h>",
            "#include <asm/backlight.h>",
            "#include <asm/reg.h>",
            "#include <asm/pmc.h>",
            "#include <asm/rtas.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/emulated_ops.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/console.h>",
            "#include <linux/smp.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/bug.h>",
            "#include <linux/backlight.h>",
            "#include <linux/kexec.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/delay.h>",
            "#include <linux/prctl.h>",
            "#include <linux/module.h>\t/* print_modules */",
            "#include <linux/extable.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/user.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/nmi.h>\n#include <asm/stacktrace.h>\n#include <asm/kprobes.h>\n#include <sysdev/fsl_pci.h>\n#include <asm/hmi.h>\n#include <asm/asm-prototypes.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/fadump.h>\n#include <asm/rio.h>\n#include <asm/ppc-opcode.h>\n#include <asm/kexec.h>\n#include <asm/tm.h>\n#include <asm/processor.h>\n#include <asm/firmware.h>\n#include <asm/backlight.h>\n#include <asm/reg.h>\n#include <asm/pmc.h>\n#include <asm/rtas.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/uaccess.h>\n#include <asm/emulated_ops.h>\n#include <linux/kmsg_dump.h>\n#include <linux/console.h>\n#include <linux/smp.h>\n#include <linux/context_tracking.h>\n#include <linux/ratelimit.h>\n#include <linux/kdebug.h>\n#include <linux/bug.h>\n#include <linux/backlight.h>\n#include <linux/kexec.h>\n#include <linux/kprobes.h>\n#include <linux/delay.h>\n#include <linux/prctl.h>\n#include <linux/module.h>\t/* print_modules */\n#include <linux/extable.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/user.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/pkeys.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_kernel_addr",
          "args": [
            "r3"
          ],
          "line": 3197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic unsigned long __prombss prom_initrd_start, prom_initrd_end;\nstatic void __init;\n\nstatic void __init prom_check_initrd(unsigned long r3, unsigned long r4)\n{\n#ifdef CONFIG_BLK_DEV_INITRD\n\tif (r3 && r4 && r4 != 0xdeadbeef) {\n\t\t__be64 val;\n\n\t\tprom_initrd_start = is_kernel_addr(r3) ? __pa(r3) : r3;\n\t\tprom_initrd_end = prom_initrd_start + r4;\n\n\t\tval = cpu_to_be64(prom_initrd_start);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-start\",\n\t\t\t     &val, sizeof(val));\n\t\tval = cpu_to_be64(prom_initrd_end);\n\t\tprom_setprop(prom.chosen, \"/chosen\", \"linux,initrd-end\",\n\t\t\t     &val, sizeof(val));\n\n\t\treserve_mem(prom_initrd_start,\n\t\t\t    prom_initrd_end - prom_initrd_start);\n\n\t\tprom_debug(\"initrd_start=0x%lx\\n\", prom_initrd_start);\n\t\tprom_debug(\"initrd_end=0x%lx\\n\", prom_initrd_end);\n\t}\n#endif /* CONFIG_BLK_DEV_INITRD */\n}"
  },
  {
    "function_name": "prom_find_boot_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3169-3189",
    "snippet": "static void __init prom_find_boot_cpu(void)\n{\n\t__be32 rval;\n\tihandle prom_cpu;\n\tphandle cpu_pkg;\n\n\trval = 0;\n\tif (prom_getprop(prom.chosen, \"cpu\", &rval, sizeof(rval)) <= 0)\n\t\treturn;\n\tprom_cpu = be32_to_cpu(rval);\n\n\tcpu_pkg = call_prom(\"instance-to-package\", 1, 1, prom_cpu);\n\n\tif (!PHANDLE_VALID(cpu_pkg))\n\t\treturn;\n\n\tprom_getprop(cpu_pkg, \"reg\", &rval, sizeof(rval));\n\tprom.cpu = be32_to_cpu(rval);\n\n\tprom_debug(\"Booting CPU hw index = %d\\n\", prom.cpu);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Booting CPU hw index = %d\\n\"",
            "prom.cpu"
          ],
          "line": 3188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "rval"
          ],
          "line": 3186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "cpu_pkg",
            "\"reg\"",
            "&rval",
            "sizeof(rval)"
          ],
          "line": 3185
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "cpu_pkg"
          ],
          "line": 3182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"instance-to-package\"",
            "1",
            "1",
            "prom_cpu"
          ],
          "line": 3180
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "rval"
          ],
          "line": 3178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_find_boot_cpu(void)\n{\n\t__be32 rval;\n\tihandle prom_cpu;\n\tphandle cpu_pkg;\n\n\trval = 0;\n\tif (prom_getprop(prom.chosen, \"cpu\", &rval, sizeof(rval)) <= 0)\n\t\treturn;\n\tprom_cpu = be32_to_cpu(rval);\n\n\tcpu_pkg = call_prom(\"instance-to-package\", 1, 1, prom_cpu);\n\n\tif (!PHANDLE_VALID(cpu_pkg))\n\t\treturn;\n\n\tprom_getprop(cpu_pkg, \"reg\", &rval, sizeof(rval));\n\tprom.cpu = be32_to_cpu(rval);\n\n\tprom_debug(\"Booting CPU hw index = %d\\n\", prom.cpu);\n}"
  },
  {
    "function_name": "fixup_device_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3159-3167",
    "snippet": "static void __init fixup_device_tree(void)\n{\n\tfixup_device_tree_maple();\n\tfixup_device_tree_maple_memory_controller();\n\tfixup_device_tree_chrp();\n\tfixup_device_tree_pmac();\n\tfixup_device_tree_efika();\n\tfixup_device_tree_pasemi();\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fixup_device_tree_pasemi",
          "args": [],
          "line": 3166
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_pasemi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "3156-3156",
          "snippet": "static inline void fixup_device_tree_pasemi(void) { }",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic inline void fixup_device_tree_pasemi(void) { }"
        }
      },
      {
        "call_info": {
          "callee": "fixup_device_tree_efika",
          "args": [],
          "line": 3165
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_efika",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "3012-3074",
          "snippet": "static void __init fixup_device_tree_efika(void)\n{\n\tint sound_irq[3] = { 2, 2, 0 };\n\tint bcomm_irq[3*16] = { 3,0,0, 3,1,0, 3,2,0, 3,3,0,\n\t\t\t\t3,4,0, 3,5,0, 3,6,0, 3,7,0,\n\t\t\t\t3,8,0, 3,9,0, 3,10,0, 3,11,0,\n\t\t\t\t3,12,0, 3,13,0, 3,14,0, 3,15,0 };\n\tu32 node;\n\tchar prop[64];\n\tint rv, len;\n\n\t/* Check if we're really running on a EFIKA */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\trv = prom_getprop(node, \"model\", prop, sizeof(prop));\n\tif (rv == PROM_ERROR)\n\t\treturn;\n\tif (prom_strcmp(prop, \"EFIKA5K2\"))\n\t\treturn;\n\n\tprom_printf(\"Applying EFIKA device tree fixups\\n\");\n\n\t/* Claiming to be 'chrp' is death */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\trv = prom_getprop(node, \"device_type\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (prom_strcmp(prop, \"chrp\") == 0))\n\t\tprom_setprop(node, \"/\", \"device_type\", \"efika\", sizeof(\"efika\"));\n\n\t/* CODEGEN,description is exposed in /proc/cpuinfo so\n\t   fix that too */\n\trv = prom_getprop(node, \"CODEGEN,description\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (prom_strstr(prop, \"CHRP\")))\n\t\tprom_setprop(node, \"/\", \"CODEGEN,description\",\n\t\t\t     \"Efika 5200B PowerPC System\",\n\t\t\t     sizeof(\"Efika 5200B PowerPC System\"));\n\n\t/* Fixup bestcomm interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/bestcomm\"));\n\tif (PHANDLE_VALID(node)) {\n\t\tlen = prom_getproplen(node, \"interrupts\");\n\t\tif (len == 12) {\n\t\t\tprom_printf(\"Fixing bestcomm interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/bestcom\", \"interrupts\",\n\t\t\t\t     bcomm_irq, sizeof(bcomm_irq));\n\t\t}\n\t}\n\n\t/* Fixup sound interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/sound\"));\n\tif (PHANDLE_VALID(node)) {\n\t\trv = prom_getprop(node, \"interrupts\", prop, sizeof(prop));\n\t\tif (rv == PROM_ERROR) {\n\t\t\tprom_printf(\"Adding sound interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/sound\", \"interrupts\",\n\t\t\t\t     sound_irq, sizeof(sound_irq));\n\t\t}\n\t}\n\n\t/* Make sure ethernet phy-handle property exists */\n\tfixup_device_tree_efika_add_phy();\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_efika(void)\n{\n\tint sound_irq[3] = { 2, 2, 0 };\n\tint bcomm_irq[3*16] = { 3,0,0, 3,1,0, 3,2,0, 3,3,0,\n\t\t\t\t3,4,0, 3,5,0, 3,6,0, 3,7,0,\n\t\t\t\t3,8,0, 3,9,0, 3,10,0, 3,11,0,\n\t\t\t\t3,12,0, 3,13,0, 3,14,0, 3,15,0 };\n\tu32 node;\n\tchar prop[64];\n\tint rv, len;\n\n\t/* Check if we're really running on a EFIKA */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\trv = prom_getprop(node, \"model\", prop, sizeof(prop));\n\tif (rv == PROM_ERROR)\n\t\treturn;\n\tif (prom_strcmp(prop, \"EFIKA5K2\"))\n\t\treturn;\n\n\tprom_printf(\"Applying EFIKA device tree fixups\\n\");\n\n\t/* Claiming to be 'chrp' is death */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\trv = prom_getprop(node, \"device_type\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (prom_strcmp(prop, \"chrp\") == 0))\n\t\tprom_setprop(node, \"/\", \"device_type\", \"efika\", sizeof(\"efika\"));\n\n\t/* CODEGEN,description is exposed in /proc/cpuinfo so\n\t   fix that too */\n\trv = prom_getprop(node, \"CODEGEN,description\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (prom_strstr(prop, \"CHRP\")))\n\t\tprom_setprop(node, \"/\", \"CODEGEN,description\",\n\t\t\t     \"Efika 5200B PowerPC System\",\n\t\t\t     sizeof(\"Efika 5200B PowerPC System\"));\n\n\t/* Fixup bestcomm interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/bestcomm\"));\n\tif (PHANDLE_VALID(node)) {\n\t\tlen = prom_getproplen(node, \"interrupts\");\n\t\tif (len == 12) {\n\t\t\tprom_printf(\"Fixing bestcomm interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/bestcom\", \"interrupts\",\n\t\t\t\t     bcomm_irq, sizeof(bcomm_irq));\n\t\t}\n\t}\n\n\t/* Fixup sound interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/sound\"));\n\tif (PHANDLE_VALID(node)) {\n\t\trv = prom_getprop(node, \"interrupts\", prop, sizeof(prop));\n\t\tif (rv == PROM_ERROR) {\n\t\t\tprom_printf(\"Adding sound interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/sound\", \"interrupts\",\n\t\t\t\t     sound_irq, sizeof(sound_irq));\n\t\t}\n\t}\n\n\t/* Make sure ethernet phy-handle property exists */\n\tfixup_device_tree_efika_add_phy();\n}"
        }
      },
      {
        "call_info": {
          "callee": "fixup_device_tree_pmac",
          "args": [],
          "line": 3164
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_pmac",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2900-2938",
          "snippet": "static void __init fixup_device_tree_pmac(void)\n{\n\tphandle u3, i2c, mpic;\n\tu32 u3_rev;\n\tu32 interrupts[2];\n\tu32 parent;\n\n\t/* Some G5s have a missing interrupt definition, fix it up here */\n\tu3 = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000\"));\n\tif (!PHANDLE_VALID(u3))\n\t\treturn;\n\ti2c = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/i2c@f8001000\"));\n\tif (!PHANDLE_VALID(i2c))\n\t\treturn;\n\tmpic = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/mpic@f8040000\"));\n\tif (!PHANDLE_VALID(mpic))\n\t\treturn;\n\n\t/* check if proper rev of u3 */\n\tif (prom_getprop(u3, \"device-rev\", &u3_rev, sizeof(u3_rev))\n\t    == PROM_ERROR)\n\t\treturn;\n\tif (u3_rev < 0x35 || u3_rev > 0x39)\n\t\treturn;\n\t/* does it need fixup ? */\n\tif (prom_getproplen(i2c, \"interrupts\") > 0)\n\t\treturn;\n\n\tprom_printf(\"fixing up bogus interrupts for u3 i2c...\\n\");\n\n\t/* interrupt on this revision of u3 is number 0 and level */\n\tinterrupts[0] = 0;\n\tinterrupts[1] = 1;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupts\",\n\t\t     &interrupts, sizeof(interrupts));\n\tparent = (u32)mpic;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupt-parent\",\n\t\t     &parent, sizeof(parent));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_pmac(void)\n{\n\tphandle u3, i2c, mpic;\n\tu32 u3_rev;\n\tu32 interrupts[2];\n\tu32 parent;\n\n\t/* Some G5s have a missing interrupt definition, fix it up here */\n\tu3 = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000\"));\n\tif (!PHANDLE_VALID(u3))\n\t\treturn;\n\ti2c = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/i2c@f8001000\"));\n\tif (!PHANDLE_VALID(i2c))\n\t\treturn;\n\tmpic = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/mpic@f8040000\"));\n\tif (!PHANDLE_VALID(mpic))\n\t\treturn;\n\n\t/* check if proper rev of u3 */\n\tif (prom_getprop(u3, \"device-rev\", &u3_rev, sizeof(u3_rev))\n\t    == PROM_ERROR)\n\t\treturn;\n\tif (u3_rev < 0x35 || u3_rev > 0x39)\n\t\treturn;\n\t/* does it need fixup ? */\n\tif (prom_getproplen(i2c, \"interrupts\") > 0)\n\t\treturn;\n\n\tprom_printf(\"fixing up bogus interrupts for u3 i2c...\\n\");\n\n\t/* interrupt on this revision of u3 is number 0 and level */\n\tinterrupts[0] = 0;\n\tinterrupts[1] = 1;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupts\",\n\t\t     &interrupts, sizeof(interrupts));\n\tparent = (u32)mpic;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupt-parent\",\n\t\t     &parent, sizeof(parent));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fixup_device_tree_chrp",
          "args": [],
          "line": 3163
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_chrp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2850-2894",
          "snippet": "static void __init fixup_device_tree_chrp(void)\n{\n\tphandle ph;\n\tu32 prop[6];\n\tu32 rloc = 0x01006000; /* IO space; PCI device = 12 */\n\tchar *name;\n\tint rc;\n\n\tname = \"/pci@80000000/isa@c\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(ph)) {\n\t\tname = \"/pci@ff500000/isa@6\";\n\t\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (PHANDLE_VALID(ph)) {\n\t\trc = prom_getproplen(ph, \"ranges\");\n\t\tif (rc == 0 || rc == PROM_ERROR) {\n\t\t\tprom_printf(\"Fixing up missing ISA range on Pegasos...\\n\");\n\n\t\t\tprop[0] = 0x1;\n\t\t\tprop[1] = 0x0;\n\t\t\tprop[2] = rloc;\n\t\t\tprop[3] = 0x0;\n\t\t\tprop[4] = 0x0;\n\t\t\tprop[5] = 0x00010000;\n\t\t\tprom_setprop(ph, name, \"ranges\", prop, sizeof(prop));\n\t\t}\n\t}\n\n\tname = \"/pci@80000000/ide@C,1\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (PHANDLE_VALID(ph)) {\n\t\tprom_printf(\"Fixing up IDE interrupt on Pegasos...\\n\");\n\t\tprop[0] = 14;\n\t\tprop[1] = 0x0;\n\t\tprom_setprop(ph, name, \"interrupts\", prop, 2*sizeof(u32));\n\t\tprom_printf(\"Fixing up IDE class-code on Pegasos...\\n\");\n\t\trc = prom_getprop(ph, \"class-code\", prop, sizeof(u32));\n\t\tif (rc == sizeof(u32)) {\n\t\t\tprop[0] &= ~0x5;\n\t\t\tprom_setprop(ph, name, \"class-code\", prop, sizeof(u32));\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_chrp(void)\n{\n\tphandle ph;\n\tu32 prop[6];\n\tu32 rloc = 0x01006000; /* IO space; PCI device = 12 */\n\tchar *name;\n\tint rc;\n\n\tname = \"/pci@80000000/isa@c\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(ph)) {\n\t\tname = \"/pci@ff500000/isa@6\";\n\t\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (PHANDLE_VALID(ph)) {\n\t\trc = prom_getproplen(ph, \"ranges\");\n\t\tif (rc == 0 || rc == PROM_ERROR) {\n\t\t\tprom_printf(\"Fixing up missing ISA range on Pegasos...\\n\");\n\n\t\t\tprop[0] = 0x1;\n\t\t\tprop[1] = 0x0;\n\t\t\tprop[2] = rloc;\n\t\t\tprop[3] = 0x0;\n\t\t\tprop[4] = 0x0;\n\t\t\tprop[5] = 0x00010000;\n\t\t\tprom_setprop(ph, name, \"ranges\", prop, sizeof(prop));\n\t\t}\n\t}\n\n\tname = \"/pci@80000000/ide@C,1\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (PHANDLE_VALID(ph)) {\n\t\tprom_printf(\"Fixing up IDE interrupt on Pegasos...\\n\");\n\t\tprop[0] = 14;\n\t\tprop[1] = 0x0;\n\t\tprom_setprop(ph, name, \"interrupts\", prop, 2*sizeof(u32));\n\t\tprom_printf(\"Fixing up IDE class-code on Pegasos...\\n\");\n\t\trc = prom_getprop(ph, \"class-code\", prop, sizeof(u32));\n\t\tif (rc == sizeof(u32)) {\n\t\t\tprop[0] &= ~0x5;\n\t\t\tprom_setprop(ph, name, \"class-code\", prop, sizeof(u32));\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fixup_device_tree_maple_memory_controller",
          "args": [],
          "line": 3162
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_maple_memory_controller",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2806-2838",
          "snippet": "static void __init fixup_device_tree_maple_memory_controller(void)\n{\n\tphandle mc;\n\tu32 mc_reg[4];\n\tchar *name = \"/hostbridge@f8000000\";\n\tu32 ac, sc;\n\n\tmc = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(mc))\n\t\treturn;\n\n\tif (prom_getproplen(mc, \"reg\") != 8)\n\t\treturn;\n\n\tprom_getprop(prom.root, \"#address-cells\", &ac, sizeof(ac));\n\tprom_getprop(prom.root, \"#size-cells\", &sc, sizeof(sc));\n\tif ((ac != 2) || (sc != 2))\n\t\treturn;\n\n\tif (prom_getprop(mc, \"reg\", mc_reg, sizeof(mc_reg)) == PROM_ERROR)\n\t\treturn;\n\n\tif (mc_reg[0] != CPC925_MC_START || mc_reg[1] != CPC925_MC_LENGTH)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus hostbridge on Maple...\\n\");\n\n\tmc_reg[0] = 0x0;\n\tmc_reg[1] = CPC925_MC_START;\n\tmc_reg[2] = 0x0;\n\tmc_reg[3] = CPC925_MC_LENGTH;\n\tprom_setprop(mc, name, \"reg\", mc_reg, sizeof(mc_reg));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define CPC925_MC_LENGTH\t0x1000000",
            "#define CPC925_MC_START\t\t0xf8000000",
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define CPC925_MC_LENGTH\t0x1000000\n#define CPC925_MC_START\t\t0xf8000000\n#define PROM_ERROR\t\t(-1u)\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init fixup_device_tree_maple_memory_controller(void)\n{\n\tphandle mc;\n\tu32 mc_reg[4];\n\tchar *name = \"/hostbridge@f8000000\";\n\tu32 ac, sc;\n\n\tmc = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(mc))\n\t\treturn;\n\n\tif (prom_getproplen(mc, \"reg\") != 8)\n\t\treturn;\n\n\tprom_getprop(prom.root, \"#address-cells\", &ac, sizeof(ac));\n\tprom_getprop(prom.root, \"#size-cells\", &sc, sizeof(sc));\n\tif ((ac != 2) || (sc != 2))\n\t\treturn;\n\n\tif (prom_getprop(mc, \"reg\", mc_reg, sizeof(mc_reg)) == PROM_ERROR)\n\t\treturn;\n\n\tif (mc_reg[0] != CPC925_MC_START || mc_reg[1] != CPC925_MC_LENGTH)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus hostbridge on Maple...\\n\");\n\n\tmc_reg[0] = 0x0;\n\tmc_reg[1] = CPC925_MC_START;\n\tmc_reg[2] = 0x0;\n\tmc_reg[3] = CPC925_MC_LENGTH;\n\tprom_setprop(mc, name, \"reg\", mc_reg, sizeof(mc_reg));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init fixup_device_tree(void)\n{\n\tfixup_device_tree_maple();\n\tfixup_device_tree_maple_memory_controller();\n\tfixup_device_tree_chrp();\n\tfixup_device_tree_pmac();\n\tfixup_device_tree_efika();\n\tfixup_device_tree_pasemi();\n}"
  },
  {
    "function_name": "fixup_device_tree_pasemi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3156-3156",
    "snippet": "static inline void fixup_device_tree_pasemi(void) { }",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic inline void fixup_device_tree_pasemi(void) { }"
  },
  {
    "function_name": "fixup_device_tree_pasemi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3086-3154",
    "snippet": "static void __init fixup_device_tree_pasemi(void)\n{\n\tu32 interrupts[2], parent, rval, val = 0;\n\tchar *name, *pci_name;\n\tphandle iob, node;\n\n\t/* Find the root pci node */\n\tname = \"/pxp@0,e0000000\";\n\tiob = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(iob))\n\t\treturn;\n\n\t/* check if interrupt-controller node set yet */\n\tif (prom_getproplen(iob, \"interrupt-controller\") !=PROM_ERROR)\n\t\treturn;\n\n\tprom_printf(\"adding interrupt-controller property for SB600...\\n\");\n\n\tprom_setprop(iob, name, \"interrupt-controller\", &val, 0);\n\n\tpci_name = \"/pxp@0,e0000000/pci@11\";\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(pci_name));\n\tparent = ADDR(iob);\n\n\tfor( ; prom_next_node(&node); ) {\n\t\t/* scan each node for one with an interrupt */\n\t\tif (!PHANDLE_VALID(node))\n\t\t\tcontinue;\n\n\t\trval = prom_getproplen(node, \"interrupts\");\n\t\tif (rval == 0 || rval == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\tprom_getprop(node, \"interrupts\", &interrupts, sizeof(interrupts));\n\t\tif ((interrupts[0] < 212) || (interrupts[0] > 222))\n\t\t\tcontinue;\n\n\t\t/* found a node, update both interrupts and interrupt-parent */\n\t\tif ((interrupts[0] >= 212) && (interrupts[0] <= 215))\n\t\t\tinterrupts[0] -= 203;\n\t\tif ((interrupts[0] >= 216) && (interrupts[0] <= 220))\n\t\t\tinterrupts[0] -= 213;\n\t\tif (interrupts[0] == 221)\n\t\t\tinterrupts[0] = 14;\n\t\tif (interrupts[0] == 222)\n\t\t\tinterrupts[0] = 8;\n\n\t\tprom_setprop(node, pci_name, \"interrupts\", interrupts,\n\t\t\t\t\tsizeof(interrupts));\n\t\tprom_setprop(node, pci_name, \"interrupt-parent\", &parent,\n\t\t\t\t\tsizeof(parent));\n\t}\n\n\t/*\n\t * The io-bridge has device_type set to 'io-bridge' change it to 'isa'\n\t * so that generic isa-bridge code can add the SB600 and its on-board\n\t * peripherals.\n\t */\n\tname = \"/pxp@0,e0000000/io-bridge@0\";\n\tiob = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(iob))\n\t\treturn;\n\n\t/* device_type is already set, just change it. */\n\n\tprom_printf(\"Changing device_type of SB600 node...\\n\");\n\n\tprom_setprop(iob, name, \"device_type\", \"isa\", sizeof(\"isa\"));\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "iob",
            "name",
            "\"device_type\"",
            "\"isa\"",
            "sizeof(\"isa\")"
          ],
          "line": 3153
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Changing device_type of SB600 node...\\n\""
          ],
          "line": 3151
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "iob"
          ],
          "line": 3146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(name)"
          ],
          "line": 3145
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 3145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"interrupts\"",
            "&interrupts",
            "sizeof(interrupts)"
          ],
          "line": 3119
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "node",
            "\"interrupts\""
          ],
          "line": 3115
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "649-652",
          "snippet": "static inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 3112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 3110
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "625-640",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "iob"
          ],
          "line": 3108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "pci_name"
          ],
          "line": 3107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "iob"
          ],
          "line": 3095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 3094
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_pasemi(void)\n{\n\tu32 interrupts[2], parent, rval, val = 0;\n\tchar *name, *pci_name;\n\tphandle iob, node;\n\n\t/* Find the root pci node */\n\tname = \"/pxp@0,e0000000\";\n\tiob = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(iob))\n\t\treturn;\n\n\t/* check if interrupt-controller node set yet */\n\tif (prom_getproplen(iob, \"interrupt-controller\") !=PROM_ERROR)\n\t\treturn;\n\n\tprom_printf(\"adding interrupt-controller property for SB600...\\n\");\n\n\tprom_setprop(iob, name, \"interrupt-controller\", &val, 0);\n\n\tpci_name = \"/pxp@0,e0000000/pci@11\";\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(pci_name));\n\tparent = ADDR(iob);\n\n\tfor( ; prom_next_node(&node); ) {\n\t\t/* scan each node for one with an interrupt */\n\t\tif (!PHANDLE_VALID(node))\n\t\t\tcontinue;\n\n\t\trval = prom_getproplen(node, \"interrupts\");\n\t\tif (rval == 0 || rval == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\tprom_getprop(node, \"interrupts\", &interrupts, sizeof(interrupts));\n\t\tif ((interrupts[0] < 212) || (interrupts[0] > 222))\n\t\t\tcontinue;\n\n\t\t/* found a node, update both interrupts and interrupt-parent */\n\t\tif ((interrupts[0] >= 212) && (interrupts[0] <= 215))\n\t\t\tinterrupts[0] -= 203;\n\t\tif ((interrupts[0] >= 216) && (interrupts[0] <= 220))\n\t\t\tinterrupts[0] -= 213;\n\t\tif (interrupts[0] == 221)\n\t\t\tinterrupts[0] = 14;\n\t\tif (interrupts[0] == 222)\n\t\t\tinterrupts[0] = 8;\n\n\t\tprom_setprop(node, pci_name, \"interrupts\", interrupts,\n\t\t\t\t\tsizeof(interrupts));\n\t\tprom_setprop(node, pci_name, \"interrupt-parent\", &parent,\n\t\t\t\t\tsizeof(parent));\n\t}\n\n\t/*\n\t * The io-bridge has device_type set to 'io-bridge' change it to 'isa'\n\t * so that generic isa-bridge code can add the SB600 and its on-board\n\t * peripherals.\n\t */\n\tname = \"/pxp@0,e0000000/io-bridge@0\";\n\tiob = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(iob))\n\t\treturn;\n\n\t/* device_type is already set, just change it. */\n\n\tprom_printf(\"Changing device_type of SB600 node...\\n\");\n\n\tprom_setprop(iob, name, \"device_type\", \"isa\", sizeof(\"isa\"));\n}"
  },
  {
    "function_name": "fixup_device_tree_efika",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "3012-3074",
    "snippet": "static void __init fixup_device_tree_efika(void)\n{\n\tint sound_irq[3] = { 2, 2, 0 };\n\tint bcomm_irq[3*16] = { 3,0,0, 3,1,0, 3,2,0, 3,3,0,\n\t\t\t\t3,4,0, 3,5,0, 3,6,0, 3,7,0,\n\t\t\t\t3,8,0, 3,9,0, 3,10,0, 3,11,0,\n\t\t\t\t3,12,0, 3,13,0, 3,14,0, 3,15,0 };\n\tu32 node;\n\tchar prop[64];\n\tint rv, len;\n\n\t/* Check if we're really running on a EFIKA */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\trv = prom_getprop(node, \"model\", prop, sizeof(prop));\n\tif (rv == PROM_ERROR)\n\t\treturn;\n\tif (prom_strcmp(prop, \"EFIKA5K2\"))\n\t\treturn;\n\n\tprom_printf(\"Applying EFIKA device tree fixups\\n\");\n\n\t/* Claiming to be 'chrp' is death */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\trv = prom_getprop(node, \"device_type\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (prom_strcmp(prop, \"chrp\") == 0))\n\t\tprom_setprop(node, \"/\", \"device_type\", \"efika\", sizeof(\"efika\"));\n\n\t/* CODEGEN,description is exposed in /proc/cpuinfo so\n\t   fix that too */\n\trv = prom_getprop(node, \"CODEGEN,description\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (prom_strstr(prop, \"CHRP\")))\n\t\tprom_setprop(node, \"/\", \"CODEGEN,description\",\n\t\t\t     \"Efika 5200B PowerPC System\",\n\t\t\t     sizeof(\"Efika 5200B PowerPC System\"));\n\n\t/* Fixup bestcomm interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/bestcomm\"));\n\tif (PHANDLE_VALID(node)) {\n\t\tlen = prom_getproplen(node, \"interrupts\");\n\t\tif (len == 12) {\n\t\t\tprom_printf(\"Fixing bestcomm interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/bestcom\", \"interrupts\",\n\t\t\t\t     bcomm_irq, sizeof(bcomm_irq));\n\t\t}\n\t}\n\n\t/* Fixup sound interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/sound\"));\n\tif (PHANDLE_VALID(node)) {\n\t\trv = prom_getprop(node, \"interrupts\", prop, sizeof(prop));\n\t\tif (rv == PROM_ERROR) {\n\t\t\tprom_printf(\"Adding sound interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/sound\", \"interrupts\",\n\t\t\t\t     sound_irq, sizeof(sound_irq));\n\t\t}\n\t}\n\n\t/* Make sure ethernet phy-handle property exists */\n\tfixup_device_tree_efika_add_phy();\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fixup_device_tree_efika_add_phy",
          "args": [],
          "line": 3073
        },
        "resolved": true,
        "details": {
          "function_name": "fixup_device_tree_efika_add_phy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2950-3010",
          "snippet": "static void __init fixup_device_tree_efika_add_phy(void)\n{\n\tu32 node;\n\tchar prop[64];\n\tint rv;\n\n\t/* Check if /builtin/ethernet exists - bail if it doesn't */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/ethernet\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\t/* Check if the phy-handle property exists - bail if it does */\n\trv = prom_getprop(node, \"phy-handle\", prop, sizeof(prop));\n\tif (!rv)\n\t\treturn;\n\n\t/*\n\t * At this point the ethernet device doesn't have a phy described.\n\t * Now we need to add the missing phy node and linkage\n\t */\n\n\t/* Check for an MDIO bus node - if missing then create one */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/mdio\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet MDIO node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" 1 encode-int s\\\" #address-cells\\\" property\"\n\t\t\t\t\" 0 encode-int s\\\" #size-cells\\\" property\"\n\t\t\t\t\" s\\\" mdio\\\" device-name\"\n\t\t\t\t\" s\\\" fsl,mpc5200b-mdio\\\" encode-string\"\n\t\t\t\t\" s\\\" compatible\\\" property\"\n\t\t\t\t\" 0xf0003000 0x400 reg\"\n\t\t\t\t\" 0x2 encode-int\"\n\t\t\t\t\" 0x5 encode-int encode+\"\n\t\t\t\t\" 0x3 encode-int encode+\"\n\t\t\t\t\" s\\\" interrupts\\\" property\"\n\t\t\t\" finish-device\");\n\t};\n\n\t/* Check for a PHY device node - if missing then create one and\n\t * give it's phandle to the ethernet node */\n\tnode = call_prom(\"finddevice\", 1, 1,\n\t\t\t ADDR(\"/builtin/mdio/ethernet-phy\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet PHY node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin/mdio\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" s\\\" ethernet-phy\\\" device-name\"\n\t\t\t\t\" 0x10 encode-int s\\\" reg\\\" property\"\n\t\t\t\t\" my-self\"\n\t\t\t\t\" ihandle>phandle\"\n\t\t\t\" finish-device\"\n\t\t\t\" s\\\" /builtin/ethernet\\\" find-device\"\n\t\t\t\t\" encode-int\"\n\t\t\t\t\" s\\\" phy-handle\\\" property\"\n\t\t\t\" device-end\");\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_efika_add_phy(void)\n{\n\tu32 node;\n\tchar prop[64];\n\tint rv;\n\n\t/* Check if /builtin/ethernet exists - bail if it doesn't */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/ethernet\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\t/* Check if the phy-handle property exists - bail if it does */\n\trv = prom_getprop(node, \"phy-handle\", prop, sizeof(prop));\n\tif (!rv)\n\t\treturn;\n\n\t/*\n\t * At this point the ethernet device doesn't have a phy described.\n\t * Now we need to add the missing phy node and linkage\n\t */\n\n\t/* Check for an MDIO bus node - if missing then create one */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/mdio\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet MDIO node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" 1 encode-int s\\\" #address-cells\\\" property\"\n\t\t\t\t\" 0 encode-int s\\\" #size-cells\\\" property\"\n\t\t\t\t\" s\\\" mdio\\\" device-name\"\n\t\t\t\t\" s\\\" fsl,mpc5200b-mdio\\\" encode-string\"\n\t\t\t\t\" s\\\" compatible\\\" property\"\n\t\t\t\t\" 0xf0003000 0x400 reg\"\n\t\t\t\t\" 0x2 encode-int\"\n\t\t\t\t\" 0x5 encode-int encode+\"\n\t\t\t\t\" 0x3 encode-int encode+\"\n\t\t\t\t\" s\\\" interrupts\\\" property\"\n\t\t\t\" finish-device\");\n\t};\n\n\t/* Check for a PHY device node - if missing then create one and\n\t * give it's phandle to the ethernet node */\n\tnode = call_prom(\"finddevice\", 1, 1,\n\t\t\t ADDR(\"/builtin/mdio/ethernet-phy\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet PHY node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin/mdio\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" s\\\" ethernet-phy\\\" device-name\"\n\t\t\t\t\" 0x10 encode-int s\\\" reg\\\" property\"\n\t\t\t\t\" my-self\"\n\t\t\t\t\" ihandle>phandle\"\n\t\t\t\" finish-device\"\n\t\t\t\" s\\\" /builtin/ethernet\\\" find-device\"\n\t\t\t\t\" encode-int\"\n\t\t\t\t\" s\\\" phy-handle\\\" property\"\n\t\t\t\" device-end\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "node",
            "\"/builtin/sound\"",
            "\"interrupts\"",
            "sound_irq",
            "sizeof(sound_irq)"
          ],
          "line": 3067
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Adding sound interrupts property\\n\""
          ],
          "line": 3066
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"interrupts\"",
            "prop",
            "sizeof(prop)"
          ],
          "line": 3064
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 3063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(\"/builtin/sound\")"
          ],
          "line": 3062
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/builtin/sound\""
          ],
          "line": 3062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "node",
            "\"interrupts\""
          ],
          "line": 3053
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "649-652",
          "snippet": "static inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 3052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/builtin/bestcomm\""
          ],
          "line": 3051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_strstr",
          "args": [
            "prop",
            "\"CHRP\""
          ],
          "line": 3045
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "290-305",
          "snippet": "static char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "prop",
            "\"chrp\""
          ],
          "line": 3039
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/\""
          ],
          "line": 3037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 3025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/\""
          ],
          "line": 3024
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_efika(void)\n{\n\tint sound_irq[3] = { 2, 2, 0 };\n\tint bcomm_irq[3*16] = { 3,0,0, 3,1,0, 3,2,0, 3,3,0,\n\t\t\t\t3,4,0, 3,5,0, 3,6,0, 3,7,0,\n\t\t\t\t3,8,0, 3,9,0, 3,10,0, 3,11,0,\n\t\t\t\t3,12,0, 3,13,0, 3,14,0, 3,15,0 };\n\tu32 node;\n\tchar prop[64];\n\tint rv, len;\n\n\t/* Check if we're really running on a EFIKA */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\trv = prom_getprop(node, \"model\", prop, sizeof(prop));\n\tif (rv == PROM_ERROR)\n\t\treturn;\n\tif (prom_strcmp(prop, \"EFIKA5K2\"))\n\t\treturn;\n\n\tprom_printf(\"Applying EFIKA device tree fixups\\n\");\n\n\t/* Claiming to be 'chrp' is death */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\trv = prom_getprop(node, \"device_type\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (prom_strcmp(prop, \"chrp\") == 0))\n\t\tprom_setprop(node, \"/\", \"device_type\", \"efika\", sizeof(\"efika\"));\n\n\t/* CODEGEN,description is exposed in /proc/cpuinfo so\n\t   fix that too */\n\trv = prom_getprop(node, \"CODEGEN,description\", prop, sizeof(prop));\n\tif (rv != PROM_ERROR && (prom_strstr(prop, \"CHRP\")))\n\t\tprom_setprop(node, \"/\", \"CODEGEN,description\",\n\t\t\t     \"Efika 5200B PowerPC System\",\n\t\t\t     sizeof(\"Efika 5200B PowerPC System\"));\n\n\t/* Fixup bestcomm interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/bestcomm\"));\n\tif (PHANDLE_VALID(node)) {\n\t\tlen = prom_getproplen(node, \"interrupts\");\n\t\tif (len == 12) {\n\t\t\tprom_printf(\"Fixing bestcomm interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/bestcom\", \"interrupts\",\n\t\t\t\t     bcomm_irq, sizeof(bcomm_irq));\n\t\t}\n\t}\n\n\t/* Fixup sound interrupts property */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/sound\"));\n\tif (PHANDLE_VALID(node)) {\n\t\trv = prom_getprop(node, \"interrupts\", prop, sizeof(prop));\n\t\tif (rv == PROM_ERROR) {\n\t\t\tprom_printf(\"Adding sound interrupts property\\n\");\n\t\t\tprom_setprop(node, \"/builtin/sound\", \"interrupts\",\n\t\t\t\t     sound_irq, sizeof(sound_irq));\n\t\t}\n\t}\n\n\t/* Make sure ethernet phy-handle property exists */\n\tfixup_device_tree_efika_add_phy();\n}"
  },
  {
    "function_name": "fixup_device_tree_efika_add_phy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2950-3010",
    "snippet": "static void __init fixup_device_tree_efika_add_phy(void)\n{\n\tu32 node;\n\tchar prop[64];\n\tint rv;\n\n\t/* Check if /builtin/ethernet exists - bail if it doesn't */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/ethernet\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\t/* Check if the phy-handle property exists - bail if it does */\n\trv = prom_getprop(node, \"phy-handle\", prop, sizeof(prop));\n\tif (!rv)\n\t\treturn;\n\n\t/*\n\t * At this point the ethernet device doesn't have a phy described.\n\t * Now we need to add the missing phy node and linkage\n\t */\n\n\t/* Check for an MDIO bus node - if missing then create one */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/mdio\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet MDIO node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" 1 encode-int s\\\" #address-cells\\\" property\"\n\t\t\t\t\" 0 encode-int s\\\" #size-cells\\\" property\"\n\t\t\t\t\" s\\\" mdio\\\" device-name\"\n\t\t\t\t\" s\\\" fsl,mpc5200b-mdio\\\" encode-string\"\n\t\t\t\t\" s\\\" compatible\\\" property\"\n\t\t\t\t\" 0xf0003000 0x400 reg\"\n\t\t\t\t\" 0x2 encode-int\"\n\t\t\t\t\" 0x5 encode-int encode+\"\n\t\t\t\t\" 0x3 encode-int encode+\"\n\t\t\t\t\" s\\\" interrupts\\\" property\"\n\t\t\t\" finish-device\");\n\t};\n\n\t/* Check for a PHY device node - if missing then create one and\n\t * give it's phandle to the ethernet node */\n\tnode = call_prom(\"finddevice\", 1, 1,\n\t\t\t ADDR(\"/builtin/mdio/ethernet-phy\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet PHY node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin/mdio\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" s\\\" ethernet-phy\\\" device-name\"\n\t\t\t\t\" 0x10 encode-int s\\\" reg\\\" property\"\n\t\t\t\t\" my-self\"\n\t\t\t\t\" ihandle>phandle\"\n\t\t\t\" finish-device\"\n\t\t\t\" s\\\" /builtin/ethernet\\\" find-device\"\n\t\t\t\t\" encode-int\"\n\t\t\t\t\" s\\\" phy-handle\\\" property\"\n\t\t\t\" device-end\");\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"interpret\"",
            "1",
            "1",
            "\" s\\\" /builtin/mdio\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" s\\\" ethernet-phy\\\" device-name\"\n\t\t\t\t\" 0x10 encode-int s\\\" reg\\\" property\"\n\t\t\t\t\" my-self\"\n\t\t\t\t\" ihandle>phandle\"\n\t\t\t\" finish-device\"\n\t\t\t\" s\\\" /builtin/ethernet\\\" find-device\"\n\t\t\t\t\" encode-int\"\n\t\t\t\t\" s\\\" phy-handle\\\" property\"\n\t\t\t\" device-end\""
          ],
          "line": 2997
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Adding Ethernet PHY node\\n\""
          ],
          "line": 2996
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 2995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/builtin/mdio/ethernet-phy\""
          ],
          "line": 2994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 2973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/builtin/mdio\""
          ],
          "line": 2972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"phy-handle\"",
            "prop",
            "sizeof(prop)"
          ],
          "line": 2962
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "node"
          ],
          "line": 2958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/builtin/ethernet\""
          ],
          "line": 2957
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_efika_add_phy(void)\n{\n\tu32 node;\n\tchar prop[64];\n\tint rv;\n\n\t/* Check if /builtin/ethernet exists - bail if it doesn't */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/ethernet\"));\n\tif (!PHANDLE_VALID(node))\n\t\treturn;\n\n\t/* Check if the phy-handle property exists - bail if it does */\n\trv = prom_getprop(node, \"phy-handle\", prop, sizeof(prop));\n\tif (!rv)\n\t\treturn;\n\n\t/*\n\t * At this point the ethernet device doesn't have a phy described.\n\t * Now we need to add the missing phy node and linkage\n\t */\n\n\t/* Check for an MDIO bus node - if missing then create one */\n\tnode = call_prom(\"finddevice\", 1, 1, ADDR(\"/builtin/mdio\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet MDIO node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" 1 encode-int s\\\" #address-cells\\\" property\"\n\t\t\t\t\" 0 encode-int s\\\" #size-cells\\\" property\"\n\t\t\t\t\" s\\\" mdio\\\" device-name\"\n\t\t\t\t\" s\\\" fsl,mpc5200b-mdio\\\" encode-string\"\n\t\t\t\t\" s\\\" compatible\\\" property\"\n\t\t\t\t\" 0xf0003000 0x400 reg\"\n\t\t\t\t\" 0x2 encode-int\"\n\t\t\t\t\" 0x5 encode-int encode+\"\n\t\t\t\t\" 0x3 encode-int encode+\"\n\t\t\t\t\" s\\\" interrupts\\\" property\"\n\t\t\t\" finish-device\");\n\t};\n\n\t/* Check for a PHY device node - if missing then create one and\n\t * give it's phandle to the ethernet node */\n\tnode = call_prom(\"finddevice\", 1, 1,\n\t\t\t ADDR(\"/builtin/mdio/ethernet-phy\"));\n\tif (!PHANDLE_VALID(node)) {\n\t\tprom_printf(\"Adding Ethernet PHY node\\n\");\n\t\tcall_prom(\"interpret\", 1, 1,\n\t\t\t\" s\\\" /builtin/mdio\\\" find-device\"\n\t\t\t\" new-device\"\n\t\t\t\t\" s\\\" ethernet-phy\\\" device-name\"\n\t\t\t\t\" 0x10 encode-int s\\\" reg\\\" property\"\n\t\t\t\t\" my-self\"\n\t\t\t\t\" ihandle>phandle\"\n\t\t\t\" finish-device\"\n\t\t\t\" s\\\" /builtin/ethernet\\\" find-device\"\n\t\t\t\t\" encode-int\"\n\t\t\t\t\" s\\\" phy-handle\\\" property\"\n\t\t\t\" device-end\");\n\t}\n}"
  },
  {
    "function_name": "fixup_device_tree_pmac",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2900-2938",
    "snippet": "static void __init fixup_device_tree_pmac(void)\n{\n\tphandle u3, i2c, mpic;\n\tu32 u3_rev;\n\tu32 interrupts[2];\n\tu32 parent;\n\n\t/* Some G5s have a missing interrupt definition, fix it up here */\n\tu3 = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000\"));\n\tif (!PHANDLE_VALID(u3))\n\t\treturn;\n\ti2c = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/i2c@f8001000\"));\n\tif (!PHANDLE_VALID(i2c))\n\t\treturn;\n\tmpic = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/mpic@f8040000\"));\n\tif (!PHANDLE_VALID(mpic))\n\t\treturn;\n\n\t/* check if proper rev of u3 */\n\tif (prom_getprop(u3, \"device-rev\", &u3_rev, sizeof(u3_rev))\n\t    == PROM_ERROR)\n\t\treturn;\n\tif (u3_rev < 0x35 || u3_rev > 0x39)\n\t\treturn;\n\t/* does it need fixup ? */\n\tif (prom_getproplen(i2c, \"interrupts\") > 0)\n\t\treturn;\n\n\tprom_printf(\"fixing up bogus interrupts for u3 i2c...\\n\");\n\n\t/* interrupt on this revision of u3 is number 0 and level */\n\tinterrupts[0] = 0;\n\tinterrupts[1] = 1;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupts\",\n\t\t     &interrupts, sizeof(interrupts));\n\tparent = (u32)mpic;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupt-parent\",\n\t\t     &parent, sizeof(parent));\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "i2c",
            "\"/u3@0,f8000000/i2c@f8001000\"",
            "\"interrupt-parent\"",
            "&parent",
            "sizeof(parent)"
          ],
          "line": 2936
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"fixing up bogus interrupts for u3 i2c...\\n\""
          ],
          "line": 2928
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "i2c",
            "\"interrupts\""
          ],
          "line": 2925
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "649-652",
          "snippet": "static inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "u3",
            "\"device-rev\"",
            "&u3_rev",
            "sizeof(u3_rev)"
          ],
          "line": 2919
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "mpic"
          ],
          "line": 2915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(\"/u3@0,f8000000/mpic@f8040000\")"
          ],
          "line": 2914
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/u3@0,f8000000/mpic@f8040000\""
          ],
          "line": 2914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "i2c"
          ],
          "line": 2912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/u3@0,f8000000/i2c@f8001000\""
          ],
          "line": 2911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "u3"
          ],
          "line": 2909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/u3@0,f8000000\""
          ],
          "line": 2908
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_pmac(void)\n{\n\tphandle u3, i2c, mpic;\n\tu32 u3_rev;\n\tu32 interrupts[2];\n\tu32 parent;\n\n\t/* Some G5s have a missing interrupt definition, fix it up here */\n\tu3 = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000\"));\n\tif (!PHANDLE_VALID(u3))\n\t\treturn;\n\ti2c = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/i2c@f8001000\"));\n\tif (!PHANDLE_VALID(i2c))\n\t\treturn;\n\tmpic = call_prom(\"finddevice\", 1, 1, ADDR(\"/u3@0,f8000000/mpic@f8040000\"));\n\tif (!PHANDLE_VALID(mpic))\n\t\treturn;\n\n\t/* check if proper rev of u3 */\n\tif (prom_getprop(u3, \"device-rev\", &u3_rev, sizeof(u3_rev))\n\t    == PROM_ERROR)\n\t\treturn;\n\tif (u3_rev < 0x35 || u3_rev > 0x39)\n\t\treturn;\n\t/* does it need fixup ? */\n\tif (prom_getproplen(i2c, \"interrupts\") > 0)\n\t\treturn;\n\n\tprom_printf(\"fixing up bogus interrupts for u3 i2c...\\n\");\n\n\t/* interrupt on this revision of u3 is number 0 and level */\n\tinterrupts[0] = 0;\n\tinterrupts[1] = 1;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupts\",\n\t\t     &interrupts, sizeof(interrupts));\n\tparent = (u32)mpic;\n\tprom_setprop(i2c, \"/u3@0,f8000000/i2c@f8001000\", \"interrupt-parent\",\n\t\t     &parent, sizeof(parent));\n}"
  },
  {
    "function_name": "fixup_device_tree_chrp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2850-2894",
    "snippet": "static void __init fixup_device_tree_chrp(void)\n{\n\tphandle ph;\n\tu32 prop[6];\n\tu32 rloc = 0x01006000; /* IO space; PCI device = 12 */\n\tchar *name;\n\tint rc;\n\n\tname = \"/pci@80000000/isa@c\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(ph)) {\n\t\tname = \"/pci@ff500000/isa@6\";\n\t\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (PHANDLE_VALID(ph)) {\n\t\trc = prom_getproplen(ph, \"ranges\");\n\t\tif (rc == 0 || rc == PROM_ERROR) {\n\t\t\tprom_printf(\"Fixing up missing ISA range on Pegasos...\\n\");\n\n\t\t\tprop[0] = 0x1;\n\t\t\tprop[1] = 0x0;\n\t\t\tprop[2] = rloc;\n\t\t\tprop[3] = 0x0;\n\t\t\tprop[4] = 0x0;\n\t\t\tprop[5] = 0x00010000;\n\t\t\tprom_setprop(ph, name, \"ranges\", prop, sizeof(prop));\n\t\t}\n\t}\n\n\tname = \"/pci@80000000/ide@C,1\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (PHANDLE_VALID(ph)) {\n\t\tprom_printf(\"Fixing up IDE interrupt on Pegasos...\\n\");\n\t\tprop[0] = 14;\n\t\tprop[1] = 0x0;\n\t\tprom_setprop(ph, name, \"interrupts\", prop, 2*sizeof(u32));\n\t\tprom_printf(\"Fixing up IDE class-code on Pegasos...\\n\");\n\t\trc = prom_getprop(ph, \"class-code\", prop, sizeof(u32));\n\t\tif (rc == sizeof(u32)) {\n\t\t\tprop[0] &= ~0x5;\n\t\t\tprom_setprop(ph, name, \"class-code\", prop, sizeof(u32));\n\t\t}\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "ph",
            "name",
            "\"class-code\"",
            "prop",
            "sizeof(u32)"
          ],
          "line": 2891
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "ph",
            "\"class-code\"",
            "prop",
            "sizeof(u32)"
          ],
          "line": 2888
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Fixing up IDE class-code on Pegasos...\\n\""
          ],
          "line": 2887
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "ph"
          ],
          "line": 2882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(name)"
          ],
          "line": 2881
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "ph",
            "\"ranges\""
          ],
          "line": 2866
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "649-652",
          "snippet": "static inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "ph"
          ],
          "line": 2865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "ph"
          ],
          "line": 2860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2859
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_chrp(void)\n{\n\tphandle ph;\n\tu32 prop[6];\n\tu32 rloc = 0x01006000; /* IO space; PCI device = 12 */\n\tchar *name;\n\tint rc;\n\n\tname = \"/pci@80000000/isa@c\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(ph)) {\n\t\tname = \"/pci@ff500000/isa@6\";\n\t\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (PHANDLE_VALID(ph)) {\n\t\trc = prom_getproplen(ph, \"ranges\");\n\t\tif (rc == 0 || rc == PROM_ERROR) {\n\t\t\tprom_printf(\"Fixing up missing ISA range on Pegasos...\\n\");\n\n\t\t\tprop[0] = 0x1;\n\t\t\tprop[1] = 0x0;\n\t\t\tprop[2] = rloc;\n\t\t\tprop[3] = 0x0;\n\t\t\tprop[4] = 0x0;\n\t\t\tprop[5] = 0x00010000;\n\t\t\tprom_setprop(ph, name, \"ranges\", prop, sizeof(prop));\n\t\t}\n\t}\n\n\tname = \"/pci@80000000/ide@C,1\";\n\tph = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (PHANDLE_VALID(ph)) {\n\t\tprom_printf(\"Fixing up IDE interrupt on Pegasos...\\n\");\n\t\tprop[0] = 14;\n\t\tprop[1] = 0x0;\n\t\tprom_setprop(ph, name, \"interrupts\", prop, 2*sizeof(u32));\n\t\tprom_printf(\"Fixing up IDE class-code on Pegasos...\\n\");\n\t\trc = prom_getprop(ph, \"class-code\", prop, sizeof(u32));\n\t\tif (rc == sizeof(u32)) {\n\t\t\tprop[0] &= ~0x5;\n\t\t\tprom_setprop(ph, name, \"class-code\", prop, sizeof(u32));\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "fixup_device_tree_maple_memory_controller",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2806-2838",
    "snippet": "static void __init fixup_device_tree_maple_memory_controller(void)\n{\n\tphandle mc;\n\tu32 mc_reg[4];\n\tchar *name = \"/hostbridge@f8000000\";\n\tu32 ac, sc;\n\n\tmc = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(mc))\n\t\treturn;\n\n\tif (prom_getproplen(mc, \"reg\") != 8)\n\t\treturn;\n\n\tprom_getprop(prom.root, \"#address-cells\", &ac, sizeof(ac));\n\tprom_getprop(prom.root, \"#size-cells\", &sc, sizeof(sc));\n\tif ((ac != 2) || (sc != 2))\n\t\treturn;\n\n\tif (prom_getprop(mc, \"reg\", mc_reg, sizeof(mc_reg)) == PROM_ERROR)\n\t\treturn;\n\n\tif (mc_reg[0] != CPC925_MC_START || mc_reg[1] != CPC925_MC_LENGTH)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus hostbridge on Maple...\\n\");\n\n\tmc_reg[0] = 0x0;\n\tmc_reg[1] = CPC925_MC_START;\n\tmc_reg[2] = 0x0;\n\tmc_reg[3] = CPC925_MC_LENGTH;\n\tprom_setprop(mc, name, \"reg\", mc_reg, sizeof(mc_reg));\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define CPC925_MC_LENGTH\t0x1000000",
      "#define CPC925_MC_START\t\t0xf8000000",
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "mc",
            "name",
            "\"reg\"",
            "mc_reg",
            "sizeof(mc_reg)"
          ],
          "line": 2837
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Fixing up bogus hostbridge on Maple...\\n\""
          ],
          "line": 2831
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "mc",
            "\"reg\"",
            "mc_reg",
            "sizeof(mc_reg)"
          ],
          "line": 2825
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "mc",
            "\"reg\""
          ],
          "line": 2817
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "649-652",
          "snippet": "static inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "mc"
          ],
          "line": 2814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(name)"
          ],
          "line": 2813
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2813
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define CPC925_MC_LENGTH\t0x1000000\n#define CPC925_MC_START\t\t0xf8000000\n#define PROM_ERROR\t\t(-1u)\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init fixup_device_tree_maple_memory_controller(void)\n{\n\tphandle mc;\n\tu32 mc_reg[4];\n\tchar *name = \"/hostbridge@f8000000\";\n\tu32 ac, sc;\n\n\tmc = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(mc))\n\t\treturn;\n\n\tif (prom_getproplen(mc, \"reg\") != 8)\n\t\treturn;\n\n\tprom_getprop(prom.root, \"#address-cells\", &ac, sizeof(ac));\n\tprom_getprop(prom.root, \"#size-cells\", &sc, sizeof(sc));\n\tif ((ac != 2) || (sc != 2))\n\t\treturn;\n\n\tif (prom_getprop(mc, \"reg\", mc_reg, sizeof(mc_reg)) == PROM_ERROR)\n\t\treturn;\n\n\tif (mc_reg[0] != CPC925_MC_START || mc_reg[1] != CPC925_MC_LENGTH)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus hostbridge on Maple...\\n\");\n\n\tmc_reg[0] = 0x0;\n\tmc_reg[1] = CPC925_MC_START;\n\tmc_reg[2] = 0x0;\n\tmc_reg[3] = CPC925_MC_LENGTH;\n\tprom_setprop(mc, name, \"reg\", mc_reg, sizeof(mc_reg));\n}"
  },
  {
    "function_name": "fixup_device_tree_maple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2763-2801",
    "snippet": "static void __init fixup_device_tree_maple(void)\n{\n\tphandle isa;\n\tu32 rloc = 0x01002000; /* IO space; PCI device = 4 */\n\tu32 isa_ranges[6];\n\tchar *name;\n\n\tname = \"/ht@0/isa@4\";\n\tisa = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(isa)) {\n\t\tname = \"/ht@0/isa@6\";\n\t\tisa = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (!PHANDLE_VALID(isa))\n\t\treturn;\n\n\tif (prom_getproplen(isa, \"ranges\") != 12)\n\t\treturn;\n\tif (prom_getprop(isa, \"ranges\", isa_ranges, sizeof(isa_ranges))\n\t\t== PROM_ERROR)\n\t\treturn;\n\n\tif (isa_ranges[0] != 0x1 ||\n\t\tisa_ranges[1] != 0xf4000000 ||\n\t\tisa_ranges[2] != 0x00010000)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus ISA range on Maple/Apache...\\n\");\n\n\tisa_ranges[0] = 0x1;\n\tisa_ranges[1] = 0x0;\n\tisa_ranges[2] = rloc;\n\tisa_ranges[3] = 0x0;\n\tisa_ranges[4] = 0x0;\n\tisa_ranges[5] = 0x00010000;\n\tprom_setprop(isa, name, \"ranges\",\n\t\t\tisa_ranges, sizeof(isa_ranges));\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "isa",
            "name",
            "\"ranges\"",
            "isa_ranges",
            "sizeof(isa_ranges)"
          ],
          "line": 2799
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Fixing up bogus ISA range on Maple/Apache...\\n\""
          ],
          "line": 2791
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "isa",
            "\"ranges\"",
            "isa_ranges",
            "sizeof(isa_ranges)"
          ],
          "line": 2782
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "isa",
            "\"ranges\""
          ],
          "line": 2780
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "649-652",
          "snippet": "static inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "isa"
          ],
          "line": 2777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(name)"
          ],
          "line": 2774
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "isa"
          ],
          "line": 2772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "name"
          ],
          "line": 2771
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init fixup_device_tree_maple(void)\n{\n\tphandle isa;\n\tu32 rloc = 0x01002000; /* IO space; PCI device = 4 */\n\tu32 isa_ranges[6];\n\tchar *name;\n\n\tname = \"/ht@0/isa@4\";\n\tisa = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\tif (!PHANDLE_VALID(isa)) {\n\t\tname = \"/ht@0/isa@6\";\n\t\tisa = call_prom(\"finddevice\", 1, 1, ADDR(name));\n\t\trloc = 0x01003000; /* IO space; PCI device = 6 */\n\t}\n\tif (!PHANDLE_VALID(isa))\n\t\treturn;\n\n\tif (prom_getproplen(isa, \"ranges\") != 12)\n\t\treturn;\n\tif (prom_getprop(isa, \"ranges\", isa_ranges, sizeof(isa_ranges))\n\t\t== PROM_ERROR)\n\t\treturn;\n\n\tif (isa_ranges[0] != 0x1 ||\n\t\tisa_ranges[1] != 0xf4000000 ||\n\t\tisa_ranges[2] != 0x00010000)\n\t\treturn;\n\n\tprom_printf(\"Fixing up bogus ISA range on Maple/Apache...\\n\");\n\n\tisa_ranges[0] = 0x1;\n\tisa_ranges[1] = 0x0;\n\tisa_ranges[2] = rloc;\n\tisa_ranges[3] = 0x0;\n\tisa_ranges[4] = 0x0;\n\tisa_ranges[5] = 0x00010000;\n\tprom_setprop(isa, name, \"ranges\",\n\t\t\tisa_ranges, sizeof(isa_ranges));\n}"
  },
  {
    "function_name": "flatten_device_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2666-2758",
    "snippet": "static void __init flatten_device_tree(void)\n{\n\tphandle root;\n\tunsigned long mem_start, mem_end, room;\n\tstruct boot_param_header *hdr;\n\tchar *namep;\n\tu64 *rsvmap;\n\n\t/*\n\t * Check how much room we have between alloc top & bottom (+/- a\n\t * few pages), crop to 1MB, as this is our \"chunk\" size\n\t */\n\troom = alloc_top - alloc_bottom - 0x4000;\n\tif (room > DEVTREE_CHUNK_SIZE)\n\t\troom = DEVTREE_CHUNK_SIZE;\n\tprom_debug(\"starting device tree allocs at %lx\\n\", alloc_bottom);\n\n\t/* Now try to claim that */\n\tmem_start = (unsigned long)alloc_up(room, PAGE_SIZE);\n\tif (mem_start == 0)\n\t\tprom_panic(\"Can't allocate initial device-tree chunk\\n\");\n\tmem_end = mem_start + room;\n\n\t/* Get root of tree */\n\troot = call_prom(\"peer\", 1, 1, (phandle)0);\n\tif (root == (phandle)0)\n\t\tprom_panic (\"couldn't get device tree root\\n\");\n\n\t/* Build header and make room for mem rsv map */ \n\tmem_start = ALIGN(mem_start, 4);\n\thdr = make_room(&mem_start, &mem_end,\n\t\t\tsizeof(struct boot_param_header), 4);\n\tdt_header_start = (unsigned long)hdr;\n\trsvmap = make_room(&mem_start, &mem_end, sizeof(mem_reserve_map), 8);\n\n\t/* Start of strings */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_string_start = mem_start;\n\tmem_start += 4; /* hole */\n\n\t/* Add \"phandle\" in there, we'll need it */\n\tnamep = make_room(&mem_start, &mem_end, 16, 1);\n\tprom_strcpy(namep, \"phandle\");\n\tmem_start = (unsigned long)namep + prom_strlen(namep) + 1;\n\n\t/* Build string array */\n\tprom_printf(\"Building dt strings...\\n\"); \n\tscan_dt_build_strings(root, &mem_start, &mem_end);\n\tdt_string_end = mem_start;\n\n\t/* Build structure */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_struct_start = mem_start;\n\tprom_printf(\"Building dt structure...\\n\"); \n\tscan_dt_build_struct(root, &mem_start, &mem_end);\n\tdt_push_token(OF_DT_END, &mem_start, &mem_end);\n\tdt_struct_end = PAGE_ALIGN(mem_start);\n\n\t/* Finish header */\n\thdr->boot_cpuid_phys = cpu_to_be32(prom.cpu);\n\thdr->magic = cpu_to_be32(OF_DT_HEADER);\n\thdr->totalsize = cpu_to_be32(dt_struct_end - dt_header_start);\n\thdr->off_dt_struct = cpu_to_be32(dt_struct_start - dt_header_start);\n\thdr->off_dt_strings = cpu_to_be32(dt_string_start - dt_header_start);\n\thdr->dt_strings_size = cpu_to_be32(dt_string_end - dt_string_start);\n\thdr->off_mem_rsvmap = cpu_to_be32(((unsigned long)rsvmap) - dt_header_start);\n\thdr->version = cpu_to_be32(OF_DT_VERSION);\n\t/* Version 16 is not backward compatible */\n\thdr->last_comp_version = cpu_to_be32(0x10);\n\n\t/* Copy the reserve map in */\n\tmemcpy(rsvmap, mem_reserve_map, sizeof(mem_reserve_map));\n\n#ifdef DEBUG_PROM\n\t{\n\t\tint i;\n\t\tprom_printf(\"reserved memory map:\\n\");\n\t\tfor (i = 0; i < mem_reserve_cnt; i++)\n\t\t\tprom_printf(\"  %llx - %llx\\n\",\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].base),\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].size));\n\t}\n#endif\n\t/* Bump mem_reserve_cnt to cause further reservations to fail\n\t * since it's too late.\n\t */\n\tmem_reserve_cnt = MEM_RESERVE_MAP_SIZE;\n\n\tprom_printf(\"Device tree strings 0x%lx -> 0x%lx\\n\",\n\t\t    dt_string_start, dt_string_end);\n\tprom_printf(\"Device tree struct  0x%lx -> 0x%lx\\n\",\n\t\t    dt_struct_start, dt_struct_end);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define MEM_RESERVE_MAP_SIZE\t8",
      "#define DEVTREE_CHUNK_SIZE\t0x100000"
    ],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static unsigned long __prombss dt_header_start;",
      "static unsigned long __prombss dt_struct_start, dt_struct_end;",
      "static unsigned long __prombss dt_string_start, dt_string_end;",
      "static unsigned long __prombss alloc_top;",
      "static unsigned long __prombss alloc_bottom;",
      "static struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];",
      "static int __prombss mem_reserve_cnt;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Device tree struct  0x%lx -> 0x%lx\\n\"",
            "dt_struct_start",
            "dt_struct_end"
          ],
          "line": 2756
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "mem_reserve_map[i].size"
          ],
          "line": 2746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "mem_reserve_map[i].base"
          ],
          "line": 2745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "rsvmap",
            "mem_reserve_map",
            "sizeof(mem_reserve_map)"
          ],
          "line": 2737
        },
        "resolved": true,
        "details": {
          "function_name": "_memcpy_toio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "181-205",
          "snippet": "void _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0x10"
          ],
          "line": 2734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "OF_DT_VERSION"
          ],
          "line": 2732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "((unsigned long)rsvmap) - dt_header_start"
          ],
          "line": 2731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "dt_string_end - dt_string_start"
          ],
          "line": 2730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "dt_string_start - dt_header_start"
          ],
          "line": 2729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "dt_struct_start - dt_header_start"
          ],
          "line": 2728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "dt_struct_end - dt_header_start"
          ],
          "line": 2727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "OF_DT_HEADER"
          ],
          "line": 2726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "prom.cpu"
          ],
          "line": 2725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "mem_start"
          ],
          "line": 2722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "OF_DT_END",
            "&mem_start",
            "&mem_end"
          ],
          "line": 2721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scan_dt_build_struct",
          "args": [
            "root",
            "&mem_start",
            "&mem_end"
          ],
          "line": 2720
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dt_build_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2552-2664",
          "snippet": "static void __init scan_dt_build_struct(phandle node, unsigned long *mem_start,\n\t\t\t\t\tunsigned long *mem_end)\n{\n\tphandle child;\n\tchar *namep, *prev_name, *sstart, *p, *ep, *lp, *path;\n\tunsigned long soff;\n\tunsigned char *valp;\n\tstatic char pname[MAX_PROPERTY_NAME] __prombss;\n\tint l, room, has_phandle = 0;\n\n\tdt_push_token(OF_DT_BEGIN_NODE, mem_start, mem_end);\n\n\t/* get the node's full name */\n\tnamep = (char *)*mem_start;\n\troom = *mem_end - *mem_start;\n\tif (room > 255)\n\t\troom = 255;\n\tl = call_prom(\"package-to-path\", 3, 1, node, namep, room);\n\tif (l >= 0) {\n\t\t/* Didn't fit?  Get more room. */\n\t\tif (l >= room) {\n\t\t\tif (l >= *mem_end - *mem_start)\n\t\t\t\tnamep = make_room(mem_start, mem_end, l+1, 1);\n\t\t\tcall_prom(\"package-to-path\", 3, 1, node, namep, l);\n\t\t}\n\t\tnamep[l] = '\\0';\n\n\t\t/* Fixup an Apple bug where they have bogus \\0 chars in the\n\t\t * middle of the path in some properties, and extract\n\t\t * the unit name (everything after the last '/').\n\t\t */\n\t\tfor (lp = p = namep, ep = namep + l; p < ep; p++) {\n\t\t\tif (*p == '/')\n\t\t\t\tlp = namep;\n\t\t\telse if (*p != 0)\n\t\t\t\t*lp++ = *p;\n\t\t}\n\t\t*lp = 0;\n\t\t*mem_start = ALIGN((unsigned long)lp + 1, 4);\n\t}\n\n\t/* get it again for debugging */\n\tpath = prom_scratch;\n\tmemset(path, 0, sizeof(prom_scratch));\n\tcall_prom(\"package-to-path\", 3, 1, node, path, sizeof(prom_scratch) - 1);\n\n\t/* get and store all properties */\n\tprev_name = \"\";\n\tsstart = (char *)dt_string_start;\n\tfor (;;) {\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name,\n\t\t\t      pname) != 1)\n\t\t\tbreak;\n\n \t\t/* skip \"name\" */\n\t\tif (prom_strcmp(pname, \"name\") == 0) {\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\n\t\t/* find string offset */\n\t\tsoff = dt_find_string(pname);\n\t\tif (soff == 0) {\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <%s>, node %s\\n\", pname, path);\n\t\t\tbreak;\n\t\t}\n\t\tprev_name = sstart + soff;\n\n\t\t/* get length */\n\t\tl = call_prom(\"getproplen\", 2, 1, node, pname);\n\n\t\t/* sanity checks */\n\t\tif (l == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\t/* push property head */\n\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\tdt_push_token(l, mem_start, mem_end);\n\t\tdt_push_token(soff, mem_start, mem_end);\n\n\t\t/* push property content */\n\t\tvalp = make_room(mem_start, mem_end, l, 4);\n\t\tcall_prom(\"getprop\", 4, 1, node, pname, valp, l);\n\t\t*mem_start = ALIGN(*mem_start, 4);\n\n\t\tif (!prom_strcmp(pname, \"phandle\"))\n\t\t\thas_phandle = 1;\n\t}\n\n\t/* Add a \"phandle\" property if none already exist */\n\tif (!has_phandle) {\n\t\tsoff = dt_find_string(\"phandle\");\n\t\tif (soff == 0)\n\t\t\tprom_printf(\"WARNING: Can't find string index for <phandle> node %s\\n\", path);\n\t\telse {\n\t\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\t\tdt_push_token(4, mem_start, mem_end);\n\t\t\tdt_push_token(soff, mem_start, mem_end);\n\t\t\tvalp = make_room(mem_start, mem_end, 4, 4);\n\t\t\t*(__be32 *)valp = cpu_to_be32(node);\n\t\t}\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_struct(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n\n\tdt_push_token(OF_DT_END_NODE, mem_start, mem_end);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MAX_PROPERTY_NAME 64",
            "#define PROM_ERROR\t\t(-1u)",
            "#define __prombss __section(.bss.prominit)"
          ],
          "globals_used": [
            "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);",
            "static char __prombss prom_scratch[256];",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MAX_PROPERTY_NAME 64\n#define PROM_ERROR\t\t(-1u)\n#define __prombss __section(.bss.prominit)\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\nstatic char __prombss prom_scratch[256];\nstatic void __init;\n\nstatic void __init scan_dt_build_struct(phandle node, unsigned long *mem_start,\n\t\t\t\t\tunsigned long *mem_end)\n{\n\tphandle child;\n\tchar *namep, *prev_name, *sstart, *p, *ep, *lp, *path;\n\tunsigned long soff;\n\tunsigned char *valp;\n\tstatic char pname[MAX_PROPERTY_NAME] __prombss;\n\tint l, room, has_phandle = 0;\n\n\tdt_push_token(OF_DT_BEGIN_NODE, mem_start, mem_end);\n\n\t/* get the node's full name */\n\tnamep = (char *)*mem_start;\n\troom = *mem_end - *mem_start;\n\tif (room > 255)\n\t\troom = 255;\n\tl = call_prom(\"package-to-path\", 3, 1, node, namep, room);\n\tif (l >= 0) {\n\t\t/* Didn't fit?  Get more room. */\n\t\tif (l >= room) {\n\t\t\tif (l >= *mem_end - *mem_start)\n\t\t\t\tnamep = make_room(mem_start, mem_end, l+1, 1);\n\t\t\tcall_prom(\"package-to-path\", 3, 1, node, namep, l);\n\t\t}\n\t\tnamep[l] = '\\0';\n\n\t\t/* Fixup an Apple bug where they have bogus \\0 chars in the\n\t\t * middle of the path in some properties, and extract\n\t\t * the unit name (everything after the last '/').\n\t\t */\n\t\tfor (lp = p = namep, ep = namep + l; p < ep; p++) {\n\t\t\tif (*p == '/')\n\t\t\t\tlp = namep;\n\t\t\telse if (*p != 0)\n\t\t\t\t*lp++ = *p;\n\t\t}\n\t\t*lp = 0;\n\t\t*mem_start = ALIGN((unsigned long)lp + 1, 4);\n\t}\n\n\t/* get it again for debugging */\n\tpath = prom_scratch;\n\tmemset(path, 0, sizeof(prom_scratch));\n\tcall_prom(\"package-to-path\", 3, 1, node, path, sizeof(prom_scratch) - 1);\n\n\t/* get and store all properties */\n\tprev_name = \"\";\n\tsstart = (char *)dt_string_start;\n\tfor (;;) {\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name,\n\t\t\t      pname) != 1)\n\t\t\tbreak;\n\n \t\t/* skip \"name\" */\n\t\tif (prom_strcmp(pname, \"name\") == 0) {\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\n\t\t/* find string offset */\n\t\tsoff = dt_find_string(pname);\n\t\tif (soff == 0) {\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <%s>, node %s\\n\", pname, path);\n\t\t\tbreak;\n\t\t}\n\t\tprev_name = sstart + soff;\n\n\t\t/* get length */\n\t\tl = call_prom(\"getproplen\", 2, 1, node, pname);\n\n\t\t/* sanity checks */\n\t\tif (l == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\t/* push property head */\n\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\tdt_push_token(l, mem_start, mem_end);\n\t\tdt_push_token(soff, mem_start, mem_end);\n\n\t\t/* push property content */\n\t\tvalp = make_room(mem_start, mem_end, l, 4);\n\t\tcall_prom(\"getprop\", 4, 1, node, pname, valp, l);\n\t\t*mem_start = ALIGN(*mem_start, 4);\n\n\t\tif (!prom_strcmp(pname, \"phandle\"))\n\t\t\thas_phandle = 1;\n\t}\n\n\t/* Add a \"phandle\" property if none already exist */\n\tif (!has_phandle) {\n\t\tsoff = dt_find_string(\"phandle\");\n\t\tif (soff == 0)\n\t\t\tprom_printf(\"WARNING: Can't find string index for <phandle> node %s\\n\", path);\n\t\telse {\n\t\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\t\tdt_push_token(4, mem_start, mem_end);\n\t\t\tdt_push_token(soff, mem_start, mem_end);\n\t\t\tvalp = make_room(mem_start, mem_end, 4, 4);\n\t\t\t*(__be32 *)valp = cpu_to_be32(node);\n\t\t}\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_struct(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n\n\tdt_push_token(OF_DT_END_NODE, mem_start, mem_end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "mem_start"
          ],
          "line": 2717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scan_dt_build_strings",
          "args": [
            "root",
            "&mem_start",
            "&mem_end"
          ],
          "line": 2713
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dt_build_strings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2504-2550",
          "snippet": "static void __init scan_dt_build_strings(phandle node,\n\t\t\t\t\t unsigned long *mem_start,\n\t\t\t\t\t unsigned long *mem_end)\n{\n\tchar *prev_name, *namep, *sstart;\n\tunsigned long soff;\n\tphandle child;\n\n\tsstart =  (char *)dt_string_start;\n\n\t/* get and store all property names */\n\tprev_name = \"\";\n\tfor (;;) {\n\t\t/* 64 is max len of name including nul. */\n\t\tnamep = make_room(mem_start, mem_end, MAX_PROPERTY_NAME, 1);\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name, namep) != 1) {\n\t\t\t/* No more nodes: unwind alloc */\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tbreak;\n\t\t}\n\n \t\t/* skip \"name\" */\n\t\tif (prom_strcmp(namep, \"name\") == 0) {\n \t\t\t*mem_start = (unsigned long)namep;\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\t\t/* get/create string entry */\n\t\tsoff = dt_find_string(namep);\n\t\tif (soff != 0) {\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tnamep = sstart + soff;\n\t\t} else {\n\t\t\t/* Trim off some if we can */\n\t\t\t*mem_start = (unsigned long)namep + prom_strlen(namep) + 1;\n\t\t\tdt_string_end = *mem_start;\n\t\t}\n\t\tprev_name = namep;\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_strings(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MAX_PROPERTY_NAME 64"
          ],
          "globals_used": [
            "static unsigned long __prombss dt_string_start, dt_string_end;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MAX_PROPERTY_NAME 64\n\nstatic unsigned long __prombss dt_string_start, dt_string_end;\nstatic void __init;\n\nstatic void __init scan_dt_build_strings(phandle node,\n\t\t\t\t\t unsigned long *mem_start,\n\t\t\t\t\t unsigned long *mem_end)\n{\n\tchar *prev_name, *namep, *sstart;\n\tunsigned long soff;\n\tphandle child;\n\n\tsstart =  (char *)dt_string_start;\n\n\t/* get and store all property names */\n\tprev_name = \"\";\n\tfor (;;) {\n\t\t/* 64 is max len of name including nul. */\n\t\tnamep = make_room(mem_start, mem_end, MAX_PROPERTY_NAME, 1);\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name, namep) != 1) {\n\t\t\t/* No more nodes: unwind alloc */\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tbreak;\n\t\t}\n\n \t\t/* skip \"name\" */\n\t\tif (prom_strcmp(namep, \"name\") == 0) {\n \t\t\t*mem_start = (unsigned long)namep;\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\t\t/* get/create string entry */\n\t\tsoff = dt_find_string(namep);\n\t\tif (soff != 0) {\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tnamep = sstart + soff;\n\t\t} else {\n\t\t\t/* Trim off some if we can */\n\t\t\t*mem_start = (unsigned long)namep + prom_strlen(namep) + 1;\n\t\t\tdt_string_end = *mem_start;\n\t\t}\n\t\tprev_name = namep;\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_strings(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strlen",
          "args": [
            "namep"
          ],
          "line": 2709
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strcpy",
          "args": [
            "namep",
            "\"phandle\""
          ],
          "line": 2708
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "245-252",
          "snippet": "static char __init *prom_strcpy(char *dest, const char *src)\n{\n\tchar *tmp = dest;\n\n\twhile ((*dest++ = *src++) != '\\0')\n\t\t/* nothing */;\n\treturn tmp;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic char __init *prom_strcpy(char *dest, const char *src)\n{\n\tchar *tmp = dest;\n\n\twhile ((*dest++ = *src++) != '\\0')\n\t\t/* nothing */;\n\treturn tmp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_room",
          "args": [
            "&mem_start",
            "&mem_end",
            "16",
            "1"
          ],
          "line": 2707
        },
        "resolved": true,
        "details": {
          "function_name": "make_room",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2449-2477",
          "snippet": "static void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %lx...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define DEVTREE_CHUNK_SIZE\t0x100000"
          ],
          "globals_used": [
            "static unsigned long __prombss alloc_top;",
            "static unsigned long __prombss alloc_bottom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_bottom;\nstatic void __init;\n\nstatic void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %lx...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "mem_start"
          ],
          "line": 2702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "mem_start",
            "4"
          ],
          "line": 2695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"couldn't get device tree root\\n\""
          ],
          "line": 2692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"peer\"",
            "1",
            "1",
            "(phandle)0"
          ],
          "line": 2690
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Can't allocate initial device-tree chunk\\n\""
          ],
          "line": 2686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_up",
          "args": [
            "room",
            "PAGE_SIZE"
          ],
          "line": 2684
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_up",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1462-1500",
          "snippet": "static unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = ALIGN(base, align);\n\tprom_debug(\"%s(%lx, %lx)\\n\", __func__, size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = ALIGN(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = ALIGN(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss alloc_top;",
            "static unsigned long __prombss alloc_top_high;",
            "static unsigned long __prombss alloc_bottom;",
            "static unsigned long __prombss rmo_top;",
            "static unsigned long __prombss ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_top_high;\nstatic unsigned long __prombss alloc_bottom;\nstatic unsigned long __prombss rmo_top;\nstatic unsigned long __prombss ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = ALIGN(base, align);\n\tprom_debug(\"%s(%lx, %lx)\\n\", __func__, size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = ALIGN(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = ALIGN(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"starting device tree allocs at %lx\\n\"",
            "alloc_bottom"
          ],
          "line": 2681
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic struct prom_t __prombss prom;\nstatic unsigned long __prombss dt_header_start;\nstatic unsigned long __prombss dt_struct_start, dt_struct_end;\nstatic unsigned long __prombss dt_string_start, dt_string_end;\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_bottom;\nstatic struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];\nstatic int __prombss mem_reserve_cnt;\nstatic void __init;\n\nstatic void __init flatten_device_tree(void)\n{\n\tphandle root;\n\tunsigned long mem_start, mem_end, room;\n\tstruct boot_param_header *hdr;\n\tchar *namep;\n\tu64 *rsvmap;\n\n\t/*\n\t * Check how much room we have between alloc top & bottom (+/- a\n\t * few pages), crop to 1MB, as this is our \"chunk\" size\n\t */\n\troom = alloc_top - alloc_bottom - 0x4000;\n\tif (room > DEVTREE_CHUNK_SIZE)\n\t\troom = DEVTREE_CHUNK_SIZE;\n\tprom_debug(\"starting device tree allocs at %lx\\n\", alloc_bottom);\n\n\t/* Now try to claim that */\n\tmem_start = (unsigned long)alloc_up(room, PAGE_SIZE);\n\tif (mem_start == 0)\n\t\tprom_panic(\"Can't allocate initial device-tree chunk\\n\");\n\tmem_end = mem_start + room;\n\n\t/* Get root of tree */\n\troot = call_prom(\"peer\", 1, 1, (phandle)0);\n\tif (root == (phandle)0)\n\t\tprom_panic (\"couldn't get device tree root\\n\");\n\n\t/* Build header and make room for mem rsv map */ \n\tmem_start = ALIGN(mem_start, 4);\n\thdr = make_room(&mem_start, &mem_end,\n\t\t\tsizeof(struct boot_param_header), 4);\n\tdt_header_start = (unsigned long)hdr;\n\trsvmap = make_room(&mem_start, &mem_end, sizeof(mem_reserve_map), 8);\n\n\t/* Start of strings */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_string_start = mem_start;\n\tmem_start += 4; /* hole */\n\n\t/* Add \"phandle\" in there, we'll need it */\n\tnamep = make_room(&mem_start, &mem_end, 16, 1);\n\tprom_strcpy(namep, \"phandle\");\n\tmem_start = (unsigned long)namep + prom_strlen(namep) + 1;\n\n\t/* Build string array */\n\tprom_printf(\"Building dt strings...\\n\"); \n\tscan_dt_build_strings(root, &mem_start, &mem_end);\n\tdt_string_end = mem_start;\n\n\t/* Build structure */\n\tmem_start = PAGE_ALIGN(mem_start);\n\tdt_struct_start = mem_start;\n\tprom_printf(\"Building dt structure...\\n\"); \n\tscan_dt_build_struct(root, &mem_start, &mem_end);\n\tdt_push_token(OF_DT_END, &mem_start, &mem_end);\n\tdt_struct_end = PAGE_ALIGN(mem_start);\n\n\t/* Finish header */\n\thdr->boot_cpuid_phys = cpu_to_be32(prom.cpu);\n\thdr->magic = cpu_to_be32(OF_DT_HEADER);\n\thdr->totalsize = cpu_to_be32(dt_struct_end - dt_header_start);\n\thdr->off_dt_struct = cpu_to_be32(dt_struct_start - dt_header_start);\n\thdr->off_dt_strings = cpu_to_be32(dt_string_start - dt_header_start);\n\thdr->dt_strings_size = cpu_to_be32(dt_string_end - dt_string_start);\n\thdr->off_mem_rsvmap = cpu_to_be32(((unsigned long)rsvmap) - dt_header_start);\n\thdr->version = cpu_to_be32(OF_DT_VERSION);\n\t/* Version 16 is not backward compatible */\n\thdr->last_comp_version = cpu_to_be32(0x10);\n\n\t/* Copy the reserve map in */\n\tmemcpy(rsvmap, mem_reserve_map, sizeof(mem_reserve_map));\n\n#ifdef DEBUG_PROM\n\t{\n\t\tint i;\n\t\tprom_printf(\"reserved memory map:\\n\");\n\t\tfor (i = 0; i < mem_reserve_cnt; i++)\n\t\t\tprom_printf(\"  %llx - %llx\\n\",\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].base),\n\t\t\t\t    be64_to_cpu(mem_reserve_map[i].size));\n\t}\n#endif\n\t/* Bump mem_reserve_cnt to cause further reservations to fail\n\t * since it's too late.\n\t */\n\tmem_reserve_cnt = MEM_RESERVE_MAP_SIZE;\n\n\tprom_printf(\"Device tree strings 0x%lx -> 0x%lx\\n\",\n\t\t    dt_string_start, dt_string_end);\n\tprom_printf(\"Device tree struct  0x%lx -> 0x%lx\\n\",\n\t\t    dt_struct_start, dt_struct_end);\n}"
  },
  {
    "function_name": "scan_dt_build_struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2552-2664",
    "snippet": "static void __init scan_dt_build_struct(phandle node, unsigned long *mem_start,\n\t\t\t\t\tunsigned long *mem_end)\n{\n\tphandle child;\n\tchar *namep, *prev_name, *sstart, *p, *ep, *lp, *path;\n\tunsigned long soff;\n\tunsigned char *valp;\n\tstatic char pname[MAX_PROPERTY_NAME] __prombss;\n\tint l, room, has_phandle = 0;\n\n\tdt_push_token(OF_DT_BEGIN_NODE, mem_start, mem_end);\n\n\t/* get the node's full name */\n\tnamep = (char *)*mem_start;\n\troom = *mem_end - *mem_start;\n\tif (room > 255)\n\t\troom = 255;\n\tl = call_prom(\"package-to-path\", 3, 1, node, namep, room);\n\tif (l >= 0) {\n\t\t/* Didn't fit?  Get more room. */\n\t\tif (l >= room) {\n\t\t\tif (l >= *mem_end - *mem_start)\n\t\t\t\tnamep = make_room(mem_start, mem_end, l+1, 1);\n\t\t\tcall_prom(\"package-to-path\", 3, 1, node, namep, l);\n\t\t}\n\t\tnamep[l] = '\\0';\n\n\t\t/* Fixup an Apple bug where they have bogus \\0 chars in the\n\t\t * middle of the path in some properties, and extract\n\t\t * the unit name (everything after the last '/').\n\t\t */\n\t\tfor (lp = p = namep, ep = namep + l; p < ep; p++) {\n\t\t\tif (*p == '/')\n\t\t\t\tlp = namep;\n\t\t\telse if (*p != 0)\n\t\t\t\t*lp++ = *p;\n\t\t}\n\t\t*lp = 0;\n\t\t*mem_start = ALIGN((unsigned long)lp + 1, 4);\n\t}\n\n\t/* get it again for debugging */\n\tpath = prom_scratch;\n\tmemset(path, 0, sizeof(prom_scratch));\n\tcall_prom(\"package-to-path\", 3, 1, node, path, sizeof(prom_scratch) - 1);\n\n\t/* get and store all properties */\n\tprev_name = \"\";\n\tsstart = (char *)dt_string_start;\n\tfor (;;) {\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name,\n\t\t\t      pname) != 1)\n\t\t\tbreak;\n\n \t\t/* skip \"name\" */\n\t\tif (prom_strcmp(pname, \"name\") == 0) {\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\n\t\t/* find string offset */\n\t\tsoff = dt_find_string(pname);\n\t\tif (soff == 0) {\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <%s>, node %s\\n\", pname, path);\n\t\t\tbreak;\n\t\t}\n\t\tprev_name = sstart + soff;\n\n\t\t/* get length */\n\t\tl = call_prom(\"getproplen\", 2, 1, node, pname);\n\n\t\t/* sanity checks */\n\t\tif (l == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\t/* push property head */\n\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\tdt_push_token(l, mem_start, mem_end);\n\t\tdt_push_token(soff, mem_start, mem_end);\n\n\t\t/* push property content */\n\t\tvalp = make_room(mem_start, mem_end, l, 4);\n\t\tcall_prom(\"getprop\", 4, 1, node, pname, valp, l);\n\t\t*mem_start = ALIGN(*mem_start, 4);\n\n\t\tif (!prom_strcmp(pname, \"phandle\"))\n\t\t\thas_phandle = 1;\n\t}\n\n\t/* Add a \"phandle\" property if none already exist */\n\tif (!has_phandle) {\n\t\tsoff = dt_find_string(\"phandle\");\n\t\tif (soff == 0)\n\t\t\tprom_printf(\"WARNING: Can't find string index for <phandle> node %s\\n\", path);\n\t\telse {\n\t\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\t\tdt_push_token(4, mem_start, mem_end);\n\t\t\tdt_push_token(soff, mem_start, mem_end);\n\t\t\tvalp = make_room(mem_start, mem_end, 4, 4);\n\t\t\t*(__be32 *)valp = cpu_to_be32(node);\n\t\t}\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_struct(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n\n\tdt_push_token(OF_DT_END_NODE, mem_start, mem_end);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define MAX_PROPERTY_NAME 64",
      "#define PROM_ERROR\t\t(-1u)",
      "#define __prombss __section(.bss.prominit)"
    ],
    "globals_used": [
      "extern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);",
      "static char __prombss prom_scratch[256];",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "OF_DT_END_NODE",
            "mem_start",
            "mem_end"
          ],
          "line": 2663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"peer\"",
            "1",
            "1",
            "child"
          ],
          "line": 2660
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "scan_dt_build_struct",
          "args": [
            "child",
            "mem_start",
            "mem_end"
          ],
          "line": 2659
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dt_build_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2552-2664",
          "snippet": "static void __init scan_dt_build_struct(phandle node, unsigned long *mem_start,\n\t\t\t\t\tunsigned long *mem_end)\n{\n\tphandle child;\n\tchar *namep, *prev_name, *sstart, *p, *ep, *lp, *path;\n\tunsigned long soff;\n\tunsigned char *valp;\n\tstatic char pname[MAX_PROPERTY_NAME] __prombss;\n\tint l, room, has_phandle = 0;\n\n\tdt_push_token(OF_DT_BEGIN_NODE, mem_start, mem_end);\n\n\t/* get the node's full name */\n\tnamep = (char *)*mem_start;\n\troom = *mem_end - *mem_start;\n\tif (room > 255)\n\t\troom = 255;\n\tl = call_prom(\"package-to-path\", 3, 1, node, namep, room);\n\tif (l >= 0) {\n\t\t/* Didn't fit?  Get more room. */\n\t\tif (l >= room) {\n\t\t\tif (l >= *mem_end - *mem_start)\n\t\t\t\tnamep = make_room(mem_start, mem_end, l+1, 1);\n\t\t\tcall_prom(\"package-to-path\", 3, 1, node, namep, l);\n\t\t}\n\t\tnamep[l] = '\\0';\n\n\t\t/* Fixup an Apple bug where they have bogus \\0 chars in the\n\t\t * middle of the path in some properties, and extract\n\t\t * the unit name (everything after the last '/').\n\t\t */\n\t\tfor (lp = p = namep, ep = namep + l; p < ep; p++) {\n\t\t\tif (*p == '/')\n\t\t\t\tlp = namep;\n\t\t\telse if (*p != 0)\n\t\t\t\t*lp++ = *p;\n\t\t}\n\t\t*lp = 0;\n\t\t*mem_start = ALIGN((unsigned long)lp + 1, 4);\n\t}\n\n\t/* get it again for debugging */\n\tpath = prom_scratch;\n\tmemset(path, 0, sizeof(prom_scratch));\n\tcall_prom(\"package-to-path\", 3, 1, node, path, sizeof(prom_scratch) - 1);\n\n\t/* get and store all properties */\n\tprev_name = \"\";\n\tsstart = (char *)dt_string_start;\n\tfor (;;) {\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name,\n\t\t\t      pname) != 1)\n\t\t\tbreak;\n\n \t\t/* skip \"name\" */\n\t\tif (prom_strcmp(pname, \"name\") == 0) {\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\n\t\t/* find string offset */\n\t\tsoff = dt_find_string(pname);\n\t\tif (soff == 0) {\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <%s>, node %s\\n\", pname, path);\n\t\t\tbreak;\n\t\t}\n\t\tprev_name = sstart + soff;\n\n\t\t/* get length */\n\t\tl = call_prom(\"getproplen\", 2, 1, node, pname);\n\n\t\t/* sanity checks */\n\t\tif (l == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\t/* push property head */\n\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\tdt_push_token(l, mem_start, mem_end);\n\t\tdt_push_token(soff, mem_start, mem_end);\n\n\t\t/* push property content */\n\t\tvalp = make_room(mem_start, mem_end, l, 4);\n\t\tcall_prom(\"getprop\", 4, 1, node, pname, valp, l);\n\t\t*mem_start = ALIGN(*mem_start, 4);\n\n\t\tif (!prom_strcmp(pname, \"phandle\"))\n\t\t\thas_phandle = 1;\n\t}\n\n\t/* Add a \"phandle\" property if none already exist */\n\tif (!has_phandle) {\n\t\tsoff = dt_find_string(\"phandle\");\n\t\tif (soff == 0)\n\t\t\tprom_printf(\"WARNING: Can't find string index for <phandle> node %s\\n\", path);\n\t\telse {\n\t\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\t\tdt_push_token(4, mem_start, mem_end);\n\t\t\tdt_push_token(soff, mem_start, mem_end);\n\t\t\tvalp = make_room(mem_start, mem_end, 4, 4);\n\t\t\t*(__be32 *)valp = cpu_to_be32(node);\n\t\t}\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_struct(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n\n\tdt_push_token(OF_DT_END_NODE, mem_start, mem_end);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "node"
          ],
          "line": 2652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_room",
          "args": [
            "mem_start",
            "mem_end",
            "4",
            "4"
          ],
          "line": 2651
        },
        "resolved": true,
        "details": {
          "function_name": "make_room",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2449-2477",
          "snippet": "static void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %lx...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define DEVTREE_CHUNK_SIZE\t0x100000"
          ],
          "globals_used": [
            "static unsigned long __prombss alloc_top;",
            "static unsigned long __prombss alloc_bottom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_bottom;\nstatic void __init;\n\nstatic void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %lx...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "soff",
            "mem_start",
            "mem_end"
          ],
          "line": 2650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "4",
            "mem_start",
            "mem_end"
          ],
          "line": 2649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "OF_DT_PROP",
            "mem_start",
            "mem_end"
          ],
          "line": 2648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"WARNING: Can't find string index for <phandle> node %s\\n\"",
            "path"
          ],
          "line": 2646
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dt_find_string",
          "args": [
            "\"phandle\""
          ],
          "line": 2644
        },
        "resolved": true,
        "details": {
          "function_name": "dt_find_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2484-2496",
          "snippet": "static unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (prom_strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += prom_strlen(s) + 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long __prombss dt_string_start, dt_string_end;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long __prombss dt_string_start, dt_string_end;\nstatic void __init;\n\nstatic unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (prom_strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += prom_strlen(s) + 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "pname",
            "\"phandle\""
          ],
          "line": 2638
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "*mem_start",
            "4"
          ],
          "line": 2636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "soff",
            "mem_start",
            "mem_end"
          ],
          "line": 2631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "l",
            "mem_start",
            "mem_end"
          ],
          "line": 2630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "OF_DT_PROP",
            "mem_start",
            "mem_end"
          ],
          "line": 2629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "path",
            "0",
            "sizeof(prom_scratch)"
          ],
          "line": 2595
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "122-147",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "(unsigned long)lp + 1",
            "4"
          ],
          "line": 2590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dt_push_token",
          "args": [
            "OF_DT_BEGIN_NODE",
            "mem_start",
            "mem_end"
          ],
          "line": 2562
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MAX_PROPERTY_NAME 64\n#define PROM_ERROR\t\t(-1u)\n#define __prombss __section(.bss.prominit)\n\nextern void copy_and_flush(unsigned long dest, unsigned long src,\n\t\t\t   unsigned long size, unsigned long offset);\nstatic char __prombss prom_scratch[256];\nstatic void __init;\n\nstatic void __init scan_dt_build_struct(phandle node, unsigned long *mem_start,\n\t\t\t\t\tunsigned long *mem_end)\n{\n\tphandle child;\n\tchar *namep, *prev_name, *sstart, *p, *ep, *lp, *path;\n\tunsigned long soff;\n\tunsigned char *valp;\n\tstatic char pname[MAX_PROPERTY_NAME] __prombss;\n\tint l, room, has_phandle = 0;\n\n\tdt_push_token(OF_DT_BEGIN_NODE, mem_start, mem_end);\n\n\t/* get the node's full name */\n\tnamep = (char *)*mem_start;\n\troom = *mem_end - *mem_start;\n\tif (room > 255)\n\t\troom = 255;\n\tl = call_prom(\"package-to-path\", 3, 1, node, namep, room);\n\tif (l >= 0) {\n\t\t/* Didn't fit?  Get more room. */\n\t\tif (l >= room) {\n\t\t\tif (l >= *mem_end - *mem_start)\n\t\t\t\tnamep = make_room(mem_start, mem_end, l+1, 1);\n\t\t\tcall_prom(\"package-to-path\", 3, 1, node, namep, l);\n\t\t}\n\t\tnamep[l] = '\\0';\n\n\t\t/* Fixup an Apple bug where they have bogus \\0 chars in the\n\t\t * middle of the path in some properties, and extract\n\t\t * the unit name (everything after the last '/').\n\t\t */\n\t\tfor (lp = p = namep, ep = namep + l; p < ep; p++) {\n\t\t\tif (*p == '/')\n\t\t\t\tlp = namep;\n\t\t\telse if (*p != 0)\n\t\t\t\t*lp++ = *p;\n\t\t}\n\t\t*lp = 0;\n\t\t*mem_start = ALIGN((unsigned long)lp + 1, 4);\n\t}\n\n\t/* get it again for debugging */\n\tpath = prom_scratch;\n\tmemset(path, 0, sizeof(prom_scratch));\n\tcall_prom(\"package-to-path\", 3, 1, node, path, sizeof(prom_scratch) - 1);\n\n\t/* get and store all properties */\n\tprev_name = \"\";\n\tsstart = (char *)dt_string_start;\n\tfor (;;) {\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name,\n\t\t\t      pname) != 1)\n\t\t\tbreak;\n\n \t\t/* skip \"name\" */\n\t\tif (prom_strcmp(pname, \"name\") == 0) {\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\n\t\t/* find string offset */\n\t\tsoff = dt_find_string(pname);\n\t\tif (soff == 0) {\n\t\t\tprom_printf(\"WARNING: Can't find string index for\"\n\t\t\t\t    \" <%s>, node %s\\n\", pname, path);\n\t\t\tbreak;\n\t\t}\n\t\tprev_name = sstart + soff;\n\n\t\t/* get length */\n\t\tl = call_prom(\"getproplen\", 2, 1, node, pname);\n\n\t\t/* sanity checks */\n\t\tif (l == PROM_ERROR)\n\t\t\tcontinue;\n\n\t\t/* push property head */\n\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\tdt_push_token(l, mem_start, mem_end);\n\t\tdt_push_token(soff, mem_start, mem_end);\n\n\t\t/* push property content */\n\t\tvalp = make_room(mem_start, mem_end, l, 4);\n\t\tcall_prom(\"getprop\", 4, 1, node, pname, valp, l);\n\t\t*mem_start = ALIGN(*mem_start, 4);\n\n\t\tif (!prom_strcmp(pname, \"phandle\"))\n\t\t\thas_phandle = 1;\n\t}\n\n\t/* Add a \"phandle\" property if none already exist */\n\tif (!has_phandle) {\n\t\tsoff = dt_find_string(\"phandle\");\n\t\tif (soff == 0)\n\t\t\tprom_printf(\"WARNING: Can't find string index for <phandle> node %s\\n\", path);\n\t\telse {\n\t\t\tdt_push_token(OF_DT_PROP, mem_start, mem_end);\n\t\t\tdt_push_token(4, mem_start, mem_end);\n\t\t\tdt_push_token(soff, mem_start, mem_end);\n\t\t\tvalp = make_room(mem_start, mem_end, 4, 4);\n\t\t\t*(__be32 *)valp = cpu_to_be32(node);\n\t\t}\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_struct(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n\n\tdt_push_token(OF_DT_END_NODE, mem_start, mem_end);\n}"
  },
  {
    "function_name": "scan_dt_build_strings",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2504-2550",
    "snippet": "static void __init scan_dt_build_strings(phandle node,\n\t\t\t\t\t unsigned long *mem_start,\n\t\t\t\t\t unsigned long *mem_end)\n{\n\tchar *prev_name, *namep, *sstart;\n\tunsigned long soff;\n\tphandle child;\n\n\tsstart =  (char *)dt_string_start;\n\n\t/* get and store all property names */\n\tprev_name = \"\";\n\tfor (;;) {\n\t\t/* 64 is max len of name including nul. */\n\t\tnamep = make_room(mem_start, mem_end, MAX_PROPERTY_NAME, 1);\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name, namep) != 1) {\n\t\t\t/* No more nodes: unwind alloc */\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tbreak;\n\t\t}\n\n \t\t/* skip \"name\" */\n\t\tif (prom_strcmp(namep, \"name\") == 0) {\n \t\t\t*mem_start = (unsigned long)namep;\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\t\t/* get/create string entry */\n\t\tsoff = dt_find_string(namep);\n\t\tif (soff != 0) {\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tnamep = sstart + soff;\n\t\t} else {\n\t\t\t/* Trim off some if we can */\n\t\t\t*mem_start = (unsigned long)namep + prom_strlen(namep) + 1;\n\t\t\tdt_string_end = *mem_start;\n\t\t}\n\t\tprev_name = namep;\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_strings(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define MAX_PROPERTY_NAME 64"
    ],
    "globals_used": [
      "static unsigned long __prombss dt_string_start, dt_string_end;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"peer\"",
            "1",
            "1",
            "child"
          ],
          "line": 2548
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "scan_dt_build_strings",
          "args": [
            "child",
            "mem_start",
            "mem_end"
          ],
          "line": 2547
        },
        "resolved": true,
        "details": {
          "function_name": "scan_dt_build_strings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2504-2550",
          "snippet": "static void __init scan_dt_build_strings(phandle node,\n\t\t\t\t\t unsigned long *mem_start,\n\t\t\t\t\t unsigned long *mem_end)\n{\n\tchar *prev_name, *namep, *sstart;\n\tunsigned long soff;\n\tphandle child;\n\n\tsstart =  (char *)dt_string_start;\n\n\t/* get and store all property names */\n\tprev_name = \"\";\n\tfor (;;) {\n\t\t/* 64 is max len of name including nul. */\n\t\tnamep = make_room(mem_start, mem_end, MAX_PROPERTY_NAME, 1);\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name, namep) != 1) {\n\t\t\t/* No more nodes: unwind alloc */\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tbreak;\n\t\t}\n\n \t\t/* skip \"name\" */\n\t\tif (prom_strcmp(namep, \"name\") == 0) {\n \t\t\t*mem_start = (unsigned long)namep;\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\t\t/* get/create string entry */\n\t\tsoff = dt_find_string(namep);\n\t\tif (soff != 0) {\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tnamep = sstart + soff;\n\t\t} else {\n\t\t\t/* Trim off some if we can */\n\t\t\t*mem_start = (unsigned long)namep + prom_strlen(namep) + 1;\n\t\t\tdt_string_end = *mem_start;\n\t\t}\n\t\tprev_name = namep;\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_strings(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "prom_strlen",
          "args": [
            "namep"
          ],
          "line": 2538
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dt_find_string",
          "args": [
            "namep"
          ],
          "line": 2532
        },
        "resolved": true,
        "details": {
          "function_name": "dt_find_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2484-2496",
          "snippet": "static unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (prom_strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += prom_strlen(s) + 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long __prombss dt_string_start, dt_string_end;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long __prombss dt_string_start, dt_string_end;\nstatic void __init;\n\nstatic unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (prom_strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += prom_strlen(s) + 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "namep",
            "\"name\""
          ],
          "line": 2526
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_room",
          "args": [
            "mem_start",
            "mem_end",
            "MAX_PROPERTY_NAME",
            "1"
          ],
          "line": 2518
        },
        "resolved": true,
        "details": {
          "function_name": "make_room",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2449-2477",
          "snippet": "static void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %lx...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define DEVTREE_CHUNK_SIZE\t0x100000"
          ],
          "globals_used": [
            "static unsigned long __prombss alloc_top;",
            "static unsigned long __prombss alloc_bottom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_bottom;\nstatic void __init;\n\nstatic void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %lx...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MAX_PROPERTY_NAME 64\n\nstatic unsigned long __prombss dt_string_start, dt_string_end;\nstatic void __init;\n\nstatic void __init scan_dt_build_strings(phandle node,\n\t\t\t\t\t unsigned long *mem_start,\n\t\t\t\t\t unsigned long *mem_end)\n{\n\tchar *prev_name, *namep, *sstart;\n\tunsigned long soff;\n\tphandle child;\n\n\tsstart =  (char *)dt_string_start;\n\n\t/* get and store all property names */\n\tprev_name = \"\";\n\tfor (;;) {\n\t\t/* 64 is max len of name including nul. */\n\t\tnamep = make_room(mem_start, mem_end, MAX_PROPERTY_NAME, 1);\n\t\tif (call_prom(\"nextprop\", 3, 1, node, prev_name, namep) != 1) {\n\t\t\t/* No more nodes: unwind alloc */\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tbreak;\n\t\t}\n\n \t\t/* skip \"name\" */\n\t\tif (prom_strcmp(namep, \"name\") == 0) {\n \t\t\t*mem_start = (unsigned long)namep;\n \t\t\tprev_name = \"name\";\n \t\t\tcontinue;\n \t\t}\n\t\t/* get/create string entry */\n\t\tsoff = dt_find_string(namep);\n\t\tif (soff != 0) {\n\t\t\t*mem_start = (unsigned long)namep;\n\t\t\tnamep = sstart + soff;\n\t\t} else {\n\t\t\t/* Trim off some if we can */\n\t\t\t*mem_start = (unsigned long)namep + prom_strlen(namep) + 1;\n\t\t\tdt_string_end = *mem_start;\n\t\t}\n\t\tprev_name = namep;\n\t}\n\n\t/* do all our children */\n\tchild = call_prom(\"child\", 1, 1, node);\n\twhile (child != 0) {\n\t\tscan_dt_build_strings(child, mem_start, mem_end);\n\t\tchild = call_prom(\"peer\", 1, 1, child);\n\t}\n}"
  },
  {
    "function_name": "dt_find_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2484-2496",
    "snippet": "static unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (prom_strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += prom_strlen(s) + 1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long __prombss dt_string_start, dt_string_end;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_strlen",
          "args": [
            "s"
          ],
          "line": 2493
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "s",
            "str"
          ],
          "line": 2491
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long __prombss dt_string_start, dt_string_end;\nstatic void __init;\n\nstatic unsigned long __init dt_find_string(char *str)\n{\n\tchar *s, *os;\n\n\ts = os = (char *)dt_string_start;\n\ts += 4;\n\twhile (s <  (char *)dt_string_end) {\n\t\tif (prom_strcmp(s, str) == 0)\n\t\t\treturn s - os;\n\t\ts += prom_strlen(s) + 1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "make_room",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2449-2477",
    "snippet": "static void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %lx...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define DEVTREE_CHUNK_SIZE\t0x100000"
    ],
    "globals_used": [
      "static unsigned long __prombss alloc_top;",
      "static unsigned long __prombss alloc_bottom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\""
          ],
          "line": 2468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_up",
          "args": [
            "room",
            "0"
          ],
          "line": 2466
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_up",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1462-1500",
          "snippet": "static unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = ALIGN(base, align);\n\tprom_debug(\"%s(%lx, %lx)\\n\", __func__, size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = ALIGN(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = ALIGN(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss alloc_top;",
            "static unsigned long __prombss alloc_top_high;",
            "static unsigned long __prombss alloc_bottom;",
            "static unsigned long __prombss rmo_top;",
            "static unsigned long __prombss ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_top_high;\nstatic unsigned long __prombss alloc_bottom;\nstatic unsigned long __prombss rmo_top;\nstatic unsigned long __prombss ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = ALIGN(base, align);\n\tprom_debug(\"%s(%lx, %lx)\\n\", __func__, size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = ALIGN(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = ALIGN(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\""
          ],
          "line": 2464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Chunk exhausted, claiming more at %lx...\\n\"",
            "alloc_bottom"
          ],
          "line": 2458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "*mem_start",
            "align"
          ],
          "line": 2454
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define DEVTREE_CHUNK_SIZE\t0x100000\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_bottom;\nstatic void __init;\n\nstatic void __init *make_room(unsigned long *mem_start, unsigned long *mem_end,\n\t\t\t      unsigned long needed, unsigned long align)\n{\n\tvoid *ret;\n\n\t*mem_start = ALIGN(*mem_start, align);\n\twhile ((*mem_start + needed) > *mem_end) {\n\t\tunsigned long room, chunk;\n\n\t\tprom_debug(\"Chunk exhausted, claiming more at %lx...\\n\",\n\t\t\t   alloc_bottom);\n\t\troom = alloc_top - alloc_bottom;\n\t\tif (room > DEVTREE_CHUNK_SIZE)\n\t\t\troom = DEVTREE_CHUNK_SIZE;\n\t\tif (room < PAGE_SIZE)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(no room)\\n\");\n\t\tchunk = alloc_up(room, 0);\n\t\tif (chunk == 0)\n\t\t\tprom_panic(\"No memory for flatten_device_tree \"\n\t\t\t\t   \"(claim failed)\\n\");\n\t\t*mem_end = chunk + room;\n\t}\n\n\tret = (void *)*mem_start;\n\t*mem_start += needed;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "prom_check_displays",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2346-2445",
    "snippet": "static void __init prom_check_displays(void)\n{\n\tchar type[16], *path;\n\tphandle node;\n\tihandle ih;\n\tint i;\n\n\tstatic const unsigned char default_colors[] __initconst = {\n\t\t0x00, 0x00, 0x00,\n\t\t0x00, 0x00, 0xaa,\n\t\t0x00, 0xaa, 0x00,\n\t\t0x00, 0xaa, 0xaa,\n\t\t0xaa, 0x00, 0x00,\n\t\t0xaa, 0x00, 0xaa,\n\t\t0xaa, 0xaa, 0x00,\n\t\t0xaa, 0xaa, 0xaa,\n\t\t0x55, 0x55, 0x55,\n\t\t0x55, 0x55, 0xff,\n\t\t0x55, 0xff, 0x55,\n\t\t0x55, 0xff, 0xff,\n\t\t0xff, 0x55, 0x55,\n\t\t0xff, 0x55, 0xff,\n\t\t0xff, 0xff, 0x55,\n\t\t0xff, 0xff, 0xff\n\t};\n\tconst unsigned char *clut;\n\n\tprom_debug(\"Looking for displays\\n\");\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"display\") != 0)\n\t\t\tcontinue;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tpath = prom_scratch;\n\t\tmemset(path, 0, sizeof(prom_scratch));\n\n\t\t/*\n\t\t * leave some room at the end of the path for appending extra\n\t\t * arguments\n\t\t */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node, path,\n\t\t\t      sizeof(prom_scratch) - 10) == PROM_ERROR)\n\t\t\tcontinue;\n\t\tprom_printf(\"found display   : %s, opening... \", path);\n\t\t\n\t\tih = call_prom(\"open\", 1, 1, path);\n\t\tif (ih == 0) {\n\t\t\tprom_printf(\"failed\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Success */\n\t\tprom_printf(\"done\\n\");\n\t\tprom_setprop(node, path, \"linux,opened\", NULL, 0);\n\n\t\t/* Setup a usable color table when the appropriate\n\t\t * method is available. Should update this to set-colors */\n\t\tclut = default_colors;\n\t\tfor (i = 0; i < 16; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n\n#ifdef CONFIG_LOGO_LINUX_CLUT224\n\t\tclut = PTRRELOC(logo_linux_clut224.clut);\n\t\tfor (i = 0; i < logo_linux_clut224.clutsize; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i + 32, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n#endif /* CONFIG_LOGO_LINUX_CLUT224 */\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t\tif (prom_getprop(node, \"linux,boot-display\", NULL, 0) !=\n\t\t    PROM_ERROR) {\n\t\t\tu32 width, height, pitch, addr;\n\n\t\t\tprom_printf(\"Setting btext !\\n\");\n\n\t\t\tif (prom_getprop(node, \"width\", &width, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"height\", &height, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"linebytes\", &pitch, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"address\", &addr, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tprom_printf(\"W=%d H=%d LB=%d addr=0x%x\\n\",\n\t\t\t\t    width, height, pitch, addr);\n\t\t\tbtext_setup_display(width, height, 8, pitch, addr);\n\t\t\tbtext_prepare_BAT();\n\t\t}\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static char __prombss prom_scratch[256];",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "btext_prepare_BAT",
          "args": [],
          "line": 2441
        },
        "resolved": true,
        "details": {
          "function_name": "btext_prepare_BAT",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/btext.c",
          "lines": "87-112",
          "snippet": "void __init btext_prepare_BAT(void)\n{\n\tunsigned long vaddr = PAGE_OFFSET + 0x10000000;\n\tunsigned long addr;\n\tunsigned long lowbits;\n\n\taddr = (unsigned long)dispDeviceBase;\n\tif (!addr) {\n\t\tboot_text_mapped = 0;\n\t\treturn;\n\t}\n\tif (PVR_VER(mfspr(SPRN_PVR)) != 1) {\n\t\t/* 603, 604, G3, G4, ... */\n\t\tlowbits = addr & ~0xFF000000UL;\n\t\taddr &= 0xFF000000UL;\n\t\tdisp_BAT[0] = vaddr | (BL_16M<<2) | 2;\n\t\tdisp_BAT[1] = addr | (_PAGE_NO_CACHE | _PAGE_GUARDED | BPP_RW);\t\n\t} else {\n\t\t/* 601 */\n\t\tlowbits = addr & ~0xFF800000UL;\n\t\taddr &= 0xFF800000UL;\n\t\tdisp_BAT[0] = vaddr | (_PAGE_NO_CACHE | PP_RWXX) | 4;\n\t\tdisp_BAT[1] = addr | BL_8M | 0x40;\n\t}\n\tlogicalDisplayBase = (void *) (vaddr + lowbits);\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/btext.h>",
            "#include <asm/prom.h>",
            "#include <asm/sections.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned char *dispDeviceBase",
            "static unsigned char *logicalDisplayBase",
            "unsigned long disp_BAT[2] __initdata = {0, 0};",
            "int boot_text_mapped"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/btext.h>\n#include <asm/prom.h>\n#include <asm/sections.h>\n#include <linux/pgtable.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic unsigned char *dispDeviceBase;\nstatic unsigned char *logicalDisplayBase;\nunsigned long disp_BAT[2] __initdata = {0, 0};\nint boot_text_mapped;\n\nvoid __init btext_prepare_BAT(void)\n{\n\tunsigned long vaddr = PAGE_OFFSET + 0x10000000;\n\tunsigned long addr;\n\tunsigned long lowbits;\n\n\taddr = (unsigned long)dispDeviceBase;\n\tif (!addr) {\n\t\tboot_text_mapped = 0;\n\t\treturn;\n\t}\n\tif (PVR_VER(mfspr(SPRN_PVR)) != 1) {\n\t\t/* 603, 604, G3, G4, ... */\n\t\tlowbits = addr & ~0xFF000000UL;\n\t\taddr &= 0xFF000000UL;\n\t\tdisp_BAT[0] = vaddr | (BL_16M<<2) | 2;\n\t\tdisp_BAT[1] = addr | (_PAGE_NO_CACHE | _PAGE_GUARDED | BPP_RW);\t\n\t} else {\n\t\t/* 601 */\n\t\tlowbits = addr & ~0xFF800000UL;\n\t\taddr &= 0xFF800000UL;\n\t\tdisp_BAT[0] = vaddr | (_PAGE_NO_CACHE | PP_RWXX) | 4;\n\t\tdisp_BAT[1] = addr | BL_8M | 0x40;\n\t}\n\tlogicalDisplayBase = (void *) (vaddr + lowbits);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btext_setup_display",
          "args": [
            "width",
            "height",
            "8",
            "pitch",
            "addr"
          ],
          "line": 2440
        },
        "resolved": true,
        "details": {
          "function_name": "btext_setup_display",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/btext.c",
          "lines": "120-135",
          "snippet": "void __init btext_setup_display(int width, int height, int depth, int pitch,\n\t\t\t\tunsigned long address)\n{\n\tg_loc_X = 0;\n\tg_loc_Y = 0;\n\tg_max_loc_X = width / 8;\n\tg_max_loc_Y = height / 16;\n\tlogicalDisplayBase = (unsigned char *)address;\n\tdispDeviceBase = (unsigned char *)address;\n\tdispDeviceRowBytes = pitch;\n\tdispDeviceDepth = depth == 15 ? 16 : depth;\n\tdispDeviceRect[0] = dispDeviceRect[1] = 0;\n\tdispDeviceRect[2] = width;\n\tdispDeviceRect[3] = height;\n\tboot_text_mapped = 1;\n}",
          "includes": [
            "#include <asm/udbg.h>",
            "#include <asm/processor.h>",
            "#include <asm/io.h>",
            "#include <asm/mmu.h>",
            "#include <asm/page.h>",
            "#include <asm/btext.h>",
            "#include <asm/prom.h>",
            "#include <asm/sections.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/memblock.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int g_max_loc_X",
            "static int g_max_loc_Y",
            "static int dispDeviceRowBytes",
            "static int dispDeviceDepth",
            "static int dispDeviceRect[4]",
            "static unsigned char *dispDeviceBase",
            "static unsigned char *logicalDisplayBase",
            "int boot_text_mapped"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/udbg.h>\n#include <asm/processor.h>\n#include <asm/io.h>\n#include <asm/mmu.h>\n#include <asm/page.h>\n#include <asm/btext.h>\n#include <asm/prom.h>\n#include <asm/sections.h>\n#include <linux/pgtable.h>\n#include <linux/memblock.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic int g_max_loc_X;\nstatic int g_max_loc_Y;\nstatic int dispDeviceRowBytes;\nstatic int dispDeviceDepth;\nstatic int dispDeviceRect[4];\nstatic unsigned char *dispDeviceBase;\nstatic unsigned char *logicalDisplayBase;\nint boot_text_mapped;\n\nvoid __init btext_setup_display(int width, int height, int depth, int pitch,\n\t\t\t\tunsigned long address)\n{\n\tg_loc_X = 0;\n\tg_loc_Y = 0;\n\tg_max_loc_X = width / 8;\n\tg_max_loc_Y = height / 16;\n\tlogicalDisplayBase = (unsigned char *)address;\n\tdispDeviceBase = (unsigned char *)address;\n\tdispDeviceRowBytes = pitch;\n\tdispDeviceDepth = depth == 15 ? 16 : depth;\n\tdispDeviceRect[0] = dispDeviceRect[1] = 0;\n\tdispDeviceRect[2] = width;\n\tdispDeviceRect[3] = height;\n\tboot_text_mapped = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"W=%d H=%d LB=%d addr=0x%x\\n\"",
            "width",
            "height",
            "pitch",
            "addr"
          ],
          "line": 2438
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"address\"",
            "&addr",
            "4"
          ],
          "line": 2435
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_set_color",
          "args": [
            "ih",
            "i + 32",
            "clut[0]",
            "clut[1]",
            "clut[2]"
          ],
          "line": 2414
        },
        "resolved": true,
        "details": {
          "function_name": "prom_set_color",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "2333-2336",
          "snippet": "static int __init prom_set_color(ihandle ih, int i, int r, int g, int b)\n{\n\treturn call_prom(\"call-method\", 6, 1, ADDR(\"color!\"), ih, i, b, g, r);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_set_color(ihandle ih, int i, int r, int g, int b)\n{\n\treturn call_prom(\"call-method\", 6, 1, ADDR(\"color!\"), ih, i, b, g, r);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTRRELOC",
          "args": [
            "logo_linux_clut224.clut"
          ],
          "line": 2412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "node",
            "path",
            "\"linux,opened\"",
            "NULL",
            "0"
          ],
          "line": 2401
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"open\"",
            "1",
            "1",
            "path"
          ],
          "line": 2393
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "path",
            "0",
            "sizeof(prom_scratch)"
          ],
          "line": 2382
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "122-147",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "type",
            "\"display\""
          ],
          "line": 2377
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 2374
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "625-640",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Looking for displays\\n\""
          ],
          "line": 2373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic char __prombss prom_scratch[256];\nstatic void __init;\n\nstatic void __init prom_check_displays(void)\n{\n\tchar type[16], *path;\n\tphandle node;\n\tihandle ih;\n\tint i;\n\n\tstatic const unsigned char default_colors[] __initconst = {\n\t\t0x00, 0x00, 0x00,\n\t\t0x00, 0x00, 0xaa,\n\t\t0x00, 0xaa, 0x00,\n\t\t0x00, 0xaa, 0xaa,\n\t\t0xaa, 0x00, 0x00,\n\t\t0xaa, 0x00, 0xaa,\n\t\t0xaa, 0xaa, 0x00,\n\t\t0xaa, 0xaa, 0xaa,\n\t\t0x55, 0x55, 0x55,\n\t\t0x55, 0x55, 0xff,\n\t\t0x55, 0xff, 0x55,\n\t\t0x55, 0xff, 0xff,\n\t\t0xff, 0x55, 0x55,\n\t\t0xff, 0x55, 0xff,\n\t\t0xff, 0xff, 0x55,\n\t\t0xff, 0xff, 0xff\n\t};\n\tconst unsigned char *clut;\n\n\tprom_debug(\"Looking for displays\\n\");\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"display\") != 0)\n\t\t\tcontinue;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tpath = prom_scratch;\n\t\tmemset(path, 0, sizeof(prom_scratch));\n\n\t\t/*\n\t\t * leave some room at the end of the path for appending extra\n\t\t * arguments\n\t\t */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node, path,\n\t\t\t      sizeof(prom_scratch) - 10) == PROM_ERROR)\n\t\t\tcontinue;\n\t\tprom_printf(\"found display   : %s, opening... \", path);\n\t\t\n\t\tih = call_prom(\"open\", 1, 1, path);\n\t\tif (ih == 0) {\n\t\t\tprom_printf(\"failed\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Success */\n\t\tprom_printf(\"done\\n\");\n\t\tprom_setprop(node, path, \"linux,opened\", NULL, 0);\n\n\t\t/* Setup a usable color table when the appropriate\n\t\t * method is available. Should update this to set-colors */\n\t\tclut = default_colors;\n\t\tfor (i = 0; i < 16; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n\n#ifdef CONFIG_LOGO_LINUX_CLUT224\n\t\tclut = PTRRELOC(logo_linux_clut224.clut);\n\t\tfor (i = 0; i < logo_linux_clut224.clutsize; i++, clut += 3)\n\t\t\tif (prom_set_color(ih, i + 32, clut[0], clut[1],\n\t\t\t\t\t   clut[2]) != 0)\n\t\t\t\tbreak;\n#endif /* CONFIG_LOGO_LINUX_CLUT224 */\n\n#ifdef CONFIG_PPC_EARLY_DEBUG_BOOTX\n\t\tif (prom_getprop(node, \"linux,boot-display\", NULL, 0) !=\n\t\t    PROM_ERROR) {\n\t\t\tu32 width, height, pitch, addr;\n\n\t\t\tprom_printf(\"Setting btext !\\n\");\n\n\t\t\tif (prom_getprop(node, \"width\", &width, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"height\", &height, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"linebytes\", &pitch, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tif (prom_getprop(node, \"address\", &addr, 4) == PROM_ERROR)\n\t\t\t\treturn;\n\n\t\t\tprom_printf(\"W=%d H=%d LB=%d addr=0x%x\\n\",\n\t\t\t\t    width, height, pitch, addr);\n\t\t\tbtext_setup_display(width, height, 8, pitch, addr);\n\t\t\tbtext_prepare_BAT();\n\t\t}\n#endif /* CONFIG_PPC_EARLY_DEBUG_BOOTX */\n\t}\n}"
  },
  {
    "function_name": "prom_set_color",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2333-2336",
    "snippet": "static int __init prom_set_color(ihandle ih, int i, int r, int g, int b)\n{\n\treturn call_prom(\"call-method\", 6, 1, ADDR(\"color!\"), ih, i, b, g, r);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"call-method\"",
            "6",
            "1",
            "ADDR(\"color!\")",
            "ih",
            "i",
            "b",
            "g",
            "r"
          ],
          "line": 2335
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"color!\""
          ],
          "line": 2335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_set_color(ihandle ih, int i, int r, int g, int b)\n{\n\treturn call_prom(\"call-method\", 6, 1, ADDR(\"color!\"), ih, i, b, g, r);\n}"
  },
  {
    "function_name": "prom_find_machine_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2270-2331",
    "snippet": "static int __init prom_find_machine_type(void)\n{\n\tchar compat[256];\n\tint len, i = 0;\n#ifdef CONFIG_PPC64\n\tphandle rtas;\n\tint x;\n#endif\n\n\t/* Look for a PowerMac or a Cell */\n\tlen = prom_getprop(prom.root, \"compatible\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len > 0) {\n\t\tcompat[len] = 0;\n\t\twhile (i < len) {\n\t\t\tchar *p = &compat[i];\n\t\t\tint sl = prom_strlen(p);\n\t\t\tif (sl == 0)\n\t\t\t\tbreak;\n\t\t\tif (prom_strstr(p, \"Power Macintosh\") ||\n\t\t\t    prom_strstr(p, \"MacRISC\"))\n\t\t\t\treturn PLATFORM_POWERMAC;\n#ifdef CONFIG_PPC64\n\t\t\t/* We must make sure we don't detect the IBM Cell\n\t\t\t * blades as pSeries due to some firmware issues,\n\t\t\t * so we do it here.\n\t\t\t */\n\t\t\tif (prom_strstr(p, \"IBM,CBEA\") ||\n\t\t\t    prom_strstr(p, \"IBM,CPBW-1.0\"))\n\t\t\t\treturn PLATFORM_GENERIC;\n#endif /* CONFIG_PPC64 */\n\t\t\ti += sl + 1;\n\t\t}\n\t}\n#ifdef CONFIG_PPC64\n\t/* Try to figure out if it's an IBM pSeries or any other\n\t * PAPR compliant platform. We assume it is if :\n\t *  - /device_type is \"chrp\" (please, do NOT use that for future\n\t *    non-IBM designs !\n\t *  - it has /rtas\n\t */\n\tlen = prom_getprop(prom.root, \"device_type\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len <= 0)\n\t\treturn PLATFORM_GENERIC;\n\tif (prom_strcmp(compat, \"chrp\"))\n\t\treturn PLATFORM_GENERIC;\n\n\t/* Default to pSeries. We need to know if we are running LPAR */\n\trtas = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tif (!PHANDLE_VALID(rtas))\n\t\treturn PLATFORM_GENERIC;\n\tx = prom_getproplen(rtas, \"ibm,hypertas-functions\");\n\tif (x != PROM_ERROR) {\n\t\tprom_debug(\"Hypertas detected, assuming LPAR !\\n\");\n\t\treturn PLATFORM_PSERIES_LPAR;\n\t}\n\treturn PLATFORM_PSERIES;\n#else\n\treturn PLATFORM_GENERIC;\n#endif\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)",
      "#define PLATFORM_GENERIC\t0x0500",
      "#define PLATFORM_POWERMAC\t0x0400",
      "#define PLATFORM_PSERIES_LPAR\t0x0101",
      "#define PLATFORM_PSERIES\t0x0100"
    ],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Hypertas detected, assuming LPAR !\\n\""
          ],
          "line": 2324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "rtas",
            "\"ibm,hypertas-functions\""
          ],
          "line": 2322
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "649-652",
          "snippet": "static inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "rtas"
          ],
          "line": 2320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(\"/rtas\")"
          ],
          "line": 2319
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/rtas\""
          ],
          "line": 2319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "compat",
            "\"chrp\""
          ],
          "line": 2315
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "prom.root",
            "\"device_type\"",
            "compat",
            "sizeof(compat)-1"
          ],
          "line": 2311
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strstr",
          "args": [
            "p",
            "\"IBM,CPBW-1.0\""
          ],
          "line": 2298
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "290-305",
          "snippet": "static char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strlen",
          "args": [
            "p"
          ],
          "line": 2286
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n#define PLATFORM_GENERIC\t0x0500\n#define PLATFORM_POWERMAC\t0x0400\n#define PLATFORM_PSERIES_LPAR\t0x0101\n#define PLATFORM_PSERIES\t0x0100\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic int __init prom_find_machine_type(void)\n{\n\tchar compat[256];\n\tint len, i = 0;\n#ifdef CONFIG_PPC64\n\tphandle rtas;\n\tint x;\n#endif\n\n\t/* Look for a PowerMac or a Cell */\n\tlen = prom_getprop(prom.root, \"compatible\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len > 0) {\n\t\tcompat[len] = 0;\n\t\twhile (i < len) {\n\t\t\tchar *p = &compat[i];\n\t\t\tint sl = prom_strlen(p);\n\t\t\tif (sl == 0)\n\t\t\t\tbreak;\n\t\t\tif (prom_strstr(p, \"Power Macintosh\") ||\n\t\t\t    prom_strstr(p, \"MacRISC\"))\n\t\t\t\treturn PLATFORM_POWERMAC;\n#ifdef CONFIG_PPC64\n\t\t\t/* We must make sure we don't detect the IBM Cell\n\t\t\t * blades as pSeries due to some firmware issues,\n\t\t\t * so we do it here.\n\t\t\t */\n\t\t\tif (prom_strstr(p, \"IBM,CBEA\") ||\n\t\t\t    prom_strstr(p, \"IBM,CPBW-1.0\"))\n\t\t\t\treturn PLATFORM_GENERIC;\n#endif /* CONFIG_PPC64 */\n\t\t\ti += sl + 1;\n\t\t}\n\t}\n#ifdef CONFIG_PPC64\n\t/* Try to figure out if it's an IBM pSeries or any other\n\t * PAPR compliant platform. We assume it is if :\n\t *  - /device_type is \"chrp\" (please, do NOT use that for future\n\t *    non-IBM designs !\n\t *  - it has /rtas\n\t */\n\tlen = prom_getprop(prom.root, \"device_type\",\n\t\t\t   compat, sizeof(compat)-1);\n\tif (len <= 0)\n\t\treturn PLATFORM_GENERIC;\n\tif (prom_strcmp(compat, \"chrp\"))\n\t\treturn PLATFORM_GENERIC;\n\n\t/* Default to pSeries. We need to know if we are running LPAR */\n\trtas = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tif (!PHANDLE_VALID(rtas))\n\t\treturn PLATFORM_GENERIC;\n\tx = prom_getproplen(rtas, \"ibm,hypertas-functions\");\n\tif (x != PROM_ERROR) {\n\t\tprom_debug(\"Hypertas detected, assuming LPAR !\\n\");\n\t\treturn PLATFORM_PSERIES_LPAR;\n\t}\n\treturn PLATFORM_PSERIES;\n#else\n\treturn PLATFORM_GENERIC;\n#endif\n}"
  },
  {
    "function_name": "prom_init_stdout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2238-2268",
    "snippet": "static void __init prom_init_stdout(void)\n{\n\tchar *path = of_stdout_device;\n\tchar type[16];\n\tphandle stdout_node;\n\t__be32 val;\n\n\tif (prom_getprop(prom.chosen, \"stdout\", &val, sizeof(val)) <= 0)\n\t\tprom_panic(\"cannot find stdout\");\n\n\tprom.stdout = be32_to_cpu(val);\n\n\t/* Get the full OF pathname of the stdout device */\n\tmemset(path, 0, 256);\n\tcall_prom(\"instance-to-path\", 3, 1, prom.stdout, path, 255);\n\tprom_printf(\"OF stdout device is: %s\\n\", of_stdout_device);\n\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-path\",\n\t\t     path, prom_strlen(path) + 1);\n\n\t/* instance-to-package fails on PA-Semi */\n\tstdout_node = call_prom(\"instance-to-package\", 1, 1, prom.stdout);\n\tif (stdout_node != PROM_ERROR) {\n\t\tval = cpu_to_be32(stdout_node);\n\n\t\t/* If it's a display, note it */\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(stdout_node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"display\") == 0)\n\t\t\tprom_setprop(stdout_node, path, \"linux,boot-display\", NULL, 0);\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static char __prombss of_stdout_device[256];",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "stdout_node",
            "path",
            "\"linux,boot-display\"",
            "NULL",
            "0"
          ],
          "line": 2266
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "type",
            "\"display\""
          ],
          "line": 2265
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "stdout_node",
            "\"device_type\"",
            "type",
            "sizeof(type)"
          ],
          "line": 2264
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "type",
            "0",
            "sizeof(type)"
          ],
          "line": 2263
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "122-147",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "stdout_node"
          ],
          "line": 2260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"instance-to-package\"",
            "1",
            "1",
            "prom.stdout"
          ],
          "line": 2258
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strlen",
          "args": [
            "path"
          ],
          "line": 2255
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"OF stdout device is: %s\\n\"",
            "of_stdout_device"
          ],
          "line": 2253
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 2248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"cannot find stdout\""
          ],
          "line": 2246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic struct prom_t __prombss prom;\nstatic char __prombss of_stdout_device[256];\nstatic void __init;\n\nstatic void __init prom_init_stdout(void)\n{\n\tchar *path = of_stdout_device;\n\tchar type[16];\n\tphandle stdout_node;\n\t__be32 val;\n\n\tif (prom_getprop(prom.chosen, \"stdout\", &val, sizeof(val)) <= 0)\n\t\tprom_panic(\"cannot find stdout\");\n\n\tprom.stdout = be32_to_cpu(val);\n\n\t/* Get the full OF pathname of the stdout device */\n\tmemset(path, 0, 256);\n\tcall_prom(\"instance-to-path\", 3, 1, prom.stdout, path, 255);\n\tprom_printf(\"OF stdout device is: %s\\n\", of_stdout_device);\n\tprom_setprop(prom.chosen, \"/chosen\", \"linux,stdout-path\",\n\t\t     path, prom_strlen(path) + 1);\n\n\t/* instance-to-package fails on PA-Semi */\n\tstdout_node = call_prom(\"instance-to-package\", 1, 1, prom.stdout);\n\tif (stdout_node != PROM_ERROR) {\n\t\tval = cpu_to_be32(stdout_node);\n\n\t\t/* If it's a display, note it */\n\t\tmemset(type, 0, sizeof(type));\n\t\tprom_getprop(stdout_node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"display\") == 0)\n\t\t\tprom_setprop(stdout_node, path, \"linux,boot-display\", NULL, 0);\n\t}\n}"
  },
  {
    "function_name": "prom_find_mmu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2208-2233",
    "snippet": "static void __init prom_find_mmu(void)\n{\n\tphandle oprom;\n\tchar version[64];\n\n\toprom = call_prom(\"finddevice\", 1, 1, ADDR(\"/openprom\"));\n\tif (!PHANDLE_VALID(oprom))\n\t\treturn;\n\tif (prom_getprop(oprom, \"model\", version, sizeof(version)) <= 0)\n\t\treturn;\n\tversion[sizeof(version) - 1] = 0;\n\t/* XXX might need to add other versions here */\n\tif (prom_strcmp(version, \"Open Firmware, 1.0.5\") == 0)\n\t\tof_workarounds = OF_WA_CLAIM;\n\telse if (prom_strncmp(version, \"FirmWorks,3.\", 12) == 0) {\n\t\tof_workarounds = OF_WA_CLAIM | OF_WA_LONGTRAIL;\n\t\tcall_prom(\"interpret\", 1, 1, \"dev /memory 0 to allow-reclaim\");\n\t} else\n\t\treturn;\n\tprom.memory = call_prom(\"open\", 1, 1, ADDR(\"/memory\"));\n\tprom_getprop(prom.chosen, \"mmu\", &prom.mmumap,\n\t\t     sizeof(prom.mmumap));\n\tprom.mmumap = be32_to_cpu(prom.mmumap);\n\tif (!IHANDLE_VALID(prom.memory) || !IHANDLE_VALID(prom.mmumap))\n\t\tof_workarounds &= ~OF_WA_CLAIM;\t\t/* hmmm */\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
      "#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */"
    ],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "IHANDLE_VALID",
          "args": [
            "prom.mmumap"
          ],
          "line": 2231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IHANDLE_VALID",
          "args": [
            "prom.memory"
          ],
          "line": 2231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "prom.mmumap"
          ],
          "line": 2230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "prom.chosen",
            "\"mmu\"",
            "&prom.mmumap",
            "sizeof(prom.mmumap)"
          ],
          "line": 2228
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"open\"",
            "1",
            "1",
            "ADDR(\"/memory\")"
          ],
          "line": 2227
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/memory\""
          ],
          "line": 2227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_strncmp",
          "args": [
            "version",
            "\"FirmWorks,3.\"",
            "12"
          ],
          "line": 2222
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "254-268",
          "snippet": "static int __init prom_strncmp(const char *cs, const char *ct, size_t count)\n{\n\tunsigned char c1, c2;\n\n\twhile (count) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t\tcount--;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strncmp(const char *cs, const char *ct, size_t count)\n{\n\tunsigned char c1, c2;\n\n\twhile (count) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t\tcount--;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "version",
            "\"Open Firmware, 1.0.5\""
          ],
          "line": 2220
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "oprom"
          ],
          "line": 2214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/openprom\""
          ],
          "line": 2213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_find_mmu(void)\n{\n\tphandle oprom;\n\tchar version[64];\n\n\toprom = call_prom(\"finddevice\", 1, 1, ADDR(\"/openprom\"));\n\tif (!PHANDLE_VALID(oprom))\n\t\treturn;\n\tif (prom_getprop(oprom, \"model\", version, sizeof(version)) <= 0)\n\t\treturn;\n\tversion[sizeof(version) - 1] = 0;\n\t/* XXX might need to add other versions here */\n\tif (prom_strcmp(version, \"Open Firmware, 1.0.5\") == 0)\n\t\tof_workarounds = OF_WA_CLAIM;\n\telse if (prom_strncmp(version, \"FirmWorks,3.\", 12) == 0) {\n\t\tof_workarounds = OF_WA_CLAIM | OF_WA_LONGTRAIL;\n\t\tcall_prom(\"interpret\", 1, 1, \"dev /memory 0 to allow-reclaim\");\n\t} else\n\t\treturn;\n\tprom.memory = call_prom(\"open\", 1, 1, ADDR(\"/memory\"));\n\tprom_getprop(prom.chosen, \"mmu\", &prom.mmumap,\n\t\t     sizeof(prom.mmumap));\n\tprom.mmumap = be32_to_cpu(prom.mmumap);\n\tif (!IHANDLE_VALID(prom.memory) || !IHANDLE_VALID(prom.mmumap))\n\t\tof_workarounds &= ~OF_WA_CLAIM;\t\t/* hmmm */\n}"
  },
  {
    "function_name": "prom_init_client_services",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2184-2200",
    "snippet": "static void __init prom_init_client_services(unsigned long pp)\n{\n\t/* Get a handle to the prom entry point before anything else */\n\tprom_entry = pp;\n\n\t/* get a handle for the stdout device */\n\tprom.chosen = call_prom(\"finddevice\", 1, 1, ADDR(\"/chosen\"));\n\tif (!PHANDLE_VALID(prom.chosen))\n\t\tprom_panic(\"cannot find chosen\"); /* msg won't be printed :( */\n\n\t/* get device tree root */\n\tprom.root = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(prom.root))\n\t\tprom_panic(\"cannot find device tree root\"); /* msg won't be printed :( */\n\n\tprom.mmumap = 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static unsigned long __prombss prom_entry;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"cannot find device tree root\""
          ],
          "line": 2197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "prom.root"
          ],
          "line": 2196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(\"/\")"
          ],
          "line": 2195
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/\""
          ],
          "line": 2195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"cannot find chosen\""
          ],
          "line": 2192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "prom.chosen"
          ],
          "line": 2191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/chosen\""
          ],
          "line": 2190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic void __init prom_init_client_services(unsigned long pp)\n{\n\t/* Get a handle to the prom entry point before anything else */\n\tprom_entry = pp;\n\n\t/* get a handle for the stdout device */\n\tprom.chosen = call_prom(\"finddevice\", 1, 1, ADDR(\"/chosen\"));\n\tif (!PHANDLE_VALID(prom.chosen))\n\t\tprom_panic(\"cannot find chosen\"); /* msg won't be printed :( */\n\n\t/* get device tree root */\n\tprom.root = call_prom(\"finddevice\", 1, 1, ADDR(\"/\"));\n\tif (!PHANDLE_VALID(prom.root))\n\t\tprom_panic(\"cannot find device tree root\"); /* msg won't be printed :( */\n\n\tprom.mmumap = 0;\n}"
  },
  {
    "function_name": "prom_hold_cpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "2094-2181",
    "snippet": "static void __init prom_hold_cpus(void)\n{\n\tunsigned long i;\n\tphandle node;\n\tchar type[64];\n\tunsigned long *spinloop\n\t\t= (void *) LOW_ADDR(__secondary_hold_spinloop);\n\tunsigned long *acknowledge\n\t\t= (void *) LOW_ADDR(__secondary_hold_acknowledge);\n\tunsigned long secondary_hold = LOW_ADDR(__secondary_hold);\n\n\t/*\n\t * On pseries, if RTAS supports \"query-cpu-stopped-state\",\n\t * we skip this stage, the CPUs will be started by the\n\t * kernel using RTAS.\n\t */\n\tif ((of_platform == PLATFORM_PSERIES ||\n\t     of_platform == PLATFORM_PSERIES_LPAR) &&\n\t    rtas_has_query_cpu_stopped) {\n\t\tprom_printf(\"prom_hold_cpus: skipped\\n\");\n\t\treturn;\n\t}\n\n\tprom_debug(\"prom_hold_cpus: start...\\n\");\n\tprom_debug(\"    1) spinloop       = 0x%lx\\n\", (unsigned long)spinloop);\n\tprom_debug(\"    1) *spinloop      = 0x%lx\\n\", *spinloop);\n\tprom_debug(\"    1) acknowledge    = 0x%lx\\n\",\n\t\t   (unsigned long)acknowledge);\n\tprom_debug(\"    1) *acknowledge   = 0x%lx\\n\", *acknowledge);\n\tprom_debug(\"    1) secondary_hold = 0x%lx\\n\", secondary_hold);\n\n\t/* Set the common spinloop variable, so all of the secondary cpus\n\t * will block when they are awakened from their OF spinloop.\n\t * This must occur for both SMP and non SMP kernels, since OF will\n\t * be trashed when we move the kernel.\n\t */\n\t*spinloop = 0;\n\n\t/* look for cpus */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tunsigned int cpu_no;\n\t\t__be32 reg;\n\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"cpu\") != 0)\n\t\t\tcontinue;\n\n\t\t/* Skip non-configured cpus. */\n\t\tif (prom_getprop(node, \"status\", type, sizeof(type)) > 0)\n\t\t\tif (prom_strcmp(type, \"okay\") != 0)\n\t\t\t\tcontinue;\n\n\t\treg = cpu_to_be32(-1); /* make sparse happy */\n\t\tprom_getprop(node, \"reg\", &reg, sizeof(reg));\n\t\tcpu_no = be32_to_cpu(reg);\n\n\t\tprom_debug(\"cpu hw idx   = %u\\n\", cpu_no);\n\n\t\t/* Init the acknowledge var which will be reset by\n\t\t * the secondary cpu when it awakens from its OF\n\t\t * spinloop.\n\t\t */\n\t\t*acknowledge = (unsigned long)-1;\n\n\t\tif (cpu_no != prom.cpu) {\n\t\t\t/* Primary Thread of non-boot cpu or any thread */\n\t\t\tprom_printf(\"starting cpu hw idx %u... \", cpu_no);\n\t\t\tcall_prom(\"start-cpu\", 3, 0, node,\n\t\t\t\t  secondary_hold, cpu_no);\n\n\t\t\tfor (i = 0; (i < 100000000) && \n\t\t\t     (*acknowledge == ((unsigned long)-1)); i++ )\n\t\t\t\tmb();\n\n\t\t\tif (*acknowledge == cpu_no)\n\t\t\t\tprom_printf(\"done\\n\");\n\t\t\telse\n\t\t\t\tprom_printf(\"failed: %lx\\n\", *acknowledge);\n\t\t}\n#ifdef CONFIG_SMP\n\t\telse\n\t\t\tprom_printf(\"boot cpu hw idx %u\\n\", cpu_no);\n#endif /* CONFIG_SMP */\n\t}\n\n\tprom_debug(\"prom_hold_cpus: end...\\n\");\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PLATFORM_PSERIES_LPAR\t0x0101",
      "#define PLATFORM_PSERIES\t0x0100"
    ],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static int __prombss of_platform;",
      "static bool  __prombss rtas_has_query_cpu_stopped;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_hold_cpus: end...\\n\""
          ],
          "line": 2180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"failed: %lx\\n\"",
            "*acknowledge"
          ],
          "line": 2172
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb",
          "args": [],
          "line": 2167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"start-cpu\"",
            "3",
            "0",
            "node",
            "secondary_hold",
            "cpu_no"
          ],
          "line": 2162
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"cpu hw idx   = %u\\n\"",
            "cpu_no"
          ],
          "line": 2151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "reg"
          ],
          "line": 2149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"reg\"",
            "&reg",
            "sizeof(reg)"
          ],
          "line": 2148
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "-1"
          ],
          "line": 2147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "type",
            "\"okay\""
          ],
          "line": 2144
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 2133
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "625-640",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    1) secondary_hold = 0x%lx\\n\"",
            "secondary_hold"
          ],
          "line": 2123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    1) *acknowledge   = 0x%lx\\n\"",
            "*acknowledge"
          ],
          "line": 2122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    1) acknowledge    = 0x%lx\\n\"",
            "(unsigned long)acknowledge"
          ],
          "line": 2120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    1) *spinloop      = 0x%lx\\n\"",
            "*spinloop"
          ],
          "line": 2119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    1) spinloop       = 0x%lx\\n\"",
            "(unsigned long)spinloop"
          ],
          "line": 2118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_hold_cpus: start...\\n\""
          ],
          "line": 2117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOW_ADDR",
          "args": [
            "__secondary_hold"
          ],
          "line": 2103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOW_ADDR",
          "args": [
            "__secondary_hold_acknowledge"
          ],
          "line": 2102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOW_ADDR",
          "args": [
            "__secondary_hold_spinloop"
          ],
          "line": 2100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PLATFORM_PSERIES_LPAR\t0x0101\n#define PLATFORM_PSERIES\t0x0100\n\nstatic struct prom_t __prombss prom;\nstatic int __prombss of_platform;\nstatic bool  __prombss rtas_has_query_cpu_stopped;\nstatic void __init;\n\nstatic void __init prom_hold_cpus(void)\n{\n\tunsigned long i;\n\tphandle node;\n\tchar type[64];\n\tunsigned long *spinloop\n\t\t= (void *) LOW_ADDR(__secondary_hold_spinloop);\n\tunsigned long *acknowledge\n\t\t= (void *) LOW_ADDR(__secondary_hold_acknowledge);\n\tunsigned long secondary_hold = LOW_ADDR(__secondary_hold);\n\n\t/*\n\t * On pseries, if RTAS supports \"query-cpu-stopped-state\",\n\t * we skip this stage, the CPUs will be started by the\n\t * kernel using RTAS.\n\t */\n\tif ((of_platform == PLATFORM_PSERIES ||\n\t     of_platform == PLATFORM_PSERIES_LPAR) &&\n\t    rtas_has_query_cpu_stopped) {\n\t\tprom_printf(\"prom_hold_cpus: skipped\\n\");\n\t\treturn;\n\t}\n\n\tprom_debug(\"prom_hold_cpus: start...\\n\");\n\tprom_debug(\"    1) spinloop       = 0x%lx\\n\", (unsigned long)spinloop);\n\tprom_debug(\"    1) *spinloop      = 0x%lx\\n\", *spinloop);\n\tprom_debug(\"    1) acknowledge    = 0x%lx\\n\",\n\t\t   (unsigned long)acknowledge);\n\tprom_debug(\"    1) *acknowledge   = 0x%lx\\n\", *acknowledge);\n\tprom_debug(\"    1) secondary_hold = 0x%lx\\n\", secondary_hold);\n\n\t/* Set the common spinloop variable, so all of the secondary cpus\n\t * will block when they are awakened from their OF spinloop.\n\t * This must occur for both SMP and non SMP kernels, since OF will\n\t * be trashed when we move the kernel.\n\t */\n\t*spinloop = 0;\n\n\t/* look for cpus */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tunsigned int cpu_no;\n\t\t__be32 reg;\n\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tif (prom_strcmp(type, \"cpu\") != 0)\n\t\t\tcontinue;\n\n\t\t/* Skip non-configured cpus. */\n\t\tif (prom_getprop(node, \"status\", type, sizeof(type)) > 0)\n\t\t\tif (prom_strcmp(type, \"okay\") != 0)\n\t\t\t\tcontinue;\n\n\t\treg = cpu_to_be32(-1); /* make sparse happy */\n\t\tprom_getprop(node, \"reg\", &reg, sizeof(reg));\n\t\tcpu_no = be32_to_cpu(reg);\n\n\t\tprom_debug(\"cpu hw idx   = %u\\n\", cpu_no);\n\n\t\t/* Init the acknowledge var which will be reset by\n\t\t * the secondary cpu when it awakens from its OF\n\t\t * spinloop.\n\t\t */\n\t\t*acknowledge = (unsigned long)-1;\n\n\t\tif (cpu_no != prom.cpu) {\n\t\t\t/* Primary Thread of non-boot cpu or any thread */\n\t\t\tprom_printf(\"starting cpu hw idx %u... \", cpu_no);\n\t\t\tcall_prom(\"start-cpu\", 3, 0, node,\n\t\t\t\t  secondary_hold, cpu_no);\n\n\t\t\tfor (i = 0; (i < 100000000) && \n\t\t\t     (*acknowledge == ((unsigned long)-1)); i++ )\n\t\t\t\tmb();\n\n\t\t\tif (*acknowledge == cpu_no)\n\t\t\t\tprom_printf(\"done\\n\");\n\t\t\telse\n\t\t\t\tprom_printf(\"failed: %lx\\n\", *acknowledge);\n\t\t}\n#ifdef CONFIG_SMP\n\t\telse\n\t\t\tprom_printf(\"boot cpu hw idx %u\\n\", cpu_no);\n#endif /* CONFIG_SMP */\n\t}\n\n\tprom_debug(\"prom_hold_cpus: end...\\n\");\n}"
  },
  {
    "function_name": "prom_initialize_tce_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1947-2066",
    "snippet": "static void __init prom_initialize_tce_table(void)\n{\n\tphandle node;\n\tihandle phb_node;\n\tchar compatible[64], type[64], model[64];\n\tchar *path = prom_scratch;\n\tu64 base, align;\n\tu32 minalign, minsize;\n\tu64 tce_entry, *tce_entryp;\n\tu64 local_alloc_top, local_alloc_bottom;\n\tu64 i;\n\n\tif (prom_iommu_off)\n\t\treturn;\n\n\tprom_debug(\"starting prom_initialize_tce_table\\n\");\n\n\t/* Cache current top of allocs so we reserve a single block */\n\tlocal_alloc_top = alloc_top_high;\n\tlocal_alloc_bottom = local_alloc_top;\n\n\t/* Search all nodes looking for PHBs. */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tcompatible[0] = 0;\n\t\ttype[0] = 0;\n\t\tmodel[0] = 0;\n\t\tprom_getprop(node, \"compatible\",\n\t\t\t     compatible, sizeof(compatible));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tprom_getprop(node, \"model\", model, sizeof(model));\n\n\t\tif ((type[0] == 0) || (prom_strstr(type, \"pci\") == NULL))\n\t\t\tcontinue;\n\n\t\t/* Keep the old logic intact to avoid regression. */\n\t\tif (compatible[0] != 0) {\n\t\t\tif ((prom_strstr(compatible, \"python\") == NULL) &&\n\t\t\t    (prom_strstr(compatible, \"Speedwagon\") == NULL) &&\n\t\t\t    (prom_strstr(compatible, \"Winnipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t} else if (model[0] != 0) {\n\t\t\tif ((prom_strstr(model, \"ython\") == NULL) &&\n\t\t\t    (prom_strstr(model, \"peedwagon\") == NULL) &&\n\t\t\t    (prom_strstr(model, \"innipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (prom_getprop(node, \"tce-table-minalign\", &minalign,\n\t\t\t\t sizeof(minalign)) == PROM_ERROR)\n\t\t\tminalign = 0;\n\t\tif (prom_getprop(node, \"tce-table-minsize\", &minsize,\n\t\t\t\t sizeof(minsize)) == PROM_ERROR)\n\t\t\tminsize = 4UL << 20;\n\n\t\t/*\n\t\t * Even though we read what OF wants, we just set the table\n\t\t * size to 4 MB.  This is enough to map 2GB of PCI DMA space.\n\t\t * By doing this, we avoid the pitfalls of trying to DMA to\n\t\t * MMIO space and the DMA alias hole.\n\t\t */\n\t\tminsize = 4UL << 20;\n\n\t\t/* Align to the greater of the align or size */\n\t\talign = max(minalign, minsize);\n\t\tbase = alloc_down(minsize, align, 1);\n\t\tif (base == 0)\n\t\t\tprom_panic(\"ERROR, cannot find space for TCE table.\\n\");\n\t\tif (base < local_alloc_bottom)\n\t\t\tlocal_alloc_bottom = base;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tmemset(path, 0, sizeof(prom_scratch));\n\t\t/* Call OF to setup the TCE hardware */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node,\n\t\t\t      path, sizeof(prom_scratch) - 1) == PROM_ERROR) {\n\t\t\tprom_printf(\"package-to-path failed\\n\");\n\t\t}\n\n\t\t/* Save away the TCE table attributes for later use. */\n\t\tprom_setprop(node, path, \"linux,tce-base\", &base, sizeof(base));\n\t\tprom_setprop(node, path, \"linux,tce-size\", &minsize, sizeof(minsize));\n\n\t\tprom_debug(\"TCE table: %s\\n\", path);\n\t\tprom_debug(\"\\tnode = 0x%x\\n\", node);\n\t\tprom_debug(\"\\tbase = 0x%llx\\n\", base);\n\t\tprom_debug(\"\\tsize = 0x%x\\n\", minsize);\n\n\t\t/* Initialize the table to have a one-to-one mapping\n\t\t * over the allocated size.\n\t\t */\n\t\ttce_entryp = (u64 *)base;\n\t\tfor (i = 0; i < (minsize >> 3) ;tce_entryp++, i++) {\n\t\t\ttce_entry = (i << PAGE_SHIFT);\n\t\t\ttce_entry |= 0x3;\n\t\t\t*tce_entryp = tce_entry;\n\t\t}\n\n\t\tprom_printf(\"opening PHB %s\", path);\n\t\tphb_node = call_prom(\"open\", 1, 1, path);\n\t\tif (phb_node == 0)\n\t\t\tprom_printf(\"... failed\\n\");\n\t\telse\n\t\t\tprom_printf(\"... done\\n\");\n\n\t\tcall_prom(\"call-method\", 6, 0, ADDR(\"set-64-bit-addressing\"),\n\t\t\t  phb_node, -1, minsize,\n\t\t\t  (u32) base, (u32) (base >> 32));\n\t\tcall_prom(\"close\", 1, 0, phb_node);\n\t}\n\n\treserve_mem(local_alloc_bottom, local_alloc_top - local_alloc_bottom);\n\n\t/* These are only really needed if there is a memory limit in\n\t * effect, but we don't know so export them always. */\n\tprom_tce_alloc_start = local_alloc_bottom;\n\tprom_tce_alloc_end = local_alloc_top;\n\n\t/* Flag the first invalid entry */\n\tprom_debug(\"ending prom_initialize_tce_table\\n\");\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static char __prombss prom_scratch[256];",
      "static unsigned long __prombss alloc_top_high;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"ending prom_initialize_tce_table\\n\""
          ],
          "line": 2065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_mem",
          "args": [
            "local_alloc_bottom",
            "local_alloc_top - local_alloc_bottom"
          ],
          "line": 2057
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1593-1614",
          "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = ALIGN(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8"
          ],
          "globals_used": [
            "static struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];",
            "static int __prombss mem_reserve_cnt;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];\nstatic int __prombss mem_reserve_cnt;\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = ALIGN(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"close\"",
            "1",
            "0",
            "phb_node"
          ],
          "line": 2054
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "base >> 32"
          ],
          "line": 2053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"set-64-bit-addressing\""
          ],
          "line": 2051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"... done\\n\""
          ],
          "line": 2049
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"\\tsize = 0x%x\\n\"",
            "minsize"
          ],
          "line": 2032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"\\tbase = 0x%llx\\n\"",
            "base"
          ],
          "line": 2031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"\\tnode = 0x%x\\n\"",
            "node"
          ],
          "line": 2030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"TCE table: %s\\n\"",
            "path"
          ],
          "line": 2029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "node",
            "path",
            "\"linux,tce-size\"",
            "&minsize",
            "sizeof(minsize)"
          ],
          "line": 2027
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "path",
            "0",
            "sizeof(prom_scratch)"
          ],
          "line": 2018
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "122-147",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"ERROR, cannot find space for TCE table.\\n\""
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_down",
          "args": [
            "minsize",
            "align",
            "1"
          ],
          "line": 2011
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_down",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1507-1559",
          "snippet": "static unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"%s(%lx, %lx, %s)\\n\", __func__, size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss alloc_top;",
            "static unsigned long __prombss alloc_top_high;",
            "static unsigned long __prombss alloc_bottom;",
            "static unsigned long __prombss rmo_top;",
            "static unsigned long __prombss ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_top_high;\nstatic unsigned long __prombss alloc_bottom;\nstatic unsigned long __prombss rmo_top;\nstatic unsigned long __prombss ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"%s(%lx, %lx, %s)\\n\", __func__, size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "minalign",
            "minsize"
          ],
          "line": 2010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"tce-table-minsize\"",
            "&minsize",
            "sizeof(minsize)"
          ],
          "line": 1997
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strstr",
          "args": [
            "model",
            "\"innipeg\""
          ],
          "line": 1990
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "290-305",
          "snippet": "static char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 1969
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "625-640",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"starting prom_initialize_tce_table\\n\""
          ],
          "line": 1962
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic char __prombss prom_scratch[256];\nstatic unsigned long __prombss alloc_top_high;\nstatic void __init;\n\nstatic void __init prom_initialize_tce_table(void)\n{\n\tphandle node;\n\tihandle phb_node;\n\tchar compatible[64], type[64], model[64];\n\tchar *path = prom_scratch;\n\tu64 base, align;\n\tu32 minalign, minsize;\n\tu64 tce_entry, *tce_entryp;\n\tu64 local_alloc_top, local_alloc_bottom;\n\tu64 i;\n\n\tif (prom_iommu_off)\n\t\treturn;\n\n\tprom_debug(\"starting prom_initialize_tce_table\\n\");\n\n\t/* Cache current top of allocs so we reserve a single block */\n\tlocal_alloc_top = alloc_top_high;\n\tlocal_alloc_bottom = local_alloc_top;\n\n\t/* Search all nodes looking for PHBs. */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\tcompatible[0] = 0;\n\t\ttype[0] = 0;\n\t\tmodel[0] = 0;\n\t\tprom_getprop(node, \"compatible\",\n\t\t\t     compatible, sizeof(compatible));\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\t\tprom_getprop(node, \"model\", model, sizeof(model));\n\n\t\tif ((type[0] == 0) || (prom_strstr(type, \"pci\") == NULL))\n\t\t\tcontinue;\n\n\t\t/* Keep the old logic intact to avoid regression. */\n\t\tif (compatible[0] != 0) {\n\t\t\tif ((prom_strstr(compatible, \"python\") == NULL) &&\n\t\t\t    (prom_strstr(compatible, \"Speedwagon\") == NULL) &&\n\t\t\t    (prom_strstr(compatible, \"Winnipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t} else if (model[0] != 0) {\n\t\t\tif ((prom_strstr(model, \"ython\") == NULL) &&\n\t\t\t    (prom_strstr(model, \"peedwagon\") == NULL) &&\n\t\t\t    (prom_strstr(model, \"innipeg\") == NULL))\n\t\t\t\tcontinue;\n\t\t}\n\n\t\tif (prom_getprop(node, \"tce-table-minalign\", &minalign,\n\t\t\t\t sizeof(minalign)) == PROM_ERROR)\n\t\t\tminalign = 0;\n\t\tif (prom_getprop(node, \"tce-table-minsize\", &minsize,\n\t\t\t\t sizeof(minsize)) == PROM_ERROR)\n\t\t\tminsize = 4UL << 20;\n\n\t\t/*\n\t\t * Even though we read what OF wants, we just set the table\n\t\t * size to 4 MB.  This is enough to map 2GB of PCI DMA space.\n\t\t * By doing this, we avoid the pitfalls of trying to DMA to\n\t\t * MMIO space and the DMA alias hole.\n\t\t */\n\t\tminsize = 4UL << 20;\n\n\t\t/* Align to the greater of the align or size */\n\t\talign = max(minalign, minsize);\n\t\tbase = alloc_down(minsize, align, 1);\n\t\tif (base == 0)\n\t\t\tprom_panic(\"ERROR, cannot find space for TCE table.\\n\");\n\t\tif (base < local_alloc_bottom)\n\t\t\tlocal_alloc_bottom = base;\n\n\t\t/* It seems OF doesn't null-terminate the path :-( */\n\t\tmemset(path, 0, sizeof(prom_scratch));\n\t\t/* Call OF to setup the TCE hardware */\n\t\tif (call_prom(\"package-to-path\", 3, 1, node,\n\t\t\t      path, sizeof(prom_scratch) - 1) == PROM_ERROR) {\n\t\t\tprom_printf(\"package-to-path failed\\n\");\n\t\t}\n\n\t\t/* Save away the TCE table attributes for later use. */\n\t\tprom_setprop(node, path, \"linux,tce-base\", &base, sizeof(base));\n\t\tprom_setprop(node, path, \"linux,tce-size\", &minsize, sizeof(minsize));\n\n\t\tprom_debug(\"TCE table: %s\\n\", path);\n\t\tprom_debug(\"\\tnode = 0x%x\\n\", node);\n\t\tprom_debug(\"\\tbase = 0x%llx\\n\", base);\n\t\tprom_debug(\"\\tsize = 0x%x\\n\", minsize);\n\n\t\t/* Initialize the table to have a one-to-one mapping\n\t\t * over the allocated size.\n\t\t */\n\t\ttce_entryp = (u64 *)base;\n\t\tfor (i = 0; i < (minsize >> 3) ;tce_entryp++, i++) {\n\t\t\ttce_entry = (i << PAGE_SHIFT);\n\t\t\ttce_entry |= 0x3;\n\t\t\t*tce_entryp = tce_entry;\n\t\t}\n\n\t\tprom_printf(\"opening PHB %s\", path);\n\t\tphb_node = call_prom(\"open\", 1, 1, path);\n\t\tif (phb_node == 0)\n\t\t\tprom_printf(\"... failed\\n\");\n\t\telse\n\t\t\tprom_printf(\"... done\\n\");\n\n\t\tcall_prom(\"call-method\", 6, 0, ADDR(\"set-64-bit-addressing\"),\n\t\t\t  phb_node, -1, minsize,\n\t\t\t  (u32) base, (u32) (base >> 32));\n\t\tcall_prom(\"close\", 1, 0, phb_node);\n\t}\n\n\treserve_mem(local_alloc_bottom, local_alloc_top - local_alloc_bottom);\n\n\t/* These are only really needed if there is a memory limit in\n\t * effect, but we don't know so export them always. */\n\tprom_tce_alloc_start = local_alloc_bottom;\n\tprom_tce_alloc_end = local_alloc_top;\n\n\t/* Flag the first invalid entry */\n\tprom_debug(\"ending prom_initialize_tce_table\\n\");\n}"
  },
  {
    "function_name": "prom_instantiate_sml",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1869-1941",
    "snippet": "static void __init prom_instantiate_sml(void)\n{\n\tphandle ibmvtpm_node;\n\tihandle ibmvtpm_inst;\n\tu32 entry = 0, size = 0, succ = 0;\n\tu64 base;\n\t__be32 val;\n\n\tprom_debug(\"prom_instantiate_sml: start...\\n\");\n\n\tibmvtpm_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tprom_debug(\"ibmvtpm_node: %x\\n\", ibmvtpm_node);\n\tif (!PHANDLE_VALID(ibmvtpm_node))\n\t\treturn;\n\n\tibmvtpm_inst = call_prom(\"open\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tif (!IHANDLE_VALID(ibmvtpm_inst)) {\n\t\tprom_printf(\"opening vtpm package failed (%x)\\n\", ibmvtpm_inst);\n\t\treturn;\n\t}\n\n\tif (prom_getprop(ibmvtpm_node, \"ibm,sml-efi-reformat-supported\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR) {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &succ,\n\t\t\t\t  ADDR(\"reformat-sml-to-efi-alignment\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || succ == 0) {\n\t\t\tprom_printf(\"Reformat SML to EFI alignment failed\\n\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-allocated-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get allocated size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-handover-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get handover size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for sml\\n\");\n\n\tprom_printf(\"instantiating sml at 0x%llx...\", base);\n\n\tmemset((void *)base, 0, size);\n\n\tif (call_prom_ret(\"call-method\", 4, 2, &entry,\n\t\t\t  ADDR(\"sml-handover\"),\n\t\t\t  ibmvtpm_inst, size, base) != 0 || entry == 0) {\n\t\tprom_printf(\"SML handover failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-base\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-size\",\n\t\t     &size, sizeof(size));\n\n\tprom_debug(\"sml base     = 0x%llx\\n\", base);\n\tprom_debug(\"sml size     = 0x%x\\n\", size);\n\n\tprom_debug(\"prom_instantiate_sml: end...\\n\");\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_instantiate_sml: end...\\n\""
          ],
          "line": 1940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"sml size     = 0x%x\\n\"",
            "size"
          ],
          "line": 1938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"sml base     = 0x%llx\\n\"",
            "base"
          ],
          "line": 1937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "ibmvtpm_node",
            "\"/vdevice/vtpm\"",
            "\"linux,sml-size\"",
            "&size",
            "sizeof(size)"
          ],
          "line": 1934
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserve_mem",
          "args": [
            "base",
            "size"
          ],
          "line": 1930
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1593-1614",
          "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = ALIGN(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8"
          ],
          "globals_used": [
            "static struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];",
            "static int __prombss mem_reserve_cnt;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];\nstatic int __prombss mem_reserve_cnt;\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = ALIGN(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\" done\\n\""
          ],
          "line": 1928
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom_ret",
          "args": [
            "\"call-method\"",
            "4",
            "2",
            "&entry",
            "ADDR(\"sml-handover\")",
            "ibmvtpm_inst",
            "size",
            "base"
          ],
          "line": 1922
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"sml-handover\""
          ],
          "line": 1923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "(void *)base",
            "0",
            "size"
          ],
          "line": 1920
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "122-147",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Could not allocate memory for sml\\n\""
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_down",
          "args": [
            "size",
            "PAGE_SIZE",
            "0"
          ],
          "line": 1914
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_down",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1507-1559",
          "snippet": "static unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"%s(%lx, %lx, %s)\\n\", __func__, size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss alloc_top;",
            "static unsigned long __prombss alloc_top_high;",
            "static unsigned long __prombss alloc_bottom;",
            "static unsigned long __prombss rmo_top;",
            "static unsigned long __prombss ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_top_high;\nstatic unsigned long __prombss alloc_bottom;\nstatic unsigned long __prombss rmo_top;\nstatic unsigned long __prombss ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"%s(%lx, %lx, %s)\\n\", __func__, size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"sml-get-handover-size\""
          ],
          "line": 1907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"sml-get-allocated-size\""
          ],
          "line": 1900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"reformat-sml-to-efi-alignment\""
          ],
          "line": 1893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "ibmvtpm_node",
            "\"ibm,sml-efi-reformat-supported\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 1890
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IHANDLE_VALID",
          "args": [
            "ibmvtpm_inst"
          ],
          "line": 1885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/vdevice/vtpm\""
          ],
          "line": 1884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "ibmvtpm_node"
          ],
          "line": 1881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"ibmvtpm_node: %x\\n\"",
            "ibmvtpm_node"
          ],
          "line": 1880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/vdevice/vtpm\""
          ],
          "line": 1879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_instantiate_sml: start...\\n\""
          ],
          "line": 1877
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic void __init prom_instantiate_sml(void)\n{\n\tphandle ibmvtpm_node;\n\tihandle ibmvtpm_inst;\n\tu32 entry = 0, size = 0, succ = 0;\n\tu64 base;\n\t__be32 val;\n\n\tprom_debug(\"prom_instantiate_sml: start...\\n\");\n\n\tibmvtpm_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tprom_debug(\"ibmvtpm_node: %x\\n\", ibmvtpm_node);\n\tif (!PHANDLE_VALID(ibmvtpm_node))\n\t\treturn;\n\n\tibmvtpm_inst = call_prom(\"open\", 1, 1, ADDR(\"/vdevice/vtpm\"));\n\tif (!IHANDLE_VALID(ibmvtpm_inst)) {\n\t\tprom_printf(\"opening vtpm package failed (%x)\\n\", ibmvtpm_inst);\n\t\treturn;\n\t}\n\n\tif (prom_getprop(ibmvtpm_node, \"ibm,sml-efi-reformat-supported\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR) {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &succ,\n\t\t\t\t  ADDR(\"reformat-sml-to-efi-alignment\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || succ == 0) {\n\t\t\tprom_printf(\"Reformat SML to EFI alignment failed\\n\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-allocated-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get allocated size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\tif (call_prom_ret(\"call-method\", 2, 2, &size,\n\t\t\t\t  ADDR(\"sml-get-handover-size\"),\n\t\t\t\t  ibmvtpm_inst) != 0 || size == 0) {\n\t\t\tprom_printf(\"SML get handover size failed\\n\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for sml\\n\");\n\n\tprom_printf(\"instantiating sml at 0x%llx...\", base);\n\n\tmemset((void *)base, 0, size);\n\n\tif (call_prom_ret(\"call-method\", 4, 2, &entry,\n\t\t\t  ADDR(\"sml-handover\"),\n\t\t\t  ibmvtpm_inst, size, base) != 0 || entry == 0) {\n\t\tprom_printf(\"SML handover failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-base\",\n\t\t     &base, sizeof(base));\n\tprom_setprop(ibmvtpm_node, \"/vdevice/vtpm\", \"linux,sml-size\",\n\t\t     &size, sizeof(size));\n\n\tprom_debug(\"sml base     = 0x%llx\\n\", base);\n\tprom_debug(\"sml size     = 0x%x\\n\", size);\n\n\tprom_debug(\"prom_instantiate_sml: end...\\n\");\n}"
  },
  {
    "function_name": "prom_instantiate_rtas",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1802-1863",
    "snippet": "static void __init prom_instantiate_rtas(void)\n{\n\tphandle rtas_node;\n\tihandle rtas_inst;\n\tu32 base, entry = 0;\n\t__be32 val;\n\tu32 size = 0;\n\n\tprom_debug(\"prom_instantiate_rtas: start...\\n\");\n\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"rtas-size\", &val, sizeof(size));\n\tsize = be32_to_cpu(val);\n\tif (size == 0)\n\t\treturn;\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for RTAS\\n\");\n\n\trtas_inst = call_prom(\"open\", 1, 1, ADDR(\"/rtas\"));\n\tif (!IHANDLE_VALID(rtas_inst)) {\n\t\tprom_printf(\"opening rtas package failed (%x)\\n\", rtas_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating rtas at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 3, 2, &entry,\n\t\t\t  ADDR(\"instantiate-rtas\"),\n\t\t\t  rtas_inst, base) != 0\n\t    || entry == 0) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tval = cpu_to_be32(base);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-base\",\n\t\t     &val, sizeof(val));\n\tval = cpu_to_be32(entry);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-entry\",\n\t\t     &val, sizeof(val));\n\n\t/* Check if it supports \"query-cpu-stopped-state\" */\n\tif (prom_getprop(rtas_node, \"query-cpu-stopped-state\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR)\n\t\trtas_has_query_cpu_stopped = true;\n\n\tprom_debug(\"rtas base     = 0x%x\\n\", base);\n\tprom_debug(\"rtas entry    = 0x%x\\n\", entry);\n\tprom_debug(\"rtas size     = 0x%x\\n\", size);\n\n\tprom_debug(\"prom_instantiate_rtas: end...\\n\");\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static bool  __prombss rtas_has_query_cpu_stopped;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_instantiate_rtas: end...\\n\""
          ],
          "line": 1862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"rtas size     = 0x%x\\n\"",
            "size"
          ],
          "line": 1860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"rtas entry    = 0x%x\\n\"",
            "entry"
          ],
          "line": 1859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"rtas base     = 0x%x\\n\"",
            "base"
          ],
          "line": 1858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "rtas_node",
            "\"query-cpu-stopped-state\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 1854
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_setprop",
          "args": [
            "rtas_node",
            "\"/rtas\"",
            "\"linux,rtas-entry\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 1850
        },
        "resolved": true,
        "details": {
          "function_name": "prom_setprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "680-700",
          "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "entry"
          ],
          "line": 1849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "base"
          ],
          "line": 1846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reserve_mem",
          "args": [
            "base",
            "size"
          ],
          "line": 1844
        },
        "resolved": true,
        "details": {
          "function_name": "reserve_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1593-1614",
          "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = ALIGN(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define MEM_RESERVE_MAP_SIZE\t8"
          ],
          "globals_used": [
            "static struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];",
            "static int __prombss mem_reserve_cnt;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];\nstatic int __prombss mem_reserve_cnt;\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = ALIGN(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\" done\\n\""
          ],
          "line": 1842
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_prom_ret",
          "args": [
            "\"call-method\"",
            "3",
            "2",
            "&entry",
            "ADDR(\"instantiate-rtas\")",
            "rtas_inst",
            "base"
          ],
          "line": 1835
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"instantiate-rtas\""
          ],
          "line": 1836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IHANDLE_VALID",
          "args": [
            "rtas_inst"
          ],
          "line": 1828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/rtas\""
          ],
          "line": 1827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Could not allocate memory for RTAS\\n\""
          ],
          "line": 1825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_down",
          "args": [
            "size",
            "PAGE_SIZE",
            "0"
          ],
          "line": 1823
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_down",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1507-1559",
          "snippet": "static unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"%s(%lx, %lx, %s)\\n\", __func__, size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss alloc_top;",
            "static unsigned long __prombss alloc_top_high;",
            "static unsigned long __prombss alloc_bottom;",
            "static unsigned long __prombss rmo_top;",
            "static unsigned long __prombss ram_top;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_top_high;\nstatic unsigned long __prombss alloc_bottom;\nstatic unsigned long __prombss rmo_top;\nstatic unsigned long __prombss ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"%s(%lx, %lx, %s)\\n\", __func__, size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 1819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "rtas_node"
          ],
          "line": 1814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"rtas_node: %x\\n\"",
            "rtas_node"
          ],
          "line": 1813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/rtas\""
          ],
          "line": 1812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"prom_instantiate_rtas: start...\\n\""
          ],
          "line": 1810
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic bool  __prombss rtas_has_query_cpu_stopped;\nstatic void __init;\n\nstatic void __init prom_instantiate_rtas(void)\n{\n\tphandle rtas_node;\n\tihandle rtas_inst;\n\tu32 base, entry = 0;\n\t__be32 val;\n\tu32 size = 0;\n\n\tprom_debug(\"prom_instantiate_rtas: start...\\n\");\n\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"rtas-size\", &val, sizeof(size));\n\tsize = be32_to_cpu(val);\n\tif (size == 0)\n\t\treturn;\n\n\tbase = alloc_down(size, PAGE_SIZE, 0);\n\tif (base == 0)\n\t\tprom_panic(\"Could not allocate memory for RTAS\\n\");\n\n\trtas_inst = call_prom(\"open\", 1, 1, ADDR(\"/rtas\"));\n\tif (!IHANDLE_VALID(rtas_inst)) {\n\t\tprom_printf(\"opening rtas package failed (%x)\\n\", rtas_inst);\n\t\treturn;\n\t}\n\n\tprom_printf(\"instantiating rtas at 0x%x...\", base);\n\n\tif (call_prom_ret(\"call-method\", 3, 2, &entry,\n\t\t\t  ADDR(\"instantiate-rtas\"),\n\t\t\t  rtas_inst, base) != 0\n\t    || entry == 0) {\n\t\tprom_printf(\" failed\\n\");\n\t\treturn;\n\t}\n\tprom_printf(\" done\\n\");\n\n\treserve_mem(base, size);\n\n\tval = cpu_to_be32(base);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-base\",\n\t\t     &val, sizeof(val));\n\tval = cpu_to_be32(entry);\n\tprom_setprop(rtas_node, \"/rtas\", \"linux,rtas-entry\",\n\t\t     &val, sizeof(val));\n\n\t/* Check if it supports \"query-cpu-stopped-state\" */\n\tif (prom_getprop(rtas_node, \"query-cpu-stopped-state\",\n\t\t\t &val, sizeof(val)) != PROM_ERROR)\n\t\trtas_has_query_cpu_stopped = true;\n\n\tprom_debug(\"rtas base     = 0x%x\\n\", base);\n\tprom_debug(\"rtas entry    = 0x%x\\n\", entry);\n\tprom_debug(\"rtas size     = 0x%x\\n\", size);\n\n\tprom_debug(\"prom_instantiate_rtas: end...\\n\");\n}"
  },
  {
    "function_name": "prom_rtas_os_term",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1773-1796",
    "snippet": "static void __init prom_rtas_os_term(char *str)\n{\n\tphandle rtas_node;\n\t__be32 val;\n\tu32 token;\n\n\tprom_debug(\"%s: start...\\n\", __func__);\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"ibm,os-term\", &val, sizeof(val));\n\ttoken = be32_to_cpu(val);\n\tprom_debug(\"ibm,os-term: %x\\n\", token);\n\tif (token == 0)\n\t\tprom_panic(\"Could not get token for ibm,os-term\\n\");\n\tos_term_args.token = cpu_to_be32(token);\n\tos_term_args.nargs = cpu_to_be32(1);\n\tos_term_args.nret = cpu_to_be32(1);\n\tos_term_args.args[0] = cpu_to_be32(__pa(str));\n\tprom_rtas_hcall((uint64_t)&os_term_args);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_rtas_hcall",
          "args": [
            "(uint64_t)&os_term_args"
          ],
          "line": 1795
        },
        "resolved": true,
        "details": {
          "function_name": "prom_rtas_hcall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1760-1769",
          "snippet": "static int prom_rtas_hcall(uint64_t args)\n{\n\tregister uint64_t arg1 asm(\"r3\") = H_RTAS;\n\tregister uint64_t arg2 asm(\"r4\") = args;\n\n\tasm volatile(\"sc 1\\n\" : \"=r\" (arg1) :\n\t\t\t\"r\" (arg1),\n\t\t\t\"r\" (arg2) :);\n\treturn arg1;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int prom_rtas_hcall(uint64_t args)\n{\n\tregister uint64_t arg1 asm(\"r3\") = H_RTAS;\n\tregister uint64_t arg2 asm(\"r4\") = args;\n\n\tasm volatile(\"sc 1\\n\" : \"=r\" (arg1) :\n\t\t\t\"r\" (arg1),\n\t\t\t\"r\" (arg2) :);\n\treturn arg1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "__pa(str)"
          ],
          "line": 1794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "str"
          ],
          "line": 1794
        },
        "resolved": true,
        "details": {
          "function_name": "__parse_fpscr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/traps.c",
          "lines": "1164-1189",
          "snippet": "static inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/nmi.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/kprobes.h>",
            "#include <sysdev/fsl_pci.h>",
            "#include <asm/hmi.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/debug.h>",
            "#include <asm/tm.h>",
            "#include <asm/switch_to.h>",
            "#include <asm/fadump.h>",
            "#include <asm/rio.h>",
            "#include <asm/ppc-opcode.h>",
            "#include <asm/kexec.h>",
            "#include <asm/tm.h>",
            "#include <asm/processor.h>",
            "#include <asm/firmware.h>",
            "#include <asm/backlight.h>",
            "#include <asm/reg.h>",
            "#include <asm/pmc.h>",
            "#include <asm/rtas.h>",
            "#include <asm/machdep.h>",
            "#include <asm/io.h>",
            "#include <asm/debugfs.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/emulated_ops.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/console.h>",
            "#include <linux/smp.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/bug.h>",
            "#include <linux/backlight.h>",
            "#include <linux/kexec.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/delay.h>",
            "#include <linux/prctl.h>",
            "#include <linux/module.h>\t/* print_modules */",
            "#include <linux/extable.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/user.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/unistd.h>",
            "#include <linux/stddef.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/nmi.h>\n#include <asm/stacktrace.h>\n#include <asm/kprobes.h>\n#include <sysdev/fsl_pci.h>\n#include <asm/hmi.h>\n#include <asm/asm-prototypes.h>\n#include <asm/debug.h>\n#include <asm/tm.h>\n#include <asm/switch_to.h>\n#include <asm/fadump.h>\n#include <asm/rio.h>\n#include <asm/ppc-opcode.h>\n#include <asm/kexec.h>\n#include <asm/tm.h>\n#include <asm/processor.h>\n#include <asm/firmware.h>\n#include <asm/backlight.h>\n#include <asm/reg.h>\n#include <asm/pmc.h>\n#include <asm/rtas.h>\n#include <asm/machdep.h>\n#include <asm/io.h>\n#include <asm/debugfs.h>\n#include <linux/uaccess.h>\n#include <asm/emulated_ops.h>\n#include <linux/kmsg_dump.h>\n#include <linux/console.h>\n#include <linux/smp.h>\n#include <linux/context_tracking.h>\n#include <linux/ratelimit.h>\n#include <linux/kdebug.h>\n#include <linux/bug.h>\n#include <linux/backlight.h>\n#include <linux/kexec.h>\n#include <linux/kprobes.h>\n#include <linux/delay.h>\n#include <linux/prctl.h>\n#include <linux/module.h>\t/* print_modules */\n#include <linux/extable.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/user.h>\n#include <linux/ptrace.h>\n#include <linux/unistd.h>\n#include <linux/stddef.h>\n#include <linux/pkeys.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\nstatic inline int __parse_fpscr(unsigned long fpscr)\n{\n\tint ret = FPE_FLTUNK;\n\n\t/* Invalid operation */\n\tif ((fpscr & FPSCR_VE) && (fpscr & FPSCR_VX))\n\t\tret = FPE_FLTINV;\n\n\t/* Overflow */\n\telse if ((fpscr & FPSCR_OE) && (fpscr & FPSCR_OX))\n\t\tret = FPE_FLTOVF;\n\n\t/* Underflow */\n\telse if ((fpscr & FPSCR_UE) && (fpscr & FPSCR_UX))\n\t\tret = FPE_FLTUND;\n\n\t/* Divide by zero */\n\telse if ((fpscr & FPSCR_ZE) && (fpscr & FPSCR_ZX))\n\t\tret = FPE_FLTDIV;\n\n\t/* Inexact result */\n\telse if ((fpscr & FPSCR_XE) && (fpscr & FPSCR_XX))\n\t\tret = FPE_FLTRES;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "token"
          ],
          "line": 1791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Could not get token for ibm,os-term\\n\""
          ],
          "line": 1790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"ibm,os-term: %x\\n\"",
            "token"
          ],
          "line": 1788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 1787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "rtas_node",
            "\"ibm,os-term\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 1786
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PHANDLE_VALID",
          "args": [
            "rtas_node"
          ],
          "line": 1782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"rtas_node: %x\\n\"",
            "rtas_node"
          ],
          "line": 1781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"finddevice\"",
            "1",
            "1",
            "ADDR(\"/rtas\")"
          ],
          "line": 1780
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/rtas\""
          ],
          "line": 1780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"%s: start...\\n\"",
            "__func__"
          ],
          "line": 1779
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_rtas_os_term(char *str)\n{\n\tphandle rtas_node;\n\t__be32 val;\n\tu32 token;\n\n\tprom_debug(\"%s: start...\\n\", __func__);\n\trtas_node = call_prom(\"finddevice\", 1, 1, ADDR(\"/rtas\"));\n\tprom_debug(\"rtas_node: %x\\n\", rtas_node);\n\tif (!PHANDLE_VALID(rtas_node))\n\t\treturn;\n\n\tval = 0;\n\tprom_getprop(rtas_node, \"ibm,os-term\", &val, sizeof(val));\n\ttoken = be32_to_cpu(val);\n\tprom_debug(\"ibm,os-term: %x\\n\", token);\n\tif (token == 0)\n\t\tprom_panic(\"Could not get token for ibm,os-term\\n\");\n\tos_term_args.token = cpu_to_be32(token);\n\tos_term_args.nargs = cpu_to_be32(1);\n\tos_term_args.nret = cpu_to_be32(1);\n\tos_term_args.args[0] = cpu_to_be32(__pa(str));\n\tprom_rtas_hcall((uint64_t)&os_term_args);\n}"
  },
  {
    "function_name": "prom_rtas_hcall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1760-1769",
    "snippet": "static int prom_rtas_hcall(uint64_t args)\n{\n\tregister uint64_t arg1 asm(\"r3\") = H_RTAS;\n\tregister uint64_t arg2 asm(\"r4\") = args;\n\n\tasm volatile(\"sc 1\\n\" : \"=r\" (arg1) :\n\t\t\t\"r\" (arg1),\n\t\t\t\"r\" (arg2) :);\n\treturn arg1;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic int prom_rtas_hcall(uint64_t args)\n{\n\tregister uint64_t arg1 asm(\"r3\") = H_RTAS;\n\tregister uint64_t arg2 asm(\"r4\") = args;\n\n\tasm volatile(\"sc 1\\n\" : \"=r\" (arg1) :\n\t\t\t\"r\" (arg1),\n\t\t\t\"r\" (arg2) :);\n\treturn arg1;\n}"
  },
  {
    "function_name": "prom_close_stdin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1748-1757",
    "snippet": "static void __init prom_close_stdin(void)\n{\n\t__be32 val;\n\tihandle stdin;\n\n\tif (prom_getprop(prom.chosen, \"stdin\", &val, sizeof(val)) > 0) {\n\t\tstdin = be32_to_cpu(val);\n\t\tcall_prom(\"close\", 1, 0, stdin);\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"close\"",
            "1",
            "0",
            "stdin"
          ],
          "line": 1755
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 1754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "prom.chosen",
            "\"stdin\"",
            "&val",
            "sizeof(val)"
          ],
          "line": 1753
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_close_stdin(void)\n{\n\t__be32 val;\n\tihandle stdin;\n\n\tif (prom_getprop(prom.chosen, \"stdin\", &val, sizeof(val)) > 0) {\n\t\tstdin = be32_to_cpu(val);\n\t\tcall_prom(\"close\", 1, 0, stdin);\n\t}\n}"
  },
  {
    "function_name": "prom_init_mem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1620-1746",
    "snippet": "static void __init prom_init_mem(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\tcell_t *p, *endp;\n\t__be32 val;\n\tu32 rac, rsc;\n\n\t/*\n\t * We iterate the memory nodes to find\n\t * 1) top of RMO (first node)\n\t * 2) top of memory\n\t */\n\tval = cpu_to_be32(2);\n\tprom_getprop(prom.root, \"#address-cells\", &val, sizeof(val));\n\trac = be32_to_cpu(val);\n\tval = cpu_to_be32(1);\n\tprom_getprop(prom.root, \"#size-cells\", &val, sizeof(rsc));\n\trsc = be32_to_cpu(val);\n\tprom_debug(\"root_addr_cells: %x\\n\", rac);\n\tprom_debug(\"root_size_cells: %x\\n\", rsc);\n\n\tprom_debug(\"scanning memory:\\n\");\n\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (type[0] == 0) {\n\t\t\t/*\n\t\t\t * CHRP Longtrail machines have no device_type\n\t\t\t * on the memory node, so check the name instead...\n\t\t\t */\n\t\t\tprom_getprop(node, \"name\", type, sizeof(type));\n\t\t}\n\t\tif (prom_strcmp(type, \"memory\"))\n\t\t\tcontinue;\n\n\t\tplen = prom_getprop(node, \"reg\", regbuf, sizeof(regbuf));\n\t\tif (plen > sizeof(regbuf)) {\n\t\t\tprom_printf(\"memory node too large for buffer !\\n\");\n\t\t\tplen = sizeof(regbuf);\n\t\t}\n\t\tp = regbuf;\n\t\tendp = p + (plen / sizeof(cell_t));\n\n#ifdef DEBUG_PROM\n\t\tmemset(prom_scratch, 0, sizeof(prom_scratch));\n\t\tcall_prom(\"package-to-path\", 3, 1, node, prom_scratch,\n\t\t\t  sizeof(prom_scratch) - 1);\n\t\tprom_debug(\"  node %s :\\n\", prom_scratch);\n#endif /* DEBUG_PROM */\n\n\t\twhile ((endp - p) >= (rac + rsc)) {\n\t\t\tunsigned long base, size;\n\n\t\t\tbase = prom_next_cell(rac, &p);\n\t\t\tsize = prom_next_cell(rsc, &p);\n\n\t\t\tif (size == 0)\n\t\t\t\tcontinue;\n\t\t\tprom_debug(\"    %lx %lx\\n\", base, size);\n\t\t\tif (base == 0 && (of_platform & PLATFORM_LPAR))\n\t\t\t\trmo_top = size;\n\t\t\tif ((base + size) > ram_top)\n\t\t\t\tram_top = base + size;\n\t\t}\n\t}\n\n\talloc_bottom = PAGE_ALIGN((unsigned long)&_end + 0x4000);\n\n\t/*\n\t * If prom_memory_limit is set we reduce the upper limits *except* for\n\t * alloc_top_high. This must be the real top of RAM so we can put\n\t * TCE's up there.\n\t */\n\n\talloc_top_high = ram_top;\n\n\tif (prom_memory_limit) {\n\t\tif (prom_memory_limit <= alloc_bottom) {\n\t\t\tprom_printf(\"Ignoring mem=%lx <= alloc_bottom.\\n\",\n\t\t\t\t    prom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else if (prom_memory_limit >= ram_top) {\n\t\t\tprom_printf(\"Ignoring mem=%lx >= ram_top.\\n\",\n\t\t\t\t    prom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else {\n\t\t\tram_top = prom_memory_limit;\n\t\t\trmo_top = min(rmo_top, prom_memory_limit);\n\t\t}\n\t}\n\n\t/*\n\t * Setup our top alloc point, that is top of RMO or top of\n\t * segment 0 when running non-LPAR.\n\t * Some RS64 machines have buggy firmware where claims up at\n\t * 1GB fail.  Cap at 768MB as a workaround.\n\t * Since 768MB is plenty of room, and we need to cap to something\n\t * reasonable on 32-bit, cap at 768MB on all machines.\n\t */\n\tif (!rmo_top)\n\t\trmo_top = ram_top;\n\trmo_top = min(0x30000000ul, rmo_top);\n\talloc_top = rmo_top;\n\talloc_top_high = ram_top;\n\n\t/*\n\t * Check if we have an initrd after the kernel but still inside\n\t * the RMO.  If we do move our bottom point to after it.\n\t */\n\tif (prom_initrd_start &&\n\t    prom_initrd_start < rmo_top &&\n\t    prom_initrd_end > alloc_bottom)\n\t\talloc_bottom = PAGE_ALIGN(prom_initrd_end);\n\n\tprom_printf(\"memory layout at init:\\n\");\n\tprom_printf(\"  memory_limit : %lx (16 MB aligned)\\n\",\n\t\t    prom_memory_limit);\n\tprom_printf(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_printf(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_printf(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_printf(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_printf(\"  ram_top      : %lx\\n\", ram_top);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PLATFORM_LPAR\t\t0x0001"
    ],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static char __prombss prom_scratch[256];",
      "static unsigned long __prombss prom_initrd_start, prom_initrd_end;",
      "static int __prombss of_platform;",
      "static unsigned long __prombss prom_memory_limit;",
      "static unsigned long __prombss alloc_top;",
      "static unsigned long __prombss alloc_top_high;",
      "static unsigned long __prombss alloc_bottom;",
      "static unsigned long __prombss rmo_top;",
      "static unsigned long __prombss ram_top;",
      "static cell_t __prombss regbuf[1024];",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"  ram_top      : %lx\\n\"",
            "ram_top"
          ],
          "line": 1745
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "prom_initrd_end"
          ],
          "line": 1736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "0x30000000ul",
            "rmo_top"
          ],
          "line": 1725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "rmo_top",
            "prom_memory_limit"
          ],
          "line": 1711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "(unsigned long)&_end + 0x4000"
          ],
          "line": 1690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    %lx %lx\\n\"",
            "base",
            "size"
          ],
          "line": 1682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_next_cell",
          "args": [
            "rsc",
            "&p"
          ],
          "line": 1678
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_cell",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1564-1583",
          "snippet": "static unsigned long __init prom_next_cell(int s, cell_t **cellp)\n{\n\tcell_t *p = *cellp;\n\tunsigned long r = 0;\n\n\t/* Ignore more than 2 cells */\n\twhile (s > sizeof(unsigned long) / 4) {\n\t\tp++;\n\t\ts--;\n\t}\n\tr = be32_to_cpu(*p++);\n#ifdef CONFIG_PPC64\n\tif (s > 1) {\n\t\tr <<= 32;\n\t\tr |= be32_to_cpu(*(p++));\n\t}\n#endif\n\t*cellp = p;\n\treturn r;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic unsigned long __init prom_next_cell(int s, cell_t **cellp)\n{\n\tcell_t *p = *cellp;\n\tunsigned long r = 0;\n\n\t/* Ignore more than 2 cells */\n\twhile (s > sizeof(unsigned long) / 4) {\n\t\tp++;\n\t\ts--;\n\t}\n\tr = be32_to_cpu(*p++);\n#ifdef CONFIG_PPC64\n\tif (s > 1) {\n\t\tr <<= 32;\n\t\tr |= be32_to_cpu(*(p++));\n\t}\n#endif\n\t*cellp = p;\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  node %s :\\n\"",
            "prom_scratch"
          ],
          "line": 1671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"package-to-path\"",
            "3",
            "1",
            "node",
            "prom_scratch",
            "sizeof(prom_scratch) - 1"
          ],
          "line": 1669
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "prom_scratch",
            "0",
            "sizeof(prom_scratch)"
          ],
          "line": 1668
        },
        "resolved": true,
        "details": {
          "function_name": "_memset_io",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "122-147",
          "snippet": "notrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nnotrace void\n_memset_io(volatile void __iomem *addr, int c, unsigned long n)\n{\n\tvoid *p = (void __force *)addr;\n\tu32 lc = c;\n\tlc |= lc << 8;\n\tlc |= lc << 16;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && !IO_CHECK_ALIGN(p, 4)) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)p) = lc;\n\t\tp += 4;\n\t\tn -= 4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)p) = c;\n\t\tp++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"reg\"",
            "regbuf",
            "sizeof(regbuf)"
          ],
          "line": 1659
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "type",
            "\"memory\""
          ],
          "line": 1656
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 1645
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "625-640",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"scanning memory:\\n\""
          ],
          "line": 1643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"root_size_cells: %x\\n\"",
            "rsc"
          ],
          "line": 1641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"root_addr_cells: %x\\n\"",
            "rac"
          ],
          "line": 1640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 1639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1"
          ],
          "line": 1637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "val"
          ],
          "line": 1636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "2"
          ],
          "line": 1634
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PLATFORM_LPAR\t\t0x0001\n\nstatic struct prom_t __prombss prom;\nstatic char __prombss prom_scratch[256];\nstatic unsigned long __prombss prom_initrd_start, prom_initrd_end;\nstatic int __prombss of_platform;\nstatic unsigned long __prombss prom_memory_limit;\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_top_high;\nstatic unsigned long __prombss alloc_bottom;\nstatic unsigned long __prombss rmo_top;\nstatic unsigned long __prombss ram_top;\nstatic cell_t __prombss regbuf[1024];\nstatic void __init;\n\nstatic void __init prom_init_mem(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\tcell_t *p, *endp;\n\t__be32 val;\n\tu32 rac, rsc;\n\n\t/*\n\t * We iterate the memory nodes to find\n\t * 1) top of RMO (first node)\n\t * 2) top of memory\n\t */\n\tval = cpu_to_be32(2);\n\tprom_getprop(prom.root, \"#address-cells\", &val, sizeof(val));\n\trac = be32_to_cpu(val);\n\tval = cpu_to_be32(1);\n\tprom_getprop(prom.root, \"#size-cells\", &val, sizeof(rsc));\n\trsc = be32_to_cpu(val);\n\tprom_debug(\"root_addr_cells: %x\\n\", rac);\n\tprom_debug(\"root_size_cells: %x\\n\", rsc);\n\n\tprom_debug(\"scanning memory:\\n\");\n\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (type[0] == 0) {\n\t\t\t/*\n\t\t\t * CHRP Longtrail machines have no device_type\n\t\t\t * on the memory node, so check the name instead...\n\t\t\t */\n\t\t\tprom_getprop(node, \"name\", type, sizeof(type));\n\t\t}\n\t\tif (prom_strcmp(type, \"memory\"))\n\t\t\tcontinue;\n\n\t\tplen = prom_getprop(node, \"reg\", regbuf, sizeof(regbuf));\n\t\tif (plen > sizeof(regbuf)) {\n\t\t\tprom_printf(\"memory node too large for buffer !\\n\");\n\t\t\tplen = sizeof(regbuf);\n\t\t}\n\t\tp = regbuf;\n\t\tendp = p + (plen / sizeof(cell_t));\n\n#ifdef DEBUG_PROM\n\t\tmemset(prom_scratch, 0, sizeof(prom_scratch));\n\t\tcall_prom(\"package-to-path\", 3, 1, node, prom_scratch,\n\t\t\t  sizeof(prom_scratch) - 1);\n\t\tprom_debug(\"  node %s :\\n\", prom_scratch);\n#endif /* DEBUG_PROM */\n\n\t\twhile ((endp - p) >= (rac + rsc)) {\n\t\t\tunsigned long base, size;\n\n\t\t\tbase = prom_next_cell(rac, &p);\n\t\t\tsize = prom_next_cell(rsc, &p);\n\n\t\t\tif (size == 0)\n\t\t\t\tcontinue;\n\t\t\tprom_debug(\"    %lx %lx\\n\", base, size);\n\t\t\tif (base == 0 && (of_platform & PLATFORM_LPAR))\n\t\t\t\trmo_top = size;\n\t\t\tif ((base + size) > ram_top)\n\t\t\t\tram_top = base + size;\n\t\t}\n\t}\n\n\talloc_bottom = PAGE_ALIGN((unsigned long)&_end + 0x4000);\n\n\t/*\n\t * If prom_memory_limit is set we reduce the upper limits *except* for\n\t * alloc_top_high. This must be the real top of RAM so we can put\n\t * TCE's up there.\n\t */\n\n\talloc_top_high = ram_top;\n\n\tif (prom_memory_limit) {\n\t\tif (prom_memory_limit <= alloc_bottom) {\n\t\t\tprom_printf(\"Ignoring mem=%lx <= alloc_bottom.\\n\",\n\t\t\t\t    prom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else if (prom_memory_limit >= ram_top) {\n\t\t\tprom_printf(\"Ignoring mem=%lx >= ram_top.\\n\",\n\t\t\t\t    prom_memory_limit);\n\t\t\tprom_memory_limit = 0;\n\t\t} else {\n\t\t\tram_top = prom_memory_limit;\n\t\t\trmo_top = min(rmo_top, prom_memory_limit);\n\t\t}\n\t}\n\n\t/*\n\t * Setup our top alloc point, that is top of RMO or top of\n\t * segment 0 when running non-LPAR.\n\t * Some RS64 machines have buggy firmware where claims up at\n\t * 1GB fail.  Cap at 768MB as a workaround.\n\t * Since 768MB is plenty of room, and we need to cap to something\n\t * reasonable on 32-bit, cap at 768MB on all machines.\n\t */\n\tif (!rmo_top)\n\t\trmo_top = ram_top;\n\trmo_top = min(0x30000000ul, rmo_top);\n\talloc_top = rmo_top;\n\talloc_top_high = ram_top;\n\n\t/*\n\t * Check if we have an initrd after the kernel but still inside\n\t * the RMO.  If we do move our bottom point to after it.\n\t */\n\tif (prom_initrd_start &&\n\t    prom_initrd_start < rmo_top &&\n\t    prom_initrd_end > alloc_bottom)\n\t\talloc_bottom = PAGE_ALIGN(prom_initrd_end);\n\n\tprom_printf(\"memory layout at init:\\n\");\n\tprom_printf(\"  memory_limit : %lx (16 MB aligned)\\n\",\n\t\t    prom_memory_limit);\n\tprom_printf(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_printf(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_printf(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_printf(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_printf(\"  ram_top      : %lx\\n\", ram_top);\n}"
  },
  {
    "function_name": "reserve_mem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1593-1614",
    "snippet": "static void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = ALIGN(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define MEM_RESERVE_MAP_SIZE\t8"
    ],
    "globals_used": [
      "static struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];",
      "static int __prombss mem_reserve_cnt;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "size"
          ],
          "line": 1612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be64",
          "args": [
            "base"
          ],
          "line": 1611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"Memory reserve map exhausted !\\n\""
          ],
          "line": 1610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "top",
            "PAGE_SIZE"
          ],
          "line": 1606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN_DOWN",
          "args": [
            "base",
            "PAGE_SIZE"
          ],
          "line": 1605
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define MEM_RESERVE_MAP_SIZE\t8\n\nstatic struct mem_map_entry __prombss mem_reserve_map[MEM_RESERVE_MAP_SIZE];\nstatic int __prombss mem_reserve_cnt;\nstatic void __init;\n\nstatic void __init reserve_mem(u64 base, u64 size)\n{\n\tu64 top = base + size;\n\tunsigned long cnt = mem_reserve_cnt;\n\n\tif (size == 0)\n\t\treturn;\n\n\t/* We need to always keep one empty entry so that we\n\t * have our terminator with \"size\" set to 0 since we are\n\t * dumb and just copy this entire array to the boot params\n\t */\n\tbase = ALIGN_DOWN(base, PAGE_SIZE);\n\ttop = ALIGN(top, PAGE_SIZE);\n\tsize = top - base;\n\n\tif (cnt >= (MEM_RESERVE_MAP_SIZE - 1))\n\t\tprom_panic(\"Memory reserve map exhausted !\\n\");\n\tmem_reserve_map[cnt].base = cpu_to_be64(base);\n\tmem_reserve_map[cnt].size = cpu_to_be64(size);\n\tmem_reserve_cnt = cnt + 1;\n}"
  },
  {
    "function_name": "prom_next_cell",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1564-1583",
    "snippet": "static unsigned long __init prom_next_cell(int s, cell_t **cellp)\n{\n\tcell_t *p = *cellp;\n\tunsigned long r = 0;\n\n\t/* Ignore more than 2 cells */\n\twhile (s > sizeof(unsigned long) / 4) {\n\t\tp++;\n\t\ts--;\n\t}\n\tr = be32_to_cpu(*p++);\n#ifdef CONFIG_PPC64\n\tif (s > 1) {\n\t\tr <<= 32;\n\t\tr |= be32_to_cpu(*(p++));\n\t}\n#endif\n\t*cellp = p;\n\treturn r;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*(p++)"
          ],
          "line": 1578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*p++"
          ],
          "line": 1574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic unsigned long __init prom_next_cell(int s, cell_t **cellp)\n{\n\tcell_t *p = *cellp;\n\tunsigned long r = 0;\n\n\t/* Ignore more than 2 cells */\n\twhile (s > sizeof(unsigned long) / 4) {\n\t\tp++;\n\t\ts--;\n\t}\n\tr = be32_to_cpu(*p++);\n#ifdef CONFIG_PPC64\n\tif (s > 1) {\n\t\tr <<= 32;\n\t\tr |= be32_to_cpu(*(p++));\n\t}\n#endif\n\t*cellp = p;\n\treturn r;\n}"
  },
  {
    "function_name": "alloc_down",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1507-1559",
    "snippet": "static unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"%s(%lx, %lx, %s)\\n\", __func__, size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static unsigned long __prombss alloc_top;",
      "static unsigned long __prombss alloc_top_high;",
      "static unsigned long __prombss alloc_bottom;",
      "static unsigned long __prombss rmo_top;",
      "static unsigned long __prombss ram_top;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  ram_top      : %lx\\n\"",
            "ram_top"
          ],
          "line": 1556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  rmo_top      : %lx\\n\"",
            "rmo_top"
          ],
          "line": 1555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_top_hi : %lx\\n\"",
            "alloc_top_high"
          ],
          "line": 1554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_top    : %lx\\n\"",
            "alloc_top"
          ],
          "line": 1553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_bottom : %lx\\n\"",
            "alloc_bottom"
          ],
          "line": 1552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\" -> %lx\\n\"",
            "addr"
          ],
          "line": 1551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_claim",
          "args": [
            "base",
            "size",
            "0"
          ],
          "line": 1541
        },
        "resolved": true,
        "details": {
          "function_name": "prom_claim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "575-607",
          "snippet": "static unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    trying: 0x%lx\\n\\r\"",
            "base"
          ],
          "line": 1540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN_DOWN",
          "args": [
            "base - 0x100000",
            "align"
          ],
          "line": 1539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN_DOWN",
          "args": [
            "alloc_top - size",
            "align"
          ],
          "line": 1537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN_DOWN",
          "args": [
            "alloc_top_high - size",
            "align"
          ],
          "line": 1519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"alloc_down() called with mem not initialized\\n\""
          ],
          "line": 1515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"%s(%lx, %lx, %s)\\n\"",
            "__func__",
            "size",
            "align",
            "highmem ? \"(high)\" : \"(low)\""
          ],
          "line": 1512
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_top_high;\nstatic unsigned long __prombss alloc_bottom;\nstatic unsigned long __prombss rmo_top;\nstatic unsigned long __prombss ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_down(unsigned long size, unsigned long align,\n\t\t\t\t       int highmem)\n{\n\tunsigned long base, addr = 0;\n\n\tprom_debug(\"%s(%lx, %lx, %s)\\n\", __func__, size, align,\n\t\t   highmem ? \"(high)\" : \"(low)\");\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_down() called with mem not initialized\\n\");\n\n\tif (highmem) {\n\t\t/* Carve out storage for the TCE table. */\n\t\taddr = ALIGN_DOWN(alloc_top_high - size, align);\n\t\tif (addr <= alloc_bottom)\n\t\t\treturn 0;\n\t\t/* Will we bump into the RMO ? If yes, check out that we\n\t\t * didn't overlap existing allocations there, if we did,\n\t\t * we are dead, we must be the first in town !\n\t\t */\n\t\tif (addr < rmo_top) {\n\t\t\t/* Good, we are first */\n\t\t\tif (alloc_top == rmo_top)\n\t\t\t\talloc_top = rmo_top = addr;\n\t\t\telse\n\t\t\t\treturn 0;\n\t\t}\n\t\talloc_top_high = addr;\n\t\tgoto bail;\n\t}\n\n\tbase = ALIGN_DOWN(alloc_top - size, align);\n\tfor (; base > alloc_bottom;\n\t     base = ALIGN_DOWN(base - 0x100000, align))  {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_top = addr;\n\n bail:\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}"
  },
  {
    "function_name": "alloc_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1462-1500",
    "snippet": "static unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = ALIGN(base, align);\n\tprom_debug(\"%s(%lx, %lx)\\n\", __func__, size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = ALIGN(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = ALIGN(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static unsigned long __prombss alloc_top;",
      "static unsigned long __prombss alloc_top_high;",
      "static unsigned long __prombss alloc_bottom;",
      "static unsigned long __prombss rmo_top;",
      "static unsigned long __prombss ram_top;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  ram_top      : %lx\\n\"",
            "ram_top"
          ],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  rmo_top      : %lx\\n\"",
            "rmo_top"
          ],
          "line": 1496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_top_hi : %lx\\n\"",
            "alloc_top_high"
          ],
          "line": 1495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_top    : %lx\\n\"",
            "alloc_top"
          ],
          "line": 1494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"  alloc_bottom : %lx\\n\"",
            "alloc_bottom"
          ],
          "line": 1493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\" -> %lx\\n\"",
            "addr"
          ],
          "line": 1492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_claim",
          "args": [
            "base",
            "size",
            "0"
          ],
          "line": 1481
        },
        "resolved": true,
        "details": {
          "function_name": "prom_claim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "575-607",
          "snippet": "static unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */",
            "#define OF_WORKAROUNDS\tof_workarounds",
            "#define OF_WORKAROUNDS\t0"
          ],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"    trying: 0x%lx\\n\\r\"",
            "base"
          ],
          "line": 1480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "base + 0x100000",
            "align"
          ],
          "line": 1479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "alloc_bottom",
            "align"
          ],
          "line": 1474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_panic",
          "args": [
            "\"alloc_up() called with mem not initialized\\n\""
          ],
          "line": 1471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"%s(%lx, %lx)\\n\"",
            "__func__",
            "size",
            "align"
          ],
          "line": 1469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "base",
            "align"
          ],
          "line": 1468
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss alloc_top;\nstatic unsigned long __prombss alloc_top_high;\nstatic unsigned long __prombss alloc_bottom;\nstatic unsigned long __prombss rmo_top;\nstatic unsigned long __prombss ram_top;\nstatic void __init;\n\nstatic unsigned long __init alloc_up(unsigned long size, unsigned long align)\n{\n\tunsigned long base = alloc_bottom;\n\tunsigned long addr = 0;\n\n\tif (align)\n\t\tbase = ALIGN(base, align);\n\tprom_debug(\"%s(%lx, %lx)\\n\", __func__, size, align);\n\tif (ram_top == 0)\n\t\tprom_panic(\"alloc_up() called with mem not initialized\\n\");\n\n\tif (align)\n\t\tbase = ALIGN(alloc_bottom, align);\n\telse\n\t\tbase = alloc_bottom;\n\n\tfor(; (base + size) <= alloc_top; \n\t    base = ALIGN(base + 0x100000, align)) {\n\t\tprom_debug(\"    trying: 0x%lx\\n\\r\", base);\n\t\taddr = (unsigned long)prom_claim(base, size, 0);\n\t\tif (addr != PROM_ERROR && addr != 0)\n\t\t\tbreak;\n\t\taddr = 0;\n\t\tif (align == 0)\n\t\t\tbreak;\n\t}\n\tif (addr == 0)\n\t\treturn 0;\n\talloc_bottom = addr + size;\n\n\tprom_debug(\" -> %lx\\n\", addr);\n\tprom_debug(\"  alloc_bottom : %lx\\n\", alloc_bottom);\n\tprom_debug(\"  alloc_top    : %lx\\n\", alloc_top);\n\tprom_debug(\"  alloc_top_hi : %lx\\n\", alloc_top_high);\n\tprom_debug(\"  rmo_top      : %lx\\n\", rmo_top);\n\tprom_debug(\"  ram_top      : %lx\\n\", ram_top);\n\n\treturn addr;\n}"
  },
  {
    "function_name": "prom_send_capabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1368-1426",
    "snippet": "static void __init prom_send_capabilities(void)\n{\n\tihandle root;\n\tprom_arg_t ret;\n\tu32 cores;\n\n\t/* Check ibm,arch-vec-5-platform-support and fixup vec5 if required */\n\tprom_check_platform_support();\n\n\troot = call_prom(\"open\", 1, 1, ADDR(\"/\"));\n\tif (root != 0) {\n\t\t/* We need to tell the FW about the number of cores we support.\n\t\t *\n\t\t * To do that, we count the number of threads on the first core\n\t\t * (we assume this is the same for all cores) and use it to\n\t\t * divide NR_CPUS.\n\t\t */\n\n\t\tcores = DIV_ROUND_UP(NR_CPUS, prom_count_smt_threads());\n\t\tprom_printf(\"Max number of cores passed to firmware: %u (NR_CPUS = %d)\\n\",\n\t\t\t    cores, NR_CPUS);\n\n\t\tibm_architecture_vec.vec5.max_cpus = cpu_to_be32(cores);\n\n\t\t/* try calling the ibm,client-architecture-support method */\n\t\tprom_printf(\"Calling ibm,client-architecture-support...\");\n\t\tif (call_prom_ret(\"call-method\", 3, 2, &ret,\n\t\t\t\t  ADDR(\"ibm,client-architecture-support\"),\n\t\t\t\t  root,\n\t\t\t\t  ADDR(&ibm_architecture_vec)) == 0) {\n\t\t\t/* the call exists... */\n\t\t\tif (ret)\n\t\t\t\tprom_printf(\"\\nWARNING: ibm,client-architecture\"\n\t\t\t\t\t    \"-support call FAILED!\\n\");\n\t\t\tcall_prom(\"close\", 1, 0, root);\n\t\t\tprom_printf(\" done\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"close\", 1, 0, root);\n\t\tprom_printf(\" not implemented\\n\");\n\t}\n\n#ifdef __BIG_ENDIAN__\n\t{\n\t\tihandle elfloader;\n\n\t\t/* no ibm,client-architecture-support call, try the old way */\n\t\telfloader = call_prom(\"open\", 1, 1,\n\t\t\t\t      ADDR(\"/packages/elf-loader\"));\n\t\tif (elfloader == 0) {\n\t\t\tprom_printf(\"couldn't open /packages/elf-loader\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"call-method\", 3, 1, ADDR(\"process-elf-header\"),\n\t\t\t  elfloader, ADDR(&fake_elf));\n\t\tcall_prom(\"close\", 1, 0, elfloader);\n\t}\n#endif /* __BIG_ENDIAN__ */\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"close\"",
            "1",
            "0",
            "elfloader"
          ],
          "line": 1423
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "&fake_elf"
          ],
          "line": 1422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"process-elf-header\""
          ],
          "line": 1421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"couldn't open /packages/elf-loader\\n\""
          ],
          "line": 1418
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/packages/elf-loader\""
          ],
          "line": 1416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "&ibm_architecture_vec"
          ],
          "line": 1397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"ibm,client-architecture-support\""
          ],
          "line": 1395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "cores"
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "NR_CPUS",
            "prom_count_smt_threads()"
          ],
          "line": 1386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_count_smt_threads",
          "args": [],
          "line": 1386
        },
        "resolved": true,
        "details": {
          "function_name": "prom_count_smt_threads",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1190-1226",
          "snippet": "static int __init prom_count_smt_threads(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\n\t/* Pick up th first CPU node we can find */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (prom_strcmp(type, \"cpu\"))\n\t\t\tcontinue;\n\t\t/*\n\t\t * There is an entry for each smt thread, each entry being\n\t\t * 4 bytes long.  All cpus should have the same number of\n\t\t * smt threads, so return after finding the first.\n\t\t */\n\t\tplen = prom_getproplen(node, \"ibm,ppc-interrupt-server#s\");\n\t\tif (plen == PROM_ERROR)\n\t\t\tbreak;\n\t\tplen >>= 2;\n\t\tprom_debug(\"Found %lu smt threads per core\\n\", (unsigned long)plen);\n\n\t\t/* Sanity check */\n\t\tif (plen < 1 || plen > 64) {\n\t\t\tprom_printf(\"Threads per core %lu out of bounds, assuming 1\\n\",\n\t\t\t\t    (unsigned long)plen);\n\t\t\treturn 1;\n\t\t}\n\t\treturn plen;\n\t}\n\tprom_debug(\"No threads found, assuming 1 per core\\n\");\n\n\treturn 1;\n\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init prom_count_smt_threads(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\n\t/* Pick up th first CPU node we can find */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (prom_strcmp(type, \"cpu\"))\n\t\t\tcontinue;\n\t\t/*\n\t\t * There is an entry for each smt thread, each entry being\n\t\t * 4 bytes long.  All cpus should have the same number of\n\t\t * smt threads, so return after finding the first.\n\t\t */\n\t\tplen = prom_getproplen(node, \"ibm,ppc-interrupt-server#s\");\n\t\tif (plen == PROM_ERROR)\n\t\t\tbreak;\n\t\tplen >>= 2;\n\t\tprom_debug(\"Found %lu smt threads per core\\n\", (unsigned long)plen);\n\n\t\t/* Sanity check */\n\t\tif (plen < 1 || plen > 64) {\n\t\t\tprom_printf(\"Threads per core %lu out of bounds, assuming 1\\n\",\n\t\t\t\t    (unsigned long)plen);\n\t\t\treturn 1;\n\t\t}\n\t\treturn plen;\n\t}\n\tprom_debug(\"No threads found, assuming 1 per core\\n\");\n\n\treturn 1;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"/\""
          ],
          "line": 1377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_check_platform_support",
          "args": [],
          "line": 1375
        },
        "resolved": true,
        "details": {
          "function_name": "prom_check_platform_support",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1305-1366",
          "snippet": "static void __init prom_check_platform_support(void)\n{\n\tstruct platform_support supported = {\n\t\t.hash_mmu = false,\n\t\t.radix_mmu = false,\n\t\t.radix_gtse = false,\n\t\t.xive = false\n\t};\n\tint prop_len = prom_getproplen(prom.chosen,\n\t\t\t\t       \"ibm,arch-vec-5-platform-support\");\n\n\t/*\n\t * First copy the architecture vec template\n\t *\n\t * use memcpy() instead of *vec = *vec_template so that GCC replaces it\n\t * by __memcpy() when KASAN is active\n\t */\n\tmemcpy(&ibm_architecture_vec, &ibm_architecture_vec_template,\n\t       sizeof(ibm_architecture_vec));\n\n\tif (prop_len > 1) {\n\t\tint i;\n\t\tu8 vec[8];\n\t\tprom_debug(\"Found ibm,arch-vec-5-platform-support, len: %d\\n\",\n\t\t\t   prop_len);\n\t\tif (prop_len > sizeof(vec))\n\t\t\tprom_printf(\"WARNING: ibm,arch-vec-5-platform-support longer than expected (len: %d)\\n\",\n\t\t\t\t    prop_len);\n\t\tprom_getprop(prom.chosen, \"ibm,arch-vec-5-platform-support\",\n\t\t\t     &vec, sizeof(vec));\n\t\tfor (i = 0; i < sizeof(vec); i += 2) {\n\t\t\tprom_debug(\"%d: index = 0x%x val = 0x%x\\n\", i / 2\n\t\t\t\t\t\t\t\t  , vec[i]\n\t\t\t\t\t\t\t\t  , vec[i + 1]);\n\t\t\tprom_parse_platform_support(vec[i], vec[i + 1],\n\t\t\t\t\t\t    &supported);\n\t\t}\n\t}\n\n\tif (supported.radix_mmu && IS_ENABLED(CONFIG_PPC_RADIX_MMU)) {\n\t\t/* Radix preferred - Check if GTSE is also supported */\n\t\tprom_debug(\"Asking for radix\\n\");\n\t\tibm_architecture_vec.vec5.mmu = OV5_FEAT(OV5_MMU_RADIX);\n\t\tif (supported.radix_gtse)\n\t\t\tibm_architecture_vec.vec5.radix_ext =\n\t\t\t\t\tOV5_FEAT(OV5_RADIX_GTSE);\n\t\telse\n\t\t\tprom_debug(\"Radix GTSE isn't supported\\n\");\n\t} else if (supported.hash_mmu) {\n\t\t/* Default to hash mmu (if we can) */\n\t\tprom_debug(\"Asking for hash\\n\");\n\t\tibm_architecture_vec.vec5.mmu = OV5_FEAT(OV5_MMU_HASH);\n\t} else {\n\t\t/* We're probably on a legacy hypervisor */\n\t\tprom_debug(\"Assuming legacy hash support\\n\");\n\t}\n\n\tif (supported.xive) {\n\t\tprom_debug(\"Asking for XIVE\\n\");\n\t\tibm_architecture_vec.vec5.intarch = OV5_FEAT(OV5_XIVE_EXPLOIT);\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_check_platform_support(void)\n{\n\tstruct platform_support supported = {\n\t\t.hash_mmu = false,\n\t\t.radix_mmu = false,\n\t\t.radix_gtse = false,\n\t\t.xive = false\n\t};\n\tint prop_len = prom_getproplen(prom.chosen,\n\t\t\t\t       \"ibm,arch-vec-5-platform-support\");\n\n\t/*\n\t * First copy the architecture vec template\n\t *\n\t * use memcpy() instead of *vec = *vec_template so that GCC replaces it\n\t * by __memcpy() when KASAN is active\n\t */\n\tmemcpy(&ibm_architecture_vec, &ibm_architecture_vec_template,\n\t       sizeof(ibm_architecture_vec));\n\n\tif (prop_len > 1) {\n\t\tint i;\n\t\tu8 vec[8];\n\t\tprom_debug(\"Found ibm,arch-vec-5-platform-support, len: %d\\n\",\n\t\t\t   prop_len);\n\t\tif (prop_len > sizeof(vec))\n\t\t\tprom_printf(\"WARNING: ibm,arch-vec-5-platform-support longer than expected (len: %d)\\n\",\n\t\t\t\t    prop_len);\n\t\tprom_getprop(prom.chosen, \"ibm,arch-vec-5-platform-support\",\n\t\t\t     &vec, sizeof(vec));\n\t\tfor (i = 0; i < sizeof(vec); i += 2) {\n\t\t\tprom_debug(\"%d: index = 0x%x val = 0x%x\\n\", i / 2\n\t\t\t\t\t\t\t\t  , vec[i]\n\t\t\t\t\t\t\t\t  , vec[i + 1]);\n\t\t\tprom_parse_platform_support(vec[i], vec[i + 1],\n\t\t\t\t\t\t    &supported);\n\t\t}\n\t}\n\n\tif (supported.radix_mmu && IS_ENABLED(CONFIG_PPC_RADIX_MMU)) {\n\t\t/* Radix preferred - Check if GTSE is also supported */\n\t\tprom_debug(\"Asking for radix\\n\");\n\t\tibm_architecture_vec.vec5.mmu = OV5_FEAT(OV5_MMU_RADIX);\n\t\tif (supported.radix_gtse)\n\t\t\tibm_architecture_vec.vec5.radix_ext =\n\t\t\t\t\tOV5_FEAT(OV5_RADIX_GTSE);\n\t\telse\n\t\t\tprom_debug(\"Radix GTSE isn't supported\\n\");\n\t} else if (supported.hash_mmu) {\n\t\t/* Default to hash mmu (if we can) */\n\t\tprom_debug(\"Asking for hash\\n\");\n\t\tibm_architecture_vec.vec5.mmu = OV5_FEAT(OV5_MMU_HASH);\n\t} else {\n\t\t/* We're probably on a legacy hypervisor */\n\t\tprom_debug(\"Assuming legacy hash support\\n\");\n\t}\n\n\tif (supported.xive) {\n\t\tprom_debug(\"Asking for XIVE\\n\");\n\t\tibm_architecture_vec.vec5.intarch = OV5_FEAT(OV5_XIVE_EXPLOIT);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_send_capabilities(void)\n{\n\tihandle root;\n\tprom_arg_t ret;\n\tu32 cores;\n\n\t/* Check ibm,arch-vec-5-platform-support and fixup vec5 if required */\n\tprom_check_platform_support();\n\n\troot = call_prom(\"open\", 1, 1, ADDR(\"/\"));\n\tif (root != 0) {\n\t\t/* We need to tell the FW about the number of cores we support.\n\t\t *\n\t\t * To do that, we count the number of threads on the first core\n\t\t * (we assume this is the same for all cores) and use it to\n\t\t * divide NR_CPUS.\n\t\t */\n\n\t\tcores = DIV_ROUND_UP(NR_CPUS, prom_count_smt_threads());\n\t\tprom_printf(\"Max number of cores passed to firmware: %u (NR_CPUS = %d)\\n\",\n\t\t\t    cores, NR_CPUS);\n\n\t\tibm_architecture_vec.vec5.max_cpus = cpu_to_be32(cores);\n\n\t\t/* try calling the ibm,client-architecture-support method */\n\t\tprom_printf(\"Calling ibm,client-architecture-support...\");\n\t\tif (call_prom_ret(\"call-method\", 3, 2, &ret,\n\t\t\t\t  ADDR(\"ibm,client-architecture-support\"),\n\t\t\t\t  root,\n\t\t\t\t  ADDR(&ibm_architecture_vec)) == 0) {\n\t\t\t/* the call exists... */\n\t\t\tif (ret)\n\t\t\t\tprom_printf(\"\\nWARNING: ibm,client-architecture\"\n\t\t\t\t\t    \"-support call FAILED!\\n\");\n\t\t\tcall_prom(\"close\", 1, 0, root);\n\t\t\tprom_printf(\" done\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"close\", 1, 0, root);\n\t\tprom_printf(\" not implemented\\n\");\n\t}\n\n#ifdef __BIG_ENDIAN__\n\t{\n\t\tihandle elfloader;\n\n\t\t/* no ibm,client-architecture-support call, try the old way */\n\t\telfloader = call_prom(\"open\", 1, 1,\n\t\t\t\t      ADDR(\"/packages/elf-loader\"));\n\t\tif (elfloader == 0) {\n\t\t\tprom_printf(\"couldn't open /packages/elf-loader\\n\");\n\t\t\treturn;\n\t\t}\n\t\tcall_prom(\"call-method\", 3, 1, ADDR(\"process-elf-header\"),\n\t\t\t  elfloader, ADDR(&fake_elf));\n\t\tcall_prom(\"close\", 1, 0, elfloader);\n\t}\n#endif /* __BIG_ENDIAN__ */\n}"
  },
  {
    "function_name": "prom_check_platform_support",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1305-1366",
    "snippet": "static void __init prom_check_platform_support(void)\n{\n\tstruct platform_support supported = {\n\t\t.hash_mmu = false,\n\t\t.radix_mmu = false,\n\t\t.radix_gtse = false,\n\t\t.xive = false\n\t};\n\tint prop_len = prom_getproplen(prom.chosen,\n\t\t\t\t       \"ibm,arch-vec-5-platform-support\");\n\n\t/*\n\t * First copy the architecture vec template\n\t *\n\t * use memcpy() instead of *vec = *vec_template so that GCC replaces it\n\t * by __memcpy() when KASAN is active\n\t */\n\tmemcpy(&ibm_architecture_vec, &ibm_architecture_vec_template,\n\t       sizeof(ibm_architecture_vec));\n\n\tif (prop_len > 1) {\n\t\tint i;\n\t\tu8 vec[8];\n\t\tprom_debug(\"Found ibm,arch-vec-5-platform-support, len: %d\\n\",\n\t\t\t   prop_len);\n\t\tif (prop_len > sizeof(vec))\n\t\t\tprom_printf(\"WARNING: ibm,arch-vec-5-platform-support longer than expected (len: %d)\\n\",\n\t\t\t\t    prop_len);\n\t\tprom_getprop(prom.chosen, \"ibm,arch-vec-5-platform-support\",\n\t\t\t     &vec, sizeof(vec));\n\t\tfor (i = 0; i < sizeof(vec); i += 2) {\n\t\t\tprom_debug(\"%d: index = 0x%x val = 0x%x\\n\", i / 2\n\t\t\t\t\t\t\t\t  , vec[i]\n\t\t\t\t\t\t\t\t  , vec[i + 1]);\n\t\t\tprom_parse_platform_support(vec[i], vec[i + 1],\n\t\t\t\t\t\t    &supported);\n\t\t}\n\t}\n\n\tif (supported.radix_mmu && IS_ENABLED(CONFIG_PPC_RADIX_MMU)) {\n\t\t/* Radix preferred - Check if GTSE is also supported */\n\t\tprom_debug(\"Asking for radix\\n\");\n\t\tibm_architecture_vec.vec5.mmu = OV5_FEAT(OV5_MMU_RADIX);\n\t\tif (supported.radix_gtse)\n\t\t\tibm_architecture_vec.vec5.radix_ext =\n\t\t\t\t\tOV5_FEAT(OV5_RADIX_GTSE);\n\t\telse\n\t\t\tprom_debug(\"Radix GTSE isn't supported\\n\");\n\t} else if (supported.hash_mmu) {\n\t\t/* Default to hash mmu (if we can) */\n\t\tprom_debug(\"Asking for hash\\n\");\n\t\tibm_architecture_vec.vec5.mmu = OV5_FEAT(OV5_MMU_HASH);\n\t} else {\n\t\t/* We're probably on a legacy hypervisor */\n\t\tprom_debug(\"Assuming legacy hash support\\n\");\n\t}\n\n\tif (supported.xive) {\n\t\tprom_debug(\"Asking for XIVE\\n\");\n\t\tibm_architecture_vec.vec5.intarch = OV5_FEAT(OV5_XIVE_EXPLOIT);\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_XIVE_EXPLOIT"
          ],
          "line": 1364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Asking for XIVE\\n\""
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Assuming legacy hash support\\n\""
          ],
          "line": 1359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_MMU_HASH"
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Asking for hash\\n\""
          ],
          "line": 1355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Radix GTSE isn't supported\\n\""
          ],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_RADIX_GTSE"
          ],
          "line": 1350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_MMU_RADIX"
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Asking for radix\\n\""
          ],
          "line": 1346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_RADIX_MMU"
          ],
          "line": 1344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_parse_platform_support",
          "args": [
            "vec[i]",
            "vec[i + 1]",
            "&supported"
          ],
          "line": 1339
        },
        "resolved": true,
        "details": {
          "function_name": "prom_parse_platform_support",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1287-1303",
          "snippet": "static void __init prom_parse_platform_support(u8 index, u8 val,\n\t\t\t\t\t       struct platform_support *support)\n{\n\tswitch (index) {\n\tcase OV5_INDX(OV5_MMU_SUPPORT): /* MMU Model */\n\t\tprom_parse_mmu_model(val & OV5_FEAT(OV5_MMU_SUPPORT), support);\n\t\tbreak;\n\tcase OV5_INDX(OV5_RADIX_GTSE): /* Radix Extensions */\n\t\tif (val & OV5_FEAT(OV5_RADIX_GTSE))\n\t\t\tsupport->radix_gtse = !prom_radix_gtse_disable;\n\t\tbreak;\n\tcase OV5_INDX(OV5_XIVE_SUPPORT): /* Interrupt mode */\n\t\tprom_parse_xive_model(val & OV5_FEAT(OV5_XIVE_SUPPORT),\n\t\t\t\t      support);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_parse_platform_support(u8 index, u8 val,\n\t\t\t\t\t       struct platform_support *support)\n{\n\tswitch (index) {\n\tcase OV5_INDX(OV5_MMU_SUPPORT): /* MMU Model */\n\t\tprom_parse_mmu_model(val & OV5_FEAT(OV5_MMU_SUPPORT), support);\n\t\tbreak;\n\tcase OV5_INDX(OV5_RADIX_GTSE): /* Radix Extensions */\n\t\tif (val & OV5_FEAT(OV5_RADIX_GTSE))\n\t\t\tsupport->radix_gtse = !prom_radix_gtse_disable;\n\t\tbreak;\n\tcase OV5_INDX(OV5_XIVE_SUPPORT): /* Interrupt mode */\n\t\tprom_parse_xive_model(val & OV5_FEAT(OV5_XIVE_SUPPORT),\n\t\t\t\t      support);\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"%d: index = 0x%x val = 0x%x\\n\"",
            "i / 2",
            "vec[i]",
            "vec[i + 1]"
          ],
          "line": 1336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "prom.chosen",
            "\"ibm,arch-vec-5-platform-support\"",
            "&vec",
            "sizeof(vec)"
          ],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"WARNING: ibm,arch-vec-5-platform-support longer than expected (len: %d)\\n\"",
            "prop_len"
          ],
          "line": 1331
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Found ibm,arch-vec-5-platform-support, len: %d\\n\"",
            "prop_len"
          ],
          "line": 1328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ibm_architecture_vec",
            "&ibm_architecture_vec_template",
            "sizeof(ibm_architecture_vec)"
          ],
          "line": 1322
        },
        "resolved": true,
        "details": {
          "function_name": "_memcpy_toio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "181-205",
          "snippet": "void _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "prom.chosen",
            "\"ibm,arch-vec-5-platform-support\""
          ],
          "line": 1313
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "649-652",
          "snippet": "static inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_check_platform_support(void)\n{\n\tstruct platform_support supported = {\n\t\t.hash_mmu = false,\n\t\t.radix_mmu = false,\n\t\t.radix_gtse = false,\n\t\t.xive = false\n\t};\n\tint prop_len = prom_getproplen(prom.chosen,\n\t\t\t\t       \"ibm,arch-vec-5-platform-support\");\n\n\t/*\n\t * First copy the architecture vec template\n\t *\n\t * use memcpy() instead of *vec = *vec_template so that GCC replaces it\n\t * by __memcpy() when KASAN is active\n\t */\n\tmemcpy(&ibm_architecture_vec, &ibm_architecture_vec_template,\n\t       sizeof(ibm_architecture_vec));\n\n\tif (prop_len > 1) {\n\t\tint i;\n\t\tu8 vec[8];\n\t\tprom_debug(\"Found ibm,arch-vec-5-platform-support, len: %d\\n\",\n\t\t\t   prop_len);\n\t\tif (prop_len > sizeof(vec))\n\t\t\tprom_printf(\"WARNING: ibm,arch-vec-5-platform-support longer than expected (len: %d)\\n\",\n\t\t\t\t    prop_len);\n\t\tprom_getprop(prom.chosen, \"ibm,arch-vec-5-platform-support\",\n\t\t\t     &vec, sizeof(vec));\n\t\tfor (i = 0; i < sizeof(vec); i += 2) {\n\t\t\tprom_debug(\"%d: index = 0x%x val = 0x%x\\n\", i / 2\n\t\t\t\t\t\t\t\t  , vec[i]\n\t\t\t\t\t\t\t\t  , vec[i + 1]);\n\t\t\tprom_parse_platform_support(vec[i], vec[i + 1],\n\t\t\t\t\t\t    &supported);\n\t\t}\n\t}\n\n\tif (supported.radix_mmu && IS_ENABLED(CONFIG_PPC_RADIX_MMU)) {\n\t\t/* Radix preferred - Check if GTSE is also supported */\n\t\tprom_debug(\"Asking for radix\\n\");\n\t\tibm_architecture_vec.vec5.mmu = OV5_FEAT(OV5_MMU_RADIX);\n\t\tif (supported.radix_gtse)\n\t\t\tibm_architecture_vec.vec5.radix_ext =\n\t\t\t\t\tOV5_FEAT(OV5_RADIX_GTSE);\n\t\telse\n\t\t\tprom_debug(\"Radix GTSE isn't supported\\n\");\n\t} else if (supported.hash_mmu) {\n\t\t/* Default to hash mmu (if we can) */\n\t\tprom_debug(\"Asking for hash\\n\");\n\t\tibm_architecture_vec.vec5.mmu = OV5_FEAT(OV5_MMU_HASH);\n\t} else {\n\t\t/* We're probably on a legacy hypervisor */\n\t\tprom_debug(\"Assuming legacy hash support\\n\");\n\t}\n\n\tif (supported.xive) {\n\t\tprom_debug(\"Asking for XIVE\\n\");\n\t\tibm_architecture_vec.vec5.intarch = OV5_FEAT(OV5_XIVE_EXPLOIT);\n\t}\n}"
  },
  {
    "function_name": "prom_parse_platform_support",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1287-1303",
    "snippet": "static void __init prom_parse_platform_support(u8 index, u8 val,\n\t\t\t\t\t       struct platform_support *support)\n{\n\tswitch (index) {\n\tcase OV5_INDX(OV5_MMU_SUPPORT): /* MMU Model */\n\t\tprom_parse_mmu_model(val & OV5_FEAT(OV5_MMU_SUPPORT), support);\n\t\tbreak;\n\tcase OV5_INDX(OV5_RADIX_GTSE): /* Radix Extensions */\n\t\tif (val & OV5_FEAT(OV5_RADIX_GTSE))\n\t\t\tsupport->radix_gtse = !prom_radix_gtse_disable;\n\t\tbreak;\n\tcase OV5_INDX(OV5_XIVE_SUPPORT): /* Interrupt mode */\n\t\tprom_parse_xive_model(val & OV5_FEAT(OV5_XIVE_SUPPORT),\n\t\t\t\t      support);\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_parse_xive_model",
          "args": [
            "val & OV5_FEAT(OV5_XIVE_SUPPORT)",
            "support"
          ],
          "line": 1299
        },
        "resolved": true,
        "details": {
          "function_name": "prom_parse_xive_model",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1259-1285",
          "snippet": "static void __init prom_parse_xive_model(u8 val,\n\t\t\t\t\t struct platform_support *support)\n{\n\tswitch (val) {\n\tcase OV5_FEAT(OV5_XIVE_EITHER): /* Either Available */\n\t\tprom_debug(\"XIVE - either mode supported\\n\");\n\t\tsupport->xive = !prom_xive_disable;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_XIVE_EXPLOIT): /* Only Exploitation mode */\n\t\tprom_debug(\"XIVE - exploitation mode supported\\n\");\n\t\tif (prom_xive_disable) {\n\t\t\t/*\n\t\t\t * If we __have__ to do XIVE, we're better off ignoring\n\t\t\t * the command line rather than not booting.\n\t\t\t */\n\t\t\tprom_printf(\"WARNING: Ignoring cmdline option xive=off\\n\");\n\t\t}\n\t\tsupport->xive = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_XIVE_LEGACY): /* Only Legacy mode */\n\t\tprom_debug(\"XIVE - legacy mode supported\\n\");\n\t\tbreak;\n\tdefault:\n\t\tprom_debug(\"Unknown xive support option: 0x%x\\n\", val);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_parse_xive_model(u8 val,\n\t\t\t\t\t struct platform_support *support)\n{\n\tswitch (val) {\n\tcase OV5_FEAT(OV5_XIVE_EITHER): /* Either Available */\n\t\tprom_debug(\"XIVE - either mode supported\\n\");\n\t\tsupport->xive = !prom_xive_disable;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_XIVE_EXPLOIT): /* Only Exploitation mode */\n\t\tprom_debug(\"XIVE - exploitation mode supported\\n\");\n\t\tif (prom_xive_disable) {\n\t\t\t/*\n\t\t\t * If we __have__ to do XIVE, we're better off ignoring\n\t\t\t * the command line rather than not booting.\n\t\t\t */\n\t\t\tprom_printf(\"WARNING: Ignoring cmdline option xive=off\\n\");\n\t\t}\n\t\tsupport->xive = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_XIVE_LEGACY): /* Only Legacy mode */\n\t\tprom_debug(\"XIVE - legacy mode supported\\n\");\n\t\tbreak;\n\tdefault:\n\t\tprom_debug(\"Unknown xive support option: 0x%x\\n\", val);\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_XIVE_SUPPORT"
          ],
          "line": 1299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_INDX",
          "args": [
            "OV5_XIVE_SUPPORT"
          ],
          "line": 1298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_RADIX_GTSE"
          ],
          "line": 1295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_INDX",
          "args": [
            "OV5_RADIX_GTSE"
          ],
          "line": 1294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_parse_mmu_model",
          "args": [
            "val & OV5_FEAT(OV5_MMU_SUPPORT)",
            "support"
          ],
          "line": 1292
        },
        "resolved": true,
        "details": {
          "function_name": "prom_parse_mmu_model",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "1228-1257",
          "snippet": "static void __init prom_parse_mmu_model(u8 val,\n\t\t\t\t\tstruct platform_support *support)\n{\n\tswitch (val) {\n\tcase OV5_FEAT(OV5_MMU_DYNAMIC):\n\tcase OV5_FEAT(OV5_MMU_EITHER): /* Either Available */\n\t\tprom_debug(\"MMU - either supported\\n\");\n\t\tsupport->radix_mmu = !prom_radix_disable;\n\t\tsupport->hash_mmu = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_MMU_RADIX): /* Only Radix */\n\t\tprom_debug(\"MMU - radix only\\n\");\n\t\tif (prom_radix_disable) {\n\t\t\t/*\n\t\t\t * If we __have__ to do radix, we're better off ignoring\n\t\t\t * the command line rather than not booting.\n\t\t\t */\n\t\t\tprom_printf(\"WARNING: Ignoring cmdline option disable_radix\\n\");\n\t\t}\n\t\tsupport->radix_mmu = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_MMU_HASH):\n\t\tprom_debug(\"MMU - hash only\\n\");\n\t\tsupport->hash_mmu = true;\n\t\tbreak;\n\tdefault:\n\t\tprom_debug(\"Unknown mmu support option: 0x%x\\n\", val);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_parse_mmu_model(u8 val,\n\t\t\t\t\tstruct platform_support *support)\n{\n\tswitch (val) {\n\tcase OV5_FEAT(OV5_MMU_DYNAMIC):\n\tcase OV5_FEAT(OV5_MMU_EITHER): /* Either Available */\n\t\tprom_debug(\"MMU - either supported\\n\");\n\t\tsupport->radix_mmu = !prom_radix_disable;\n\t\tsupport->hash_mmu = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_MMU_RADIX): /* Only Radix */\n\t\tprom_debug(\"MMU - radix only\\n\");\n\t\tif (prom_radix_disable) {\n\t\t\t/*\n\t\t\t * If we __have__ to do radix, we're better off ignoring\n\t\t\t * the command line rather than not booting.\n\t\t\t */\n\t\t\tprom_printf(\"WARNING: Ignoring cmdline option disable_radix\\n\");\n\t\t}\n\t\tsupport->radix_mmu = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_MMU_HASH):\n\t\tprom_debug(\"MMU - hash only\\n\");\n\t\tsupport->hash_mmu = true;\n\t\tbreak;\n\tdefault:\n\t\tprom_debug(\"Unknown mmu support option: 0x%x\\n\", val);\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_MMU_SUPPORT"
          ],
          "line": 1292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_INDX",
          "args": [
            "OV5_MMU_SUPPORT"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_parse_platform_support(u8 index, u8 val,\n\t\t\t\t\t       struct platform_support *support)\n{\n\tswitch (index) {\n\tcase OV5_INDX(OV5_MMU_SUPPORT): /* MMU Model */\n\t\tprom_parse_mmu_model(val & OV5_FEAT(OV5_MMU_SUPPORT), support);\n\t\tbreak;\n\tcase OV5_INDX(OV5_RADIX_GTSE): /* Radix Extensions */\n\t\tif (val & OV5_FEAT(OV5_RADIX_GTSE))\n\t\t\tsupport->radix_gtse = !prom_radix_gtse_disable;\n\t\tbreak;\n\tcase OV5_INDX(OV5_XIVE_SUPPORT): /* Interrupt mode */\n\t\tprom_parse_xive_model(val & OV5_FEAT(OV5_XIVE_SUPPORT),\n\t\t\t\t      support);\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "prom_parse_xive_model",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1259-1285",
    "snippet": "static void __init prom_parse_xive_model(u8 val,\n\t\t\t\t\t struct platform_support *support)\n{\n\tswitch (val) {\n\tcase OV5_FEAT(OV5_XIVE_EITHER): /* Either Available */\n\t\tprom_debug(\"XIVE - either mode supported\\n\");\n\t\tsupport->xive = !prom_xive_disable;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_XIVE_EXPLOIT): /* Only Exploitation mode */\n\t\tprom_debug(\"XIVE - exploitation mode supported\\n\");\n\t\tif (prom_xive_disable) {\n\t\t\t/*\n\t\t\t * If we __have__ to do XIVE, we're better off ignoring\n\t\t\t * the command line rather than not booting.\n\t\t\t */\n\t\t\tprom_printf(\"WARNING: Ignoring cmdline option xive=off\\n\");\n\t\t}\n\t\tsupport->xive = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_XIVE_LEGACY): /* Only Legacy mode */\n\t\tprom_debug(\"XIVE - legacy mode supported\\n\");\n\t\tbreak;\n\tdefault:\n\t\tprom_debug(\"Unknown xive support option: 0x%x\\n\", val);\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Unknown xive support option: 0x%x\\n\"",
            "val"
          ],
          "line": 1282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"XIVE - legacy mode supported\\n\""
          ],
          "line": 1279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_XIVE_LEGACY"
          ],
          "line": 1278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"WARNING: Ignoring cmdline option xive=off\\n\""
          ],
          "line": 1274
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"XIVE - exploitation mode supported\\n\""
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_XIVE_EXPLOIT"
          ],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"XIVE - either mode supported\\n\""
          ],
          "line": 1264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_XIVE_EITHER"
          ],
          "line": 1263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_parse_xive_model(u8 val,\n\t\t\t\t\t struct platform_support *support)\n{\n\tswitch (val) {\n\tcase OV5_FEAT(OV5_XIVE_EITHER): /* Either Available */\n\t\tprom_debug(\"XIVE - either mode supported\\n\");\n\t\tsupport->xive = !prom_xive_disable;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_XIVE_EXPLOIT): /* Only Exploitation mode */\n\t\tprom_debug(\"XIVE - exploitation mode supported\\n\");\n\t\tif (prom_xive_disable) {\n\t\t\t/*\n\t\t\t * If we __have__ to do XIVE, we're better off ignoring\n\t\t\t * the command line rather than not booting.\n\t\t\t */\n\t\t\tprom_printf(\"WARNING: Ignoring cmdline option xive=off\\n\");\n\t\t}\n\t\tsupport->xive = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_XIVE_LEGACY): /* Only Legacy mode */\n\t\tprom_debug(\"XIVE - legacy mode supported\\n\");\n\t\tbreak;\n\tdefault:\n\t\tprom_debug(\"Unknown xive support option: 0x%x\\n\", val);\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "prom_parse_mmu_model",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1228-1257",
    "snippet": "static void __init prom_parse_mmu_model(u8 val,\n\t\t\t\t\tstruct platform_support *support)\n{\n\tswitch (val) {\n\tcase OV5_FEAT(OV5_MMU_DYNAMIC):\n\tcase OV5_FEAT(OV5_MMU_EITHER): /* Either Available */\n\t\tprom_debug(\"MMU - either supported\\n\");\n\t\tsupport->radix_mmu = !prom_radix_disable;\n\t\tsupport->hash_mmu = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_MMU_RADIX): /* Only Radix */\n\t\tprom_debug(\"MMU - radix only\\n\");\n\t\tif (prom_radix_disable) {\n\t\t\t/*\n\t\t\t * If we __have__ to do radix, we're better off ignoring\n\t\t\t * the command line rather than not booting.\n\t\t\t */\n\t\t\tprom_printf(\"WARNING: Ignoring cmdline option disable_radix\\n\");\n\t\t}\n\t\tsupport->radix_mmu = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_MMU_HASH):\n\t\tprom_debug(\"MMU - hash only\\n\");\n\t\tsupport->hash_mmu = true;\n\t\tbreak;\n\tdefault:\n\t\tprom_debug(\"Unknown mmu support option: 0x%x\\n\", val);\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Unknown mmu support option: 0x%x\\n\"",
            "val"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"MMU - hash only\\n\""
          ],
          "line": 1250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_MMU_HASH"
          ],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"WARNING: Ignoring cmdline option disable_radix\\n\""
          ],
          "line": 1245
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"MMU - radix only\\n\""
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_MMU_RADIX"
          ],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"MMU - either supported\\n\""
          ],
          "line": 1234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_MMU_EITHER"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OV5_FEAT",
          "args": [
            "OV5_MMU_DYNAMIC"
          ],
          "line": 1232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic void __init prom_parse_mmu_model(u8 val,\n\t\t\t\t\tstruct platform_support *support)\n{\n\tswitch (val) {\n\tcase OV5_FEAT(OV5_MMU_DYNAMIC):\n\tcase OV5_FEAT(OV5_MMU_EITHER): /* Either Available */\n\t\tprom_debug(\"MMU - either supported\\n\");\n\t\tsupport->radix_mmu = !prom_radix_disable;\n\t\tsupport->hash_mmu = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_MMU_RADIX): /* Only Radix */\n\t\tprom_debug(\"MMU - radix only\\n\");\n\t\tif (prom_radix_disable) {\n\t\t\t/*\n\t\t\t * If we __have__ to do radix, we're better off ignoring\n\t\t\t * the command line rather than not booting.\n\t\t\t */\n\t\t\tprom_printf(\"WARNING: Ignoring cmdline option disable_radix\\n\");\n\t\t}\n\t\tsupport->radix_mmu = true;\n\t\tbreak;\n\tcase OV5_FEAT(OV5_MMU_HASH):\n\t\tprom_debug(\"MMU - hash only\\n\");\n\t\tsupport->hash_mmu = true;\n\t\tbreak;\n\tdefault:\n\t\tprom_debug(\"Unknown mmu support option: 0x%x\\n\", val);\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "prom_count_smt_threads",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "1190-1226",
    "snippet": "static int __init prom_count_smt_threads(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\n\t/* Pick up th first CPU node we can find */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (prom_strcmp(type, \"cpu\"))\n\t\t\tcontinue;\n\t\t/*\n\t\t * There is an entry for each smt thread, each entry being\n\t\t * 4 bytes long.  All cpus should have the same number of\n\t\t * smt threads, so return after finding the first.\n\t\t */\n\t\tplen = prom_getproplen(node, \"ibm,ppc-interrupt-server#s\");\n\t\tif (plen == PROM_ERROR)\n\t\t\tbreak;\n\t\tplen >>= 2;\n\t\tprom_debug(\"Found %lu smt threads per core\\n\", (unsigned long)plen);\n\n\t\t/* Sanity check */\n\t\tif (plen < 1 || plen > 64) {\n\t\t\tprom_printf(\"Threads per core %lu out of bounds, assuming 1\\n\",\n\t\t\t\t    (unsigned long)plen);\n\t\t\treturn 1;\n\t\t}\n\t\treturn plen;\n\t}\n\tprom_debug(\"No threads found, assuming 1 per core\\n\");\n\n\treturn 1;\n\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"No threads found, assuming 1 per core\\n\""
          ],
          "line": 1222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"Threads per core %lu out of bounds, assuming 1\\n\"",
            "(unsigned long)plen"
          ],
          "line": 1216
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Found %lu smt threads per core\\n\"",
            "(unsigned long)plen"
          ],
          "line": 1212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getproplen",
          "args": [
            "node",
            "\"ibm,ppc-interrupt-server#s\""
          ],
          "line": 1208
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getproplen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "649-652",
          "snippet": "static inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strcmp",
          "args": [
            "type",
            "\"cpu\""
          ],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "230-243",
          "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "node",
            "\"device_type\"",
            "type",
            "sizeof(type)"
          ],
          "line": 1199
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_next_node",
          "args": [
            "&node"
          ],
          "line": 1197
        },
        "resolved": true,
        "details": {
          "function_name": "prom_next_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "625-640",
          "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic void __init;\n\nstatic int __init prom_count_smt_threads(void)\n{\n\tphandle node;\n\tchar type[64];\n\tunsigned int plen;\n\n\t/* Pick up th first CPU node we can find */\n\tfor (node = 0; prom_next_node(&node); ) {\n\t\ttype[0] = 0;\n\t\tprom_getprop(node, \"device_type\", type, sizeof(type));\n\n\t\tif (prom_strcmp(type, \"cpu\"))\n\t\t\tcontinue;\n\t\t/*\n\t\t * There is an entry for each smt thread, each entry being\n\t\t * 4 bytes long.  All cpus should have the same number of\n\t\t * smt threads, so return after finding the first.\n\t\t */\n\t\tplen = prom_getproplen(node, \"ibm,ppc-interrupt-server#s\");\n\t\tif (plen == PROM_ERROR)\n\t\t\tbreak;\n\t\tplen >>= 2;\n\t\tprom_debug(\"Found %lu smt threads per core\\n\", (unsigned long)plen);\n\n\t\t/* Sanity check */\n\t\tif (plen < 1 || plen > 64) {\n\t\t\tprom_printf(\"Threads per core %lu out of bounds, assuming 1\\n\",\n\t\t\t\t    (unsigned long)plen);\n\t\t\treturn 1;\n\t\t}\n\t\treturn plen;\n\t}\n\tprom_debug(\"No threads found, assuming 1 per core\\n\");\n\n\treturn 1;\n\n}"
  },
  {
    "function_name": "early_cmdline_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "767-850",
    "snippet": "static void __init early_cmdline_parse(void)\n{\n\tconst char *opt;\n\n\tchar *p;\n\tint l = 0;\n\n\tprom_cmd_line[0] = 0;\n\tp = prom_cmd_line;\n\n\tif (!IS_ENABLED(CONFIG_CMDLINE_FORCE) && (long)prom.chosen > 0)\n\t\tl = prom_getprop(prom.chosen, \"bootargs\", p, COMMAND_LINE_SIZE-1);\n\n\tif (IS_ENABLED(CONFIG_CMDLINE_EXTEND) || l <= 0 || p[0] == '\\0')\n\t\tprom_strlcat(prom_cmd_line, \" \" CONFIG_CMDLINE,\n\t\t\t     sizeof(prom_cmd_line));\n\n\tprom_printf(\"command line: %s\\n\", prom_cmd_line);\n\n#ifdef CONFIG_PPC64\n\topt = prom_strstr(prom_cmd_line, \"iommu=\");\n\tif (opt) {\n\t\tprom_printf(\"iommu opt is: %s\\n\", opt);\n\t\topt += 6;\n\t\twhile (*opt && *opt == ' ')\n\t\t\topt++;\n\t\tif (!prom_strncmp(opt, \"off\", 3))\n\t\t\tprom_iommu_off = 1;\n\t\telse if (!prom_strncmp(opt, \"force\", 5))\n\t\t\tprom_iommu_force_on = 1;\n\t}\n#endif\n\topt = prom_strstr(prom_cmd_line, \"mem=\");\n\tif (opt) {\n\t\topt += 4;\n\t\tprom_memory_limit = prom_memparse(opt, (const char **)&opt);\n#ifdef CONFIG_PPC64\n\t\t/* Align to 16 MB == size of ppc64 large page */\n\t\tprom_memory_limit = ALIGN(prom_memory_limit, 0x1000000);\n#endif\n\t}\n\n#ifdef CONFIG_PPC_PSERIES\n\tprom_radix_disable = !IS_ENABLED(CONFIG_PPC_RADIX_MMU_DEFAULT);\n\topt = prom_strstr(prom_cmd_line, \"disable_radix\");\n\tif (opt) {\n\t\topt += 13;\n\t\tif (*opt && *opt == '=') {\n\t\t\tbool val;\n\n\t\t\tif (prom_strtobool(++opt, &val))\n\t\t\t\tprom_radix_disable = false;\n\t\t\telse\n\t\t\t\tprom_radix_disable = val;\n\t\t} else\n\t\t\tprom_radix_disable = true;\n\t}\n\tif (prom_radix_disable)\n\t\tprom_debug(\"Radix disabled from cmdline\\n\");\n\n\topt = prom_strstr(prom_cmd_line, \"radix_hcall_invalidate=on\");\n\tif (opt) {\n\t\tprom_radix_gtse_disable = true;\n\t\tprom_debug(\"Radix GTSE disabled from cmdline\\n\");\n\t}\n\n\topt = prom_strstr(prom_cmd_line, \"xive=off\");\n\tif (opt) {\n\t\tprom_xive_disable = true;\n\t\tprom_debug(\"XIVE disabled from cmdline\\n\");\n\t}\n#endif /* CONFIG_PPC_PSERIES */\n\n#ifdef CONFIG_PPC_SVM\n\topt = prom_strstr(prom_cmd_line, \"svm=\");\n\tif (opt) {\n\t\tbool val;\n\n\t\topt += sizeof(\"svm=\") - 1;\n\t\tif (!prom_strtobool(opt, &val))\n\t\t\tprom_svm_enable = val;\n\t}\n#endif /* CONFIG_PPC_SVM */\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static char __prombss prom_cmd_line[COMMAND_LINE_SIZE];",
      "static unsigned long __prombss prom_memory_limit;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_strtobool",
          "args": [
            "opt",
            "&val"
          ],
          "line": 846
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strtobool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "328-363",
          "snippet": "static int __init prom_strtobool(const char *s, bool *res)\n{\n\tif (!s)\n\t\treturn -EINVAL;\n\n\tswitch (s[0]) {\n\tcase 'y':\n\tcase 'Y':\n\tcase '1':\n\t\t*res = true;\n\t\treturn 0;\n\tcase 'n':\n\tcase 'N':\n\tcase '0':\n\t\t*res = false;\n\t\treturn 0;\n\tcase 'o':\n\tcase 'O':\n\t\tswitch (s[1]) {\n\t\tcase 'n':\n\t\tcase 'N':\n\t\t\t*res = true;\n\t\t\treturn 0;\n\t\tcase 'f':\n\t\tcase 'F':\n\t\t\t*res = false;\n\t\t\treturn 0;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strtobool(const char *s, bool *res)\n{\n\tif (!s)\n\t\treturn -EINVAL;\n\n\tswitch (s[0]) {\n\tcase 'y':\n\tcase 'Y':\n\tcase '1':\n\t\t*res = true;\n\t\treturn 0;\n\tcase 'n':\n\tcase 'N':\n\tcase '0':\n\t\t*res = false;\n\t\treturn 0;\n\tcase 'o':\n\tcase 'O':\n\t\tswitch (s[1]) {\n\t\tcase 'n':\n\t\tcase 'N':\n\t\t\t*res = true;\n\t\t\treturn 0;\n\t\tcase 'f':\n\t\tcase 'F':\n\t\t\t*res = false;\n\t\t\treturn 0;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strstr",
          "args": [
            "prom_cmd_line",
            "\"svm=\""
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "290-305",
          "snippet": "static char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"XIVE disabled from cmdline\\n\""
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Radix GTSE disabled from cmdline\\n\""
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_debug",
          "args": [
            "\"Radix disabled from cmdline\\n\""
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PPC_RADIX_MMU_DEFAULT"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "prom_memory_limit",
            "0x1000000"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_memparse",
          "args": [
            "opt",
            "(const char **)&opt"
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "prom_memparse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "736-761",
          "snippet": "static unsigned long prom_memparse(const char *ptr, const char **retptr)\n{\n\tunsigned long ret = prom_strtoul(ptr, retptr);\n\tint shift = 0;\n\n\t/*\n\t * We can't use a switch here because GCC *may* generate a\n\t * jump table which won't work, because we're not running at\n\t * the address we're linked at.\n\t */\n\tif ('G' == **retptr || 'g' == **retptr)\n\t\tshift = 30;\n\n\tif ('M' == **retptr || 'm' == **retptr)\n\t\tshift = 20;\n\n\tif ('K' == **retptr || 'k' == **retptr)\n\t\tshift = 10;\n\n\tif (shift) {\n\t\tret <<= shift;\n\t\t(*retptr)++;\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long prom_memparse(const char *ptr, const char **retptr)\n{\n\tunsigned long ret = prom_strtoul(ptr, retptr);\n\tint shift = 0;\n\n\t/*\n\t * We can't use a switch here because GCC *may* generate a\n\t * jump table which won't work, because we're not running at\n\t * the address we're linked at.\n\t */\n\tif ('G' == **retptr || 'g' == **retptr)\n\t\tshift = 30;\n\n\tif ('M' == **retptr || 'm' == **retptr)\n\t\tshift = 20;\n\n\tif ('K' == **retptr || 'k' == **retptr)\n\t\tshift = 10;\n\n\tif (shift) {\n\t\tret <<= shift;\n\t\t(*retptr)++;\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strncmp",
          "args": [
            "opt",
            "\"force\"",
            "5"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "254-268",
          "snippet": "static int __init prom_strncmp(const char *cs, const char *ct, size_t count)\n{\n\tunsigned char c1, c2;\n\n\twhile (count) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t\tcount--;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strncmp(const char *cs, const char *ct, size_t count)\n{\n\tunsigned char c1, c2;\n\n\twhile (count) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t\tcount--;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_printf",
          "args": [
            "\"iommu opt is: %s\\n\"",
            "opt"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strlcat",
          "args": [
            "prom_cmd_line",
            "\" \" CONFIG_CMDLINE",
            "sizeof(prom_cmd_line)"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlcat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "307-325",
          "snippet": "static size_t __init prom_strlcat(char *dest, const char *src, size_t count)\n{\n\tsize_t dsize = prom_strlen(dest);\n\tsize_t len = prom_strlen(src);\n\tsize_t res = dsize + len;\n\n\t/* This would be a bug */\n\tif (dsize >= count)\n\t\treturn count;\n\n\tdest += dsize;\n\tcount -= dsize;\n\tif (len >= count)\n\t\tlen = count-1;\n\tmemcpy(dest, src, len);\n\tdest[len] = 0;\n\treturn res;\n\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlcat(char *dest, const char *src, size_t count)\n{\n\tsize_t dsize = prom_strlen(dest);\n\tsize_t len = prom_strlen(src);\n\tsize_t res = dsize + len;\n\n\t/* This would be a bug */\n\tif (dsize >= count)\n\t\treturn count;\n\n\tdest += dsize;\n\tcount -= dsize;\n\tif (len >= count)\n\t\tlen = count-1;\n\tmemcpy(dest, src, len);\n\tdest[len] = 0;\n\treturn res;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_CMDLINE_EXTEND"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_getprop",
          "args": [
            "prom.chosen",
            "\"bootargs\"",
            "p",
            "COMMAND_LINE_SIZE-1"
          ],
          "line": 778
        },
        "resolved": true,
        "details": {
          "function_name": "prom_getprop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "642-647",
          "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_CMDLINE_FORCE"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic char __prombss prom_cmd_line[COMMAND_LINE_SIZE];\nstatic unsigned long __prombss prom_memory_limit;\nstatic void __init;\n\nstatic void __init early_cmdline_parse(void)\n{\n\tconst char *opt;\n\n\tchar *p;\n\tint l = 0;\n\n\tprom_cmd_line[0] = 0;\n\tp = prom_cmd_line;\n\n\tif (!IS_ENABLED(CONFIG_CMDLINE_FORCE) && (long)prom.chosen > 0)\n\t\tl = prom_getprop(prom.chosen, \"bootargs\", p, COMMAND_LINE_SIZE-1);\n\n\tif (IS_ENABLED(CONFIG_CMDLINE_EXTEND) || l <= 0 || p[0] == '\\0')\n\t\tprom_strlcat(prom_cmd_line, \" \" CONFIG_CMDLINE,\n\t\t\t     sizeof(prom_cmd_line));\n\n\tprom_printf(\"command line: %s\\n\", prom_cmd_line);\n\n#ifdef CONFIG_PPC64\n\topt = prom_strstr(prom_cmd_line, \"iommu=\");\n\tif (opt) {\n\t\tprom_printf(\"iommu opt is: %s\\n\", opt);\n\t\topt += 6;\n\t\twhile (*opt && *opt == ' ')\n\t\t\topt++;\n\t\tif (!prom_strncmp(opt, \"off\", 3))\n\t\t\tprom_iommu_off = 1;\n\t\telse if (!prom_strncmp(opt, \"force\", 5))\n\t\t\tprom_iommu_force_on = 1;\n\t}\n#endif\n\topt = prom_strstr(prom_cmd_line, \"mem=\");\n\tif (opt) {\n\t\topt += 4;\n\t\tprom_memory_limit = prom_memparse(opt, (const char **)&opt);\n#ifdef CONFIG_PPC64\n\t\t/* Align to 16 MB == size of ppc64 large page */\n\t\tprom_memory_limit = ALIGN(prom_memory_limit, 0x1000000);\n#endif\n\t}\n\n#ifdef CONFIG_PPC_PSERIES\n\tprom_radix_disable = !IS_ENABLED(CONFIG_PPC_RADIX_MMU_DEFAULT);\n\topt = prom_strstr(prom_cmd_line, \"disable_radix\");\n\tif (opt) {\n\t\topt += 13;\n\t\tif (*opt && *opt == '=') {\n\t\t\tbool val;\n\n\t\t\tif (prom_strtobool(++opt, &val))\n\t\t\t\tprom_radix_disable = false;\n\t\t\telse\n\t\t\t\tprom_radix_disable = val;\n\t\t} else\n\t\t\tprom_radix_disable = true;\n\t}\n\tif (prom_radix_disable)\n\t\tprom_debug(\"Radix disabled from cmdline\\n\");\n\n\topt = prom_strstr(prom_cmd_line, \"radix_hcall_invalidate=on\");\n\tif (opt) {\n\t\tprom_radix_gtse_disable = true;\n\t\tprom_debug(\"Radix GTSE disabled from cmdline\\n\");\n\t}\n\n\topt = prom_strstr(prom_cmd_line, \"xive=off\");\n\tif (opt) {\n\t\tprom_xive_disable = true;\n\t\tprom_debug(\"XIVE disabled from cmdline\\n\");\n\t}\n#endif /* CONFIG_PPC_PSERIES */\n\n#ifdef CONFIG_PPC_SVM\n\topt = prom_strstr(prom_cmd_line, \"svm=\");\n\tif (opt) {\n\t\tbool val;\n\n\t\topt += sizeof(\"svm=\") - 1;\n\t\tif (!prom_strtobool(opt, &val))\n\t\t\tprom_svm_enable = val;\n\t}\n#endif /* CONFIG_PPC_SVM */\n}"
  },
  {
    "function_name": "prom_memparse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "736-761",
    "snippet": "static unsigned long prom_memparse(const char *ptr, const char **retptr)\n{\n\tunsigned long ret = prom_strtoul(ptr, retptr);\n\tint shift = 0;\n\n\t/*\n\t * We can't use a switch here because GCC *may* generate a\n\t * jump table which won't work, because we're not running at\n\t * the address we're linked at.\n\t */\n\tif ('G' == **retptr || 'g' == **retptr)\n\t\tshift = 30;\n\n\tif ('M' == **retptr || 'm' == **retptr)\n\t\tshift = 20;\n\n\tif ('K' == **retptr || 'k' == **retptr)\n\t\tshift = 10;\n\n\tif (shift) {\n\t\tret <<= shift;\n\t\t(*retptr)++;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_strtoul",
          "args": [
            "ptr",
            "retptr"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strtoul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "711-734",
          "snippet": "static unsigned long prom_strtoul(const char *cp, const char **endp)\n{\n\tunsigned long result = 0, base = 10, value;\n\n\tif (*cp == '0') {\n\t\tbase = 8;\n\t\tcp++;\n\t\tif (toupper(*cp) == 'X') {\n\t\t\tcp++;\n\t\t\tbase = 16;\n\t\t}\n\t}\n\n\twhile (isxdigit(*cp) &&\n\t       (value = isdigit(*cp) ? *cp - '0' : toupper(*cp) - 'A' + 10) < base) {\n\t\tresult = result * base + value;\n\t\tcp++;\n\t}\n\n\tif (endp)\n\t\t*endp = cp;\n\n\treturn result;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long prom_strtoul(const char *cp, const char **endp)\n{\n\tunsigned long result = 0, base = 10, value;\n\n\tif (*cp == '0') {\n\t\tbase = 8;\n\t\tcp++;\n\t\tif (toupper(*cp) == 'X') {\n\t\t\tcp++;\n\t\t\tbase = 16;\n\t\t}\n\t}\n\n\twhile (isxdigit(*cp) &&\n\t       (value = isdigit(*cp) ? *cp - '0' : toupper(*cp) - 'A' + 10) < base) {\n\t\tresult = result * base + value;\n\t\tcp++;\n\t}\n\n\tif (endp)\n\t\t*endp = cp;\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long prom_memparse(const char *ptr, const char **retptr)\n{\n\tunsigned long ret = prom_strtoul(ptr, retptr);\n\tint shift = 0;\n\n\t/*\n\t * We can't use a switch here because GCC *may* generate a\n\t * jump table which won't work, because we're not running at\n\t * the address we're linked at.\n\t */\n\tif ('G' == **retptr || 'g' == **retptr)\n\t\tshift = 30;\n\n\tif ('M' == **retptr || 'm' == **retptr)\n\t\tshift = 20;\n\n\tif ('K' == **retptr || 'k' == **retptr)\n\t\tshift = 10;\n\n\tif (shift) {\n\t\tret <<= shift;\n\t\t(*retptr)++;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "prom_strtoul",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "711-734",
    "snippet": "static unsigned long prom_strtoul(const char *cp, const char **endp)\n{\n\tunsigned long result = 0, base = 10, value;\n\n\tif (*cp == '0') {\n\t\tbase = 8;\n\t\tcp++;\n\t\tif (toupper(*cp) == 'X') {\n\t\t\tcp++;\n\t\t\tbase = 16;\n\t\t}\n\t}\n\n\twhile (isxdigit(*cp) &&\n\t       (value = isdigit(*cp) ? *cp - '0' : toupper(*cp) - 'A' + 10) < base) {\n\t\tresult = result * base + value;\n\t\tcp++;\n\t}\n\n\tif (endp)\n\t\t*endp = cp;\n\n\treturn result;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "toupper",
          "args": [
            "*cp"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*cp"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isxdigit",
          "args": [
            "*cp"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toupper",
          "args": [
            "*cp"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic unsigned long prom_strtoul(const char *cp, const char **endp)\n{\n\tunsigned long result = 0, base = 10, value;\n\n\tif (*cp == '0') {\n\t\tbase = 8;\n\t\tcp++;\n\t\tif (toupper(*cp) == 'X') {\n\t\t\tcp++;\n\t\t\tbase = 16;\n\t\t}\n\t}\n\n\twhile (isxdigit(*cp) &&\n\t       (value = isdigit(*cp) ? *cp - '0' : toupper(*cp) - 'A' + 10) < base) {\n\t\tresult = result * base + value;\n\t\tcp++;\n\t}\n\n\tif (endp)\n\t\t*endp = cp;\n\n\treturn result;\n}"
  },
  {
    "function_name": "prom_setprop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "680-700",
    "snippet": "static int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */",
      "#define OF_WORKAROUNDS\tof_workarounds",
      "#define OF_WORKAROUNDS\t0"
    ],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"interpret\"",
            "1",
            "1",
            "(u32)(unsigned long) cmd"
          ],
          "line": 699
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_string",
          "args": [
            "&p",
            "\"property\""
          ],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "add_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "654-662",
          "snippet": "static void add_string(char **str, const char *q)\n{\n\tchar *p = *str;\n\n\twhile (*q)\n\t\t*p++ = *q++;\n\t*p++ = ' ';\n\t*str = p;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void add_string(char **str, const char *q)\n{\n\tchar *p = *str;\n\n\twhile (*q)\n\t\t*p++ = *q++;\n\t*p++ = ' ';\n\t*str = p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tohex",
          "args": [
            "prom_strlen(pname)"
          ],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "tohex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "664-678",
          "snippet": "static char *tohex(unsigned int x)\n{\n\tstatic const char digits[] __initconst = \"0123456789abcdef\";\n\tstatic char result[9] __prombss;\n\tint i;\n\n\tresult[8] = 0;\n\ti = 8;\n\tdo {\n\t\t--i;\n\t\tresult[i] = digits[x & 0xf];\n\t\tx >>= 4;\n\t} while (x != 0 && i > 0);\n\treturn &result[i];\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define __prombss __section(.bss.prominit)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define __prombss __section(.bss.prominit)\n\nstatic char *tohex(unsigned int x)\n{\n\tstatic const char digits[] __initconst = \"0123456789abcdef\";\n\tstatic char result[9] __prombss;\n\tint i;\n\n\tresult[8] = 0;\n\ti = 8;\n\tdo {\n\t\t--i;\n\t\tresult[i] = digits[x & 0xf];\n\t\tx >>= 4;\n\t} while (x != 0 && i > 0);\n\treturn &result[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strlen",
          "args": [
            "pname"
          ],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "pname"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "pname"
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_LONGTRAIL\t2\t/* work around longtrail bugs */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic void __init;\n\nstatic int __init prom_setprop(phandle node, const char *nodename,\n\t\t\t       const char *pname, void *value, size_t valuelen)\n{\n\tchar cmd[256], *p;\n\n\tif (!(OF_WORKAROUNDS & OF_WA_LONGTRAIL))\n\t\treturn call_prom(\"setprop\", 4, 1, node, ADDR(pname),\n\t\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n\n\t/* gah... setprop doesn't work on longtrail, have to use interpret */\n\tp = cmd;\n\tadd_string(&p, \"dev\");\n\tadd_string(&p, nodename);\n\tadd_string(&p, tohex((u32)(unsigned long) value));\n\tadd_string(&p, tohex(valuelen));\n\tadd_string(&p, tohex(ADDR(pname)));\n\tadd_string(&p, tohex(prom_strlen(pname)));\n\tadd_string(&p, \"property\");\n\t*p = 0;\n\treturn call_prom(\"interpret\", 1, 1, (u32)(unsigned long) cmd);\n}"
  },
  {
    "function_name": "tohex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "664-678",
    "snippet": "static char *tohex(unsigned int x)\n{\n\tstatic const char digits[] __initconst = \"0123456789abcdef\";\n\tstatic char result[9] __prombss;\n\tint i;\n\n\tresult[8] = 0;\n\ti = 8;\n\tdo {\n\t\t--i;\n\t\tresult[i] = digits[x & 0xf];\n\t\tx >>= 4;\n\t} while (x != 0 && i > 0);\n\treturn &result[i];\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define __prombss __section(.bss.prominit)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define __prombss __section(.bss.prominit)\n\nstatic char *tohex(unsigned int x)\n{\n\tstatic const char digits[] __initconst = \"0123456789abcdef\";\n\tstatic char result[9] __prombss;\n\tint i;\n\n\tresult[8] = 0;\n\ti = 8;\n\tdo {\n\t\t--i;\n\t\tresult[i] = digits[x & 0xf];\n\t\tx >>= 4;\n\t} while (x != 0 && i > 0);\n\treturn &result[i];\n}"
  },
  {
    "function_name": "add_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "654-662",
    "snippet": "static void add_string(char **str, const char *q)\n{\n\tchar *p = *str;\n\n\twhile (*q)\n\t\t*p++ = *q++;\n\t*p++ = ' ';\n\t*str = p;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void add_string(char **str, const char *q)\n{\n\tchar *p = *str;\n\n\twhile (*q)\n\t\t*p++ = *q++;\n\t*p++ = ' ';\n\t*str = p;\n}"
  },
  {
    "function_name": "prom_getproplen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "649-652",
    "snippet": "static inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"getproplen\"",
            "2",
            "1",
            "node",
            "ADDR(pname)"
          ],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "pname"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getproplen(phandle node, const char *pname)\n{\n\treturn call_prom(\"getproplen\", 2, 1, node, ADDR(pname));\n}"
  },
  {
    "function_name": "prom_getprop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "642-647",
    "snippet": "static inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"getprop\"",
            "4",
            "1",
            "node",
            "ADDR(pname)",
            "(u32)(unsigned long) value",
            "(u32) valuelen"
          ],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "pname"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic inline int __init prom_getprop(phandle node, const char *pname,\n\t\t\t\t      void *value, size_t valuelen)\n{\n\treturn call_prom(\"getprop\", 4, 1, node, ADDR(pname),\n\t\t\t (u32)(unsigned long) value, (u32) valuelen);\n}"
  },
  {
    "function_name": "prom_next_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "625-640",
    "snippet": "static int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"peer\"",
            "1",
            "1",
            "node"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_next_node(phandle *nodep)\n{\n\tphandle node;\n\n\tif ((node = *nodep) != 0\n\t    && (*nodep = call_prom(\"child\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\treturn 1;\n\tfor (;;) {\n\t\tif ((node = call_prom(\"parent\", 1, 1, node)) == 0)\n\t\t\treturn 0;\n\t\tif ((*nodep = call_prom(\"peer\", 1, 1, node)) != 0)\n\t\t\treturn 1;\n\t}\n}"
  },
  {
    "function_name": "prom_claim",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "575-607",
    "snippet": "static unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */",
      "#define OF_WORKAROUNDS\tof_workarounds",
      "#define OF_WORKAROUNDS\t0"
    ],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"claim\"",
            "3",
            "1",
            "(prom_arg_t)virt",
            "(prom_arg_t)size",
            "(prom_arg_t)align"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"map\""
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"release\""
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"claim\""
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"claim\""
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define OF_WA_CLAIM\t1\t/* do phys/virt claim separately, then map */\n#define OF_WORKAROUNDS\tof_workarounds\n#define OF_WORKAROUNDS\t0\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic unsigned int __init prom_claim(unsigned long virt, unsigned long size,\n\t\t\t\tunsigned long align)\n{\n\n\tif (align == 0 && (OF_WORKAROUNDS & OF_WA_CLAIM)) {\n\t\t/*\n\t\t * Old OF requires we claim physical and virtual separately\n\t\t * and then map explicitly (assuming virtual mode)\n\t\t */\n\t\tint ret;\n\t\tprom_arg_t result;\n\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.memory,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0 || result == -1)\n\t\t\treturn -1;\n\t\tret = call_prom_ret(\"call-method\", 5, 2, &result,\n\t\t\t\t    ADDR(\"claim\"), prom.mmumap,\n\t\t\t\t    align, size, virt);\n\t\tif (ret != 0) {\n\t\t\tcall_prom(\"call-method\", 4, 1, ADDR(\"release\"),\n\t\t\t\t  prom.memory, size, virt);\n\t\t\treturn -1;\n\t\t}\n\t\t/* the 0x12 is M (coherence) + PP == read/write */\n\t\tcall_prom(\"call-method\", 6, 1,\n\t\t\t  ADDR(\"map\"), prom.mmumap, 0x12, size, virt, virt);\n\t\treturn virt;\n\t}\n\treturn call_prom(\"claim\", 3, 1, (prom_arg_t)virt, (prom_arg_t)size,\n\t\t\t (prom_arg_t)align);\n}"
  },
  {
    "function_name": "prom_printf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "482-572",
    "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_print_dec",
          "args": [
            "vs"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "prom_print_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "465-479",
          "snippet": "static void __init prom_print_dec(unsigned long val)\n{\n\tint i, size;\n\tchar buf[UL_DIGITS+1];\n\n\tfor (i = UL_DIGITS-1; i >= 0;  i--) {\n\t\tbuf[i] = (val % 10) + '0';\n\t\tval = val/10;\n\t\tif (val == 0)\n\t\t\tbreak;\n\t}\n\t/* shift stuff down */\n\tsize = UL_DIGITS - i;\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf+i, size);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define UL_DIGITS 21"
          ],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define UL_DIGITS 21\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_print_dec(unsigned long val)\n{\n\tint i, size;\n\tchar buf[UL_DIGITS+1];\n\n\tfor (i = UL_DIGITS-1; i >= 0;  i--) {\n\t\tbuf[i] = (val % 10) + '0';\n\t\tval = val/10;\n\t\tif (val == 0)\n\t\t\tbreak;\n\t}\n\t/* shift stuff down */\n\tsize = UL_DIGITS - i;\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf+i, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_print",
          "args": [
            "\"-\""
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "prom_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "482-572",
          "snippet": "static void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "longlong"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "long"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "int"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "unsignedlong long"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "unsignedlong"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "unsignedint"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prom_print_hex",
          "args": [
            "v"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "prom_print_hex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "448-461",
          "snippet": "static void __init prom_print_hex(unsigned long val)\n{\n\tint i, nibbles = sizeof(val)*2;\n\tchar buf[sizeof(val)*2+1];\n\n\tfor (i = nibbles-1;  i >= 0;  i--) {\n\t\tbuf[i] = (val & 0xf) + '0';\n\t\tif (buf[i] > '9')\n\t\t\tbuf[i] += ('a'-'0'-10);\n\t\tval >>= 4;\n\t}\n\tbuf[nibbles] = '\\0';\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf, nibbles);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct prom_t __prombss prom;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_print_hex(unsigned long val)\n{\n\tint i, nibbles = sizeof(val)*2;\n\tchar buf[sizeof(val)*2+1];\n\n\tfor (i = nibbles-1;  i >= 0;  i--) {\n\t\tbuf[i] = (val & 0xf) + '0';\n\t\tif (buf[i] > '9')\n\t\t\tbuf[i] += ('a'-'0'-10);\n\t\tval >>= 4;\n\t}\n\tbuf[nibbles] = '\\0';\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf, nibbles);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "unsignedlong long"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "unsignedlong"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "unsignedint"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "constchar *"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"write\"",
            "3",
            "1",
            "prom.stdout",
            "ADDR(\"\\r\\n\")",
            "2"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"\\r\\n\""
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "format"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_printf(const char *format, ...)\n{\n\tconst char *p, *q, *s;\n\tva_list args;\n\tunsigned long v;\n\tlong vs;\n\tint n = 0;\n\n\tva_start(args, format);\n\tfor (p = format; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n' && *q != '%'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\tif (*q == '\\n') {\n\t\t\t++q;\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout,\n\t\t\t\t  ADDR(\"\\r\\n\"), 2);\n\t\t\tcontinue;\n\t\t}\n\t\t++q;\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\twhile (*q == 'l') {\n\t\t\t++q;\n\t\t\t++n;\n\t\t}\n\t\tswitch (*q) {\n\t\tcase 's':\n\t\t\t++q;\n\t\t\ts = va_arg(args, const char *);\n\t\t\tprom_print(s);\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_hex(v);\n\t\t\tbreak;\n\t\tcase 'u':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tv = va_arg(args, unsigned int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tv = va_arg(args, unsigned long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tv = va_arg(args, unsigned long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprom_print_dec(v);\n\t\t\tbreak;\n\t\tcase 'd':\n\t\t\t++q;\n\t\t\tswitch (n) {\n\t\t\tcase 0:\n\t\t\t\tvs = va_arg(args, int);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvs = va_arg(args, long);\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\tdefault:\n\t\t\t\tvs = va_arg(args, long long);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (vs < 0) {\n\t\t\t\tprom_print(\"-\");\n\t\t\t\tvs = -vs;\n\t\t\t}\n\t\t\tprom_print_dec(vs);\n\t\t\tbreak;\n\t\t}\n\t}\n\tva_end(args);\n}"
  },
  {
    "function_name": "prom_print_dec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "465-479",
    "snippet": "static void __init prom_print_dec(unsigned long val)\n{\n\tint i, size;\n\tchar buf[UL_DIGITS+1];\n\n\tfor (i = UL_DIGITS-1; i >= 0;  i--) {\n\t\tbuf[i] = (val % 10) + '0';\n\t\tval = val/10;\n\t\tif (val == 0)\n\t\t\tbreak;\n\t}\n\t/* shift stuff down */\n\tsize = UL_DIGITS - i;\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf+i, size);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define UL_DIGITS 21"
    ],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"write\"",
            "3",
            "1",
            "prom.stdout",
            "buf+i",
            "size"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define UL_DIGITS 21\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_print_dec(unsigned long val)\n{\n\tint i, size;\n\tchar buf[UL_DIGITS+1];\n\n\tfor (i = UL_DIGITS-1; i >= 0;  i--) {\n\t\tbuf[i] = (val % 10) + '0';\n\t\tval = val/10;\n\t\tif (val == 0)\n\t\t\tbreak;\n\t}\n\t/* shift stuff down */\n\tsize = UL_DIGITS - i;\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf+i, size);\n}"
  },
  {
    "function_name": "prom_print_hex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "448-461",
    "snippet": "static void __init prom_print_hex(unsigned long val)\n{\n\tint i, nibbles = sizeof(val)*2;\n\tchar buf[sizeof(val)*2+1];\n\n\tfor (i = nibbles-1;  i >= 0;  i--) {\n\t\tbuf[i] = (val & 0xf) + '0';\n\t\tif (buf[i] > '9')\n\t\t\tbuf[i] += ('a'-'0'-10);\n\t\tval >>= 4;\n\t}\n\tbuf[nibbles] = '\\0';\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf, nibbles);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"write\"",
            "3",
            "1",
            "prom.stdout",
            "buf",
            "nibbles"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_print_hex(unsigned long val)\n{\n\tint i, nibbles = sizeof(val)*2;\n\tchar buf[sizeof(val)*2+1];\n\n\tfor (i = nibbles-1;  i >= 0;  i--) {\n\t\tbuf[i] = (val & 0xf) + '0';\n\t\tif (buf[i] > '9')\n\t\t\tbuf[i] += ('a'-'0'-10);\n\t\tval >>= 4;\n\t}\n\tbuf[nibbles] = '\\0';\n\tcall_prom(\"write\", 3, 1, prom.stdout, buf, nibbles);\n}"
  },
  {
    "function_name": "prom_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "424-441",
    "snippet": "static void __init prom_print(const char *msg)\n{\n\tconst char *p, *q;\n\n\tif (prom.stdout == 0)\n\t\treturn;\n\n\tfor (p = msg; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\t++q;\n\t\tcall_prom(\"write\", 3, 1, prom.stdout, ADDR(\"\\r\\n\"), 2);\n\t}\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct prom_t __prombss prom;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_prom",
          "args": [
            "\"write\"",
            "3",
            "1",
            "prom.stdout",
            "ADDR(\"\\r\\n\")",
            "2"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "call_prom_ret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "394-421",
          "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define PROM_ERROR\t\t(-1u)"
          ],
          "globals_used": [
            "static unsigned long __prombss prom_entry;",
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "\"\\r\\n\""
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic struct prom_t __prombss prom;\nstatic void __init;\n\nstatic void __init prom_print(const char *msg)\n{\n\tconst char *p, *q;\n\n\tif (prom.stdout == 0)\n\t\treturn;\n\n\tfor (p = msg; *p != 0; p = q) {\n\t\tfor (q = p; *q != 0 && *q != '\\n'; ++q)\n\t\t\t;\n\t\tif (q > p)\n\t\t\tcall_prom(\"write\", 3, 1, prom.stdout, p, q - p);\n\t\tif (*q == 0)\n\t\t\tbreak;\n\t\t++q;\n\t\tcall_prom(\"write\", 3, 1, prom.stdout, ADDR(\"\\r\\n\"), 2);\n\t}\n}"
  },
  {
    "function_name": "call_prom_ret",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "394-421",
    "snippet": "static int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static unsigned long __prombss prom_entry;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "args.args[nargs]"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "args.args[nargs+i]"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enter_prom",
          "args": [
            "&args",
            "prom_entry"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "enter_prom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "140-143",
          "snippet": "static inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "list"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "va_arg(list, prom_arg_t)"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "list",
            "prom_arg_t"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "list",
            "rets"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nret"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nargs"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ADDR(service)"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "service"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom_ret(const char *service, int nargs, int nret,\n\t\t\t\tprom_arg_t *rets, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, rets);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\tif (rets != NULL)\n\t\tfor (i = 1; i < nret; ++i)\n\t\t\trets[i-1] = be32_to_cpu(args.args[nargs+i]);\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
  },
  {
    "function_name": "call_prom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "370-392",
    "snippet": "static int __init call_prom(const char *service, int nargs, int nret, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, nret);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [
      "#define PROM_ERROR\t\t(-1u)"
    ],
    "globals_used": [
      "static unsigned long __prombss prom_entry;",
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "args.args[nargs]"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enter_prom",
          "args": [
            "&args",
            "prom_entry"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "enter_prom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "140-143",
          "snippet": "static inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "list"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "va_arg(list, prom_arg_t)"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "list",
            "prom_arg_t"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "list",
            "nret"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nret"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "nargs"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ADDR(service)"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADDR",
          "args": [
            "service"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\n#define PROM_ERROR\t\t(-1u)\n\nstatic unsigned long __prombss prom_entry;\nstatic void __init;\n\nstatic int __init call_prom(const char *service, int nargs, int nret, ...)\n{\n\tint i;\n\tstruct prom_args args;\n\tva_list list;\n\n\targs.service = cpu_to_be32(ADDR(service));\n\targs.nargs = cpu_to_be32(nargs);\n\targs.nret = cpu_to_be32(nret);\n\n\tva_start(list, nret);\n\tfor (i = 0; i < nargs; i++)\n\t\targs.args[i] = cpu_to_be32(va_arg(list, prom_arg_t));\n\tva_end(list);\n\n\tfor (i = 0; i < nret; i++)\n\t\targs.args[nargs+i] = 0;\n\n\tif (enter_prom(&args, prom_entry) < 0)\n\t\treturn PROM_ERROR;\n\n\treturn (nret > 0) ? be32_to_cpu(args.args[nargs]) : 0;\n}"
  },
  {
    "function_name": "prom_strtobool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "328-363",
    "snippet": "static int __init prom_strtobool(const char *s, bool *res)\n{\n\tif (!s)\n\t\treturn -EINVAL;\n\n\tswitch (s[0]) {\n\tcase 'y':\n\tcase 'Y':\n\tcase '1':\n\t\t*res = true;\n\t\treturn 0;\n\tcase 'n':\n\tcase 'N':\n\tcase '0':\n\t\t*res = false;\n\t\treturn 0;\n\tcase 'o':\n\tcase 'O':\n\t\tswitch (s[1]) {\n\t\tcase 'n':\n\t\tcase 'N':\n\t\t\t*res = true;\n\t\t\treturn 0;\n\t\tcase 'f':\n\t\tcase 'F':\n\t\t\t*res = false;\n\t\t\treturn 0;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn -EINVAL;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strtobool(const char *s, bool *res)\n{\n\tif (!s)\n\t\treturn -EINVAL;\n\n\tswitch (s[0]) {\n\tcase 'y':\n\tcase 'Y':\n\tcase '1':\n\t\t*res = true;\n\t\treturn 0;\n\tcase 'n':\n\tcase 'N':\n\tcase '0':\n\t\t*res = false;\n\t\treturn 0;\n\tcase 'o':\n\tcase 'O':\n\t\tswitch (s[1]) {\n\t\tcase 'n':\n\t\tcase 'N':\n\t\t\t*res = true;\n\t\t\treturn 0;\n\t\tcase 'f':\n\t\tcase 'F':\n\t\t\t*res = false;\n\t\t\treturn 0;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "prom_strlcat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "307-325",
    "snippet": "static size_t __init prom_strlcat(char *dest, const char *src, size_t count)\n{\n\tsize_t dsize = prom_strlen(dest);\n\tsize_t len = prom_strlen(src);\n\tsize_t res = dsize + len;\n\n\t/* This would be a bug */\n\tif (dsize >= count)\n\t\treturn count;\n\n\tdest += dsize;\n\tcount -= dsize;\n\tif (len >= count)\n\t\tlen = count-1;\n\tmemcpy(dest, src, len);\n\tdest[len] = 0;\n\treturn res;\n\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dest",
            "src",
            "len"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "_memcpy_toio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/io.c",
          "lines": "181-205",
          "snippet": "void _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}",
          "includes": [
            "#include <asm/bug.h>",
            "#include <asm/firmware.h>",
            "#include <asm/io.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/bug.h>\n#include <asm/firmware.h>\n#include <asm/io.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid _memcpy_toio(volatile void __iomem *dest, const void *src, unsigned long n)\n{\n\tvoid *vdest = (void __force *) dest;\n\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n\twhile(n && (!IO_CHECK_ALIGN(vdest, 4) || !IO_CHECK_ALIGN(src, 4))) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\twhile(n >= 4) {\n\t\t*((volatile u32 *)vdest) = *((volatile u32 *)src);\n\t\tsrc += 4;\n\t\tvdest += 4;\n\t\tn-=4;\n\t}\n\twhile(n) {\n\t\t*((volatile u8 *)vdest) = *((u8 *)src);\n\t\tsrc++;\n\t\tvdest++;\n\t\tn--;\n\t}\n\t__asm__ __volatile__ (\"sync\" : : : \"memory\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strlen",
          "args": [
            "src"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlcat(char *dest, const char *src, size_t count)\n{\n\tsize_t dsize = prom_strlen(dest);\n\tsize_t len = prom_strlen(src);\n\tsize_t res = dsize + len;\n\n\t/* This would be a bug */\n\tif (dsize >= count)\n\t\treturn count;\n\n\tdest += dsize;\n\tcount -= dsize;\n\tif (len >= count)\n\t\tlen = count-1;\n\tmemcpy(dest, src, len);\n\tdest[len] = 0;\n\treturn res;\n\n}"
  },
  {
    "function_name": "prom_strstr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "290-305",
    "snippet": "static char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prom_memcmp",
          "args": [
            "s1",
            "s2",
            "l2"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "prom_memcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "279-288",
          "snippet": "static int __init prom_memcmp(const void *cs, const void *ct, size_t count)\n{\n\tconst unsigned char *su1, *su2;\n\tint res = 0;\n\n\tfor (su1 = cs, su2 = ct; 0 < count; ++su1, ++su2, count--)\n\t\tif ((res = *su1 - *su2) != 0)\n\t\t\tbreak;\n\treturn res;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_memcmp(const void *cs, const void *ct, size_t count)\n{\n\tconst unsigned char *su1, *su2;\n\tint res = 0;\n\n\tfor (su1 = cs, su2 = ct; 0 < count; ++su1, ++su2, count--)\n\t\tif ((res = *su1 - *su2) != 0)\n\t\t\tbreak;\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prom_strlen",
          "args": [
            "s1"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "prom_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
          "lines": "270-277",
          "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
          "includes": [
            "#include <linux/linux_logo.h>",
            "#include <asm/ultravisor-api.h>",
            "#include <asm/asm-prototypes.h>",
            "#include <asm/machdep.h>",
            "#include <asm/sections.h>",
            "#include <asm/btext.h>",
            "#include <asm/iommu.h>",
            "#include <asm/mmu.h>",
            "#include <asm/smp.h>",
            "#include <asm/io.h>",
            "#include <asm/irq.h>",
            "#include <asm/processor.h>",
            "#include <asm/page.h>",
            "#include <asm/rtas.h>",
            "#include <asm/prom.h>",
            "#include <linux/pgtable.h>",
            "#include <linux/bitops.h>",
            "#include <linux/initrd.h>",
            "#include <linux/delay.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pci.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/threads.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __init"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic char __init *prom_strstr(const char *s1, const char *s2)\n{\n\tsize_t l1, l2;\n\n\tl2 = prom_strlen(s2);\n\tif (!l2)\n\t\treturn (char *)s1;\n\tl1 = prom_strlen(s1);\n\twhile (l1 >= l2) {\n\t\tl1--;\n\t\tif (!prom_memcmp(s1, s2, l2))\n\t\t\treturn (char *)s1;\n\t\ts1++;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "prom_memcmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "279-288",
    "snippet": "static int __init prom_memcmp(const void *cs, const void *ct, size_t count)\n{\n\tconst unsigned char *su1, *su2;\n\tint res = 0;\n\n\tfor (su1 = cs, su2 = ct; 0 < count; ++su1, ++su2, count--)\n\t\tif ((res = *su1 - *su2) != 0)\n\t\t\tbreak;\n\treturn res;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_memcmp(const void *cs, const void *ct, size_t count)\n{\n\tconst unsigned char *su1, *su2;\n\tint res = 0;\n\n\tfor (su1 = cs, su2 = ct; 0 < count; ++su1, ++su2, count--)\n\t\tif ((res = *su1 - *su2) != 0)\n\t\t\tbreak;\n\treturn res;\n}"
  },
  {
    "function_name": "prom_strlen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "270-277",
    "snippet": "static size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic size_t __init prom_strlen(const char *s)\n{\n\tconst char *sc;\n\n\tfor (sc = s; *sc != '\\0'; ++sc)\n\t\t/* nothing */;\n\treturn sc - s;\n}"
  },
  {
    "function_name": "prom_strncmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "254-268",
    "snippet": "static int __init prom_strncmp(const char *cs, const char *ct, size_t count)\n{\n\tunsigned char c1, c2;\n\n\twhile (count) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t\tcount--;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strncmp(const char *cs, const char *ct, size_t count)\n{\n\tunsigned char c1, c2;\n\n\twhile (count) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t\tcount--;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "prom_strcpy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "245-252",
    "snippet": "static char __init *prom_strcpy(char *dest, const char *src)\n{\n\tchar *tmp = dest;\n\n\twhile ((*dest++ = *src++) != '\\0')\n\t\t/* nothing */;\n\treturn tmp;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic char __init *prom_strcpy(char *dest, const char *src)\n{\n\tchar *tmp = dest;\n\n\twhile ((*dest++ = *src++) != '\\0')\n\t\t/* nothing */;\n\treturn tmp;\n}"
  },
  {
    "function_name": "prom_strcmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "230-243",
    "snippet": "static int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __init"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic void __init;\n\nstatic int __init prom_strcmp(const char *cs, const char *ct)\n{\n\tunsigned char c1, c2;\n\n\twhile (1) {\n\t\tc1 = *cs++;\n\t\tc2 = *ct++;\n\t\tif (c1 != c2)\n\t\t\treturn c1 < c2 ? -1 : 1;\n\t\tif (!c1)\n\t\t\tbreak;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "enter_prom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-27777/repo/arch/powerpc/kernel/prom_init.c",
    "lines": "140-143",
    "snippet": "static inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}",
    "includes": [
      "#include <linux/linux_logo.h>",
      "#include <asm/ultravisor-api.h>",
      "#include <asm/asm-prototypes.h>",
      "#include <asm/machdep.h>",
      "#include <asm/sections.h>",
      "#include <asm/btext.h>",
      "#include <asm/iommu.h>",
      "#include <asm/mmu.h>",
      "#include <asm/smp.h>",
      "#include <asm/io.h>",
      "#include <asm/irq.h>",
      "#include <asm/processor.h>",
      "#include <asm/page.h>",
      "#include <asm/rtas.h>",
      "#include <asm/prom.h>",
      "#include <linux/pgtable.h>",
      "#include <linux/bitops.h>",
      "#include <linux/initrd.h>",
      "#include <linux/delay.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pci.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/threads.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/kernel.h>",
      "#include <stdarg.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "args"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/linux_logo.h>\n#include <asm/ultravisor-api.h>\n#include <asm/asm-prototypes.h>\n#include <asm/machdep.h>\n#include <asm/sections.h>\n#include <asm/btext.h>\n#include <asm/iommu.h>\n#include <asm/mmu.h>\n#include <asm/smp.h>\n#include <asm/io.h>\n#include <asm/irq.h>\n#include <asm/processor.h>\n#include <asm/page.h>\n#include <asm/rtas.h>\n#include <asm/prom.h>\n#include <linux/pgtable.h>\n#include <linux/bitops.h>\n#include <linux/initrd.h>\n#include <linux/delay.h>\n#include <linux/proc_fs.h>\n#include <linux/pci.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/threads.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <stdarg.h>\n\nstatic inline int enter_prom(struct prom_args *args, unsigned long entry)\n{\n\treturn ((int (*)(struct prom_args *))entry)(args);\n}"
  }
]